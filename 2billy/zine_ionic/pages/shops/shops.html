<ion-header>
  <ion-navbar>
    <ion-buttons start>
    <button ion-button menuToggle icon-only >
      <ion-icon name='menu'></ion-icon>
    </button>
    </ion-buttons>
    <button color="seccond" style="height:30px;font-size:80%;width:90%" ion-button (click)="openSearch()" outline  icon-left large><ion-icon name="search"></ion-icon>クリックして検索</button>
    <ion-buttons end>
      <button ion-button icon-only (click)="openMap()">
        <ion-icon name='map-outline'></ion-icon>
      </button>
    </ion-buttons>
  </ion-navbar>
</ion-header>

<ion-content>
  <div padding>
    <ion-segment [(ngModel)]="main">
      <ion-segment-button value="range" tappable (click)="presentRange($event)">
        {{selectedRange}}
      </ion-segment-button>
      <ion-segment-button value="category" tappable (click)="presentCategory($event)">
        ジャンル
      </ion-segment-button>
      <ion-segment-button value="sort" tappable (click)="presentSort($event)">
        {{selectedSort}}
      </ion-segment-button>
    </ion-segment>
  </div>
  <div [ngSwitch]="range">
    <ion-list *ngIf="isMember == true">
      <ion-item-sliding *ngFor="let shop of shops">
        <ion-item tappable (click)="openShop(shop.id)"style="-webkit-align-items: center; " >
          <ion-thumbnail item-start no-padding>
            <img src="{{shop.s_image}}" class="shops-img" > 
          </ion-thumbnail>
      <h3 style="display:table;"><span style="
      font-weight: bold;
      background-color:rgba(255, 180, 0, 0.1);
      vertical-align: middle; display: table-cell;border: 1px solid #ffb400;font-size:1rem; color:#ffb400">&nbsp;店名&nbsp;</span>&nbsp;<b>{{shop.name}}</b></h3>
      <div style="width:100%;margin-top: 4px;">
        <div style="float:left;margin-top:-4px;"> 
          <rating no-margin no-padding  [(ngModel)]="shop.score" style="font-size:70%;" readOnly="true" max="5" emptyStarIconName="star-outline" halfStarIconName="star-half" starIconName="star" nullable="false" (ngModelChange)="onModelChange($event)"> </rating>
        </div>
        <div style="float:left;">
          <div style="display:table;margin-top:4px">
            <span *ngIf="shop.certific" style="
            display: table-cell;
            vertical-align: middle;
            font-weight: bold;
            background-color:rgba(105, 187, 123, 0.18);
            border: 1px solid #69BB7B;font-size:0.9rem;color: #69BB7B;background-color:rgba(105, 187, 123, 0.1)">&nbsp;おすすめ&nbsp;</span>&nbsp;
          <span *ngIf="shop.has_coupons" style="
          display: table-cell;
          font-weight: bold;
          vertical-align: middle;
          border: 1px solid #F7A3A3;font-size:0.9rem; color:#F7A3A3;background-color:rgba(247, 163, 163, 0.1)">&nbsp;キャンペーン&nbsp;</span>
          </div>
        </div>
        <div style="clear:both"></div>
      </div>
      <p >
      <span *ngFor="let area of shop.shop_area">
        {{area.area_name}}
      </span>
      <span *ngFor="let cate of shop.shop_category">
        {{cate.cate_name}}
      </span>
      <ion-note item-end>>{{shop.distance}}km</ion-note>
      </p>
          <div class="actions">
            <span >
              <ion-icon name='heart-outline' *ngIf="!shop.islike" color="danger" item-srat></ion-icon> 
              <ion-icon name='heart' *ngIf="shop.islike" color="danger"  item-srat></ion-icon>
              <span ion-text color="gray" style="font-size:80%" >{{shop.likenum}}</span>
            </span>
            <span margin-left>
              <ion-icon name="ios-text-outline" color="facebook"></ion-icon>
              <span ion-text color="gray" style="font-size:80%"[hidden]="!shop.shop_evaluates_count">{{shop.shop_evaluates_count}}</span>
            </span>
          </div>
        </ion-item>
        <ion-item-options>
          <button tappable ion-button color="danger" (click)="dropBookmark(shop)">
            <ion-icon name="ios-trash-outline"></ion-icon>
             削除
          </button>
        </ion-item-options>
      </ion-item-sliding>
    </ion-list>
    <ion-list *ngIf="isMember == false">
     <ion-item-sliding *ngFor="let shop of shops">
      <ion-item tappable  (click)="openShop(shop.id)" no-padding padding-left style="-webkit-align-items: center; " >
        <ion-thumbnail item-start>
          <img src="{{shop.s_image}}" class="shops-img" >
        </ion-thumbnail>
        <h3 style="display:table;"><span style="
            font-weight: bold;vertical-align: middle; display: table-cell;border: 1px solid #ffb400;font-size:1rem; color:#ffb400;rgba;
            background-color:rgba(255, 180, 0, 0.1);
            ">&nbsp;店名&nbsp;</span>&nbsp;<b>{{shop.name}}</b></h3>
        <div style="width:100%;margin-top: 4px;">
          <div style="float:left;margin-top:-4px;"> 
            <rating no-margin no-padding  [(ngModel)]="shop.score" style="font-size:70%;" readOnly="true" max="5" emptyStarIconName="star-outline" halfStarIconName="star-half" starIconName="star" nullable="false" (ngModelChange)="onModelChange($event)"> </rating>
          </div>
          <div style="float:left;">
            <div style="display:table;margin-top:4px">
              <span *ngIf="shop.certific" style="
              display: table-cell;
              vertical-align: middle;
              font-weight: bold;
              border: 1px solid #69BB7B;font-size:0.9rem;color: #69BB7B;background-color:rgba(105, 187, 123, 0.1)">&nbsp;おすすめ&nbsp;</span>&nbsp;
            <span *ngIf="shop.has_coupons" style="
            display: table-cell;
            font-weight: bold;
            vertical-align: middle;
            border: 1px solid #F7A3A3;font-size:0.9rem; color:#F7A3A3;background-color:rgba(247, 163, 163, 0.1)">&nbsp;キャンペーン&nbsp;</span>
            </div>
          </div>
          <div style="clear:both"></div>
        </div>
        <p>
          <span *ngFor="let area of shop.shop_area">
            {{area.area_name}}
          </span>
          <span *ngFor="let cate of shop.shop_category">
            {{cate.cate_name}}
          </span>
          <ion-note item-end>>{{shop.distance}}km</ion-note>
        </p>
        <div class="actions">
          <span >
            <ion-icon name='heart-outline' *ngIf="!shop.islike" color="danger"  item-srat></ion-icon> 
            <ion-icon name='heart' *ngIf="shop.islike" color="danger" item-srat></ion-icon>
            <span ion-text color="gray" style="font-size:80%" >{{shop.likenum}}</span>
          </span>
          <span margin-left>
            <ion-icon name="ios-text-outline" color="facebook"></ion-icon>
            <span ion-text color="gray" style="font-size:80%"[hidden]="!shop.shop_evaluates_count">{{shop.shop_evaluates_count}}</span>
          </span>
        </div>
       </ion-item>
        <ion-item-options>
          <button tappable ion-button color="blue" (click)="onCorrection(shop.id)">
            <ion-icon name="create-outline"></ion-icon>
             訂正
          </button>
          <button tappable ion-button color="danger" (click)="addLike(shop.id)">
            <ion-icon name="heart-outline"></ion-icon>
             いいね
          </button>
        </ion-item-options>
      </ion-item-sliding>
    </ion-list>
  </div>
  <ion-infinite-scroll [enabled]="scrollEnable" (ionInfinite)="doInfinite($event)"> 
    <ion-infinite-scroll-content></ion-infinite-scroll-content>
  </ion-infinite-scroll>
</ion-content>
