!function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n=window.webpackJsonp;window.webpackJsonp=function(r,o,a){for(var s,l,u,c=0,h=[];c<r.length;c++)i[l=r[c]]&&h.push(i[l][0]),i[l]=0;for(s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s]);for(n&&n(r,o,a);h.length;)h.shift()();if(a)for(c=0;c<a.length;c++)u=e(e.s=a[c]);return u};var r={},i={4:0};e.e=function(t){function n(){s.onerror=s.onload=null,clearTimeout(l);var e=i[t];0!==e&&(e&&e[1](new Error("Loading chunk "+t+" failed.")),i[t]=void 0)}var r=i[t];if(0===r)return new Promise(function(t){t()});if(r)return r[2];var o=new Promise(function(e,n){r=i[t]=[e,n]});r[2]=o;var a=document.getElementsByTagName("head")[0],s=document.createElement("script");s.type="text/javascript",s.charset="utf-8",s.async=!0,s.timeout=12e4,e.nc&&s.setAttribute("nonce",e.nc),s.src=e.p+""+t+".js";var l=setTimeout(n,12e4);return s.onerror=s.onload=n,a.appendChild(s),o},e.m=t,e.c=r,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="build/",e.oe=function(t){throw console.error(t),t}}([function(t,e,n){"use strict";(function(t){function r(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(t){var r=t.apply(void 0,e);for(var i in r)this[i]=r[i]}}}function i(t,e,n){function i(){function t(t,e,n){for(var i=t.hasOwnProperty(rr)?t[rr]:Object.defineProperty(t,rr,{value:[]})[rr];i.length<=n;)i.push(null);return(i[n]=i[n]||[]).push(r),t}for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(this instanceof i)return o.apply(this,e),this;var r=new((a=i).bind.apply(a,[void 0].concat(e)));return t.annotation=r,t;var a}var o=r(e);return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i}function o(){if(!gr){var t=mr.Symbol;if(t&&t.iterator)gr=t.iterator;else for(var e=Object.getOwnPropertyNames(Map.prototype),n=0;n<e.length;++n){var r=e[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(gr=r)}}return gr}function a(t){"undefined"==typeof Zone?vr.then(function(){t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}function s(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)}function l(t){if("string"==typeof t)return t;if(t instanceof Array)return"["+t.map(l).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return""+t.overriddenName;if(t.name)return""+t.name;var e=t.toString();if(null==e)return""+e;var n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function u(t){return t.__forward_ref__=u,t.toString=function(){return l(this())},t}function c(t){return"function"==typeof t&&t.hasOwnProperty("__forward_ref__")&&t.__forward_ref__===u?t():t}function h(t){var e=function(t){var e=Ar,n=t.deps;if(n&&n.length){e=[];for(var r=0;r<n.length;r++){var i=6,o=c(n[r]);if(o instanceof Array)for(var a=0,s=o;a<s.length;a++){var l=s[a];l instanceof cr||l==cr?i|=1:l instanceof pr||l==pr?i&=-3:l instanceof hr||l==hr?i&=-5:o=l instanceof ur?l.token:c(l)}e.push({token:o,options:i})}}else if(t.useExisting){var o=c(t.useExisting);e=[{token:o,options:6}]}else if(!(n||Pr in t))throw v("'deps' required",t);return e}(t),n=Sr,r=Ar,i=!1,o=c(t.provide);if(Pr in t)r=t.useValue;else if(t.useFactory)n=t.useFactory;else if(t.useExisting);else if(t.useClass)i=!0,n=c(t.useClass);else{if("function"!=typeof o)throw v("StaticProvider does not have [useValue|useFactory|useExisting|useClass] or [provide] is not newable",t);i=!0,n=o}return{deps:e,fn:n,useNew:i,value:r}}function p(t){return v("Cannot mix multi providers and regular providers",t)}function d(t,e){if(e)if((e=c(e))instanceof Array)for(var n=0;n<e.length;n++)d(t,e[n]);else{if("function"==typeof e)throw v("Function/Class not supported",e);if(!e||"object"!=typeof e||!e.provide)throw v("Unexpected provider",e);var r=c(e.provide),i=h(e);if(!0===e.multi){var o=t.get(r);if(o){if(o.fn!==Tr)throw p(r)}else t.set(r,o={token:e.provide,deps:[],useNew:!1,fn:Tr,value:Ar});o.deps.push({token:r=e,options:6})}var a=t.get(r);if(a&&a.fn==Tr)throw p(r);t.set(r,i)}}function f(t,e,n,r,i){try{return function(t,e,n,r,i){var o;if(e){if((o=e.value)==Mr)throw Error(Ir+"Circular dependency");if(o===Ar){e.value=Mr;var a=void 0,s=e.useNew,l=e.fn,u=e.deps,c=Ar;if(u.length){c=[];for(var h=0;h<u.length;h++){var p=u[h],d=p.options,m=2&d?n.get(p.token):void 0;c.push(f(p.token,m,n,m||4&d?r:Nr,1&d?null:wr.THROW_IF_NOT_FOUND))}}e.value=o=s?new((v=l).bind.apply(v,[void 0].concat(c))):l.apply(a,c)}}else o=r.get(t,i);return o;var v}(t,e,n,r,i)}catch(n){n instanceof Error||(n=new Error(n));throw(n[Or]=n[Or]||[]).unshift(t),e&&e.value==Mr&&(e.value=Ar),n}}function m(t,e,n){void 0===n&&(n=null),t=t&&"\n"===t.charAt(0)&&t.charAt(1)==Ir?t.substr(2):t;var r=l(e);if(e instanceof Array)r=e.map(l).join(" -> ");else if("object"==typeof e){var i=[];for(var o in e)if(e.hasOwnProperty(o)){var a=e[o];i.push(o+":"+("string"==typeof a?JSON.stringify(a):l(a)))}r="{"+i.join(", ")+"}"}return"StaticInjectorError"+(n?"("+n+")":"")+"["+r+"]: "+t.replace(Lr,"\n  ")}function v(t,e){return new Error(m(t,e))}function g(t){return t[Fr]}function y(t){return t[Rr]}function b(t){if(t.length>1){return" ("+function(t){for(var e=[],n=0;n<t.length;++n){if(e.indexOf(t[n])>-1)return e.push(t[n]),e;e.push(t[n])}return e}(t.slice().reverse()).map(function(t){return l(t.token)}).join(" -> ")+")"}return""}function _(t,e,n,r){var i=[e],o=n(i),a=r?function(t,e){var n=t+" caused by: "+(e instanceof Error?e.message:e),r=Error(n);return r[Rr]=e,r}(o,r):Error(o);return a.addKey=x,a.keys=i,a.injectors=[t],a.constructResolvingMessage=n,a[Rr]=r,a}function x(t,e){this.injectors.push(t),this.keys.push(e),this.message=this.constructResolvingMessage(this.keys)}function w(t,e){for(var n=[],r=0,i=e.length;r<i;r++){var o=e[r];n.push(o&&0!=o.length?o.map(l).join(" "):"?")}return Error("Cannot resolve all parameters for '"+l(t)+"'("+n.join(", ")+"). Make sure that all the parameters are decorated with Inject or have valid type annotations and that '"+l(t)+"' is decorated with Injectable.")}function S(t,e){return Error("Cannot mix multi providers and regular providers, got: "+t+" "+e)}function A(t){return"function"==typeof t}function M(t){return t?t.map(function(t){var e=t.type.annotationCls;return new(e.bind.apply(e,[void 0].concat(t.args?t.args:[])))}):[]}function T(t){var e=t.prototype?Object.getPrototypeOf(t.prototype):null;return(e?e.constructor:null)||Object}function C(t){var e,n;if(t.useClass){var r=c(t.useClass);e=Xr.factory(r),n=N(r)}else t.useExisting?(e=function(t){return t},n=[Yr.fromKey(jr.get(t.useExisting))]):t.useFactory?(e=t.useFactory,n=function(t,e){if(e){var n=e.map(function(t){return[t]});return e.map(function(e){return L(t,e,n)})}return N(t)}(t.useFactory,t.deps)):(e=function(){return t.useValue},n=qr);return new Qr(e,n)}function E(t){return new Zr(jr.get(t.provide),[C(t)],t.multi||!1)}function P(t){var e=function(t,e){for(var n=0;n<t.length;n++){var r=t[n],i=e.get(r.key.id);if(i){if(r.multiProvider!==i.multiProvider)throw S(i,r);if(r.multiProvider)for(var o=0;o<r.resolvedFactories.length;o++)i.resolvedFactories.push(r.resolvedFactories[o]);else e.set(r.key.id,r)}else{var a=void 0;a=r.multiProvider?new Zr(r.key,r.resolvedFactories.slice(),r.multiProvider):r,e.set(r.key.id,a)}}return e}(O(t,[]).map(E),new Map);return Array.from(e.values())}function O(t,e){return t.forEach(function(t){if(t instanceof zr)e.push({provide:t,useClass:t});else if(t&&"object"==typeof t&&void 0!==t.provide)e.push(t);else{if(!(t instanceof Array))throw function(t){return Error("Invalid provider - only instances of Provider and Type are allowed, got: "+t)}(t);O(t,e)}}),e}function N(t){var e=Xr.parameters(t);if(!e)return[];if(e.some(function(t){return null==t}))throw w(t,e);return e.map(function(n){return L(t,n,e)})}function L(t,e,n){var r=null,i=!1;if(!Array.isArray(e))return I(e instanceof ur?e.token:e,i,null);for(var o=null,a=0;a<e.length;++a){var s=e[a];s instanceof zr?r=s:s instanceof ur?r=s.token:s instanceof cr?i=!0:s instanceof hr||s instanceof pr?o=s:s instanceof er&&(r=s)}if(null!=(r=c(r)))return I(r,i,o);throw w(t,n)}function I(t,e,n){return new Yr(jr.get(t),e,n)}function D(t){return!!t&&"function"==typeof t.then}function F(t){return!!t&&"function"==typeof t.subscribe}function R(){return""+k()+k()+k()}function k(){return String.fromCharCode(97+Math.floor(25*Math.random()))}function U(){throw new Error("Runtime compiler is not loaded")}function j(t){var e=Error("No component factory found for "+l(t)+". Did you add it to @NgModule.entryComponents?");return e[hi]=t,e}function B(t,e){return null}function z(){}function V(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(function(){return t.onStable.emit(null)})}finally{t.isStable=!0}}}function G(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function H(t){t._nesting--,V(t)}function W(t){Ci=t}function X(){if(Pi)throw new Error("Cannot enable prod mode after platform setup.");Ei=!1}function Y(){return Pi=!0,Ei}function q(t,e,n){void 0===n&&(n=[]);var r="Platform: "+e,i=new er(r);return function(e){void 0===e&&(e=[]);var o=Z();if(!o||o.injector.get(Oi,!1))if(t)t(n.concat(e).concat({provide:i,useValue:!0}));else{var a=n.concat(e).concat({provide:i,useValue:!0});!function(t){if(Wn&&!Wn.destroyed&&!Wn.injector.get(Oi,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Wn=t.get(Li);var e=t.get(ri,null);e&&e.forEach(function(t){return t()})}(wr.create({providers:a,name:r}))}return function(t){var e=Z();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(i)}}function Z(){return Wn&&!Wn.destroyed?Wn:null}function Q(t,e){return t=Array.isArray(e)?e.reduce(Q,t):Object(Zn.__assign)({},t,e)}function J(t,e){var n=t.indexOf(e);n>-1&&t.splice(n,1)}function K(t){return t.reduce(function(t,e){var n=Array.isArray(e)?K(e):e;return t.concat(n)},[])}function $(t,e,n){t.childNodes.forEach(function(t){t instanceof Wi&&(e(t)&&n.push(t),$(t,e,n))})}function tt(t,e,n){t instanceof Wi&&t.childNodes.forEach(function(t){e(t)&&n.push(t),t instanceof Wi&&tt(t,e,n)})}function et(t){return Xi.get(t)||null}function nt(t){Xi.set(t.nativeNode,t)}function rt(t,e){var n=it(t),r=it(e);if(n&&r)return function(t,e,n){var r=t[o()](),i=e[o()]();for(;;){var a=r.next(),s=i.next();if(a.done&&s.done)return!0;if(a.done||s.done)return!1;if(!n(a.value,s.value))return!1}}(t,e,rt);return!(n||!(t&&("object"==typeof t||"function"==typeof t))||r||!(e&&("object"==typeof e||"function"==typeof e)))||s(t,e)}function it(t){return!!ot(t)&&(Array.isArray(t)||!(t instanceof Map)&&o()in t)}function ot(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function at(t,e,n){var r=t.previousIndex;if(null===r)return r;var i=0;return n&&r<n.length&&(i=n[r]),r+e+i}function st(){return so}function lt(){return lo}function ut(t){return t||"en-US"}function ct(t,e,n){var r=t.state,i=1792&r;return i===e?(t.state=-1793&r|n,t.initIndex=-1,!0):i===n}function ht(t,e,n){return(1792&t.state)===e&&t.initIndex<=n&&(t.initIndex=n+1,!0)}function pt(t,e){return t.nodes[e]}function dt(t,e){return t.nodes[e]}function ft(t,e){return t.nodes[e]}function mt(t,e){return t.nodes[e]}function vt(t,e){return t.nodes[e]}function gt(t,e,n,r){var i="ExpressionChangedAfterItHasBeenCheckedError: Expression has changed after it was checked. Previous value: '"+e+"'. Current value: '"+n+"'.";return r&&(i+=" It seems like the view has been created after its parent and its children have been dirty checked. Has it been created in a change detection hook ?"),function(t,e){var n=new Error(t);return yt(n,e),n}(i,t)}function yt(t,e){t[Fr]=e,t[kr]=e.logError.bind(e)}function bt(t){return new Error("ViewDestroyedError: Attempt to use a destroyed view: "+t)}function _t(t){var e=go.get(t);return e||(e=l(t)+"_"+go.size,go.set(t,e)),e}function xt(t,e,n,r){if(Yi.isWrapped(r)){r=Yi.unwrap(r);var i=t.def.nodes[e].bindingIndex+n,o=Yi.unwrap(t.oldValues[i]);t.oldValues[i]=new Yi(o)}return r}function wt(t){return{id:yo,styles:t.styles,encapsulation:t.encapsulation,data:t.data}}function St(t){if(t&&t.id===yo){var e=null!=t.encapsulation&&t.encapsulation!==ar.None||t.styles.length||Object.keys(t.data).length;t.id=e?"c"+_o++:bo}return t&&t.id===bo&&(t=null),t||null}function At(t,e,n,r){return!(!(2&t.state)&&s(t.oldValues[e.bindingIndex+n],r))}function Mt(t,e,n,r){return!!At(t,e,n,r)&&(t.oldValues[e.bindingIndex+n]=r,!0)}function Tt(t,e,n,r){var i=t.oldValues[e.bindingIndex+n];if(1&t.state||!rt(i,r)){var o=e.bindings[n].name;throw gt(mo.createDebugContext(t,e.nodeIndex),o+": "+i,o+": "+r,0!=(1&t.state))}}function Ct(t){for(var e=t;e;)2&e.def.flags&&(e.state|=8),e=e.viewContainerParent||e.parent}function Et(t,e){for(var n=t;n&&n!==e;)n.state|=64,n=n.viewContainerParent||n.parent}function Pt(t,e,n,r){try{return Ct(33554432&t.def.nodes[e].flags?dt(t,e).componentView:t),mo.handleEvent(t,e,n,r)}catch(e){t.root.errorHandler.handleError(e)}}function Ot(t){if(t.parent){return dt(t.parent,t.parentNodeDef.nodeIndex)}return null}function Nt(t){return t.parent?t.parentNodeDef.parent:null}function Lt(t,e){switch(201347067&e.flags){case 1:return dt(t,e.nodeIndex).renderElement;case 2:return pt(t,e.nodeIndex).renderText}}function It(t,e){return t?t+":"+e:e}function Dt(t){return!!t.parent&&!!(32768&t.parentNodeDef.flags)}function Ft(t){return!(!t.parent||32768&t.parentNodeDef.flags)}function Rt(t){return 1<<t%32}function kt(t){var e={},n=0,r={};return t&&t.forEach(function(t){var i=t[0],o=t[1];"number"==typeof i?(e[i]=o,n|=Rt(i)):r[i]=o}),{matchedQueries:e,references:r,matchedQueryIds:n}}function Ut(t,e){return t.map(function(t){var n,r;return Array.isArray(t)?(r=t[0],n=t[1]):(r=0,n=t),n&&("function"==typeof n||"object"==typeof n)&&e&&Object.defineProperty(n,yr,{value:e,configurable:!0}),{flags:r,token:n,tokenKey:_t(n)}})}function jt(t,e,n){var r=n.renderParent;return r?0==(1&r.flags)||0==(33554432&r.flags)||r.element.componentRendererType&&r.element.componentRendererType.encapsulation===ar.Native?dt(t,n.renderParent.nodeIndex).renderElement:void 0:e}function Bt(t){var e=xo.get(t);return e||((e=t(function(){return vo})).factory=t,xo.set(t,e)),e}function zt(t,e,n,r,i){3===e&&(n=t.renderer.parentNode(Lt(t,t.def.lastRenderRootNode))),Vt(t,e,0,t.def.nodes.length-1,n,r,i)}function Vt(t,e,n,r,i,o,a){for(var s=n;s<=r;s++){var l=t.def.nodes[s];11&l.flags&&Ht(t,l,e,i,o,a),s+=l.childCount}}function Gt(t,e,n,r,i,o){for(var a=t;a&&!Dt(a);)a=a.parent;for(var s=a.parent,l=Nt(a),u=l.nodeIndex+l.childCount,c=l.nodeIndex+1;c<=u;c++){var h=s.def.nodes[c];h.ngContentIndex===e&&Ht(s,h,n,r,i,o),c+=h.childCount}if(!s.parent){var p=t.root.projectableNodes[e];if(p)for(c=0;c<p.length;c++)Wt(t,p[c],n,r,i,o)}}function Ht(t,e,n,r,i,o){if(8&e.flags)Gt(t,e.ngContent.index,n,r,i,o);else{var a=Lt(t,e);if(3===n&&33554432&e.flags&&48&e.bindingFlags){if(16&e.bindingFlags&&Wt(t,a,n,r,i,o),32&e.bindingFlags){Wt(dt(t,e.nodeIndex).componentView,a,n,r,i,o)}}else Wt(t,a,n,r,i,o);if(16777216&e.flags)for(var s=dt(t,e.nodeIndex).viewContainer._embeddedViews,l=0;l<s.length;l++)zt(s[l],n,r,i,o);1&e.flags&&!e.element.name&&Vt(t,n,e.nodeIndex+1,e.nodeIndex+e.childCount,r,i,o)}}function Wt(t,e,n,r,i,o){var a=t.renderer;switch(n){case 1:a.appendChild(r,e);break;case 2:a.insertBefore(r,e,i);break;case 3:a.removeChild(r,e);break;case 0:o.push(e)}}function Xt(t){if(":"===t[0]){var e=t.match(wo);return[e[1],e[2]]}return["",t]}function Yt(t){for(var e=0,n=0;n<t.length;n++)e|=t[n].flags;return e}function qt(t,e,n,r,i,o,a,s,l,u,c,h,p,d,f,m,v,g,y,b){switch(t){case 1:return e+Zt(n)+r;case 2:return e+Zt(n)+r+Zt(i)+o;case 3:return e+Zt(n)+r+Zt(i)+o+Zt(a)+s;case 4:return e+Zt(n)+r+Zt(i)+o+Zt(a)+s+Zt(l)+u;case 5:return e+Zt(n)+r+Zt(i)+o+Zt(a)+s+Zt(l)+u+Zt(c)+h;case 6:return e+Zt(n)+r+Zt(i)+o+Zt(a)+s+Zt(l)+u+Zt(c)+h+Zt(p)+d;case 7:return e+Zt(n)+r+Zt(i)+o+Zt(a)+s+Zt(l)+u+Zt(c)+h+Zt(p)+d+Zt(f)+m;case 8:return e+Zt(n)+r+Zt(i)+o+Zt(a)+s+Zt(l)+u+Zt(c)+h+Zt(p)+d+Zt(f)+m+Zt(v)+g;case 9:return e+Zt(n)+r+Zt(i)+o+Zt(a)+s+Zt(l)+u+Zt(c)+h+Zt(p)+d+Zt(f)+m+Zt(v)+g+Zt(y)+b;default:throw new Error("Does not support more than 9 expressions")}}function Zt(t){return null!=t?t.toString():""}function Qt(t,e,n,r,i,o){t|=1;var a=kt(e);return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,flags:t,checkIndex:-1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:a.matchedQueries,matchedQueryIds:a.matchedQueryIds,references:a.references,ngContentIndex:n,childCount:r,bindings:[],bindingFlags:0,outputs:[],element:{ns:null,name:null,attrs:null,template:o?Bt(o):null,componentProvider:null,componentView:null,componentRendererType:null,publicProviders:null,allProviders:null,handleEvent:i||vo},provider:null,text:null,query:null,ngContent:null}}function Jt(t,e,n,r,i,o,a,s,l,u,c,h){void 0===a&&(a=[]),u||(u=vo);var p=kt(n),d=p.matchedQueries,f=p.references,m=p.matchedQueryIds,v=null,g=null;o&&(v=(O=Xt(o))[0],g=O[1]),s=s||[];for(var y=new Array(s.length),b=0;b<s.length;b++){var _=s[b],x=_[0],w=_[2],S=Xt(_[1]),A=S[1],M=void 0,T=void 0;switch(15&x){case 4:T=w;break;case 1:case 8:M=w}y[b]={flags:x,ns:S[0],name:A,nonMinifiedName:A,securityContext:M,suffix:T}}l=l||[];var C=new Array(l.length);for(b=0;b<l.length;b++){var E=l[b];C[b]={type:0,target:E[0],eventName:E[1],propName:null}}var P=(a=a||[]).map(function(t){var e=t[1],n=Xt(t[0]);return[n[0],n[1],e]});return h=St(h),c&&(e|=33554432),e|=1,{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:e,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:d,matchedQueryIds:m,references:f,ngContentIndex:r,childCount:i,bindings:y,bindingFlags:Yt(y),outputs:C,element:{ns:v,name:g,attrs:P,template:null,componentProvider:null,componentView:c||null,componentRendererType:h,publicProviders:null,allProviders:null,handleEvent:u||vo},provider:null,text:null,query:null,ngContent:null};var O}function Kt(t,e,n){var r,i=n.element,o=t.root.selectorOrNode,a=t.renderer;if(t.parent||!o){r=i.name?a.createElement(i.name,i.ns):a.createComment("");var s=jt(t,e,n);s&&a.appendChild(s,r)}else r=a.selectRootElement(o);if(i.attrs)for(var l=0;l<i.attrs.length;l++){var u=i.attrs[l];a.setAttribute(r,u[1],u[2],u[0])}return r}function $t(t,e,n,r){for(var i=0;i<n.outputs.length;i++){var o=n.outputs[i],a=function(t,e,n){return function(r){return Pt(t,e,n,r)}}(t,n.nodeIndex,It(o.target,o.eventName)),s=o.target,l=t;"component"===o.target&&(s=null,l=e);var u=l.renderer.listen(s||r,o.eventName,a);t.disposables[n.outputIndex+i]=u}}function te(t,e,n,r){if(!Mt(t,e,n,r))return!1;var i=e.bindings[n],o=dt(t,e.nodeIndex),a=o.renderElement,s=i.name;switch(15&i.flags){case 1:!function(t,e,n,r,i,o){var a=e.securityContext,s=a?t.root.sanitizer.sanitize(a,o):o;s=null!=s?s.toString():null;var l=t.renderer;null!=o?l.setAttribute(n,i,s,r):l.removeAttribute(n,i,r)}(t,i,a,i.ns,s,r);break;case 2:!function(t,e,n,r){var i=t.renderer;r?i.addClass(e,n):i.removeClass(e,n)}(t,a,s,r);break;case 4:!function(t,e,n,r,i){var o=t.root.sanitizer.sanitize(po.STYLE,i);if(null!=o){o=o.toString();var a=e.suffix;null!=a&&(o+=a)}else o=null;var s=t.renderer;null!=o?s.setStyle(n,r,o):s.removeStyle(n,r)}(t,i,a,s,r);break;case 8:!function(t,e,n,r,i){var o=e.securityContext,a=o?t.root.sanitizer.sanitize(o,i):i;t.renderer.setProperty(n,r,a)}(33554432&e.flags&&32&i.flags?o.componentView:t,i,a,s,r)}return!0}function ee(t,e,n,r){n=c(n);return{index:-1,deps:Ut(r,l(e)),flags:t,token:e,value:n}}function ne(t){for(var e={},n=0;n<t.length;n++){var r=t[n];r.index=n,e[_t(r.token)]=r}return{factory:null,providersByKey:e,providers:t}}function re(t,e,n){if(void 0===n&&(n=wr.THROW_IF_NOT_FOUND),8&e.flags)return e.token;if(2&e.flags&&(n=null),1&e.flags)return t._parent.get(e.token,n);var r=e.tokenKey;switch(r){case Ao:case Mo:return t}var i=t._def.providersByKey[r];if(i){var o=t._providers[i.index];return void 0===o&&(o=t._providers[i.index]=ie(t,i)),o===So?void 0:o}return t._parent.get(e.token,n)}function ie(t,e){var n;switch(201347067&e.flags){case 512:n=function(t,e,n){var r=n.length;switch(r){case 0:return new e;case 1:return new e(re(t,n[0]));case 2:return new e(re(t,n[0]),re(t,n[1]));case 3:return new e(re(t,n[0]),re(t,n[1]),re(t,n[2]));default:for(var i=new Array(r),o=0;o<r;o++)i[o]=re(t,n[o]);return new(e.bind.apply(e,[void 0].concat(i)))}}(t,e.value,e.deps);break;case 1024:n=function(t,e,n){var r=n.length;switch(r){case 0:return e();case 1:return e(re(t,n[0]));case 2:return e(re(t,n[0]),re(t,n[1]));case 3:return e(re(t,n[0]),re(t,n[1]),re(t,n[2]));default:for(var i=Array(r),o=0;o<r;o++)i[o]=re(t,n[o]);return e.apply(void 0,i)}}(t,e.value,e.deps);break;case 2048:n=re(t,e.deps[0]);break;case 256:n=e.value}return void 0===n?So:n}function oe(t,e,n,r){var i=e.viewContainer._embeddedViews;null!==n&&void 0!==n||(n=i.length),r.viewContainerParent=t,ue(i,n,r),function(t,e){var n=Ot(e);if(!n||n===t||16&e.state)return;e.state|=16;var r=n.template._projectedViews;r||(r=n.template._projectedViews=[]);r.push(e),function(t,e){if(4&e.flags)return;t.nodeFlags|=4,e.flags|=4;var n=e.parent;for(;n;)n.childFlags|=4,n=n.parent}(e.parent.def,e.parentNodeDef)}(e,r),mo.dirtyParentQueries(r);se(e,n>0?i[n-1]:null,r)}function ae(t,e){var n=t.viewContainer._embeddedViews;if((null==e||e>=n.length)&&(e=n.length-1),e<0)return null;var r=n[e];return r.viewContainerParent=null,ce(n,e),mo.dirtyParentQueries(r),le(r),r}function se(t,e,n){var r=e?Lt(e,e.def.lastRenderRootNode):t.renderElement;zt(n,2,n.renderer.parentNode(r),n.renderer.nextSibling(r),void 0)}function le(t){zt(t,3,null,null,void 0)}function ue(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function ce(t,e){e>=t.length-1?t.pop():t.splice(e,1)}function he(t,e,n,r,i,o){return new Co(t,e,n,r,i,o)}function pe(t,e,n){return new Po(t,e,n)}function de(t){return new Oo(t)}function fe(t,e){return new No(t,e)}function me(t,e){return new Lo(t,e)}function ve(t,e){var n=t.def.nodes[e];if(1&n.flags){var r=dt(t,n.nodeIndex);return n.element.template?r.template:r.renderElement}if(2&n.flags)return pt(t,n.nodeIndex).renderText;if(20240&n.flags)return ft(t,n.nodeIndex).instance;throw new Error("Illegal state: read nodeValue for node index "+e)}function ge(t){return new Io(t.renderer)}function ye(t,e,n,r){return new Do(t,e,n,r)}function be(t,e,n,r,i,o,a,s){var l=[];if(a)for(var u in a){var c=a[u];l[c[0]]={flags:8,name:u,nonMinifiedName:c[1],ns:null,securityContext:null,suffix:null}}var h=[];if(s)for(var p in s)h.push({type:1,propName:p,target:null,eventName:s[p]});return e|=16384,we(t,e,n,r,i,i,o,l,h)}function _e(t,e,n){return t|=16,we(-1,t,null,0,e,e,n)}function xe(t,e,n,r,i){return we(-1,t,e,0,n,r,i)}function we(t,e,n,r,i,o,a,s,u){var h=kt(n),p=h.matchedQueries,d=h.references,f=h.matchedQueryIds;u||(u=[]),s||(s=[]),o=c(o);var m=Ut(a,l(i));return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:e,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:p,matchedQueryIds:f,references:d,ngContentIndex:-1,childCount:r,bindings:s,bindingFlags:Yt(s),outputs:u,element:null,provider:{token:i,value:o,deps:m},text:null,query:null,ngContent:null}}function Se(t,e){return Te(t,e)}function Ae(t,e){for(var n=t;n.parent&&!Dt(n);)n=n.parent;return Ce(n.parent,Nt(n),!0,e.provider.value,e.provider.deps)}function Me(t,e){var n=Ce(t,e.parent,(32768&e.flags)>0,e.provider.value,e.provider.deps);if(e.outputs.length)for(var r=0;r<e.outputs.length;r++){var i=e.outputs[r],o=n[i.propName].subscribe(function(t,e,n){return function(r){return Pt(t,e,n,r)}}(t,e.parent.nodeIndex,i.eventName));t.disposables[e.outputIndex+r]=o.unsubscribe.bind(o)}return n}function Te(t,e){var n=(8192&e.flags)>0,r=e.provider;switch(201347067&e.flags){case 512:return Ce(t,e.parent,n,r.value,r.deps);case 1024:return function(t,e,n,r,i){var o=i.length;switch(o){case 0:return r();case 1:return r(Ee(t,e,n,i[0]));case 2:return r(Ee(t,e,n,i[0]),Ee(t,e,n,i[1]));case 3:return r(Ee(t,e,n,i[0]),Ee(t,e,n,i[1]),Ee(t,e,n,i[2]));default:for(var a=Array(o),s=0;s<o;s++)a[s]=Ee(t,e,n,i[s]);return r.apply(void 0,a)}}(t,e.parent,n,r.value,r.deps);case 2048:return Ee(t,e.parent,n,r.deps[0]);case 256:return r.value}}function Ce(t,e,n,r,i){var o=i.length;switch(o){case 0:return new r;case 1:return new r(Ee(t,e,n,i[0]));case 2:return new r(Ee(t,e,n,i[0]),Ee(t,e,n,i[1]));case 3:return new r(Ee(t,e,n,i[0]),Ee(t,e,n,i[1]),Ee(t,e,n,i[2]));default:for(var a=new Array(o),s=0;s<o;s++)a[s]=Ee(t,e,n,i[s]);return new(r.bind.apply(r,[void 0].concat(a)))}}function Ee(t,e,n,r,i){if(void 0===i&&(i=wr.THROW_IF_NOT_FOUND),8&r.flags)return r.token;var o=t;2&r.flags&&(i=null);var a=r.tokenKey;for(a===Bo&&(n=!(!e||!e.element.componentView)),e&&1&r.flags&&(n=!1,e=e.parent);t;){if(e)switch(a){case Fo:return ge(Pe(t,e,n));case Ro:return Pe(t,e,n).renderer;case ko:return new Ui(dt(t,e.nodeIndex).renderElement);case Uo:return dt(t,e.nodeIndex).viewContainer;case jo:if(e.element.template)return dt(t,e.nodeIndex).template;break;case Bo:return de(Pe(t,e,n));case zo:return me(t,e);default:var s=(n?e.element.allProviders:e.element.publicProviders)[a];if(s){var l=ft(t,s.nodeIndex);return l||(l={instance:Te(t,s)},t.nodes[s.nodeIndex]=l),l.instance}}n=Dt(t),e=Nt(t),t=t.parent}var u=o.root.injector.get(r.token,Vo);return u!==Vo||i===Vo?u:o.root.ngModule.injector.get(r.token,i)}function Pe(t,e,n){var r;if(n)r=dt(t,e.nodeIndex).componentView;else for(r=t;r.parent&&!Dt(r);)r=r.parent;return r}function Oe(t,e,n,r,i,o){if(32768&n.flags){var a=dt(t,n.parent.nodeIndex).componentView;2&a.def.flags&&(a.state|=8)}if(e.instance[n.bindings[r].name]=i,524288&n.flags){o=o||{};var s=Yi.unwrap(t.oldValues[n.bindingIndex+r]);o[n.bindings[r].nonMinifiedName]=new qi(s,i,0!=(2&t.state))}return t.oldValues[n.bindingIndex+r]=i,o}function Ne(t,e){if(t.def.nodeFlags&e)for(var n=t.def.nodes,r=0,i=0;i<n.length;i++){var o=n[i],a=o.parent;for(!a&&o.flags&e&&Le(t,i,o.flags&e,r++),0==(o.childFlags&e)&&(i+=o.childCount);a&&1&a.flags&&i===a.nodeIndex+a.childCount;)a.directChildFlags&e&&(r=function(t,e,n,r){for(var i=e.nodeIndex+1;i<=e.nodeIndex+e.childCount;i++){var o=t.def.nodes[i];o.flags&n&&Le(t,i,o.flags&n,r++),i+=o.childCount}return r}(t,a,e,r)),a=a.parent}}function Le(t,e,n,r){var i=ft(t,e);if(i){var o=i.instance;o&&(mo.setCurrentNode(t,e),1048576&n&&ht(t,512,r)&&o.ngAfterContentInit(),2097152&n&&o.ngAfterContentChecked(),4194304&n&&ht(t,768,r)&&o.ngAfterViewInit(),8388608&n&&o.ngAfterViewChecked(),131072&n&&o.ngOnDestroy())}}function Ie(t,e,n){var r=[];for(var i in n){r.push({propName:i,bindingType:n[i]})}return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:-1,flags:t,childFlags:0,directChildFlags:0,childMatchedQueries:0,ngContentIndex:-1,matchedQueries:{},matchedQueryIds:0,references:{},childCount:0,bindings:[],bindingFlags:0,outputs:[],element:null,provider:null,text:null,query:{id:e,filterId:Rt(e),bindings:r},ngContent:null}}function De(){return new ji}function Fe(t){for(var e=t.def.nodeMatchedQueries;t.parent&&Ft(t);){var n=t.parentNodeDef;t=t.parent;for(var r=n.nodeIndex+n.childCount,i=0;i<=r;i++){67108864&(o=t.def.nodes[i]).flags&&536870912&o.flags&&(o.query.filterId&e)===o.query.filterId&&vt(t,i).setDirty(),!(1&o.flags&&i+o.childCount<n.nodeIndex)&&67108864&o.childFlags&&536870912&o.childFlags||(i+=o.childCount)}}if(134217728&t.def.nodeFlags)for(i=0;i<t.def.nodes.length;i++){var o;134217728&(o=t.def.nodes[i]).flags&&536870912&o.flags&&vt(t,i).setDirty(),i+=o.childCount}}function Re(t,e){var n=vt(t,e.nodeIndex);if(n.dirty){var r,i=void 0;if(67108864&e.flags){var o=e.parent.parent;i=ke(t,o.nodeIndex,o.nodeIndex+o.childCount,e.query,[]),r=ft(t,e.parent.nodeIndex).instance}else 134217728&e.flags&&(i=ke(t,0,t.def.nodes.length-1,e.query,[]),r=t.component);n.reset(i);for(var a=e.query.bindings,s=!1,l=0;l<a.length;l++){var u=a[l],c=void 0;switch(u.bindingType){case 0:c=n.first;break;case 1:c=n,s=!0}r[u.propName]=c}s&&n.notifyOnChanges()}}function ke(t,e,n,r,i){for(var o=e;o<=n;o++){var a=t.def.nodes[o],s=a.matchedQueries[r.id];if(null!=s&&i.push(Ue(t,a,s)),1&a.flags&&a.element.template&&(a.element.template.nodeMatchedQueries&r.filterId)===r.filterId){var l=dt(t,o);if((a.childMatchedQueries&r.filterId)===r.filterId&&(ke(t,o+1,o+a.childCount,r,i),o+=a.childCount),16777216&a.flags)for(var u=l.viewContainer._embeddedViews,c=0;c<u.length;c++){var h=u[c],p=Ot(h);p&&p===l&&ke(h,0,h.def.nodes.length-1,r,i)}var d=l.template._projectedViews;if(d)for(c=0;c<d.length;c++){var f=d[c];ke(f,0,f.def.nodes.length-1,r,i)}}(a.childMatchedQueries&r.filterId)!==r.filterId&&(o+=a.childCount)}return i}function Ue(t,e,n){if(null!=n)switch(n){case 1:return dt(t,e.nodeIndex).renderElement;case 0:return new Ui(dt(t,e.nodeIndex).renderElement);case 2:return dt(t,e.nodeIndex).template;case 3:return dt(t,e.nodeIndex).viewContainer;case 4:return ft(t,e.nodeIndex).instance}}function je(t,e){return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:-1,flags:8,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:t,childCount:0,bindings:[],bindingFlags:0,outputs:[],element:null,provider:null,text:null,query:null,ngContent:{index:e}}}function Be(t,e,n){var r=jt(t,e,n);if(r){Gt(t,n.ngContent.index,1,r,null,void 0)}}function ze(t,e){return Ge(128,t,new Array(e+1))}function Ve(t,e){for(var n=Object.keys(e),r=n.length,i=new Array(r),o=0;o<r;o++){var a=n[o];i[e[a]]=a}return Ge(64,t,i)}function Ge(t,e,n){for(var r=new Array(n.length),i=0;i<n.length;i++){var o=n[i];r[i]={flags:8,name:o,ns:null,nonMinifiedName:o,securityContext:null,suffix:null}}return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:e,flags:t,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:-1,childCount:0,bindings:r,bindingFlags:Yt(r),outputs:[],element:null,provider:null,text:null,query:null,ngContent:null}}function He(t,e,n){for(var r=new Array(n.length-1),i=1;i<n.length;i++)r[i-1]={flags:8,name:null,ns:null,nonMinifiedName:null,securityContext:null,suffix:n[i]};return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:2,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:e,childCount:0,bindings:r,bindingFlags:8,outputs:[],element:null,provider:null,text:{prefix:n[0]},query:null,ngContent:null}}function We(t,e,n){var r,i=t.renderer;r=i.createText(n.text.prefix);var o=jt(t,e,n);return o&&i.appendChild(o,r),{renderText:r}}function Xe(t,e){return(null!=t?t.toString():"")+e.suffix}function Ye(t,e,n,r){for(var i=0,o=0,a=0,s=0,l=0,u=null,c=null,h=!1,p=!1,d=null,f=0;f<e.length;f++){var m=e[f];if(m.nodeIndex=f,m.parent=u,m.bindingIndex=i,m.outputIndex=o,m.renderParent=c,a|=m.flags,l|=m.matchedQueryIds,m.element){var v=m.element;v.publicProviders=u?u.element.publicProviders:Object.create(null),v.allProviders=v.publicProviders,h=!1,p=!1,m.element.template&&(l|=m.element.template.nodeMatchedQueries)}if(function(t,e,n){var r=e.element&&e.element.template;if(r){if(!r.lastRenderRootNode)throw new Error("Illegal State: Embedded templates without nodes are not allowed!");if(r.lastRenderRootNode&&16777216&r.lastRenderRootNode.flags)throw new Error("Illegal State: Last root node of a template can't have embedded views, at index "+e.nodeIndex+"!")}if(20224&e.flags){var i=t?t.flags:0;if(0==(1&i))throw new Error("Illegal State: StaticProvider/Directive nodes need to be children of elements or anchors, at index "+e.nodeIndex+"!")}if(e.query){if(67108864&e.flags&&(!t||0==(16384&t.flags)))throw new Error("Illegal State: Content Query nodes need to be children of directives, at index "+e.nodeIndex+"!");if(134217728&e.flags&&t)throw new Error("Illegal State: View Query nodes have to be top level nodes, at index "+e.nodeIndex+"!")}if(e.childCount){var o=t?t.nodeIndex+t.childCount:n-1;if(e.nodeIndex<=o&&e.nodeIndex+e.childCount>o)throw new Error("Illegal State: childCount of node leads outside of parent, at index "+e.nodeIndex+"!")}}(u,m,e.length),i+=m.bindings.length,o+=m.outputs.length,!c&&3&m.flags&&(d=m),20224&m.flags){h||(h=!0,u.element.publicProviders=Object.create(u.element.publicProviders),u.element.allProviders=u.element.publicProviders);var g=0!=(32768&m.flags);!(0!=(8192&m.flags))||g?u.element.publicProviders[_t(m.provider.token)]=m:(p||(p=!0,u.element.allProviders=Object.create(u.element.publicProviders)),u.element.allProviders[_t(m.provider.token)]=m),g&&(u.element.componentProvider=m)}if(u?(u.childFlags|=m.flags,u.directChildFlags|=m.flags,u.childMatchedQueries|=m.matchedQueryIds,m.element&&m.element.template&&(u.childMatchedQueries|=m.element.template.nodeMatchedQueries)):s|=m.flags,m.childCount>0)u=m,qe(m)||(c=m);else for(;u&&f===u.nodeIndex+u.childCount;){var y=u.parent;y&&(y.childFlags|=u.childFlags,y.childMatchedQueries|=u.childMatchedQueries),c=(u=y)&&qe(u)?u.renderParent:u}}return{factory:null,nodeFlags:a,rootNodeFlags:s,nodeMatchedQueries:l,flags:t,nodes:e,updateDirectives:n||vo,updateRenderer:r||vo,handleEvent:function(t,n,r,i){return e[n].element.handleEvent(t,r,i)},bindingCount:i,outputCount:o,lastRenderRootNode:d}}function qe(t){return 0!=(1&t.flags)&&null===t.element.name}function Ze(t,e,n,r){var i=Ke(t.root,t.renderer,t,e,n);return $e(i,t.component,r),tn(i),i}function Qe(t,e,n){var r=Ke(t,t.renderer,null,null,e);return $e(r,n,n),tn(r),r}function Je(t,e,n,r){var i,o=e.element.componentRendererType;return i=o?t.root.rendererFactory.createRenderer(r,o):t.root.renderer,Ke(t.root,i,t,e.element.componentProvider,n)}function Ke(t,e,n,r,i){var o=new Array(i.nodes.length),a=i.outputCount?new Array(i.outputCount):null;return{def:i,parent:n,viewContainerParent:null,parentNodeDef:r,context:null,component:null,nodes:o,state:13,root:t,renderer:e,oldValues:new Array(i.bindingCount),disposables:a,initIndex:-1}}function $e(t,e,n){t.component=e,t.context=n}function tn(t){var e;if(Dt(t)){e=dt(t.parent,t.parentNodeDef.parent.nodeIndex).renderElement}for(var n=t.def,r=t.nodes,i=0;i<n.nodes.length;i++){var o=n.nodes[i];mo.setCurrentNode(t,i);var a=void 0;switch(201347067&o.flags){case 1:var s=Kt(t,e,o),l=void 0;if(33554432&o.flags){var u=Bt(o.element.componentView);l=mo.createComponentView(t,o,u,s)}$t(t,l,o,s),a={renderElement:s,componentView:l,viewContainer:null,template:o.element.template?fe(t,o):void 0},16777216&o.flags&&(a.viewContainer=pe(t,o,a));break;case 2:a=We(t,e,o);break;case 512:case 1024:case 2048:case 256:if(!((a=r[i])||4096&o.flags)){a={instance:Se(t,o)}}break;case 16:a={instance:Ae(t,o)};break;case 16384:if(!(a=r[i])){a={instance:Me(t,o)}}if(32768&o.flags){$e(dt(t,o.parent.nodeIndex).componentView,a.instance,a.instance)}break;case 32:case 64:case 128:a={value:void 0};break;case 67108864:case 134217728:a=De();break;case 8:Be(t,e,o),a=void 0}r[i]=a}un(t,Go.CreateViewNodes),dn(t,201326592,268435456,0)}function en(t){on(t),mo.updateDirectives(t,1),cn(t,Go.CheckNoChanges),mo.updateRenderer(t,1),un(t,Go.CheckNoChanges),t.state&=-97}function nn(t){1&t.state?(t.state&=-2,t.state|=2):t.state&=-3,ct(t,0,256),on(t),mo.updateDirectives(t,0),cn(t,Go.CheckAndUpdate),dn(t,67108864,536870912,0);var e=ct(t,256,512);Ne(t,2097152|(e?1048576:0)),mo.updateRenderer(t,0),un(t,Go.CheckAndUpdate),dn(t,134217728,536870912,0),Ne(t,8388608|((e=ct(t,512,768))?4194304:0)),2&t.def.flags&&(t.state&=-9),t.state&=-97,ct(t,768,1024)}function rn(t,e,n,r,i,o,a,s,l,u,c,h,p){return 0===n?function(t,e,n,r,i,o,a,s,l,u,c,h){switch(201347067&e.flags){case 1:return function(t,e,n,r,i,o,a,s,l,u,c,h){var p=e.bindings.length,d=!1;return p>0&&te(t,e,0,n)&&(d=!0),p>1&&te(t,e,1,r)&&(d=!0),p>2&&te(t,e,2,i)&&(d=!0),p>3&&te(t,e,3,o)&&(d=!0),p>4&&te(t,e,4,a)&&(d=!0),p>5&&te(t,e,5,s)&&(d=!0),p>6&&te(t,e,6,l)&&(d=!0),p>7&&te(t,e,7,u)&&(d=!0),p>8&&te(t,e,8,c)&&(d=!0),p>9&&te(t,e,9,h)&&(d=!0),d}(t,e,n,r,i,o,a,s,l,u,c,h);case 2:return function(t,e,n,r,i,o,a,s,l,u,c,h){var p=!1,d=e.bindings,f=d.length;if(f>0&&Mt(t,e,0,n)&&(p=!0),f>1&&Mt(t,e,1,r)&&(p=!0),f>2&&Mt(t,e,2,i)&&(p=!0),f>3&&Mt(t,e,3,o)&&(p=!0),f>4&&Mt(t,e,4,a)&&(p=!0),f>5&&Mt(t,e,5,s)&&(p=!0),f>6&&Mt(t,e,6,l)&&(p=!0),f>7&&Mt(t,e,7,u)&&(p=!0),f>8&&Mt(t,e,8,c)&&(p=!0),f>9&&Mt(t,e,9,h)&&(p=!0),p){var m=e.text.prefix;f>0&&(m+=Xe(n,d[0])),f>1&&(m+=Xe(r,d[1])),f>2&&(m+=Xe(i,d[2])),f>3&&(m+=Xe(o,d[3])),f>4&&(m+=Xe(a,d[4])),f>5&&(m+=Xe(s,d[5])),f>6&&(m+=Xe(l,d[6])),f>7&&(m+=Xe(u,d[7])),f>8&&(m+=Xe(c,d[8])),f>9&&(m+=Xe(h,d[9]));var v=pt(t,e.nodeIndex).renderText;t.renderer.setValue(v,m)}return p}(t,e,n,r,i,o,a,s,l,u,c,h);case 16384:return function(t,e,n,r,i,o,a,s,l,u,c,h){var p=ft(t,e.nodeIndex),d=p.instance,f=!1,m=void 0,v=e.bindings.length;return v>0&&At(t,e,0,n)&&(f=!0,m=Oe(t,p,e,0,n,m)),v>1&&At(t,e,1,r)&&(f=!0,m=Oe(t,p,e,1,r,m)),v>2&&At(t,e,2,i)&&(f=!0,m=Oe(t,p,e,2,i,m)),v>3&&At(t,e,3,o)&&(f=!0,m=Oe(t,p,e,3,o,m)),v>4&&At(t,e,4,a)&&(f=!0,m=Oe(t,p,e,4,a,m)),v>5&&At(t,e,5,s)&&(f=!0,m=Oe(t,p,e,5,s,m)),v>6&&At(t,e,6,l)&&(f=!0,m=Oe(t,p,e,6,l,m)),v>7&&At(t,e,7,u)&&(f=!0,m=Oe(t,p,e,7,u,m)),v>8&&At(t,e,8,c)&&(f=!0,m=Oe(t,p,e,8,c,m)),v>9&&At(t,e,9,h)&&(f=!0,m=Oe(t,p,e,9,h,m)),m&&d.ngOnChanges(m),65536&e.flags&&ht(t,256,e.nodeIndex)&&d.ngOnInit(),262144&e.flags&&d.ngDoCheck(),f}(t,e,n,r,i,o,a,s,l,u,c,h);case 32:case 64:case 128:return function(t,e,n,r,i,o,a,s,l,u,c,h){var p=e.bindings,d=!1,f=p.length;if(f>0&&Mt(t,e,0,n)&&(d=!0),f>1&&Mt(t,e,1,r)&&(d=!0),f>2&&Mt(t,e,2,i)&&(d=!0),f>3&&Mt(t,e,3,o)&&(d=!0),f>4&&Mt(t,e,4,a)&&(d=!0),f>5&&Mt(t,e,5,s)&&(d=!0),f>6&&Mt(t,e,6,l)&&(d=!0),f>7&&Mt(t,e,7,u)&&(d=!0),f>8&&Mt(t,e,8,c)&&(d=!0),f>9&&Mt(t,e,9,h)&&(d=!0),d){var m=mt(t,e.nodeIndex),v=void 0;switch(201347067&e.flags){case 32:v=new Array(p.length),f>0&&(v[0]=n),f>1&&(v[1]=r),f>2&&(v[2]=i),f>3&&(v[3]=o),f>4&&(v[4]=a),f>5&&(v[5]=s),f>6&&(v[6]=l),f>7&&(v[7]=u),f>8&&(v[8]=c),f>9&&(v[9]=h);break;case 64:v={},f>0&&(v[p[0].name]=n),f>1&&(v[p[1].name]=r),f>2&&(v[p[2].name]=i),f>3&&(v[p[3].name]=o),f>4&&(v[p[4].name]=a),f>5&&(v[p[5].name]=s),f>6&&(v[p[6].name]=l),f>7&&(v[p[7].name]=u),f>8&&(v[p[8].name]=c),f>9&&(v[p[9].name]=h);break;case 128:var g=n;switch(f){case 1:v=g.transform(n);break;case 2:v=g.transform(r);break;case 3:v=g.transform(r,i);break;case 4:v=g.transform(r,i,o);break;case 5:v=g.transform(r,i,o,a);break;case 6:v=g.transform(r,i,o,a,s);break;case 7:v=g.transform(r,i,o,a,s,l);break;case 8:v=g.transform(r,i,o,a,s,l,u);break;case 9:v=g.transform(r,i,o,a,s,l,u,c);break;case 10:v=g.transform(r,i,o,a,s,l,u,c,h)}}m.value=v}return d}(t,e,n,r,i,o,a,s,l,u,c,h);default:throw"unreachable"}}(t,e,r,i,o,a,s,l,u,c,h,p):function(t,e,n){switch(201347067&e.flags){case 1:return function(t,e,n){for(var r=!1,i=0;i<n.length;i++)te(t,e,i,n[i])&&(r=!0);return r}(t,e,n);case 2:return function(t,e,n){for(var r=e.bindings,i=!1,o=0;o<n.length;o++)Mt(t,e,o,n[o])&&(i=!0);if(i){var a="";for(o=0;o<n.length;o++)a+=Xe(n[o],r[o]);a=e.text.prefix+a;var s=pt(t,e.nodeIndex).renderText;t.renderer.setValue(s,a)}return i}(t,e,n);case 16384:return function(t,e,n){for(var r=ft(t,e.nodeIndex),i=r.instance,o=!1,a=void 0,s=0;s<n.length;s++)At(t,e,s,n[s])&&(o=!0,a=Oe(t,r,e,s,n[s],a));return a&&i.ngOnChanges(a),65536&e.flags&&ht(t,256,e.nodeIndex)&&i.ngOnInit(),262144&e.flags&&i.ngDoCheck(),o}(t,e,n);case 32:case 64:case 128:return function(t,e,n){for(var r=e.bindings,i=!1,o=0;o<n.length;o++)Mt(t,e,o,n[o])&&(i=!0);if(i){var a=mt(t,e.nodeIndex),s=void 0;switch(201347067&e.flags){case 32:s=n;break;case 64:for(s={},o=0;o<n.length;o++)s[r[o].name]=n[o];break;case 128:var l=n[0],u=n.slice(1);s=l.transform.apply(l,u)}a.value=s}return i}(t,e,n);default:throw"unreachable"}}(t,e,r)}function on(t){var e=t.def;if(4&e.nodeFlags)for(var n=0;n<e.nodes.length;n++){var r=e.nodes[n];if(4&r.flags){var i=dt(t,n).template._projectedViews;if(i)for(var o=0;o<i.length;o++){var a=i[o];a.state|=32,Et(a,t)}}else 0==(4&r.childFlags)&&(n+=r.childCount)}}function an(t,e,n,r,i,o,a,s,l,u,c,h,p){return 0===n?function(t,e,n,r,i,o,a,s,l,u,c,h){var p=e.bindings.length;p>0&&Tt(t,e,0,n);p>1&&Tt(t,e,1,r);p>2&&Tt(t,e,2,i);p>3&&Tt(t,e,3,o);p>4&&Tt(t,e,4,a);p>5&&Tt(t,e,5,s);p>6&&Tt(t,e,6,l);p>7&&Tt(t,e,7,u);p>8&&Tt(t,e,8,c);p>9&&Tt(t,e,9,h)}(t,e,r,i,o,a,s,l,u,c,h,p):function(t,e,n){for(var r=0;r<n.length;r++)Tt(t,e,r,n[r])}(t,e,r),!1}function sn(t,e){if(vt(t,e.nodeIndex).dirty)throw gt(mo.createDebugContext(t,e.nodeIndex),"Query "+e.query.id+" not dirty","Query "+e.query.id+" dirty",0!=(1&t.state))}function ln(t){if(!(128&t.state)){if(cn(t,Go.Destroy),un(t,Go.Destroy),Ne(t,131072),t.disposables)for(var e=0;e<t.disposables.length;e++)t.disposables[e]();!function(t){if(16&t.state){var e=Ot(t);if(e){var n=e.template._projectedViews;n&&(ce(n,n.indexOf(t)),mo.dirtyParentQueries(t))}}}(t),t.renderer.destroyNode&&function(t){for(var e=t.def.nodes.length,n=0;n<e;n++){var r=t.def.nodes[n];1&r.flags?t.renderer.destroyNode(dt(t,n).renderElement):2&r.flags?t.renderer.destroyNode(pt(t,n).renderText):(67108864&r.flags||134217728&r.flags)&&vt(t,n).destroy()}}(t),Dt(t)&&t.renderer.destroy(),t.state|=128}}function un(t,e){var n=t.def;if(33554432&n.nodeFlags)for(var r=0;r<n.nodes.length;r++){var i=n.nodes[r];33554432&i.flags?hn(dt(t,r).componentView,e):0==(33554432&i.childFlags)&&(r+=i.childCount)}}function cn(t,e){var n=t.def;if(16777216&n.nodeFlags)for(var r=0;r<n.nodes.length;r++){var i=n.nodes[r];if(16777216&i.flags)for(var o=dt(t,r).viewContainer._embeddedViews,a=0;a<o.length;a++)hn(o[a],e);else 0==(16777216&i.childFlags)&&(r+=i.childCount)}}function hn(t,e){var n=t.state;switch(e){case Go.CheckNoChanges:0==(128&n)&&(12==(12&n)?en(t):64&n&&pn(t,Go.CheckNoChangesProjectedViews));break;case Go.CheckNoChangesProjectedViews:0==(128&n)&&(32&n?en(t):64&n&&pn(t,e));break;case Go.CheckAndUpdate:0==(128&n)&&(12==(12&n)?nn(t):64&n&&pn(t,Go.CheckAndUpdateProjectedViews));break;case Go.CheckAndUpdateProjectedViews:0==(128&n)&&(32&n?nn(t):64&n&&pn(t,e));break;case Go.Destroy:ln(t);break;case Go.CreateViewNodes:tn(t)}}function pn(t,e){cn(t,e),un(t,e)}function dn(t,e,n,r){if(t.def.nodeFlags&e&&t.def.nodeFlags&n)for(var i=t.def.nodes.length,o=0;o<i;o++){var a=t.def.nodes[o];if(a.flags&e&&a.flags&n)switch(mo.setCurrentNode(t,a.nodeIndex),r){case 0:Re(t,a);break;case 1:sn(t,a)}a.childFlags&e&&a.childFlags&n||(o+=a.childCount)}}function fn(){if(!Ho){Ho=!0;var t=Y()?{setCurrentNode:On,createRootView:vn,createEmbeddedView:yn,createComponentView:bn,createNgModuleRef:_n,overrideProvider:xn,overrideComponentView:wn,clearOverrides:Sn,checkAndUpdateView:Cn,checkNoChangesView:En,destroyView:Pn,createDebugContext:function(t,e){return new Zo(t,e)},handleEvent:Nn,updateDirectives:Ln,updateRenderer:In}:{setCurrentNode:function(){},createRootView:mn,createEmbeddedView:Ze,createComponentView:Je,createNgModuleRef:ye,overrideProvider:vo,overrideComponentView:vo,clearOverrides:vo,checkAndUpdateView:nn,checkNoChangesView:en,destroyView:ln,createDebugContext:function(t,e){return new Zo(t,e)},handleEvent:function(t,e,n,r){return t.def.handleEvent(t,e,n,r)},updateDirectives:function(t,e){return t.def.updateDirectives(0===e?Mn:Tn,t)},updateRenderer:function(t,e){return t.def.updateRenderer(0===e?Mn:Tn,t)}};mo.setCurrentNode=t.setCurrentNode,mo.createRootView=t.createRootView,mo.createEmbeddedView=t.createEmbeddedView,mo.createComponentView=t.createComponentView,mo.createNgModuleRef=t.createNgModuleRef,mo.overrideProvider=t.overrideProvider,mo.overrideComponentView=t.overrideComponentView,mo.clearOverrides=t.clearOverrides,mo.checkAndUpdateView=t.checkAndUpdateView,mo.checkNoChangesView=t.checkNoChangesView,mo.destroyView=t.destroyView,mo.resolveDep=Ee,mo.createDebugContext=t.createDebugContext,mo.handleEvent=t.handleEvent,mo.updateDirectives=t.updateDirectives,mo.updateRenderer=t.updateRenderer,mo.dirtyParentQueries=Fe}}function mn(t,e,n,r,i,o){return Qe(gn(t,i,i.injector.get(Fi),e,n),r,o)}function vn(t,e,n,r,i,o){var a=i.injector.get(Fi),s=gn(t,i,new Qo(a),e,n),l=An(r);return jn(Yo.create,Qe,null,[s,l,o])}function gn(t,e,n,r,i){var o=e.injector.get(fo),a=e.injector.get(Ur);return{ngModule:e,injector:t,projectableNodes:r,selectorOrNode:i,sanitizer:o,rendererFactory:n,renderer:n.createRenderer(null,null),errorHandler:a}}function yn(t,e,n,r){var i=An(n);return jn(Yo.create,Ze,null,[t,e,i,r])}function bn(t,e,n,r){var i=Xo.get(e.element.componentProvider.provider.token);return n=i||An(n),jn(Yo.create,Je,null,[t,e,n,r])}function _n(t,e,n,r){return ye(t,e,n,function(t){var e=function(t){var e=!1,n=!1;if(0===Wo.size)return{hasOverrides:e,hasDeprecatedOverrides:n};return t.providers.forEach(function(t){var r=Wo.get(t.token);3840&t.flags&&r&&(e=!0,n=n||r.deprecatedBehavior)}),{hasOverrides:e,hasDeprecatedOverrides:n}}(t),n=e.hasDeprecatedOverrides;if(!e.hasOverrides)return t;return t=t.factory(function(){return vo}),function(t){for(var e=0;e<t.providers.length;e++){var r=t.providers[e];n&&(r.flags|=4096);var i=Wo.get(r.token);i&&(r.flags=-3841&r.flags|i.flags,r.deps=Ut(i.deps),r.value=i.value)}}(t),t}(r))}function xn(t){Wo.set(t.token,t)}function wn(t,e){var n=Bt(Bt(function(t){return t.viewDefFactory}(e)).nodes[0].element.componentView);Xo.set(t,n)}function Sn(){Wo.clear(),Xo.clear()}function An(t){if(0===Wo.size)return t;var e=function(t){for(var e=[],n=null,r=0;r<t.nodes.length;r++){var i=t.nodes[r];1&i.flags&&(n=i),n&&3840&i.flags&&Wo.has(i.provider.token)&&(e.push(n.nodeIndex),n=null)}return e}(t);if(0===e.length)return t;t=t.factory(function(){return vo});for(var n=0;n<e.length;n++)!function(t,e){for(var n=e+1;n<t.nodes.length;n++){var r=t.nodes[n];if(1&r.flags)return;if(3840&r.flags){var i=r.provider,o=Wo.get(i.token);o&&(r.flags=-3841&r.flags|o.flags,i.deps=Ut(o.deps),i.value=o.value)}}}(t,e[n]);return t}function Mn(t,e,n,r,i,o,a,s,l,u,c,h,p){var d=t.def.nodes[e];return rn(t,d,n,r,i,o,a,s,l,u,c,h,p),224&d.flags?mt(t,e).value:void 0}function Tn(t,e,n,r,i,o,a,s,l,u,c,h,p){var d=t.def.nodes[e];return an(t,d,n,r,i,o,a,s,l,u,c,h,p),224&d.flags?mt(t,e).value:void 0}function Cn(t){return jn(Yo.detectChanges,nn,null,[t])}function En(t){return jn(Yo.checkNoChanges,en,null,[t])}function Pn(t){return jn(Yo.destroy,ln,null,[t])}function On(t,e){Yn=t,qn=e}function Nn(t,e,n,r){return On(t,e),jn(Yo.handleEvent,t.def.handleEvent,null,[t,e,n,r])}function Ln(t,e){if(128&t.state)throw bt(Yo[Xn]);return On(t,Rn(t,0)),t.def.updateDirectives(function(t,n,r){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=t.def.nodes[n];return 0===e?Dn(t,a,r,i):Fn(t,a,r,i),16384&a.flags&&On(t,Rn(t,n)),224&a.flags?mt(t,a.nodeIndex).value:void 0},t)}function In(t,e){if(128&t.state)throw bt(Yo[Xn]);return On(t,kn(t,0)),t.def.updateRenderer(function(t,n,r){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=t.def.nodes[n];return 0===e?Dn(t,a,r,i):Fn(t,a,r,i),3&a.flags&&On(t,kn(t,n)),224&a.flags?mt(t,a.nodeIndex).value:void 0},t)}function Dn(t,e,n,r){if(rn.apply(void 0,[t,e,n].concat(r))){var i=1===n?r[0]:r;if(16384&e.flags){for(var o={},a=0;a<e.bindings.length;a++){var s=e.bindings[a],l=i[a];8&s.flags&&(o[function(t){return"ng-reflect-"+(t=function(t){return t.replace(qo,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"-"+t[1].toLowerCase()})}(t.replace(/[$@]/g,"_")))}(s.nonMinifiedName)]=function(t){try{return null!=t?t.toString().slice(0,30):t}catch(t){return"[ERROR] Exception while trying to serialize the value"}}(l))}var u=e.parent,c=dt(t,u.nodeIndex).renderElement;if(u.element.name)for(var h in o){null!=(l=o[h])?t.renderer.setAttribute(c,h,l):t.renderer.removeAttribute(c,h)}else t.renderer.setValue(c,"bindings="+JSON.stringify(o,null,2))}}}function Fn(t,e,n,r){an.apply(void 0,[t,e,n].concat(r))}function Rn(t,e){for(var n=e;n<t.def.nodes.length;n++){var r=t.def.nodes[n];if(16384&r.flags&&r.bindings&&r.bindings.length)return n}return null}function kn(t,e){for(var n=e;n<t.def.nodes.length;n++){var r=t.def.nodes[n];if(3&r.flags&&r.bindings&&r.bindings.length)return n}return null}function Un(t,e,n){for(var r in e.references)n[r]=Ue(t,e,e.references[r])}function jn(t,e,n,r){var i=Xn,o=Yn,a=qn;try{Xn=t;var s=e.apply(n,r);return Yn=o,qn=a,Xn=i,s}catch(t){if(function(t){return!!g(t)}(t)||!Yn)throw t;throw function(t,e){return t instanceof Error||(t=new Error(t.toString())),yt(t,e),t}(t,Bn())}}function Bn(){return Yn?new Zo(Yn,qn):null}function zn(t,e,n){return new Ko(t,e,n)}function Vn(t,e,n){return{parent:$o,id:t,node:null,data:[],ngStaticData:n,cleanup:null,renderer:e,child:null,tail:null,next:null,bindingStartIndex:null,creationMode:!0,viewHookStartIndex:null}}n.d(e,"f",function(){return Ii}),n.d(e,"M",function(){return X}),n.d(e,"P",function(){return Y}),n.d(e,"L",function(){return q}),n.d(e,"t",function(){return Ni}),n.d(e,"b",function(){return ni}),n.d(e,"x",function(){return ri}),n.d(e,"w",function(){return ii}),n.d(e,"c",function(){return ti}),n.d(e,"d",function(){return ei}),n.d(e,"O",function(){return et}),n.d(e,"G",function(){return Mi}),n.d(e,"R",function(){return W}),n.d(e,"r",function(){return co}),n.d(e,"e",function(){return ho}),n.d(e,"l",function(){return xi}),n.d(e,"k",function(){return Ur}),n.d(e,"D",function(){return fo}),n.d(e,"E",function(){return po}),n.d(e,"a",function(){return or}),n.d(e,"J",function(){return ar}),n.d(e,"H",function(){return sr}),n.d(e,"N",function(){return u}),n.d(e,"o",function(){return wr}),n.d(e,"y",function(){return Kr}),n.d(e,"n",function(){return er}),n.d(e,"m",function(){return ur}),n.d(e,"v",function(){return cr}),n.d(e,"u",function(){return wi}),n.d(e,"z",function(){return Di}),n.d(e,"A",function(){return ki}),n.d(e,"B",function(){return Fi}),n.d(e,"C",function(){return Ri}),n.d(e,"h",function(){return si}),n.d(e,"i",function(){return di}),n.d(e,"j",function(){return Ui}),n.d(e,"s",function(){return vi}),n.d(e,"F",function(){return Bi}),n.d(e,"I",function(){return zi}),n.d(e,"g",function(){return Vi}),n.d(e,"p",function(){return io}),n.d(e,"q",function(){return oo}),n.d(e,"K",function(){return Yi}),n.d(e,"Q",function(){return uo}),n.d(e,"_3",function(){return it}),n.d(e,"T",function(){return ai}),n.d(e,"S",function(){return fi}),n.d(e,"_0",function(){return mr}),n.d(e,"_6",function(){return s}),n.d(e,"_19",function(){return l}),n.d(e,"_4",function(){return F}),n.d(e,"_5",function(){return D}),n.d(e,"U",function(){return Qt}),n.d(e,"V",function(){return he}),n.d(e,"W",function(){return zn}),n.d(e,"X",function(){return wt}),n.d(e,"Y",function(){return be}),n.d(e,"Z",function(){return Jt}),n.d(e,"_2",function(){return qt}),n.d(e,"_7",function(){return ne}),n.d(e,"_8",function(){return ee}),n.d(e,"_10",function(){return je}),n.d(e,"_11",function(){return ve}),n.d(e,"_13",function(){return _e}),n.d(e,"_16",function(){return xe}),n.d(e,"_14",function(){return Ve}),n.d(e,"_15",function(){return ze}),n.d(e,"_18",function(){return Ie}),n.d(e,"_20",function(){return He}),n.d(e,"_21",function(){return xt}),n.d(e,"_22",function(){return Ye}),n.d(e,"_9",function(){return st}),n.d(e,"_12",function(){return lt}),n.d(e,"_17",function(){return ut}),n.d(e,"_1",function(){return R});var Gn,Hn,Wn,Xn,Yn,qn,Zn=n(5),Qn=n(14),Jn=n(204),Kn=n(214),$n=n(44),tr=n(37),er=function(){function t(t){this._desc=t,this.ngMetadataName="InjectionToken"}return t.prototype.toString=function(){return"InjectionToken "+this._desc},t}(),nr="__annotations__",rr="__paramaters__",ir="__prop__metadata__",or=new er("AnalyzeForEntryComponents"),ar=function(){var t={Emulated:0,Native:1,None:2};return t[t.Emulated]="Emulated",t[t.Native]="Native",t[t.None]="None",t}(),sr=function(){return function(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}(),lr=new sr("5.2.10"),ur=i("Inject",function(t){return{token:t}}),cr=i("Optional"),hr=i("Self"),pr=i("SkipSelf"),dr="undefined"!=typeof window&&window,fr="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,mr=dr||void 0!==t&&t||fr,vr=Promise.resolve(0),gr=null,yr="__source",br=new Object,_r=br,xr=function(){function t(){}return t.prototype.get=function(t,e){if(void 0===e&&(e=br),e===br)throw new Error("NullInjectorError: No provider for "+l(t)+"!");return e},t}(),wr=function(){function t(){}return t.create=function(t,e){return Array.isArray(t)?new Dr(t,e):new Dr(t.providers,t.parent,t.name||null)},t.THROW_IF_NOT_FOUND=br,t.NULL=new xr,t}(),Sr=function(t){return t},Ar=[],Mr=Sr,Tr=function(){return Array.prototype.slice.call(arguments)},Cr={},Er=Cr,Pr=function(t){for(var e in t)if(t[e]===Cr)return e;throw Error("!prop")}({provide:String,useValue:Er}),Or="ngTempTokenPath",Nr=wr.NULL,Lr=/\n/gm,Ir="",Dr=function(){function t(t,e,n){void 0===e&&(e=Nr),void 0===n&&(n=null),this.parent=e,this.source=n;var r=this._records=new Map;r.set(wr,{token:wr,fn:Sr,deps:Ar,value:this,useNew:!1}),d(r,t)}return t.prototype.get=function(t,e){var n=this._records.get(t);try{return f(t,n,this._records,this.parent,e)}catch(e){var r=e[Or];throw t[yr]&&r.unshift(t[yr]),e.message=m("\n"+e.message,r,this.source),e.ngTokenPath=r,e[Or]=null,e}},t.prototype.toString=function(){var t=[];return this._records.forEach(function(e,n){return t.push(l(n))}),"StaticInjector["+t.join(", ")+"]"},t}(),Fr="ngDebugContext",Rr="ngOriginalError",kr="ngErrorLogger",Ur=function(){function t(){this._console=console}return t.prototype.handleError=function(t){var e=this._findOriginalError(t),n=this._findContext(t),r=function(t){return t[kr]||function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t.error.apply(t,e)}}(t);r(this._console,"ERROR",t),e&&r(this._console,"ORIGINAL ERROR",e),n&&r(this._console,"ERROR CONTEXT",n)},t.prototype._findContext=function(t){return t?g(t)?g(t):this._findContext(y(t)):null},t.prototype._findOriginalError=function(t){for(var e=y(t);e&&y(e);)e=y(e);return e},t}(),jr=function(){function t(t,e){if(this.token=t,this.id=e,!t)throw new Error("Token must be defined!");this.displayName=l(this.token)}return t.get=function(t){return Br.get(c(t))},Object.defineProperty(t,"numberOfKeys",{get:function(){return Br.numberOfKeys},enumerable:!0,configurable:!0}),t}(),Br=new(function(){function t(){this._allKeys=new Map}return t.prototype.get=function(t){if(t instanceof jr)return t;if(this._allKeys.has(t))return this._allKeys.get(t);var e=new jr(t,jr.numberOfKeys);return this._allKeys.set(t,e),e},Object.defineProperty(t.prototype,"numberOfKeys",{get:function(){return this._allKeys.size},enumerable:!0,configurable:!0}),t}()),zr=Function,Vr=/^function\s+\S+\(\)\s*{[\s\S]+\.apply\(this,\s*arguments\)/,Gr=/^class\s+[A-Za-z\d$_]*\s*extends\s+[A-Za-z\d$_]+\s*{/,Hr=/^class\s+[A-Za-z\d$_]*\s*extends\s+[A-Za-z\d$_]+\s*{[\s\S]*constructor\s*\(/,Wr=function(){function t(t){this._reflect=t||mr.Reflect}return t.prototype.isReflectionEnabled=function(){return!0},t.prototype.factory=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return new(t.bind.apply(t,[void 0].concat(e)))}},t.prototype._zipTypesAndAnnotations=function(t,e){var n;n=void 0===t?new Array(e.length):new Array(t.length);for(var r=0;r<n.length;r++)n[r]=void 0===t?[]:t[r]!=Object?[t[r]]:[],e&&null!=e[r]&&(n[r]=n[r].concat(e[r]));return n},t.prototype._ownParameters=function(t,e){var n=t.toString();if(Vr.exec(n)||Gr.exec(n)&&!Hr.exec(n))return null;if(t.parameters&&t.parameters!==e.parameters)return t.parameters;var r=t.ctorParameters;if(r&&r!==e.ctorParameters){var i="function"==typeof r?r():r,o=i.map(function(t){return t&&t.type}),a=i.map(function(t){return t&&M(t.decorators)});return this._zipTypesAndAnnotations(o,a)}var s=t.hasOwnProperty(rr)&&t[rr],l=this._reflect&&this._reflect.getOwnMetadata&&this._reflect.getOwnMetadata("design:paramtypes",t);return l||s?this._zipTypesAndAnnotations(l,s):new Array(t.length).fill(void 0)},t.prototype.parameters=function(t){if(!A(t))return[];var e=T(t),n=this._ownParameters(t,e);return n||e===Object||(n=this.parameters(e)),n||[]},t.prototype._ownAnnotations=function(t,e){if(t.annotations&&t.annotations!==e.annotations){var n=t.annotations;return"function"==typeof n&&n.annotations&&(n=n.annotations),n}return t.decorators&&t.decorators!==e.decorators?M(t.decorators):t.hasOwnProperty(nr)?t[nr]:null},t.prototype.annotations=function(t){if(!A(t))return[];var e=T(t),n=this._ownAnnotations(t,e)||[];return(e!==Object?this.annotations(e):[]).concat(n)},t.prototype._ownPropMetadata=function(t,e){if(t.propMetadata&&t.propMetadata!==e.propMetadata){var n=t.propMetadata;return"function"==typeof n&&n.propMetadata&&(n=n.propMetadata),n}if(t.propDecorators&&t.propDecorators!==e.propDecorators){var r=t.propDecorators,i={};return Object.keys(r).forEach(function(t){i[t]=M(r[t])}),i}return t.hasOwnProperty(ir)?t[ir]:null},t.prototype.propMetadata=function(t){if(!A(t))return{};var e=T(t),n={};if(e!==Object){var r=this.propMetadata(e);Object.keys(r).forEach(function(t){n[t]=r[t]})}var i=this._ownPropMetadata(t,e);return i&&Object.keys(i).forEach(function(t){var e=[];n.hasOwnProperty(t)&&e.push.apply(e,n[t]),e.push.apply(e,i[t]),n[t]=e}),n},t.prototype.hasLifecycleHook=function(t,e){return t instanceof zr&&e in t.prototype},t.prototype.guards=function(t){return{}},t.prototype.getter=function(t){return new Function("o","return o."+t+";")},t.prototype.setter=function(t){return new Function("o","v","return o."+t+" = v;")},t.prototype.method=function(t){var e="if (!o."+t+") throw new Error('\""+t+"\" is undefined');\n        return o."+t+".apply(o, args);";return new Function("o","args",e)},t.prototype.importUri=function(t){return"object"==typeof t&&t.filePath?t.filePath:"./"+l(t)},t.prototype.resourceUri=function(t){return"./"+l(t)},t.prototype.resolveIdentifier=function(t,e,n,r){return r},t.prototype.resolveEnum=function(t,e){return t[e]},t}(),Xr=new(function(){function t(t){this.reflectionCapabilities=t}return t.prototype.updateCapabilities=function(t){this.reflectionCapabilities=t},t.prototype.factory=function(t){return this.reflectionCapabilities.factory(t)},t.prototype.parameters=function(t){return this.reflectionCapabilities.parameters(t)},t.prototype.annotations=function(t){return this.reflectionCapabilities.annotations(t)},t.prototype.propMetadata=function(t){return this.reflectionCapabilities.propMetadata(t)},t.prototype.hasLifecycleHook=function(t,e){return this.reflectionCapabilities.hasLifecycleHook(t,e)},t.prototype.getter=function(t){return this.reflectionCapabilities.getter(t)},t.prototype.setter=function(t){return this.reflectionCapabilities.setter(t)},t.prototype.method=function(t){return this.reflectionCapabilities.method(t)},t.prototype.importUri=function(t){return this.reflectionCapabilities.importUri(t)},t.prototype.resourceUri=function(t){return this.reflectionCapabilities.resourceUri(t)},t.prototype.resolveIdentifier=function(t,e,n,r){return this.reflectionCapabilities.resolveIdentifier(t,e,n,r)},t.prototype.resolveEnum=function(t,e){return this.reflectionCapabilities.resolveEnum(t,e)},t}())(new Wr),Yr=function(){function t(t,e,n){this.key=t,this.optional=e,this.visibility=n}return t.fromKey=function(e){return new t(e,!1,null)},t}(),qr=[],Zr=function(){return function(t,e,n){this.key=t,this.resolvedFactories=e,this.multiProvider=n,this.resolvedFactory=this.resolvedFactories[0]}}(),Qr=function(){return function(t,e){this.factory=t,this.dependencies=e}}(),Jr=new Object,Kr=function(){function t(){}return t.resolve=function(t){return P(t)},t.resolveAndCreate=function(e,n){var r=t.resolve(e);return t.fromResolvedProviders(r,n)},t.fromResolvedProviders=function(t,e){return new $r(t,e)},t}(),$r=function(){function t(t,e){this._constructionCounter=0,this._providers=t,this.parent=e||null;var n=t.length;this.keyIds=new Array(n),this.objs=new Array(n);for(var r=0;r<n;r++)this.keyIds[r]=t[r].key.id,this.objs[r]=Jr}return t.prototype.get=function(t,e){return void 0===e&&(e=_r),this._getByKey(jr.get(t),null,e)},t.prototype.resolveAndCreateChild=function(t){var e=Kr.resolve(t);return this.createChildFromResolved(e)},t.prototype.createChildFromResolved=function(e){var n=new t(e);return n.parent=this,n},t.prototype.resolveAndInstantiate=function(t){return this.instantiateResolved(Kr.resolve([t])[0])},t.prototype.instantiateResolved=function(t){return this._instantiateProvider(t)},t.prototype.getProviderAtIndex=function(t){if(t<0||t>=this._providers.length)throw function(t){return Error("Index "+t+" is out-of-bounds.")}(t);return this._providers[t]},t.prototype._new=function(t){if(this._constructionCounter++>this._getMaxNumberOfObjects())throw function(t,e){return _(t,e,function(t){return"Cannot instantiate cyclic dependency!"+b(t)})}(this,t.key);return this._instantiateProvider(t)},t.prototype._getMaxNumberOfObjects=function(){return this.objs.length},t.prototype._instantiateProvider=function(t){if(t.multiProvider){for(var e=new Array(t.resolvedFactories.length),n=0;n<t.resolvedFactories.length;++n)e[n]=this._instantiate(t,t.resolvedFactories[n]);return e}return this._instantiate(t,t.resolvedFactories[0])},t.prototype._instantiate=function(t,e){var n,r=this,i=e.factory;try{n=e.dependencies.map(function(t){return r._getByReflectiveDependency(t)})}catch(e){throw e.addKey&&e.addKey(this,t.key),e}var o;try{o=i.apply(void 0,n)}catch(e){throw function(t,e,n,r){return _(t,r,function(t){var n=l(t[0].token);return e.message+": Error during instantiation of "+n+"!"+b(t)+"."},e)}(this,e,0,t.key)}return o},t.prototype._getByReflectiveDependency=function(t){return this._getByKey(t.key,t.visibility,t.optional?null:_r)},t.prototype._getByKey=function(e,n,r){return e===t.INJECTOR_KEY?this:n instanceof hr?this._getByKeySelf(e,r):this._getByKeyDefault(e,r,n)},t.prototype._getObjByKeyId=function(t){for(var e=0;e<this.keyIds.length;e++)if(this.keyIds[e]===t)return this.objs[e]===Jr&&(this.objs[e]=this._new(this._providers[e])),this.objs[e];return Jr},t.prototype._throwOrNull=function(t,e){if(e!==_r)return e;throw function(t,e){return _(t,e,function(t){return"No provider for "+l(t[0].token)+"!"+b(t)})}(this,t)},t.prototype._getByKeySelf=function(t,e){var n=this._getObjByKeyId(t.id);return n!==Jr?n:this._throwOrNull(t,e)},t.prototype._getByKeyDefault=function(e,n,r){var i;for(i=r instanceof pr?this.parent:this;i instanceof t;){var o=i,a=o._getObjByKeyId(e.id);if(a!==Jr)return a;i=o.parent}return null!==i?i.get(e.token,n):this._throwOrNull(e,n)},Object.defineProperty(t.prototype,"displayName",{get:function(){return"ReflectiveInjector(providers: ["+function(t,e){for(var n=new Array(t._providers.length),r=0;r<t._providers.length;++r)n[r]=e(t.getProviderAtIndex(r));return n}(this,function(t){return' "'+t.key.displayName+'" '}).join(", ")+"])"},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return this.displayName},t.INJECTOR_KEY=jr.get(wr),t}(),ti=new er("Application Initializer"),ei=function(){function t(t){var e=this;this.appInits=t,this.initialized=!1,this.done=!1,this.donePromise=new Promise(function(t,n){e.resolve=t,e.reject=n})}return t.prototype.runInitializers=function(){var t=this;if(!this.initialized){var e=[],n=function(){t.done=!0,t.resolve()};if(this.appInits)for(var r=0;r<this.appInits.length;r++){var i=this.appInits[r]();D(i)&&e.push(i)}Promise.all(e).then(function(){n()}).catch(function(e){t.reject(e)}),0===e.length&&n(),this.initialized=!0}},t}(),ni=new er("AppId"),ri=new er("Platform Initializer"),ii=new er("Platform ID"),oi=new er("appBootstrapListener"),ai=function(){function t(){}return t.prototype.log=function(t){console.log(t)},t.prototype.warn=function(t){console.warn(t)},t.ctorParameters=function(){return[]},t}(),si=function(){function t(){}return t.prototype.compileModuleSync=function(t){throw U()},t.prototype.compileModuleAsync=function(t){throw U()},t.prototype.compileModuleAndAllComponentsSync=function(t){throw U()},t.prototype.compileModuleAndAllComponentsAsync=function(t){throw U()},t.prototype.clearCache=function(){},t.prototype.clearCacheFor=function(t){},t}(),li=function(){return function(){}}(),ui=function(){return function(){}}(),ci=function(){return function(){}}(),hi="ngComponent",pi=function(){function t(){}return t.prototype.resolveComponentFactory=function(t){throw j(t)},t}(),di=function(){function t(){}return t.NULL=new pi,t}(),fi=function(){function t(t,e,n){this._parent=e,this._ngModule=n,this._factories=new Map;for(var r=0;r<t.length;r++){var i=t[r];this._factories.set(i.componentType,i)}}return t.prototype.resolveComponentFactory=function(t){var e=this._factories.get(t);if(!e&&this._parent&&(e=this._parent.resolveComponentFactory(t)),!e)throw j(t);return new mi(e,this._ngModule)},t}(),mi=function(t){function e(e,n){var r=t.call(this)||this;return r.factory=e,r.ngModule=n,r.selector=e.selector,r.componentType=e.componentType,r.ngContentSelectors=e.ngContentSelectors,r.inputs=e.inputs,r.outputs=e.outputs,r}return Object(Zn.__extends)(e,t),e.prototype.create=function(t,e,n,r){return this.factory.create(t,e,n,r||this.ngModule)},e}(ci),vi=function(){return function(){}}(),gi=function(){return function(){}}(),yi=function(){var t=mr.wtf;return!(!t||!(Gn=t.trace)||(Hn=Gn.events,0))}(),bi=yi?function(t,e){return void 0===e&&(e=null),Hn.createScope(t,e)}:function(t,e){return B},_i=yi?function(t,e){return Gn.leaveScope(t,e),e}:function(t,e){return e},xi=function(t){function e(e){void 0===e&&(e=!1);var n=t.call(this)||this;return n.__isAsync=e,n}return Object(Zn.__extends)(e,t),e.prototype.emit=function(e){t.prototype.next.call(this,e)},e.prototype.subscribe=function(e,n,r){var i,o=function(t){return null},a=function(){return null};e&&"object"==typeof e?(i=this.__isAsync?function(t){setTimeout(function(){return e.next(t)})}:function(t){e.next(t)},e.error&&(o=this.__isAsync?function(t){setTimeout(function(){return e.error(t)})}:function(t){e.error(t)}),e.complete&&(a=this.__isAsync?function(){setTimeout(function(){return e.complete()})}:function(){e.complete()})):(i=this.__isAsync?function(t){setTimeout(function(){return e(t)})}:function(t){e(t)},n&&(o=this.__isAsync?function(t){setTimeout(function(){return n(t)})}:function(t){n(t)}),r&&(a=this.__isAsync?function(){setTimeout(function(){return r()})}:function(){r()}));var s=t.prototype.subscribe.call(this,i,o,a);return e instanceof tr.Subscription&&e.add(s),s},e}($n.Subject),wi=function(){function t(t){var e=t.enableLongStackTrace,n=void 0!==e&&e;if(this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new xi(!1),this.onMicrotaskEmpty=new xi(!1),this.onStable=new xi(!1),this.onError=new xi(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),function(t){t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:function(e,n,r,i,o,a){try{return G(t),e.invokeTask(r,i,o,a)}finally{H(t)}},onInvoke:function(e,n,r,i,o,a,s){try{return G(t),e.invoke(r,i,o,a,s)}finally{H(t)}},onHasTask:function(e,n,r,i){e.hasTask(r,i),n===r&&("microTask"==i.change?(t.hasPendingMicrotasks=i.microTask,V(t)):"macroTask"==i.change&&(t.hasPendingMacrotasks=i.macroTask))},onHandleError:function(e,n,r,i){return e.handleError(r,i),t.runOutsideAngular(function(){return t.onError.emit(i)}),!1}})}(this)}return t.isInAngularZone=function(){return!0===Zone.current.get("isAngularZone")},t.assertInAngularZone=function(){if(!t.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")},t.assertNotInAngularZone=function(){if(t.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")},t.prototype.run=function(t,e,n){return this._inner.run(t,e,n)},t.prototype.runTask=function(t,e,n,r){var i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+r,t,Si,z,z);try{return i.runTask(o,e,n)}finally{i.cancelTask(o)}},t.prototype.runGuarded=function(t,e,n){return this._inner.runGuarded(t,e,n)},t.prototype.runOutsideAngular=function(t){return this._outer.run(t)},t}(),Si={},Ai=function(){function t(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new xi,this.onMicrotaskEmpty=new xi,this.onStable=new xi,this.onError=new xi}return t.prototype.run=function(t){return t()},t.prototype.runGuarded=function(t){return t()},t.prototype.runOutsideAngular=function(t){return t()},t.prototype.runTask=function(t){return t()},t}(),Mi=function(){function t(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this._watchAngularEvents()}return t.prototype._watchAngularEvents=function(){var t=this;this._ngZone.onUnstable.subscribe({next:function(){t._didWork=!0,t._isZoneStable=!1}}),this._ngZone.runOutsideAngular(function(){t._ngZone.onStable.subscribe({next:function(){wi.assertNotInAngularZone(),a(function(){t._isZoneStable=!0,t._runCallbacksIfReady()})}})})},t.prototype.increasePendingRequestCount=function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount},t.prototype.decreasePendingRequestCount=function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount},t.prototype.isStable=function(){return this._isZoneStable&&0==this._pendingCount&&!this._ngZone.hasPendingMacrotasks},t.prototype._runCallbacksIfReady=function(){var t=this;this.isStable()?a(function(){for(;0!==t._callbacks.length;)t._callbacks.pop()(t._didWork);t._didWork=!1}):this._didWork=!0},t.prototype.whenStable=function(t){this._callbacks.push(t),this._runCallbacksIfReady()},t.prototype.getPendingRequestCount=function(){return this._pendingCount},t.prototype.findProviders=function(t,e,n){return[]},t}(),Ti=function(){function t(){this._applications=new Map,Ci.addToWindow(this)}return t.prototype.registerApplication=function(t,e){this._applications.set(t,e)},t.prototype.unregisterApplication=function(t){this._applications.delete(t)},t.prototype.unregisterAllApplications=function(){this._applications.clear()},t.prototype.getTestability=function(t){return this._applications.get(t)||null},t.prototype.getAllTestabilities=function(){return Array.from(this._applications.values())},t.prototype.getAllRootElements=function(){return Array.from(this._applications.keys())},t.prototype.findTestabilityInTree=function(t,e){return void 0===e&&(e=!0),Ci.findTestabilityInTree(this,t,e)},t.ctorParameters=function(){return[]},t}(),Ci=new(function(){function t(){}return t.prototype.addToWindow=function(t){},t.prototype.findTestabilityInTree=function(t,e,n){return null},t}()),Ei=!0,Pi=!1,Oi=new er("AllowMultipleToken"),Ni=function(){return function(t,e){this.name=t,this.token=e}}(),Li=function(){function t(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return t.prototype.bootstrapModuleFactory=function(t,e){var n=this,r=function(t){return"noop"===t?new Ai:("zone.js"===t?void 0:t)||new wi({enableLongStackTrace:Y()})}(e?e.ngZone:void 0),i=[{provide:wi,useValue:r}];return r.run(function(){var e=wr.create({providers:i,parent:n.injector,name:t.moduleType.name}),o=t.create(e),a=o.injector.get(Ur,null);if(!a)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return o.onDestroy(function(){return J(n._modules,o)}),r.runOutsideAngular(function(){return r.onError.subscribe({next:function(t){a.handleError(t)}})}),function(t,e,n){try{var r=n();return D(r)?r.catch(function(n){throw e.runOutsideAngular(function(){return t.handleError(n)}),n}):r}catch(n){throw e.runOutsideAngular(function(){return t.handleError(n)}),n}}(a,r,function(){var t=o.injector.get(ei);return t.runInitializers(),t.donePromise.then(function(){return n._moduleDoBootstrap(o),o})})})},t.prototype.bootstrapModule=function(t,e){var n=this;void 0===e&&(e=[]);var r=this.injector.get(li),i=Q({},e);return r.createCompiler([i]).compileModuleAsync(t).then(function(t){return n.bootstrapModuleFactory(t,i)})},t.prototype._moduleDoBootstrap=function(t){var e=t.injector.get(Ii);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(function(t){return e.bootstrap(t)});else{if(!t.instance.ngDoBootstrap)throw new Error("The module "+l(t.instance.constructor)+' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.');t.instance.ngDoBootstrap(e)}this._modules.push(t)},t.prototype.onDestroy=function(t){this._destroyListeners.push(t)},Object.defineProperty(t.prototype,"injector",{get:function(){return this._injector},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(function(t){return t.destroy()}),this._destroyListeners.forEach(function(t){return t()}),this._destroyed=!0},Object.defineProperty(t.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!0,configurable:!0}),t}(),Ii=function(){function t(t,e,n,r,i,o){var s=this;this._zone=t,this._console=e,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=i,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=Y(),this._zone.onMicrotaskEmpty.subscribe({next:function(){s._zone.run(function(){s.tick()})}});var l=new Qn.Observable(function(t){s._stable=s._zone.isStable&&!s._zone.hasPendingMacrotasks&&!s._zone.hasPendingMicrotasks,s._zone.runOutsideAngular(function(){t.next(s._stable),t.complete()})}),u=new Qn.Observable(function(t){var e;s._zone.runOutsideAngular(function(){e=s._zone.onStable.subscribe(function(){wi.assertNotInAngularZone(),a(function(){s._stable||s._zone.hasPendingMacrotasks||s._zone.hasPendingMicrotasks||(s._stable=!0,t.next(!0))})})});var n=s._zone.onUnstable.subscribe(function(){wi.assertInAngularZone(),s._stable&&(s._stable=!1,s._zone.runOutsideAngular(function(){t.next(!1)}))});return function(){e.unsubscribe(),n.unsubscribe()}});this.isStable=Object(Jn.merge)(l,Kn.share.call(u))}return t.prototype.bootstrap=function(t,e){var n=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");var r;r=t instanceof ci?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(r.componentType);var i=r instanceof mi?null:this._injector.get(vi),o=r.create(wr.NULL,[],e||r.selector,i);o.onDestroy(function(){n._unloadComponent(o)});var a=o.injector.get(Mi,null);return a&&o.injector.get(Ti).registerApplication(o.location.nativeElement,a),this._loadComponent(o),Y()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),o},t.prototype.tick=function(){var e=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");var n=t._tickScope();try{this._runningTick=!0,this._views.forEach(function(t){return t.detectChanges()}),this._enforceNoNewChanges&&this._views.forEach(function(t){return t.checkNoChanges()})}catch(t){this._zone.runOutsideAngular(function(){return e._exceptionHandler.handleError(t)})}finally{this._runningTick=!1,_i(n)}},t.prototype.attachView=function(t){var e=t;this._views.push(e),e.attachToAppRef(this)},t.prototype.detachView=function(t){var e=t;J(this._views,e),e.detachFromAppRef()},t.prototype._loadComponent=function(t){this.attachView(t.hostView),this.tick(),this.components.push(t);this._injector.get(oi,[]).concat(this._bootstrapListeners).forEach(function(e){return e(t)})},t.prototype._unloadComponent=function(t){this.detachView(t.hostView),J(this.components,t)},t.prototype.ngOnDestroy=function(){this._views.slice().forEach(function(t){return t.destroy()})},Object.defineProperty(t.prototype,"viewCount",{get:function(){return this._views.length},enumerable:!0,configurable:!0}),t._tickScope=bi("ApplicationRef#tick()"),t}(),Di=function(){return function(){}}(),Fi=function(){return function(){}}(),Ri=function(){var t={Important:1,DashCase:2};return t[t.Important]="Important",t[t.DashCase]="DashCase",t}(),ki=function(){return function(){}}(),Ui=function(){return function(t){this.nativeElement=t}}(),ji=function(){function t(){this.dirty=!0,this._results=[],this.changes=new xi,this.length=0}return t.prototype.map=function(t){return this._results.map(t)},t.prototype.filter=function(t){return this._results.filter(t)},t.prototype.find=function(t){return this._results.find(t)},t.prototype.reduce=function(t,e){return this._results.reduce(t,e)},t.prototype.forEach=function(t){this._results.forEach(t)},t.prototype.some=function(t){return this._results.some(t)},t.prototype.toArray=function(){return this._results.slice()},t.prototype[o()]=function(){return this._results[o()]()},t.prototype.toString=function(){return this._results.toString()},t.prototype.reset=function(t){this._results=K(t),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]},t.prototype.notifyOnChanges=function(){this.changes.emit(this)},t.prototype.setDirty=function(){this.dirty=!0},t.prototype.destroy=function(){this.changes.complete(),this.changes.unsubscribe()},t}(),Bi=function(){return function(){}}(),zi=function(){return function(){}}(),Vi=function(){return function(){}}(),Gi=function(){return function(t,e){this.name=t,this.callback=e}}(),Hi=function(){function t(t,e,n){this._debugContext=n,this.nativeNode=t,e&&e instanceof Wi?e.addChild(this):this.parent=null,this.listeners=[]}return Object.defineProperty(t.prototype,"injector",{get:function(){return this._debugContext.injector},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"componentInstance",{get:function(){return this._debugContext.component},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){return this._debugContext.context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"references",{get:function(){return this._debugContext.references},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"providerTokens",{get:function(){return this._debugContext.providerTokens},enumerable:!0,configurable:!0}),t}(),Wi=function(t){function e(e,n,r){var i=t.call(this,e,n,r)||this;return i.properties={},i.attributes={},i.classes={},i.styles={},i.childNodes=[],i.nativeElement=e,i}return Object(Zn.__extends)(e,t),e.prototype.addChild=function(t){t&&(this.childNodes.push(t),t.parent=this)},e.prototype.removeChild=function(t){var e=this.childNodes.indexOf(t);-1!==e&&(t.parent=null,this.childNodes.splice(e,1))},e.prototype.insertChildrenAfter=function(t,e){var n=this,r=this.childNodes.indexOf(t);-1!==r&&((i=this.childNodes).splice.apply(i,[r+1,0].concat(e)),e.forEach(function(t){t.parent&&t.parent.removeChild(t),t.parent=n}));var i},e.prototype.insertBefore=function(t,e){var n=this.childNodes.indexOf(t);-1===n?this.addChild(e):(e.parent&&e.parent.removeChild(e),e.parent=this,this.childNodes.splice(n,0,e))},e.prototype.query=function(t){return this.queryAll(t)[0]||null},e.prototype.queryAll=function(t){var e=[];return $(this,t,e),e},e.prototype.queryAllNodes=function(t){var e=[];return tt(this,t,e),e},Object.defineProperty(e.prototype,"children",{get:function(){return this.childNodes.filter(function(t){return t instanceof e})},enumerable:!0,configurable:!0}),e.prototype.triggerEventHandler=function(t,e){this.listeners.forEach(function(n){n.name==t&&n.callback(e)})},e}(Hi),Xi=new Map,Yi=function(){function t(t){this.wrapped=t}return t.wrap=function(e){return new t(e)},t.unwrap=function(e){return t.isWrapped(e)?e.wrapped:e},t.isWrapped=function(e){return e instanceof t},t}(),qi=function(){function t(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}return t.prototype.isFirstChange=function(){return this.firstChange},t}(),Zi=function(){function t(){}return t.prototype.supports=function(t){return it(t)},t.prototype.create=function(t){return new Ji(t)},t}(),Qi=function(t,e){return e},Ji=function(){function t(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||Qi}return t.prototype.forEachItem=function(t){var e;for(e=this._itHead;null!==e;e=e._next)t(e)},t.prototype.forEachOperation=function(t){for(var e=this._itHead,n=this._removalsHead,r=0,i=null;e||n;){var o=!n||e&&e.currentIndex<at(n,r,i)?e:n,a=at(o,r,i),s=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(e=e._next,null==o.previousIndex)r++;else{i||(i=[]);var l=a-r,u=s-r;if(l!=u){for(var c=0;c<l;c++){var h=c<i.length?i[c]:i[c]=0,p=h+c;u<=p&&p<l&&(i[c]=h+1)}i[o.previousIndex]=u-l}}a!==s&&t(o,a,s)}},t.prototype.forEachPreviousItem=function(t){var e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)},t.prototype.forEachAddedItem=function(t){var e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)},t.prototype.forEachMovedItem=function(t){var e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)},t.prototype.forEachRemovedItem=function(t){var e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)},t.prototype.forEachIdentityChange=function(t){var e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)},t.prototype.diff=function(t){if(null==t&&(t=[]),!it(t))throw new Error("Error trying to diff '"+l(t)+"'. Only arrays and iterables are allowed");return this.check(t)?this:null},t.prototype.onDestroy=function(){},t.prototype.check=function(t){var e=this;this._reset();var n,r,i,a=this._itHead,l=!1;if(Array.isArray(t)){this.length=t.length;for(var u=0;u<this.length;u++)i=this._trackByFn(u,r=t[u]),null!==a&&s(a.trackById,i)?(l&&(a=this._verifyReinsertion(a,r,i,u)),s(a.item,r)||this._addIdentityChange(a,r)):(a=this._mismatch(a,r,i,u),l=!0),a=a._next}else n=0,function(t,e){if(Array.isArray(t))for(var n=0;n<t.length;n++)e(t[n]);else for(var r=t[o()](),i=void 0;!(i=r.next()).done;)e(i.value)}(t,function(t){i=e._trackByFn(n,t),null!==a&&s(a.trackById,i)?(l&&(a=e._verifyReinsertion(a,t,i,n)),s(a.item,t)||e._addIdentityChange(a,t)):(a=e._mismatch(a,t,i,n),l=!0),a=a._next,n++}),this.length=n;return this._truncate(a),this.collection=t,this.isDirty},Object.defineProperty(t.prototype,"isDirty",{get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead},enumerable:!0,configurable:!0}),t.prototype._reset=function(){if(this.isDirty){var t=void 0,e=void 0;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=e)t.previousIndex=t.currentIndex,e=t._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}},t.prototype._mismatch=function(t,e,n,r){var i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(s(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,r)):null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(s(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,r)):t=this._addAfter(new Ki(e,n),i,r),t},t.prototype._verifyReinsertion=function(t,e,n,r){var i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?t=this._reinsertAfter(i,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t},t.prototype._truncate=function(t){for(;null!==t;){var e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)},t.prototype._reinsertAfter=function(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);var r=t._prevRemoved,i=t._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(t,e,n),this._addToMoves(t,n),t},t.prototype._moveAfter=function(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t},t.prototype._addAfter=function(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t},t.prototype._insertAfter=function(t,e,n){var r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new to),this._linkedRecords.put(t),t.currentIndex=n,t},t.prototype._remove=function(t){return this._addToRemovals(this._unlink(t))},t.prototype._unlink=function(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);var e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t},t.prototype._addToMoves=function(t,e){return t.previousIndex===e?t:(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t,t)},t.prototype._addToRemovals=function(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new to),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t},t.prototype._addIdentityChange=function(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t},t}(),Ki=function(){return function(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}(),$i=function(){function t(){this._head=null,this._tail=null}return t.prototype.add=function(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)},t.prototype.get=function(t,e){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&s(n.trackById,t))return n;return null},t.prototype.remove=function(t){var e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head},t}(),to=function(){function t(){this.map=new Map}return t.prototype.put=function(t){var e=t.trackById,n=this.map.get(e);n||(n=new $i,this.map.set(e,n)),n.add(t)},t.prototype.get=function(t,e){var n=this.map.get(t);return n?n.get(t,e):null},t.prototype.remove=function(t){var e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t},Object.defineProperty(t.prototype,"isEmpty",{get:function(){return 0===this.map.size},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this.map.clear()},t}(),eo=function(){function t(){}return t.prototype.supports=function(t){return t instanceof Map||ot(t)},t.prototype.create=function(){return new no},t}(),no=function(){function t(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return Object.defineProperty(t.prototype,"isDirty",{get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead},enumerable:!0,configurable:!0}),t.prototype.forEachItem=function(t){var e;for(e=this._mapHead;null!==e;e=e._next)t(e)},t.prototype.forEachPreviousItem=function(t){var e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)},t.prototype.forEachChangedItem=function(t){var e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)},t.prototype.forEachAddedItem=function(t){var e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)},t.prototype.forEachRemovedItem=function(t){var e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)},t.prototype.diff=function(t){if(t){if(!(t instanceof Map||ot(t)))throw new Error("Error trying to diff '"+l(t)+"'. Only maps and objects are allowed")}else t=new Map;return this.check(t)?this:null},t.prototype.onDestroy=function(){},t.prototype.check=function(t){var e=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(t,function(t,r){if(n&&n.key===r)e._maybeAddToChanges(n,t),e._appendAfter=n,n=n._next;else{var i=e._getOrCreateRecordForKey(r,t);n=e._insertBeforeOrAppend(n,i)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty},t.prototype._insertBeforeOrAppend=function(t,e){if(t){var n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null},t.prototype._getOrCreateRecordForKey=function(t,e){if(this._records.has(t)){var n=this._records.get(t);this._maybeAddToChanges(n,e);var r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}var o=new ro(t);return this._records.set(t,o),o.currentValue=e,this._addToAdditions(o),o},t.prototype._reset=function(){if(this.isDirty){var t=void 0;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}},t.prototype._maybeAddToChanges=function(t,e){s(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))},t.prototype._addToAdditions=function(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)},t.prototype._addToChanges=function(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)},t.prototype._forEach=function(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(function(n){return e(t[n],n)})},t}(),ro=function(){return function(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}(),io=function(){function t(t){this.factories=t}return t.create=function(e,n){if(null!=n){var r=n.factories.slice();return e=e.concat(r),new t(e)}return new t(e)},t.extend=function(e){return{provide:t,useFactory:function(n){if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return t.create(e,n)},deps:[[t,new pr,new cr]]}},t.prototype.find=function(t){var e=this.factories.find(function(e){return e.supports(t)});if(null!=e)return e;throw new Error("Cannot find a differ supporting object '"+t+"' of type '"+function(t){return t.name||typeof t}(t)+"'")},t}(),oo=function(){function t(t){this.factories=t}return t.create=function(e,n){if(n){var r=n.factories.slice();e=e.concat(r)}return new t(e)},t.extend=function(e){return{provide:t,useFactory:function(n){if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return t.create(e,n)},deps:[[t,new pr,new cr]]}},t.prototype.find=function(t){var e=this.factories.find(function(e){return e.supports(t)});if(e)return e;throw new Error("Cannot find a differ supporting object '"+t+"'")},t}(),ao=[new eo],so=new io([new Zi]),lo=new oo(ao),uo=q(null,"core",[{provide:ii,useValue:"unknown"},{provide:Li,deps:[wr]},{provide:Ti,deps:[]},{provide:ai,deps:[]}]),co=new er("LocaleId"),ho=function(){return function(t){}}(),po=function(){var t={NONE:0,HTML:1,STYLE:2,SCRIPT:3,URL:4,RESOURCE_URL:5};return t[t.NONE]="NONE",t[t.HTML]="HTML",t[t.STYLE]="STYLE",t[t.SCRIPT]="SCRIPT",t[t.URL]="URL",t[t.RESOURCE_URL]="RESOURCE_URL",t}(),fo=function(){return function(){}}(),mo={setCurrentNode:void 0,createRootView:void 0,createEmbeddedView:void 0,createComponentView:void 0,createNgModuleRef:void 0,overrideProvider:void 0,overrideComponentView:void 0,clearOverrides:void 0,checkAndUpdateView:void 0,checkNoChangesView:void 0,destroyView:void 0,resolveDep:void 0,createDebugContext:void 0,handleEvent:void 0,updateDirectives:void 0,updateRenderer:void 0,dirtyParentQueries:void 0},vo=function(){},go=new Map,yo="$$undefined",bo="$$empty",_o=0,xo=new WeakMap,wo=/^:([^:]+):(.+)$/,So=new Object,Ao=_t(wr),Mo=_t(vi),To=new Object,Co=function(t){function e(e,n,r,i,o,a){var s=t.call(this)||this;return s.selector=e,s.componentType=n,s._inputs=i,s._outputs=o,s.ngContentSelectors=a,s.viewDefFactory=r,s}return Object(Zn.__extends)(e,t),Object.defineProperty(e.prototype,"inputs",{get:function(){var t=[],e=this._inputs;for(var n in e){t.push({propName:n,templateName:e[n]})}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputs",{get:function(){var t=[];for(var e in this._outputs){t.push({propName:e,templateName:this._outputs[e]})}return t},enumerable:!0,configurable:!0}),e.prototype.create=function(t,e,n,r){if(!r)throw new Error("ngModule should be provided");var i=Bt(this.viewDefFactory),o=i.nodes[0].element.componentProvider.nodeIndex,a=mo.createRootView(t,e||[],n,i,r,To),s=ft(a,o).instance;return n&&a.renderer.setAttribute(dt(a,0).renderElement,"ng-version",lr.full),new Eo(a,new Oo(a),s)},e}(ci),Eo=function(t){function e(e,n,r){var i=t.call(this)||this;return i._view=e,i._viewRef=n,i._component=r,i._elDef=i._view.def.nodes[0],i.hostView=n,i.changeDetectorRef=n,i.instance=r,i}return Object(Zn.__extends)(e,t),Object.defineProperty(e.prototype,"location",{get:function(){return new Ui(dt(this._view,this._elDef.nodeIndex).renderElement)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"injector",{get:function(){return new Lo(this._view,this._elDef)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"componentType",{get:function(){return this._component.constructor},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this._viewRef.destroy()},e.prototype.onDestroy=function(t){this._viewRef.onDestroy(t)},e}(ui),Po=function(){function t(t,e,n){this._view=t,this._elDef=e,this._data=n,this._embeddedViews=[]}return Object.defineProperty(t.prototype,"element",{get:function(){return new Ui(this._data.renderElement)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"injector",{get:function(){return new Lo(this._view,this._elDef)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentInjector",{get:function(){for(var t=this._view,e=this._elDef.parent;!e&&t;)e=Nt(t),t=t.parent;return t?new Lo(t,e):new Lo(this._view,null)},enumerable:!0,configurable:!0}),t.prototype.clear=function(){for(var t=this._embeddedViews.length-1;t>=0;t--){var e=ae(this._data,t);mo.destroyView(e)}},t.prototype.get=function(t){var e=this._embeddedViews[t];if(e){var n=new Oo(e);return n.attachToViewContainerRef(this),n}return null},Object.defineProperty(t.prototype,"length",{get:function(){return this._embeddedViews.length},enumerable:!0,configurable:!0}),t.prototype.createEmbeddedView=function(t,e,n){var r=t.createEmbeddedView(e||{});return this.insert(r,n),r},t.prototype.createComponent=function(t,e,n,r,i){var o=n||this.parentInjector;i||t instanceof mi||(i=o.get(vi));var a=t.create(o,r,void 0,i);return this.insert(a.hostView,e),a},t.prototype.insert=function(t,e){if(t.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");var n=t;return oe(this._view,this._data,e,n._view),n.attachToViewContainerRef(this),t},t.prototype.move=function(t,e){if(t.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");var n=this._embeddedViews.indexOf(t._view);return function(t,e,n){var r=t.viewContainer._embeddedViews,i=r[e];ce(r,e),null==n&&(n=r.length),ue(r,n,i),mo.dirtyParentQueries(i),le(i),se(t,n>0?r[n-1]:null,i)}(this._data,n,e),t},t.prototype.indexOf=function(t){return this._embeddedViews.indexOf(t._view)},t.prototype.remove=function(t){var e=ae(this._data,t);e&&mo.destroyView(e)},t.prototype.detach=function(t){var e=ae(this._data,t);return e?new Oo(e):null},t}(),Oo=function(){function t(t){this._view=t,this._viewContainerRef=null,this._appRef=null}return Object.defineProperty(t.prototype,"rootNodes",{get:function(){return function(t){var e=[];return zt(t,0,void 0,void 0,e),e}(this._view)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){return this._view.context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"destroyed",{get:function(){return 0!=(128&this._view.state)},enumerable:!0,configurable:!0}),t.prototype.markForCheck=function(){Ct(this._view)},t.prototype.detach=function(){this._view.state&=-5},t.prototype.detectChanges=function(){var t=this._view.root.rendererFactory;t.begin&&t.begin();try{mo.checkAndUpdateView(this._view)}finally{t.end&&t.end()}},t.prototype.checkNoChanges=function(){mo.checkNoChangesView(this._view)},t.prototype.reattach=function(){this._view.state|=4},t.prototype.onDestroy=function(t){this._view.disposables||(this._view.disposables=[]),this._view.disposables.push(t)},t.prototype.destroy=function(){this._appRef?this._appRef.detachView(this):this._viewContainerRef&&this._viewContainerRef.detach(this._viewContainerRef.indexOf(this)),mo.destroyView(this._view)},t.prototype.detachFromAppRef=function(){this._appRef=null,le(this._view),mo.dirtyParentQueries(this._view)},t.prototype.attachToAppRef=function(t){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t},t.prototype.attachToViewContainerRef=function(t){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=t},t}(),No=function(t){function e(e,n){var r=t.call(this)||this;return r._parentView=e,r._def=n,r}return Object(Zn.__extends)(e,t),e.prototype.createEmbeddedView=function(t){return new Oo(mo.createEmbeddedView(this._parentView,this._def,this._def.element.template,t))},Object.defineProperty(e.prototype,"elementRef",{get:function(){return new Ui(dt(this._parentView,this._def.nodeIndex).renderElement)},enumerable:!0,configurable:!0}),e}(Bi),Lo=function(){function t(t,e){this.view=t,this.elDef=e}return t.prototype.get=function(t,e){void 0===e&&(e=wr.THROW_IF_NOT_FOUND);return mo.resolveDep(this.view,this.elDef,!!this.elDef&&0!=(33554432&this.elDef.flags),{flags:0,token:t,tokenKey:_t(t)},e)},t}(),Io=function(){function t(t){this.delegate=t}return t.prototype.selectRootElement=function(t){return this.delegate.selectRootElement(t)},t.prototype.createElement=function(t,e){var n=Xt(e),r=this.delegate.createElement(n[1],n[0]);return t&&this.delegate.appendChild(t,r),r},t.prototype.createViewRoot=function(t){return t},t.prototype.createTemplateAnchor=function(t){var e=this.delegate.createComment("");return t&&this.delegate.appendChild(t,e),e},t.prototype.createText=function(t,e){var n=this.delegate.createText(e);return t&&this.delegate.appendChild(t,n),n},t.prototype.projectNodes=function(t,e){for(var n=0;n<e.length;n++)this.delegate.appendChild(t,e[n])},t.prototype.attachViewAfter=function(t,e){for(var n=this.delegate.parentNode(t),r=this.delegate.nextSibling(t),i=0;i<e.length;i++)this.delegate.insertBefore(n,e[i],r)},t.prototype.detachView=function(t){for(var e=0;e<t.length;e++){var n=t[e],r=this.delegate.parentNode(n);this.delegate.removeChild(r,n)}},t.prototype.destroyView=function(t,e){for(var n=0;n<e.length;n++)this.delegate.destroyNode(e[n])},t.prototype.listen=function(t,e,n){return this.delegate.listen(t,e,n)},t.prototype.listenGlobal=function(t,e,n){return this.delegate.listen(t,e,n)},t.prototype.setElementProperty=function(t,e,n){this.delegate.setProperty(t,e,n)},t.prototype.setElementAttribute=function(t,e,n){var r=Xt(e),i=r[0],o=r[1];null!=n?this.delegate.setAttribute(t,o,n,i):this.delegate.removeAttribute(t,o,i)},t.prototype.setBindingDebugInfo=function(t,e,n){},t.prototype.setElementClass=function(t,e,n){n?this.delegate.addClass(t,e):this.delegate.removeClass(t,e)},t.prototype.setElementStyle=function(t,e,n){null!=n?this.delegate.setStyle(t,e,n):this.delegate.removeStyle(t,e)},t.prototype.invokeElementMethod=function(t,e,n){t[e].apply(t,n)},t.prototype.setText=function(t,e){this.delegate.setValue(t,e)},t.prototype.animate=function(){throw new Error("Renderer.animate is no longer supported!")},t}(),Do=function(){function t(t,e,n,r){this._moduleType=t,this._parent=e,this._bootstrapComponents=n,this._def=r,this._destroyListeners=[],this._destroyed=!1,this.injector=this,function(t){for(var e=t._def,n=t._providers=new Array(e.providers.length),r=0;r<e.providers.length;r++){var i=e.providers[r];4096&i.flags||(n[r]=ie(t,i))}}(this)}return t.prototype.get=function(t,e){return void 0===e&&(e=wr.THROW_IF_NOT_FOUND),re(this,{token:t,tokenKey:_t(t),flags:0},e)},Object.defineProperty(t.prototype,"instance",{get:function(){return this.get(this._moduleType)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"componentFactoryResolver",{get:function(){return this.get(di)},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){if(this._destroyed)throw new Error("The ng module "+l(this.instance.constructor)+" has already been destroyed.");this._destroyed=!0,function(t,e){for(var n=t._def,r=0;r<n.providers.length;r++)if(131072&n.providers[r].flags){var i=t._providers[r];i&&i!==So&&i.ngOnDestroy()}}(this),this._destroyListeners.forEach(function(t){return t()})},t.prototype.onDestroy=function(t){this._destroyListeners.push(t)},t}(),Fo=_t(Di),Ro=_t(ki),ko=_t(Ui),Uo=_t(zi),jo=_t(Bi),Bo=_t(Vi),zo=_t(wr),Vo={},Go=function(){var t={CreateViewNodes:0,CheckNoChanges:1,CheckNoChangesProjectedViews:2,CheckAndUpdate:3,CheckAndUpdateProjectedViews:4,Destroy:5};return t[t.CreateViewNodes]="CreateViewNodes",t[t.CheckNoChanges]="CheckNoChanges",t[t.CheckNoChangesProjectedViews]="CheckNoChangesProjectedViews",t[t.CheckAndUpdate]="CheckAndUpdate",t[t.CheckAndUpdateProjectedViews]="CheckAndUpdateProjectedViews",t[t.Destroy]="Destroy",t}(),Ho=!1,Wo=new Map,Xo=new Map,Yo=function(){var t={create:0,detectChanges:1,checkNoChanges:2,destroy:3,handleEvent:4};return t[t.create]="create",t[t.detectChanges]="detectChanges",t[t.checkNoChanges]="checkNoChanges",t[t.destroy]="destroy",t[t.handleEvent]="handleEvent",t}(),qo=/([A-Z])/g,Zo=function(){function t(t,e){this.view=t,this.nodeIndex=e,null==e&&(this.nodeIndex=e=0),this.nodeDef=t.def.nodes[e];for(var n=this.nodeDef,r=t;n&&0==(1&n.flags);)n=n.parent;if(!n)for(;!n&&r;)n=Nt(r),r=r.parent;this.elDef=n,this.elView=r}return Object.defineProperty(t.prototype,"elOrCompView",{get:function(){return dt(this.elView,this.elDef.nodeIndex).componentView||this.view},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"injector",{get:function(){return me(this.elView,this.elDef)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"component",{get:function(){return this.elOrCompView.component},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){return this.elOrCompView.context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"providerTokens",{get:function(){var t=[];if(this.elDef)for(var e=this.elDef.nodeIndex+1;e<=this.elDef.nodeIndex+this.elDef.childCount;e++){var n=this.elView.def.nodes[e];20224&n.flags&&t.push(n.provider.token),e+=n.childCount}return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"references",{get:function(){var t={};if(this.elDef){Un(this.elView,this.elDef,t);for(var e=this.elDef.nodeIndex+1;e<=this.elDef.nodeIndex+this.elDef.childCount;e++){var n=this.elView.def.nodes[e];20224&n.flags&&Un(this.elView,n,t),e+=n.childCount}}return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"componentRenderElement",{get:function(){var t=function(t){for(;t&&!Dt(t);)t=t.parent;return t.parent?dt(t.parent,Nt(t).nodeIndex):null}(this.elOrCompView);return t?t.renderElement:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderNode",{get:function(){return 2&this.nodeDef.flags?Lt(this.view,this.nodeDef):Lt(this.elView,this.elDef)},enumerable:!0,configurable:!0}),t.prototype.logError=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i;2&this.nodeDef.flags?(r=this.view.def,i=this.nodeDef.nodeIndex):(r=this.elView.def,i=this.elDef.nodeIndex);var o=function(t,e){for(var n=-1,r=0;r<=e;r++)3&t.nodes[r].flags&&n++;return n}(r,i),a=-1;r.factory(function(){return++a===o?(n=t.error).bind.apply(n,[t].concat(e)):vo;var n}),a<o&&(t.error("Illegal state: the ViewDefinitionFactory did not call the logger!"),t.error.apply(t,e))},t}(),Qo=function(){function t(t){this.delegate=t}return t.prototype.createRenderer=function(t,e){return new Jo(this.delegate.createRenderer(t,e))},t.prototype.begin=function(){this.delegate.begin&&this.delegate.begin()},t.prototype.end=function(){this.delegate.end&&this.delegate.end()},t.prototype.whenRenderingDone=function(){return this.delegate.whenRenderingDone?this.delegate.whenRenderingDone():Promise.resolve(null)},t}(),Jo=function(){function t(t){this.delegate=t,this.data=this.delegate.data}return t.prototype.destroyNode=function(t){!function(t){Xi.delete(t.nativeNode)}(et(t)),this.delegate.destroyNode&&this.delegate.destroyNode(t)},t.prototype.destroy=function(){this.delegate.destroy()},t.prototype.createElement=function(t,e){var n=this.delegate.createElement(t,e),r=Bn();if(r){var i=new Wi(n,null,r);i.name=t,nt(i)}return n},t.prototype.createComment=function(t){var e=this.delegate.createComment(t),n=Bn();return n&&nt(new Hi(e,null,n)),e},t.prototype.createText=function(t){var e=this.delegate.createText(t),n=Bn();return n&&nt(new Hi(e,null,n)),e},t.prototype.appendChild=function(t,e){var n=et(t),r=et(e);n&&r&&n instanceof Wi&&n.addChild(r),this.delegate.appendChild(t,e)},t.prototype.insertBefore=function(t,e,n){var r=et(t),i=et(e),o=et(n);r&&i&&r instanceof Wi&&r.insertBefore(o,i),this.delegate.insertBefore(t,e,n)},t.prototype.removeChild=function(t,e){var n=et(t),r=et(e);n&&r&&n instanceof Wi&&n.removeChild(r),this.delegate.removeChild(t,e)},t.prototype.selectRootElement=function(t){var e=this.delegate.selectRootElement(t),n=Bn();return n&&nt(new Wi(e,null,n)),e},t.prototype.setAttribute=function(t,e,n,r){var i=et(t);if(i&&i instanceof Wi){i.attributes[r?r+":"+e:e]=n}this.delegate.setAttribute(t,e,n,r)},t.prototype.removeAttribute=function(t,e,n){var r=et(t);if(r&&r instanceof Wi){r.attributes[n?n+":"+e:e]=null}this.delegate.removeAttribute(t,e,n)},t.prototype.addClass=function(t,e){var n=et(t);n&&n instanceof Wi&&(n.classes[e]=!0),this.delegate.addClass(t,e)},t.prototype.removeClass=function(t,e){var n=et(t);n&&n instanceof Wi&&(n.classes[e]=!1),this.delegate.removeClass(t,e)},t.prototype.setStyle=function(t,e,n,r){var i=et(t);i&&i instanceof Wi&&(i.styles[e]=n),this.delegate.setStyle(t,e,n,r)},t.prototype.removeStyle=function(t,e,n){var r=et(t);r&&r instanceof Wi&&(r.styles[e]=null),this.delegate.removeStyle(t,e,n)},t.prototype.setProperty=function(t,e,n){var r=et(t);r&&r instanceof Wi&&(r.properties[e]=n),this.delegate.setProperty(t,e,n)},t.prototype.listen=function(t,e,n){if("string"!=typeof t){var r=et(t);r&&r.listeners.push(new Gi(e,n))}return this.delegate.listen(t,e,n)},t.prototype.parentNode=function(t){return this.delegate.parentNode(t)},t.prototype.nextSibling=function(t){return this.delegate.nextSibling(t)},t.prototype.setValue=function(t,e){return this.delegate.setValue(t,e)},t}(),Ko=function(t){function e(e,n,r){var i=t.call(this)||this;return i.moduleType=e,i._bootstrapComponents=n,i._ngModuleDefFactory=r,i}return Object(Zn.__extends)(e,t),e.prototype.create=function(t){fn();var e=Bt(this._ngModuleDefFactory);return mo.createNgModuleRef(this.moduleType,t||wr.NULL,this._bootstrapComponents,e)},e}(gi);"undefined"==typeof ngDevMode&&("undefined"!=typeof window&&(window.ngDevMode=!0),"undefined"!=typeof self&&(self.ngDevMode=!0),void 0!==t&&(t.ngDevMode=!0));var $o;$o=Vn(null,null,[])}).call(e,n(78))},function(t,e,n){"use strict";n.d(e,"a",function(){return o}),e.c=function(t,e){var n=new o;n.init(t,e);var r=e.win();return r.Ionic=r.Ionic||{},r.Ionic.config=n,n},n.d(e,"b",function(){return a});var r=n(0),i=n(2),o=function(){function t(){this._c={},this._s={},this._modes={},this._trns={}}return t.prototype.init=function(t,e){this._s=t&&Object(i.k)(t)&&!Object(i.e)(t)?t:{},this.plt=e},t.prototype.get=function(t,e){void 0===e&&(e=null);var n=this.plt;if(!Object(i.h)(this._c[t])){if(!Object(i.h)(t))throw"config key is not defined";var r=void 0,o=this._s[t],a=void 0,s=void 0,l=void 0,u=void 0,c=null;if(n){var h=n.getQueryParam("ionic"+t);if(Object(i.h)(h))return this._c[t]="true"===h||"false"!==h&&h;for(var p=n.platforms(),d=0,f=p.length;d<f;d++)this._s.platforms&&(c=this._s.platforms[p[d]])&&(Object(i.h)(c[t])&&(r=c[t]),(c=this.getModeConfig(c.mode))&&Object(i.h)(c[t])&&(a=c[t])),(c=n.getPlatformConfig(p[d]))&&c.settings&&(Object(i.h)(c.settings[t])&&(l=c.settings[t]),(c=this.getModeConfig(c.settings.mode))&&Object(i.h)(c[t])&&(u=c[t]))}(c=this.getModeConfig(this._s.mode))&&Object(i.h)(c[t])&&(s=c[t]),this._c[t]=Object(i.h)(r)?r:Object(i.h)(o)?o:Object(i.h)(a)?a:Object(i.h)(s)?s:Object(i.h)(l)?l:Object(i.h)(u)?u:null}var m=this._c[t];return Object(i.i)(m)&&(m=m(n)),null!==m?m:e},t.prototype.getBoolean=function(t,e){void 0===e&&(e=!1);var n=this.get(t);return null===n?e:"string"==typeof n?"true"===n:!!n},t.prototype.getNumber=function(t,e){void 0===e&&(e=NaN);var n=parseFloat(this.get(t));return isNaN(n)?e:n},t.prototype.set=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[0],r=t[1];switch(t.length){case 2:this._s[n]=r,delete this._c[n];break;case 3:this._s.platforms=this._s.platforms||{},this._s.platforms[n]=this._s.platforms[n]||{},this._s.platforms[n][r]=t[2],delete this._c[r]}return this},t.prototype.settings=function(t,e){switch(arguments.length){case 0:return this._s;case 1:this._s=t,this._c={};break;case 2:this._s.platforms=this._s.platforms||{},this._s.platforms[t]=e,this._c={}}return this},t.prototype.setModeConfig=function(t,e){this._modes[t]=e},t.prototype.getModeConfig=function(t){return this._modes[t]||null},t.prototype.setTransition=function(t,e){this._trns[t]=e},t.prototype.getTransition=function(t){return this._trns[t]||null},t}(),a=new r.n("USERCONFIG")},function(t,e,n){"use strict";function r(t){return"string"==typeof t}function i(t){return"number"==typeof t}e.a=function(t,e,n){return Math.max(t,Math.min(e,n))},e.b=function(t){return JSON.parse(JSON.stringify(t))},e.c=function(t,e){return t===e||JSON.stringify(t)===JSON.stringify(e)},e.d=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=arguments.length-1;r>=1;r--){var i=arguments[r];if(i)for(var o in i)i.hasOwnProperty(o)&&!t.hasOwnProperty(o)&&(t[o]=i[o])}return t},e.n=r,e.j=i,e.i=function(t){return"function"==typeof t},e.h=function(t){return void 0!==t},e.p=function(t){return void 0===t},e.l=function(t){return void 0!==t&&null!==t},e.f=function(t){return void 0===t||null===t},e.k=function(t){return"object"==typeof t},e.e=function(t){return Array.isArray(t)},e.o=function(t){return"string"==typeof t?"true"===(t=t.toLowerCase().trim())||"on"===t||""===t:!!t},e.g=function(t,e){return void 0===t||null===t||""===t?void 0===e||null===e||""===e:!0===t||"true"===t?!0===e||"true"===e:!1===t||"false"===t?!1===e||"false"===e:0===t||"0"===t?0===e||"0"===e:t==e},e.m=function(t,e,n){switch(void 0===n&&(n=!1),t){case"right":return!0;case"left":return!1;case"end":return!e;case"start":return e;default:return n?!e:e}},e.r=function(t,e){var n=t[e.from];return t.splice(e.from,1),t.splice(e.to,0,n),t},e.q=function(t,e){var n=t.indexOf(e);return!!~n&&!!t.splice(n,1)},e.t=function(t,e,n){return!e&&n||t&&e},e.s=function(t){return"requestIdleCallback"in window?window.requestIdleCallback(t):setTimeout(t,500)}},function(t,e,n){"use strict";var r=n(0),i=n(11),o=function(){function t(){this.data={}}return t.prototype.parseUrl=function(t){if(t){var e=t.indexOf("?");if(e>-1)for(var n=t.slice(e+1).split("&"),r=0;r<n.length;r++)if(n[r].indexOf("=")>0){var i=n[r].split("=");i.length>1&&(this.data[i[0].toLowerCase()]=i[1].split("#")[0])}}},t.prototype.get=function(t){return this.data[t.toLowerCase()]},t}(),a=n(2);n.d(e,"a",function(){return s}),e.b=function(t,e,n){var r=new s;r.setDefault("core"),r.setPlatformConfigs(e),r.setZone(n);var i=t.documentElement;r.setDocument(t);var o=i.dir;r.setDir("rtl"===o?"rtl":"ltr",!o),r.setLang(i.lang,!1),r.setCssProps(i);var a=t.defaultView;return r.setWindow(a),r.setNavigatorPlatform(a.navigator.platform),r.setUserAgent(a.navigator.userAgent),r.setQueryParams(a.location.href),r.init(),a.Ionic=a.Ionic||{},a.Ionic.platform=r,r};var s=function(){function t(){var t=this;this._versions={},this._qp=new o,this._bbActions=[],this._pW=0,this._pH=0,this._lW=0,this._lH=0,this._isPortrait=null,this._uiEvtOpts=!1,this._platforms=[],this.backButton=new r.l,this.pause=new r.l,this.resume=new r.l,this.resize=new r.l,this._readyPromise=new Promise(function(e){t._readyResolve=e}),this.backButton.subscribe(function(){t.runBackButtonAction()})}return t.prototype.setWindow=function(t){this._win=t},t.prototype.win=function(){return this._win},t.prototype.setDocument=function(t){this._doc=t},t.prototype.doc=function(){return this._doc},t.prototype.setZone=function(t){this.zone=t},t.prototype.setCssProps=function(t){this.Css=Object(i.c)(t)},t.prototype.is=function(t){return this._platforms.indexOf(t)>-1},t.prototype.platforms=function(){return this._platforms},t.prototype.versions=function(){return this._versions},t.prototype.version=function(){for(var t in this._versions)if(this._versions[t])return this._versions[t];return{}},t.prototype.ready=function(){return this._readyPromise},t.prototype.triggerReady=function(t){var e=this;this.zone.run(function(){e._readyResolve(t)})},t.prototype.prepareReady=function(){function t(){e._doc.removeEventListener("DOMContentLoaded",t,!1),e._win.removeEventListener("load",t,!1),e.triggerReady("dom")}var e=this;"complete"===e._doc.readyState||"interactive"===e._doc.readyState?e.triggerReady("dom"):(e._doc.addEventListener("DOMContentLoaded",t,!1),e._win.addEventListener("load",t,!1))},t.prototype.setDir=function(t,e){this._dir=t,this.isRTL="rtl"===t,!1!==e&&this._doc.documentElement.setAttribute("dir",t)},t.prototype.dir=function(){return this._dir},t.prototype.setLang=function(t,e){this._lang=t,!1!==e&&this._doc.documentElement.setAttribute("lang",t)},t.prototype.lang=function(){return this._lang},t.prototype.exitApp=function(){},t.prototype.registerBackButtonAction=function(t,e){var n=this;void 0===e&&(e=0);var r={fn:t,priority:e};return this._bbActions.push(r),function(){Object(a.q)(n._bbActions,r)}},t.prototype.runBackButtonAction=function(){var t=null;this._bbActions.forEach(function(e){(!t||e.priority>=t.priority)&&(t=e)}),t&&t.fn&&t.fn()},t.prototype.setUserAgent=function(t){this._ua=t},t.prototype.setQueryParams=function(t){this._qp.parseUrl(t)},t.prototype.getQueryParam=function(t){return this._qp.get(t)},t.prototype.url=function(){return this._win.location.href},t.prototype.userAgent=function(){return this._ua||""},t.prototype.setNavigatorPlatform=function(t){this._nPlt=t},t.prototype.navigatorPlatform=function(){return this._nPlt||""},t.prototype.width=function(){return this._calcDim(),this._isPortrait?this._pW:this._lW},t.prototype.height=function(){return this._calcDim(),this._isPortrait?this._pH:this._lH},t.prototype.getElementComputedStyle=function(t,e){return this._win.getComputedStyle(t,e)},t.prototype.getElementFromPoint=function(t,e){return this._doc.elementFromPoint(t,e)},t.prototype.getElementBoundingClientRect=function(t){return t.getBoundingClientRect()},t.prototype.isPortrait=function(){return this._calcDim(),this._isPortrait},t.prototype.isLandscape=function(){return!this.isPortrait()},t.prototype._calcDim=function(){if(null===this._isPortrait||!1===this._isPortrait&&this._win.innerWidth<this._win.innerHeight){var t=this._win,e=t.innerWidth,n=t.innerHeight;t.screen.width>0&&t.screen.height>0&&(e<n?(this._pW<=e&&(this._isPortrait=!0,this._pW=e),this._pH<=n&&(this._isPortrait=!0,this._pH=n)):(this._lW!==e&&(this._isPortrait=!1,this._lW=e),this._lH!==n&&(this._isPortrait=!1,this._lH=n)))}},t.prototype.raf=function(t){return this._win.__zone_symbol__requestAnimationFrame(t)},t.prototype.cancelRaf=function(t){return this._win.__zone_symbol__cancelAnimationFrame(t)},t.prototype.timeout=function(t,e){return this._win.__zone_symbol__setTimeout(t,e)},t.prototype.cancelTimeout=function(t){this._win.__zone_symbol__clearTimeout(t)},t.prototype.registerListener=function(t,e,n,r,i){var o,a=this._uiEvtOpts?{capture:!!r.capture,passive:!!r.passive}:!!r.capture;return!r.zone&&t.__zone_symbol__addEventListener?(t.__zone_symbol__addEventListener(e,n,a),o=function(){t.__zone_symbol__removeEventListener(e,n,a)}):(t.addEventListener(e,n,a),o=function(){t.removeEventListener(e,n,a)}),i&&i.push(o),o},t.prototype.transitionEnd=function(t,e,n){function r(){o.forEach(function(t){t()})}function i(n){t===n.target&&(r(),e(n))}void 0===n&&(n=!0);var o=[];return t&&(this.registerListener(t,"webkitTransitionEnd",i,{zone:n},o),this.registerListener(t,"transitionend",i,{zone:n},o)),r},t.prototype.windowLoad=function(t){var e,n=this._win,r=this._doc;"complete"===r.readyState?t(n,r):e=this.registerListener(n,"load",function(){e&&e(),t(n,r)},{zone:!1})},t.prototype.isActiveElement=function(t){return!(!t||this.getActiveElement()!==t)},t.prototype.getActiveElement=function(){return this._doc.activeElement},t.prototype.hasFocus=function(t){return!(!t||this.getActiveElement()!==t||t.parentElement.querySelector(":focus")!==t)},t.prototype.hasFocusedTextInput=function(){var t=this.getActiveElement();return!!Object(i.e)(t)&&t.parentElement.querySelector(":focus")===t},t.prototype.focusOutActiveElement=function(){var t=this.getActiveElement();t&&t.blur&&t.blur()},t.prototype._initEvents=function(){var t=this;try{var e=Object.defineProperty({},"passive",{get:function(){t._uiEvtOpts=!0}});this._win.addEventListener("optsTest",null,e)}catch(t){}this.timeout(function(){var e;t.registerListener(t._win,"resize",function(){clearTimeout(e),e=setTimeout(function(){!1===t.hasFocusedTextInput()&&(t._isPortrait=null),t.zone.run(function(){return t.resize.emit()})},200)},{passive:!0,zone:!1})},2e3)},t.prototype.setPlatformConfigs=function(t){this._registry=t||{}},t.prototype.getPlatformConfig=function(t){return this._registry[t]||{}},t.prototype.registry=function(){return this._registry},t.prototype.setDefault=function(t){this._default=t},t.prototype.testQuery=function(t,e){return t.toLowerCase().split(";").indexOf(e)>-1},t.prototype.testNavigatorPlatform=function(t){return new RegExp(t,"i").test(this._nPlt)},t.prototype.matchUserAgentVersion=function(t){if(this._ua&&t){var e=this._ua.match(t);if(e)return{major:e[1],minor:e[2]}}},t.prototype.testUserAgent=function(t){return!!this._ua&&this._ua.indexOf(t)>=0},t.prototype.isPlatformMatch=function(t,e,n){void 0===n&&(n=[]);var r=this._qp.get("ionicplatform");if(r)return this.testQuery(r,t);e=e||[t];for(var i=this._ua.toLowerCase(),o=0;o<e.length;o++)if(i.indexOf(e[o])>-1){for(var a=0;a<n.length;a++)if(i.indexOf(n[a])>-1)return!1;return!0}return!1},t.prototype.init=function(){this._initEvents();var t,e,n;for(var r in this._registry)(n=this.matchPlatform(r))&&(n.isEngine?e=n:(!t||n.depth>t.depth)&&(t=n));if(t||(t=new l(this._registry,this._default)),t){e&&(e.child=t,t.parent=e,t=e);for(var i=t;i;)!function(t,e){var n=e.superset();if(n){var r=new l(t,n);r.parent=e.parent,r.child=e,r.parent&&(r.parent.child=r),e.parent=r}}(this._registry,i),i=i.child;for(i=t.parent;i;)t=i,i=i.parent;for(i=t;i;){if(i.initialize(this),"iphone"===i.name&&"iPad"===this.navigatorPlatform())return this._platforms.push("tablet"),void this._platforms.push("ipad");this._platforms.push(i.name),this._versions[i.name]=i.version(this),i=i.child}}this._platforms.indexOf("mobile")>-1&&-1===this._platforms.indexOf("cordova")&&this._platforms.push("mobileweb")},t.prototype.matchPlatform=function(t){var e=new l(this._registry,t).getRoot(this);if(e){e.depth=0;for(var n=e.child;n;)e.depth++,n=n.child}return e},t}(),l=function(){function t(t,e){this.registry=t,this.c=t[e],this.name=e,this.isEngine=this.c.isEngine}return t.prototype.settings=function(){return this.c.settings||{}},t.prototype.superset=function(){return this.c.superset},t.prototype.isMatch=function(t){return this.c.isMatch&&this.c.isMatch(t)||!1},t.prototype.initialize=function(t){this.c.initialize&&this.c.initialize(t)},t.prototype.version=function(t){if(this.c.versionParser){var e=this.c.versionParser(t);if(e){var n=e.major+"."+e.minor;return{str:n,num:parseFloat(n),major:parseInt(e.major,10),minor:parseInt(e.minor,10)}}}},t.prototype.getRoot=function(e){if(this.isMatch(e)){var n=this.getSubsetParents(this.name);if(!n.length)return this;for(var r=null,i=null,o=0;o<n.length;o++)if(r=new t(this.registry,n[o]),r.child=this,i=r.getRoot(e))return this.parent=r,i}return null},t.prototype.getSubsetParents=function(t){var e=[],n=null;for(var r in this.registry)(n=this.registry[r]).subsets&&n.subsets.indexOf(t)>-1&&e.push(r);return e},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return s}),e.b=function(t){return!!(t&&t._didLoad&&t._willUnload)};var r=n(0),i=n(2),o=n(29),a=n(10),s=function(){function t(t,e,n){void 0===n&&(n=l),this.component=t,this._isHidden=!1,this._state=o.h,this.willEnter=new r.l,this.didEnter=new r.l,this.willLeave=new r.l,this.didLeave=new r.l,this.willUnload=new r.l,this.readReady=new r.l,this.writeReady=new r.l,this.isOverlay=!1,this._emitter=new r.l,this.data=e instanceof a.a?e.data:Object(i.l)(e)?e:{},this._cssClass=n,this._ts=Date.now(),window.addEventListener("orientationchange",this.handleOrientationChange.bind(this))}return t.prototype.handleOrientationChange=function(){this.getContent()&&this.getContent().resize()},t.prototype.init=function(t){this._ts=Date.now(),this._cmp=t,this.instance=this.instance||t.instance,this._detached=!1},t.prototype._setNav=function(t){this._nav=t},t.prototype._setInstance=function(t){this.instance=t},t.prototype.subscribe=function(t){return this._emitter.subscribe(t)},t.prototype.emit=function(t){this._emitter.emit(t)},t.prototype.onDidDismiss=function(t){this._onDidDismiss=t},t.prototype.onWillDismiss=function(t){this._onWillDismiss=t},t.prototype.dismiss=function(t,e,n){if(void 0===n&&(n={}),!this._nav)return Promise.resolve(!1);this.isOverlay&&!n.minClickBlockDuration&&(n.minClickBlockDuration=400),this._dismissData=t,this._dismissRole=e;var r=Object.assign({},this._leavingOpts,n);return this._nav.removeView(this,r).then(function(){return t})},t.prototype.getNav=function(){return this._nav},t.prototype.getTransitionName=function(t){return this._nav&&this._nav.config.get("pageTransition")},t.prototype.getNavParams=function(){return new a.a(this.data)},t.prototype.setLeavingOpts=function(t){this._leavingOpts=t},t.prototype.enableBack=function(){if(!this._nav)return!1;return!!this._nav.getPrevious(this)},Object.defineProperty(t.prototype,"name",{get:function(){return this.component?this.component.name:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this._nav?this._nav.indexOf(this):-1},enumerable:!0,configurable:!0}),t.prototype.isFirst=function(){return!!this._nav&&this._nav.first()===this},t.prototype.isLast=function(){return!!this._nav&&this._nav.last()===this},t.prototype._domShow=function(t,e){if(this._cmp&&t===this._isHidden){this._isHidden=!t;var n=t?null:"";e.setElementAttribute(this.pageRef().nativeElement,"hidden",n)}},t.prototype.getZIndex=function(){return this._zIndex},t.prototype._setZIndex=function(t,e){if(t!==this._zIndex){this._zIndex=t;var n=this.pageRef();n&&e.setElementStyle(n.nativeElement,"z-index",t)}},t.prototype.pageRef=function(){return this._cmp&&this._cmp.location},t.prototype._setContent=function(t){this._cntDir=t},t.prototype.getContent=function(){return this._cntDir},t.prototype._setContentRef=function(t){this._cntRef=t},t.prototype.contentRef=function(){return this._cntRef},t.prototype._setIONContent=function(t){this._setContent(t),this._ionCntDir=t},t.prototype.getIONContent=function(){return this._ionCntDir},t.prototype._setIONContentRef=function(t){this._setContentRef(t),this._ionCntRef=t},t.prototype.getIONContentRef=function(){return this._ionCntRef},t.prototype._setHeader=function(t){this._hdrDir=t},t.prototype.getHeader=function(){return this._hdrDir},t.prototype._setFooter=function(t){this._ftrDir=t},t.prototype.getFooter=function(){return this._ftrDir},t.prototype._setNavbar=function(t){this._nb=t},t.prototype.getNavbar=function(){return this._nb},t.prototype.hasNavbar=function(){return!!this._nb},t.prototype.setBackButtonText=function(t){this._nb&&this._nb.setBackButtonText(t)},t.prototype.showBackButton=function(t){this._nb&&(this._nb.hideBackButton=!t)},t.prototype._preLoad=function(){this._lifecycle("PreLoad")},t.prototype._willLoad=function(){this._lifecycle("WillLoad")},t.prototype._didLoad=function(){this._lifecycle("DidLoad")},t.prototype._willEnter=function(){this.handleOrientationChange(),this._detached&&this._cmp&&(this._cmp.changeDetectorRef.reattach(),this._detached=!1),this.willEnter.emit(null),this._lifecycle("WillEnter")},t.prototype._didEnter=function(){this._nb&&this._nb.didEnter(),this.didEnter.emit(null),this._lifecycle("DidEnter")},t.prototype._willLeave=function(t){this.willLeave.emit(null),this._lifecycle("WillLeave"),t&&this._onWillDismiss&&(this._onWillDismiss(this._dismissData,this._dismissRole),this._onWillDismiss=null)},t.prototype._didLeave=function(){this.didLeave.emit(null),this._lifecycle("DidLeave"),!this._detached&&this._cmp&&(this._cmp.changeDetectorRef.detach(),this._detached=!0)},t.prototype._willUnload=function(){this.willUnload.emit(null),this._lifecycle("WillUnload"),this._onDidDismiss&&this._onDidDismiss(this._dismissData,this._dismissRole),this._onDidDismiss=null,this._dismissData=null,this._dismissRole=null},t.prototype._destroy=function(t){if(this._cmp){if(t){var e=this._cmp.location.nativeElement;t.setElementAttribute(e,"class",null),t.setElementAttribute(e,"style",null)}window.removeEventListener("orientationchange",this.handleOrientationChange.bind(this)),this._cmp.destroy()}this._nav=this._cmp=this.instance=this._cntDir=this._cntRef=this._leavingOpts=this._hdrDir=this._ftrDir=this._nb=this._onDidDismiss=this._onWillDismiss=null,this._state=o.f},t.prototype._lifecycleTest=function(t){var e=this.instance,n="ionViewCan"+t;if(e&&e[n])try{var r=e[n]();return r instanceof Promise?r:Promise.resolve(!1!==r)}catch(t){return Promise.reject(this.name+" "+n+" error: "+t.message)}return Promise.resolve(!0)},t.prototype._lifecycle=function(t){var e=this.instance,n="ionView"+t;e&&e[n]&&e[n]()},t}(),l="ion-page"},function(t,e,n){"use strict";function r(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function i(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function o(t){return this instanceof o?(this.v=t,this):new o(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.__extends=function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},n.d(e,"__assign",function(){return s}),e.__rest=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&(n[r[i]]=t[r[i]])}return n},e.__decorate=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},e.__param=function(t,e){return function(n,r){e(n,r,t)}},e.__metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},e.__awaiter=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}l((r=r.apply(t,e||[])).next())})},e.__generator=function(t,e){function n(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(o=s.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){s.label=n[1];break}if(6===n[0]&&s.label<o[1]){s.label=o[1],o=n;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(n);break}o[2]&&s.ops.pop(),s.trys.pop();continue}n=e.call(t,s)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},e.__exportStar=function(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])},e.__values=r,e.__read=i,e.__spread=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t},e.__await=o,e.__asyncGenerator=function(t,e,n){function r(t){c[t]&&(u[t]=function(e){return new Promise(function(n,r){h.push([t,e,n,r])>1||i(t,e)})})}function i(t,e){try{!function(t){t.value instanceof o?Promise.resolve(t.value.v).then(a,s):l(h[0][2],t)}(c[t](e))}catch(t){l(h[0][3],t)}}function a(t){i("next",t)}function s(t){i("throw",t)}function l(t,e){t(e),h.shift(),h.length&&i(h[0][0],h[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var u,c=n.apply(t,e||[]),h=[];return u={},r("next"),r("throw"),r("return"),u[Symbol.asyncIterator]=function(){return this},u},e.__asyncDelegator=function(t){function e(e,i){t[e]&&(n[e]=function(n){return(r=!r)?{value:o(t[e](n)),done:"return"===e}:i?i(n):n})}var n,r;return n={},e("next"),e("throw",function(t){throw t}),e("return"),n[Symbol.iterator]=function(){return this},n},e.__asyncValues=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator];return e?e.call(t):r(t)},e.__makeTemplateObject=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},e.__importStar=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e},e.__importDefault=function(t){return t&&t.__esModule?t:{default:t}};var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},s=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t}},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){function t(t,e,n,r){this._config=t,this._elementRef=e,this._renderer=n,this._componentName=r,r&&(this._setComponentName(),this._setMode(t.get("mode")))}return Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(t){this._setColor(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mode",{get:function(){return this._mode},set:function(t){this._setMode(t)},enumerable:!0,configurable:!0}),t.prototype.setElementClass=function(t,e){this._renderer.setElementClass(this._elementRef.nativeElement,t,e)},t.prototype.setElementAttribute=function(t,e){this._renderer.setElementAttribute(this._elementRef.nativeElement,t,e)},t.prototype.setElementStyle=function(t,e){this._renderer.setElementStyle(this._elementRef.nativeElement,t,e)},t.prototype._setColor=function(t,e){e&&(this._componentName=e),this._color&&this.setElementClass(this._componentName+"-"+this._mode+"-"+this._color,!1),t&&(this.setElementClass(this._componentName+"-"+this._mode+"-"+t,!0),this._color=t)},t.prototype._setMode=function(t){this._mode&&this.setElementClass(this._componentName+"-"+this._mode,!1),t&&(this.setElementClass(this._componentName+"-"+t,!0),this._setColor(null),this._mode=t,this._setColor(this._color))},t.prototype._setComponentName=function(){this.setElementClass(this._componentName,!0)},t.prototype.getElementRef=function(){return this._elementRef},t.prototype.getNativeElement=function(){return this._elementRef.nativeElement},t}()},function(t,e,n){"use strict";n.d(e,"b",function(){return r}),n.d(e,"d",function(){return i}),n.d(e,"c",function(){return o}),n.d(e,"j",function(){return a}),n.d(e,"k",function(){return s}),n.d(e,"h",function(){return l}),n.d(e,"g",function(){return u}),n.d(e,"f",function(){return c}),n.d(e,"e",function(){return h}),n.d(e,"i",function(){return p}),n.d(e,"a",function(){return d}),n.d(e,"l",function(){return f});n(8);var r="goback-swipe",i="menu-swipe",o="item-swipe",a="refresher",s="toggle",l=-10,u=0,c=10,h=20,p=30,d={disable:[i,r],disableScroll:!0},f=function(){function t(t){this._app=t,this.id=1,this.requestedStart={},this.disabledGestures={},this.disabledScroll=new Set,this.capturedID=null}return t.prototype.createGesture=function(t){if(!t.name)throw new Error("name is undefined");return new m(t.name,this.newID(),this,t.priority||0,!!t.disableScroll)},t.prototype.createBlocker=function(t){return void 0===t&&(t={}),new v(this.newID(),this,t.disable,!!t.disableScroll)},t.prototype.newID=function(){var t=this.id;return this.id++,t},t.prototype.start=function(t,e,n){return this.canStart(t)?(this.requestedStart[e]=n,!0):(delete this.requestedStart[e],!1)},t.prototype.capture=function(t,e,n){if(!this.start(t,e,n))return!1;var r=this.requestedStart,i=-1e4;for(var o in r)i=Math.max(i,r[o]);return i===n?(this.capturedID=e,this.requestedStart={},!0):(delete r[e],!1)},t.prototype.release=function(t){delete this.requestedStart[t],this.capturedID&&t===this.capturedID&&(this.capturedID=null)},t.prototype.disableGesture=function(t,e){var n=this.disabledGestures[t];n||(n=new Set,this.disabledGestures[t]=n),n.add(e)},t.prototype.enableGesture=function(t,e){var n=this.disabledGestures[t];n&&n.delete(e)},t.prototype.disableScroll=function(t){var e=!this.isScrollDisabled();this.disabledScroll.add(t),this._app&&e&&this.isScrollDisabled()&&this._app._setDisableScroll(!0)},t.prototype.enableScroll=function(t){var e=this.isScrollDisabled();this.disabledScroll.delete(t),this._app&&e&&!this.isScrollDisabled()&&this._app._setDisableScroll(!1)},t.prototype.canStart=function(t){return!this.capturedID&&!this.isDisabled(t)},t.prototype.isCaptured=function(){return!!this.capturedID},t.prototype.isScrollDisabled=function(){return this.disabledScroll.size>0},t.prototype.isDisabled=function(t){var e=this.disabledGestures[t];return!!(e&&e.size>0)},t}(),m=function(){function t(t,e,n,r,i){this.name=t,this.id=e,this.controller=n,this.priority=r,this.disableScroll=i}return t.prototype.canStart=function(){return!!this.controller&&this.controller.canStart(this.name)},t.prototype.start=function(){return!!this.controller&&this.controller.start(this.name,this.id,this.priority)},t.prototype.capture=function(){if(!this.controller)return!1;var t=this.controller.capture(this.name,this.id,this.priority);return t&&this.disableScroll&&this.controller.disableScroll(this.id),t},t.prototype.release=function(){this.controller&&(this.controller.release(this.id),this.disableScroll&&this.controller.enableScroll(this.id))},t.prototype.destroy=function(){this.release(),this.controller=null},t}(),v=function(){function t(t,e,n,r){this.id=t,this.controller=e,this.disable=n,this.disableScroll=r,this.blocked=!1}return t.prototype.block=function(){var t=this;this.controller&&(this.disable&&this.disable.forEach(function(e){t.controller.disableGesture(e,t.id)}),this.disableScroll&&this.controller.disableScroll(this.id),this.blocked=!0)},t.prototype.unblock=function(){var t=this;this.controller&&(this.disable&&this.disable.forEach(function(e){t.controller.enableGesture(e,t.id)}),this.disableScroll&&this.controller.enableScroll(this.id),this.blocked=!1)},t.prototype.destroy=function(){this.unblock(),this.controller=null},t}()},function(t,e,n){"use strict";function r(t,e){if(t.id===e||t.name===e)return t;for(var n=0,i=t.getAllChildNavs();n<i.length;n++){var o=r(i[n],e);if(o)return o}return null}function i(t){if(!t)return null;if(Object(u.m)(t))return i(t.parent);var e=t.length();return e>1||t._isPortal&&e>0?t:i(t.parent)}function o(t){var e=[],n=t.getActiveChildNavs();return n&&n.length?n.forEach(function(t){var n=o(t);e=e.concat(n)}):e.push(t),e}var a=n(0),s=n(27),l=n(46),u=(n(1),n(29)),c=(n(26),n(3),n(15)),h=n(2),p=n(38),d=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),f="opacity",m="translateX",v="show-back-button",g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return d(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=this.plt,n=e.isRTL?"-99.5%":"99.5%",r=e.isRTL?"33%":"-33%",i=this.enteringView,o=this.leavingView,a=this.opts;this.duration(Object(h.l)(a.duration)?a.duration:500),this.easing(Object(h.l)(a.easing)?a.easing:"cubic-bezier(0.36,0.66,0.04,1)");var s="back"===a.direction,l=i&&i.hasNavbar(),u=o&&o.hasNavbar();if(i){var p=i.pageRef().nativeElement,d=new c.a(e,i.contentRef());if(d.element(p.querySelectorAll("ion-header > *:not(ion-navbar),ion-footer > *")),this.add(d),s?d.fromTo(m,r,"0%",!0).fromTo(f,.8,1,!0):d.beforeClearStyles([f]).fromTo(m,n,"0%",!0),l){var g=p.querySelector("ion-navbar"),y=new c.a(e,g);this.add(y);var b=new c.a(e,g.querySelector("ion-title")),_=new c.a(e,g.querySelectorAll("ion-buttons,[menuToggle]")),x=new c.a(e,g.querySelector(".toolbar-background")),w=new c.a(e,g.querySelector(".back-button"));if(y.add(b).add(_).add(x).add(w),b.fromTo(f,.01,1,!0),_.fromTo(f,.01,1,!0),s)b.fromTo(m,r,"0%",!0),i.enableBack()&&w.beforeAddClass(v).fromTo(f,.01,1,!0);else if(b.fromTo(m,n,"0%",!0),x.beforeClearStyles([f]).fromTo(m,n,"0%",!0),i.enableBack()){w.beforeAddClass(v).fromTo(f,.01,1,!0);var S=new c.a(e,g.querySelector(".back-button-text"));S.fromTo(m,e.isRTL?"-100px":"100px","0px"),y.add(S)}else w.beforeRemoveClass(v)}}if(o&&o.pageRef()){var A=o.pageRef().nativeElement,M=new c.a(e,o.contentRef());if(M.element(A.querySelectorAll("ion-header > *:not(ion-navbar),ion-footer > *")),this.add(M),s?M.beforeClearStyles([f]).fromTo(m,"0%",e.isRTL?"-100%":"100%"):M.fromTo(m,"0%",r).fromTo(f,1,.8).afterClearStyles(["transform",f]),u){var T=A.querySelector("ion-navbar"),C=new c.a(e,T),E=new c.a(e,T.querySelector("ion-title")),P=new c.a(e,T.querySelectorAll("ion-buttons,[menuToggle]")),O=new c.a(e,T.querySelector(".toolbar-background")),N=new c.a(e,T.querySelector(".back-button"));if(C.add(E).add(P).add(N).add(O),this.add(C),N.fromTo(f,.99,0),E.fromTo(f,.99,0),P.fromTo(f,.99,0),s){E.fromTo(m,"0%",e.isRTL?"-100%":"100%"),O.beforeClearStyles([f]).fromTo(m,"0%",e.isRTL?"-100%":"100%");var L=new c.a(e,T.querySelector(".back-button-text"));L.fromTo(m,"0%",(e.isRTL?-300:300)+"px"),C.add(L)}else E.fromTo(m,"0%",r).afterClearStyles(["transform"]),N.afterClearStyles([f]),E.afterClearStyles([f]),P.afterClearStyles([f])}}},e}(p.a),y=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return y(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=this.plt,n=this.enteringView,r=this.leavingView,i=this.opts,o="back"===i.direction;if(n&&(o?this.duration(Object(h.l)(i.duration)?i.duration:200).easing("cubic-bezier(0.47,0,0.745,0.715)"):(this.duration(Object(h.l)(i.duration)?i.duration:280).easing("cubic-bezier(0.36,0.66,0.04,1)"),this.enteringPage.fromTo("translateY","40px","0px",!0).fromTo("opacity",.01,1,!0)),n.hasNavbar())){var a=n.pageRef().nativeElement.querySelector("ion-navbar"),s=new c.a(e,a);this.add(s);var l=new c.a(e,a.querySelector(".back-button"));this.add(l),n.enableBack()?l.beforeAddClass("show-back-button"):l.beforeRemoveClass("show-back-button")}if(r&&o){this.duration(i.duration||200).easing("cubic-bezier(0.47,0,0.745,0.715)");var u=new c.a(e,r.pageRef());this.add(u.fromTo("translateY","0px","40px").fromTo("opacity",1,0))}},e}(p.a),_=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=this.plt,n=this.enteringView,r=this.leavingView,i=this.opts,o="back"===i.direction;if(n&&(o?(this.duration(Object(h.l)(i.duration)?i.duration:120).easing("cubic-bezier(0.47,0,0.745,0.715)"),this.enteringPage.beforeClearStyles(["scale"])):(this.duration(Object(h.l)(i.duration)?i.duration:280).easing("cubic-bezier(0,0,0.05,1)"),this.enteringPage.fromTo("scale",.95,1,!0).fromTo("opacity",.01,1,!0)),n.hasNavbar())){var a=n.pageRef().nativeElement.querySelector("ion-navbar"),s=new c.a(e,a);this.add(s);var l=new c.a(e,a.querySelector(".back-button"));this.add(l),n.enableBack()?l.beforeAddClass("show-back-button"):l.beforeRemoveClass("show-back-button")}if(r&&o){this.duration(i.duration||200).easing("cubic-bezier(0.47,0,0.745,0.715)");var u=new c.a(e,r.pageRef());this.add(u.fromTo("scale",1,.95).fromTo("opacity",.99,0))}},e}(p.a);n.d(e,"a",function(){return w});var w=function(){function t(t,e,n){this._config=t,this._plt=e,this._menuCtrl=n,this._disTime=0,this._scrollTime=0,this._title="",this._titleSrv=new s.i(s.b),this._rootNavs=new Map,this._didScroll=!1,this.viewDidLoad=new a.l,this.viewWillEnter=new a.l,this.viewDidEnter=new a.l,this.viewWillLeave=new a.l,this.viewDidLeave=new a.l,this.viewWillUnload=new a.l,e.registerBackButtonAction(this.goBack.bind(this)),this._disableScrollAssist=t.getBoolean("disableScrollAssist",!1);t.getBoolean("inputBlurring",!1)&&this._enableInputBlurring(),t.setTransition("ios-transition",g),t.setTransition("md-transition",b),t.setTransition("wp-transition",x)}return t.prototype.setTitle=function(t){t!==this._title&&(this._title=t,this._titleSrv.setTitle(t))},t.prototype.setElementClass=function(t,e){this._appRoot.setElementClass(t,e)},t.prototype.setEnabled=function(t,e,n){void 0===e&&(e=700),void 0===n&&(n=0),this._disTime=t?0:Date.now()+e,this._clickBlock&&(t?this._clickBlock.activate(!1,M,n):this._clickBlock.activate(!0,e+M,n))},t.prototype._setDisableScroll=function(t){this._disableScrollAssist&&this._appRoot._disableScroll(t)},t.prototype.isEnabled=function(){var t=this._disTime;return 0===t||t<Date.now()},t.prototype.setScrolling=function(){this._scrollTime=Date.now()+A,this._didScroll=!0},t.prototype.isScrolling=function(){var t=this._scrollTime;return 0!==t&&(!(t<Date.now())||(this._scrollTime=0,!1))},t.prototype.getActiveNav=function(){console.warn("(getActiveNav) is deprecated and will be removed in the next major release. Use getActiveNavs instead.");var t=this.getActiveNavs();return t&&t.length?t[0]:null},t.prototype.getActiveNavs=function(t){var e=this._appRoot._getPortal(l.c);if(e.length()>0)return o(e);if(!this._rootNavs||!this._rootNavs.size)return[];if(1===this._rootNavs.size)return o(this._rootNavs.values().next().value);if(t)return o(this._rootNavs.get(t));var n=[];return this._rootNavs.forEach(function(t){var e=o(t);n=n.concat(e)}),n},t.prototype.getRootNav=function(){console.warn("(getRootNav) is deprecated and will be removed in the next major release. Use getRootNavById instead.");var t=this.getRootNavs();return 0===t.length?null:(t.length>1&&console.warn("(getRootNav) there are multiple root navs, use getRootNavs instead"),t[0])},t.prototype.getRootNavs=function(){var t=[];return this._rootNavs.forEach(function(e){return t.push(e)}),t},t.prototype.getRootNavById=function(t){return this._rootNavs.get(t)},t.prototype.registerRootNav=function(t){this._rootNavs.set(t.id,t)},t.prototype.unregisterRootNav=function(t){this._rootNavs.delete(t.id)},t.prototype.getActiveNavContainers=function(){var t=[];return this._rootNavs.forEach(function(e){t=t.concat(o(e))}),t},t.prototype.present=function(t,e,n){var r=this._appRoot._getPortal(n);return t._setNav(r),e.direction=u.b,e.animation||(e.animation=t.getTransitionName(u.b)),t.setLeavingOpts({keyboardClose:e.keyboardClose,direction:u.a,animation:t.getTransitionName(u.a),ev:e.ev}),r.insertPages(-1,[t],e)},t.prototype.goBack=function(){if(this._menuCtrl&&this._menuCtrl.isOpen())return this._menuCtrl.close();var t=this.navPop();return t||this._config.getBoolean("navExitApp",!0)&&this._plt.exitApp(),t},t.prototype.navPop=function(){var t=this;if(!this._rootNavs||0===this._rootNavs.size||!this.isEnabled())return Promise.resolve();if(this._appRoot._getPortal(l.a).length()>0)return Promise.resolve();var e=null,n=null;return this._rootNavs.forEach(function(r){t.getActiveNavs(r.id).map(function(t){return i(t)}).filter(function(t){return!!t}).forEach(function(t){var r=t.last();(t._isPortal||r&&t.length()>1&&(!n||r._ts>=n._ts))&&(n=r,e=t)})}),e?e.pop():void 0},t.prototype._enableInputBlurring=function(){var t=!0,e=this,n=this._plt;n.registerListener(n.doc(),"focusin",function(){t=!0},{capture:!0,zone:!1,passive:!0}),n.registerListener(n.doc(),"touchend",function(r){if(e._didScroll)e._didScroll=!1;else{var i=e._plt.getActiveElement();if(i&&-1!==S.indexOf(i.tagName)){var o=r.target;o!==i&&(S.indexOf(o.tagName)>=0||o.classList.contains("input-cover")||(t=!1,n.timeout(function(){t||i.blur()},50)))}}},{capture:!1,zone:!1,passive:!0})},t.prototype.getNavByIdOrName=function(t){for(var e=0,n=Array.from(this._rootNavs.values());e<n.length;e++){var i=r(n[e],t);if(i)return i}return null},t}(),S=["INPUT","TEXTAREA","ION-INPUT","ION-TEXTAREA"],A=100,M=64},function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(3);var r=n(2),i=function(){function t(t){this.dom=t,this.writeTask=null,this.readTask=null}return t.prototype.read=function(t){var e=this;if(!this.readTask)return this.readTask=this.dom.read(function(n){e.readTask=null,t(n)})},t.prototype.write=function(t){var e=this;if(!this.writeTask)return this.writeTask=this.dom.write(function(n){e.writeTask=null,t(n)})},t.prototype.cancel=function(){var t=this.writeTask;t&&this.dom.cancel(t);var e=this.readTask;e&&this.dom.cancel(e),this.readTask=this.writeTask=null},t}(),o=function(){function t(t){this.plt=t,this.r=[],this.w=[]}return t.prototype.debouncer=function(){return new i(this)},t.prototype.read=function(t,e){var n=this;return e?t.timeoutId=this.plt.timeout(function(){n.r.push(t),n._queue()},e):(this.r.push(t),this._queue()),t},t.prototype.write=function(t,e){var n=this;return e?t.timeoutId=this.plt.timeout(function(){n.w.push(t),n._queue()},e):(this.w.push(t),this._queue()),t},t.prototype.cancel=function(t){t&&(t.timeoutId&&this.plt.cancelTimeout(t.timeoutId),Object(r.q)(this.r,t)||Object(r.q)(this.w,t))},t.prototype._queue=function(){var t=this;t.q||(t.q=!0,t.plt.raf(function(e){t._flush(e)}))},t.prototype._flush=function(t){var e;try{!function(t,e,n){for(var r;r=e.shift();)r(t);for(;r=n.shift();)r(t)}(t,this.r,this.w)}catch(t){e=t}if(this.q=!1,(this.r.length||this.w.length)&&this._queue(),e)throw e},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){function t(t){void 0===t&&(t={}),this.data=t}return t.prototype.get=function(t){return this.data[t]},t}()},function(t,e,n){"use strict";e.c=function(t){var e,n={},r=["webkitTransform","-webkit-transform","webkit-transform","transform"];for(e=0;e<r.length;e++)if(void 0!==t.style[r[e]]){n.transform=r[e];break}for(r=["webkitTransition","transition"],e=0;e<r.length;e++)if(void 0!==t.style[r[e]]){n.transition=r[e];break}var i=n.transition.indexOf("webkit")>-1;return n.transitionDuration=(i?"-webkit-":"")+"transition-duration",n.transitionTimingFn=(i?"-webkit-":"")+"transition-timing-function",n.transitionDelay=(i?"-webkit-":"")+"transition-delay",n.transitionEnd=(i?"webkitTransitionEnd ":"")+"transitionend",n.transformOrigin=(i?"-webkit-":"")+"transform-origin",n.animationDelay=i?"webkitAnimationDelay":"animationDelay",n},e.f=function(t){if(t){var e=t.changedTouches;if(e&&e.length>0){var n=e[0];return{x:n.clientX,y:n.clientY}}var r=t.pageX;if(void 0!==r)return{x:r,y:t.pageY}}return{x:0,y:0}},e.d=function(t,e,n){if(e&&n){var r=e.x-n.x,i=e.y-n.y;return r*r+i*i>t*t}return!1},e.e=function(t){return!!t&&("TEXTAREA"===t.tagName||"true"===t.contentEditable||"INPUT"===t.tagName&&!r.test(t.type))},n.d(e,"a",function(){return r}),e.b=function(t,e){for(var n=t.attributes,r=0;r<n.length;r++){var o=n[r];-1===i.indexOf(o.name)&&e.setAttribute(o.name,o.value)}};var r=/^(radio|checkbox|range|file|submit|reset|color|image|button)$/i,i=["value","checked","disabled","readonly","placeholder","type","class","style","id","autofocus","autocomplete","autocorrect"]},function(t,e,n){"use strict";function r(t){return"/"!==(t=t.trim()).charAt(0)&&(t="/"+t),t.length>1&&"/"===t.charAt(t.length-1)&&(t=t.substr(0,t.length-1)),t}n.d(e,"a",function(){return l}),e.b=function(t,e,n,r,i){var o=new l(t,e,n,r,i);return o.init(),o};var i=n(29),o=n(2),a=n(47),s=n(4),l=function(){function t(t,e,n,r,i){this._app=t,this._serializer=e,this._location=n,this._moduleLoader=r,this._baseCfr=i,this._history=[]}return t.prototype.init=function(){var t=this,e=r(this._location.path());this._historyPush(e),this._location.subscribe(function(e){t._urlChange(r(e.url))})},t.prototype._urlChange=function(t){var e=this;if(!this._isCurrentUrl(t)){this._isBackUrl(t)?this._historyPop():(!1,this._historyPush(t));var n=this._app.getActiveNavContainers();if(n&&n.length){if("/"===t){if(!Object(o.l)(this._indexAliasUrl))return void n.forEach(function(t){t.goToRoot({updateUrl:!1,isNavRoot:!0})});t=this._indexAliasUrl}this.getCurrentSegments(t).map(function(t){for(var e=0,r=n;e<r.length;e++){var i=function(t,e){for(;t;){if(t.id===e||t.name===e)return t;t=t.parent}return null}(r[e],t.navId);if(i)return{segment:t,navContainer:i}}}).filter(function(t){return!!t}).forEach(function(t){e._loadViewForSegment(t.navContainer,t.segment,function(){})})}}},t.prototype.getCurrentSegments=function(t){return t||(t=r(this._location.path())),this._serializer.parse(t)},t.prototype.navChange=function(t){if(t){for(var e=0,n=this._app.getActiveNavContainers();e<n.length;e++){var r=n[e];if(Object(i.m)(r)||r.isTransitioning())return}for(var o=[],a=0,s=this._app.getRootNavs();a<s.length;a++){var l=this.getSegmentsFromNav(s[a]);o=o.concat(l)}if((o=o.filter(function(t){return!!t})).length){var u=this._serializer.serialize(o);this._updateLocation(u,t)}}},t.prototype.getSegmentsFromNav=function(t){var e=this,n=[];return Object(i.k)(t)?n.push(this.getSegmentFromNav(t)):Object(i.l)(t)&&n.push(this.getSegmentFromTab(t)),t.getActiveChildNavs().forEach(function(t){n=n.concat(e.getSegmentsFromNav(t))}),n},t.prototype.getSegmentFromNav=function(t,e,n){if(!e){var r=t.getActive(!0);r&&(e=r.component,n=r.data)}return this._serializer.serializeComponent(t,e,n)},t.prototype.getSegmentFromTab=function(t,e,n){if(t&&t.parent){var r=t.parent,i=r.getActiveChildNavs();if(i&&i.length){var o=i[0].getActive(!0);return o&&(e=o.component,n=o.data),this._serializer.serializeComponent(r,e,n)}}},t.prototype._updateLocation=function(t,e){this._indexAliasUrl===t&&(t="/"),e===i.a&&this._isBackUrl(t)?(this._historyPop(),this._location.back()):this._isCurrentUrl(t)||(this._historyPush(t),this._location.go(t))},t.prototype.getComponentFromName=function(t){var e=this._serializer.getLinkFromName(t);return e?this.getNavLinkComponent(e):Promise.reject("invalid link: "+t)},t.prototype.getNavLinkComponent=function(t){return t.component?Promise.resolve(t.component):t.loadChildren?this._moduleLoader.load(t.loadChildren).then(function(e){return t.component=e.component,e.component}):Promise.reject("invalid link component: "+t.name)},t.prototype.resolveComponent=function(t){var e=this._moduleLoader.getComponentFactoryResolver(t);return e||(e=this._baseCfr),e.resolveComponentFactory(t)},t.prototype.createUrl=function(t,e,n,r){void 0===r&&(r=!0);var i=this._serializer.createSegmentFromName(t,e),o=this.getCurrentSegments();if(i)for(var a=0;a<o.length;a++)if(o[a].navId===t.name||o[a].navId===t.id){o[a]=i;var s=this._serializer.serialize(o);return r?this._location.prepareExternalUrl(s):s}return""},t.prototype.getSegmentByNavIdOrName=function(t,e){for(var n=r(this._location.path()),i=0,o=this._serializer.parse(n);i<o.length;i++){var a=o[i];if(a.navId===t||a.navId===e)return a}return null},t.prototype.initViews=function(t){var e=this,n=this._serializer.getLinkFromName(t.name);return this.getNavLinkComponent(n).then(function(n){t.component=n;var r=new s.a(n,t.data);return r.id=t.id,Object(o.e)(t.defaultHistory)?Object(i.i)(e,t.defaultHistory).then(function(t){return t.push(r),t}):[r]})},t.prototype._isBackUrl=function(t){return t===this._history[this._history.length-2]},t.prototype._isCurrentUrl=function(t){return t===this._history[this._history.length-1]},t.prototype._historyPush=function(t){this._isCurrentUrl(t)||(this._history.push(t),this._history.length>30&&this._history.shift())},t.prototype._historyPop=function(){this._history.pop(),this._history.length||this._historyPush(this._location.path())},t.prototype._getTabSelector=function(t){return Object(o.l)(t.tabUrlPath)?t.tabUrlPath:Object(o.l)(t.tabTitle)?Object(a.c)(t.tabTitle):"tab-"+t.index},t.prototype._loadViewForSegment=function(t,e,n){if(!e)return n(!1,!1);if(Object(i.m)(t)||Object(i.l)(t)&&t.parent){var r=Object(i.m)(t)?t:t.parent,o=r._getSelectedTabIndex(e.secondaryId),a=r.getByIndex(o);return a._segment=e,r.select(a,{updateUrl:!1,animate:!1},!0),n(!1,!1)}for(var s=t,l=s.length()-1,u=l;u>=0;u--){var c=s.getByIndex(u);if(c&&(c.id===e.id||c.id===e.name))return u===l?n(!1,!1):s.popTo(c,{animate:!1,updateUrl:!1},n)}return s.setRoot(e.component||e.name,e.data,{id:e.id,animate:!1,updateUrl:!1},n)},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(2),i=function(){function t(){this._focused=null,this._ids=-1,this._inputs=[]}return t.prototype.register=function(t){this._inputs.push(t)},t.prototype.deregister=function(t){Object(r.q)(this._inputs,t),this.unsetAsFocused(t)},t.prototype.setAsFocused=function(t){this._focused=t},t.prototype.unsetAsFocused=function(t){t===this._focused&&(this._focused=null)},t.prototype.tabFocus=function(t){var e=this._inputs,n=e.indexOf(t)+1;if(n>0&&n<e.length){var r=e[n];if(r!==this._focused)return r.initFocus()}if((n=e.indexOf(this._focused))>0){var i=e[n-1];i&&i.initFocus()}},t.prototype.nextId=function(){return++this._ids},t}()},function(t,e,n){"use strict";var r=n(33),i=n(199),o=n(138),a=n(202);e.Observable=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var r=this.operator,o=i.toSubscriber(t,e,n);if(r?r.call(o,this.source):o.add(this.source||!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.syncErrorThrown=!0,t.syncErrorValue=e,t.error(e)}},t.prototype.forEach=function(t,e){var n=this;if(e||(r.root.Rx&&r.root.Rx.config&&r.root.Rx.config.Promise?e=r.root.Rx.config.Promise:r.root.Promise&&(e=r.root.Promise)),!e)throw new Error("no Promise impl found");return new e(function(e,r){var i;i=n.subscribe(function(e){if(i)try{t(e)}catch(t){r(t),i.unsubscribe()}else t(e)},r,e)})},t.prototype._subscribe=function(t){return this.source.subscribe(t)},t.prototype[o.observable]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return 0===t.length?this:a.pipeFromArray(t)(this)},t.prototype.toPromise=function(t){var e=this;if(t||(r.root.Rx&&r.root.Rx.config&&r.root.Rx.config.Promise?t=r.root.Rx.config.Promise:r.root.Promise&&(t=r.root.Promise)),!t)throw new Error("no Promise impl found");return new t(function(t,n){var r;e.subscribe(function(t){return r=t},function(t){return n(t)},function(){return t(r)})})},t.create=function(e){return new t(e)},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(2),i=function(){function t(t,e,n){this._dur=null,this._es=null,this._rvEs=null,this.hasChildren=!1,this.isPlaying=!1,this.hasCompleted=!1,this.plt=t,this.element(e),this.opts=n}return t.prototype.element=function(t){if(t)if("string"==typeof t){t=this.plt.doc().querySelectorAll(t);for(var e=0;e<t.length;e++)this._addEle(t[e])}else if(t.length)for(e=0;e<t.length;e++)this._addEle(t[e]);else this._addEle(t);return this},t.prototype._addEle=function(t){t.nativeElement&&(t=t.nativeElement),1===t.nodeType&&(this._eL=(this._e=this._e||[]).push(t))},t.prototype.add=function(t){return t.parent=this,this.hasChildren=!0,this._cL=(this._c=this._c||[]).push(t),this},t.prototype.getDuration=function(t){return t&&Object(r.h)(t.duration)?t.duration:null!==this._dur?this._dur:this.parent?this.parent.getDuration():0},t.prototype.isRoot=function(){return!this.parent},t.prototype.duration=function(t){return this._dur=t,this},t.prototype.getEasing=function(){return this._rv&&this._rvEs?this._rvEs:null!==this._es?this._es:this.parent&&this.parent.getEasing()||null},t.prototype.easing=function(t){return this._es=t,this},t.prototype.easingReverse=function(t){return this._rvEs=t,this},t.prototype.from=function(t,e){return this._addProp("from",t,e),this},t.prototype.to=function(t,e,n){var r=this._addProp("to",t,e);return n&&this.afterClearStyles([r.trans?this.plt.Css.transform:t]),this},t.prototype.fromTo=function(t,e,n,r){return this.from(t,e).to(t,n,r)},t.prototype._getProp=function(t){return this._fx?this._fx.find(function(e){return e.name===t}):(this._fx=[],null)},t.prototype._addProp=function(t,e,n){var r=this._getProp(e);if(!r){var i=1===o[e];this._fx.push(r={name:e,trans:i,wc:i?this.plt.Css.transform:e})}var s={val:n,num:null,unit:""};if(r[t]=s,"string"==typeof n&&n.indexOf(" ")<0){var l=n.match(a),u=parseFloat(l[1]);isNaN(u)||(s.num=u),s.unit=l[0]!==l[2]?l[2]:""}else"number"==typeof n&&(s.num=n);return r},t.prototype.beforeAddClass=function(t){return(this._bfAdd=this._bfAdd||[]).push(t),this},t.prototype.beforeRemoveClass=function(t){return(this._bfRm=this._bfRm||[]).push(t),this},t.prototype.beforeStyles=function(t){return this._bfSty=t,this},t.prototype.beforeClearStyles=function(t){this._bfSty=this._bfSty||{};for(var e=0;e<t.length;e++)this._bfSty[t[e]]="";return this},t.prototype.beforeAddRead=function(t){return(this._rdFn=this._rdFn||[]).push(t),this},t.prototype.beforeAddWrite=function(t){return(this._wrFn=this._wrFn||[]).push(t),this},t.prototype.afterAddClass=function(t){return(this._afAdd=this._afAdd||[]).push(t),this},t.prototype.afterRemoveClass=function(t){return(this._afRm=this._afRm||[]).push(t),this},t.prototype.afterStyles=function(t){return this._afSty=t,this},t.prototype.afterClearStyles=function(t){this._afSty=this._afSty||{};for(var e=0;e<t.length;e++)this._afSty[t[e]]="";return this},t.prototype.play=function(t){var e=this;this.plt&&(this._isAsync=this._hasDuration(t),this._clearAsync(),this._playInit(t),this.plt.raf(function(){e.plt.raf(e._playDomInspect.bind(e,t))}))},t.prototype.syncPlay=function(){if(this.plt){var t={duration:0};this._isAsync=!1,this._clearAsync(),this._playInit(t),this._playDomInspect(t)}},t.prototype._playInit=function(t){this._twn=!1,this.isPlaying=!0,this.hasCompleted=!1,this._hasDur=this.getDuration(t)>s;for(var e=this._c,n=0;n<this._cL;n++)e[n]._playInit(t);this._hasDur&&(this._progress(0),this._willChg(!0))},t.prototype._playDomInspect=function(t){this._beforeAnimation();var e=this.getDuration(t);this._isAsync&&this._asyncEnd(e,!0),this._playProgress(t),this._isAsync&&this.plt&&this.plt.raf(this._playToStep.bind(this,1))},t.prototype._playProgress=function(t){for(var e=this._c,n=0;n<this._cL;n++)e[n]._playProgress(t);this._hasDur?this._setTrans(this.getDuration(t),!1):(this._progress(1),this._setAfterStyles(),this._didFinish(!0))},t.prototype._playToStep=function(t){for(var e=this._c,n=0;n<this._cL;n++)e[n]._playToStep(t);this._hasDur&&this._progress(t)},t.prototype._asyncEnd=function(t,e){var n=this;n._unrgTrns=this.plt.transitionEnd(n._transEl(),function(){n._clearAsync(),n._playEnd(),n._didFinishAll(e,!0,!1)},!1),n._tm=n.plt.timeout(function(){n._tm=void 0,n._clearAsync(),n._playEnd(e?1:0),n._didFinishAll(e,!0,!1)},t+l)},t.prototype._playEnd=function(t){for(var e=this._c,n=0;n<this._cL;n++)e[n]._playEnd(t);this._hasDur&&(Object(r.h)(t)&&(this._setTrans(0,!0),this._progress(t)),this._setAfterStyles(),this._willChg(!1))},t.prototype._hasDuration=function(t){if(this.getDuration(t)>s)return!0;for(var e=this._c,n=0;n<this._cL;n++)if(e[n]._hasDuration(t))return!0;return!1},t.prototype._hasDomReads=function(){if(this._rdFn&&this._rdFn.length)return!0;for(var t=this._c,e=0;e<this._cL;e++)if(t[e]._hasDomReads())return!0;return!1},t.prototype.stop=function(t){void 0===t&&(t=1),this._clearAsync(),this._hasDur=!0,this._playEnd(t)},t.prototype._clearAsync=function(){this._unrgTrns&&this._unrgTrns(),this._tm&&clearTimeout(this._tm),this._tm=this._unrgTrns=void 0},t.prototype._progress=function(t){var e,n=this._fx,r=this._eL;if(n&&r){this._rv&&(t=-1*t+1);var i,o,a="",s=this._e;for(i=0;i<n.length;i++){var l=n[i];if(l.from&&l.to){var u=l.from.num,c=l.to.num,h=u!==c;if(h&&(this._twn=!0),0===t)e=l.from.val;else if(1===t)e=l.to.val;else if(h){var p=(c-u)*t+u,d=l.to.unit;"px"===d&&(p=Math.round(p)),e=p+d}if(null!==e){var f=l.name;if(l.trans)a+=f+"("+e+") ";else for(o=0;o<r;o++)s[o].style[f]=e}}}if(a.length){(!this._rv&&1!==t||this._rv&&0!==t)&&(a+="translateZ(0px)");var m=this.plt.Css.transform;for(i=0;i<s.length;i++)s[i].style[m]=a}}},t.prototype._setTrans=function(t,e){if(this._fx)for(var n,r=this._e,i=e?"linear":this.getEasing(),o=t+"ms",a=this.plt.Css,s=a.transition,l=a.transitionDuration,u=a.transitionTimingFn,c=0;c<this._eL;c++)n=r[c].style,t>0?(n[s]="",n[l]=o,i&&(n[u]=i)):n[s]="none"},t.prototype._beforeAnimation=function(){this._fireBeforeReadFunc(),this._fireBeforeWriteFunc(),this._setBeforeStyles()},t.prototype._setBeforeStyles=function(){var t,e,n=this._c;for(t=0;t<this._cL;t++)n[t]._setBeforeStyles();if(!this._rv){var r,i,o,a=this._bfAdd,s=this._bfRm;for(t=0;t<this._eL;t++){if(r=this._e[t],i=r.classList,a)for(e=0;e<a.length;e++)i.add(a[e]);if(s)for(e=0;e<s.length;e++)i.remove(s[e]);if(this._bfSty)for(o in this._bfSty)r.style[o]=this._bfSty[o]}}},t.prototype._fireBeforeReadFunc=function(){for(var t=this._c,e=0;e<this._cL;e++)t[e]._fireBeforeReadFunc();var n=this._rdFn;if(n)for(e=0;e<n.length;e++)n[e]()},t.prototype._fireBeforeWriteFunc=function(){for(var t=this._c,e=0;e<this._cL;e++)t[e]._fireBeforeWriteFunc();var n=this._wrFn;if(this._wrFn)for(e=0;e<n.length;e++)n[e]()},t.prototype._setAfterStyles=function(){var t,e,n,r,i=this._e;for(t=0;t<this._eL;t++)if(n=i[t],r=n.classList,n.style[this.plt.Css.transitionDuration]=n.style[this.plt.Css.transitionTimingFn]="",this._rv){if(this._bfAdd)for(e=0;e<this._bfAdd.length;e++)r.remove(this._bfAdd[e]);if(this._bfRm)for(e=0;e<this._bfRm.length;e++)r.add(this._bfRm[e]);if(this._bfSty)for(var o in this._bfSty)n.style[o]=""}else{if(this._afAdd)for(e=0;e<this._afAdd.length;e++)r.add(this._afAdd[e]);if(this._afRm)for(e=0;e<this._afRm.length;e++)r.remove(this._afRm[e]);if(this._afSty)for(var o in this._afSty)n.style[o]=this._afSty[o]}},t.prototype._willChg=function(t){var e,n,r=this._fx;if(t&&r){e=[];for(var i=0;i<r.length;i++){var o=r[i].wc;"webkitTransform"===o?e.push("transform","-webkit-transform"):e.push(o)}n=e.join(",")}else n="";for(i=0;i<this._eL;i++)this._e[i].style.willChange=n},t.prototype.progressStart=function(){this._clearAsync(),this._beforeAnimation(),this._progressStart()},t.prototype._progressStart=function(){for(var t=this._c,e=0;e<this._cL;e++)t[e]._progressStart();this._setTrans(0,!0),this._willChg(!0)},t.prototype.progressStep=function(t){t=Math.min(1,Math.max(0,t));for(var e=this._c,n=0;n<this._cL;n++)e[n].progressStep(t);this._rv&&(t=-1*t+1),this._progress(t)},t.prototype.progressEnd=function(t,e,n){void 0===n&&(n=-1),this._rv&&(e=-1*e+1);var r=t?1:0;Math.abs(e-r)<.05?n=0:n<0&&(n=this._dur),this._isAsync=n>30,this._progressEnd(t,r,n,this._isAsync),this._isAsync&&(this._asyncEnd(n,t),this.plt&&this.plt.raf(this._playToStep.bind(this,r)))},t.prototype._progressEnd=function(t,e,n,r){for(var i=this._c,o=0;o<this._cL;o++)i[o]._progressEnd(t,e,n,r);r?(this.isPlaying=!0,this.hasCompleted=!1,this._hasDur=!0,this._willChg(!0),this._setTrans(n,!1)):(this._progress(e),this._willChg(!1),this._setAfterStyles(),this._didFinish(t))},t.prototype.onFinish=function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),n&&(this._fFn=this._fOneFn=void 0),e?(this._fOneFn=this._fOneFn||[],this._fOneFn.push(t)):(this._fFn=this._fFn||[],this._fFn.push(t)),this},t.prototype._didFinishAll=function(t,e,n){for(var r=this._c,i=0;i<this._cL;i++)r[i]._didFinishAll(t,e,n);(e&&this._isAsync||n&&!this._isAsync)&&this._didFinish(t)},t.prototype._didFinish=function(t){if(this.isPlaying=!1,this.hasCompleted=t,this._fFn)for(var e=0;e<this._fFn.length;e++)this._fFn[e](this);if(this._fOneFn){for(e=0;e<this._fOneFn.length;e++)this._fOneFn[e](this);this._fOneFn.length=0}},t.prototype.reverse=function(t){void 0===t&&(t=!0);for(var e=this._c,n=0;n<this._cL;n++)e[n].reverse(t);return this._rv=t,this},t.prototype.destroy=function(){for(var t=this._c,e=0;e<this._cL;e++)t[e].destroy();this._clearAsync(),this.parent=this.plt=this._e=this._rdFn=this._wrFn=null,this._c&&(this._c.length=this._cL=0),this._fFn&&(this._fFn.length=0),this._fOneFn&&(this._fOneFn.length=0)},t.prototype._transEl=function(){for(var t,e=0;e<this._cL;e++)if(t=this._c[e]._transEl())return t;return this._twn&&this._hasDur&&this._eL?this._e[0]:null},t}(),o={translateX:1,translateY:1,translateZ:1,scale:1,scaleX:1,scaleY:1,scaleZ:1,rotate:1,rotateX:1,rotateY:1,rotateZ:1,skewX:1,skewY:1,perspective:1},a=/(^-?\d*\.?\d*)(.*)/,s=32,l=400},function(t,e,n){"use strict";function r(t){return t.replace(/\/index.html$/,"")}function i(t,e){return u(h(t)[10],e)}function o(t,e){return u(h(t)[11],e)}function a(t,e){return u(h(t)[12],e)}function s(t,e){var n=h(t),r=n[13][e];if(void 0===r){if(e===j.CurrencyDecimal)return n[13][j.Decimal];if(e===j.CurrencyGroup)return n[13][j.Group]}return r}function l(t){if(!t[18])throw new Error('Missing extra locale data for the locale "'+t[0]+'". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.')}function u(t,e){for(var n=e;n>-1;n--)if(void 0!==t[n])return t[n];throw new Error("Locale data API: locale data undefined")}function c(t){var e=t.split(":");return{hours:+e[0],minutes:+e[1]}}function h(t){var e=t.toLowerCase().replace(/_/g,"-"),n=D[e];if(n)return n;var r=e.split("-")[0];if(n=D[r])return n;if("en"===r)return I;throw new Error('Missing locale data for the locale "'+t+'".')}function p(t,e){e=encodeURIComponent(e);for(var n=0,r=t.split(";");n<r.length;n++){var i=r[n],o=i.indexOf("="),a=-1==o?[i,""]:[i.slice(0,o),i.slice(o+1)],s=a[1];if(a[0].trim()===e)return decodeURIComponent(s)}return null}function d(t,e,n,r){e=f(n,e)||e;for(var i,o=[];e;){if(!(i=et.exec(e))){o.push(e);break}var a=(o=o.concat(i.slice(1))).pop();if(!a)break;e=a}var s=t.getTimezoneOffset();r&&(s=x(r,s),t=function(t,e,n){var r=n?-1:1,i=t.getTimezoneOffset(),o=x(e,i);return function(t,e){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+e),t}(t,r*(o-i))}(t,r,!0));var l="";return o.forEach(function(e){var r=function(t){if(st[t])return st[t];var e;switch(t){case"G":case"GG":case"GGG":e=y(it.Eras,k.Abbreviated);break;case"GGGG":e=y(it.Eras,k.Wide);break;case"GGGGG":e=y(it.Eras,k.Narrow);break;case"y":e=g(rt.FullYear,1,0,!1,!0);break;case"yy":e=g(rt.FullYear,2,0,!0,!0);break;case"yyy":e=g(rt.FullYear,3,0,!1,!0);break;case"yyyy":e=g(rt.FullYear,4,0,!1,!0);break;case"M":case"L":e=g(rt.Month,1,1);break;case"MM":case"LL":e=g(rt.Month,2,1);break;case"MMM":e=y(it.Months,k.Abbreviated);break;case"MMMM":e=y(it.Months,k.Wide);break;case"MMMMM":e=y(it.Months,k.Narrow);break;case"LLL":e=y(it.Months,k.Abbreviated,R.Standalone);break;case"LLLL":e=y(it.Months,k.Wide,R.Standalone);break;case"LLLLL":e=y(it.Months,k.Narrow,R.Standalone);break;case"w":e=_(1);break;case"ww":e=_(2);break;case"W":e=_(1,!0);break;case"d":e=g(rt.Date,1);break;case"dd":e=g(rt.Date,2);break;case"E":case"EE":case"EEE":e=y(it.Days,k.Abbreviated);break;case"EEEE":e=y(it.Days,k.Wide);break;case"EEEEE":e=y(it.Days,k.Narrow);break;case"EEEEEE":e=y(it.Days,k.Short);break;case"a":case"aa":case"aaa":e=y(it.DayPeriods,k.Abbreviated);break;case"aaaa":e=y(it.DayPeriods,k.Wide);break;case"aaaaa":e=y(it.DayPeriods,k.Narrow);break;case"b":case"bb":case"bbb":e=y(it.DayPeriods,k.Abbreviated,R.Standalone,!0);break;case"bbbb":e=y(it.DayPeriods,k.Wide,R.Standalone,!0);break;case"bbbbb":e=y(it.DayPeriods,k.Narrow,R.Standalone,!0);break;case"B":case"BB":case"BBB":e=y(it.DayPeriods,k.Abbreviated,R.Format,!0);break;case"BBBB":e=y(it.DayPeriods,k.Wide,R.Format,!0);break;case"BBBBB":e=y(it.DayPeriods,k.Narrow,R.Format,!0);break;case"h":e=g(rt.Hours,1,-12);break;case"hh":e=g(rt.Hours,2,-12);break;case"H":e=g(rt.Hours,1);break;case"HH":e=g(rt.Hours,2);break;case"m":e=g(rt.Minutes,1);break;case"mm":e=g(rt.Minutes,2);break;case"s":e=g(rt.Seconds,1);break;case"ss":e=g(rt.Seconds,2);break;case"S":e=g(rt.Milliseconds,1);break;case"SS":e=g(rt.Milliseconds,2);break;case"SSS":e=g(rt.Milliseconds,3);break;case"Z":case"ZZ":case"ZZZ":e=b(nt.Short);break;case"ZZZZZ":e=b(nt.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=b(nt.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=b(nt.Long);break;default:return null}return st[t]=e,e}(e);l+=r?r(t,n,s):"''"===e?"'":e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}function f(t,e){var n=function(t){return h(t)[0]}(t);if(tt[n]=tt[n]||{},tt[n][e])return tt[n][e];var r="";switch(e){case"shortDate":r=i(t,U.Short);break;case"mediumDate":r=i(t,U.Medium);break;case"longDate":r=i(t,U.Long);break;case"fullDate":r=i(t,U.Full);break;case"shortTime":r=o(t,U.Short);break;case"mediumTime":r=o(t,U.Medium);break;case"longTime":r=o(t,U.Long);break;case"fullTime":r=o(t,U.Full);break;case"short":var s=f(t,"shortTime"),l=f(t,"shortDate");r=m(a(t,U.Short),[s,l]);break;case"medium":var u=f(t,"mediumTime"),c=f(t,"mediumDate");r=m(a(t,U.Medium),[u,c]);break;case"long":var p=f(t,"longTime"),d=f(t,"longDate");r=m(a(t,U.Long),[p,d]);break;case"full":var v=f(t,"fullTime"),g=f(t,"fullDate");r=m(a(t,U.Full),[v,g])}return r&&(tt[n][e]=r),r}function m(t,e){return e&&(t=t.replace(/\{([^}]+)}/g,function(t,n){return null!=e&&n in e?e[n]:t})),t}function v(t,e,n,r,i){void 0===n&&(n="-");var o="";(t<0||i&&t<=0)&&(i?t=1-t:(t=-t,o=n));for(var a=""+t;a.length<e;)a="0"+a;return r&&(a=a.substr(a.length-e)),o+a}function g(t,e,n,r,i){return void 0===n&&(n=0),void 0===r&&(r=!1),void 0===i&&(i=!1),function(o,a){var l=function(t,e,n){switch(t){case rt.FullYear:return e.getFullYear();case rt.Month:return e.getMonth();case rt.Date:return e.getDate();case rt.Hours:return e.getHours();case rt.Minutes:return e.getMinutes();case rt.Seconds:return e.getSeconds();case rt.Milliseconds:var r=1===n?100:2===n?10:1;return Math.round(e.getMilliseconds()/r);case rt.Day:return e.getDay();default:throw new Error('Unknown DateType value "'+t+'".')}}(t,o,e);return(n>0||l>-n)&&(l+=n),t===rt.Hours&&0===l&&-12===n&&(l=12),v(l,e,s(a,j.MinusSign),r,i)}}function y(t,e,n,r){return void 0===n&&(n=R.Format),void 0===r&&(r=!1),function(i,o){return function(t,e,n,r,i,o){switch(n){case it.Months:return function(t,e,n){var r=h(t);return u(u([r[5],r[6]],e),n)}(e,i,r)[t.getMonth()];case it.Days:return function(t,e,n){var r=h(t);return u(u([r[3],r[4]],e),n)}(e,i,r)[t.getDay()];case it.DayPeriods:var a=t.getHours(),s=t.getMinutes();if(o){var p,d=function(t){var e=h(t);return l(e),(e[18][2]||[]).map(function(t){return"string"==typeof t?c(t):[c(t[0]),c(t[1])]})}(e),f=function(t,e,n){var r=h(t);return l(r),u(u([r[18][0],r[18][1]],e)||[],n)||[]}(e,i,r);if(d.forEach(function(t,e){if(Array.isArray(t)){var n=t[0],r=n.hours,i=n.minutes,o=t[1],l=o.hours,u=o.minutes;a>=r&&s>=i&&(a<l||a===l&&s<u)&&(p=f[e])}else{var c=t.hours,h=t.minutes;c===a&&h===s&&(p=f[e])}}),p)return p}return function(t,e,n){var r=h(t);return u(u([r[1],r[2]],e),n)}(e,i,r)[a<12?0:1];case it.Eras:return function(t,e){return u(h(t)[7],e)}(e,r)[t.getFullYear()<=0?0:1];default:var m=n;throw new Error("unexpected translation type "+m)}}(i,o,t,e,n,r)}}function b(t){return function(e,n,r){var i=-1*r,o=s(n,j.MinusSign),a=i>0?Math.floor(i/60):Math.ceil(i/60);switch(t){case nt.Short:return(i>=0?"+":"")+v(a,2,o)+v(Math.abs(i%60),2,o);case nt.ShortGMT:return"GMT"+(i>=0?"+":"")+v(a,1,o);case nt.Long:return"GMT"+(i>=0?"+":"")+v(a,2,o)+":"+v(Math.abs(i%60),2,o);case nt.Extended:return 0===r?"Z":(i>=0?"+":"")+v(a,2,o)+":"+v(Math.abs(i%60),2,o);default:throw new Error('Unknown zone width "'+t+'"')}}}function _(t,e){return void 0===e&&(e=!1),function(n,r){var i;if(e){var o=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,a=n.getDate();i=1+Math.floor((a+o)/7)}else{var l=function(t){var e=new Date(t,ot,1).getDay();return new Date(t,0,1+(e<=at?at:at+7)-e)}(n.getFullYear()),u=function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate()+(at-t.getDay()))}(n).getTime()-l.getTime();i=1+Math.round(u/6048e5)}return v(i,t,s(r,j.MinusSign))}}function x(t,e){t=t.replace(/:/g,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(n)?e:n}function w(t,e){return Error("InvalidPipeArgument: '"+e+"' for pipe '"+Object(M._19)(t)+"'")}function S(t){var e=new Date(0),n=0,r=0,i=t[8]?e.setUTCHours:e.setHours;t[9]&&(n=+(t[9]+t[10]),r=+(t[9]+t[11])),(t[8]?e.setUTCFullYear:e.setFullYear).call(e,+t[1],+t[2]-1,+t[3]);var o=+(t[4]||"0")-n,a=+(t[5]||"0")-r,s=+(t[6]||"0"),l=Math.round(1e3*parseFloat("0."+(t[7]||0)));return i.call(e,o,a,s,l),e}function A(t){return t instanceof Date&&!isNaN(t.valueOf())}n.d(e,"k",function(){return V}),n.d(e,"l",function(){return z}),n.d(e,"u",function(){return p}),n.d(e,"b",function(){return ct}),n.d(e,"h",function(){return G}),n.d(e,"i",function(){return W}),n.d(e,"j",function(){return Y}),n.d(e,"m",function(){return $}),n.d(e,"n",function(){return Q}),n.d(e,"o",function(){return J}),n.d(e,"p",function(){return K}),n.d(e,"c",function(){return ht}),n.d(e,"d",function(){return ut}),n.d(e,"s",function(){return pt}),n.d(e,"r",function(){return C}),n.d(e,"g",function(){return E}),n.d(e,"a",function(){return P}),n.d(e,"e",function(){return N}),n.d(e,"q",function(){return L}),n.d(e,"f",function(){return O}),n.d(e,"t",function(){return B});var M=n(0),T=n(5),C=function(){return function(){}}(),E=function(){return function(){}}(),P=new M.n("appBaseHref"),O=function(){function t(e){var n=this;this._subject=new M.l,this._platformStrategy=e;var i=this._platformStrategy.getBaseHref();this._baseHref=t.stripTrailingSlash(r(i)),this._platformStrategy.onPopState(function(t){n._subject.emit({url:n.path(!0),pop:!0,type:t.type})})}return t.prototype.path=function(t){return void 0===t&&(t=!1),this.normalize(this._platformStrategy.path(t))},t.prototype.isCurrentPathEqualTo=function(e,n){return void 0===n&&(n=""),this.path()==this.normalize(e+t.normalizeQueryParams(n))},t.prototype.normalize=function(e){return t.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,r(e)))},t.prototype.prepareExternalUrl=function(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)},t.prototype.go=function(t,e){void 0===e&&(e=""),this._platformStrategy.pushState(null,"",t,e)},t.prototype.replaceState=function(t,e){void 0===e&&(e=""),this._platformStrategy.replaceState(null,"",t,e)},t.prototype.forward=function(){this._platformStrategy.forward()},t.prototype.back=function(){this._platformStrategy.back()},t.prototype.subscribe=function(t,e,n){return this._subject.subscribe({next:t,error:e,complete:n})},t.normalizeQueryParams=function(t){return t&&"?"!==t[0]?"?"+t:t},t.joinWithSlash=function(t,e){if(0==t.length)return e;if(0==e.length)return t;var n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e},t.stripTrailingSlash=function(t){var e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)},t}(),N=function(t){function e(e,n){var r=t.call(this)||this;return r._platformLocation=e,r._baseHref="",null!=n&&(r._baseHref=n),r}return Object(T.__extends)(e,t),e.prototype.onPopState=function(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)},e.prototype.getBaseHref=function(){return this._baseHref},e.prototype.path=function(t){void 0===t&&(t=!1);var e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e},e.prototype.prepareExternalUrl=function(t){var e=O.joinWithSlash(this._baseHref,t);return e.length>0?"#"+e:e},e.prototype.pushState=function(t,e,n,r){var i=this.prepareExternalUrl(n+O.normalizeQueryParams(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(t,e,i)},e.prototype.replaceState=function(t,e,n,r){var i=this.prepareExternalUrl(n+O.normalizeQueryParams(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(t,e,i)},e.prototype.forward=function(){this._platformLocation.forward()},e.prototype.back=function(){this._platformLocation.back()},e}(E),L=function(t){function e(e,n){var r=t.call(this)||this;if(r._platformLocation=e,null==n&&(n=r._platformLocation.getBaseHrefFromDOM()),null==n)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return r._baseHref=n,r}return Object(T.__extends)(e,t),e.prototype.onPopState=function(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)},e.prototype.getBaseHref=function(){return this._baseHref},e.prototype.prepareExternalUrl=function(t){return O.joinWithSlash(this._baseHref,t)},e.prototype.path=function(t){void 0===t&&(t=!1);var e=this._platformLocation.pathname+O.normalizeQueryParams(this._platformLocation.search),n=this._platformLocation.hash;return n&&t?""+e+n:e},e.prototype.pushState=function(t,e,n,r){var i=this.prepareExternalUrl(n+O.normalizeQueryParams(r));this._platformLocation.pushState(t,e,i)},e.prototype.replaceState=function(t,e,n,r){var i=this.prepareExternalUrl(n+O.normalizeQueryParams(r));this._platformLocation.replaceState(t,e,i)},e.prototype.forward=function(){this._platformLocation.forward()},e.prototype.back=function(){this._platformLocation.back()},e}(E),I=["en",[["a","p"],["AM","PM"]],[["AM","PM"],,],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",,"{1} 'at' {0}"],[".",",",";","%","+","-","E","","","","NaN",":"],["#,##0.###","#,##0%","#,##0.00","#E0"],"$","US Dollar",function(t){var e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}],D={},F=function(){var t={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return t[t.Zero]="Zero",t[t.One]="One",t[t.Two]="Two",t[t.Few]="Few",t[t.Many]="Many",t[t.Other]="Other",t}(),R=function(){var t={Format:0,Standalone:1};return t[t.Format]="Format",t[t.Standalone]="Standalone",t}(),k=function(){var t={Narrow:0,Abbreviated:1,Wide:2,Short:3};return t[t.Narrow]="Narrow",t[t.Abbreviated]="Abbreviated",t[t.Wide]="Wide",t[t.Short]="Short",t}(),U=function(){var t={Short:0,Medium:1,Long:2,Full:3};return t[t.Short]="Short",t[t.Medium]="Medium",t[t.Long]="Long",t[t.Full]="Full",t}(),j=function(){var t={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};return t[t.Decimal]="Decimal",t[t.Group]="Group",t[t.List]="List",t[t.PercentSign]="PercentSign",t[t.PlusSign]="PlusSign",t[t.MinusSign]="MinusSign",t[t.Exponential]="Exponential",t[t.SuperscriptingExponent]="SuperscriptingExponent",t[t.PerMille]="PerMille",t[t.Infinity]="Infinity",t[t.NaN]="NaN",t[t.TimeSeparator]="TimeSeparator",t[t.CurrencyDecimal]="CurrencyDecimal",t[t.CurrencyGroup]="CurrencyGroup",t}(),B=new M.n("UseV4Plurals"),z=function(){return function(){}}(),V=function(t){function e(e,n){var r=t.call(this)||this;return r.locale=e,r.deprecatedPluralFn=n,r}return Object(T.__extends)(e,t),e.prototype.getPluralCategory=function(t,e){switch(this.deprecatedPluralFn?this.deprecatedPluralFn(e||this.locale,t):function(t){return h(t)[17]}(e||this.locale)(t)){case F.Zero:return"zero";case F.One:return"one";case F.Two:return"two";case F.Few:return"few";case F.Many:return"many";default:return"other"}},e}(z),G=function(){function t(t,e,n,r){this._iterableDiffers=t,this._keyValueDiffers=e,this._ngEl=n,this._renderer=r,this._initialClasses=[]}return Object.defineProperty(t.prototype,"klass",{set:function(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ngClass",{set:function(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&(Object(M._3)(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())},enumerable:!0,configurable:!0}),t.prototype.ngDoCheck=function(){if(this._iterableDiffer){var t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){var e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}},t.prototype._applyKeyValueChanges=function(t){var e=this;t.forEachAddedItem(function(t){return e._toggleClass(t.key,t.currentValue)}),t.forEachChangedItem(function(t){return e._toggleClass(t.key,t.currentValue)}),t.forEachRemovedItem(function(t){t.previousValue&&e._toggleClass(t.key,!1)})},t.prototype._applyIterableChanges=function(t){var e=this;t.forEachAddedItem(function(t){if("string"!=typeof t.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got "+Object(M._19)(t.item));e._toggleClass(t.item,!0)}),t.forEachRemovedItem(function(t){return e._toggleClass(t.item,!1)})},t.prototype._applyClasses=function(t){var e=this;t&&(Array.isArray(t)||t instanceof Set?t.forEach(function(t){return e._toggleClass(t,!0)}):Object.keys(t).forEach(function(n){return e._toggleClass(n,!!t[n])}))},t.prototype._removeClasses=function(t){var e=this;t&&(Array.isArray(t)||t instanceof Set?t.forEach(function(t){return e._toggleClass(t,!1)}):Object.keys(t).forEach(function(t){return e._toggleClass(t,!1)}))},t.prototype._toggleClass=function(t,e){var n=this;(t=t.trim())&&t.split(/\s+/g).forEach(function(t){e?n._renderer.addClass(n._ngEl.nativeElement,t):n._renderer.removeClass(n._ngEl.nativeElement,t)})},t}(),H=function(){function t(t,e,n,r){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=r}return Object.defineProperty(t.prototype,"first",{get:function(){return 0===this.index},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"last",{get:function(){return this.index===this.count-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"even",{get:function(){return this.index%2==0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"odd",{get:function(){return!this.even},enumerable:!0,configurable:!0}),t}(),W=function(){function t(t,e,n){this._viewContainer=t,this._template=e,this._differs=n,this._differ=null}return Object.defineProperty(t.prototype,"ngForTrackBy",{get:function(){return this._trackByFn},set:function(t){Object(M.P)()&&null!=t&&"function"!=typeof t&&console&&console.warn&&console.warn("trackBy must be a function, but received "+JSON.stringify(t)+". See https://angular.io/docs/ts/latest/api/common/index/NgFor-directive.html#!#change-propagation for more information."),this._trackByFn=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ngForTemplate",{set:function(t){t&&(this._template=t)},enumerable:!0,configurable:!0}),t.prototype.ngOnChanges=function(t){if("ngForOf"in t){var e=t.ngForOf.currentValue;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(t){throw new Error("Cannot find a differ supporting object '"+e+"' of type '"+function(t){return t.name||typeof t}(e)+"'. NgFor only supports binding to Iterables such as Arrays.")}}},t.prototype.ngDoCheck=function(){if(this._differ){var t=this._differ.diff(this.ngForOf);t&&this._applyChanges(t)}},t.prototype._applyChanges=function(t){var e=this,n=[];t.forEachOperation(function(t,r,i){if(null==t.previousIndex){var o=e._viewContainer.createEmbeddedView(e._template,new H(null,e.ngForOf,-1,-1),i),a=new X(t,o);n.push(a)}else if(null==i)e._viewContainer.remove(r);else{o=e._viewContainer.get(r);e._viewContainer.move(o,i);a=new X(t,o);n.push(a)}});for(var r=0;r<n.length;r++)this._perViewChange(n[r].view,n[r].record);r=0;for(var i=this._viewContainer.length;r<i;r++){var o=this._viewContainer.get(r);o.context.index=r,o.context.count=i}t.forEachIdentityChange(function(t){e._viewContainer.get(t.currentIndex).context.$implicit=t.item})},t.prototype._perViewChange=function(t,e){t.context.$implicit=e.item},t}(),X=function(){return function(t,e){this.record=t,this.view=e}}(),Y=function(){function t(t,e){this._viewContainer=t,this._context=new q,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=e}return Object.defineProperty(t.prototype,"ngIf",{set:function(t){this._context.$implicit=this._context.ngIf=t,this._updateView()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ngIfThen",{set:function(t){this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ngIfElse",{set:function(t){this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()},enumerable:!0,configurable:!0}),t.prototype._updateView=function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))},t}(),q=function(){return function(){this.$implicit=null,this.ngIf=null}}(),Z=function(){function t(t,e){this._viewContainerRef=t,this._templateRef=e,this._created=!1}return t.prototype.create=function(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)},t.prototype.destroy=function(){this._created=!1,this._viewContainerRef.clear()},t.prototype.enforceState=function(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()},t}(),Q=function(){function t(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}return Object.defineProperty(t.prototype,"ngSwitch",{set:function(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)},enumerable:!0,configurable:!0}),t.prototype._addCase=function(){return this._caseCount++},t.prototype._addDefault=function(t){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(t)},t.prototype._matchCase=function(t){var e=t==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||e,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),e},t.prototype._updateDefaultCases=function(t){if(this._defaultViews&&t!==this._defaultUsed){this._defaultUsed=t;for(var e=0;e<this._defaultViews.length;e++){this._defaultViews[e].enforceState(t)}}},t}(),J=function(){function t(t,e,n){this.ngSwitch=n,n._addCase(),this._view=new Z(t,e)}return t.prototype.ngDoCheck=function(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))},t}(),K=function(){return function(t,e,n){n._addDefault(new Z(t,e))}}(),$=function(){function t(t,e,n){this._differs=t,this._ngEl=e,this._renderer=n}return Object.defineProperty(t.prototype,"ngStyle",{set:function(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())},enumerable:!0,configurable:!0}),t.prototype.ngDoCheck=function(){if(this._differ){var t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}},t.prototype._applyChanges=function(t){var e=this;t.forEachRemovedItem(function(t){return e._setStyle(t.key,null)}),t.forEachAddedItem(function(t){return e._setStyle(t.key,t.currentValue)}),t.forEachChangedItem(function(t){return e._setStyle(t.key,t.currentValue)})},t.prototype._setStyle=function(t,e){var n=t.split("."),r=n[0],i=n[1];null!=(e=null!=e&&i?""+e+i:e)?this._renderer.setStyle(this._ngEl.nativeElement,r,e):this._renderer.removeStyle(this._ngEl.nativeElement,r)},t}(),tt={},et=/((?:[^GyMLwWdEabBhHmsSzZO']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,nt=function(){var t={Short:0,ShortGMT:1,Long:2,Extended:3};return t[t.Short]="Short",t[t.ShortGMT]="ShortGMT",t[t.Long]="Long",t[t.Extended]="Extended",t}(),rt=function(){var t={FullYear:0,Month:1,Date:2,Hours:3,Minutes:4,Seconds:5,Milliseconds:6,Day:7};return t[t.FullYear]="FullYear",t[t.Month]="Month",t[t.Date]="Date",t[t.Hours]="Hours",t[t.Minutes]="Minutes",t[t.Seconds]="Seconds",t[t.Milliseconds]="Milliseconds",t[t.Day]="Day",t}(),it=function(){var t={DayPeriods:0,Days:1,Months:2,Eras:3};return t[t.DayPeriods]="DayPeriods",t[t.Days]="Days",t[t.Months]="Months",t[t.Eras]="Eras",t}(),ot=0,at=4,st={},lt=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,ut=function(){function t(t){this.locale=t}return t.prototype.transform=function(e,n,r,i){if(void 0===n&&(n="mediumDate"),null==e||""===e||e!=e)return null;"string"==typeof e&&(e=e.trim());var o,a;if(A(e))o=e;else if(isNaN(e-parseFloat(e)))if("string"==typeof e&&/^(\d{4}-\d{1,2}-\d{1,2})$/.test(e)){var s=e.split("-").map(function(t){return+t}),l=s[0],u=s[1],c=s[2];o=new Date(l,u-1,c)}else o="string"==typeof e&&(a=e.match(lt))?S(a):new Date(e);else o=new Date(parseFloat(e));if(!A(o))throw w(t,e);return d(o,n,i||this.locale,r)},t}(),ct=function(){return function(){}}(),ht=new M.n("DocumentToken"),pt="browser"},function(t,e,n){"use strict";function r(t){return null==t||0===t.length}function i(t){return null!=t}function o(t){var e=Object(T._5)(t)?Object(E.fromPromise)(t):t;if(!Object(T._4)(e))throw new Error("Expected validator to return Promise or Observable.");return e}function a(t){var e=t.reduce(function(t,e){return null!=e?Object(M.__assign)({},t,e):t},{});return 0===Object.keys(e).length?null:e}function s(t){return t.validate?function(e){return t.validate(e)}:t}function l(t){return t.validate?function(e){return t.validate(e)}:t}function u(){throw new Error("unimplemented")}function c(t,e){return null==t?""+e:(e&&"object"==typeof e&&(e="Object"),(t+": "+e).slice(0,50))}function h(t,e){return e.path.concat([t])}function p(t,e){t||m(e,"Cannot find control with"),e.valueAccessor||m(e,"No value accessor for form control with"),t.validator=D.compose([t.validator,e.validator]),t.asyncValidator=D.composeAsync([t.asyncValidator,e.asyncValidator]),e.valueAccessor.writeValue(t.value),function(t,e){e.valueAccessor.registerOnChange(function(n){t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&d(t,e)})}(t,e),function(t,e){t.registerOnChange(function(t,n){e.valueAccessor.writeValue(t),n&&e.viewToModelUpdate(t)})}(t,e),function(t,e){e.valueAccessor.registerOnTouched(function(){t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&d(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),e.valueAccessor.setDisabledState&&t.registerOnDisabledChange(function(t){e.valueAccessor.setDisabledState(t)}),e._rawValidators.forEach(function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange(function(){return t.updateValueAndValidity()})}),e._rawAsyncValidators.forEach(function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange(function(){return t.updateValueAndValidity()})})}function d(t,e){e.viewToModelUpdate(t._pendingValue),t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),t._pendingChange=!1}function f(t,e){null==t&&m(e,"Cannot find control with"),t.validator=D.compose([t.validator,e.validator]),t.asyncValidator=D.composeAsync([t.asyncValidator,e.asyncValidator])}function m(t,e){var n;throw n=t.path.length>1?"path: '"+t.path.join(" -> ")+"'":t.path[0]?"name: '"+t.path+"'":"unspecified name attribute",new Error(e+" "+n)}function v(t){return null!=t?D.compose(t.map(s)):null}function g(t){return null!=t?D.composeAsync(t.map(l)):null}function y(t,e){if(!t.hasOwnProperty("model"))return!1;var n=t.model;return!!n.isFirstChange()||!Object(T._6)(e,n.currentValue)}function b(t,e){t._syncPendingControls(),e.forEach(function(t){var e=t.control;"submit"===e.updateOn&&e._pendingChange&&(t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1)})}function _(t,e){if(!e)return null;Array.isArray(e)||m(t,"Value accessor was not provided as an array for form control with");var n=void 0,r=void 0,i=void 0;return e.forEach(function(e){e.constructor===U?n=e:!function(t){return X.some(function(e){return t.constructor===e})}(e)?(i&&m(t,"More than one custom value accessor matches form control with"),i=e):(r&&m(t,"More than one built-in value accessor matches form control with"),r=e)}),i||(r||(n||(m(t,"No valid value accessor for form control with"),null)))}function x(t,e){var n=t.indexOf(e);n>-1&&t.splice(n,1)}function w(t){var e=A(t)?t.validators:t;return Array.isArray(e)?v(e):e||null}function S(t,e){var n=A(e)?e.asyncValidators:t;return Array.isArray(n)?g(n):n||null}function A(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}n.d(e,"e",function(){return F}),n.d(e,"a",function(){return k}),n.d(e,"b",function(){return U}),n.d(e,"f",function(){return B}),n.d(e,"g",function(){return Z}),n.d(e,"h",function(){return ht}),n.d(e,"c",function(){return pt}),n.d(e,"d",function(){return ft}),n.d(e,"i",function(){return mt}),n.d(e,"j",function(){return dt}),n.d(e,"k",function(){return z});var M=n(5),T=n(0),C=n(220),E=n(222),P=n(149),O=n(27),N=function(){function t(){}return Object.defineProperty(t.prototype,"value",{get:function(){return this.control?this.control.value:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valid",{get:function(){return this.control?this.control.valid:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"invalid",{get:function(){return this.control?this.control.invalid:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pending",{get:function(){return this.control?this.control.pending:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"disabled",{get:function(){return this.control?this.control.disabled:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enabled",{get:function(){return this.control?this.control.enabled:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errors",{get:function(){return this.control?this.control.errors:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pristine",{get:function(){return this.control?this.control.pristine:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dirty",{get:function(){return this.control?this.control.dirty:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"touched",{get:function(){return this.control?this.control.touched:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){return this.control?this.control.status:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"untouched",{get:function(){return this.control?this.control.untouched:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"statusChanges",{get:function(){return this.control?this.control.statusChanges:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valueChanges",{get:function(){return this.control?this.control.valueChanges:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return null},enumerable:!0,configurable:!0}),t.prototype.reset=function(t){void 0===t&&(t=void 0),this.control&&this.control.reset(t)},t.prototype.hasError=function(t,e){return!!this.control&&this.control.hasError(t,e)},t.prototype.getError=function(t,e){return this.control?this.control.getError(t,e):null},t}(),L=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(M.__extends)(e,t),Object.defineProperty(e.prototype,"formDirective",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return null},enumerable:!0,configurable:!0}),e}(N),I=/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/,D=function(){function t(){}return t.min=function(t){return function(e){if(r(e.value)||r(t))return null;var n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}},t.max=function(t){return function(e){if(r(e.value)||r(t))return null;var n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}},t.required=function(t){return r(t.value)?{required:!0}:null},t.requiredTrue=function(t){return!0===t.value?null:{required:!0}},t.email=function(t){return I.test(t.value)?null:{email:!0}},t.minLength=function(t){return function(e){if(r(e.value))return null;var n=e.value?e.value.length:0;return n<t?{minlength:{requiredLength:t,actualLength:n}}:null}},t.maxLength=function(t){return function(e){var n=e.value?e.value.length:0;return n>t?{maxlength:{requiredLength:t,actualLength:n}}:null}},t.pattern=function(e){if(!e)return t.nullValidator;var n,i;return"string"==typeof e?(i="","^"!==e.charAt(0)&&(i+="^"),i+=e,"$"!==e.charAt(e.length-1)&&(i+="$"),n=new RegExp(i)):(i=e.toString(),n=e),function(t){if(r(t.value))return null;var e=t.value;return n.test(e)?null:{pattern:{requiredPattern:i,actualValue:e}}}},t.nullValidator=function(t){return null},t.compose=function(t){if(!t)return null;var e=t.filter(i);return 0==e.length?null:function(t){return a(function(t,e){return e.map(function(e){return e(t)})}(t,e))}},t.composeAsync=function(t){if(!t)return null;var e=t.filter(i);return 0==e.length?null:function(t){var n=function(t,e){return e.map(function(e){return e(t)})}(t,e).map(o);return P.map.call(Object(C.forkJoin)(n),a)}},t}(),F=new T.n("NgValueAccessor"),R=function(){function t(t,e){this._renderer=t,this._elementRef=e,this.onChange=function(t){},this.onTouched=function(){}}return t.prototype.writeValue=function(t){this._renderer.setProperty(this._elementRef.nativeElement,"checked",t)},t.prototype.registerOnChange=function(t){this.onChange=t},t.prototype.registerOnTouched=function(t){this.onTouched=t},t.prototype.setDisabledState=function(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)},t}(),k=new T.n("CompositionEventMode"),U=function(){function t(t,e,n){this._renderer=t,this._elementRef=e,this._compositionMode=n,this.onChange=function(t){},this.onTouched=function(){},this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){var t=Object(O.r)()?Object(O.r)().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}return t.prototype.writeValue=function(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)},t.prototype.registerOnChange=function(t){this.onChange=t},t.prototype.registerOnTouched=function(t){this.onTouched=t},t.prototype.setDisabledState=function(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)},t.prototype._handleInput=function(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)},t.prototype._compositionStart=function(){this._composing=!0},t.prototype._compositionEnd=function(t){this._composing=!1,this._compositionMode&&this.onChange(t)},t}(),j=function(){function t(t,e){this._renderer=t,this._elementRef=e,this.onChange=function(t){},this.onTouched=function(){}}return t.prototype.writeValue=function(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)},t.prototype.registerOnChange=function(t){this.onChange=function(e){t(""==e?null:parseFloat(e))}},t.prototype.registerOnTouched=function(t){this.onTouched=t},t.prototype.setDisabledState=function(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)},t}(),B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._parent=null,e.name=null,e.valueAccessor=null,e._rawValidators=[],e._rawAsyncValidators=[],e}return Object(M.__extends)(e,t),Object.defineProperty(e.prototype,"validator",{get:function(){return u()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"asyncValidator",{get:function(){return u()},enumerable:!0,configurable:!0}),e}(N),z=function(){function t(){this._accessors=[]}return t.prototype.add=function(t,e){this._accessors.push([t,e])},t.prototype.remove=function(t){for(var e=this._accessors.length-1;e>=0;--e)if(this._accessors[e][1]===t)return void this._accessors.splice(e,1)},t.prototype.select=function(t){var e=this;this._accessors.forEach(function(n){e._isSameGroup(n,t)&&n[1]!==t&&n[1].fireUncheck(t.value)})},t.prototype._isSameGroup=function(t,e){return!!t[0].control&&(t[0]._parent===e._control._parent&&t[1].name===e.name)},t}(),V=function(){function t(t,e,n,r){this._renderer=t,this._elementRef=e,this._registry=n,this._injector=r,this.onChange=function(){},this.onTouched=function(){}}return t.prototype.ngOnInit=function(){this._control=this._injector.get(B),this._checkName(),this._registry.add(this._control,this)},t.prototype.ngOnDestroy=function(){this._registry.remove(this)},t.prototype.writeValue=function(t){this._state=t===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)},t.prototype.registerOnChange=function(t){var e=this;this._fn=t,this.onChange=function(){t(e.value),e._registry.select(e)}},t.prototype.fireUncheck=function(t){this.writeValue(t)},t.prototype.registerOnTouched=function(t){this.onTouched=t},t.prototype.setDisabledState=function(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)},t.prototype._checkName=function(){this.name&&this.formControlName&&this.name!==this.formControlName&&this._throwNameError(),!this.name&&this.formControlName&&(this.name=this.formControlName)},t.prototype._throwNameError=function(){throw new Error('\n      If you define both a name and a formControlName attribute on your radio button, their values\n      must match. Ex: <input type="radio" formControlName="food" name="food">\n    ')},t}(),G=function(){function t(t,e){this._renderer=t,this._elementRef=e,this.onChange=function(t){},this.onTouched=function(){}}return t.prototype.writeValue=function(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(t))},t.prototype.registerOnChange=function(t){this.onChange=function(e){t(""==e?null:parseFloat(e))}},t.prototype.registerOnTouched=function(t){this.onTouched=t},t.prototype.setDisabledState=function(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)},t}(),H=function(){function t(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=function(t){},this.onTouched=function(){},this._compareWith=T._6}return Object.defineProperty(t.prototype,"compareWith",{set:function(t){if("function"!=typeof t)throw new Error("compareWith must be a function, but received "+JSON.stringify(t));this._compareWith=t},enumerable:!0,configurable:!0}),t.prototype.writeValue=function(t){this.value=t;var e=this._getOptionId(t);null==e&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);var n=c(e,t);this._renderer.setProperty(this._elementRef.nativeElement,"value",n)},t.prototype.registerOnChange=function(t){var e=this;this.onChange=function(n){e.value=e._getOptionValue(n),t(e.value)}},t.prototype.registerOnTouched=function(t){this.onTouched=t},t.prototype.setDisabledState=function(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)},t.prototype._registerOption=function(){return(this._idCounter++).toString()},t.prototype._getOptionId=function(t){for(var e=0,n=Array.from(this._optionMap.keys());e<n.length;e++){var r=n[e];if(this._compareWith(this._optionMap.get(r),t))return r}return null},t.prototype._getOptionValue=function(t){var e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e):t},t}(),W=function(){function t(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=function(t){},this.onTouched=function(){},this._compareWith=T._6}return Object.defineProperty(t.prototype,"compareWith",{set:function(t){if("function"!=typeof t)throw new Error("compareWith must be a function, but received "+JSON.stringify(t));this._compareWith=t},enumerable:!0,configurable:!0}),t.prototype.writeValue=function(t){var e=this;this.value=t;var n;if(Array.isArray(t)){var r=t.map(function(t){return e._getOptionId(t)});n=function(t,e){t._setSelected(r.indexOf(e.toString())>-1)}}else n=function(t,e){t._setSelected(!1)};this._optionMap.forEach(n)},t.prototype.registerOnChange=function(t){var e=this;this.onChange=function(n){var r=[];if(n.hasOwnProperty("selectedOptions"))for(var i=n.selectedOptions,o=0;o<i.length;o++){var a=i.item(o),s=e._getOptionValue(a.value);r.push(s)}else for(i=n.options,o=0;o<i.length;o++){if((a=i.item(o)).selected){s=e._getOptionValue(a.value);r.push(s)}}e.value=r,t(r)}},t.prototype.registerOnTouched=function(t){this.onTouched=t},t.prototype.setDisabledState=function(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)},t.prototype._registerOption=function(t){var e=(this._idCounter++).toString();return this._optionMap.set(e,t),e},t.prototype._getOptionId=function(t){for(var e=0,n=Array.from(this._optionMap.keys());e<n.length;e++){var r=n[e];if(this._compareWith(this._optionMap.get(r)._value,t))return r}return null},t.prototype._getOptionValue=function(t){var e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e)._value:t},t}(),X=[R,G,j,H,W,V],Y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(M.__extends)(e,t),e.prototype.ngOnInit=function(){this._checkParentType(),this.formDirective.addFormGroup(this)},e.prototype.ngOnDestroy=function(){this.formDirective&&this.formDirective.removeFormGroup(this)},Object.defineProperty(e.prototype,"control",{get:function(){return this.formDirective.getFormGroup(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return h(this.name,this._parent)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formDirective",{get:function(){return this._parent?this._parent.formDirective:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"validator",{get:function(){return v(this._validators)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"asyncValidator",{get:function(){return g(this._asyncValidators)},enumerable:!0,configurable:!0}),e.prototype._checkParentType=function(){},e}(L),q=function(){function t(t){this._cd=t}return Object.defineProperty(t.prototype,"ngClassUntouched",{get:function(){return!!this._cd.control&&this._cd.control.untouched},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ngClassTouched",{get:function(){return!!this._cd.control&&this._cd.control.touched},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ngClassPristine",{get:function(){return!!this._cd.control&&this._cd.control.pristine},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ngClassDirty",{get:function(){return!!this._cd.control&&this._cd.control.dirty},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ngClassValid",{get:function(){return!!this._cd.control&&this._cd.control.valid},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ngClassInvalid",{get:function(){return!!this._cd.control&&this._cd.control.invalid},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ngClassPending",{get:function(){return!!this._cd.control&&this._cd.control.pending},enumerable:!0,configurable:!0}),t}(),Z=function(t){function e(e){return t.call(this,e)||this}return Object(M.__extends)(e,t),e}(q),Q="PENDING",J="DISABLED",K=function(){function t(t,e){this.validator=t,this.asyncValidator=e,this._onCollectionChange=function(){},this.pristine=!0,this.touched=!1,this._onDisabledChange=[]}return Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valid",{get:function(){return"VALID"===this.status},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"invalid",{get:function(){return"INVALID"===this.status},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pending",{get:function(){return this.status==Q},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"disabled",{get:function(){return this.status===J},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enabled",{get:function(){return this.status!==J},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dirty",{get:function(){return!this.pristine},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"untouched",{get:function(){return!this.touched},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updateOn",{get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"},enumerable:!0,configurable:!0}),t.prototype.setValidators=function(t){this.validator=w(t)},t.prototype.setAsyncValidators=function(t){this.asyncValidator=S(t)},t.prototype.clearValidators=function(){this.validator=null},t.prototype.clearAsyncValidators=function(){this.asyncValidator=null},t.prototype.markAsTouched=function(t){void 0===t&&(t={}),this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)},t.prototype.markAsUntouched=function(t){void 0===t&&(t={}),this.touched=!1,this._pendingTouched=!1,this._forEachChild(function(t){t.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)},t.prototype.markAsDirty=function(t){void 0===t&&(t={}),this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)},t.prototype.markAsPristine=function(t){void 0===t&&(t={}),this.pristine=!0,this._pendingDirty=!1,this._forEachChild(function(t){t.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)},t.prototype.markAsPending=function(t){void 0===t&&(t={}),this.status=Q,this._parent&&!t.onlySelf&&this._parent.markAsPending(t)},t.prototype.disable=function(t){void 0===t&&(t={}),this.status=J,this.errors=null,this._forEachChild(function(e){e.disable(Object(M.__assign)({},t,{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(t),this._onDisabledChange.forEach(function(t){return t(!0)})},t.prototype.enable=function(t){void 0===t&&(t={}),this.status="VALID",this._forEachChild(function(e){e.enable(Object(M.__assign)({},t,{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(t),this._onDisabledChange.forEach(function(t){return t(!1)})},t.prototype._updateAncestors=function(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),this._parent._updatePristine(),this._parent._updateTouched())},t.prototype.setParent=function(t){this._parent=t},t.prototype.updateValueAndValidity=function(t){void 0===t&&(t={}),this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&this.status!==Q||this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)},t.prototype._updateTreeValidity=function(t){void 0===t&&(t={emitEvent:!0}),this._forEachChild(function(e){return e._updateTreeValidity(t)}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})},t.prototype._setInitialStatus=function(){this.status=this._allControlsDisabled()?J:"VALID"},t.prototype._runValidator=function(){return this.validator?this.validator(this):null},t.prototype._runAsyncValidator=function(t){var e=this;if(this.asyncValidator){this.status=Q;var n=o(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(function(n){return e.setErrors(n,{emitEvent:t})})}},t.prototype._cancelExistingSubscription=function(){this._asyncValidationSubscription&&this._asyncValidationSubscription.unsubscribe()},t.prototype.setErrors=function(t,e){void 0===e&&(e={}),this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)},t.prototype.get=function(t){return function(t,e,n){return null==e?null:(e instanceof Array||(e=e.split(n)),e instanceof Array&&0===e.length?null:e.reduce(function(t,e){return t instanceof tt?t.controls[e]||null:t instanceof et?t.at(e)||null:null},t))}(this,t,".")},t.prototype.getError=function(t,e){var n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null},t.prototype.hasError=function(t,e){return!!this.getError(t,e)},Object.defineProperty(t.prototype,"root",{get:function(){for(var t=this;t._parent;)t=t._parent;return t},enumerable:!0,configurable:!0}),t.prototype._updateControlsErrors=function(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)},t.prototype._initObservables=function(){this.valueChanges=new T.l,this.statusChanges=new T.l},t.prototype._calculateStatus=function(){return this._allControlsDisabled()?J:this.errors?"INVALID":this._anyControlsHaveStatus(Q)?Q:this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"},t.prototype._anyControlsHaveStatus=function(t){return this._anyControls(function(e){return e.status===t})},t.prototype._anyControlsDirty=function(){return this._anyControls(function(t){return t.dirty})},t.prototype._anyControlsTouched=function(){return this._anyControls(function(t){return t.touched})},t.prototype._updatePristine=function(t){void 0===t&&(t={}),this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)},t.prototype._updateTouched=function(t){void 0===t&&(t={}),this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)},t.prototype._isBoxedValue=function(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t},t.prototype._registerOnCollectionChange=function(t){this._onCollectionChange=t},t.prototype._setUpdateStrategy=function(t){A(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)},t}(),$=function(t){function e(e,n,r){void 0===e&&(e=null);var i=t.call(this,w(n),S(r,n))||this;return i._onChange=[],i._applyFormState(e),i._setUpdateStrategy(n),i.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),i._initObservables(),i}return Object(M.__extends)(e,t),e.prototype.setValue=function(t,e){var n=this;void 0===e&&(e={}),this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(function(t){return t(n.value,!1!==e.emitViewToModelChange)}),this.updateValueAndValidity(e)},e.prototype.patchValue=function(t,e){void 0===e&&(e={}),this.setValue(t,e)},e.prototype.reset=function(t,e){void 0===t&&(t=null),void 0===e&&(e={}),this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1},e.prototype._updateValue=function(){},e.prototype._anyControls=function(t){return!1},e.prototype._allControlsDisabled=function(){return this.disabled},e.prototype.registerOnChange=function(t){this._onChange.push(t)},e.prototype._clearChangeFns=function(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=function(){}},e.prototype.registerOnDisabledChange=function(t){this._onDisabledChange.push(t)},e.prototype._forEachChild=function(t){},e.prototype._syncPendingControls=function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange))&&(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0)},e.prototype._applyFormState=function(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t},e}(K),tt=function(t){function e(e,n,r){var i=t.call(this,w(n),S(r,n))||this;return i.controls=e,i._initObservables(),i._setUpdateStrategy(n),i._setUpControls(),i.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),i}return Object(M.__extends)(e,t),e.prototype.registerControl=function(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)},e.prototype.addControl=function(t,e){this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()},e.prototype.removeControl=function(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(function(){}),delete this.controls[t],this.updateValueAndValidity(),this._onCollectionChange()},e.prototype.setControl=function(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(function(){}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()},e.prototype.contains=function(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled},e.prototype.setValue=function(t,e){var n=this;void 0===e&&(e={}),this._checkAllValuesPresent(t),Object.keys(t).forEach(function(r){n._throwIfControlMissing(r),n.controls[r].setValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)},e.prototype.patchValue=function(t,e){var n=this;void 0===e&&(e={}),Object.keys(t).forEach(function(r){n.controls[r]&&n.controls[r].patchValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)},e.prototype.reset=function(t,e){void 0===t&&(t={}),void 0===e&&(e={}),this._forEachChild(function(n,r){n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e),this._updatePristine(e),this._updateTouched(e)},e.prototype.getRawValue=function(){return this._reduceChildren({},function(t,e,n){return t[n]=e instanceof $?e.value:e.getRawValue(),t})},e.prototype._syncPendingControls=function(){var t=this._reduceChildren(!1,function(t,e){return!!e._syncPendingControls()||t});return t&&this.updateValueAndValidity({onlySelf:!0}),t},e.prototype._throwIfControlMissing=function(t){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[t])throw new Error("Cannot find form control with name: "+t+".")},e.prototype._forEachChild=function(t){var e=this;Object.keys(this.controls).forEach(function(n){return t(e.controls[n],n)})},e.prototype._setUpControls=function(){var t=this;this._forEachChild(function(e){e.setParent(t),e._registerOnCollectionChange(t._onCollectionChange)})},e.prototype._updateValue=function(){this.value=this._reduceValue()},e.prototype._anyControls=function(t){var e=this,n=!1;return this._forEachChild(function(r,i){n=n||e.contains(i)&&t(r)}),n},e.prototype._reduceValue=function(){var t=this;return this._reduceChildren({},function(e,n,r){return(n.enabled||t.disabled)&&(e[r]=n.value),e})},e.prototype._reduceChildren=function(t,e){var n=t;return this._forEachChild(function(t,r){n=e(n,t,r)}),n},e.prototype._allControlsDisabled=function(){for(var t=0,e=Object.keys(this.controls);t<e.length;t++){if(this.controls[e[t]].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled},e.prototype._checkAllValuesPresent=function(t){this._forEachChild(function(e,n){if(void 0===t[n])throw new Error("Must supply a value for form control with name: '"+n+"'.")})},e}(K),et=function(t){function e(e,n,r){var i=t.call(this,w(n),S(r,n))||this;return i.controls=e,i._initObservables(),i._setUpdateStrategy(n),i._setUpControls(),i.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),i}return Object(M.__extends)(e,t),e.prototype.at=function(t){return this.controls[t]},e.prototype.push=function(t){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity(),this._onCollectionChange()},e.prototype.insert=function(t,e){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity()},e.prototype.removeAt=function(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(function(){}),this.controls.splice(t,1),this.updateValueAndValidity()},e.prototype.setControl=function(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(function(){}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity(),this._onCollectionChange()},Object.defineProperty(e.prototype,"length",{get:function(){return this.controls.length},enumerable:!0,configurable:!0}),e.prototype.setValue=function(t,e){var n=this;void 0===e&&(e={}),this._checkAllValuesPresent(t),t.forEach(function(t,r){n._throwIfControlMissing(r),n.at(r).setValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)},e.prototype.patchValue=function(t,e){var n=this;void 0===e&&(e={}),t.forEach(function(t,r){n.at(r)&&n.at(r).patchValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)},e.prototype.reset=function(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this._forEachChild(function(n,r){n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e),this._updatePristine(e),this._updateTouched(e)},e.prototype.getRawValue=function(){return this.controls.map(function(t){return t instanceof $?t.value:t.getRawValue()})},e.prototype._syncPendingControls=function(){var t=this.controls.reduce(function(t,e){return!!e._syncPendingControls()||t},!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t},e.prototype._throwIfControlMissing=function(t){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(t))throw new Error("Cannot find form control at index "+t)},e.prototype._forEachChild=function(t){this.controls.forEach(function(e,n){t(e,n)})},e.prototype._updateValue=function(){var t=this;this.value=this.controls.filter(function(e){return e.enabled||t.disabled}).map(function(t){return t.value})},e.prototype._anyControls=function(t){return this.controls.some(function(e){return e.enabled&&t(e)})},e.prototype._setUpControls=function(){var t=this;this._forEachChild(function(e){return t._registerControl(e)})},e.prototype._checkAllValuesPresent=function(t){this._forEachChild(function(e,n){if(void 0===t[n])throw new Error("Must supply a value for form control at index: "+n+".")})},e.prototype._allControlsDisabled=function(){for(var t=0,e=this.controls;t<e.length;t++){if(e[t].enabled)return!1}return this.controls.length>0||this.disabled},e.prototype._registerControl=function(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)},e}(K),nt=Promise.resolve(null),rt=function(t){function e(e,n){var r=t.call(this)||this;return r.submitted=!1,r._directives=[],r.ngSubmit=new T.l,r.form=new tt({},v(e),g(n)),r}return Object(M.__extends)(e,t),e.prototype.ngAfterViewInit=function(){this._setUpdateStrategy()},Object.defineProperty(e.prototype,"formDirective",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"control",{get:function(){return this.form},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"controls",{get:function(){return this.form.controls},enumerable:!0,configurable:!0}),e.prototype.addControl=function(t){var e=this;nt.then(function(){var n=e._findContainer(t.path);t.control=n.registerControl(t.name,t.control),p(t.control,t),t.control.updateValueAndValidity({emitEvent:!1}),e._directives.push(t)})},e.prototype.getControl=function(t){return this.form.get(t.path)},e.prototype.removeControl=function(t){var e=this;nt.then(function(){var n=e._findContainer(t.path);n&&n.removeControl(t.name),x(e._directives,t)})},e.prototype.addFormGroup=function(t){var e=this;nt.then(function(){var n=e._findContainer(t.path),r=new tt({});f(r,t),n.registerControl(t.name,r),r.updateValueAndValidity({emitEvent:!1})})},e.prototype.removeFormGroup=function(t){var e=this;nt.then(function(){var n=e._findContainer(t.path);n&&n.removeControl(t.name)})},e.prototype.getFormGroup=function(t){return this.form.get(t.path)},e.prototype.updateModel=function(t,e){var n=this;nt.then(function(){n.form.get(t.path).setValue(e)})},e.prototype.setValue=function(t){this.control.setValue(t)},e.prototype.onSubmit=function(t){return this.submitted=!0,b(this.form,this._directives),this.ngSubmit.emit(t),!1},e.prototype.onReset=function(){this.resetForm()},e.prototype.resetForm=function(t){void 0===t&&(t=void 0),this.form.reset(t),this.submitted=!1},e.prototype._setUpdateStrategy=function(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)},e.prototype._findContainer=function(t){return t.pop(),t.length?this.form.get(t):this.form},e}(L),it='\n    <div [formGroup]="myGroup">\n      <input formControlName="firstName">\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       firstName: new FormControl()\n    });',ot='\n    <div [formGroup]="myGroup">\n       <div formGroupName="person">\n          <input formControlName="firstName">\n       </div>\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       person: new FormGroup({ firstName: new FormControl() })\n    });',at='\n    <form>\n       <div ngModelGroup="person">\n          <input [(ngModel)]="person.name" name="firstName">\n       </div>\n    </form>',st='\n    <div [formGroup]="myGroup">\n       <input formControlName="firstName">\n       <input [(ngModel)]="showMoreControls" [ngModelOptions]="{standalone: true}">\n    </div>\n  ',lt=function(){function t(){}return t.modelParentException=function(){throw new Error('\n      ngModel cannot be used to register form controls with a parent formGroup directive.  Try using\n      formGroup\'s partner directive "formControlName" instead.  Example:\n\n      '+it+"\n\n      Or, if you'd like to avoid registering this form control, indicate that it's standalone in ngModelOptions:\n\n      Example:\n\n      "+st)},t.formGroupNameException=function(){throw new Error("\n      ngModel cannot be used to register form controls with a parent formGroupName or formArrayName directive.\n\n      Option 1: Use formControlName instead of ngModel (reactive strategy):\n\n      "+ot+"\n\n      Option 2:  Update ngModel's parent be ngModelGroup (template-driven strategy):\n\n      "+at)},t.missingNameException=function(){throw new Error('If ngModel is used within a form tag, either the name attribute must be set or the form\n      control must be defined as \'standalone\' in ngModelOptions.\n\n      Example 1: <input [(ngModel)]="person.firstName" name="first">\n      Example 2: <input [(ngModel)]="person.firstName" [ngModelOptions]="{standalone: true}">')},t.modelGroupParentException=function(){throw new Error("\n      ngModelGroup cannot be used with a parent formGroup directive.\n\n      Option 1: Use formGroupName instead of ngModelGroup (reactive strategy):\n\n      "+ot+"\n\n      Option 2:  Use a regular form tag instead of the formGroup directive (template-driven strategy):\n\n      "+at)},t}(),ut=function(t){function e(e,n,r){var i=t.call(this)||this;return i._parent=e,i._validators=n,i._asyncValidators=r,i}return Object(M.__extends)(e,t),e.prototype._checkParentType=function(){this._parent instanceof e||this._parent instanceof rt||lt.modelGroupParentException()},e}(Y),ct=Promise.resolve(null),ht=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.control=new $,o._registered=!1,o.update=new T.l,o._parent=e,o._rawValidators=n||[],o._rawAsyncValidators=r||[],o.valueAccessor=_(o,i),o}return Object(M.__extends)(e,t),e.prototype.ngOnChanges=function(t){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in t&&this._updateDisabled(t),y(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)},e.prototype.ngOnDestroy=function(){this.formDirective&&this.formDirective.removeControl(this)},Object.defineProperty(e.prototype,"path",{get:function(){return this._parent?h(this.name,this._parent):[this.name]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formDirective",{get:function(){return this._parent?this._parent.formDirective:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"validator",{get:function(){return v(this._rawValidators)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"asyncValidator",{get:function(){return g(this._rawAsyncValidators)},enumerable:!0,configurable:!0}),e.prototype.viewToModelUpdate=function(t){this.viewModel=t,this.update.emit(t)},e.prototype._setUpControl=function(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0},e.prototype._setUpdateStrategy=function(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)},e.prototype._isStandalone=function(){return!this._parent||!(!this.options||!this.options.standalone)},e.prototype._setUpStandalone=function(){p(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})},e.prototype._checkForErrors=function(){this._isStandalone()||this._checkParentType(),this._checkName()},e.prototype._checkParentType=function(){!(this._parent instanceof ut)&&this._parent instanceof Y?lt.formGroupNameException():this._parent instanceof ut||this._parent instanceof rt||lt.modelParentException()},e.prototype._checkName=function(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()||this.name||lt.missingNameException()},e.prototype._updateValue=function(t){var e=this;ct.then(function(){e.control.setValue(t,{emitViewToModelChange:!1})})},e.prototype._updateDisabled=function(t){var e=this,n=t.isDisabled.currentValue,r=""===n||n&&"false"!==n;ct.then(function(){r&&!e.control.disabled?e.control.disable():!r&&e.control.disabled&&e.control.enable()})},e}(B),pt=function(){function t(){}return t.prototype.group=function(t,e){void 0===e&&(e=null);var n=this._reduceControls(t);return new tt(n,null!=e?e.validator:null,null!=e?e.asyncValidator:null)},t.prototype.control=function(t,e,n){return new $(t,e,n)},t.prototype.array=function(t,e,n){var r=this,i=t.map(function(t){return r._createControl(t)});return new et(i,e,n)},t.prototype._reduceControls=function(t){var e=this,n={};return Object.keys(t).forEach(function(r){n[r]=e._createControl(t[r])}),n},t.prototype._createControl=function(t){if(t instanceof $||t instanceof tt||t instanceof et)return t;if(Array.isArray(t)){return this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null)}return this.control(t)},t}(),dt=function(){return function(){}}(),ft=function(){return function(){}}(),mt=function(){return function(){}}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(1),n(13);var r=n(6),i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(t){function e(e,n,r,i,o){var a=t.call(this,n,r,i,"item")||this;return a._ids=-1,a._inputs=[],a._viewLabel=!0,a._name="item",a.labelId=null,a._setName(r),a._hasReorder=!!o,a.id=e.nextId().toString(),a.labelId="lbl-"+a.id,i.orgListen||(i.orgListen=i.listen,i.listen=function(t,e,n){return"click"===e&&t.setAttribute&&t.setAttribute("tappable",""),i.orgListen(t,e,n)}),a}return i(e,t),e.prototype.registerInput=function(t){return this._inputs.push(t),this.id+"-"+ ++this._ids},e.prototype.ngAfterContentInit=function(){if(this._viewLabel&&this._inputs.length){var t=this.getLabelText().trim();this._viewLabel=t.length>0}this._inputs.length>1&&this.setElementClass("item-multiple-inputs",!0)},e.prototype._updateColor=function(t,e){this._setColor(t,e=e||"item")},e.prototype._setName=function(t){var e=t.nativeElement.nodeName.replace("ION-","");"LIST-HEADER"!==e&&"ITEM-DIVIDER"!==e||(this._name=e)},e.prototype.getLabelText=function(){return this._label?this._label.text:""},Object.defineProperty(e.prototype,"contentLabel",{set:function(t){t&&(this._label=t,t.id=this.labelId,t.type&&this.setElementClass("item-label-"+t.type,!0),this._viewLabel=!1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewLabel",{set:function(t){this._label||(this._label=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_buttons",{set:function(t){t.forEach(function(t){t._size||t.setElementClass("item-button",!0)})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_icons",{set:function(t){t.forEach(function(t){t.setElementClass("item-icon",!0)})},enumerable:!0,configurable:!0}),e}(r.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){return function(){}}()},function(t,e,n){"use strict";n.d(e,"a",function(){return a});n(1);var r=n(6),i=n(2),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=function(t){function e(e,n,r,i){var o=t.call(this,n,r,i)||this;return o._role="button",o._style="default",o._mode=n.get("mode"),!1===n.get("hoverCSS")&&o.setElementClass("disable-hover",!0),e.trim().length>0&&o.setRole(e),o}return o(e,t),Object.defineProperty(e.prototype,"large",{set:function(t){this._attr("_size","large",t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"small",{set:function(t){this._attr("_size","small",t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"default",{set:function(t){this._attr("_size","default",t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outline",{set:function(t){this._attr("_style","outline",t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clear",{set:function(t){this._attr("_style","clear",t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"solid",{set:function(t){this._attr("_style","solid",t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"round",{set:function(t){this._attr("_shape","round",t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"block",{set:function(t){this._attr("_display","block",t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"full",{set:function(t){this._attr("_display","full",t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strong",{set:function(t){this._attr("_decorator","strong",t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mode",{set:function(t){this._assignCss(!1),this._mode=t,this._assignCss(!0)},enumerable:!0,configurable:!0}),e.prototype._attr=function(t,e,n){"_style"===t&&this._updateColor(this._color,!1),this._setClass(this[t],!1),Object(i.o)(n)?(this[t]=e,this._setClass(e,!0)):(this[t]="_style"===t?"default":null,this._setClass(this[t],!0)),"_style"===t&&this._updateColor(this._color,!0)},Object.defineProperty(e.prototype,"color",{set:function(t){this._updateColor(this._color,!1),this._updateColor(t,!0),this._color=t},enumerable:!0,configurable:!0}),e.prototype.ngAfterContentInit=function(){this._init=!0,this._assignCss(!0)},e.prototype.setRole=function(t){this._assignCss(!1),this._role=t,this._assignCss(!0)},e.prototype._assignCss=function(t){var e=this._role;e&&(this.setElementClass(e,t),this.setElementClass(e+"-"+this._mode,t),this._setClass(this._style,t),this._setClass(this._shape,t),this._setClass(this._display,t),this._setClass(this._size,t),this._setClass(this._decorator,t),this._updateColor(this._color,t))},e.prototype._setClass=function(t,e){t&&this._init&&(t=t.toLocaleLowerCase(),this.setElementClass(this._role+"-"+t,e),this.setElementClass(this._role+"-"+t+"-"+this._mode,e))},e.prototype._updateColor=function(t,e){if(t&&this._init){var n=this._role,r=this._style;n+=null!==(r="bar-button"!==this._role&&"solid"===r?"default":r)&&""!==r&&"default"!==r?"-"+r.toLowerCase():"",null!==t&&""!==t&&this.setElementClass(n+"-"+this._mode+"-"+t,e)}},e}(r.a)},function(t,e,n){"use strict";function r(t,e){return t.top<e.top?-1:t.top>e.top?1:0}function i(t){return t.indexOf("px")>0?parseInt(t,10):0}function o(t){return t>0?t+"px":""}n.d(e,"a",function(){return d});var a=n(0),s=(n(1),n(9),n(6)),l=n(29),u=n(2),c=(n(24),n(19),n(3),n(151)),h=(n(4),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.subscribe=function(e,n,r){return this.onSubscribe(),t.prototype.subscribe.call(this,e,n,r)},e}(a.l),d=function(t){function e(e,n,r,i,o,a,s,u,h,d){var f=t.call(this,e,i,o,"content")||this;f._plt=n,f._dom=r,f._app=a,f._keyboard=s,f._zone=u,f._scrollPadding=0,f._inputPolling=!1,f._hasRefresher=!1,f._imgs=[],f._scrollDownOnLoad=!1,f.ionScrollStart=new p,f.ionScroll=new p,f.ionScrollEnd=new p;var m=function(){return f._scroll.enableEvents()};for(f.ionScroll.onSubscribe=m,f.ionScrollStart.onSubscribe=m,f.ionScrollEnd.onSubscribe=m,f.statusbarPadding=e.getBoolean("statusbarPadding",!1),f._imgReqBfr=e.getNumber("imgRequestBuffer",1400),f._imgRndBfr=e.getNumber("imgRenderBuffer",400),f._imgVelMax=e.getNumber("imgVelocityMax",3),f._scroll=new c.a(a,n,r);d;){if(Object(l.m)(d)){f._tabs=d;break}d=d.parent}return h?(f._viewCtrl=h,h._setIONContent(f),h._setIONContentRef(i),f._viewCtrlReadSub=h.readReady.subscribe(function(){f._viewCtrlReadSub.unsubscribe(),f._readDimensions()}),f._viewCtrlWriteSub=h.writeReady.subscribe(function(){f._viewCtrlWriteSub.unsubscribe(),f._writeDimensions()})):(r.read(f._readDimensions.bind(f)),r.write(f._writeDimensions.bind(f))),f}return h(e,t),Object.defineProperty(e.prototype,"contentHeight",{get:function(){return this._scroll.ev.contentHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentWidth",{get:function(){return this._scroll.ev.contentWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollHeight",{get:function(){return this._scroll.ev.scrollHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollWidth",{get:function(){return this._scroll.ev.scrollWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollTop",{get:function(){return this._scroll.ev.scrollTop},set:function(t){this._scroll.setTop(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollLeft",{get:function(){return this._scroll.ev.scrollLeft},set:function(t){this._scroll.setLeft(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isScrolling",{get:function(){return this._scroll.isScrolling},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"directionY",{get:function(){return this._scroll.ev.directionY},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"directionX",{get:function(){return this._scroll.ev.directionX},enumerable:!0,configurable:!0}),e.prototype.ngAfterViewInit=function(){var t=this,e=this._scroll;e.ev.fixedElement=this.getFixedElement(),e.ev.scrollElement=this.getScrollElement(),e.onScrollStart=function(e){t.ionScrollStart.emit(e)},e.onScroll=function(e){t.ionScroll.emit(e),t.imgsUpdate()},e.onScrollEnd=function(e){t.ionScrollEnd.emit(e),t.imgsUpdate()}},e.prototype.enableJsScroll=function(){this._scroll.enableJsScroll(this._cTop,this._cBottom)},e.prototype.ngOnDestroy=function(){this._scLsn&&this._scLsn(),this._viewCtrlReadSub&&this._viewCtrlReadSub.unsubscribe(),this._viewCtrlWriteSub&&this._viewCtrlWriteSub.unsubscribe(),this._viewCtrlReadSub=this._viewCtrlWriteSub=null,this._scroll&&this._scroll.destroy(),this._footerEle=this._scLsn=this._scroll=null},e.prototype.getScrollElement=function(){return this._scrollContent.nativeElement},e.prototype.getFixedElement=function(){return this._fixedContent.nativeElement},e.prototype.onScrollElementTransitionEnd=function(t){this._plt.transitionEnd(this.getScrollElement(),t)},e.prototype.scrollTo=function(t,e,n,r){return void 0===n&&(n=300),this._scroll.scrollTo(t,e,n,r)},e.prototype.scrollToTop=function(t){return void 0===t&&(t=300),this._scroll.scrollToTop(t)},e.prototype.scrollToBottom=function(t){return void 0===t&&(t=300),this._scroll.scrollToBottom(t)},Object.defineProperty(e.prototype,"fullscreen",{get:function(){return this._fullscreen},set:function(t){this._fullscreen=Object(u.o)(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollDownOnLoad",{get:function(){return this._scrollDownOnLoad},set:function(t){this._scrollDownOnLoad=Object(u.o)(t)},enumerable:!0,configurable:!0}),e.prototype.addImg=function(t){this._imgs.push(t)},e.prototype.removeImg=function(t){Object(u.q)(this._imgs,t)},e.prototype.setScrollElementStyle=function(t,e){var n=this.getScrollElement();n&&this._dom.write(function(){n.style[t]=e})},e.prototype.getContentDimensions=function(){var t=this.getScrollElement(),e=t.parentElement;return{contentHeight:e.offsetHeight-this._cTop-this._cBottom,contentTop:this._cTop,contentBottom:this._cBottom,contentWidth:e.offsetWidth,contentLeft:e.offsetLeft,scrollHeight:t.scrollHeight,scrollTop:t.scrollTop,scrollWidth:t.scrollWidth,scrollLeft:t.scrollLeft}},e.prototype.addScrollPadding=function(t){if(0===t&&(this._inputPolling=!1,this._scrollPadding=-1),t>this._scrollPadding){this._scrollPadding=t;var e=this.getScrollElement();e&&this._dom.write(function(){e.style.paddingBottom=t>0?t+"px":""})}},e.prototype.clearScrollPaddingFocusOut=function(){var t=this;this._inputPolling||(this._inputPolling=!0,this._keyboard.onClose(function(){t.addScrollPadding(0)},200,3e3))},e.prototype.resize=function(){this._dom.read(this._readDimensions.bind(this)),this._dom.write(this._writeDimensions.bind(this))},e.prototype._readDimensions=function(){var t,e=this._pTop,n=this._pRight,r=this._pBottom,o=this._pLeft,a=this._hdrHeight,s=this._ftrHeight,l=this._tabsPlacement,u=0;if(this._pTop=0,this._pRight=0,this._pBottom=0,this._pLeft=0,this._hdrHeight=0,this._ftrHeight=0,this._tabsPlacement=null,this._tTop=0,this._fTop=0,this._fBottom=0,this._scroll){t=this._scroll.ev;var c=this.getNativeElement();if(c){for(var h,p,d=c.parentElement,f=d.children,m=f.length-1;m>=0;m--)"ION-CONTENT"===(p=(c=f[m]).tagName)?(t.contentElement=c,this._fullscreen&&(h=getComputedStyle(c),this._pTop=i(h.paddingTop),this._pBottom=i(h.paddingBottom),this._pRight=i(h.paddingRight),this._pLeft=i(h.paddingLeft))):"ION-HEADER"===p?(t.headerElement=c,this._hdrHeight=c.clientHeight):"ION-FOOTER"===p&&(t.footerElement=c,this._ftrHeight=c.clientHeight,this._footerEle=c);c=d;for(;c&&"ION-MODAL"!==c.tagName&&!c.classList.contains("tab-subpage");)"ION-TABS"===c.tagName&&(this._tabbarHeight=c.firstElementChild.clientHeight,null===this._tabsPlacement&&(this._tabsPlacement=c.getAttribute("tabsplacement"))),c=c.parentElement;this._tabs&&"top"===this._tabsPlacement&&(this._tTop=this._hdrHeight,u=this._tabs._top),this._cTop=this._hdrHeight,this._cBottom=this._ftrHeight,"top"===this._tabsPlacement?this._cTop+=this._tabbarHeight:"bottom"===this._tabsPlacement&&(this._cBottom+=this._tabbarHeight),this._hasRefresher&&(this._cTop-=1),this._fTop=this._cTop,this._fBottom=this._cBottom,this._fullscreen&&(this._cTop+=this._pTop,this._cBottom+=this._pBottom);var v=this.getContentDimensions();t.scrollHeight=v.scrollHeight,t.scrollWidth=v.scrollWidth,t.contentHeight=v.contentHeight,t.contentWidth=v.contentWidth,t.contentTop=v.contentTop,t.contentBottom=v.contentBottom,this._dirty=e!==this._pTop||r!==this._pBottom||o!==this._pLeft||n!==this._pRight||a!==this._hdrHeight||s!==this._ftrHeight||l!==this._tabsPlacement||u!==this._tTop||this._cTop!==this.contentTop||this._cBottom!==this.contentBottom,this._scroll.init(this.getScrollElement(),this._cTop,this._cBottom),this.imgsUpdate()}}},e.prototype._writeDimensions=function(){if(this._dirty){var t=this.getScrollElement();if(t){var e=this.getFixedElement();if(e){if("bottom"===this._tabsPlacement&&this._cBottom>0&&this._footerEle){this._footerEle.style.bottom=o(this._cBottom-this._ftrHeight)}var n="marginTop",r="marginBottom",i=this._fTop,a=this._fBottom;this._fullscreen&&(n="paddingTop",r="paddingBottom"),this._cTop!==this.contentTop&&(t.style[n]=o(this._cTop),e.style.marginTop=o(i),this.contentTop=this._cTop),this._cBottom!==this.contentBottom&&(t.style[r]=o(this._cBottom),e.style.marginBottom=o(a),this.contentBottom=this._cBottom),null!==this._tabsPlacement&&this._tabs&&("top"===this._tabsPlacement?this._tabs.setTabbarPosition(this._tTop,-1):this._tabs.setTabbarPosition(-1,0)),this._scrollDownOnLoad&&(this.scrollToBottom(0),this._scrollDownOnLoad=!1)}}}},e.prototype.imgsUpdate=function(){this._scroll.initialized&&this._imgs.length&&this.isImgsUpdatable()&&function(t,e,n,i,o,a){for(var s,l=e+n,u=[],c=[],h=0,p=t.length;h<p;h++){if(s=t[h],"up"===i){if(s.top<l&&s.bottom>e-a){s.canRequest=s.canRender=!0,u.push(s);continue}if(s.bottom<=e&&s.bottom>e-o){s.canRequest=!0,s.canRender=!1,c.push(s);continue}if(s.top>=l&&s.top<l+a){s.canRequest=s.canRender=!1;continue}}else{if(s.bottom>e&&s.top<l+a){s.canRequest=s.canRender=!0,u.push(s);continue}if(s.top>=l&&s.top<l+o){s.canRequest=!0,s.canRender=!1,c.push(s);continue}if(s.bottom<=e&&s.bottom>e-a){s.canRequest=s.canRender=!1;continue}}s.canRequest=s.canRender=!1,s.reset()}u.sort(r).forEach(function(t){return t.update()}),"up"===i?c.sort(r).reverse().forEach(function(t){return t.update()}):c.sort(r).forEach(function(t){return t.update()})}(this._imgs,this.scrollTop,this.contentHeight,this.directionY,this._imgReqBfr,this._imgRndBfr)},e.prototype.isImgsUpdatable=function(){return Math.abs(this._scroll.ev.velocityY)<this._imgVelMax},e}(s.a)},function(t,e,n){"use strict";n.d(e,"d",function(){return r}),n.d(e,"h",function(){return i}),n.d(e,"e",function(){return o}),n.d(e,"a",function(){return a}),n.d(e,"b",function(){return s}),n.d(e,"c",function(){return l}),n.d(e,"f",function(){return u}),n.d(e,"g",function(){return c});var r=37,i=38,o=39,a=40,s=13,l=27,u=32,c=9},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){function t(t,e){this._elementRef=t,this._renderer=e}return t.prototype.getNativeElement=function(){return this._elementRef.nativeElement},t.prototype.setElementClass=function(t,e){this._renderer.setElementClass(this._elementRef.nativeElement,t,e)},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(0),i=(n(1),n(9),n(11)),o=n(22),a=(n(3),function(){function t(t,e,n,i){this._plt=e,this._zone=n,this._dom=i,this.willShow=new r.l,this.willHide=new r.l,this.didShow=new r.l,this.didHide=new r.l,this.eventsAvailable=!1,this.focusOutline(t.get("focusOutline"));var o=e.win();o.Ionic&&o.Ionic.keyboardPlugin?this.listenV2(o):this.listenV1(o)}return t.prototype.listenV2=function(t){var e=this,n=this._plt;n.registerListener(t,"keyboardWillShow",function(t){e._zone.run(function(){e.willShow.emit(t.keyboardHeight)})},{zone:!1,passive:!0}),n.registerListener(t,"keyboardWillHide",function(){e._zone.run(function(){e.willHide.emit()})},{zone:!1,passive:!0}),n.registerListener(t,"keyboardDidShow",function(t){e._zone.run(function(){e.didShow.emit(t.keyboardHeight)})},{zone:!1,passive:!0}),n.registerListener(t,"keyboardDidHide",function(){e._zone.run(function(){e.didHide.emit()})},{zone:!1,passive:!0}),this.eventsAvailable=!0},t.prototype.listenV1=function(t){var e=this,n=this._plt;n.registerListener(t,"native.keyboardhide",function(){e.blurActiveInput(!0)},{zone:!1,passive:!0}),n.registerListener(t,"native.keyboardshow",function(){e.blurActiveInput(!1)},{zone:!1,passive:!0})},t.prototype.blurActiveInput=function(t){var e=this,n=this._plt;n.cancelTimeout(this._tmr),t&&(this._tmr=n.timeout(function(){e.isOpen()&&n.focusOutActiveElement()},80))},t.prototype.isOpen=function(){return this.hasFocusedTextInput()},t.prototype.onClose=function(t,e,n){function r(){!i.isOpen()||o>n?i._plt.timeout(function(){i._zone.run(function(){t()})},400):i._plt.timeout(r,e),o++}void 0===e&&(e=s),void 0===n&&(n=l);var i=this,o=0,a=null;return t||(a=new Promise(function(e){t=e})),i._plt.timeout(r,e),a},t.prototype.close=function(){var t=this;this._dom.read(function(){t.isOpen()&&t._dom.write(function(){t._plt.focusOutActiveElement()})})},t.prototype.focusOutline=function(t){function e(){s._dom.write(function(){l.doc().body.classList[c?"add":"remove"]("focus-outline")})}function n(){c=!1,r()}function r(){e(),i&&i(),a&&a(),c&&(i=l.registerListener(u,"mousedown",n,h),a=l.registerListener(u,"touchstart",n,h))}var i,a,s=this,l=s._plt,u=l.doc(),c=!1,h={passive:!0,zone:!1};if(!0===t)return c=!0,e();!1!==t&&l.registerListener(l.doc(),"keydown",function(t){c||t.keyCode!==o.g||(c=!0,r())},h)},t.prototype.hasFocusedTextInput=function(){var t=this._plt.getActiveElement();return!!Object(i.e)(t)&&t.parentElement.querySelector(":focus")===t},t.prototype.hideFormAccessoryBar=function(t){var e=this._plt.win();e&&e.Keyboard&&e.Keyboard.hideFormAccessoryBar&&e.Keyboard.hideFormAccessoryBar(t)},t}()),s=150,l=100},function(t,e,n){"use strict";n.d(e,"a",function(){return r});n(3);var r=function(){function t(t){var e=this;t&&t.ready().then(function(){e._p=t.win().TapticEngine})}return t.prototype.available=function(){return!!this._p},t.prototype.selection=function(){this._p&&this._p.selection()},t.prototype.gestureSelectionStart=function(){this._p&&this._p.gestureSelectionStart()},t.prototype.gestureSelectionChanged=function(){this._p&&this._p.gestureSelectionChanged()},t.prototype.gestureSelectionEnd=function(){this._p&&this._p.gestureSelectionEnd()},t.prototype.notification=function(t){this._p&&this._p.notification(t)},t.prototype.impact=function(t){this._p&&this._p.impact(t)},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(2),i=function(){function t(){this._menus=[]}return t.prototype.open=function(t){var e=this.get(t);if(e&&!this.isAnimating()){var n=this.getOpen();return n&&e!==n&&n.setOpen(!1,!1),e.open()}return Promise.resolve(!1)},t.prototype.close=function(t){var e;return(e=t?this.get(t):this.getOpen())?e.close():Promise.resolve(!1)},t.prototype.toggle=function(t){var e=this.get(t);if(e&&!this.isAnimating()){var n=this.getOpen();return n&&e!==n&&n.setOpen(!1,!1),e.toggle()}return Promise.resolve(!1)},t.prototype.enable=function(t,e){var n=this.get(e);if(n)return n.enable(t)},t.prototype.swipeEnable=function(t,e){var n=this.get(e);if(n)return n.swipeEnable(t)},t.prototype.isOpen=function(t){if(t){var e=this.get(t);return e&&e.isOpen||!1}return!!this.getOpen()},t.prototype.isEnabled=function(t){var e=this.get(t);return e&&e.enabled||!1},t.prototype.get=function(t){return"left"===t||"right"===t?this._menus.find(function(e){return e.side===t&&e.enabled})||this._menus.find(function(e){return e.side===t})||null:t?this._menus.find(function(e){return e.id===t})||null:this._menus.find(function(t){return t.enabled})||(this._menus.length?this._menus[0]:null)},t.prototype.getOpen=function(){return this._menus.find(function(t){return t.isOpen})},t.prototype.getMenus=function(){return this._menus},t.prototype.isAnimating=function(){return this._menus.some(function(t){return t.isAnimating()})},t.prototype._register=function(t){this._menus.push(t)},t.prototype._unregister=function(t){Object(r.q)(this._menus,t)},t.prototype._setActiveMenu=function(t){var e=t.side;this._menus.filter(function(n){return n.side===e&&n!==t}).map(function(t){return t.enable(!1)})},t.registerType=function(t,e){o[t]=e},t.create=function(t,e,n){return new o[t](e,n)},t}(),o={}},function(t,e,n){"use strict";function r(){return b}function i(){return!!window.history.pushState}function o(t,e){if("undefined"==typeof COMPILED||!COMPILED){(g._0.ng=g._0.ng||{})[t]=e}}function a(t){return Object(g.O)(t)}function s(t){return o(F,a),o(R,Object(y.__assign)({},D,function(t){return t.reduce(function(t,e){return t[e.name]=e.token,t},{})}(t||[]))),function(){return a}}function l(t,e,n){for(var r=0;r<e.length;r++){var i=e[r];Array.isArray(i)?l(t,i,n):(i=i.replace(G,t),n.push(i))}return n}function u(t){return function(e){!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}function c(t,e){if(t.charCodeAt(0)===q)throw new Error("Found the synthetic "+e+" "+t+'. Please include either "BrowserAnimationsModule" or "NoopAnimationsModule" in your application.')}function h(t){return(t=String(t)).match(gt)||t.match(yt)?t:(Object(g.P)()&&r().log("WARNING: sanitizing unsafe URL value "+t+" (see http://g.co/ng/security#xss)"),"unsafe:"+t)}function p(t){for(var e={},n=0,r=t.split(",");n<r.length;n++){e[r[n]]=!0}return e}function d(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n={},r=0,i=t;r<i.length;r++){var o=i[r];for(var a in o)o.hasOwnProperty(a)&&(n[a]=!0)}return n}function f(t){return t.replace(/&/g,"&amp;").replace(Et,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(Pt,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}n.d(e,"a",function(){return Vt}),n.d(e,"j",function(){return zt}),n.d(e,"h",function(){return P}),n.d(e,"i",function(){return I}),n.d(e,"b",function(){return C}),n.d(e,"d",function(){return k}),n.d(e,"e",function(){return U}),n.d(e,"f",function(){return ct}),n.d(e,"g",function(){return ht}),n.d(e,"c",function(){return Lt}),n.d(e,"r",function(){return r}),n.d(e,"l",function(){return X}),n.d(e,"k",function(){return lt}),n.d(e,"n",function(){return pt}),n.d(e,"o",function(){return mt}),n.d(e,"m",function(){return z}),n.d(e,"p",function(){return B}),n.d(e,"s",function(){return s}),n.d(e,"q",function(){return It});var m,v=n(16),g=n(0),y=n(5),b=null,_={class:"className",innerHtml:"innerHTML",readonly:"readOnly",tabindex:"tabIndex"},x={"\b":"Backspace","\t":"Tab","":"Delete","":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},w={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","":"NumLock"};g._0.Node&&(m=g._0.Node.prototype.contains||function(t){return!!(16&this.compareDocumentPosition(t))});var S,A,M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.__extends)(e,t),e.prototype.parse=function(t){throw new Error("parse not implemented")},e.makeCurrent=function(){!function(t){b||(b=t)}(new e)},e.prototype.hasProperty=function(t,e){return e in t},e.prototype.setProperty=function(t,e,n){t[e]=n},e.prototype.getProperty=function(t,e){return t[e]},e.prototype.invoke=function(t,e,n){(r=t)[e].apply(r,n);var r},e.prototype.logError=function(t){window.console&&(console.error?console.error(t):console.log(t))},e.prototype.log=function(t){window.console&&window.console.log&&window.console.log(t)},e.prototype.logGroup=function(t){window.console&&window.console.group&&window.console.group(t)},e.prototype.logGroupEnd=function(){window.console&&window.console.groupEnd&&window.console.groupEnd()},Object.defineProperty(e.prototype,"attrToPropMap",{get:function(){return _},enumerable:!0,configurable:!0}),e.prototype.contains=function(t,e){return m.call(t,e)},e.prototype.querySelector=function(t,e){return t.querySelector(e)},e.prototype.querySelectorAll=function(t,e){return t.querySelectorAll(e)},e.prototype.on=function(t,e,n){t.addEventListener(e,n,!1)},e.prototype.onAndCancel=function(t,e,n){return t.addEventListener(e,n,!1),function(){t.removeEventListener(e,n,!1)}},e.prototype.dispatchEvent=function(t,e){t.dispatchEvent(e)},e.prototype.createMouseEvent=function(t){var e=this.getDefaultDocument().createEvent("MouseEvent");return e.initEvent(t,!0,!0),e},e.prototype.createEvent=function(t){var e=this.getDefaultDocument().createEvent("Event");return e.initEvent(t,!0,!0),e},e.prototype.preventDefault=function(t){t.preventDefault(),t.returnValue=!1},e.prototype.isPrevented=function(t){return t.defaultPrevented||null!=t.returnValue&&!t.returnValue},e.prototype.getInnerHTML=function(t){return t.innerHTML},e.prototype.getTemplateContent=function(t){return"content"in t&&this.isTemplateElement(t)?t.content:null},e.prototype.getOuterHTML=function(t){return t.outerHTML},e.prototype.nodeName=function(t){return t.nodeName},e.prototype.nodeValue=function(t){return t.nodeValue},e.prototype.type=function(t){return t.type},e.prototype.content=function(t){return this.hasProperty(t,"content")?t.content:t},e.prototype.firstChild=function(t){return t.firstChild},e.prototype.nextSibling=function(t){return t.nextSibling},e.prototype.parentElement=function(t){return t.parentNode},e.prototype.childNodes=function(t){return t.childNodes},e.prototype.childNodesAsList=function(t){for(var e=t.childNodes,n=new Array(e.length),r=0;r<e.length;r++)n[r]=e[r];return n},e.prototype.clearNodes=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},e.prototype.appendChild=function(t,e){t.appendChild(e)},e.prototype.removeChild=function(t,e){t.removeChild(e)},e.prototype.replaceChild=function(t,e,n){t.replaceChild(e,n)},e.prototype.remove=function(t){return t.parentNode&&t.parentNode.removeChild(t),t},e.prototype.insertBefore=function(t,e,n){t.insertBefore(n,e)},e.prototype.insertAllBefore=function(t,e,n){n.forEach(function(n){return t.insertBefore(n,e)})},e.prototype.insertAfter=function(t,e,n){t.insertBefore(n,e.nextSibling)},e.prototype.setInnerHTML=function(t,e){t.innerHTML=e},e.prototype.getText=function(t){return t.textContent},e.prototype.setText=function(t,e){t.textContent=e},e.prototype.getValue=function(t){return t.value},e.prototype.setValue=function(t,e){t.value=e},e.prototype.getChecked=function(t){return t.checked},e.prototype.setChecked=function(t,e){t.checked=e},e.prototype.createComment=function(t){return this.getDefaultDocument().createComment(t)},e.prototype.createTemplate=function(t){var e=this.getDefaultDocument().createElement("template");return e.innerHTML=t,e},e.prototype.createElement=function(t,e){return(e=e||this.getDefaultDocument()).createElement(t)},e.prototype.createElementNS=function(t,e,n){return(n=n||this.getDefaultDocument()).createElementNS(t,e)},e.prototype.createTextNode=function(t,e){return(e=e||this.getDefaultDocument()).createTextNode(t)},e.prototype.createScriptTag=function(t,e,n){var r=(n=n||this.getDefaultDocument()).createElement("SCRIPT");return r.setAttribute(t,e),r},e.prototype.createStyleElement=function(t,e){var n=(e=e||this.getDefaultDocument()).createElement("style");return this.appendChild(n,this.createTextNode(t,e)),n},e.prototype.createShadowRoot=function(t){return t.createShadowRoot()},e.prototype.getShadowRoot=function(t){return t.shadowRoot},e.prototype.getHost=function(t){return t.host},e.prototype.clone=function(t){return t.cloneNode(!0)},e.prototype.getElementsByClassName=function(t,e){return t.getElementsByClassName(e)},e.prototype.getElementsByTagName=function(t,e){return t.getElementsByTagName(e)},e.prototype.classList=function(t){return Array.prototype.slice.call(t.classList,0)},e.prototype.addClass=function(t,e){t.classList.add(e)},e.prototype.removeClass=function(t,e){t.classList.remove(e)},e.prototype.hasClass=function(t,e){return t.classList.contains(e)},e.prototype.setStyle=function(t,e,n){t.style[e]=n},e.prototype.removeStyle=function(t,e){t.style[e]=""},e.prototype.getStyle=function(t,e){return t.style[e]},e.prototype.hasStyle=function(t,e,n){var r=this.getStyle(t,e)||"";return n?r==n:r.length>0},e.prototype.tagName=function(t){return t.tagName},e.prototype.attributeMap=function(t){for(var e=new Map,n=t.attributes,r=0;r<n.length;r++){var i=n.item(r);e.set(i.name,i.value)}return e},e.prototype.hasAttribute=function(t,e){return t.hasAttribute(e)},e.prototype.hasAttributeNS=function(t,e,n){return t.hasAttributeNS(e,n)},e.prototype.getAttribute=function(t,e){return t.getAttribute(e)},e.prototype.getAttributeNS=function(t,e,n){return t.getAttributeNS(e,n)},e.prototype.setAttribute=function(t,e,n){t.setAttribute(e,n)},e.prototype.setAttributeNS=function(t,e,n,r){t.setAttributeNS(e,n,r)},e.prototype.removeAttribute=function(t,e){t.removeAttribute(e)},e.prototype.removeAttributeNS=function(t,e,n){t.removeAttributeNS(e,n)},e.prototype.templateAwareRoot=function(t){return this.isTemplateElement(t)?this.content(t):t},e.prototype.createHtmlDocument=function(){return document.implementation.createHTMLDocument("fakeTitle")},e.prototype.getDefaultDocument=function(){return document},e.prototype.getBoundingClientRect=function(t){try{return t.getBoundingClientRect()}catch(t){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}},e.prototype.getTitle=function(t){return t.title},e.prototype.setTitle=function(t,e){t.title=e||""},e.prototype.elementMatches=function(t,e){return!!this.isElementNode(t)&&(t.matches&&t.matches(e)||t.msMatchesSelector&&t.msMatchesSelector(e)||t.webkitMatchesSelector&&t.webkitMatchesSelector(e))},e.prototype.isTemplateElement=function(t){return this.isElementNode(t)&&"TEMPLATE"===t.nodeName},e.prototype.isTextNode=function(t){return t.nodeType===Node.TEXT_NODE},e.prototype.isCommentNode=function(t){return t.nodeType===Node.COMMENT_NODE},e.prototype.isElementNode=function(t){return t.nodeType===Node.ELEMENT_NODE},e.prototype.hasShadowRoot=function(t){return null!=t.shadowRoot&&t instanceof HTMLElement},e.prototype.isShadowRoot=function(t){return t instanceof DocumentFragment},e.prototype.importIntoDoc=function(t){return document.importNode(this.templateAwareRoot(t),!0)},e.prototype.adoptNode=function(t){return document.adoptNode(t)},e.prototype.getHref=function(t){return t.getAttribute("href")},e.prototype.getEventKey=function(t){var e=t.key;if(null==e){if(null==(e=t.keyIdentifier))return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&w.hasOwnProperty(e)&&(e=w[e]))}return x[e]||e},e.prototype.getGlobalEventTarget=function(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null},e.prototype.getHistory=function(){return window.history},e.prototype.getLocation=function(){return window.location},e.prototype.getBaseHref=function(t){var e=T||(T=document.querySelector("base"))?T.getAttribute("href"):null;return null==e?null:function(t){return S||(S=document.createElement("a")),S.setAttribute("href",t),"/"===S.pathname.charAt(0)?S.pathname:"/"+S.pathname}(e)},e.prototype.resetBaseElement=function(){T=null},e.prototype.getUserAgent=function(){return window.navigator.userAgent},e.prototype.setData=function(t,e,n){this.setAttribute(t,"data-"+e,n)},e.prototype.getData=function(t,e){return this.getAttribute(t,"data-"+e)},e.prototype.getComputedStyle=function(t){return getComputedStyle(t)},e.prototype.supportsWebAnimation=function(){return"function"==typeof Element.prototype.animate},e.prototype.performanceNow=function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},e.prototype.supportsCookies=function(){return!0},e.prototype.getCookie=function(t){return Object(v.u)(document.cookie,t)},e.prototype.setCookie=function(t,e){document.cookie=encodeURIComponent(t)+"="+encodeURIComponent(e)},e}(function(t){function e(){var e=t.call(this)||this;e._animationPrefix=null,e._transitionEnd=null;try{var n=e.createElement("div",document);if(null!=e.getStyle(n,"animationName"))e._animationPrefix="";else for(var r=["Webkit","Moz","O","ms"],i=0;i<r.length;i++)if(null!=e.getStyle(n,r[i]+"AnimationName")){e._animationPrefix="-"+r[i].toLowerCase()+"-";break}var o={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};Object.keys(o).forEach(function(t){null!=e.getStyle(n,t)&&(e._transitionEnd=o[t])})}catch(t){e._animationPrefix=null,e._transitionEnd=null}return e}return Object(y.__extends)(e,t),e.prototype.getDistributedNodes=function(t){return t.getDistributedNodes()},e.prototype.resolveAndSetHref=function(t,e,n){t.href=null==n?e:e+"/../"+n},e.prototype.supportsDOMEvents=function(){return!0},e.prototype.supportsNativeShadowDOM=function(){return"function"==typeof document.body.createShadowRoot},e.prototype.getAnimationPrefix=function(){return this._animationPrefix?this._animationPrefix:""},e.prototype.getTransitionEnd=function(){return this._transitionEnd?this._transitionEnd:""},e.prototype.supportsAnimation=function(){return null!=this._animationPrefix&&null!=this._transitionEnd},e}(function(){function t(){this.resourceLoaderType=null}return Object.defineProperty(t.prototype,"attrToPropMap",{get:function(){return this._attrToPropMap},set:function(t){this._attrToPropMap=t},enumerable:!0,configurable:!0}),t}())),T=null,C=v.c,E=function(t){function e(e){var n=t.call(this)||this;return n._doc=e,n._init(),n}return Object(y.__extends)(e,t),e.prototype._init=function(){this.location=r().getLocation(),this._history=r().getHistory()},e.prototype.getBaseHrefFromDOM=function(){return r().getBaseHref(this._doc)},e.prototype.onPopState=function(t){r().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",t,!1)},e.prototype.onHashChange=function(t){r().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",t,!1)},Object.defineProperty(e.prototype,"pathname",{get:function(){return this.location.pathname},set:function(t){this.location.pathname=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"search",{get:function(){return this.location.search},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hash",{get:function(){return this.location.hash},enumerable:!0,configurable:!0}),e.prototype.pushState=function(t,e,n){i()?this._history.pushState(t,e,n):this.location.hash=n},e.prototype.replaceState=function(t,e,n){i()?this._history.replaceState(t,e,n):this.location.hash=n},e.prototype.forward=function(){this._history.forward()},e.prototype.back=function(){this._history.back()},e.ctorParameters=function(){return[{type:void 0,decorators:[{type:g.m,args:[C]}]}]},e}(v.r),P=function(){function t(t){this._doc=t,this._dom=r()}return t.prototype.addTag=function(t,e){return void 0===e&&(e=!1),t?this._getOrCreateElement(t,e):null},t.prototype.addTags=function(t,e){var n=this;return void 0===e&&(e=!1),t?t.reduce(function(t,r){return r&&t.push(n._getOrCreateElement(r,e)),t},[]):[]},t.prototype.getTag=function(t){return t?this._dom.querySelector(this._doc,"meta["+t+"]")||null:null},t.prototype.getTags=function(t){if(!t)return[];var e=this._dom.querySelectorAll(this._doc,"meta["+t+"]");return e?[].slice.call(e):[]},t.prototype.updateTag=function(t,e){if(!t)return null;e=e||this._parseSelector(t);var n=this.getTag(e);return n?this._setMetaElementAttributes(t,n):this._getOrCreateElement(t,!0)},t.prototype.removeTag=function(t){this.removeTagElement(this.getTag(t))},t.prototype.removeTagElement=function(t){t&&this._dom.remove(t)},t.prototype._getOrCreateElement=function(t,e){if(void 0===e&&(e=!1),!e){var n=this._parseSelector(t),r=this.getTag(n);if(r&&this._containsAttributes(t,r))return r}var i=this._dom.createElement("meta");this._setMetaElementAttributes(t,i);var o=this._dom.getElementsByTagName(this._doc,"head")[0];return this._dom.appendChild(o,i),i},t.prototype._setMetaElementAttributes=function(t,e){var n=this;return Object.keys(t).forEach(function(r){return n._dom.setAttribute(e,r,t[r])}),e},t.prototype._parseSelector=function(t){var e=t.name?"name":"property";return e+'="'+t[e]+'"'},t.prototype._containsAttributes=function(t,e){var n=this;return Object.keys(t).every(function(r){return n._dom.getAttribute(e,r)===t[r]})},t}(),O=new g.n("TRANSITION_ID"),N=[{provide:g.c,useFactory:function(t,e,n){return function(){n.get(g.d).donePromise.then(function(){var n=r();Array.prototype.slice.apply(n.querySelectorAll(e,"style[ng-transition]")).filter(function(e){return n.getAttribute(e,"ng-transition")===t}).forEach(function(t){return n.remove(t)})})}},deps:[O,C,g.o],multi:!0}],L=function(){function t(){}return t.init=function(){Object(g.R)(new t)},t.prototype.addToWindow=function(t){g._0.getAngularTestability=function(e,n){void 0===n&&(n=!0);var r=t.findTestabilityInTree(e,n);if(null==r)throw new Error("Could not find testability for element.");return r},g._0.getAllAngularTestabilities=function(){return t.getAllTestabilities()},g._0.getAllAngularRootElements=function(){return t.getAllRootElements()};g._0.frameworkStabilizers||(g._0.frameworkStabilizers=[]),g._0.frameworkStabilizers.push(function(t){var e=g._0.getAllAngularTestabilities(),n=e.length,r=!1,i=function(e){r=r||e,0==--n&&t(r)};e.forEach(function(t){t.whenStable(i)})})},t.prototype.findTestabilityInTree=function(t,e,n){if(null==e)return null;var i=t.getTestability(e);return null!=i?i:n?r().isShadowRoot(e)?this.findTestabilityInTree(t,r().getHost(e),!0):this.findTestabilityInTree(t,r().parentElement(e),!0):null},t}(),I=function(){function t(t){this._doc=t}return t.prototype.getTitle=function(){return r().getTitle(this._doc)},t.prototype.setTitle=function(t){r().setTitle(this._doc,t)},t}(),D={ApplicationRef:g.f,NgZone:g.u},F="probe",R="coreTokens",k=new g.n("EventManagerPlugins"),U=function(){function t(t,e){var n=this;this._zone=e,this._eventNameToPlugin=new Map,t.forEach(function(t){return t.manager=n}),this._plugins=t.slice().reverse()}return t.prototype.addEventListener=function(t,e,n){return this._findPluginFor(e).addEventListener(t,e,n)},t.prototype.addGlobalEventListener=function(t,e,n){return this._findPluginFor(e).addGlobalEventListener(t,e,n)},t.prototype.getZone=function(){return this._zone},t.prototype._findPluginFor=function(t){var e=this._eventNameToPlugin.get(t);if(e)return e;for(var n=this._plugins,r=0;r<n.length;r++){var i=n[r];if(i.supports(t))return this._eventNameToPlugin.set(t,i),i}throw new Error("No event manager plugin found for event "+t)},t}(),j=function(){function t(t){this._doc=t}return t.prototype.addGlobalEventListener=function(t,e,n){var i=r().getGlobalEventTarget(this._doc,t);if(!i)throw new Error("Unsupported event target "+i+" for event "+e);return this.addEventListener(i,e,n)},t}(),B=function(){function t(){this._stylesSet=new Set}return t.prototype.addStyles=function(t){var e=this,n=new Set;t.forEach(function(t){e._stylesSet.has(t)||(e._stylesSet.add(t),n.add(t))}),this.onStylesAdded(n)},t.prototype.onStylesAdded=function(t){},t.prototype.getAllStyles=function(){return Array.from(this._stylesSet)},t}(),z=function(t){function e(e){var n=t.call(this)||this;return n._doc=e,n._hostNodes=new Set,n._styleNodes=new Set,n._hostNodes.add(e.head),n}return Object(y.__extends)(e,t),e.prototype._addStylesToHost=function(t,e){var n=this;t.forEach(function(t){var r=n._doc.createElement("style");r.textContent=t,n._styleNodes.add(e.appendChild(r))})},e.prototype.addHost=function(t){this._addStylesToHost(this._stylesSet,t),this._hostNodes.add(t)},e.prototype.removeHost=function(t){this._hostNodes.delete(t)},e.prototype.onStylesAdded=function(t){var e=this;this._hostNodes.forEach(function(n){return e._addStylesToHost(t,n)})},e.prototype.ngOnDestroy=function(){this._styleNodes.forEach(function(t){return r().remove(t)})},e}(B),V={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},G=/%COMP%/g,H="_nghost-%COMP%",W="_ngcontent-%COMP%",X=function(){function t(t,e){this.eventManager=t,this.sharedStylesHost=e,this.rendererByCompId=new Map,this.defaultRenderer=new Y(t)}return t.prototype.createRenderer=function(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case g.J.Emulated:var n=this.rendererByCompId.get(e.id);return n||(n=new Z(this.eventManager,this.sharedStylesHost,e),this.rendererByCompId.set(e.id,n)),n.applyToHost(t),n;case g.J.Native:return new Q(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){var r=l(e.id,e.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}},t.prototype.begin=function(){},t.prototype.end=function(){},t}(),Y=function(){function t(t){this.eventManager=t,this.data=Object.create(null)}return t.prototype.destroy=function(){},t.prototype.createElement=function(t,e){return e?document.createElementNS(V[e],t):document.createElement(t)},t.prototype.createComment=function(t){return document.createComment(t)},t.prototype.createText=function(t){return document.createTextNode(t)},t.prototype.appendChild=function(t,e){t.appendChild(e)},t.prototype.insertBefore=function(t,e,n){t&&t.insertBefore(e,n)},t.prototype.removeChild=function(t,e){t&&t.removeChild(e)},t.prototype.selectRootElement=function(t){var e="string"==typeof t?document.querySelector(t):t;if(!e)throw new Error('The selector "'+t+'" did not match any elements');return e.textContent="",e},t.prototype.parentNode=function(t){return t.parentNode},t.prototype.nextSibling=function(t){return t.nextSibling},t.prototype.setAttribute=function(t,e,n,r){if(r){e=r+":"+e;var i=V[r];i?t.setAttributeNS(i,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)},t.prototype.removeAttribute=function(t,e,n){if(n){var r=V[n];r?t.removeAttributeNS(r,e):t.removeAttribute(n+":"+e)}else t.removeAttribute(e)},t.prototype.addClass=function(t,e){t.classList.add(e)},t.prototype.removeClass=function(t,e){t.classList.remove(e)},t.prototype.setStyle=function(t,e,n,r){r&g.C.DashCase?t.style.setProperty(e,n,r&g.C.Important?"important":""):t.style[e]=n},t.prototype.removeStyle=function(t,e,n){n&g.C.DashCase?t.style.removeProperty(e):t.style[e]=""},t.prototype.setProperty=function(t,e,n){c(e,"property"),t[e]=n},t.prototype.setValue=function(t,e){t.nodeValue=e},t.prototype.listen=function(t,e,n){return c(e,"listener"),"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,u(n)):this.eventManager.addEventListener(t,e,u(n))},t}(),q="@".charCodeAt(0),Z=function(t){function e(e,n,r){var i=t.call(this,e)||this;i.component=r;var o=l(r.id,r.styles,[]);return n.addStyles(o),i.contentAttr=function(t){return W.replace(G,t)}(r.id),i.hostAttr=function(t){return H.replace(G,t)}(r.id),i}return Object(y.__extends)(e,t),e.prototype.applyToHost=function(e){t.prototype.setAttribute.call(this,e,this.hostAttr,"")},e.prototype.createElement=function(e,n){var r=t.prototype.createElement.call(this,e,n);return t.prototype.setAttribute.call(this,r,this.contentAttr,""),r},e}(Y),Q=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;o.sharedStylesHost=n,o.hostEl=r,o.component=i,o.shadowRoot=r.createShadowRoot(),o.sharedStylesHost.addHost(o.shadowRoot);for(var a=l(i.id,i.styles,[]),s=0;s<a.length;s++){var u=document.createElement("style");u.textContent=a[s],o.shadowRoot.appendChild(u)}return o}return Object(y.__extends)(e,t),e.prototype.nodeOrShadowRoot=function(t){return t===this.hostEl?this.shadowRoot:t},e.prototype.destroy=function(){this.sharedStylesHost.removeHost(this.shadowRoot)},e.prototype.appendChild=function(e,n){return t.prototype.appendChild.call(this,this.nodeOrShadowRoot(e),n)},e.prototype.insertBefore=function(e,n,r){return t.prototype.insertBefore.call(this,this.nodeOrShadowRoot(e),n,r)},e.prototype.removeChild=function(e,n){return t.prototype.removeChild.call(this,this.nodeOrShadowRoot(e),n)},e.prototype.parentNode=function(e){return this.nodeOrShadowRoot(t.prototype.parentNode.call(this,this.nodeOrShadowRoot(e)))},e}(Y),J="undefined"!=typeof Zone&&Zone.__symbol__||function(t){return"__zone_symbol__"+t},K=J("addEventListener"),$=J("removeEventListener"),tt={},et="removeEventListener",nt="__zone_symbol__propagationStopped",rt="__zone_symbol__stopImmediatePropagation",it="undefined"!=typeof Zone&&Zone[J("BLACK_LISTED_EVENTS")];it&&(A={});var ot,at=function(t){return!!A&&A.hasOwnProperty(t)},st=function(t){var e=tt[t.type];if(e){var n=this[e];if(n){var r=[t];if(1===n.length){return(a=n[0]).zone!==Zone.current?a.zone.run(a.handler,this,r):a.handler.apply(this,r)}for(var i=n.slice(),o=0;o<i.length&&!0!==t[nt];o++){var a;(a=i[o]).zone!==Zone.current?a.zone.run(a.handler,this,r):a.handler.apply(this,r)}}}},lt=function(t){function e(e,n){var r=t.call(this,e)||this;return r.ngZone=n,r.patchEvent(),r}return Object(y.__extends)(e,t),e.prototype.patchEvent=function(){if(Event&&Event.prototype&&!Event.prototype[rt]){var t=Event.prototype[rt]=Event.prototype.stopImmediatePropagation;Event.prototype.stopImmediatePropagation=function(){this&&(this[nt]=!0),t&&t.apply(this,arguments)}}},e.prototype.supports=function(t){return!0},e.prototype.addEventListener=function(t,e,n){var r=this,i=n;if(!t[K]||g.u.isInAngularZone()&&!at(e))t.addEventListener(e,i,!1);else{var o=tt[e];o||(o=tt[e]=J("ANGULAR"+e+"FALSE"));var a=t[o],s=a&&a.length>0;a||(a=t[o]=[]);var l=at(e)?Zone.root:Zone.current;if(0===a.length)a.push({zone:l,handler:i});else{for(var u=!1,c=0;c<a.length;c++)if(a[c].handler===i){u=!0;break}u||a.push({zone:l,handler:i})}s||t[K](e,st,!1)}return function(){return r.removeEventListener(t,e,i)}},e.prototype.removeEventListener=function(t,e,n){var r=t[$];if(!r)return t[et].apply(t,[e,n,!1]);var i=tt[e],o=i&&t[i];if(!o)return t[et].apply(t,[e,n,!1]);for(var a=!1,s=0;s<o.length;s++)if(o[s].handler===n){a=!0,o.splice(s,1);break}a?0===o.length&&r.apply(t,[e,st,!1]):t[et].apply(t,[e,n,!1])},e}(j),ut={pan:!0,panstart:!0,panmove:!0,panend:!0,pancancel:!0,panleft:!0,panright:!0,panup:!0,pandown:!0,pinch:!0,pinchstart:!0,pinchmove:!0,pinchend:!0,pinchcancel:!0,pinchin:!0,pinchout:!0,press:!0,pressup:!0,rotate:!0,rotatestart:!0,rotatemove:!0,rotateend:!0,rotatecancel:!0,swipe:!0,swipeleft:!0,swiperight:!0,swipeup:!0,swipedown:!0,tap:!0},ct=new g.n("HammerGestureConfig"),ht=function(){function t(){this.events=[],this.overrides={}}return t.prototype.buildHammer=function(t){var e=new Hammer(t);e.get("pinch").set({enable:!0}),e.get("rotate").set({enable:!0});for(var n in this.overrides)e.get(n).set(this.overrides[n]);return e},t}(),pt=function(t){function e(e,n){var r=t.call(this,e)||this;return r._config=n,r}return Object(y.__extends)(e,t),e.prototype.supports=function(t){if(!ut.hasOwnProperty(t.toLowerCase())&&!this.isCustomEvent(t))return!1;if(!window.Hammer)throw new Error("Hammer.js is not loaded, can not bind "+t+" event");return!0},e.prototype.addEventListener=function(t,e,n){var r=this,i=this.manager.getZone();return e=e.toLowerCase(),i.runOutsideAngular(function(){var o=r._config.buildHammer(t),a=function(t){i.runGuarded(function(){n(t)})};return o.on(e,a),function(){return o.off(e,a)}})},e.prototype.isCustomEvent=function(t){return this._config.events.indexOf(t)>-1},e}(j),dt=["alt","control","meta","shift"],ft={alt:function(t){return t.altKey},control:function(t){return t.ctrlKey},meta:function(t){return t.metaKey},shift:function(t){return t.shiftKey}},mt=function(t){function e(e){return t.call(this,e)||this}return Object(y.__extends)(e,t),e.prototype.supports=function(t){return null!=e.parseEventName(t)},e.prototype.addEventListener=function(t,n,i){var o=e.parseEventName(n),a=e.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(function(){return r().onAndCancel(t,o.domEventName,a)})},e.parseEventName=function(t){var n=t.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;var i=e._normalizeKey(n.pop()),o="";if(dt.forEach(function(t){var e=n.indexOf(t);e>-1&&(n.splice(e,1),o+=t+".")}),o+=i,0!=n.length||0===i.length)return null;var a={};return a.domEventName=r,a.fullKey=o,a},e.getEventFullKey=function(t){var e="",n=r().getEventKey(t);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),dt.forEach(function(r){if(r!=n){(0,ft[r])(t)&&(e+=r+".")}}),e+=n},e.eventCallback=function(t,n,r){return function(i){e.getEventFullKey(i)===t&&r.runGuarded(function(){return n(i)})}},e._normalizeKey=function(t){switch(t){case"esc":return"escape";default:return t}},e}(j),vt=function(){function t(t,e){this.defaultDoc=t,this.DOM=e;var n=this.DOM.createHtmlDocument();if(this.inertBodyElement=n.body,null==this.inertBodyElement){var r=this.DOM.createElement("html",n);this.inertBodyElement=this.DOM.createElement("body",n),this.DOM.appendChild(r,this.inertBodyElement),this.DOM.appendChild(n,r)}this.DOM.setInnerHTML(this.inertBodyElement,'<svg><g onload="this.parentNode.remove()"></g></svg>'),!this.inertBodyElement.querySelector||this.inertBodyElement.querySelector("svg")?(this.DOM.setInnerHTML(this.inertBodyElement,'<svg><p><style><img src="</style><img src=x onerror=alert(1)//">'),this.getInertBodyElement=this.inertBodyElement.querySelector&&this.inertBodyElement.querySelector("svg img")&&function(){try{return!!window.DOMParser}catch(t){return!1}}()?this.getInertBodyElement_DOMParser:this.getInertBodyElement_InertDocument):this.getInertBodyElement=this.getInertBodyElement_XHR}return t.prototype.getInertBodyElement_XHR=function(t){t="<body><remove></remove>"+t+"</body>";try{t=encodeURI(t)}catch(t){return null}var e=new XMLHttpRequest;e.responseType="document",e.open("GET","data:text/html;charset=utf-8,"+t,!1),e.send(null);var n=e.response.body;return n.removeChild(n.firstChild),n},t.prototype.getInertBodyElement_DOMParser=function(t){t="<body><remove></remove>"+t+"</body>";try{var e=(new window.DOMParser).parseFromString(t,"text/html").body;return e.removeChild(e.firstChild),e}catch(t){return null}},t.prototype.getInertBodyElement_InertDocument=function(t){var e=this.DOM.createElement("template");return"content"in e?(this.DOM.setInnerHTML(e,t),e):(this.DOM.setInnerHTML(this.inertBodyElement,t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(this.inertBodyElement),this.inertBodyElement)},t.prototype.stripCustomNsAttrs=function(t){var e=this;this.DOM.attributeMap(t).forEach(function(n,r){"xmlns:ns1"!==r&&0!==r.indexOf("ns1:")||e.DOM.removeAttribute(t,r)});for(var n=0,r=this.DOM.childNodesAsList(t);n<r.length;n++){var i=r[n];this.DOM.isElementNode(i)&&this.stripCustomNsAttrs(i)}},t}(),gt=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,yt=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i,bt=p("area,br,col,hr,img,wbr"),_t=p("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),xt=p("rp,rt"),wt=d(xt,_t),St=d(bt,d(_t,p("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),d(xt,p("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),wt),At=p("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Mt=p("srcset"),Tt=d(At,Mt,p("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width")),Ct=function(){function t(){this.sanitizedSomething=!1,this.buf=[],this.DOM=r()}return t.prototype.sanitizeChildren=function(t){for(var e=this.DOM.firstChild(t);e;)if(this.DOM.isElementNode(e)?this.startElement(e):this.DOM.isTextNode(e)?this.chars(this.DOM.nodeValue(e)):this.sanitizedSomething=!0,this.DOM.firstChild(e))e=this.DOM.firstChild(e);else for(;e;){this.DOM.isElementNode(e)&&this.endElement(e);var n=this.checkClobberedElement(e,this.DOM.nextSibling(e));if(n){e=n;break}e=this.checkClobberedElement(e,this.DOM.parentElement(e))}return this.buf.join("")},t.prototype.startElement=function(t){var e=this,n=this.DOM.nodeName(t).toLowerCase();St.hasOwnProperty(n)?(this.buf.push("<"),this.buf.push(n),this.DOM.attributeMap(t).forEach(function(t,n){var r=n.toLowerCase();Tt.hasOwnProperty(r)?(At[r]&&(t=h(t)),Mt[r]&&(t=function(t){return(t=String(t)).split(",").map(function(t){return h(t.trim())}).join(", ")}(t)),e.buf.push(" "),e.buf.push(n),e.buf.push('="'),e.buf.push(f(t)),e.buf.push('"')):e.sanitizedSomething=!0}),this.buf.push(">")):this.sanitizedSomething=!0},t.prototype.endElement=function(t){var e=this.DOM.nodeName(t).toLowerCase();St.hasOwnProperty(e)&&!bt.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))},t.prototype.chars=function(t){this.buf.push(f(t))},t.prototype.checkClobberedElement=function(t,e){if(e&&this.DOM.contains(t,e))throw new Error("Failed to sanitize html because the element is clobbered: "+this.DOM.getOuterHTML(t));return e},t}(),Et=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Pt=/([^\#-~ |!])/g,Ot=new RegExp("^([-,.\"'%_!# a-zA-Z0-9]+|(?:(?:matrix|translate|scale|rotate|skew|perspective)(?:X|Y|3d)?|(?:rgb|hsl)a?|(?:repeating-)?(?:linear|radial)-gradient|(?:calc|attr))\\([-0-9.%, #a-zA-Z]+\\))$","g"),Nt=/^url\(([^)]+)\)$/,Lt=function(){return function(){}}(),It=function(t){function e(e){var n=t.call(this)||this;return n._doc=e,n}return Object(y.__extends)(e,t),e.prototype.sanitize=function(t,e){if(null==e)return null;switch(t){case g.E.NONE:return e;case g.E.HTML:return e instanceof Ft?e.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(e,"HTML"),function(t,e){var n=r(),i=null;try{ot=ot||new vt(t,n);var o=e?String(e):"";i=ot.getInertBodyElement(o);var a=5,s=o;do{if(0===a)throw new Error("Failed to sanitize html because the input is unstable");a--,o=s,s=n.getInnerHTML(i),i=ot.getInertBodyElement(o)}while(o!==s);var l=new Ct,u=l.sanitizeChildren(n.getTemplateContent(i)||i);return Object(g.P)()&&l.sanitizedSomething&&n.log("WARNING: sanitizing HTML stripped some content (see http://g.co/ng/security#xss)."),u}finally{if(i)for(var c=n.getTemplateContent(i)||i,h=0,p=n.childNodesAsList(c);h<p.length;h++)n.removeChild(c,p[h])}}(this._doc,String(e)));case g.E.STYLE:return e instanceof Rt?e.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(e,"Style"),function(t){if(!(t=String(t).trim()))return"";var e=t.match(Nt);return e&&h(e[1])===e[1]||t.match(Ot)&&function(t){for(var e=!0,n=!0,r=0;r<t.length;r++){var i=t.charAt(r);"'"===i&&n?e=!e:'"'===i&&e&&(n=!n)}return e&&n}(t)?t:(Object(g.P)()&&r().log("WARNING: sanitizing unsafe style value "+t+" (see http://g.co/ng/security#xss)."),"unsafe")}(e));case g.E.SCRIPT:if(e instanceof kt)return e.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(e,"Script"),new Error("unsafe value used in a script context");case g.E.URL:return e instanceof jt||e instanceof Ut?e.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(e,"URL"),h(String(e)));case g.E.RESOURCE_URL:if(e instanceof jt)return e.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(e,"ResourceURL"),new Error("unsafe value used in a resource URL context (see http://g.co/ng/security#xss)");default:throw new Error("Unexpected SecurityContext "+t+" (see http://g.co/ng/security#xss)")}},e.prototype.checkNotSafeValue=function(t,e){if(t instanceof Dt)throw new Error("Required a safe "+e+", got a "+t.getTypeName()+" (see http://g.co/ng/security#xss)")},e.prototype.bypassSecurityTrustHtml=function(t){return new Ft(t)},e.prototype.bypassSecurityTrustStyle=function(t){return new Rt(t)},e.prototype.bypassSecurityTrustScript=function(t){return new kt(t)},e.prototype.bypassSecurityTrustUrl=function(t){return new Ut(t)},e.prototype.bypassSecurityTrustResourceUrl=function(t){return new jt(t)},e}(Lt),Dt=function(){function t(t){this.changingThisBreaksApplicationSecurity=t}return t.prototype.toString=function(){return"SafeValue must use [property]=binding: "+this.changingThisBreaksApplicationSecurity+" (see http://g.co/ng/security#xss)"},t}(),Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.__extends)(e,t),e.prototype.getTypeName=function(){return"HTML"},e}(Dt),Rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.__extends)(e,t),e.prototype.getTypeName=function(){return"Style"},e}(Dt),kt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.__extends)(e,t),e.prototype.getTypeName=function(){return"Script"},e}(Dt),Ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.__extends)(e,t),e.prototype.getTypeName=function(){return"URL"},e}(Dt),jt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(y.__extends)(e,t),e.prototype.getTypeName=function(){return"ResourceURL"},e}(Dt),Bt=[{provide:g.w,useValue:v.s},{provide:g.x,useValue:function(){M.makeCurrent(),L.init()},multi:!0},{provide:v.r,useClass:E,deps:[C]},{provide:C,useFactory:function(){return document},deps:[]}],zt=Object(g.L)(g.Q,"browser",Bt),Vt=function(){function t(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return t.withServerTransition=function(e){return{ngModule:t,providers:[{provide:g.b,useValue:e.appId},{provide:O,useExisting:g.b},N]}},t}();"undefined"!=typeof window&&window},function(t,e,n){"use strict";var r=n(5).__extends,i=n(133),o=n(37),a=n(137),s=n(79),l=function(t){function e(e,n,r){switch(t.call(this),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=a.empty;break;case 1:if(!e){this.destination=a.empty;break}if("object"==typeof e){if(function(t){return t instanceof l||"syncErrorThrowable"in t&&t[s.rxSubscriber]}(e)){var i=e[s.rxSubscriber]();this.syncErrorThrowable=i.syncErrorThrowable,this.destination=i,i.add(this)}else this.syncErrorThrowable=!0,this.destination=new u(this,e);break}default:this.syncErrorThrowable=!0,this.destination=new u(this,e,n,r)}}return r(e,t),e.prototype[s.rxSubscriber]=function(){return this},e.create=function(t,n,r){var i=new e(t,n,r);return i.syncErrorThrowable=!1,i},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parent,e=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this},e}(o.Subscription);e.Subscriber=l;var u=function(t){function e(e,n,r,o){t.call(this),this._parentSubscriber=e;var s,l=this;i.isFunction(n)?s=n:n&&(s=n.next,r=n.error,o=n.complete,n!==a.empty&&(l=Object.create(n),i.isFunction(l.unsubscribe)&&this.add(l.unsubscribe.bind(l)),l.unsubscribe=this.unsubscribe.bind(this))),this._context=l,this._next=s,this._error=r,this._complete=o}return r(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber;if(this._error)e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else{if(!e.syncErrorThrowable)throw this.unsubscribe(),t;e.syncErrorValue=t,e.syncErrorThrown=!0,this.unsubscribe()}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var n=function(){return t._complete.call(t._context)};e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){throw this.unsubscribe(),t}},e.prototype.__tryOrSetError=function(t,e,n){try{e.call(this._context,n)}catch(e){return t.syncErrorValue=e,t.syncErrorThrown=!0,!0}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(l)},function(t,e,n){"use strict";function r(t,e,n){return"function"==typeof e?Promise.resolve(new a.a(e,n)):"string"==typeof e?t.getComponentFromName(e).then(function(t){var r=new a.a(t,n);return r.id=e,r}):Promise.resolve(null)}function i(t,e,n){return e?Object(a.b)(e)?Promise.resolve(e):r(t,e,n):Promise.resolve(null)}e.j=r,e.i=function(t,e){var n=[];if(Object(o.e)(e))for(var r=0;r<e.length;r++){var s=e[r];s&&(Object(a.b)(s)?n.push(s):n.push(s.page?i(t,s.page,s.params):i(t,s,null)))}return Promise.all(n)},e.n=function(t,e,n,r,i){if(e){if(t._isPortal)return r===f&&e._setZIndex(t._zIndexOffset+s,i),void s++;(n=n||t.getPrevious(e))&&Object(o.l)(n._zIndex)?e._setZIndex(r===d?n._zIndex-1:n._zIndex+1,i):e._setZIndex(p+t._zIndexOffset,i)}},e.m=function(t){return!!t&&!!t.getSelected},e.l=function(t){return!!t&&Object(o.l)(t._tabId)},e.k=function(t){return!!t&&!!t.push&&"nav"===t.getType()},n.d(e,"h",function(){return l}),n.d(e,"g",function(){return u}),n.d(e,"e",function(){return c}),n.d(e,"f",function(){return h}),n.d(e,"d",function(){return p}),n.d(e,"a",function(){return d}),n.d(e,"b",function(){return f}),n.d(e,"c",function(){return m});var o=n(2),a=n(4),s=9999,l=1,u=2,c=3,h=4,p=100,d="back",f="forward",m="switch"},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(144),i=function(){function t(t){this.plt=t,this.evts=[]}return t.prototype.pointerEvents=function(t){if(t.element&&t.pointerDown){var e=new r.b(this.plt,t.element,t.pointerDown,t.pointerMove,t.pointerUp,{capture:t.capture,passive:t.passive,zone:t.zone});return this.evts.push(function(){return e.destroy()}),e}console.error("PointerEvents config is invalid")},t.prototype.listen=function(t,e,n,r){if(t){var i=this.plt.registerListener(t,e,n,r);return this.evts.push(i),i}},t.prototype.unlistenAll=function(){this.evts.forEach(function(t){t()}),this.evts.length=0},t.prototype.destroy=function(){this.unlistenAll(),this.evts=null},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return i});n(1);var r=n(2),i=(n(3),function(){function t(t,e){this.plt=t,this._config=e,this._ids=0,this._trns={}}return t.prototype.getRootTrnsId=function(t){for(t=t.parent;t;){if(Object(r.l)(t._trnsId))return t._trnsId;t=t.parent}return null},t.prototype.nextId=function(){return this._ids++},t.prototype.get=function(t,e,n,r){var i=this._config.getTransition(r.animation);i||(i=this._config.getTransition("ios-transition"));var o=new i(this.plt,e,n,r);return o.trnsId=t,this._trns[t]?this._trns[t].add(o):this._trns[t]=o,o},t.prototype.destroy=function(t){var e=this._trns[t];e&&(e.destroy(),delete this._trns[t])},t}())},function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n(0),i=n(2),o=n(6),a=n(150),s=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),l=function(t){function e(e,n,o,s,l,u,c,h){var p=t.call(this,e,n,o,s)||this;return p._defaultValue=l,p._form=u,p._item=c,p._ngControl=h,p._isFocus=!1,p._disabled=!1,p._debouncer=new a.a(0),p._init=!1,p._initModel=!1,p.ionFocus=new r.l,p.ionChange=new r.l,p.ionBlur=new r.l,u&&u.register(p),p._value=Object(i.b)(p._defaultValue),c&&(p.id=s+"-"+c.registerInput(s),p._labelId=c.labelId,p._item.setElementClass("item-"+s,!0)),h&&(h.valueAccessor=p),p}return s(e,t),Object.defineProperty(e.prototype,"disabled",{get:function(){return this._disabled},set:function(t){this.setDisabledState(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){this._writeValue(t)&&(this.onChange(),this._fireIonChange())},enumerable:!0,configurable:!0}),e.prototype.setValue=function(t){this.value=t},e.prototype.setDisabledState=function(t){this._disabled=t=Object(i.o)(t),this._item&&this._item.setElementClass("item-"+this._componentName+"-disabled",t)},e.prototype.writeValue=function(t){this._writeValue(t)&&(this._initModel?this._fireIonChange():this._init&&(this._initModel=!0))},e.prototype._writeValue=function(t){if(Object(i.p)(t))return!1;var e=null===t?Object(i.b)(this._defaultValue):this._inputNormalize(t);return!(Object(i.p)(e)||!this._inputShouldChange(e))&&(this._value=e,this._init&&this._inputUpdated(),!0)},e.prototype._fireIonChange=function(){var t=this;this._init&&this._debouncer.debounce(function(){t.ionChange.emit(t._inputChangeEvent()),t._initModel=!0})},e.prototype.registerOnChange=function(t){this._onChanged=t},e.prototype.registerOnTouched=function(t){this._onTouched=t},e.prototype._initialize=function(){this._init||(this._init=!0,Object(i.l)(this._value)&&this._inputUpdated())},e.prototype._fireFocus=function(){this._isFocus||(this._form&&this._form.setAsFocused(this),this._setFocus(!0),this.ionFocus.emit(this))},e.prototype._fireBlur=function(){this._isFocus&&(this._form&&this._form.unsetAsFocused(this),this._setFocus(!1),this._fireTouched(),this.ionBlur.emit(this))},e.prototype._fireTouched=function(){this._onTouched&&this._onTouched()},e.prototype._setFocus=function(t){this._isFocus=t;var e=this._item;e&&(e.setElementClass("input-has-focus",t),e.setElementClass("item-input-has-focus",t)),this._inputUpdated()},e.prototype.onChange=function(){this._onChanged&&this._onChanged(this._inputNgModelEvent())},e.prototype.isFocus=function(){return this._isFocus},e.prototype.hasValue=function(){var t=this._value;return!!Object(i.l)(t)&&(!Object(i.e)(t)&&!Object(i.n)(t)||t.length>0)},e.prototype.focusNext=function(){this._form&&this._form.tabFocus(this)},e.prototype.ngOnDestroy=function(){var t=this._form;t&&t.deregister(this),this._init=!1},e.prototype.ngAfterContentInit=function(){this._initialize()},e.prototype.initFocus=function(){var t=this._elementRef.nativeElement.querySelector("button");t&&t.focus()},e.prototype._inputNormalize=function(t){return t},e.prototype._inputShouldChange=function(t){return this._value!==t},e.prototype._inputChangeEvent=function(){return this},e.prototype._inputNgModelEvent=function(){return this._value},e.prototype._inputUpdated=function(){var t=this._item;if(t){!function(t,e){e&&(t.setElementClass("ng-untouched",e.untouched),t.setElementClass("ng-touched",e.touched),t.setElementClass("ng-pristine",e.pristine),t.setElementClass("ng-dirty",e.dirty),t.setElementClass("ng-valid",e.valid),t.setElementClass("ng-invalid",!e.valid))}(t,this._ngControl);var e=this.hasValue();t.setElementClass("input-has-value",e),t.setElementClass("item-input-has-value",e)}},e}(o.a)},function(t,e,n){"use strict";(function(t){var n="undefined"!=typeof window&&window,r="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,i=n||void 0!==t&&t||r;e.root=i,function(){if(!i)throw new Error("RxJS could not find any global context (window, self, global)")}()}).call(e,n(78))},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(15),i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(t){function e(e,n,r,i){var o=t.call(this,e,null,i)||this;return o.enteringView=n,o.leavingView=r,o}return i(e,t),e.prototype.init=function(){},e.prototype.registerStart=function(t){this._trnsStart=t},e.prototype.start=function(){this._trnsStart&&this._trnsStart(),this._trnsStart=null,this.parent&&this.parent.start()},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.parent=this.enteringView=this.leavingView=this._trnsStart=null},e}(r.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return r});n(6),n(2),n(1),n(3),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}}();var r=function(){return function(){}}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"b",function(){return a}),e.c=function(t,e){return new a(t,e)},e.d=function(t,e,n,r){return function(){Object(i.s)(function(){r.runOutsideAngular(function(){!function(t,e,n){if(!e||!e.links||!t.getBoolean("preloadModules"))return Promise.resolve();var r=e.links.filter(function(t){return!!t.loadChildren&&"off"!==t.priority}),i=r.filter(function(t){return"high"===t.priority}).map(function(t){return n.load(t.loadChildren)});Promise.all(i).then(function(){var t=r.filter(function(t){return"low"===t.priority}).map(function(t){return n.load(t.loadChildren)});return Promise.all(t)}).catch(function(t){console.error(t.message)})}(t,e,n)})})}};var r=n(0),i=(n(89),n(2)),o=new r.n("LZYCMP"),a=function(){function t(t,e){this._ngModuleLoader=t,this._injector=e,this._cfrMap=new Map,this._promiseMap=new Map}return t.prototype.load=function(t){var e=this,n=t.split(s),r=this._promiseMap.get(t);return r||(r=this._ngModuleLoader.load(n[0],n[1]),this._promiseMap.set(t,r)),r.then(function(t){var n=t.create(e._injector),r=n.injector.get(o);return e._cfrMap.set(r,n.componentFactoryResolver),{componentFactoryResolver:n.componentFactoryResolver,component:r}})},t.prototype.getComponentFactoryResolver=function(t){return this._cfrMap.get(t)},t}(),s="#"},function(t,e,n){"use strict";function r(t){return t.reduce(function(t,e){return t.concat(e instanceof u.UnsubscriptionError?e.errors:e)},[])}var i=n(134),o=n(135),a=n(133),s=n(200),l=n(136),u=n(201);e.Subscription=function(){function t(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var t,e=!1;if(!this.closed){var n=this._parent,c=this._parents,h=this._unsubscribe,p=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var d=-1,f=c?c.length:0;n;)n.remove(this),n=++d<f&&c[d]||null;if(a.isFunction(h)){s.tryCatch(h).call(this)===l.errorObject&&(e=!0,t=t||(l.errorObject.e instanceof u.UnsubscriptionError?r(l.errorObject.e.errors):[l.errorObject.e]))}if(i.isArray(p))for(d=-1,f=p.length;++d<f;){var m=p[d];if(o.isObject(m)){if(s.tryCatch(m.unsubscribe).call(m)===l.errorObject){e=!0,t=t||[];var v=l.errorObject.e;v instanceof u.UnsubscriptionError?t=t.concat(r(v.errors)):t.push(v)}}}if(e)throw new u.UnsubscriptionError(t)}},t.prototype.add=function(e){if(!e||e===t.EMPTY)return t.EMPTY;if(e===this)return this;var n=e;switch(typeof e){case"function":n=new t(e);case"object":if(n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if("function"!=typeof n._addParent){var r=n;(n=new t)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(n),n._addParent(this),n},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},t.prototype._addParent=function(t){var e=this._parent,n=this._parents;e&&e!==t?n?-1===n.indexOf(t)&&n.push(t):this._parents=[t]:this._parent=t},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(15),i=n(34),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.init=function(){var t=this;this.enteringView&&(this.enteringPage=new r.a(this.plt,this.enteringView.pageRef()),this.add(this.enteringPage.beforeAddClass("show-page")),this.beforeAddRead(function(){t.enteringView.readReady.emit()}),this.beforeAddWrite(function(){t.enteringView.writeReady.emit()}))},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.enteringPage&&this.enteringPage.destroy(),this.enteringPage=null},e}(i.a)},function(t,e,n){"use strict";function r(t){return i._22(2,[(t()(),i.Z(0,0,null,null,1,"span",[["class","button-inner"]],null,null,null,null,null)),i._10(null,0),(t()(),i.Z(2,0,null,null,0,"div",[["class","button-effect"]],null,null,null,null,null))],null,null)}n.d(e,"a",function(){return o}),e.b=r;var i=n(0),o=(n(1),i.X({encapsulation:2,styles:[],data:{}}))},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(2),i=(n(1),n(6)),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=function(t){function e(e,n,r){var i=t.call(this,e,n,r,"icon")||this;return i._isActive=!0,i._name="",i._ios="",i._md="",i._css="",i._hidden=!1,i._iconMode=e.get("iconMode"),i}return o(e,t),e.prototype.ngOnDestroy=function(){this._css&&this.setElementClass(this._css,!1)},Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(t){this._name=/^md-|^ios-|^logo-/.test(t)?t:this._iconMode+"-"+t,this.update()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ios",{get:function(){return this._ios},set:function(t){this._ios=t,this.update()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"md",{get:function(){return this._md},set:function(t){this._md=t,this.update()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isActive",{get:function(){return this._isActive},set:function(t){this._isActive=Object(r.o)(t),this.update()},enumerable:!0,configurable:!0}),e.prototype.update=function(){var t;if(!(this._hidden=null===(t=this._ios&&"ios"===this._iconMode?this._ios:this._md&&"md"===this._iconMode?this._md:this._name))){"ios"===t.split("-",2)[0]&&!this._isActive&&t.indexOf("logo-")<0&&t.indexOf("-outline")<0&&(t+="-outline");var e="ion-"+t;if(this._css!==e){this._css&&this.setElementClass(this._css,!1),this._css=e,this.setElementClass(e,!0);var n=t.replace("ios-","").replace("md-","").replace("-"," ");this.setElementAttribute("aria-label",n)}}},e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return a});n(1);var r=n(2),i=(n(19),n(164)),o=(n(4),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),a=function(t){function e(e,n,r,i,o,a){var s=t.call(this,i,o,a)||this;return s._app=e,s.navCtrl=r,s._hidden=!1,s._hideBb=!1,n&&n._setNavbar(s),s._bbIcon=i.get("backButtonIcon"),s._sbPadding=i.getBoolean("statusbarPadding"),s._backText=i.get("backButtonText","Back"),s}return o(e,t),Object.defineProperty(e.prototype,"hideBackButton",{get:function(){return this._hideBb},set:function(t){this._hideBb=Object(r.o)(t)},enumerable:!0,configurable:!0}),e.prototype.backButtonClick=function(t){t.preventDefault(),t.stopPropagation(),this.navCtrl&&this.navCtrl.pop(null,null)},e.prototype.setBackButtonText=function(t){this._backText=t},e.prototype.didEnter=function(){try{this._app.setTitle(this.getTitleText())}catch(t){console.error(t)}},e.prototype.setHidden=function(t){this._hidden=t},e}(i.a)},function(t,e,n){"use strict";var r=n(0),i=(n(21),n(9),n(2)),o=n(152),a=n(11),s=n(30),l=function(){function t(t,e){this.plt=t,this.reorderList=e,this.selectedItemEle=null,this.events=new s.a(t),this.events.pointerEvents({element:this.reorderList.getNativeElement(),pointerDown:this.onDragStart.bind(this),pointerMove:this.onDragMove.bind(this),pointerUp:this.onDragEnd.bind(this),zone:!1})}return t.prototype.onDragStart=function(t){if(this.selectedItemEle)return!1;var e=t.target;if("ION-REORDER"!==e.nodeName)return!1;var n=e.$ionComponent;if(!n)return console.error("ion-reorder does not contain $ionComponent"),!1;this.reorderList._reorderPrepare();var r=n.getReorderNode();return r?(t.preventDefault(),this.selectedItemEle=r,this.selectedItemHeight=r.offsetHeight,this.lastYcoord=-100,this.lastToIndex=Object(o.b)(r),this.windowHeight=this.plt.height()-u,this.lastScrollPosition=this.reorderList._scrollContent(0),this.offset=Object(a.f)(t),this.offset.y+=this.lastScrollPosition,r.classList.add(h),this.reorderList._reorderStart(),!0):(console.error("reorder node not found"),!1)},t.prototype.onDragMove=function(t){var e=this.selectedItemEle;if(e){t.preventDefault();var n=Object(a.f)(t),r=n.y,i=this.scroll(r);if(Math.abs(r-this.lastYcoord)>30){var s=this.itemForCoord(n);if(s){var l=Object(o.b)(s);if(void 0!==l&&(l!==this.lastToIndex||this.emptyZone)){var u=Object(o.b)(e);this.lastToIndex=l,this.lastYcoord=r,this.emptyZone=!1,this.reorderList._reorderMove(u,l,this.selectedItemHeight)}}else this.emptyZone=!0}var c=Math.round(r-this.offset.y+i);e.style[this.plt.Css.transform]="translateY("+c+"px)"}},t.prototype.onDragEnd=function(t){var e=this,n=this.selectedItemEle;if(n){t&&(t.preventDefault(),t.stopPropagation());var r=this.lastToIndex,i=Object(o.b)(n),a=function(){e.selectedItemEle.style.transition="",e.selectedItemEle.classList.remove(h),e.selectedItemEle=null};r===i?(n.style.transition="transform 200ms ease-in-out",setTimeout(a,200)):a(),this.reorderList._reorderEmit(i,r)}},t.prototype.itemForCoord=function(t){var e=this.plt.getElementFromPoint(this.offset.x+(this.reorderList._isStart===this.plt.isRTL?-100:100),t.y);return Object(o.a)(e,this.reorderList.getNativeElement())},t.prototype.scroll=function(t){return t<u?this.lastScrollPosition=this.reorderList._scrollContent(-c):t>this.windowHeight&&(this.lastScrollPosition=this.reorderList._scrollContent(c)),this.lastScrollPosition},t.prototype.destroy=function(){this.onDragEnd(null),this.events.destroy(),this.events=null,this.reorderList=null},t}(),u=60,c=10,h="reorder-active";n(3);n.d(e,"a",function(){return d});var p=function(){function t(t,e){this.from=t,this.to=e}return t.prototype.applyTo=function(t){Object(i.r)(t,this)},t}(),d=function(){function t(t,e,n,i,o,a){this._plt=t,this._dom=e,this._rendered=i,this._zone=o,this._content=a,this._enableReorder=!1,this._visibleReorder=!1,this._isStart=!1,this._lastToIndex=-1,this.ionItemReorder=new r.l,this._element=n.nativeElement}return Object.defineProperty(t.prototype,"side",{set:function(t){this._isStart="start"===t},enumerable:!0,configurable:!0}),t.prototype.ngOnDestroy=function(){this._element=null,this._reorderGesture&&this._reorderGesture.destroy()},Object.defineProperty(t.prototype,"reorder",{get:function(){return this._enableReorder},set:function(t){var e=this,n=Object(i.o)(t);!n&&this._reorderGesture?(this._reorderGesture.destroy(),this._reorderGesture=null,this._visibleReorder=!1,setTimeout(function(){return e._enableReorder=!1},400)):n&&!this._reorderGesture&&(this._reorderGesture=new l(this._plt,this),this._enableReorder=!0,this._dom.write(function(){e._zone.run(function(){e._visibleReorder=!0})},16))},enumerable:!0,configurable:!0}),t.prototype._reorderPrepare=function(){for(var t=this._element,e=t.children,n=0,r=e.length;n<r;n++){var i=e[n];i.$ionIndex=n,i.$ionReorderList=t}},t.prototype._reorderStart=function(){this.setElementClass("reorder-list-active",!0)},t.prototype._reorderEmit=function(t,e){var n=this;this._reorderReset(),t!==e&&this._zone.run(function(){var r=new p(t,e);n.ionItemReorder.emit(r)})},t.prototype._scrollContent=function(t){var e=this._content.scrollTop+t;return 0!==t&&this._content.scrollTo(0,e,0),e},t.prototype._reorderReset=function(){var t=this._element.children,e=t.length;this.setElementClass("reorder-list-active",!1);for(var n=this._plt.Css.transform,r=0;r<e;r++)t[r].style[n]="";this._lastToIndex=-1},t.prototype._reorderMove=function(t,e,n){-1===this._lastToIndex&&(this._lastToIndex=t);var r=this._lastToIndex;this._lastToIndex=e;var i=this._element.children,o=this._plt.Css.transform;if(e>=r)for(var a=r;a<=e;a++)a!==t&&(i[a].style[o]=a>t?"translateY("+-n+"px)":"");if(e<=r)for(a=e;a<=r;a++)a!==t&&(i[a].style[o]=a<t?"translateY("+n+"px)":"")},t.prototype.setElementClass=function(t,e){this._rendered.setElementClass(this._element,t,e)},t.prototype.getNativeElement=function(){return this._element},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(1);var r=n(6),i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(t){function e(e,n,r,i,o,a,s){var l=t.call(this,e,n,r,"label")||this;return l.type=""===i?"floating":""===o?"stacked":""===a?"fixed":""===s?"inset":null,l}return i(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(t){this._id=t,t&&this.setElementAttribute("id",t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.getNativeElement().textContent||""},enumerable:!0,configurable:!0}),e}(r.a)},function(t,e,n){"use strict";var r=n(5).__extends,i=n(14),o=n(28),a=n(37),s=n(218),l=n(219),u=n(79),c=function(t){function e(e){t.call(this,e),this.destination=e}return r(e,t),e}(o.Subscriber);e.SubjectSubscriber=c;var h=function(t){function e(){t.call(this),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}return r(e,t),e.prototype[u.rxSubscriber]=function(){return new c(this)},e.prototype.lift=function(t){var e=new p(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new s.ObjectUnsubscribedError;if(!this.isStopped)for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].next(t)},e.prototype.error=function(t){if(this.closed)throw new s.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new s.ObjectUnsubscribedError;this.isStopped=!0;for(var t=this.observers,e=t.length,n=t.slice(),r=0;r<e;r++)n[r].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new s.ObjectUnsubscribedError;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new s.ObjectUnsubscribedError;return this.hasError?(t.error(this.thrownError),a.Subscription.EMPTY):this.isStopped?(t.complete(),a.Subscription.EMPTY):(this.observers.push(t),new l.SubjectSubscription(this,t))},e.prototype.asObservable=function(){var t=new i.Observable;return t.source=this,t},e.create=function(t,e){return new p(t,e)},e}(i.Observable);e.Subject=h;var p=function(t){function e(e,n){t.call(this),this.destination=e,this.source=n}return r(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):a.Subscription.EMPTY},e}(h);e.AnonymousSubject=p},function(t,e,n){"use strict";n.d(e,"a",function(){return s}),n.d(e,"b",function(){return l});var r=n(0),i=(n(1),n(6)),o=(n(3),n(46)),a=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),s=new r.n("USERROOT"),l=function(t){function e(e,n,r,i,o,a,s){var l=t.call(this,o,r,i,"app-root")||this;return l._userCmp=e,l._cfr=n,l._plt=a,s._appRoot=l,l._stopScrollPlugin=window.IonicStopScroll,l}return a(e,t),e.prototype.ngOnInit=function(){var t=this,e=this._cfr.resolveComponentFactory(this._userCmp),n=this._viewport.createComponent(e);this._renderer.setElementClass(n.location.nativeElement,"app-root",!0),n.changeDetectorRef.detectChanges(),this.setElementClass(this._config.get("mode"),!0);var r=this._plt.versions();this._plt.platforms().forEach(function(e){var n="platform-"+e;t.setElementClass(n,!0);var i=r[e];i&&(t.setElementClass(n+=i.major,!0),t.setElementClass(n+"_"+i.minor,!0))}),this._config.getBoolean("hoverCSS",!0)&&this.setElementClass("enable-hover",!0),this._plt.prepareReady()},e.prototype._getPortal=function(t){return t===o.b?this._loadingPortal:t===o.d?this._toastPortal:t===o.c?this._modalPortal:this._overlayPortal},e.prototype._getActivePortal=function(){var t=this._overlayPortal,e=this._modalPortal,n=e.length()>0,r=t.length()>0;if(!n&&!r)return null;if(n&&r){return t.getActive().getZIndex()>e.getActive().getZIndex()?t:e}return n?e:r?t:void 0},e.prototype._disableScroll=function(t){var e=this;if(t)this.stopScroll().then(function(){e._tmr=e._plt.timeout(function(){e.setElementClass("disable-scroll",!0)},32)});else{var n=this._stopScrollPlugin;n&&n.cancel&&n.cancel(),clearTimeout(this._tmr),this.setElementClass("disable-scroll",!1)}},e.prototype.stopScroll=function(){var t=this;return this._stopScrollPlugin?new Promise(function(e){t._stopScrollPlugin.stop(function(){return e(!0)})}):Promise.resolve(!1)},e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"c",function(){return i}),n.d(e,"b",function(){return o}),n.d(e,"d",function(){return a});var r=1,i=2,o=3,a=4},function(t,e,n){"use strict";function r(t,e){return t.segmentPartsLen>e.segmentPartsLen?-1:t.segmentPartsLen<e.segmentPartsLen?1:t.staticLen>e.staticLen?-1:t.staticLen<e.staticLen?1:t.dataLen<e.dataLen?-1:t.dataLen>e.dataLen?1:0}function i(t,e,n){return function(t,e){for(var n=[],r=0;r<e.length;r++)for(var i=function(t,e){if(t.navId){var n=e.getNavByIdOrName(t.navId);return n?[n]:[]}return e.getRootNavs()}(e[r].navGroup,t),a=0,s=e[r].segments;a<s.length;a++){var l=s[a];if(1===i.length)n.push(o(l,i[0])),i=i[0].getActiveChildNavs();else{if(!(i.length>1))break;n.push(o(l,i[i.length-1])),i=i[i.length-1].getActiveChildNavs()}}return n}(t,function(t,e){return function(t,e){for(var n=[],r=new Set,i=0,o=t;i<o.length;i++){for(var a=o[i],s=[],l=a.segmentPieces.concat([]),h=l.length;h>=0;h--){for(var p=!1,d=0;d<h;d++){for(var f=h-d-1,m=h,v=l.slice(f,m),g=0,y=e;g<y.length;g++){var b=y[g];if(!r.has(b.name)){var _=function(t,e){if(e.segmentPartsLen!==t.length)return null;for(var n=0;n<t.length;n++)if(!u(t[n],e.segmentParts[n]))return null;return{id:t.join("/"),name:e.name,component:e.component,loadChildren:e.loadChildren,data:c(t,e),defaultHistory:e.defaultHistory}}(v,b);if(_){h=f+1,r.add(b.name),p=!0,s.push(_);for(var x=f;x<m;x++)l[x]=null;break}}}if(p)break}!p&&l[h-1]&&s.push({id:null,name:null,secondaryId:l[h-1],component:null,loadChildren:null,data:null,defaultHistory:null})}for(var w=s.reverse(),h=0;h<w.length;h++)w[h].secondaryId&&!w[h].id&&h+1<=w.length-1&&(w[h+1].secondaryId=w[h].secondaryId,w[h]=null);var S=s.filter(function(t){return!!t});a.secondaryId&&s.length&&(S[0].secondaryId=a.secondaryId),n.push({navGroup:a,segments:S})}return n}(function(t){return t.map(function(t){var e=t.split("/");return"nav"===e[0]?{type:"nav",navId:e[1],niceId:e[1],secondaryId:null,segmentPieces:e.splice(2)}:"tabs"===e[0]?{type:"tabs",navId:e[1],niceId:e[1],secondaryId:e[2],segmentPieces:e.splice(3)}:{type:null,navId:null,niceId:null,secondaryId:null,segmentPieces:e}})}(function(t){for(var e=t.split("/"),n=[],r=0;r<e.length;r++)0===r||"nav"!==e[r]&&"tabs"!==e[r]||n.push(r);n.push(e.length);var i=[],o=0,a=[];for(r=0;r<e.length;r++)r>=n[o]&&(i.push(a.join("/")),a=[],o++),a.push(e[r]);return i.push(a.join("/")),i}(t)),e)}(e,n))}function o(t,e){var n=Object.assign({},t);return n.type=e.getType(),n.navId=e.name||e.id,n.secondaryId=t.secondaryId,n}n.d(e,"b",function(){return l}),e.c=function(t){for(t=(t=t.replace(d,"-")).charAt(0).toLowerCase()+t.substring(1).replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()});t.indexOf("--")>-1;)t=t.replace("--","-");return"-"===t.charAt(0)&&(t=t.substring(1)),"-"===t.substring(t.length-1)&&(t=t.substring(0,t.length-1)),encodeURIComponent(t)},n.d(e,"a",function(){return f}),e.d=function(t,e){return new l(t,e)};var a=n(0),s=n(2),l=function(){function t(t,e){this._app=t,this.links=e&&Object(s.e)(e.links)?p(e.links):[]}return t.prototype.parse=function(t){return"/"===t.charAt(0)&&(t=t.substr(1)),t=t.split("?")[0].split("#")[0],i(this._app,t,this.links)},t.prototype.createSegmentFromName=function(t,e){var n=this.getLinkFromName(e);return n?this._createSegment(this._app,t,n,null):null},t.prototype.getLinkFromName=function(t){return this.links.find(function(e){return e.component===t||e.name===t})},t.prototype.serialize=function(t){if(!t||!t.length)return"/";return t.map(function(t){return"tabs"===t.type?t.requiresExplicitNavPrefix?"/"+t.type+"/"+t.navId+"/"+t.secondaryId+"/"+t.id:"/"+t.secondaryId+"/"+t.id:t.requiresExplicitNavPrefix?"/"+t.type+"/"+t.navId+"/"+t.id:"/"+t.id}).join("")},t.prototype.serializeComponent=function(t,e,n){if(e){var r=h(this.links,e,n);if(r)return this._createSegment(this._app,t,r,n)}return null},t.prototype._createSegment=function(t,e,n,r){var i=n.segmentParts;if(Object(s.l)(r)){i=i.slice();var o=Object.keys(r),a=o.length;if(a)for(var l=0;l<i.length;l++)if(":"===i[l].charAt(0))for(var u=0;u<a;u++)if(i[l]===":"+o[u]){i[l]=encodeURIComponent(r[o[u]]);break}}var c=!0;return c=e.parent?e.parent&&e.parent.getAllChildNavs().length>1:t.getRootNavById(e.id)&&t.getRootNavs().length>1,{id:i.join("/"),name:n.name,component:n.component,loadChildren:n.loadChildren,data:r,defaultHistory:n.defaultHistory,navId:e.name||e.id,type:e.getType(),secondaryId:e.getSecondaryIdentifier(),requiresExplicitNavPrefix:c}},t}(),u=function(t,e){return!(!Object(s.l)(t)||!Object(s.l)(e))&&(":"===e.charAt(0)||t===e)},c=function(t,e){for(var n=null,r=0;r<e.segmentPartsLen;r++)":"===e.segmentParts[r].charAt(0)&&((n=n||{})[e.segmentParts[r].substring(1)]=decodeURIComponent(t[r]));return n},h=function(t,e,n){for(var r=null,i=-1,o=0;o<t.length;o++){var a=t[o];if(a.component===e){var l=0;if(n)for(var u=Object.keys(n),c=0;c<u.length;c++)Object(s.l)(a.dataKeys[u[c]])&&l++;else if(a.dataLen)continue;l>=i&&(r=a,i=l)}}return r},p=function(t){for(var e=0,n=t.length;e<n;e++){var i=t[e];Object(s.f)(i.segment)&&(i.segment=i.name),i.dataKeys={},i.segmentParts=i.segment.split("/"),i.segmentPartsLen=i.segmentParts.length,i.staticLen=i.dataLen=0;for(var o=!0,a=0;a<i.segmentPartsLen;a++)":"===i.segmentParts[a].charAt(0)?(i.dataLen++,o=!1,i.dataKeys[i.segmentParts[a].substring(1)]=!0):o&&i.staticLen++}return t.sort(r)},d=/\s+|\?|\!|\$|\,|\.|\+|\"|\'|\*|\^|\||\/|\\|\[|\]|#|%|`|>|<|;|:|@|&|=/g,f=new a.n("USERLINKS")},function(t,e,n){"use strict";var r=n(0),i=n(2),o=(n(1),n(9),n(25),"picker-opt-selected"),a=(n(3),n(11)),s=n(30);n.d(e,"a",function(){return l});var l=function(){function t(t,e,n,i,o,a,l){this._plt=e,this.elementRef=n,this._zone=i,this._haptic=o,this.y=0,this.pos=[],this.startY=null,this.ionChange=new r.l,this.events=new s.a(a),this.rotateFactor=t.getNumber("pickerRotateFactor",0),this.scaleFactor=t.getNumber("pickerScaleFactor",1),this.decelerateFunc=this.decelerate.bind(this),this.debouncer=l.debouncer()}return t.prototype.ngAfterViewInit=function(){var t=this.colEle.nativeElement;this.colHeight=t.clientHeight,this.optHeight=t.firstElementChild?t.firstElementChild.clientHeight:0,this.events.pointerEvents({element:this.elementRef.nativeElement,pointerDown:this.pointerStart.bind(this),pointerMove:this.pointerMove.bind(this),pointerUp:this.pointerEnd.bind(this),capture:!0,zone:!1})},t.prototype.ngOnDestroy=function(){this._plt.cancelRaf(this.rafId),this.events.destroy()},t.prototype.pointerStart=function(t){this._haptic.gestureSelectionStart(),t.preventDefault(),this._plt.cancelRaf(this.rafId),this.startY=Object(a.f)(t).y,this.velocity=0,this.pos.length=0,this.pos.push(this.startY,Date.now());for(var e=this.col.options,n=e.length-1,r=0,i=0;i<e.length;i++)e[i].disabled||(n=Math.min(n,i),r=Math.max(r,i));return this.minY=n*this.optHeight*-1,this.maxY=r*this.optHeight*-1,!0},t.prototype.pointerMove=function(t){var e=this;t.preventDefault(),t.stopPropagation();var n=Object(a.f)(t).y;this.pos.push(n,Date.now()),this.debouncer.write(function(){if(null!==e.startY){var t=e.y+(n-e.startY);t>e.minY?(t=Math.pow(t,.8),e.bounceFrom=t):t<e.maxY?(t+=Math.pow(e.maxY-t,.9),e.bounceFrom=t):e.bounceFrom=0,e.update(t,0,!1,!1);var r=Math.max(Math.abs(Math.round(t/e.optHeight)),0);r!==e.lastTempIndex&&(e._haptic.gestureSelectionChanged(),e.lastTempIndex=r)}})},t.prototype.pointerEnd=function(t){if(t.preventDefault(),this.debouncer.cancel(),null!==this.startY)if(this.velocity=0,this.bounceFrom>0)this.update(this.minY,100,!0,!0);else if(this.bounceFrom<0)this.update(this.maxY,100,!0,!0);else{var e=Object(a.f)(t).y;this.pos.push(e,Date.now());for(var n=this.pos.length-1,r=n,o=Date.now()-100,s=n;s>0&&this.pos[s]>o;s-=2)r=s;if(r!==n){var l=(this.pos[r-1]-this.pos[n-1])/(this.pos[n]-this.pos[r])*(1e3/60);this.velocity=Object(i.a)(-60,l,60)}if(Math.abs(e-this.startY)>3){this.update(this.y+(e-this.startY),0,!0,!0)}this.startY=null,this.decelerate()}},t.prototype.decelerate=function(){var t=0;if(isNaN(this.y)||!this.optHeight)this.update(t,0,!0,!0),this._haptic.gestureSelectionEnd();else if(Math.abs(this.velocity)>0){this.velocity*=.97,this.velocity=this.velocity>0?Math.max(this.velocity,1):Math.min(this.velocity,-1),(t=Math.round(this.y-this.velocity))>this.minY?(t=this.minY,this.velocity=0):t<this.maxY&&(t=this.maxY,this.velocity=0);var e=t%this.optHeight!=0||Math.abs(this.velocity)>1;this.update(t,0,!0,!e),e&&(this.rafId=this._plt.raf(this.decelerateFunc))}else if(this.y%this.optHeight!=0){var n=Math.abs(this.y%this.optHeight);this.velocity=n>this.optHeight/2?1:-1,this._haptic.gestureSelectionEnd(),this.decelerate()}var r=Math.max(Math.abs(Math.round(t/this.optHeight)),0);r!==this.lastTempIndex&&this._haptic.gestureSelectionChanged(),this.lastTempIndex=r},t.prototype.optClick=function(t,e){this.velocity||(t.preventDefault(),t.stopPropagation(),this.setSelected(e,150))},t.prototype.setSelected=function(t,e){var n=t>-1?t*this.optHeight*-1:0;this._plt.cancelRaf(this.rafId),this.velocity=0,this.update(n,e,!0,!0)},t.prototype.update=function(t,e,n,r){t=Math.round(t);var i,a,s,l,u,c,h,p,d,f,m=this.colEle.nativeElement.children,v=m.length,g=this.col.selectedIndex=Math.min(Math.max(Math.round(-t/this.optHeight),0),v-1),y=0===e?null:e+"ms",b="scale("+this.scaleFactor+")";for(i=0;i<v;i++)a=m[i],s=this.col.options[i],l=i*this.optHeight+t,u=!0,d="",0!==this.rotateFactor?(p=l*this.rotateFactor,Math.abs(p)>90?u=!1:(0,c=0,h=90,d="rotateX("+p+"deg) ")):(0,h=0,c=l,Math.abs(c)>170&&(u=!1)),f=g===i,u?(d+="translate3d(0px,"+c+"px,"+h+"px) ",1===this.scaleFactor||f||(d+=b)):d="translate3d(-9999px,0px,0px)",e!==s._dur&&(s._dur=e,a.style[this._plt.Css.transitionDuration]=y),d!==s._trans&&(s._trans=d,a.style[this._plt.Css.transform]=d),f!==s._selected&&(s._selected=f,f?a.classList.add(o):a.classList.remove(o));if(this.col.prevSelected=g,n&&(this.y=t),r)if(void 0===this.lastIndex)this.lastIndex=this.col.selectedIndex;else if(this.lastIndex!==this.col.selectedIndex){this.lastIndex=this.col.selectedIndex;var _=this.ionChange;_.observers.length>0&&this._zone.run(_.emit.bind(_,this.col.options[this.col.selectedIndex]))}},t.prototype.refresh=function(){for(var t=this.col.options.length-1,e=0,n=this.col.options,r=0;r<n.length;r++)n[r].disabled||(t=Math.min(t,r),e=Math.max(e,r));var o=Object(i.a)(t,this.col.selectedIndex,e);if(this.col.prevSelected!==o){var a=o*this.optHeight*-1;this._plt.cancelRaf(this.rafId),this.velocity=0,this.update(a,150,!0,!1)}},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(1),n(12),n(9),n(7),n(19);var r=n(56),i=(n(3),n(31),n(4),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),o=function(t){function e(e,n,r,i,o,a,s,l,u,c,h,p,d,f){var m=t.call(this,n,r,i,o,a,s,l,u,c,h,p,d,f)||this;return m._hasInit=!1,e&&e._setContent(m),n?n.registerChildNav(m):e&&e.getNav()?(m.parent=e.getNav(),m.parent.registerChildNav(m)):r&&!r.getRootNavById(m.id)&&r.registerRootNav(m),m}return i(e,t),Object.defineProperty(e.prototype,"_vp",{set:function(t){this.setViewport(t)},enumerable:!0,configurable:!0}),e.prototype.ngAfterViewInit=function(){var t=this;this._hasInit=!0;var e=this._linker.getSegmentByNavIdOrName(this.id,this.name);if(e&&(e.component||e.loadChildren))return this._linker.initViews(e).then(function(e){return t.setPages(e,null,null)});if(this._root){var n=!e;return this.push(this._root,this.rootParams,{isNavRoot:this._app.getRootNavById(this.id)===this,updateUrl:n},null)}},Object.defineProperty(e.prototype,"root",{get:function(){return this._root},set:function(t){this._root=t,this._hasInit&&this.setRoot(t)},enumerable:!0,configurable:!0}),e.prototype.ngOnDestroy=function(){this.destroy()},e.prototype.initPane=function(){return this._elementRef.nativeElement.hasAttribute("main")},e.prototype.paneChanged=function(t){t&&this.resize()},e.prototype.goToRoot=function(t){return this.setRoot(this._root,this.rootParams,t,null)},e.prototype.getType=function(){return"nav"},e.prototype.getSecondaryIdentifier=function(){return null},e}(r.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(0),i=(n(76),n(2)),o=function(){function t(t,e,n){this._renderer=t,this._elementRef=e,this._cd=n,this._disabled=!1,this._btns=[],this._ids=-1,this._init=!1,this.ionChange=new r.l,this.id=++a}return Object.defineProperty(t.prototype,"disabled",{get:function(){return this._disabled},set:function(t){this._disabled=Object(i.o)(t)},enumerable:!0,configurable:!0}),t.prototype.ngAfterContentInit=function(){var t=this._btns.find(function(t){return t.checked});t&&this._setActive(t)},t.prototype.writeValue=function(t){this.value=t,this._init&&(this._update(),this.onTouched(),this.ionChange.emit(t)),this._init=!0},t.prototype.registerOnChange=function(t){var e=this;this._fn=t,this.onChange=function(n){t(n),e.value=n,e._update(),e.onTouched(),e.ionChange.emit(n)}},t.prototype.registerOnTouched=function(t){this.onTouched=t},t.prototype._update=function(){var t=this,e=!1;this._btns.forEach(function(n){n.checked=Object(i.g)(t.value,n.value)&&!e,n.checked&&(t._setActive(n),e=!0)})},t.prototype._setActive=function(t){this._renderer.setElementAttribute(this._elementRef.nativeElement,"aria-activedescendant",t.id)},t.prototype.add=function(t){var e=this;return this._btns.push(t),t.ionSelect.subscribe(function(t){e.onChange(t)}),this.id+"-"+ ++this._ids},t.prototype.remove=function(t){var e=this._btns.indexOf(t);e>-1&&(t.value===this.value&&(this.value=null),this._btns.splice(e,1))},Object.defineProperty(t.prototype,"_header",{set:function(t){t&&(t.id||(t.id="rg-hdr-"+this.id),this._renderer.setElementAttribute(this._elementRef.nativeElement,"aria-describedby",t.id))},enumerable:!0,configurable:!0}),t.prototype.onChange=function(t){this.value=t,this._update(),this.onTouched(),this.ionChange.emit(t),this._cd.detectChanges()},t.prototype.onTouched=function(){},t.prototype.setDisabledState=function(t){this.disabled=t},t}(),a=-1},function(t,e,n){"use strict";function r(t){return function(t){return t}}function i(t,e,n){return setTimeout(l(t,n),e)}function o(t,e,n){return!!Array.isArray(t)&&(a(t,n[e],n),!0)}function a(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(void 0!==t.length)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function s(t,e,n){var r,i=e.prototype;(r=t.prototype=Object.create(i)).constructor=t,r._super=i,n&&Object.assign(r,n)}function l(t,e){return function(){return t.apply(e,arguments)}}function u(t,e){return typeof t==Le?t.apply(e?e[0]||void 0:void 0,e):t}function c(t,e){return void 0===t?e:t}function h(t,e,n){a(m(e),function(e){t.addEventListener(e,n,!1)})}function p(t,e,n){a(m(e),function(e){t.removeEventListener(e,n,!1)})}function d(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function f(t,e){return t.indexOf(e)>-1}function m(t){return t.trim().split(/\s+/g)}function v(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function g(t){return Array.prototype.slice.call(t,0)}function y(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var a=e?t[o][e]:t[o];v(i,a)<0&&r.push(t[o]),i[o]=a,o++}return n&&(r=e?r.sort(function(t,n){return t[e]>n[e]?1:0}):r.sort()),r}function b(t,e){for(var n,r,i=e[0].toUpperCase()+e.slice(1),o=0;o<Oe.length;){if(n=Oe[o],(r=n?n+i:e)in t)return r;o++}}function _(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||window}function x(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){u(t.options.enable,[t])&&n.handler(e)},this.init()}function w(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,o=e&ze&&r-i==0,a=e&(Ge|He)&&r-i==0;n.isFirst=!!o,n.isFinal=!!a,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=S(e));i>1&&!n.firstMultiple?n.firstMultiple=S(e):1===i&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,s=a?a.center:o.center,l=e.center=A(r);e.timeStamp=Fe(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=E(s,l),e.distance=C(s,l),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};e.eventType!==ze&&o.eventType!==Ge||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y});e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=T(e.deltaX,e.deltaY);var u=M(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=u.x,e.overallVelocityY=u.y,e.overallVelocity=De(u.x)>De(u.y)?u.x:u.y,e.scale=a?function(t,e){return C(e[0],e[1],tn)/C(t[0],t[1],tn)}(a.pointers,r):1,e.rotation=a?function(t,e){return E(e[1],e[0],tn)+E(t[1],t[0],tn)}(a.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,r,i,o,a=t.lastInterval||e,s=e.timeStamp-a.timeStamp;if(e.eventType!=He&&(s>Be||void 0===a.velocity)){var l=e.deltaX-a.deltaX,u=e.deltaY-a.deltaY,c=M(s,l,u);r=c.x,i=c.y,n=De(c.x)>De(c.y)?c.x:c.y,o=T(l,u),t.lastInterval=e}else n=a.velocity,r=a.velocityX,i=a.velocityY,o=a.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=o}(n,e);var c=t.element;d(e.srcEvent.target,c)&&(c=e.srcEvent.target);e.target=c}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function S(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:Ie(t.pointers[n].clientX),clientY:Ie(t.pointers[n].clientY)},n++;return{timeStamp:Fe(),pointers:e,center:A(e),deltaX:t.deltaX,deltaY:t.deltaY}}function A(t){var e=t.length;if(1===e)return{x:Ie(t[0].clientX),y:Ie(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:Ie(n/e),y:Ie(r/e)}}function M(t,e,n){return{x:e/t||0,y:n/t||0}}function T(t,e){return t===e?We:De(t)>=De(e)?t<0?Xe:Ye:e<0?qe:Ze}function C(t,e,n){n||(n=$e);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function E(t,e,n){n||(n=$e);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}function P(t,e){this.evEl=nn,this.evWin=rn,this.allow=!0,this.pressed=!1,x.apply(this,arguments)}function O(){this.evEl=sn,this.evWin=ln,x.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function N(){this.evTarget=cn,this.evWin=hn,this.started=!1,x.apply(this,arguments)}function L(t,e){this.evTarget=dn,this.targetIds={},x.apply(this,arguments)}function I(){x.apply(this,arguments);var t=l(this.handler,this);this.touch=new L(this.manager,t),this.mouse=new P(this.manager,t)}function D(t,e){this.manager=t,this.set(e)}function F(t){this.options=Object.assign({},this.defaults,t||{}),this.id=Re++,this.manager=null,this.options.enable=c(this.options.enable,!0),this.state=xn,this.simultaneous={},this.requireFail=[]}function R(t){return t&Tn?"cancel":t&An?"end":t&Sn?"move":t&wn?"start":""}function k(t){return t==Ze?"down":t==qe?"up":t==Xe?"left":t==Ye?"right":""}function U(t,e){var n=e.manager;return n?n.get(t):t}function j(){F.apply(this,arguments)}function B(){j.apply(this,arguments),this.pX=null,this.pY=null}function z(){j.apply(this,arguments)}function V(){F.apply(this,arguments),this._timer=null,this._input=null}function G(){j.apply(this,arguments)}function H(){j.apply(this,arguments)}function W(){F.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function X(t,e){return e=e||{},e.recognizers=c(e.recognizers,Cn.preset),new Y(t,e)}function Y(t,e){this.options=Object.assign({},Cn,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.element=t,this.input=function(t){var e=t.options.inputClass;return new(e||(Ue?O:je?L:ke?I:P))(t,w)}(this),this.touchAction=new D(this,this.options.touchAction),q(this,!0),a(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function q(t,e){var n=t.element;n.style&&a(t.options.cssProps,function(t,r){n.style[b(n.style,r)]=e?t:""})}var Z=n(45),Q=n(26),J=n(84),K=n(69),$=n(58),tt=n(85),et=n(70),nt=n(59),rt=n(8),it=(n(145),n(23)),ot=(n(146),n(20)),at=n(122),st=n(123),lt=n(124),ut=(n(147),n(148),n(153),n(21)),ct=(n(154),n(53)),ht=n(113),pt=n(75),dt=n(125),ft=n(126),mt=n(127),vt=n(6),gt=n(40),yt=(n(156),n(86),n(157),n(114)),bt=n(18),_t=n(71),xt=(n(159),n(128)),wt=(n(87),n(42)),St=(n(160),n(62)),At=n(43),Mt=n(54),Tt=n(76),Ct=n(161),Et=n(88),Pt=n(63),Ot=(n(162),n(163),n(129)),Nt=n(15),Lt=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),It=function(){function t(t){this.ani=new Nt.a(t),this.ani.easing("cubic-bezier(0.0, 0.0, 0.2, 1)").easingReverse("cubic-bezier(0.4, 0.0, 0.6, 1)").duration(280)}return t.prototype.setOpen=function(t,e,n){var r=this.ani.onFinish(n,!0,!0).reverse(!t);e?r.play():r.syncPlay()},t.prototype.setProgressStart=function(t){this.isOpening=!t,this.ani.reverse(t).progressStart()},t.prototype.setProgessStep=function(t){this.ani.progressStep(t)},t.prototype.setProgressEnd=function(t,e,n,r){var i=this,o=this.isOpening&&t;this.isOpening||t||(o=!0);var a=this.ani;a.onFinish(function(){i.isOpening=!1,r(o)},!0);var s=1-Math.min(Math.abs(n)/4,.7),l=a.getDuration()*s;a.progressEnd(t,e,l)},t.prototype.destroy=function(){this.ani.destroy(),this.ani=null},t}();Q.a.registerType("reveal",function(t){function e(e,n){var r=t.call(this,n)||this,i=e.width()*(e.isRightSide?-1:1)+"px",o=new Nt.a(n,e.getContentElement());return o.fromTo("translateX","0px",i),r.ani.add(o),r}return Lt(e,t),e}(It));Q.a.registerType("push",function(t){function e(e,n){var r,i,o,a=t.call(this,n)||this,s=e.width();e.isRightSide?(r=-s+"px",i=s+"px",o="0px"):(r=s+"px",o="0px",i=-s+"px");var l=new Nt.a(n,e.getMenuElement());l.fromTo("translateX",i,o),a.ani.add(l);var u=new Nt.a(n,e.getContentElement());return u.fromTo("translateX","0px",r),a.ani.add(u),a}return Lt(e,t),e}(It));Q.a.registerType("overlay",function(t){function e(e,n){var r,i,o=t.call(this,n)||this,a=e.width();e.isRightSide?(r=8+a+"px",i="0px"):(r=-(8+a)+"px",i="0px");var s=new Nt.a(n,e.getMenuElement());s.fromTo("translateX",r,i),o.ani.add(s);var l=new Nt.a(n,e.getBackdropElement());return l.fromTo("opacity",.01,.35),o.ani.add(l),o}return Lt(e,t),e}(It));var Dt=n(165),Ft=n(64),Rt=n(72),kt=n(49),Ut=(n(96),n(172),n(97),n(173),n(174),n(77)),jt=n(155),Bt=n(61),zt=n(48),Vt=n(60),Gt=n(99),Ht=n(65),Wt=n(98),Xt=n(66),Yt=n(50),qt=n(115),Zt=n(116),Qt=(n(100),n(175),n(176),n(117)),Jt=n(130),Kt=n(74),$t=n(118),te=n(67),ee=(n(177),n(101)),ne=(n(178),n(179),n(102),n(55)),re=n(35),ie=(n(180),n(181),n(104),n(103),n(170)),oe=n(68),ae=n(73),se=n(119),le=n(132),ue=n(120),ce=n(52),he=n(121),pe=n(110),de=n(41),fe=n(131),me=(n(182),n(105),n(106),n(107),n(183),n(1)),ve=n(9),ge=n(3),ye=n(25),be=n(12),_e=n(19),xe=n(56),we=n(10),Se=(n(29),n(94)),Ae=n(47),Me=n(4),Te=n(57),Ce=n(2),Ee=window,Pe=document,Oe=["","webkit","Moz","MS","ms","o"],Ne=Pe.createElement("div"),Le="function",Ie=Math.round,De=Math.abs,Fe=Date.now,Re=1,ke="ontouchstart"in window,Ue=void 0!==b(window,"PointerEvent"),je=ke&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Be=25,ze=1,Ve=2,Ge=4,He=8,We=1,Xe=2,Ye=4,qe=8,Ze=16,Qe=Xe|Ye,Je=qe|Ze,Ke=Qe|Je,$e=["x","y"],tn=["clientX","clientY"];x.prototype={handler:function(){},init:function(){this.evEl&&h(this.element,this.evEl,this.domHandler),this.evTarget&&h(this.target,this.evTarget,this.domHandler),this.evWin&&h(_(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&p(this.element,this.evEl,this.domHandler),this.evTarget&&p(this.target,this.evTarget,this.domHandler),this.evWin&&p(_(this.element),this.evWin,this.domHandler)}};var en={mousedown:ze,mousemove:Ve,mouseup:Ge},nn="mousedown",rn="mousemove mouseup";s(P,x,{handler:function(t){var e=en[t.type];e&ze&&0===t.button&&(this.pressed=!0),e&Ve&&1!==t.which&&(e=Ge),this.pressed&&this.allow&&(e&Ge&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var on={pointerdown:ze,pointermove:Ve,pointerup:Ge,pointercancel:He,pointerout:He},an={2:"touch",3:"pen",4:"mouse",5:"kinect"},sn="pointerdown",ln="pointermove pointerup pointercancel";Ee.MSPointerEvent&&!Ee.PointerEvent&&(sn="MSPointerDown",ln="MSPointerMove MSPointerUp MSPointerCancel"),s(O,x,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=on[r],o=an[t.pointerType]||t.pointerType,a="touch"==o,s=v(e,t.pointerId,"pointerId");i&ze&&(0===t.button||a)?s<0&&(e.push(t),s=e.length-1):i&(Ge|He)&&(n=!0),s<0||(e[s]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(s,1))}});var un={touchstart:ze,touchmove:Ve,touchend:Ge,touchcancel:He},cn="touchstart",hn="touchstart touchmove touchend touchcancel";s(N,x,{handler:function(t){var e=un[t.type];if(e===ze&&(this.started=!0),this.started){var n=function(t,e){var n=g(t.touches),r=g(t.changedTouches);return e&(Ge|He)&&(n=y(n.concat(r),"identifier",!0)),[n,r]}.call(this,t,e);e&(Ge|He)&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}});var pn={touchstart:ze,touchmove:Ve,touchend:Ge,touchcancel:He},dn="touchstart touchmove touchend touchcancel";s(L,x,{handler:function(t){var e=pn[t.type],n=function(t,e){var n=g(t.touches),r=this.targetIds;if(e&(ze|Ve)&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,a=g(t.changedTouches),s=[],l=this.target;if(o=n.filter(function(t){return d(t.target,l)}),e===ze)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<a.length;)r[a[i].identifier]&&s.push(a[i]),e&(Ge|He)&&delete r[a[i].identifier],i++;return s.length?[y(o.concat(s),"identifier",!0),s]:void 0}.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}),s(I,x,{handler:function(t,e,n){var r="mouse"==n.pointerType;if("touch"==n.pointerType)this.mouse.allow=!1;else if(r&&!this.mouse.allow)return;e&(Ge|He)&&(this.mouse.allow=!0),this.callback(t,e,n)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var fn=b(Ne.style,"touchAction"),mn=void 0!==fn,vn="auto",gn="manipulation",yn="none",bn="pan-x",_n="pan-y";D.prototype={set:function(t){"compute"==t&&(t=this.compute()),mn&&this.manager.element.style&&(this.manager.element.style[fn]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return a(this.manager.recognizers,function(e){u(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),function(t){if(f(t,yn))return yn;var e=f(t,bn),n=f(t,_n);return e&&n?yn:e||n?e?bn:_n:f(t,gn)?gn:vn}(t.join(" "))},preventDefaults:function(t){if(!mn){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=f(r,yn),o=f(r,_n),a=f(r,bn);if(i){if(1===t.pointers.length&&t.distance<2&&t.deltaTime<250)return}if(!a||!o)return i||o&&n&Qe||a&&n&Je?this.preventSrc(e):void 0}}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var xn=1,wn=2,Sn=4,An=8,Mn=An,Tn=16;F.prototype={defaults:{},set:function(t){return Object.assign(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(o(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=U(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return o(t,"dropRecognizeWith",this)?this:(t=U(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(o(t,"requireFailure",this))return this;var e=this.requireFail;return t=U(t,this),-1===v(e,t)&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(o(t,"dropRequireFailure",this))return this;t=U(t,this);var e=v(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){n.manager.emit(e,t)}var n=this,r=this.state;r<An&&e(n.options.event+R(r)),e(n.options.event),t.additionalEvent&&e(t.additionalEvent),r>=An&&e(n.options.event+R(r))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(32|xn)))return!1;t++}return!0},recognize:function(t){var e=Object.assign({},t);if(!u(this.options.enable,[this,e]))return this.reset(),void(this.state=32);this.state&(Mn|Tn|32)&&(this.state=xn),this.state=this.process(e),this.state&(wn|Sn|An|Tn)&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},s(j,F,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=e&(wn|Sn),i=this.attrTest(t);return r&&(n&He||!i)?e|Tn:r||i?n&Ge?e|An:e&wn?e|Sn:wn:32}}),s(B,j,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ke},getTouchAction:function(){var t=this.options.direction,e=[];return t&Qe&&e.push(_n),t&Je&&e.push(bn),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,a=t.deltaY;return i&e.direction||(e.direction&Qe?(i=0===o?We:o<0?Xe:Ye,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===a?We:a<0?qe:Ze,n=a!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return j.prototype.attrTest.call(this,t)&&(this.state&wn||!(this.state&wn)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=k(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),s(z,j,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[yn]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&wn)},emit:function(t){if(1!==t.scale){t.additionalEvent=this.options.event+(t.scale<1?"in":"out")}this._super.emit.call(this,t)}}),s(V,F,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[vn]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,o=t.deltaTime>e.time;if(this._input=t,!r||!n||t.eventType&(Ge|He)&&!o)this.reset();else if(t.eventType&ze)this.reset(),this._timer=i(function(){this.state=Mn,this.tryEmit()},e.time,this);else if(t.eventType&Ge)return Mn;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===Mn&&(t&&t.eventType&Ge?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=Fe(),this.manager.emit(this.options.event,this._input)))}}),s(G,j,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[yn]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&wn)}}),s(H,j,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Qe|Je,pointers:1},getTouchAction:function(){return B.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&(Qe|Je)?e=t.overallVelocity:n&Qe?e=t.overallVelocityX:n&Je&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&De(e)>this.options.velocity&&t.eventType&Ge},emit:function(t){var e=k(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),s(W,F,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[gn]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,o=t.deltaTime<e.time;if(this.reset(),t.eventType&ze&&0===this.count)return this.failTimeout();if(r&&o&&n){if(t.eventType!=Ge)return this.failTimeout();var a=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||C(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,s&&a?this.count+=1:this.count=1,this._input=t;if(0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=i(function(){this.state=Mn,this.tryEmit()},e.interval,this),wn):Mn}return 32},failTimeout:function(){return this._timer=i(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Mn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});var Cn={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[G,{enable:!1}],[z,{enable:!1},["rotate"]],[H,{direction:Qe}],[B,{direction:Qe},["swipe"]],[W],[W,{event:"doubletap",taps:2},["tap"]],[V]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};Y.prototype={set:function(t){return Object.assign(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var n,r=this.recognizers,i=e.curRecognizer;(!i||i&&i.state&Mn)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&n.state&(wn|Sn|An)&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof F)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(o(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(o(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=v(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){var n=this.handlers;return a(m(t),function(t){n[t]=n[t]||[],n[t].push(e)}),this},off:function(t,e){var n=this.handlers;return a(m(t),function(t){e?n[t]&&n[t].splice(v(n[t],e),1):delete n[t]}),this},emit:function(t,e){this.options.domEvents&&function(t,e){var n=Pe.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&q(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},Object.assign(X,{INPUT_START:ze,INPUT_MOVE:Ve,INPUT_END:Ge,INPUT_CANCEL:He,STATE_POSSIBLE:xn,STATE_BEGAN:wn,STATE_CHANGED:Sn,STATE_ENDED:An,STATE_RECOGNIZED:Mn,STATE_CANCELLED:Tn,STATE_FAILED:32,DIRECTION_NONE:We,DIRECTION_LEFT:Xe,DIRECTION_RIGHT:Ye,DIRECTION_UP:qe,DIRECTION_DOWN:Ze,DIRECTION_HORIZONTAL:Qe,DIRECTION_VERTICAL:Je,DIRECTION_ALL:Ke,Manager:Y,Input:x,TouchAction:D,TouchInput:L,MouseInput:P,PointerEventInput:O,TouchMouseInput:I,SingleTouchInput:N,Recognizer:F,AttrRecognizer:j,Tap:W,Pan:B,Swipe:H,Pinch:z,Rotate:G,Press:V,on:h,off:p,each:a,inherit:s,bindFn:l,prefixed:b}),Ee.Hammer=X;var En=function(){function t(t,e){void 0===e&&(e={}),this._callbacks={},this.isListening=!1,Object(Ce.d)(e,{domEvents:!0}),this.element=t,this.direction=e.direction||"x",e.direction="x"===this.direction?Qe:Je,this._options=e}return t.prototype.options=function(t){Object.assign(this._options,t)},t.prototype.on=function(t,e){"pinch"!==t&&"rotate"!==t||this._hammer.get(t).set({enable:!0}),this._hammer.on(t,e),(this._callbacks[t]||(this._callbacks[t]=[])).push(e)},t.prototype.off=function(t,e){this._hammer.off(t,this._callbacks[t]?e:null)},t.prototype.listen=function(){this.isListening||(this._hammer=X(this.element,this._options)),this.isListening=!0},t.prototype.unlisten=function(){var t,e;if(this._hammer&&this.isListening){for(t in this._callbacks)for(e=0;e<this._callbacks[t].length;e++)this._hammer.off(t,this._callbacks[t]);this._hammer.destroy()}this._callbacks={},this._hammer=null,this.isListening=!1},t.prototype.destroy=function(){this.unlisten(),this.element=this._options=null},t}(),Pn=n(83),On=n(143),Nn=n(7),Ln=n(91),In=n(184),Dn=n(24),Fn=n(13),Rn=n(38),kn=n(34),Un=n(93),jn=n(95),Bn=n(92),zn=n(112);n.d(e,!1,function(){return Z.b}),n.d(e,!1,function(){return Q.a}),n.d(e,!1,function(){return J.a}),n.d(e,!1,function(){return K.a}),n.d(e,!1,function(){return $.a}),n.d(e,!1,function(){return tt.a}),n.d(e,!1,function(){return et.a}),n.d(e,!1,function(){return nt.a}),n.d(e,!1,function(){return rt.a}),n.d(e,!1,function(){}),n.d(e,!1,function(){return it.a}),n.d(e,!1,function(){}),n.d(e,!1,function(){return ot.a}),n.d(e,!1,function(){return at.a}),n.d(e,!1,function(){return st.a}),n.d(e,!1,function(){return lt.a}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){return ut.a}),n.d(e,!1,function(){}),n.d(e,!1,function(){return ct.a}),n.d(e,!1,function(){return ht.a}),n.d(e,!1,function(){return pt.a}),n.d(e,!1,function(){return dt.a}),n.d(e,!1,function(){return ft.a}),n.d(e,!1,function(){return mt.a}),n.d(e,!1,function(){return vt.a}),n.d(e,!1,function(){return gt.a}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){return yt.a}),n.d(e,!1,function(){return bt.a}),n.d(e,!1,function(){return _t.a}),n.d(e,!1,function(){}),n.d(e,!1,function(){return xt.a}),n.d(e,!1,function(){}),n.d(e,!1,function(){return wt.a}),n.d(e,!1,function(){}),n.d(e,!1,function(){return St.a}),n.d(e,!1,function(){return At.a}),n.d(e,!1,function(){return Mt.a}),n.d(e,!1,function(){return Tt.a}),n.d(e,!1,function(){return Ct.a}),n.d(e,!1,function(){return Et.a}),n.d(e,!1,function(){return Pt.a}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){return Ot.a}),n.d(e,!1,function(){return It}),n.d(e,!1,function(){return Dt.a}),n.d(e,!1,function(){return Ft.a}),n.d(e,!1,function(){return Rt.a}),n.d(e,!1,function(){return kt.a}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){return Ut.a}),n.d(e,!1,function(){return jt.a}),n.d(e,!1,function(){return Bt.a}),n.d(e,!1,function(){return zt.a}),n.d(e,!1,function(){return Vt.a}),n.d(e,!1,function(){return Gt.a}),n.d(e,!1,function(){return Ht.a}),n.d(e,!1,function(){return Wt.a}),n.d(e,!1,function(){return Xt.a}),n.d(e,!1,function(){return Yt.a}),n.d(e,!1,function(){return qt.a}),n.d(e,!1,function(){return Zt.a}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){return Qt.a}),n.d(e,!1,function(){return Jt.a}),n.d(e,!1,function(){return Kt.a}),n.d(e,!1,function(){return $t.a}),n.d(e,!1,function(){return te.a}),n.d(e,!1,function(){}),n.d(e,!1,function(){return ee.a}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){return ne.a}),n.d(e,!1,function(){}),n.d(e,!1,function(){return re.a}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){return ie.a}),n.d(e,!1,function(){return oe.a}),n.d(e,!1,function(){return ae.a}),n.d(e,!1,function(){return se.a}),n.d(e,!1,function(){return le.a}),n.d(e,!1,function(){return ue.a}),n.d(e,!1,function(){return ce.a}),n.d(e,!1,function(){return he.a}),n.d(e,!1,function(){return pe.a}),n.d(e,!1,function(){return de.a}),n.d(e,!1,function(){return fe.a}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){return me.a}),n.d(e,!1,function(){return me.c}),n.d(e,!1,function(){return me.b}),n.d(e,!1,function(){return ve.a}),n.d(e,!1,function(){return ge.a}),n.d(e,!1,function(){return ge.b}),n.d(e,!1,function(){return ye.a}),n.d(e,!1,function(){return be.a}),n.d(e,!1,function(){return r}),n.d(e,!1,function(){return _e.a}),n.d(e,!1,function(){return xe.a}),n.d(e,!1,function(){return we.a}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){return Se.a}),n.d(e,!1,function(){return Se.b}),n.d(e,!1,function(){}),n.d(e,!1,function(){return Ae.b}),n.d(e,!1,function(){return Ae.a}),n.d(e,!1,function(){return Me.a}),n.d(e,!1,function(){return Te.a}),n.d(e,!1,function(){return En}),n.d(e,!1,function(){return Pn.a}),n.d(e,!1,function(){return On.a}),n.d(e,!1,function(){return Nn.a}),n.d(e,!1,function(){return Nn.b}),n.d(e,!1,function(){return Nn.d}),n.d(e,!1,function(){return Nn.c}),n.d(e,!1,function(){return Nn.j}),n.d(e,!1,function(){return Nn.k}),n.d(e,!1,function(){return Nn.l}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){return Ln.a}),n.d(e,!1,function(){}),n.d(e,!1,function(){return Ln.b}),n.d(e,!1,function(){return In.a}),n.d(e,!1,function(){return Dn.a}),n.d(e,!1,function(){return Fn.a}),n.d(e,!1,function(){}),n.d(e,!1,function(){}),n.d(e,!1,function(){return Ce.r}),n.d(e,!1,function(){}),n.d(e,!1,function(){return Nt.a}),n.d(e,!1,function(){return Rn.a}),n.d(e,!1,function(){return kn.a}),n.d(e,!1,function(){return Un.a}),n.d(e,!1,function(){return jn.a}),n.d(e,!1,function(){return Bn.a}),n.d(e,!1,function(){return zn.a}),n.d(e,!1,function(){return zn.b}),n.d(e,!1,function(){return zn.c})},function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(1);var r=n(164),i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(t){function e(e,n,r){var i=t.call(this,e,n,r)||this;return i._sbPadding=e.getBoolean("statusbarPadding"),i}return i(e,t),e}(r.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(1);var r=n(6),i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(t){function e(e,n,r){return t.call(this,e,n,r,"fab")||this}return i(e,t),e.prototype.setActiveClose=function(t){this.setElementClass("fab-close-active",t)},e}(r.a)},function(t,e,n){"use strict";n(0),n(1),n(9);var r=n(7),i=n(6),o=n(2),a=n(57),s=n(11),l=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),u=function(t){function e(e,n,i,o){var a=t.call(this,e,n.getNativeElement(),{maxAngle:20,threshold:5,zone:!1,domController:o,gesture:i.createGesture({name:r.c,priority:r.h,disableScroll:!0})})||this;return a.list=n,a.preSelectedContainer=null,a.selectedContainer=null,a.openContainer=null,a}return l(e,t),e.prototype.canStart=function(t){if(this.selectedContainer)return!1;var e=function(t){var e=t.target.closest("ion-item-sliding");return e?e.$ionComponent:null}(t);if(!e)return this.closeOpened(),!1;e!==this.openContainer&&this.closeOpened();var n=Object(s.f)(t);return this.preSelectedContainer=e,this.firstCoordX=n.x,this.firstTimestamp=Date.now(),!0},e.prototype.onDragStart=function(t){t.preventDefault();var e=Object(s.f)(t);this.selectedContainer=this.openContainer=this.preSelectedContainer,this.selectedContainer.startSliding(e.x)},e.prototype.onDragMove=function(t){t.preventDefault(),this.selectedContainer.moveSliding(Object(s.f)(t).x)},e.prototype.onDragEnd=function(t){t.preventDefault();var e=Object(s.f)(t).x-this.firstCoordX,n=Date.now()-this.firstTimestamp;this.selectedContainer.endSliding(e/n),this.selectedContainer=null,this.preSelectedContainer=null},e.prototype.notCaptured=function(t){(function(t){return!!t.target.closest("ion-item-options>button")})(t)||this.closeOpened()},e.prototype.closeOpened=function(){return this.selectedContainer=null,!!this.openContainer&&(this.openContainer.close(),this.openContainer=null,!0)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.closeOpened(),this.list=null,this.preSelectedContainer=null,this.selectedContainer=null,this.openContainer=null},e}(a.a);n(3);n.d(e,"a",function(){return h});var c=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),h=function(t){function e(e,n,r,i,o,a){var s=t.call(this,e,n,r,"list")||this;return s._plt=i,s._gestureCtrl=o,s._domCtrl=a,s._enableSliding=!0,s._containsSlidingItems=!1,s}return c(e,t),Object.defineProperty(e.prototype,"sliding",{get:function(){return this._enableSliding},set:function(t){this._enableSliding=Object(o.o)(t),this._updateSlidingState()},enumerable:!0,configurable:!0}),e.prototype.containsSlidingItem=function(t){this._containsSlidingItems=t,this._updateSlidingState()},e.prototype._updateSlidingState=function(){this._enableSliding&&this._containsSlidingItems?this._slidingGesture||(this._slidingGesture=new u(this._plt,this,this._gestureCtrl,this._domCtrl),this._slidingGesture.listen()):(this._slidingGesture&&this._slidingGesture.destroy(),this._slidingGesture=null)},e.prototype.closeSlidingItems=function(){this._slidingGesture&&this._slidingGesture.closeOpened()},e.prototype.destroy=function(){this._slidingGesture&&this._slidingGesture.destroy()},e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return a});n(1);var r=n(6),i=n(2),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=function(t){function e(e,n,r){var i=t.call(this,e,n,r,"spinner")||this;return i._dur=null,i._paused=!1,i}return o(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t,this.load()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._dur},set:function(t){this._dur=t,this.load()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},set:function(t){this._paused=Object(i.o)(t)},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){this._init=!0,this.load()},e.prototype.load=function(){if(this._init){this._l=[],this._c=[];var t=this._name||this._config.get("spinner","ios"),e=s[t];if(e){if(e.lines)for(var n=0,r=e.lines;n<r;n++)this._l.push(this._loadEle(e,n,r));else if(e.circles)for(n=0,r=e.circles;n<r;n++)this._c.push(this._loadEle(e,n,r));this.setElementClass("spinner-"+t,!0),this.setElementClass("spinner-"+this._mode+"-"+t,!0)}}},e.prototype._loadEle=function(t,e,n){var r=this._dur||t.dur,i=t.fn(r,e,n);return i.style.animationDuration=r+"ms",i},e}(r.a),s={ios:{dur:1e3,lines:12,fn:function(t,e,n){var r="rotate("+(30*e+(e<6?180:-180))+"deg)",i=-(t-t/n*e)+"ms";return{y1:17,y2:29,style:{transform:r,webkitTransform:r,animationDelay:i,webkitAnimationDelay:i}}}},"ios-small":{dur:1e3,lines:12,fn:function(t,e,n){var r="rotate("+(30*e+(e<6?180:-180))+"deg)",i=-(t-t/n*e)+"ms";return{y1:12,y2:20,style:{transform:r,webkitTransform:r,animationDelay:i,webkitAnimationDelay:i}}}},bubbles:{dur:1e3,circles:9,fn:function(t,e,n){var r=-(t-t/n*e)+"ms";return{r:5,style:{top:9*Math.sin(2*Math.PI*e/n)+"px",left:9*Math.cos(2*Math.PI*e/n)+"px",animationDelay:r,webkitAnimationDelay:r}}}},circles:{dur:1e3,circles:8,fn:function(t,e,n){var r=-(t-t/n*e)+"ms";return{r:5,style:{top:9*Math.sin(2*Math.PI*e/n)+"px",left:9*Math.cos(2*Math.PI*e/n)+"px",animationDelay:r,webkitAnimationDelay:r}}}},crescent:{dur:750,circles:1,fn:function(){return{r:26,style:{}}}},dots:{dur:750,circles:3,fn:function(t,e){var n=-110*e+"ms";return{r:6,style:{left:9-9*e+"px",animationDelay:n,webkitAnimationDelay:n}}}}}},function(t,e,n){"use strict";var r=n(0),i=n(29),o=n(2),a=n(4),s=n(6),l=n(19),u=n(10),c=n(7),h=n(83),p=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),d=function(t){function e(e,n,r,i){var o=t.call(this,e,e.doc().body,{direction:"x",edge:"start",maxEdgeStart:75,threshold:5,zone:!1,domController:i,gesture:r.createGesture({name:c.b,priority:c.e,disableScroll:!0})})||this;return o._nav=n,o}return p(e,t),e.prototype.canStart=function(e){return this._nav.canSwipeBack()&&t.prototype.canStart.call(this,e)},e.prototype.onSlideBeforeStart=function(t){this._nav.swipeBackStart()},e.prototype.onSlide=function(t,e){e.preventDefault(),e.stopPropagation();this._nav.swipeBackProgress(t.distance/t.max)},e.prototype.onSlideEnd=function(t,e){var n=t.velocity,r=t.distance/t.max,i=n<0,a=Math.abs(t.velocity)>.4,s=Math.abs(t.delta)<.5*Math.abs(t.max),l=!Object(o.t)(i,a,s);this._nav.swipeBackEnd(l,r,n)},e}(h.a);n.d(e,"a",function(){return m});var f=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),m=function(t){function e(e,n,i,o,a,s,l,u,c,h,p,d,f){var m=t.call(this,i,a,l)||this;return m.parent=e,m._app=n,m.config=i,m.plt=o,m._zone=s,m._cfr=u,m._gestureCtrl=c,m._trnsCtrl=h,m._linker=p,m._domCtrl=d,m._errHandler=f,m._ids=-1,m._init=!1,m._queue=[],m._trnsId=null,m._trnsTm=!1,m._views=[],m._zIndexOffset=0,m.viewDidLoad=new r.l,m.viewWillEnter=new r.l,m.viewDidEnter=new r.l,m.viewWillLeave=new r.l,m.viewDidLeave=new r.l,m.viewWillUnload=new r.l,m._sbEnabled=i.getBoolean("swipeBackEnabled"),m._children=[],m.id="n"+ ++v,m._destroyed=!1,m}return f(e,t),Object.defineProperty(e.prototype,"swipeBackEnabled",{get:function(){return this._sbEnabled},set:function(t){this._sbEnabled=Object(o.o)(t),this._swipeBackCheck()},enumerable:!0,configurable:!0}),e.prototype.push=function(t,e,n,r){return this._queueTrns({insertStart:-1,insertViews:[{page:t,params:e}],opts:n},r)},e.prototype.insert=function(t,e,n,r,i){return this._queueTrns({insertStart:t,insertViews:[{page:e,params:n}],opts:r},i)},e.prototype.insertPages=function(t,e,n,r){return this._queueTrns({insertStart:t,insertViews:e,opts:n},r)},e.prototype.pop=function(t,e){return this._queueTrns({removeStart:-1,removeCount:1,opts:t},e)},e.prototype.popTo=function(t,e,n){var r={removeStart:-1,removeCount:-1,opts:e};return Object(a.b)(t)?(r.removeView=t,r.removeStart=1):Object(o.j)(t)&&(r.removeStart=t+1),this._queueTrns(r,n)},e.prototype.popToRoot=function(t,e){return this._queueTrns({removeStart:1,removeCount:-1,opts:t},e)},e.prototype.popAll=function(){for(var t=[],e=this._views.length-1;e>=0;e--)t.push(this.pop(null));return Promise.all(t)},e.prototype.remove=function(t,e,n,r){return void 0===e&&(e=1),this._queueTrns({removeStart:t,removeCount:e,opts:n},r)},e.prototype.removeView=function(t,e,n){return this._queueTrns({removeView:t,removeStart:0,removeCount:1,opts:e},n)},e.prototype.setRoot=function(t,e,n,r){return this.setPages([{page:t,params:e}],n,r)},e.prototype.setPages=function(t,e,n){return Object(o.f)(e)&&(e={}),!0!==e.animate&&(e.animate=!1),this._queueTrns({insertStart:0,insertViews:t,removeStart:0,removeCount:-1,opts:e},n)},e.prototype._queueTrns=function(t,e){var n=new Promise(function(e,n){t.resolve=e,t.reject=n});return t.done=e,t.insertViews&&0===t.insertViews.length&&(t.insertViews=void 0),this._queue.push(t),this._nextTrns(),n},e.prototype._success=function(t,e){null!==this._queue?(this._init=!0,this._trnsId=null,this.setTransitioning(!1),this._swipeBackCheck(),this._nextTrns(),e.done&&e.done(t.hasCompleted,t.requiresTransition,t.enteringName,t.leavingName,t.direction),e.resolve(t.hasCompleted)):this._fireError("nav controller was destroyed",e)},e.prototype._failed=function(t,e){null!==this._queue?(this._trnsId=null,this._queue.length=0,this.setTransitioning(!1),this._swipeBackCheck(),this._nextTrns(),this._fireError(t,e)):this._fireError("nav controller was destroyed",e)},e.prototype._fireError=function(t,e){e.done&&e.done(!1,!1,t),e.reject&&!this._destroyed?e.reject(t):e.resolve(!1)},e.prototype._nextTrns=function(){var t=this;if(this.isTransitioning())return!1;var e=this._queue.shift();if(!e)return!1;var n,r;return this._startTI(e).then(function(){return t._loadLazyLoading(e)}).then(function(){if(r=t.getActive(),n=t._getEnteringView(e,r),!r&&!n)throw"no views in the stack to be removed";n&&n._state===i.h&&t._viewInit(n),e.requiresTransition=(e.enteringRequiresTransition||e.leavingRequiresTransition)&&n!==r}).then(function(){return t._viewTest(n,r,e)}).then(function(){return t._postViewInit(n,r,e)}).then(function(){return t._transition(n,r,e)}).then(function(n){return t._success(n,e)}).catch(function(n){return t._failed(n,e)}),!0},e.prototype._startTI=function(t){var e=this._views.length;if(Object(o.l)(t.removeView)){var n=this.indexOf(t.removeView);if(n<0)return Promise.reject("removeView was not found");t.removeStart+=n}return Object(o.l)(t.removeStart)&&(t.removeStart<0&&(t.removeStart=e-1),t.removeCount<0&&(t.removeCount=e-t.removeStart),t.leavingRequiresTransition=t.removeCount>0&&t.removeStart+t.removeCount===e),t.insertViews&&((t.insertStart<0||t.insertStart>e)&&(t.insertStart=e),t.enteringRequiresTransition=t.insertStart===e),this.setTransitioning(!0),Promise.resolve()},e.prototype._loadLazyLoading=function(t){var e=this,n=t.insertViews;return n?Object(i.i)(this._linker,n).then(function(n){if(0===(n=n.filter(function(t){return null!==t})).length)throw"invalid views to insert";for(var r=0;r<n.length;r++){var o=n[r],a=o._nav;if(a&&a!==e)throw"inserted view was already inserted";if(o._state===i.f)throw"inserted view was already destroyed"}t.insertViews=n}):Promise.resolve()},e.prototype._getEnteringView=function(t,e){var n=t.insertViews;if(n)return n[n.length-1];var r=t.removeStart;if(Object(o.l)(r)){var i,a,s=this._views,l=r+t.removeCount;for(i=s.length-1;i>=0;i--)if(a=s[i],(i<r||i>=l)&&a!==e)return a}return null},e.prototype._postViewInit=function(t,e,n){var r,a,s,l=this,u=n.opts||{},c=n.insertViews,h=n.removeStart,p=n.removeCount;if(Object(o.l)(h)){for(s=[],a=0;a<p;a++)(r=this._views[a+h])&&r!==t&&r!==e&&s.push(r);u.direction=u.direction||i.a}if(0===this._views.length+(c?c.length:0)-(p||0)&&!this._isPortal)throw console.warn("You can't remove all the pages in the navigation stack. nav.pop() is probably called too many times.",this,this.getNativeElement()),"navigation stack needs at least one root page";if(c){for(Object(o.l)(u.id)&&(t.id=u.id),a=0;a<c.length;a++)this._insertViewAt(r=c[a],n.insertStart+a);n.enteringRequiresTransition&&(u.direction=u.direction||i.b)}if(s&&s.length>0)for(this._zone.run(function(){for(a=0;a<s.length;a++)l._willLeave(r=s[a],!0),l._didLeave(r),l._willUnload(r)}),a=0;a<s.length;a++)this._destroyView(s[a]);n.requiresTransition&&!u.animation&&(u.animation=Object(o.l)(n.removeStart)?(e||t).getTransitionName(u.direction):(t||e).getTransitionName(u.direction)),n.opts=u},e.prototype._viewInit=function(t){var e=r.y.resolve([{provide:l.a,useValue:this},{provide:a.a,useValue:t},{provide:u.a,useValue:t.getNavParams()}]),n=this._linker.resolveComponent(t.component),o=r.y.fromResolvedProviders(e,this._viewport.parentInjector);t.init(n.create(o,[])),t._state=i.g,this._preLoad(t)},e.prototype._viewAttachToDOM=function(t,e,n){if(this._willLoad(t),n.insert(e.hostView,n.length),t._state=i.e,t._cssClass){this._renderer.setElementClass(e.location.nativeElement,t._cssClass,!0)}e.changeDetectorRef.detectChanges(),this._zone.run(this._didLoad.bind(this,t))},e.prototype._viewTest=function(t,e,n){if(!n.requiresTransition)return Promise.resolve();var r=[];return e&&r.push(e._lifecycleTest("Leave")),t&&r.push(t._lifecycleTest("Enter")),0===r.length?Promise.resolve():Promise.all(r).then(function(t){if(t.some(function(t){return!1===t}))throw"canEnter/Leave returned false"}).catch(function(t){throw n.reject=null,t})},e.prototype._transition=function(t,e,n){var r=this;if(!n.requiresTransition)return Promise.resolve({hasCompleted:!0,requiresTransition:!1});var o=n.opts;this._trnsId=this._trnsCtrl.getRootTrnsId(this),null===this._trnsId&&(this._trnsId=this._trnsCtrl.nextId());var a=this._trnsCtrl.get(this._trnsId,t,e,{animation:o.animation,direction:o.direction,duration:!1===o.animate?0:o.duration,easing:o.easing,isRTL:this._config.plt.isRTL,ev:o.ev});this._sbTrns&&this._sbTrns.destroy(),this._sbTrns=null,a.isRoot()&&o.progressAnimation&&(this._sbTrns=a);var s=new Promise(function(t){return a.registerStart(t)}).then(function(){return r._transitionStart(a,t,e,o)});return t&&t._state===i.g&&this._viewAttachToDOM(t,t._cmp,this._viewport),a.hasChildren||a.start(),s},e.prototype._transitionStart=function(t,e,n,r){var o=this;this._trnsId=null,Object(i.n)(this,e,n,r.direction,this._renderer),e&&e._domShow(!0,this._renderer),n&&n._domShow(!0,this._renderer),t.init();var a=!this._init&&1===this._views.length&&!this._isPortal,s=!1===this._config.get("animate");(a||s)&&(r.animate=!1),!1===r.animate&&t.duration(0),t.beforeAddRead(this._viewsWillLifecycles.bind(this,e,n));var l=t.getDuration(),u=new Promise(function(e){t.onFinish(e)});return t.isRoot()&&(l>g&&!1!==r.disableApp&&this._app.setEnabled(!1,l+b,r.minClickBlockDuration),r.progressAnimation?t.progressStart():t.play()),u.then(function(){return o._zone.run(function(){return o._transitionFinish(t,r)})})},e.prototype._transitionFinish=function(t,e){var n,r,i=t.hasCompleted,o=t.enteringView,a=t.leavingView;return i?(o&&(n=o.name,this._didEnter(o)),a&&(r=a.name,this._didLeave(a)),this._cleanup(o)):this._cleanup(a),t.isRoot()&&(this._trnsCtrl.destroy(t.trnsId),this._app.setEnabled(!0),this.setTransitioning(!1),this.hasChildren()||!1===e.updateUrl||this._linker.navChange(e.direction),!1!==e.keyboardClose&&this.plt.focusOutActiveElement()),{hasCompleted:i,requiresTransition:!0,enteringName:n,leavingName:r,direction:e.direction}},e.prototype._viewsWillLifecycles=function(t,e){var n=this;(t||e)&&this._zone.run(function(){if(e){n._willLeave(e,!t||e.index>t.index)}t&&n._willEnter(t)})},e.prototype._insertViewAt=function(t,e){var n=this._views.indexOf(t);n>-1?this._views.splice(e,0,this._views.splice(n,1)[0]):(t._setNav(this),this._ids++,t.id||(t.id=this.id+"-"+this._ids),this._views.splice(e,0,t))},e.prototype._removeView=function(t){var e=this._views,n=e.indexOf(t);n>=0&&e.splice(n,1)},e.prototype._destroyView=function(t){t._destroy(this._renderer),this._removeView(t)},e.prototype._cleanup=function(t){if(!this._destroyed){var e=this._views.indexOf(t),n=this._views,r=!1,o=void 0,a=void 0;for(a=n.length-1;a>=0;a--)o=n[a],a>e?(this._willUnload(o),this._destroyView(o)):a<e&&!this._isPortal&&o._domShow(!1,this._renderer),o._zIndex<=0&&(r=!0);if(!this._isPortal&&r)for(a=0;a<n.length;a++)(o=n[a])._setZIndex(o._zIndex+i.d+1,this._renderer)}},e.prototype._preLoad=function(t){t._preLoad()},e.prototype._willLoad=function(t){try{t._willLoad()}catch(t){this._errHandler&&this._errHandler.handleError(t)}},e.prototype._didLoad=function(t){try{t._didLoad(),this.viewDidLoad.emit(t),this._app.viewDidLoad.emit(t)}catch(t){this._errHandler&&this._errHandler.handleError(t)}},e.prototype._willEnter=function(t){try{t._willEnter(),this.viewWillEnter.emit(t),this._app.viewWillEnter.emit(t)}catch(t){this._errHandler&&this._errHandler.handleError(t)}},e.prototype._didEnter=function(t){try{t._didEnter(),this.viewDidEnter.emit(t),this._app.viewDidEnter.emit(t)}catch(t){this._errHandler&&this._errHandler.handleError(t)}},e.prototype._willLeave=function(t,e){try{t._willLeave(e),this.viewWillLeave.emit(t),this._app.viewWillLeave.emit(t)}catch(t){this._errHandler&&this._errHandler.handleError(t)}},e.prototype._didLeave=function(t){try{t._didLeave(),this.viewDidLeave.emit(t),this._app.viewDidLeave.emit(t)}catch(t){this._errHandler&&this._errHandler.handleError(t)}},e.prototype._willUnload=function(t){try{t._willUnload(),this.viewWillUnload.emit(t),this._app.viewWillUnload.emit(t)}catch(t){this._errHandler&&this._errHandler.handleError(t)}},e.prototype.hasChildren=function(){return this._children&&this._children.length>0},e.prototype.getActiveChildNavs=function(){return this._children},e.prototype.getAllChildNavs=function(){return this._children},e.prototype.registerChildNav=function(t){this._children.push(t)},e.prototype.unregisterChildNav=function(t){this._children=this._children.filter(function(e){return e!==t})},e.prototype.destroy=function(){for(var t,e=this._views,n=0;n<e.length;n++)(t=e[n])._willUnload(),t._destroy(this._renderer);this._sbGesture&&this._sbGesture.destroy(),this._sbTrns&&this._sbTrns.destroy(),this._queue=this._views=this._sbGesture=this._sbTrns=null,this.parent&&this.parent.unregisterChildNav?this.parent.unregisterChildNav(this):this._app&&this._app.unregisterRootNav(this),this._destroyed=!0},e.prototype.swipeBackStart=function(){if(!(this.isTransitioning()||this._queue.length>0)){this._queueTrns({removeStart:-1,removeCount:1,opts:{direction:i.a,progressAnimation:!0}},null)}},e.prototype.swipeBackProgress=function(t){this._sbTrns&&this._sbGesture&&(this._app.setEnabled(!1,y),this.setTransitioning(!0),this._sbTrns.progressStep(t))},e.prototype.swipeBackEnd=function(t,e,n){if(this._sbTrns&&this._sbGesture){var r=this._sbTrns.getDuration()/(Math.abs(n)+1);this._sbTrns.progressEnd(t,e,r)}},e.prototype._swipeBackCheck=function(){this.canSwipeBack()?(this._sbGesture||(this._sbGesture=new d(this.plt,this,this._gestureCtrl,this._domCtrl)),this._sbGesture.listen()):this._sbGesture&&this._sbGesture.unlisten()},e.prototype.canSwipeBack=function(){return this._sbEnabled&&!this._isPortal&&!this._children.length&&!this.isTransitioning()&&this._app.isEnabled()&&this.canGoBack()},e.prototype.canGoBack=function(){var t=this.getActive();return!(!t||!t.enableBack())},e.prototype.isTransitioning=function(){return this._trnsTm},e.prototype.setTransitioning=function(t){this._trnsTm=t},e.prototype.getActive=function(){return this._views[this._views.length-1]},e.prototype.isActive=function(t){return t===this.getActive()},e.prototype.getByIndex=function(t){return this._views[t]},e.prototype.getPrevious=function(t){t||(t=this.getActive());var e=this._views,n=e.indexOf(t);return n>0?e[n-1]:null},e.prototype.first=function(){return this._views[0]},e.prototype.last=function(){var t=this._views;return t[t.length-1]},e.prototype.indexOf=function(t){return this._views.indexOf(t)},e.prototype.length=function(){return this._views.length},e.prototype.getViews=function(){return this._views},e.prototype.getViewById=function(t){for(var e=0,n=this._views;e<n.length;e++){var r=n[e];if(r&&r.id===t)return r}return null},e.prototype.isSwipeBackEnabled=function(){return this._sbEnabled},e.prototype.dismissPageChangeViews=function(){for(var t=0,e=this._views;t<e.length;t++){var n=e[t];n.data&&n.data.dismissOnPageChange&&n.dismiss().catch(function(){})}},e.prototype.setViewport=function(t){this._viewport=t},e.prototype.resize=function(){var t=this.getActive();if(t){var e=t.getIONContent();e&&e.resize()}},e.prototype.goToRoot=function(t){return Promise.reject(new Error("goToRoot needs to be implemented by child class"))},e.prototype.getType=function(){return"nav"},e.prototype.getSecondaryIdentifier=function(){return null},e.prototype.getActiveChildNav=function(){return console.warn("(getActiveChildNav) is deprecated and will be removed in the next major release. Use getActiveChildNavs instead."),this._children[this._children.length-1]},e}(s.a),v=-1,g=64,y=5e3,b=2e3},function(t,e,n){"use strict";var r=n(2),i=function(){function t(t,e,n){this.direction=t,this.dirty=!1,this._angle=0,this._isPan=0;var r=n*(Math.PI/180);this.maxCosine=Math.cos(r),this.threshold=e*e}return t.prototype.start=function(t){this.startCoord=t,this._angle=0,this._isPan=0,this.dirty=!0},t.prototype.detect=function(t){if(!this.dirty)return!1;var e=t.x-this.startCoord.x,n=t.y-this.startCoord.y;if(e*e+n*n>=this.threshold){var r=Math.atan2(n,e),i="y"===this.direction?Math.sin(r):Math.cos(r);return this._angle=r,this._isPan=i>this.maxCosine?1:i<-this.maxCosine?-1:0,this.dirty=!1,!0}return!1},t.prototype.angle=function(){return this._angle},t.prototype.pan=function(){return this._isPan},t}(),o=n(11),a=n(30);n.d(e,"a",function(){return s});var s=function(){function t(t,e,n){void 0===n&&(n={}),this.plt=t,this.element=e,Object(r.d)(n,{threshold:20,maxAngle:40,direction:"x",zone:!0,capture:!1,passive:!1}),this.events=new a.a(t),n.domController&&(this.debouncer=n.domController.debouncer()),this.gestute=n.gesture,this.direction=n.direction,this.eventsConfig={element:this.element,pointerDown:this.pointerDown.bind(this),pointerMove:this.pointerMove.bind(this),pointerUp:this.pointerUp.bind(this),zone:n.zone,capture:n.capture,passive:n.passive},n.threshold>0&&(this.detector=new i(n.direction,n.threshold,n.maxAngle))}return t.prototype.listen=function(){this.isListening||(this.pointerEvents=this.events.pointerEvents(this.eventsConfig),this.isListening=!0)},t.prototype.unlisten=function(){this.isListening&&(this.gestute&&this.gestute.release(),this.events.unlistenAll(),this.isListening=!1)},t.prototype.destroy=function(){this.gestute&&this.gestute.destroy(),this.gestute=null,this.unlisten(),this.events.destroy(),this.events=this.element=this.gestute=null},t.prototype.pointerDown=function(t){if(!this.started){if(!this.canStart(t))return!1;if(this.gestute&&(this.gestute.release(),!this.gestute.start()))return!1;this.started=!0,this.captured=!1;var e=Object(o.f)(t);if(this.detector)this.detector.start(e);else if(!this.tryToCapture(t))return this.started=!1,this.captured=!1,this.gestute.release(),!1;return!0}},t.prototype.pointerMove=function(t){var e=this;if(this.captured)this.debouncer.write(function(){e.onDragMove(t)});else{var n=Object(o.f)(t);this.detector.detect(n)&&0!==this.detector.pan()&&(this.tryToCapture(t)||this.abort(t))}},t.prototype.pointerUp=function(t){this.debouncer.cancel(),this.gestute&&this.gestute.release(),this.captured?this.onDragEnd(t):this.notCaptured(t),this.captured=!1,this.started=!1},t.prototype.tryToCapture=function(t){return!(this.gestute&&!this.gestute.capture())&&(this.onDragStart(t),this.captured=!0,!0)},t.prototype.abort=function(t){this.started=!1,this.captured=!1,this.gestute.release(),this.pointerEvents.stop(),this.notCaptured(t)},t.prototype.getNativeElement=function(){return this.element},t.prototype.canStart=function(t){return!0},t.prototype.onDragStart=function(t){},t.prototype.onDragMove=function(t){},t.prototype.onDragEnd=function(t){},t.prototype.notCaptured=function(t){},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(7),i=(n(1),n(22)),o=(n(10),n(4),function(){function t(t,e,n,i,o,s){this._viewCtrl=t,this._elementRef=n,this.gestureBlocker=i.createBlocker(r.a),this.d=o.data,this.mode=e.get("mode"),s.setElementClass(n.nativeElement,"action-sheet-"+this.mode,!0),this.d.cssClass&&this.d.cssClass.split(" ").forEach(function(t){""!==t.trim()&&s.setElementClass(n.nativeElement,t,!0)}),this.id=++a,this.d.title&&(this.hdrId="acst-hdr-"+this.id),this.d.subTitle&&(this.descId="acst-subhdr-"+this.id)}return t.prototype.ionViewDidLoad=function(){var t=this;this.d.buttons=this.d.buttons.map(function(e){switch("string"==typeof e&&(e={text:e}),e.cssClass||(e.cssClass=""),e.role){case"cancel":return t.cancelButton=e,null;case"destructive":e.cssClass=(e.cssClass+" "||"")+"action-sheet-destructive";break;case"selected":e.cssClass=(e.cssClass+" "||"")+"action-sheet-selected"}return e}).filter(function(t){return null!==t})},t.prototype.ionViewWillEnter=function(){this.gestureBlocker.block()},t.prototype.ionViewDidLeave=function(){this.gestureBlocker.unblock()},t.prototype.ionViewDidEnter=function(){var t=this._elementRef.nativeElement.querySelector("button");t&&t.focus(),this.enabled=!0},t.prototype.keyUp=function(t){this.enabled&&t.keyCode===i.c&&this._viewCtrl.isLast()&&this.bdClick()},t.prototype.click=function(t){if(this.enabled){var e=!0;t.handler&&!1===t.handler()&&(e=!1),e&&this.dismiss(t.role)}},t.prototype.bdClick=function(){this.enabled&&this.d.enableBackdropDismiss&&(this.cancelButton?this.click(this.cancelButton):this.dismiss("backdrop"))},t.prototype.dismiss=function(t){return this._viewCtrl.dismiss(null,t,{minClickBlockDuration:400})},t.prototype.ngOnDestroy=function(){this.d=this.cancelButton=null,this.gestureBlocker.destroy()},t}()),a=-1},function(t,e,n){"use strict";n.d(e,"a",function(){return s});n(1);var r=n(11),i=n(7),o=n(2),a=n(22),s=(n(10),n(3),n(4),function(){function t(t,e,n,r,o,a,s){this._viewCtrl=t,this._elementRef=e,this._renderer=a,this._plt=s,this.gestureBlocker=r.createBlocker(i.a),this.d=o.data,this.mode=this.d.mode||n.get("mode"),this.keyboardResizes=n.getBoolean("keyboardResizes",!1),a.setElementClass(e.nativeElement,"alert-"+this.mode,!0),this.d.cssClass&&this.d.cssClass.split(" ").forEach(function(t){""!==t.trim()&&a.setElementClass(e.nativeElement,t,!0)}),this.id=++l,this.descId="",this.hdrId="alert-hdr-"+this.id,this.subHdrId="alert-subhdr-"+this.id,this.msgId="alert-msg-"+this.id,this.activeId="",this.lastClick=0,this.d.message?this.descId=this.msgId:this.d.subTitle&&(this.descId=this.subHdrId),this.d.message||(this.d.message="")}return t.prototype.ionViewDidLoad=function(){var t=this,e=this.d;e.buttons=e.buttons.map(function(t){return"string"==typeof t?{text:t}:t}),e.inputs=e.inputs.map(function(e,n){return{type:e.type||"text",name:Object(o.l)(e.name)?e.name:n+"",placeholder:Object(o.l)(e.placeholder)?e.placeholder:"",value:Object(o.l)(e.value)?e.value:"",label:e.label,checked:!!e.checked,disabled:!!e.disabled,id:Object(o.l)(e.id)?e.id:"alert-input-"+t.id+"-"+n,handler:Object(o.l)(e.handler)?e.handler:null,min:Object(o.l)(e.min)?e.min:null,max:Object(o.l)(e.max)?e.max:null}});var n=[];e.inputs.forEach(function(t){n.indexOf(t.type)<0&&n.push(t.type)}),n.length>1&&(n.indexOf("checkbox")>-1||n.indexOf("radio")>-1)&&console.warn("Alert cannot mix input types: "+n.join("/")+". Please see alert docs for more info."),this.inputType=n.length?n[0]:null;var i=this.d.inputs.find(function(t){return t.checked});i&&(this.activeId=i.id);var a=this.d.inputs.length&&this.d.inputs.some(function(t){return!r.a.test(t.type)});!this.keyboardResizes&&a&&this._plt.is("mobile")&&this._renderer.setElementClass(this._elementRef.nativeElement,"alert-top",!0)},t.prototype.ionViewWillEnter=function(){this.gestureBlocker.block()},t.prototype.ionViewDidLeave=function(){this.gestureBlocker.unblock()},t.prototype.ionViewDidEnter=function(){var t=this._elementRef.nativeElement.querySelector("input,button");t&&setTimeout(function(){return t.focus()}),this.enabled=!0},t.prototype.keyUp=function(t){if(this.enabled&&this._viewCtrl.isLast())if(t.keyCode===a.b){if(this.lastClick+1e3<Date.now()){this.btnClick(this.d.buttons[this.d.buttons.length-1])}}else t.keyCode===a.c&&this.bdClick()},t.prototype.btnClick=function(t){if(this.enabled){this.lastClick=Date.now();var e=!0;t.handler&&!1===t.handler(this.getValues())&&(e=!1),e&&this.dismiss(t.role)}},t.prototype.rbClick=function(t){this.enabled&&(this.d.inputs.forEach(function(e){e.checked=t===e}),this.activeId=t.id,t.handler&&t.handler(t))},t.prototype.cbClick=function(t){this.enabled&&(t.checked=!t.checked,t.handler&&t.handler(t))},t.prototype.bdClick=function(){if(this.enabled&&this.d.enableBackdropDismiss){var t=this.d.buttons.find(function(t){return"cancel"===t.role});t?this.btnClick(t):this.dismiss("backdrop")}},t.prototype.dismiss=function(t){return this._viewCtrl.dismiss(this.getValues(),t,{minClickBlockDuration:400})},t.prototype.getValues=function(){if("radio"===this.inputType){var t=this.d.inputs.find(function(t){return t.checked});return t?t.value:void 0}if("checkbox"===this.inputType)return this.d.inputs.filter(function(t){return t.checked}).map(function(t){return t.value});if(0!==this.d.inputs.length){var e={};return this.d.inputs.forEach(function(t){e[t.name]=t.value}),e}},t.prototype.ngOnDestroy=function(){this.gestureBlocker.destroy()},t}()),l=-1},function(t,e,n){"use strict";n.d(e,"a",function(){return i});n(1);var r=n(155),i=function(){function t(t,e){this._app=t,this.config=e}return t.prototype.create=function(t){return void 0===t&&(t={}),new r.a(this._app,t,this.config)},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(2),i=(n(1),n(7)),o=n(22),a=(n(10),n(4),function(){function t(t,e,n,r,o,a){this._viewCtrl=t,this._elementRef=e,this._gestureBlocker=r.createBlocker(i.a),this.d=o.data,this.mode=n.get("mode"),a.setElementClass(e.nativeElement,"picker-"+this.mode,!0),this.d.cssClass&&this.d.cssClass.split(" ").forEach(function(t){a.setElementClass(e.nativeElement,t,!0)}),this.id=++s,this.lastClick=0}return t.prototype.ionViewWillLoad=function(){var t=this.d;t.buttons=t.buttons.map(function(t){return Object(r.n)(t)?{text:t}:(t.role&&(t.cssRole="picker-toolbar-"+t.role),t)}),t.columns=t.columns.map(function(t){return Object(r.l)(t.options)||(t.options=[]),t.selectedIndex=t.selectedIndex||0,t.options=t.options.map(function(t){var e={text:"",value:"",disabled:t.disabled};return Object(r.l)(t)&&(Object(r.n)(t)||Object(r.j)(t)?(e.text=t.toString(),e.value=t):(e.text=Object(r.l)(t.text)?t.text:t.value,e.value=Object(r.l)(t.value)?t.value:t.text)),e}),t})},t.prototype.ionViewDidLoad=function(){this.refresh()},t.prototype.ionViewWillEnter=function(){this._gestureBlocker.block()},t.prototype.ionViewDidLeave=function(){this._gestureBlocker.unblock()},t.prototype.refresh=function(){this._cols.forEach(function(t){return t.refresh()})},t.prototype._colChange=function(){this._viewCtrl.ionChange.emit(this.getSelected())},t.prototype._keyUp=function(t){if(this.enabled&&this._viewCtrl.isLast())if(t.keyCode===o.b){if(this.lastClick+1e3<Date.now()){this.btnClick(this.d.buttons[this.d.buttons.length-1])}}else t.keyCode===o.c&&this.bdClick()},t.prototype.ionViewDidEnter=function(){var t=this._elementRef.nativeElement.querySelector("button");t&&t.focus(),this.enabled=!0},t.prototype.btnClick=function(t){if(this.enabled){this.lastClick=Date.now();var e=!0;t.handler&&!1===t.handler(this.getSelected())&&(e=!1),e&&this.dismiss(t.role)}},t.prototype.bdClick=function(){if(this.enabled&&this.d.enableBackdropDismiss){var t=this.d.buttons.find(function(t){return"cancel"===t.role});t?this.btnClick(t):this.dismiss("backdrop")}},t.prototype.dismiss=function(t){return this._viewCtrl.dismiss(this.getSelected(),t)},t.prototype.getSelected=function(){var t={};return this.d.columns.forEach(function(e,n){var r=e.options[e.selectedIndex];t[e.name]={text:r?r.text:null,value:r?r.value:null,columnIndex:n}}),t},t.prototype.ngOnDestroy=function(){this._gestureBlocker.destroy()},t}()),s=-1},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(152),i=function(){function t(t){this.elementRef=t,t.nativeElement.$ionComponent=this}return t.prototype.getReorderNode=function(){return Object(r.a)(this.elementRef.nativeElement,null)},t.prototype.onClick=function(t){t.preventDefault(),t.stopPropagation()},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return a});n(1);var r=n(7),i=n(2),o=n(22),a=(n(10),n(4),function(){function t(t,e,n,i,o,a){this._viewCtrl=t,this._config=e,this.gestureBlocker=i.createBlocker(r.a),this.d=o.data,a.setElementClass(n.nativeElement,"loading-"+e.get("mode"),!0),this.d.cssClass&&this.d.cssClass.split(" ").forEach(function(t){""!==t.trim()&&a.setElementClass(n.nativeElement,t,!0)}),this.id=++s}return t.prototype.ngOnInit=function(){Object(i.p)(this.d.spinner)&&(this.d.spinner=this._config.get("loadingSpinner",this._config.get("spinner","ios"))),this.showSpinner=Object(i.h)(this.d.spinner)&&"hide"!==this.d.spinner},t.prototype.ionViewWillEnter=function(){this.gestureBlocker.block()},t.prototype.ionViewDidLeave=function(){this.gestureBlocker.unblock()},t.prototype.ionViewDidEnter=function(){var t=this;this.d&&this.d.duration&&(this.durationTimeout=setTimeout(function(){return t.dismiss("backdrop")},this.d.duration))},t.prototype.keyUp=function(t){this._viewCtrl.isLast()&&t.keyCode===o.c&&this.bdClick()},t.prototype.bdClick=function(){this.d.enableBackdropDismiss&&this.dismiss("backdrop")},t.prototype.dismiss=function(t){return this.durationTimeout&&clearTimeout(this.durationTimeout),this._viewCtrl.dismiss(null,t)},t.prototype.ngOnDestroy=function(){this.gestureBlocker.destroy()},t}()),s=-1},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(22),i=(n(10),n(4),n(7)),o=(n(36),function(){function t(t,e,n,r,o,a,s){this._cfr=t,this._renderer=e,this._elementRef=n,this._navParams=r,this._viewCtrl=o,this.moduleLoader=s;var l=r.get("opts");this._gestureBlocker=a.createBlocker({disable:[i.d,i.b]}),this._bdDismiss=l.enableBackdropDismiss,l.cssClass&&l.cssClass.split(" ").forEach(function(t){""!==t.trim()&&e.setElementClass(n.nativeElement,t,!0)})}return t.prototype.ionViewPreLoad=function(){var t=this._navParams.data.component;if(t){var e=this.moduleLoader.getComponentFactoryResolver(t);e||(e=this._cfr);var n=e.resolveComponentFactory(t),r=this._viewport.createComponent(n,this._viewport.length,this._viewport.parentInjector,[]);this._setCssClass(r,"ion-page"),this._setCssClass(r,"show-page"),this._viewCtrl._setInstance(r.instance),this._viewCtrl.willEnter.subscribe(this._viewWillEnter.bind(this)),this._viewCtrl.didLeave.subscribe(this._viewDidLeave.bind(this)),this._enabled=!0}else console.warn("modal's page was not defined")},t.prototype._viewWillEnter=function(){this._gestureBlocker.block()},t.prototype._viewDidLeave=function(){this._gestureBlocker.unblock()},t.prototype._setCssClass=function(t,e){this._renderer.setElementClass(t.location.nativeElement,e,!0)},t.prototype._bdClick=function(){if(this._enabled&&this._bdDismiss){return this._viewCtrl.dismiss(null,"backdrop",{minClickBlockDuration:400})}},t.prototype._keyUp=function(t){this._enabled&&this._viewCtrl.isLast()&&t.keyCode===r.c&&this._bdClick()},t.prototype.ngOnDestroy=function(){this._gestureBlocker.destroy()},t}())},function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(1);var r=n(22),i=(n(10),n(4),n(7)),o=(n(36),function(){function t(t,e,n,r,o,s,l,u){this._cfr=t,this._elementRef=e,this._renderer=n,this._config=r,this._navParams=o,this._viewCtrl=s,this.moduleLoader=u,this._gestureBlocker=l.createBlocker(i.a),this.d=o.data.opts,n.setElementClass(e.nativeElement,"popover-"+r.get("mode"),!0),this.d.cssClass&&this.d.cssClass.split(" ").forEach(function(t){""!==t.trim()&&n.setElementClass(e.nativeElement,t,!0)}),this.id=++a}return t.prototype.ionViewPreLoad=function(){this._load(this._navParams.data.component)},t.prototype._load=function(t){if(t){var e=this.moduleLoader.getComponentFactoryResolver(t);e||(e=this._cfr);var n=e.resolveComponentFactory(t),r=this._viewport.createComponent(n,this._viewport.length,this._viewport.parentInjector,[]);this._viewCtrl._setInstance(r.instance),this._enabled=!0,this._viewCtrl.willEnter.subscribe(this._viewWillEnter.bind(this)),this._viewCtrl.didLeave.subscribe(this._viewDidLeave.bind(this))}},t.prototype._viewWillEnter=function(){this._gestureBlocker.block()},t.prototype._viewDidLeave=function(){this._gestureBlocker.unblock()},t.prototype._setCssClass=function(t,e){this._renderer.setElementClass(t.location.nativeElement,e,!0)},t.prototype._bdClick=function(){if(this._enabled&&this.d.enableBackdropDismiss)return this._viewCtrl.dismiss(null,"backdrop")},t.prototype._keyUp=function(t){this._enabled&&t.keyCode===r.c&&this._viewCtrl.isLast()&&this._bdClick()},t.prototype.ngOnDestroy=function(){this._gestureBlocker.destroy()},t}()),a=-1},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(0),i=(n(1),n(13),n(6)),o=n(2),a=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),s=function(t){function e(e,n,i,o,a,s){var l=t.call(this,n,i,o,"radio")||this;return l._form=e,l._item=a,l._group=s,l._checked=!1,l._disabled=!1,l._value=null,l.ionSelect=new r.l,e.register(l),s&&(l.id="rb-"+s.add(l)),a&&(l.id="rb-"+a.registerInput("radio"),l._labelId="lbl-"+a.id,l._item.setElementClass("item-radio",!0)),l}return a(e,t),Object.defineProperty(e.prototype,"color",{set:function(t){this._setColor(t),this._item&&this._item._updateColor(t,"item-radio")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return Object(o.f)(this._value)?this.id:this._value},set:function(t){this._value=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"checked",{get:function(){return this._checked},set:function(t){this._checked=Object(o.o)(t),this._item&&this._item.setElementClass("item-radio-checked",this._checked)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this._disabled||null!=this._group&&this._group.disabled},set:function(t){this._disabled=Object(o.o)(t),this._item&&this._item.setElementClass("item-radio-disabled",this._disabled)},enumerable:!0,configurable:!0}),e.prototype.initFocus=function(){this._elementRef.nativeElement.querySelector("button").focus()},e.prototype._click=function(t){t.preventDefault(),t.stopPropagation(),this.checked=!0,this.ionSelect.emit(this.value)},e.prototype.ngOnInit=function(){this._group&&Object(o.l)(this._group.value)&&(this.checked=Object(o.g)(this._group.value,this.value)),this._group&&this._group.disabled&&(this.disabled=this._group.disabled)},e.prototype.ngOnDestroy=function(){this._form.deregister(this),this._group&&this._group.remove(this)},e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return r});n(10),n(4);var r=function(){function t(t,e){this.navParams=t,this.viewController=e}return Object.defineProperty(t.prototype,"value",{get:function(){var t=this.options.find(function(t){return t.checked});return t?t.value:void 0},set:function(t){var e=this.options.find(function(e){return e.value===t});e&&e.handler&&e.handler(),this.viewController.dismiss(t)},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){this.options=this.navParams.data.options},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return r});n(1),n(10),n(4);var r=function(){function t(t,e,n,r,o){this._viewCtrl=t,this._config=e,this._elementRef=n,this.dismissTimeout=void 0,o.setElementClass(n.nativeElement,"toast-"+e.get("mode"),!0),this.d=r.data,this.d.cssClass&&this.d.cssClass.split(" ").forEach(function(t){""!==t.trim()&&o.setElementClass(n.nativeElement,t,!0)}),this.id=++i,this.d.message&&(this.hdrId="toast-hdr-"+this.id)}return t.prototype.ngAfterViewInit=function(){var t=this;this.d.duration&&(this.dismissTimeout=setTimeout(function(){t.dismiss("backdrop")},this.d.duration)),this.enabled=!0},t.prototype.ionViewDidEnter=function(){var t=document.activeElement;t&&t.blur();var e=this._elementRef.nativeElement.querySelector("button");e&&e.focus()},t.prototype.cbClick=function(){this.enabled&&this.dismiss("close")},t.prototype.dismiss=function(t){return clearTimeout(this.dismissTimeout),this.dismissTimeout=void 0,this._viewCtrl.dismiss(null,t,{disableApp:!1})},t}(),i=-1},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(84),i=(n(1),function(){function t(t,e){this._app=t,this.config=e}return t.prototype.create=function(t){return void 0===t&&(t={}),new r.a(this._app,t,this.config)},t}())},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(85),i=(n(1),function(){function t(t,e){this._app=t,this.config=e}return t.prototype.create=function(t){return void 0===t&&(t={}),new r.a(this._app,t,this.config)},t}())},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){return function(){}}()},function(t,e,n){"use strict";n.d(e,"a",function(){return i});n(1);var r=n(165),i=(n(12),function(){function t(t,e,n){this._app=t,this.config=e,this.deepLinker=n}return t.prototype.create=function(t,e,n){return void 0===e&&(e={}),void 0===n&&(n={}),new r.a(this._app,t,e,n,this.config,this.deepLinker)},t}())},function(t,e,n){"use strict";n.d(e,"a",function(){return i});n(1);var r=n(170),i=function(){function t(t,e){this._app=t,this.config=e}return t.prototype.create=function(t){return void 0===t&&(t={}),new r.a(this._app,t,this.config)},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(0),i=n(2),o=function(){function t(){this.isActive=!1,this._disabled=!1,this.ionSelect=new r.l}return Object.defineProperty(t.prototype,"disabled",{get:function(){return this._disabled},set:function(t){this._disabled=Object(i.o)(t)},enumerable:!0,configurable:!0}),t.prototype.onClick=function(){this.ionSelect.emit(this)},t.prototype.ngOnInit=function(){Object(i.l)(this.value)||console.warn('<ion-segment-button> requires a "value" attribute')},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return i});n(1);var r=n(2),i=(n(3),n(53),function(){function t(t,e,n,r){this._elementRef=t,this._renderer=e,this._plt=r,this._visible=!1,this._fabs=[],this._mode=n.get("mode")}return Object.defineProperty(t.prototype,"_setbuttons",{set:function(t){for(var e=this._fabs=t.toArray(),n="fab-"+this._mode+"-in-list",r=0,i=e;r<i.length;r++){var o=i[r];o.setElementClass("fab-in-list",!0),o.setElementClass(n,!0)}},enumerable:!0,configurable:!0}),t.prototype.setVisible=function(t){var e=this,n=Object(r.o)(t);if(n!==this._visible){this._visible=n;var i=this._fabs,o=1;i.forEach(n?function(t){e._plt.timeout(function(){return t.setElementClass("show",!0)},30*o),o++}:function(t){return t.setElementClass("show",!1)}),this.setElementClass("fab-list-active",n)}},t.prototype.setElementClass=function(t,e){this._renderer.setElementClass(this._elementRef.nativeElement,t,e)},t}())},function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(1);var r=n(6),i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(t){function e(e,n,r,i){var o=t.call(this,e,r,n,"list-header")||this;return o._id=i,o}return i(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(t){this._id=t,this.setElementAttribute("id",t)},enumerable:!0,configurable:!0}),e}(r.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(0),i=n(2),o=function(){function t(t){this._elementRef=t,this._selected=!1,this._disabled=!1,this.ionSelect=new r.l}return Object.defineProperty(t.prototype,"disabled",{get:function(){return this._disabled},set:function(t){this._disabled=Object(i.o)(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selected",{get:function(){return this._selected},set:function(t){this._selected=Object(i.o)(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return Object(i.l)(this._value)?this._value:this.text},set:function(t){this._value=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._elementRef.nativeElement.textContent},enumerable:!0,configurable:!0}),t}()},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";var r=n(33).root.Symbol;e.rxSubscriber="function"==typeof r&&"function"==typeof r.for?r.for("rxSubscriber"):"@@rxSubscriber",e.$$rxSubscriber=e.rxSubscriber},function(t,e,n){"use strict";var r=n(33),i=n(209),o=n(210),a=n(135),s=n(14),l=n(211),u=n(212),c=n(138);e.subscribeToResult=function(t,e,n,h){var p=new u.InnerSubscriber(t,n,h);if(p.closed)return null;if(e instanceof s.Observable)return e._isScalar?(p.next(e.value),p.complete(),null):(p.syncErrorThrowable=!0,e.subscribe(p));if(i.isArrayLike(e)){for(var d=0,f=e.length;d<f&&!p.closed;d++)p.next(e[d]);p.closed||p.complete()}else{if(o.isPromise(e))return e.then(function(t){p.closed||(p.next(t),p.complete())},function(t){return p.error(t)}).then(null,function(t){r.root.setTimeout(function(){throw t})}),p;if(e&&"function"==typeof e[l.iterator])for(var m=e[l.iterator]();;){var v=m.next();if(v.done){p.complete();break}if(p.next(v.value),p.closed)break}else if(e&&"function"==typeof e[c.observable]){var g=e[c.observable]();if("function"==typeof g.subscribe)return g.subscribe(new u.InnerSubscriber(t,n,h));p.error(new TypeError("Provided object does not correctly implement Symbol.observable"))}else{var y="You provided "+(a.isObject(e)?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";p.error(new TypeError(y))}}return null}},function(t,e,n){"use strict";var r=n(5).__extends,i=n(28);e.OuterSubscriber=function(t){function e(){t.apply(this,arguments)}return r(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(i.Subscriber)},function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(1),n(12),n(9),n(7);var r=n(56),i=(n(3),n(31),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),o=function(t){function e(e,n,r,i,o,a,s,l,u,c,h,p,d){var f=t.call(this,null,e,n,r,i,o,a,s,l,u,c,p,d)||this;return f._isPortal=!0,f._init=!0,f.setViewport(h),e.viewDidLeave.subscribe(function(t){t.isOverlay||f.dismissPageChangeViews()}),f}return i(e,t),Object.defineProperty(e.prototype,"_overlayPortal",{set:function(t){this._zIndexOffset=t||0},enumerable:!0,configurable:!0}),e.prototype.ngOnDestroy=function(){this.destroy()},e.prototype.getType=function(){return"portal"},e.prototype.getSecondaryIdentifier=function(){return null},e}(r.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(143),i=n(2),o=n(11),a=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),s=function(t){function e(e,n,r){void 0===r&&(r={});var o=this;return Object(i.d)(r,{edge:"start",maxEdgeStart:50}),(o=t.call(this,e,n,r)||this).setEdges(r.edge),o.maxEdgeStart=r.maxEdgeStart,o}return a(e,t),e.prototype.setEdges=function(t){var e=this.plt.isRTL;this.edges=t.split(" ").map(function(t){switch(t){case"start":return e?"right":"left";case"end":return e?"left":"right";default:return t}})},e.prototype.canStart=function(t){var e=this,n=Object(o.f)(t);return this._d=this.getContainerDimensions(),this.edges.every(function(t){return e._checkEdge(t,n)})},e.prototype.getContainerDimensions=function(){var t=this.plt;return{left:0,top:0,width:t.width(),height:t.height()}},e.prototype._checkEdge=function(t,e){var n=this._d,r=this.maxEdgeStart;switch(t){case"left":return e.x<=n.left+r;case"right":return e.x>=n.width-r;case"top":return e.y<=n.top+r;case"bottom":return e.y>=n.height-r}return!1},e}(r.a)},function(t,e,n){"use strict";var r=n(58),i=n(15),o=n(34),a=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.init=function(){var t=this.enteringView.pageRef().nativeElement,e=new i.a(this.plt,t.querySelector("ion-backdrop")),n=new i.a(this.plt,t.querySelector(".action-sheet-wrapper"));e.fromTo("opacity",.01,.4),n.fromTo("translateY","100%","0%"),this.easing("cubic-bezier(.36,.66,.04,1)").duration(400).add(e).add(n)},e}(o.a),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.init=function(){var t=this.leavingView.pageRef().nativeElement,e=new i.a(this.plt,t.querySelector("ion-backdrop")),n=new i.a(this.plt,t.querySelector(".action-sheet-wrapper"));e.fromTo("opacity",.4,0),n.fromTo("translateY","0%","100%"),this.easing("cubic-bezier(.36,.66,.04,1)").duration(300).add(e).add(n)},e}(o.a),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.init=function(){var t=this.enteringView.pageRef().nativeElement,e=new i.a(this.plt,t.querySelector("ion-backdrop")),n=new i.a(this.plt,t.querySelector(".action-sheet-wrapper"));e.fromTo("opacity",.01,.26),n.fromTo("translateY","100%","0%"),this.easing("cubic-bezier(.36,.66,.04,1)").duration(400).add(e).add(n)},e}(o.a),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.init=function(){var t=this.leavingView.pageRef().nativeElement,e=new i.a(this.plt,t.querySelector("ion-backdrop")),n=new i.a(this.plt,t.querySelector(".action-sheet-wrapper"));e.fromTo("opacity",.26,0),n.fromTo("translateY","0%","100%"),this.easing("cubic-bezier(.36,.66,.04,1)").duration(450).add(e).add(n)},e}(o.a),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.init=function(){var t=this.enteringView.pageRef().nativeElement,e=new i.a(this.plt,t.querySelector("ion-backdrop")),n=new i.a(this.plt,t.querySelector(".action-sheet-wrapper"));e.fromTo("opacity",.01,.16),n.fromTo("translateY","100%","0%"),this.easing("cubic-bezier(.36,.66,.04,1)").duration(400).add(e).add(n)},e}(o.a),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.init=function(){var t=this.leavingView.pageRef().nativeElement,e=new i.a(this.plt,t.querySelector("ion-backdrop")),n=new i.a(this.plt,t.querySelector(".action-sheet-wrapper"));e.fromTo("opacity",.1,0),n.fromTo("translateY","0%","100%"),this.easing("cubic-bezier(.36,.66,.04,1)").duration(450).add(e).add(n)},e}(o.a),d=n(2),f=n(4);n.d(e,"a",function(){return v});var m=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),v=function(t){function e(e,n,i){var o=this;return n.buttons=n.buttons||[],n.enableBackdropDismiss=!Object(d.l)(n.enableBackdropDismiss)||!!n.enableBackdropDismiss,o=t.call(this,r.a,n,null)||this,o._app=e,o.isOverlay=!0,i.setTransition("action-sheet-slide-in",s),i.setTransition("action-sheet-slide-out",l),i.setTransition("action-sheet-md-slide-in",u),i.setTransition("action-sheet-md-slide-out",c),i.setTransition("action-sheet-wp-slide-in",h),i.setTransition("action-sheet-wp-slide-out",p),o}return m(e,t),e.prototype.getTransitionName=function(t){return this._nav&&this._nav.config.get("actionSheet"+("back"===t?"Leave":"Enter"))},e.prototype.setTitle=function(t){return this.data.title=t,this},e.prototype.setSubTitle=function(t){return this.data.subTitle=t,this},e.prototype.addButton=function(t){return this.data.buttons.push(t),this},e.prototype.present=function(t){return void 0===t&&(t={}),t.minClickBlockDuration=t.minClickBlockDuration||400,this._app.present(this,t)},e}(f.a)},function(t,e,n){"use strict";var r=n(59),i=n(15),o=n(34),a=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.init=function(){var t=this.enteringView.pageRef().nativeElement,e=new i.a(this.plt,t.querySelector("ion-backdrop")),n=new i.a(this.plt,t.querySelector(".alert-wrapper"));n.fromTo("opacity",.01,1).fromTo("scale",1.1,1),e.fromTo("opacity",.01,.3),this.easing("ease-in-out").duration(200).add(e).add(n)},e}(o.a),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.init=function(){var t=this.leavingView.pageRef().nativeElement,e=new i.a(this.plt,t.querySelector("ion-backdrop")),n=new i.a(this.plt,t.querySelector(".alert-wrapper"));n.fromTo("opacity",.99,0).fromTo("scale",1,.9),e.fromTo("opacity",.3,0),this.easing("ease-in-out").duration(200).add(e).add(n)},e}(o.a),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.init=function(){var t=this.enteringView.pageRef().nativeElement,e=new i.a(this.plt,t.querySelector("ion-backdrop")),n=new i.a(this.plt,t.querySelector(".alert-wrapper"));n.fromTo("opacity",.01,1).fromTo("scale",1.1,1),e.fromTo("opacity",.01,.5),this.easing("ease-in-out").duration(200).add(e).add(n)},e}(o.a),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.init=function(){var t=this.leavingView.pageRef().nativeElement,e=new i.a(this.plt,t.querySelector("ion-backdrop")),n=new i.a(this.plt,t.querySelector(".alert-wrapper"));n.fromTo("opacity",.99,0).fromTo("scale",1,.9),e.fromTo("opacity",.5,0),this.easing("ease-in-out").duration(200).add(e).add(n)},e}(o.a),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.init=function(){var t=this.enteringView.pageRef().nativeElement,e=new i.a(this.plt,t.querySelector("ion-backdrop")),n=new i.a(this.plt,t.querySelector(".alert-wrapper"));n.fromTo("opacity",.01,1).fromTo("scale",1.3,1),e.fromTo("opacity",.01,.5),this.easing("cubic-bezier(0,0,0.05,1)").duration(200).add(e).add(n)},e}(o.a),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.init=function(){var t=this.leavingView.pageRef().nativeElement,e=new i.a(this.plt,t.querySelector("ion-backdrop")),n=new i.a(this.plt,t.querySelector(".alert-wrapper"));n.fromTo("opacity",.99,0).fromTo("scale",1,1.3),e.fromTo("opacity",.5,0),this.easing("ease-out").duration(150).add(e).add(n)},e}(o.a),d=n(2),f=n(4);n.d(e,"a",function(){return v});var m=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),v=function(t){function e(e,n,i){void 0===n&&(n={});var o=this;return n.inputs=n.inputs||[],n.buttons=n.buttons||[],n.enableBackdropDismiss=!Object(d.l)(n.enableBackdropDismiss)||!!n.enableBackdropDismiss,o=t.call(this,r.a,n,null)||this,o._app=e,o.isOverlay=!0,i.setTransition("alert-pop-in",s),i.setTransition("alert-pop-out",l),i.setTransition("alert-md-pop-in",u),i.setTransition("alert-md-pop-out",c),i.setTransition("alert-wp-pop-in",h),i.setTransition("alert-wp-pop-out",p),o}return m(e,t),e.prototype.getTransitionName=function(t){return this._nav&&this._nav.config.get("back"===t?"alertLeave":"alertEnter")},e.prototype.setTitle=function(t){return this.data.title=t,this},e.prototype.setSubTitle=function(t){return this.data.subTitle=t,this},e.prototype.setMessage=function(t){return this.data.message=t,this},e.prototype.addInput=function(t){return this.data.inputs.push(t),this},e.prototype.addButton=function(t){return this.data.buttons.push(t),this},e.prototype.setCssClass=function(t){return this.data.cssClass=t,this},e.prototype.setMode=function(t){this.data.mode=t},e.prototype.present=function(t){return void 0===t&&(t={}),t.minClickBlockDuration=t.minClickBlockDuration||400,this._app.present(this,t)},e}(f.a)},function(t,e,n){"use strict";n(21),n(9)},function(t,e,n){"use strict";n(3),n(2)},function(t,e,n){"use strict";n.d(e,"a",function(){return i});n(1);var r=n(161),i=function(){function t(t,e){this._app=t,this.config=e}return t.prototype.create=function(t){return void 0===t&&(t={}),new r.a(this._app,t,this.config)},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(0),i=function(){function t(t){this._compiler=t}return t.prototype.load=function(t,e){return this._compiler instanceof r.h?function(t,e){return n(167)(t).then(function(n){var r=n[e];if(!r)throw new Error("Module "+t+" does not export "+e);return r})}(t,e):function(t,e,r){return r||(r="default"),n(167)(e).then(function(n){var i=n[r];if(!i)throw new Error("Module "+e+" does not export "+r);return t.compileModuleAsync(i)})}(this._compiler,t,e)},t}()},function(t,e,n){"use strict";function r(t){if("string"!=typeof t)return t;switch(t.toUpperCase()){case"GET":return d.Get;case"POST":return d.Post;case"PUT":return d.Put;case"DELETE":return d.Delete;case"OPTIONS":return d.Options;case"HEAD":return d.Head;case"PATCH":return d.Patch}throw new Error('Invalid request method. The method "'+t+'" is not supported.')}function i(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}function o(t,e){return t.createConnection(e).response}function a(t,e,n,r){var i=t;return i.merge(new O(e?{method:e.method||n,url:e.url||r,search:e.search,params:e.params,headers:e.headers,body:e.body,withCredentials:e.withCredentials,responseType:e.responseType}:{method:n,url:r}))}function s(){return new E}function l(t,e){return new U(t,e)}n.d(e,"c",function(){return p}),n.d(e,"i",function(){return P}),n.d(e,"a",function(){return N}),n.d(e,"g",function(){return O}),n.d(e,"b",function(){return b}),n.d(e,"h",function(){return y}),n.d(e,"d",function(){return g}),n.d(e,"e",function(){return U}),n.d(e,"f",function(){return j}),n.d(e,"j",function(){return _}),n.d(e,"k",function(){return s}),n.d(e,"l",function(){return l});var u=n(5),c=n(14),h=n(27),p=function(){function t(){}return t.prototype.build=function(){return new XMLHttpRequest},t}(),d=function(){var t={Get:0,Post:1,Put:2,Delete:3,Options:4,Head:5,Patch:6};return t[t.Get]="Get",t[t.Post]="Post",t[t.Put]="Put",t[t.Delete]="Delete",t[t.Options]="Options",t[t.Head]="Head",t[t.Patch]="Patch",t}(),f=function(){var t={Basic:0,Cors:1,Default:2,Error:3,Opaque:4};return t[t.Basic]="Basic",t[t.Cors]="Cors",t[t.Default]="Default",t[t.Error]="Error",t[t.Opaque]="Opaque",t}(),m=function(){var t={NONE:0,JSON:1,FORM:2,FORM_DATA:3,TEXT:4,BLOB:5,ARRAY_BUFFER:6};return t[t.NONE]="NONE",t[t.JSON]="JSON",t[t.FORM]="FORM",t[t.FORM_DATA]="FORM_DATA",t[t.TEXT]="TEXT",t[t.BLOB]="BLOB",t[t.ARRAY_BUFFER]="ARRAY_BUFFER",t}(),v=function(){var t={Text:0,Json:1,ArrayBuffer:2,Blob:3};return t[t.Text]="Text",t[t.Json]="Json",t[t.ArrayBuffer]="ArrayBuffer",t[t.Blob]="Blob",t}(),g=function(){function t(e){var n=this;this._headers=new Map,this._normalizedNames=new Map,e&&(e instanceof t?e.forEach(function(t,e){t.forEach(function(t){return n.append(e,t)})}):Object.keys(e).forEach(function(t){var r=Array.isArray(e[t])?e[t]:[e[t]];n.delete(t),r.forEach(function(e){return n.append(t,e)})}))}return t.fromResponseHeaderString=function(e){var n=new t;return e.split("\n").forEach(function(t){var e=t.indexOf(":");if(e>0){var r=t.slice(0,e),i=t.slice(e+1).trim();n.set(r,i)}}),n},t.prototype.append=function(t,e){var n=this.getAll(t);null===n?this.set(t,e):n.push(e)},t.prototype.delete=function(t){var e=t.toLowerCase();this._normalizedNames.delete(e),this._headers.delete(e)},t.prototype.forEach=function(t){var e=this;this._headers.forEach(function(n,r){return t(n,e._normalizedNames.get(r),e._headers)})},t.prototype.get=function(t){var e=this.getAll(t);return null===e?null:e.length>0?e[0]:null},t.prototype.has=function(t){return this._headers.has(t.toLowerCase())},t.prototype.keys=function(){return Array.from(this._normalizedNames.values())},t.prototype.set=function(t,e){Array.isArray(e)?e.length&&this._headers.set(t.toLowerCase(),[e.join(",")]):this._headers.set(t.toLowerCase(),[e]),this.mayBeSetNormalizedName(t)},t.prototype.values=function(){return Array.from(this._headers.values())},t.prototype.toJSON=function(){var t=this,e={};return this._headers.forEach(function(n,r){var i=[];n.forEach(function(t){return i.push.apply(i,t.split(","))}),e[t._normalizedNames.get(r)]=i}),e},t.prototype.getAll=function(t){return this.has(t)?this._headers.get(t.toLowerCase())||null:null},t.prototype.entries=function(){throw new Error('"entries" method is not implemented on Headers class')},t.prototype.mayBeSetNormalizedName=function(t){var e=t.toLowerCase();this._normalizedNames.has(e)||this._normalizedNames.set(e,t)},t}(),y=function(){function t(t){void 0===t&&(t={});var e=t.body,n=t.status,r=t.headers,i=t.statusText,o=t.type,a=t.url;this.body=null!=e?e:null,this.status=null!=n?n:null,this.headers=null!=r?r:null,this.statusText=null!=i?i:null,this.type=null!=o?o:null,this.url=null!=a?a:null}return t.prototype.merge=function(e){return new t({body:e&&null!=e.body?e.body:this.body,status:e&&null!=e.status?e.status:this.status,headers:e&&null!=e.headers?e.headers:this.headers,statusText:e&&null!=e.statusText?e.statusText:this.statusText,type:e&&null!=e.type?e.type:this.type,url:e&&null!=e.url?e.url:this.url})},t}(),b=function(t){function e(){return t.call(this,{status:200,statusText:"Ok",type:f.Default,headers:new g})||this}return Object(u.__extends)(e,t),e}(y),_=function(){return function(){}}(),x=function(t){return t>=200&&t<300},w=function(){function t(){}return t.prototype.encodeKey=function(t){return i(t)},t.prototype.encodeValue=function(t){return i(t)},t}(),S=function(){function t(t,e){void 0===t&&(t=""),void 0===e&&(e=new w),this.rawParams=t,this.queryEncoder=e,this.paramsMap=function(t){void 0===t&&(t="");var e=new Map;t.length>0&&t.split("&").forEach(function(t){var n=t.indexOf("="),r=-1==n?[t,""]:[t.slice(0,n),t.slice(n+1)],i=r[0],o=r[1],a=e.get(i)||[];a.push(o),e.set(i,a)});return e}(t)}return t.prototype.clone=function(){var e=new t("",this.queryEncoder);return e.appendAll(this),e},t.prototype.has=function(t){return this.paramsMap.has(t)},t.prototype.get=function(t){var e=this.paramsMap.get(t);return Array.isArray(e)?e[0]:null},t.prototype.getAll=function(t){return this.paramsMap.get(t)||[]},t.prototype.set=function(t,e){if(void 0!==e&&null!==e){var n=this.paramsMap.get(t)||[];n.length=0,n.push(e),this.paramsMap.set(t,n)}else this.delete(t)},t.prototype.setAll=function(t){var e=this;t.paramsMap.forEach(function(t,n){var r=e.paramsMap.get(n)||[];r.length=0,r.push(t[0]),e.paramsMap.set(n,r)})},t.prototype.append=function(t,e){if(void 0!==e&&null!==e){var n=this.paramsMap.get(t)||[];n.push(e),this.paramsMap.set(t,n)}},t.prototype.appendAll=function(t){var e=this;t.paramsMap.forEach(function(t,n){for(var r=e.paramsMap.get(n)||[],i=0;i<t.length;++i)r.push(t[i]);e.paramsMap.set(n,r)})},t.prototype.replaceAll=function(t){var e=this;t.paramsMap.forEach(function(t,n){var r=e.paramsMap.get(n)||[];r.length=0;for(var i=0;i<t.length;++i)r.push(t[i]);e.paramsMap.set(n,r)})},t.prototype.toString=function(){var t=this,e=[];return this.paramsMap.forEach(function(n,r){n.forEach(function(n){return e.push(t.queryEncoder.encodeKey(r)+"="+t.queryEncoder.encodeValue(n))})}),e.join("&")},t.prototype.delete=function(t){this.paramsMap.delete(t)},t}(),A=function(){function t(){}return t.prototype.json=function(){return"string"==typeof this._body?JSON.parse(this._body):this._body instanceof ArrayBuffer?JSON.parse(this.text()):this._body},t.prototype.text=function(t){if(void 0===t&&(t="legacy"),this._body instanceof S)return this._body.toString();if(this._body instanceof ArrayBuffer)switch(t){case"legacy":return String.fromCharCode.apply(null,new Uint16Array(this._body));case"iso-8859":return String.fromCharCode.apply(null,new Uint8Array(this._body));default:throw new Error("Invalid value for encodingHint: "+t)}return null==this._body?"":"object"==typeof this._body?JSON.stringify(this._body,null,2):this._body.toString()},t.prototype.arrayBuffer=function(){return this._body instanceof ArrayBuffer?this._body:function(t){for(var e=new Uint16Array(t.length),n=0,r=t.length;n<r;n++)e[n]=t.charCodeAt(n);return e.buffer}(this.text())},t.prototype.blob=function(){if(this._body instanceof Blob)return this._body;if(this._body instanceof ArrayBuffer)return new Blob([this._body]);throw new Error("The request body isn't either a blob or an array buffer")},t}(),M=function(t){function e(e){var n=t.call(this)||this;return n._body=e.body,n.status=e.status,n.ok=n.status>=200&&n.status<=299,n.statusText=e.statusText,n.headers=e.headers,n.type=e.type,n.url=e.url,n}return Object(u.__extends)(e,t),e.prototype.toString=function(){return"Response with status: "+this.status+" "+this.statusText+" for URL: "+this.url},e}(A),T=/^\)\]\}',?\n/,C=function(){function t(t,e,n){var r=this;this.request=t,this.response=new c.Observable(function(i){var o=e.build();o.open(d[t.method].toUpperCase(),t.url),null!=t.withCredentials&&(o.withCredentials=t.withCredentials);var a=function(){var e=1223===o.status?204:o.status,r=null;204!==e&&"string"==typeof(r=void 0===o.response?o.responseText:o.response)&&(r=r.replace(T,"")),0===e&&(e=r?200:0);var a=g.fromResponseHeaderString(o.getAllResponseHeaders()),s=function(t){return"responseURL"in t?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(o)||t.url,l=new y({body:r,status:e,headers:a,statusText:o.statusText||"OK",url:s});null!=n&&(l=n.merge(l));var u=new M(l);if(u.ok=x(e),u.ok)return i.next(u),void i.complete();i.error(u)},s=function(t){var e=new y({body:t,type:f.Error,status:o.status,statusText:o.statusText});null!=n&&(e=n.merge(e)),i.error(new M(e))};if(r.setDetectedContentType(t,o),null==t.headers&&(t.headers=new g),t.headers.has("Accept")||t.headers.append("Accept","application/json, text/plain, */*"),t.headers.forEach(function(t,e){return o.setRequestHeader(e,t.join(","))}),null!=t.responseType&&null!=o.responseType)switch(t.responseType){case v.ArrayBuffer:o.responseType="arraybuffer";break;case v.Json:o.responseType="json";break;case v.Text:o.responseType="text";break;case v.Blob:o.responseType="blob";break;default:throw new Error("The selected responseType is not supported")}return o.addEventListener("load",a),o.addEventListener("error",s),o.send(r.request.getBody()),function(){o.removeEventListener("load",a),o.removeEventListener("error",s),o.abort()}})}return t.prototype.setDetectedContentType=function(t,e){if(null==t.headers||null==t.headers.get("Content-Type"))switch(t.contentType){case m.NONE:break;case m.JSON:e.setRequestHeader("content-type","application/json");break;case m.FORM:e.setRequestHeader("content-type","application/x-www-form-urlencoded;charset=UTF-8");break;case m.TEXT:e.setRequestHeader("content-type","text/plain");break;case m.BLOB:var n=t.blob();n.type&&e.setRequestHeader("content-type",n.type)}},t}(),E=function(){function t(t,e){void 0===t&&(t="XSRF-TOKEN"),void 0===e&&(e="X-XSRF-TOKEN"),this._cookieName=t,this._headerName=e}return t.prototype.configureRequest=function(t){var e=Object(h.r)().getCookie(this._cookieName);e&&t.headers.set(this._headerName,e)},t}(),P=function(){function t(t,e,n){this._browserXHR=t,this._baseResponseOptions=e,this._xsrfStrategy=n}return t.prototype.createConnection=function(t){return this._xsrfStrategy.configureRequest(t),new C(t,this._browserXHR,this._baseResponseOptions)},t}(),O=function(){function t(t){void 0===t&&(t={});var e=t.method,n=t.headers,i=t.body,o=t.url,a=t.search,s=t.params,l=t.withCredentials,u=t.responseType;this.method=null!=e?r(e):null,this.headers=null!=n?n:null,this.body=null!=i?i:null,this.url=null!=o?o:null,this.params=this._mergeSearchParams(s||a),this.withCredentials=null!=l?l:null,this.responseType=null!=u?u:null}return Object.defineProperty(t.prototype,"search",{get:function(){return this.params},set:function(t){this.params=t},enumerable:!0,configurable:!0}),t.prototype.merge=function(e){return new t({method:e&&null!=e.method?e.method:this.method,headers:e&&null!=e.headers?e.headers:new g(this.headers),body:e&&null!=e.body?e.body:this.body,url:e&&null!=e.url?e.url:this.url,params:e&&this._mergeSearchParams(e.params||e.search),withCredentials:e&&null!=e.withCredentials?e.withCredentials:this.withCredentials,responseType:e&&null!=e.responseType?e.responseType:this.responseType})},t.prototype._mergeSearchParams=function(t){return t?t instanceof S?t.clone():"string"==typeof t?new S(t):this._parseParams(t):this.params},t.prototype._parseParams=function(t){var e=this;void 0===t&&(t={});var n=new S;return Object.keys(t).forEach(function(r){var i=t[r];Array.isArray(i)?i.forEach(function(t){return e._appendParam(r,t,n)}):e._appendParam(r,i,n)}),n},t.prototype._appendParam=function(t,e,n){"string"!=typeof e&&(e=JSON.stringify(e)),n.append(t,e)},t}(),N=function(t){function e(){return t.call(this,{method:d.Get,headers:new g})||this}return Object(u.__extends)(e,t),e}(O),L=function(t){function e(e){var n=t.call(this)||this,i=e.url;n.url=e.url;var o=e.params||e.search;if(o){var a=void 0;if((a="object"!=typeof o||o instanceof S?o.toString():function(t){var e=new S;return Object.keys(t).forEach(function(n){var r=t[n];r&&Array.isArray(r)?r.forEach(function(t){return e.append(n,t.toString())}):e.append(n,r.toString())}),e}(o).toString()).length>0){var s="?";-1!=n.url.indexOf("?")&&(s="&"==n.url[n.url.length-1]?"":"&"),n.url=i+s+a}}return n._body=e.body,n.method=r(e.method),n.headers=new g(e.headers),n.contentType=n.detectContentType(),n.withCredentials=e.withCredentials,n.responseType=e.responseType,n}return Object(u.__extends)(e,t),e.prototype.detectContentType=function(){switch(this.headers.get("content-type")){case"application/json":return m.JSON;case"application/x-www-form-urlencoded":return m.FORM;case"multipart/form-data":return m.FORM_DATA;case"text/plain":case"text/html":return m.TEXT;case"application/octet-stream":return this._body instanceof k?m.ARRAY_BUFFER:m.BLOB;default:return this.detectContentTypeFromBody()}},e.prototype.detectContentTypeFromBody=function(){return null==this._body?m.NONE:this._body instanceof S?m.FORM:this._body instanceof F?m.FORM_DATA:this._body instanceof R?m.BLOB:this._body instanceof k?m.ARRAY_BUFFER:this._body&&"object"==typeof this._body?m.JSON:m.TEXT},e.prototype.getBody=function(){switch(this.contentType){case m.JSON:case m.FORM:return this.text();case m.FORM_DATA:return this._body;case m.TEXT:return this.text();case m.BLOB:return this.blob();case m.ARRAY_BUFFER:return this.arrayBuffer();default:return null}},e}(A),I=function(){},D="object"==typeof window?window:I,F=D.FormData||I,R=D.Blob||I,k=D.ArrayBuffer||I,U=function(){function t(t,e){this._backend=t,this._defaultOptions=e}return t.prototype.request=function(t,e){var n;if("string"==typeof t)n=o(this._backend,new L(a(this._defaultOptions,e,d.Get,t)));else{if(!(t instanceof L))throw new Error("First argument must be a url string or Request instance.");n=o(this._backend,t)}return n},t.prototype.get=function(t,e){return this.request(new L(a(this._defaultOptions,e,d.Get,t)))},t.prototype.post=function(t,e,n){return this.request(new L(a(this._defaultOptions.merge(new O({body:e})),n,d.Post,t)))},t.prototype.put=function(t,e,n){return this.request(new L(a(this._defaultOptions.merge(new O({body:e})),n,d.Put,t)))},t.prototype.delete=function(t,e){return this.request(new L(a(this._defaultOptions,e,d.Delete,t)))},t.prototype.patch=function(t,e,n){return this.request(new L(a(this._defaultOptions.merge(new O({body:e})),n,d.Patch,t)))},t.prototype.head=function(t,e){return this.request(new L(a(this._defaultOptions,e,d.Head,t)))},t.prototype.options=function(t,e){return this.request(new L(a(this._defaultOptions,e,d.Options,t)))},t}(),j=function(){return function(){}}()},function(t,e,n){"use strict";n.d(e,"a",function(){return i}),e.b=function(t,e){return function(){return function(t,e){var n=new i,o=t.win(),a=t.doc();return t.timeout(function(){o.addEventListener("online",function(t){n.publish("app:online",t)},!1),o.addEventListener("offline",function(t){n.publish("app:offline",t)},!1),o.addEventListener("orientationchange",function(t){n.publish("app:rotated",t)}),o.addEventListener("statusTap",function(){var n=a.elementFromPoint(t.width()/2,t.height()/2);if(n){var i=n.closest(".scroll-content");if(i){var o=i.style,s=new r.a(null,t,e);s._el=i,o.WebkitBackfaceVisibility="hidden",o.WebkitTransform="translate3d(0,0,0)",e.write(function(){function e(){o.overflow="",o.WebkitBackfaceVisibility="",o.WebkitTransform=""}o.overflow="hidden";var n=t.timeout(function(){e()},400);s.scrollTo(0,0,300).then(function(){t.cancelTimeout(n),e()})})}}})},2e3),n}(t,e)}};var r=n(151),i=function(){function t(){this._channels=[]}return t.prototype.subscribe=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this._channels[t]||(this._channels[t]=[]),n.forEach(function(n){e._channels[t].push(n)})},t.prototype.unsubscribe=function(t,e){void 0===e&&(e=null);var n=this._channels[t];if(!n)return!1;if(!e)return delete this._channels[t],!0;var r=n.indexOf(e);return!(r<0)&&(n.splice(r,1),n.length||delete this._channels[t],!0)},t.prototype.publish=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=this._channels[t];if(!r)return null;var i=[];return r.forEach(function(t){i.push(t.apply(void 0,e))}),i},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(27),i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.buildHammer=function(t){var e=new window.Hammer(t);for(var n in this.overrides)e.get(n).set(this.overrides[n]);return e},e}(r.g)},function(t,e,n){"use strict";n.d(e,"a",function(){return a}),e.b=function(){return o};var r=n(0),i=n(171),o={core:{settings:{mode:"md",keyboardHeight:290}},mobile:{},phablet:{isMatch:function(t){var e=Math.min(t.width(),t.height()),n=Math.max(t.width(),t.height());return e>390&&e<520&&n>620&&n<800}},tablet:{isMatch:function(t){var e=Math.min(t.width(),t.height()),n=Math.max(t.width(),t.height());return e>460&&e<820&&n>780&&n<1400}},android:{superset:"mobile",subsets:["phablet","tablet"],settings:{activator:function(t){if(t.testNavigatorPlatform("linux")){var e=t.matchUserAgentVersion(/Chrome\/(\d+).(\d+)?/);if(e)return parseInt(e.major,10)<36||t.version().major<5?"none":"ripple";if(t.version().major<5)return"none"}return"ripple"},autoFocusAssist:"immediate",inputCloning:!0,scrollAssist:!0,hoverCSS:!1,keyboardHeight:300,mode:"md"},isMatch:function(t){return t.isPlatformMatch("android",["android","silk"],["windows phone"])},versionParser:function(t){return t.matchUserAgentVersion(/Android (\d+).(\d+)?/)}},ios:{superset:"mobile",subsets:["ipad","iphone"],settings:{autoFocusAssist:"delay",hideCaretOnScroll:!0,hoverCSS:!1,inputBlurring:i.c,inputCloning:i.c,keyboardHeight:250,mode:"ios",statusbarPadding:i.a,swipeBackEnabled:i.c,tapPolyfill:i.d,virtualScrollEventAssist:i.d,disableScrollAssist:i.c,scrollAssist:i.c,keyboardResizes:function(t){var e=t.win();return!(!e.Ionic||!0!==e.Ionic.keyboardResizes)}},isMatch:function(t){return t.isPlatformMatch("ios",["iphone","ipad","ipod"],["windows phone"])},versionParser:function(t){return t.matchUserAgentVersion(/OS (\d+)_(\d+)?/)}},ipad:{superset:"tablet",settings:{keyboardHeight:500},isMatch:function(t){return t.isPlatformMatch("ipad")}},iphone:{subsets:["phablet"],isMatch:function(t){return t.isPlatformMatch("iphone")}},windows:{superset:"mobile",subsets:["phablet","tablet"],settings:{mode:"wp",autoFocusAssist:"immediate",hoverCSS:!1},isMatch:function(t){return t.isPlatformMatch("windows",["windows phone"])},versionParser:function(t){return t.matchUserAgentVersion(/Windows Phone (\d+).(\d+)?/)}},cordova:{isEngine:!0,initialize:function(t){t.prepareReady=function(){t.windowLoad(function(e,n){n.addEventListener("deviceready",function(){n.addEventListener("backbutton",function(e){t.zone.run(function(){t.backButton.emit(e)})}),n.addEventListener("pause",function(e){t.zone.run(function(){t.pause.emit(e)})}),n.addEventListener("resume",function(e){t.zone.run(function(){t.resume.emit(e)})}),t.exitApp=function(){e.navigator.app.exitApp()},t.triggerReady("cordova")})})}},isMatch:function(t){return Object(i.a)(t)}},electron:{superset:"core",initialize:function(t){t.prepareReady=function(){t.windowLoad(function(){t.triggerReady("electron")})}},isMatch:function(t){return Object(i.b)(t)}}},a=new r.n("PLTCONFIG")},function(t,e,n){"use strict";function r(t,e){if(!e||!e.parentNode)return!0;if(!t)return!1;if(t.defaultPrevented)return!0;for(var n=t.target,r=0;r<4&&n;r++){if(n.hasAttribute("disable-activated"))return!0;n=n.parentElement}return!1}function i(t){for(var e=t,n=0;n<10&&e;n++){if(function(t){if(f.indexOf(t.tagName)>-1)return!0;for(var e=0,n=m.length;e<n;e++)if(t.hasAttribute&&t.hasAttribute(m[e]))return!0;return!1}(e))return e;e=e.parentElement}return null}n(0);var o=function(){function t(t,e,n){this.app=t,this.dom=n,this._queue=[],this._active=[],this.activatedDelay=a,this.clearDelay=s,this._css=e.get("activatedClass","activated")}return t.prototype.clickAction=function(t,e,n){if(!r(t,e)){this._scheduleClear(),this._queue.length=0;for(var i=0;i<this._active.length;i++)this._active[i].classList.remove(this._css);this._active.length=0,e&&e.parentNode&&(this._active.push(e),e.classList.add(this._css))}},t.prototype.downAction=function(t,e,n){var i=this;r(t,e)||(this.unscheduleClear(),this.deactivate(!0),this._queue.push(e),this._activeDefer=this.dom.write(function(){i._activeDefer=null;for(var t,e=0;e<i._queue.length;e++)i._active.push(t=i._queue[e]),t.classList.add(i._css);i._queue.length=0},this.activatedDelay))},t.prototype.upAction=function(t,e,n){this._scheduleClear()},t.prototype._scheduleClear=function(){var t=this;this._clearDefer||(this._clearDefer=this.dom.write(function(){t.clearState(!0),t._clearDefer=null},this.clearDelay))},t.prototype.unscheduleClear=function(){this._clearDefer&&(this._clearDefer(),this._clearDefer=null)},t.prototype.clearState=function(t){var e=this;this.app.isEnabled()?this.deactivate(t):this.dom.write(function(){e.clearState(t)},600)},t.prototype.deactivate=function(t){this._clearDeferred(),this._queue.length=0;for(var e,n=0;n<this._active.length;n++)(e=this._active[n]).style[this.dom.plt.Css.transition]=t?"":"none",e.classList.remove(this._css);this._active.length=0},t.prototype._clearDeferred=function(){this._activeDefer&&(this._activeDefer(),this._activeDefer=null)},t}(),a=80,s=80,l=(n(8),n(1),n(9),n(7),n(3),n(11)),u=n(144),c=function(){function t(t,e,n){this.dom=n,this.highlight=new o(t,e,n)}return t.prototype.clickAction=function(t,e,n){this.highlight&&this.highlight.clickAction(t,e,n),this._clickAction(t,e,n)},t.prototype.downAction=function(t,e,n){this.highlight&&this.highlight.downAction(t,e,n),this._downAction(t,e,n)},t.prototype.upAction=function(t,e,n){this.highlight&&this.highlight.upAction(t,e,n),this._upAction(t,e,n)},t.prototype.clearState=function(t){this.highlight&&this.highlight.clearState(t)},t.prototype._downAction=function(t,e,n){if(!r(t,e))for(var i=e.childElementCount;i--;){var o=e.children[i];if(o.classList.contains("button-effect")){var a=e.getBoundingClientRect();o.$top=a.top,o.$left=a.left,o.$width=a.width,o.$height=a.height;break}}},t.prototype._upAction=function(t,e,n){if(!Object(l.d)(6,n,Object(l.f)(t)))for(var r=e.childElementCount;r--;){var i=e.children[r];if(i.classList.contains("button-effect")){this.startRippleEffect(i,e,n);break}}},t.prototype._clickAction=function(t,e,n){},t.prototype.startRippleEffect=function(t,e,n){if(n){var r=n.x-t.$left,i=n.y-t.$top,o=2*Math.max(Math.abs(t.$width-r),r),a=2*Math.max(Math.abs(t.$height-i),i),s=Math.min(Math.max(Math.hypot(o,a),64),240);e.hasAttribute("ion-item")&&(s=Math.min(s,140)),r-=s/2,i-=s/2,r=Math.round(r),i=Math.round(i),s=Math.round(s);var l=this.dom.plt.Css;t.style.opacity="",t.style[l.transform]="translate3d("+r+"px, "+i+"px, 0px) scale(0.001)",t.style[l.transition]="";var u=Math.sqrt(t.$width+t.$height),c=Math.max(1600*Math.sqrt(u/h)+.5,260),p=Math.round(.7*c),d=Math.round(c-p),f="translate3d("+r+"px, "+i+"px, 0px) scale(1)",m="transform "+(c=Math.round(c))+"ms,opacity "+p+"ms "+d+"ms";this.dom.write(function(){t.style.width=t.style.height=s+"px",t.style.opacity="0",t.style[l.transform]=f,t.style[l.transition]=m},16)}},t}(),h=300,p=n(30);n.d(e,"a",function(){return d}),e.b=function(t,e,n,r,i){return function(){return new d(t,e,n,r,i)}};var d=function(){function t(t,e,n,r,i){this.plt=e,this.app=r,this.gestureCtrl=i,this.disableClick=0,this.events=new p.a(e);var a=t.get("activator");"ripple"===a?this.activator=new c(r,t,n):"highlight"===a&&(this.activator=new o(r,t,n)),this.usePolyfill=t.getBoolean("tapPolyfill");var s=e.doc();this.events.listen(s,"click",this.click.bind(this),{passive:!1,capture:!0}),this.pointerEvents=this.events.pointerEvents({element:s,pointerDown:this.pointerStart.bind(this),pointerMove:this.pointerMove.bind(this),pointerUp:this.pointerEnd.bind(this),passive:!0}),this.pointerEvents.mouseWait=g}return t.prototype.pointerStart=function(t){return!this.startCoord&&(!!this.app.isEnabled()&&(this.lastTouchEnd=0,this.dispatchClick=!0,this.plt.doc()===t.target?(this.startCoord=Object(l.f)(t),!0):(this.activatableEle=i(t.target),this.activatableEle?(this.startCoord=Object(l.f)(t),this.activator&&this.activator.downAction(t,this.activatableEle,this.startCoord),!0):(this.startCoord=null,!1))))},t.prototype.pointerMove=function(t){this.startCoord&&this.shouldCancelEvent(t)&&this.pointerCancel(t)},t.prototype.pointerEnd=function(t,e){if(this.dispatchClick&&this.startCoord){if(this.activator&&t.target!==this.plt.doc()){var n=i(t.target)||this.activatableEle;n&&this.activator.upAction(t,n,this.startCoord)}this.usePolyfill&&e===u.a&&this.app.isEnabled()&&this.handleTapPolyfill(t),this.startCoord=null,this.activatableEle=null}},t.prototype.pointerCancel=function(t){this.startCoord=null,this.activatableEle=null,this.dispatchClick=!1,this.activator&&this.activator.clearState(!1),this.pointerEvents.stop()},t.prototype.shouldCancelEvent=function(t){return this.app.isScrolling()||this.gestureCtrl.isCaptured()||Object(l.d)(v,this.startCoord,Object(l.f)(t))},t.prototype.click=function(t){if(this.shouldCancelClick(t))return t.preventDefault(),void t.stopPropagation();if(this.activator&&this.plt.doc()!==t.target){var e=i(t.target);e&&this.activator.clickAction(t,e,this.startCoord)}},t.prototype.shouldCancelClick=function(t){if(this.usePolyfill){if(!t.isIonicTap&&this.isDisabledNativeClick())return!0}else if(!this.dispatchClick)return!0;return!this.app.isEnabled()||!!this.gestureCtrl.isCaptured()},t.prototype.profileClickDelay=function(t){if(this.lastTouchEnd){var e=Date.now()-this.lastTouchEnd;e<100||console.warn("SLOW click dispatched. Delay(ms):",e,t),this.lastTouchEnd=null}},t.prototype.handleTapPolyfill=function(t){var e=Object(l.f)(t);if(!Object(l.d)(v,this.startCoord,e))if(this.disableClick=Date.now()+g,this.app.isScrolling());else{var n=this.plt.doc().createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,this.plt.win(),1,0,0,e.x,e.y,!1,!1,!1,!1,0,null),n.isIonicTap=!0,t.target.dispatchEvent(n)}},t.prototype.isDisabledNativeClick=function(){return this.disableClick>Date.now()},t}(),f=["A","BUTTON"],m=["tappable","ion-button"],v=100,g=2500},function(t,e,n){"use strict";e.a=function(t){return function(){t.setModeConfig("ios",r),t.setModeConfig("md",i),t.setModeConfig("wp",o)}};var r={activator:"highlight",actionSheetEnter:"action-sheet-slide-in",actionSheetLeave:"action-sheet-slide-out",alertEnter:"alert-pop-in",alertLeave:"alert-pop-out",backButtonText:"Back",backButtonIcon:"ios-arrow-back",iconMode:"ios",loadingEnter:"loading-pop-in",loadingLeave:"loading-pop-out",menuType:"reveal",modalEnter:"modal-slide-in",modalLeave:"modal-slide-out",pageTransition:"ios-transition",pickerEnter:"picker-slide-in",pickerLeave:"picker-slide-out",pickerRotateFactor:-.46,pickerScaleFactor:1,popoverEnter:"popover-pop-in",popoverLeave:"popover-pop-out",spinner:"ios",tabsHighlight:!1,tabsPlacement:"bottom",tabsHideOnSubPages:!1,toastEnter:"toast-slide-in",toastLeave:"toast-slide-out"},i={activator:"ripple",actionSheetEnter:"action-sheet-md-slide-in",actionSheetLeave:"action-sheet-md-slide-out",alertEnter:"alert-md-pop-in",alertLeave:"alert-md-pop-out",backButtonText:"",backButtonIcon:"md-arrow-back",iconMode:"md",loadingEnter:"loading-md-pop-in",loadingLeave:"loading-md-pop-out",menuType:"overlay",modalEnter:"modal-md-slide-in",modalLeave:"modal-md-slide-out",pageTransition:"md-transition",pickerEnter:"picker-slide-in",pickerLeave:"picker-slide-out",pickerRotateFactor:0,pickerScaleFactor:.81,popoverEnter:"popover-md-pop-in",popoverLeave:"popover-md-pop-out",spinner:"crescent",tabsHighlight:!1,tabsPlacement:"bottom",tabsHideOnSubPages:!1,toastEnter:"toast-md-slide-in",toastLeave:"toast-md-slide-out"},o={activator:"highlight",actionSheetEnter:"action-sheet-wp-slide-in",actionSheetLeave:"action-sheet-wp-slide-out",alertEnter:"alert-wp-pop-in",alertLeave:"alert-wp-pop-out",backButtonText:"",backButtonIcon:"ios-arrow-back",iconMode:"ios",loadingEnter:"loading-wp-pop-in",loadingLeave:"loading-wp-pop-out",menuType:"overlay",modalEnter:"modal-md-slide-in",modalLeave:"modal-md-slide-out",pageTransition:"wp-transition",pickerEnter:"picker-slide-in",pickerLeave:"picker-slide-out",pickerRotateFactor:0,pickerScaleFactor:.81,popoverEnter:"popover-md-pop-in",popoverLeave:"popover-md-pop-out",spinner:"circles",tabsHighlight:!1,tabsPlacement:"top",tabsHideOnSubPages:!0,toastEnter:"toast-wp-slide-in",toastLeave:"toast-wp-slide-out"}},function(t,e,n){"use strict";n(19)},function(t,e,n){"use strict";n(19)},function(t,e,n){"use strict";n.d(e,"a",function(){return i});n(1);var r=n(99),i=(n(12),function(){function t(t,e,n){this._app=t,this.config=e,this._deepLinker=n}return t.prototype.create=function(t,e,n){return void 0===e&&(e={}),void 0===n&&(n={}),new r.a(this._app,t,e,n,this.config,this._deepLinker)},t}())},function(t,e,n){"use strict";var r=n(166),i=n(2),o=n(65),a=n(15),s=n(38),l=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.mdPositionView=function(t,e){var n="top",r="left",i=t.querySelector(".popover-wrapper"),o=t.querySelector(".popover-content"),a=o.getBoundingClientRect(),s=a.width,l=a.height,u=this.plt.width(),c=this.plt.height(),h=e&&e.target&&e.target.getBoundingClientRect(),p=h&&"top"in h?h.top:c/2-l/2,d=h&&h.height||0,f={top:p,left:h&&"left"in h?h.left:u/2-s/2};f.left<m?f.left=m:s+m+f.left>u&&(f.left=u-s-m,r="right"),p+d+l>c&&p-l>0?(f.top=p-l,t.className=t.className+" popover-bottom",n="bottom"):p+d+l>c&&(o.style.bottom=m+"px"),o.style.top=f.top+"px",o.style.left=f.left+"px",o.style[this.plt.Css.transformOrigin]=n+" "+r,i.style.opacity="1"},e.prototype.iosPositionView=function(t,e){var n="top",r="left",i=t.querySelector(".popover-wrapper"),o=t.querySelector(".popover-content"),a=o.getBoundingClientRect(),s=a.width,l=a.height,u=this.plt.width(),c=this.plt.height(),h=e&&e.target&&e.target.getBoundingClientRect(),p=h&&"top"in h?h.top:c/2-l/2,d=h&&"left"in h?h.left:u/2,m=h&&h.width||0,v=h&&h.height||0,g=t.querySelector(".popover-arrow"),y=g.getBoundingClientRect(),b=y.width,_=y.height;h||(g.style.display="none");var x={top:p+v,left:d+m/2-b/2},w={top:p+v+(_-1),left:d+m/2-s/2},S=!1,A=!1;w.left<f+25?(S=!0,w.left=f):s+f+w.left+25>u&&(A=!0,w.left=u-s-f,r="right"),p+v+l>c&&p-l>0?(x.top=p-(_+1),w.top=p-l-(_-1),t.className=t.className+" popover-bottom",n="bottom"):p+v+l>c&&(o.style.bottom=f+"%"),g.style.top=x.top+"px",g.style.left=x.left+"px",o.style.top=w.top+"px",o.style.left=w.left+"px",S&&(CSS.supports("left","constant(safe-area-inset-left)")?o.style.left="calc("+w.left+"px + constant(safe-area-inset-left)":CSS.supports("left","env(safe-area-inset-left)")&&(o.style.left="calc("+w.left+"px + env(safe-area-inset-left)")),A&&(CSS.supports("right","constant(safe-area-inset-right)")?o.style.left="calc("+w.left+"px - constant(safe-area-inset-right)":CSS.supports("right","env(safe-area-inset-right)")&&(o.style.left="calc("+w.left+"px - env(safe-area-inset-right)")),o.style[this.plt.Css.transformOrigin]=n+" "+r,i.style.opacity="1"},e}(s.a),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.init=function(){var t=this.enteringView.pageRef().nativeElement,e=new a.a(this.plt,t.querySelector("ion-backdrop")),n=new a.a(this.plt,t.querySelector(".popover-wrapper"));n.fromTo("opacity",.01,1),e.fromTo("opacity",.01,.08),this.easing("ease").duration(100).add(e).add(n)},e.prototype.play=function(){var e=this;this.plt.raf(function(){e.iosPositionView(e.enteringView.pageRef().nativeElement,e.opts.ev),t.prototype.play.call(e)})},e}(u),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.init=function(){var t=this.leavingView.pageRef().nativeElement,e=new a.a(this.plt,t.querySelector("ion-backdrop")),n=new a.a(this.plt,t.querySelector(".popover-wrapper"));n.fromTo("opacity",.99,0),e.fromTo("opacity",.08,0),this.easing("ease").duration(500).add(e).add(n)},e}(u),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.init=function(){var t=this.enteringView.pageRef().nativeElement,e=new a.a(this.plt,t.querySelector(".popover-content")),n=new a.a(this.plt,t.querySelector(".popover-viewport"));e.fromTo("scale",.001,1),n.fromTo("opacity",.01,1),this.easing("cubic-bezier(0.36,0.66,0.04,1)").duration(300).add(e).add(n)},e.prototype.play=function(){var e=this;this.plt.raf(function(){e.mdPositionView(e.enteringView.pageRef().nativeElement,e.opts.ev),t.prototype.play.call(e)})},e}(u),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.init=function(){var t=this.leavingView.pageRef().nativeElement,e=new a.a(this.plt,t.querySelector(".popover-wrapper"));e.fromTo("opacity",.99,0),this.easing("ease").duration(500).fromTo("opacity",.01,1).add(e)},e}(u),f=2,m=12,v=n(4),g=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),y=function(t){function e(e,n,r,a,s){void 0===r&&(r={}),void 0===a&&(a={});var l=this;return a.showBackdrop=!Object(i.l)(a.showBackdrop)||!!a.showBackdrop,a.enableBackdropDismiss=!Object(i.l)(a.enableBackdropDismiss)||!!a.enableBackdropDismiss,r.component=n,r.opts=a,l=t.call(this,o.a,r,null)||this,l._app=e,l.isOverlay=!0,s.setTransition("popover-pop-in",c),s.setTransition("popover-pop-out",h),s.setTransition("popover-md-pop-in",p),s.setTransition("popover-md-pop-out",d),l}return g(e,t),e.prototype.getTransitionName=function(t){return this._nav&&this._nav.config.get("back"===t?"popoverLeave":"popoverEnter")},e.prototype.present=function(t){return void 0===t&&(t={}),this._app.present(this,t)},e}(v.a);n.d(e,"a",function(){return _});var b=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_=function(t){function e(e,n,r,i,o,a){void 0===i&&(i={});var s=t.call(this,e,n,o,a)||this;return s.data=r,s.opts=i,s.isOverlay=!0,s}return b(e,t),e.prototype.getImplementation=function(){return new y(this._app,this._component,this.data,this.opts,this._config)},e}(r.a)},function(t,e,n){"use strict";n(21),n(7),n(2),n(3),n(11),n(30)},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){function t(t,e,n){if(this._plt=e,this.zone=n,this.isMatch=!1,t){this.conditions=t.replace(/\s/g,"").split(",");for(var r=0;r<this.conditions.length;r++)if(this.conditions[r]&&e.is(this.conditions[r]))return void(this.isMatch=!0);this.orientation()&&(this.resizeObs=e.resize.subscribe(this.orientation.bind(this)))}}return t.prototype.orientation=function(){for(var t=0;t<this.conditions.length;t++){if("portrait"===this.conditions[t])return this.isMatch=this._plt.isPortrait(),!0;if("landscape"===this.conditions[t])return this.isMatch=this._plt.isLandscape(),!0}return!1},t.prototype.ngOnDestroy=function(){this.resizeObs&&this.resizeObs.unsubscribe(),this.resizeObs=null},t}()},function(t,e,n){"use strict";n(0),n(1),n(171),n(6),n(2),Date.now(),n(3),n(4),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}}()},function(t,e,n){"use strict";var r=n(158);n.n(r),n(1),n(12),n(6),n(2),n(24),n(19),n(29),n(47),n(3),n(104),n(4),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}}()},function(t,e,n){"use strict";n(9)},function(t,e,n){"use strict"},function(t,e,n){"use strict"},function(t,e,n){"use strict"},,function(t,e,n){"use strict";n.d(e,"a",function(){return l}),n.d(e,"b",function(){return u}),e.c=function(t){return new l(t||{name:"_ionicstorage",storeName:"_ionickv",driverOrder:["sqlite","indexeddb","websql","localstorage"]})};var r=n(0),i=n(237),o=n.n(i),a=n(238),s=n.n(a),l=function(){function t(t){var e=this;this._driver=null,this._dbPromise=new Promise(function(n,r){var i,a={name:"_ionicstorage",storeName:"_ionickv",driverOrder:["sqlite","indexeddb","websql","localstorage"]},l=Object.assign(a,t||{});o.a.defineDriver(s.a).then(function(){i=o.a.createInstance(l)}).then(function(){return i.setDriver(e._getDriverOrder(l.driverOrder))}).then(function(){e._driver=i.driver(),n(i)}).catch(function(t){return r(t)})})}return Object.defineProperty(t.prototype,"driver",{get:function(){return this._driver},enumerable:!0,configurable:!0}),t.prototype.ready=function(){return this._dbPromise},t.prototype._getDriverOrder=function(t){return t.map(function(t){switch(t){case"sqlite":return s.a._driver;case"indexeddb":return o.a.INDEXEDDB;case"websql":return o.a.WEBSQL;case"localstorage":return o.a.LOCALSTORAGE}})},t.prototype.get=function(t){return this._dbPromise.then(function(e){return e.getItem(t)})},t.prototype.set=function(t,e){return this._dbPromise.then(function(n){return n.setItem(t,e)})},t.prototype.remove=function(t){return this._dbPromise.then(function(e){return e.removeItem(t)})},t.prototype.clear=function(){return this._dbPromise.then(function(t){return t.clear()})},t.prototype.length=function(){return this._dbPromise.then(function(t){return t.length()})},t.prototype.keys=function(){return this._dbPromise.then(function(t){return t.keys()})},t.prototype.forEach=function(t){return this._dbPromise.then(function(e){return e.iterate(t)})},t}(),u=new r.n("STORAGE_CONFIG_TOKEN")},function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(1);var r=n(6),i=(n(41),n(52),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),o=function(t){function e(e,n,r,i,o){var a=t.call(this,e,n,r,"title")||this;return i&&i._setTitle(a),o&&o._setTitle(a),a}return i(e,t),e.prototype.getTitleText=function(){return this._elementRef.nativeElement.textContent},e}(r.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(109),i=function(){function t(){}return t.forRoot=function(e){return void 0===e&&(e=null),{ngModule:t,providers:[{provide:r.b,useValue:e},{provide:r.a,useFactory:r.c,deps:[r.b]}]}},t}()},function(t,e,n){"use strict";function r(t,e,n){return"path"===n.get("locationStrategy")?new o.q(t,e):new o.e(t,e)}n.d(e,"a",function(){return D}),n.d(e,"b",function(){return F}),e.c=r;var i=n(0),o=n(16),a=n(27),s=n(8),l=n(45),u=n(1),c=n(12),h=n(9),p=n(91),d=n(13),f=n(7),m=n(92),v=n(25),g=n(24),y=n(36),b=n(89),_=n(3),x=n(93),w=n(94),S=n(95),A=n(31),M=n(47),T=(n(58),n(69)),C=(n(59),n(70)),E=(n(169),n(82),n(145),n(23),n(146),n(20),n(122),n(123),n(124),n(147),n(148),n(153),n(21),n(154),n(53),n(113),n(75),n(125),n(126),n(127),n(40),n(156),n(86),n(157),n(114),n(18),n(71),n(159),n(128),n(87),n(42),n(160),n(62),n(43),n(54),n(76),n(63),n(88)),P=(n(162),n(163),n(26)),O=(n(129),n(64),n(72)),N=(n(49),n(96),n(172),n(97),n(173),n(174),n(77),n(61),n(48),n(60)),L=(n(65),n(98)),I=(n(66),n(50),n(115),n(116),n(100),n(175),n(176),n(117),n(130),n(118),n(67),n(74),n(177),n(178),n(179),n(102),n(55),n(35),n(180),n(181),n(104),n(103),n(131),n(68),n(73)),D=(n(119),n(132),n(120),n(52),n(121),n(110),n(41),n(182),n(105),n(106),n(107),n(183),function(){function t(){}return t.forRoot=function(e,n,D){return void 0===n&&(n=null),void 0===D&&(D=null),{ngModule:t,providers:[{provide:l.a,useValue:e},{provide:u.b,useValue:n},{provide:M.a,useValue:D},{provide:o.a,useValue:"/"},{provide:x.a,useFactory:x.b},{provide:_.a,useFactory:_.b,deps:[a.b,x.a,i.u]},{provide:u.a,useFactory:u.c,deps:[u.b,_.a]},{provide:i.c,useFactory:S.a,deps:[u.a],multi:!0},{provide:i.c,useFactory:p.b,deps:[_.a,h.a],multi:!0},{provide:i.c,useFactory:w.b,deps:[u.a,_.a,h.a,s.a,f.l],multi:!0},{provide:i.c,useFactory:y.d,deps:[u.a,M.a,y.b,i.u],multi:!0},{provide:a.f,useClass:m.a},{provide:i.a,useValue:e,multi:!0},T.a,C.a,s.a,h.a,p.a,d.a,f.l,v.a,g.a,E.a,o.f,P.a,O.a,b.a,N.a,L.a,w.a,I.a,A.a,{provide:y.b,useFactory:y.c,deps:[b.a,i.o]},{provide:o.g,useFactory:r,deps:[o.r,[new i.m(o.a),new i.v],u.a]},{provide:M.b,useFactory:M.d,deps:[s.a,M.a]},{provide:c.a,useFactory:c.b,deps:[s.a,M.b,o.f,y.b,i.i]}]}},t}()),F=function(){function t(){}return t.forChild=function(e){return{ngModule:t,providers:[{provide:y.a,useValue:e},{provide:i.a,useValue:e,multi:!0}]}},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return i});n(3);var r=n(30),i=(n(53),n(75),function(){function t(t){this._listsActive=!1,this._events=new r.a(t)}return t.prototype.ngAfterContentInit=function(){var t=this._mainButton;t&&t.getNativeElement()?this._events.listen(t.getNativeElement(),"click",this.clickHandler.bind(this),{zone:!0}):console.error("FAB container needs a main <button ion-fab>")},t.prototype.clickHandler=function(t){this.canActivateList(t)&&this.toggleList()},t.prototype.canActivateList=function(t){if(this._fabLists.length>0&&this._mainButton&&t.target){var e=t.target.closest("ion-fab>[ion-fab]");return e&&e===this._mainButton.getNativeElement()}return!1},t.prototype.toggleList=function(){this.setActiveLists(!this._listsActive)},t.prototype.setActiveLists=function(t){if(t!==this._listsActive){for(var e=0,n=this._fabLists.toArray();e<n.length;e++){n[e].setVisible(t)}this._mainButton.setActiveClose(t),this._listsActive=t}},t.prototype.close=function(){this.setActiveLists(!1)},t.prototype.ngOnDestroy=function(){this._events.destroy()},t}())},function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r=n(0),i=n(44),o=n(158),a=(n.n(o),n(1),n(21),n(11)),s=(n(9),n(13),n(32)),l=n(2),u=(n(3),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),c=function(t){function e(e,n,o,a,s,l,u,c,h,p){var d=t.call(this,e,s,l,"input","",o,c,h)||this;if(d._plt=n,d._app=a,d._content=u,d.ngControl=h,d._dom=p,d._clearInput=!1,d._readonly=!1,d._type="text",d._isTextarea=!1,d._onDestroy=new i.Subject,d._useAssist=!1,d._relocated=!1,d.autocomplete="",d.autocorrect="",d.placeholder="",d.min=null,d.max=null,d.step=null,d.input=new r.l,d.blur=new r.l,d.focus=new r.l,d.autocomplete=e.get("autocomplete","off"),d.autocorrect=e.get("autocorrect","off"),d._autoFocusAssist=e.get("autoFocusAssist","delay"),d._keyboardHeight=e.getNumber("keyboardHeight"),d._isTextarea=!("ION-TEXTAREA"!==s.nativeElement.tagName),d._isTextarea&&c&&c.setElementClass("item-textarea",!0),!u)return d;e.getBoolean("hideCaretOnScroll",!1)&&d._enableHideCaretOnScroll();var f=n.win();if(f.Ionic&&f.Ionic.keyboardPlugin){e.getBoolean("keyboardResizes",!1)?(d._keyboardHeight=e.getNumber("keyboardSafeArea",60),d._enableScrollMove()):(d._enableScrollPadding(),d._enableScrollMove())}else{d._useAssist=e.getBoolean("scrollAssist",!1);e.getBoolean("scrollPadding",d._useAssist)&&d._enableScrollPadding()}return d}return u(e,t),Object.defineProperty(e.prototype,"clearInput",{get:function(){return this._clearInput},set:function(t){this._clearInput=!this._isTextarea&&Object(l.o)(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._isTextarea?"text":this._type},set:function(t){this._type=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readonly",{get:function(){return this._readonly},set:function(t){this._readonly=Object(l.o)(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clearOnEdit",{get:function(){return this._clearOnEdit},set:function(t){this._clearOnEdit=Object(l.o)(t)},enumerable:!0,configurable:!0}),e.prototype.ngAfterContentInit=function(){},e.prototype.ngAfterViewInit=function(){!1!==this.clearOnEdit&&"password"===this.type&&(this.clearOnEdit=!0);var t=this._elementRef.nativeElement,e=this._native.nativeElement;if(Object(a.b)(t,e),t.hasAttribute("tabIndex")&&t.removeAttribute("tabIndex"),t.hasAttribute("autofocus"))switch(t.removeAttribute("autofocus"),this._autoFocusAssist){case"immediate":e.focus();break;case"delay":this._plt.timeout(function(){return e.focus()},800)}this._initialize(),this.focus.observers.length>0&&console.warn("(focus) is deprecated in ion-input, use (ionFocus) instead"),this.blur.observers.length>0&&console.warn("(blur) is deprecated in ion-input, use (ionBlur) instead")},e.prototype.ngOnDestroy=function(){t.prototype.ngOnDestroy.call(this),this._onDestroy.next(),this._onDestroy=null},e.prototype.initFocus=function(){this.setFocus()},e.prototype.setFocus=function(){this.isFocus()||this._native.nativeElement.focus()},e.prototype.setBlur=function(){this.isFocus()&&this._native.nativeElement.blur()},e.prototype.onInput=function(t){this.value=t.target.value,this.input.emit(t)},e.prototype.onBlur=function(t){this._fireBlur(),this.blur.emit(t),this._scrollData=null,this._clearOnEdit&&this.hasValue()&&(this._didBlurAfterEdit=!0)},e.prototype.onFocus=function(t){this._fireFocus(),this.focus.emit(t)},e.prototype.onKeydown=function(t){t&&this._clearOnEdit&&this.checkClearOnEdit(t.target.value)},e.prototype._inputUpdated=function(){t.prototype._inputUpdated.call(this);var e=this._native.nativeElement,n=this._value;e.value!==n&&(e.value=n)},e.prototype.clearTextInput=function(){this.value=""},e.prototype.checkClearOnEdit=function(t){this._clearOnEdit&&(this._didBlurAfterEdit&&this.hasValue()&&this.clearTextInput(),this._didBlurAfterEdit=!1)},e.prototype._getScrollData=function(){if(!this._content)return{scrollAmount:0,scrollTo:0,scrollPadding:0,scrollDuration:0,inputSafeY:0};if(this._scrollData)return this._scrollData;var t=this._elementRef.nativeElement;return t=t.closest("ion-item,[ion-item]")||t,this._scrollData=function(t,e,n,r,i){var o=t+n.contentTop-n.scrollTop,a=o+e,s=n.contentTop,l=(i-r-s)/2,u=s+l,c=o>=s&&o<=u,p=o<s,d=o>u,f=a>=s&&a<=u,m=a>u,v={scrollAmount:0,scrollTo:0,scrollPadding:0,scrollDuration:0,inputSafeY:0};if(v.scrollPadding=r,c&&f)return v;(d||m||p)&&(v.scrollAmount=l>e?Math.round(u-a):Math.round(s-o),v.inputSafeY=4-(o-s),p&&v.scrollAmount>e&&(v.scrollAmount=e)),v.scrollTo=n.scrollTop-v.scrollAmount;var g=Math.abs(v.scrollAmount)/h;return v.scrollDuration=Math.min(400,Math.max(150,g)),v}(t.offsetTop,t.offsetHeight,this._content.getContentDimensions(),this._keyboardHeight,this._plt.height())},e.prototype._relocateInput=function(t){if(this._relocated!==t){var e=this._plt,n=this.getNativeElement(),r=this._native.nativeElement;if(t){!function(t,e,n){if(e){var r=e.offsetTop,i=e.offsetLeft,o=e.offsetWidth,a=e.offsetHeight,s=e.cloneNode(!1),l=s.style;s.classList.add("cloned-input"),s.setAttribute("aria-hidden","true"),l.pointerEvents="none",l.position="absolute",l.top=r+"px",l.left=i+"px",l.width=o+"px",l.height=a+"px";var u=n.cloneNode(!1);u.value=n.value,u.tabIndex=-1,s.appendChild(u),e.parentNode.appendChild(s),e.style.pointerEvents="none"}n.style[t.Css.transform]="scale(0)"}(e,n,r);var i=this._getScrollData().inputSafeY;r.style[e.Css.transform]="translate3d("+(this._plt.isRTL?9999:-9999)+"px,"+i+"px,0)",r.style.opacity="0"}else!function(t,e,n){if(e&&e.parentElement){for(var r=e.parentElement.querySelectorAll(".cloned-input"),i=0;i<r.length;i++)r[i].parentNode.removeChild(r[i]);e.style.pointerEvents=""}n.style[t.Css.transform]="",n.style.opacity=""}(e,n,r);this._relocated=t}},e.prototype._enableScrollPadding=function(){var t=this;this.ionFocus.subscribe(function(){var e=t._content,n=t._getScrollData().scrollPadding;e.addScrollPadding(n),e.clearScrollPaddingFocusOut()})},e.prototype._enableHideCaretOnScroll=function(){function t(t){r.isFocus()&&r._dom.write(function(){return r._relocateInput(t)})}var e=this,n=this._content;n.ionScrollStart.takeUntil(this._onDestroy).subscribe(function(){return t(!0)}),n.ionScrollEnd.takeUntil(this._onDestroy).subscribe(function(){return t(!1)}),this.ionBlur.subscribe(function(){return e._relocateInput(!1)});var r=this},e.prototype._enableScrollMove=function(){var t=this;this.ionFocus.subscribe(function(){var e=t._getScrollData();Math.abs(e.scrollAmount)>4&&t._content.scrollTo(0,e.scrollTo,e.scrollDuration)})},e.prototype._pointerStart=function(t){"touchstart"===t.type&&(this._isTouch=!0),(this._isTouch||!this._isTouch&&"mousedown"===t.type)&&this._app.isEnabled()&&(this._coord=Object(a.f)(t))},e.prototype._pointerEnd=function(t){if(this._isTouch&&"mouseup"===t.type||!this._app.isEnabled())t.preventDefault(),t.stopPropagation();else if(this._coord){var e=Object(a.f)(t);Object(a.d)(8,this._coord,e)||this.isFocus()||(t.preventDefault(),t.stopPropagation(),this._jsSetFocus())}this._coord=null},e.prototype._jsSetFocus=function(){var t=this,e=this._content;e||this.setFocus();var n=this._getScrollData();Math.abs(n.scrollAmount)<4?this.setFocus():(this._relocateInput(!0),this.setFocus(),e.scrollTo(0,n.scrollTo,n.scrollDuration,function(){t._relocateInput(!1),t.setFocus()}))},e}(s.a),h=.3},function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n(2),i=(n(1),n(9),n(13),n(25),n(32)),o=(n(3),n(11)),a=n(30),s=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),l=function(t){function e(e,n,r,i,o,s,l,u,c){var h=t.call(this,i,s,l,"range",0,e,r,null)||this;return h._haptic=n,h._plt=o,h._dom=u,h._cd=c,h._min=0,h._max=100,h._step=1,h._valA=0,h._valB=0,h._ratioA=0,h._ratioB=0,h._events=new a.a(o),h}return s(e,t),Object.defineProperty(e.prototype,"min",{get:function(){return this._min},set:function(t){t=Math.round(t),isNaN(t)||(this._min=t,this._inputUpdated())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this._max},set:function(t){t=Math.round(t),isNaN(t)||(this._max=t,this._inputUpdated())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"step",{get:function(){return this._step},set:function(t){t=Math.round(t),!isNaN(t)&&t>0&&(this._step=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"snaps",{get:function(){return this._snaps},set:function(t){this._snaps=Object(r.o)(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pin",{get:function(){return this._pin},set:function(t){this._pin=Object(r.o)(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"debounce",{get:function(){return this._debouncer.wait},set:function(t){this._debouncer.wait=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dualKnobs",{get:function(){return this._dual},set:function(t){this._dual=Object(r.o)(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ratio",{get:function(){return this._dual?Math.min(this._ratioA,this._ratioB):this._ratioA},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ratioUpper",{get:function(){return this._dual?Math.max(this._ratioA,this._ratioB):null},enumerable:!0,configurable:!0}),e.prototype.ngAfterContentInit=function(){this._initialize(),this._events.pointerEvents({element:this._slider.nativeElement,pointerDown:this._pointerDown.bind(this),pointerMove:this._pointerMove.bind(this),pointerUp:this._pointerUp.bind(this),zone:!0}),this._createTicks()},e.prototype._pointerDown=function(t){if(this._disabled)return!1;this._fireFocus(),t.preventDefault(),t.stopPropagation();var e=Object(o.f)(t),n=this._rect=this._plt.getElementBoundingClientRect(this._slider.nativeElement),i=Object(r.a)(0,(e.x-n.left)/n.width,1);return this._activeB=this._dual&&Math.abs(i-this._ratioA)>Math.abs(i-this._ratioB),this._update(e,n,!0),this._haptic.gestureSelectionStart(),!0},e.prototype._pointerMove=function(t){if(!this._disabled){t.preventDefault(),t.stopPropagation();this._update(Object(o.f)(t),this._rect,!0)&&this._snaps&&this._haptic.gestureSelectionChanged()}},e.prototype._pointerUp=function(t){this._disabled||(t.preventDefault(),t.stopPropagation(),this._update(Object(o.f)(t),this._rect,!1),this._haptic.gestureSelectionEnd(),this._fireBlur())},e.prototype._update=function(t,e,n){var i=Object(r.a)(0,(t.x-e.left)/e.width,1),o=this._ratioToValue(i);this._snaps&&(i=this._valueToRatio(o)),this._pressed=n;var a=!1;if(this._activeB?(this._pressedB=n,this._pressedA=!1,this._ratioB=i,a=o===this._valB,this._valB=o):(this._pressedA=n,this._pressedB=!1,this._ratioA=i,a=o===this._valA,this._valA=o),this._updateBar(),a)return!1;var s;return s=this._dual?{lower:Math.min(this._valA,this._valB),upper:Math.max(this._valA,this._valB)}:this._valA,this.value=s,!0},e.prototype._updateBar=function(){var t=this._ratioA,e=this._ratioB;this._dual?(this._barL=100*Math.min(t,e)+"%",this._barR=100-100*Math.max(t,e)+"%"):(this._barL="",this._barR=100-100*t+"%"),this._updateTicks()},e.prototype._createTicks=function(){var t=this;this._snaps&&this._dom.write(function(){t._ticks=[];for(var e=t._min;e<=t._max;e+=t._step){var n=t._valueToRatio(e);t._ticks.push({ratio:n,left:100*n+"%"})}t._updateTicks()})},e.prototype._updateTicks=function(){var t=this._ticks,e=this.ratio;if(this._snaps&&t)if(this._dual){var n=this.ratioUpper;t.forEach(function(t){t.active=t.ratio>=e&&t.ratio<=n})}else t.forEach(function(t){t.active=t.ratio<=e})},e.prototype._keyChg=function(t,e){var n=this._step;e?(t?this._valB+=n:this._valB-=n,this._valB=Object(r.a)(this._min,this._valB,this._max),this._ratioB=this._valueToRatio(this._valB)):(t?this._valA+=n:this._valA-=n,this._valA=Object(r.a)(this._min,this._valA,this._max),this._ratioA=this._valueToRatio(this._valA)),this._updateBar()},e.prototype._ratioToValue=function(t){return t=Math.round((this._max-this._min)*t),t=Math.round(t/this._step)*this._step+this._min,Object(r.a)(this._min,t,this._max)},e.prototype._valueToRatio=function(t){return t=Math.round((t-this._min)/this._step)*this._step,t/=this._max-this._min,Object(r.a)(0,t,1)},e.prototype._inputNormalize=function(t){return this._dual?t:(t=parseFloat(t),isNaN(t)?void 0:t)},e.prototype._inputUpdated=function(){var t=this.value;this._dual?(this._valA=t.lower,this._valB=t.upper,this._ratioA=this._valueToRatio(t.lower),this._ratioB=this._valueToRatio(t.upper)):(this._valA=t,this._ratioA=this._valueToRatio(t)),this._updateBar(),this._cd.detectChanges()},e.prototype.ngOnDestroy=function(){t.prototype.ngOnDestroy.call(this),this._events.destroy()},e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(0),i=n(22),o=function(){function t(){this.ionIncrease=new r.l,this.ionDecrease=new r.l}return Object.defineProperty(t.prototype,"ratio",{set:function(t){this._x=100*t+"%"},enumerable:!0,configurable:!0}),t.prototype._keyup=function(t){var e=t.keyCode;e===i.d||e===i.a?(this.ionDecrease.emit(),t.preventDefault(),t.stopPropagation()):e!==i.e&&e!==i.h||(this.ionIncrease.emit(),t.preventDefault(),t.stopPropagation())},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n(0),i=(n(1),n(32)),o=n(2),a=n(150),s=(n(3),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),l=function(t){function e(e,n,i,o,s){var l=t.call(this,e,i,o,"searchbar","",null,null,s)||this;return l._plt=n,l._shouldBlur=!0,l._shouldAlignLeft=!0,l._isCancelVisible=!1,l._spellcheck=!1,l._autocomplete="off",l._autocorrect="off",l._isActive=!1,l._showCancelButton=!1,l._animated=!1,l._inputDebouncer=new a.a(0),l.cancelButtonText="Cancel",l.placeholder="Search",l.type="search",l.ionInput=new r.l,l.ionCancel=new r.l,l.ionClear=new r.l,l.debounce=250,l}return s(e,t),Object.defineProperty(e.prototype,"showCancelButton",{get:function(){return this._showCancelButton},set:function(t){this._showCancelButton=Object(o.o)(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"debounce",{get:function(){return this._debouncer.wait},set:function(t){this._debouncer.wait=t,this._inputDebouncer.wait=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autocomplete",{set:function(t){this._autocomplete=""===t||"on"===t?"on":this._config.get("autocomplete","off")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autocorrect",{set:function(t){this._autocorrect=""===t||"on"===t?"on":this._config.get("autocorrect","off")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spellcheck",{set:function(t){this._spellcheck=""===t||"true"===t||!0===t||this._config.getBoolean("spellcheck",!1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animated",{get:function(){return this._animated},set:function(t){this._animated=Object(o.o)(t)},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){var t=this.showCancelButton;"string"==typeof t&&(this.showCancelButton=""===t||"true"===t)},e.prototype._inputUpdated=function(){var t=this._searchbarInput.nativeElement,e=this._value;t.value!==e&&(t.value=e),this.positionElements()},e.prototype.positionElements=function(){var t=this._animated,e=this._shouldAlignLeft,n=!t||this._value&&""!==this._value.toString().trim()||!0===this._isFocus;this._shouldAlignLeft=n,"ios"===this._mode&&(e!==n&&this.positionPlaceholder(),t&&this.positionCancelButton())},e.prototype.positionPlaceholder=function(){var t=this._searchbarInput.nativeElement,e=this._searchbarIcon.nativeElement;if(this._shouldAlignLeft)t.removeAttribute("style"),e.removeAttribute("style");else{var n=this._plt.doc(),r=n.createElement("span");r.innerHTML=this.placeholder,n.body.appendChild(r);var i=r.offsetWidth;n.body.removeChild(r);var o="calc(50% - "+i/2+"px)";this._plt.isRTL?t.style.paddingRight=o:t.style.paddingLeft=o;var a="calc(50% - "+(i/2+30)+"px)";this._plt.isRTL?e.style.marginRight=a:e.style.marginLeft=a}},e.prototype.positionCancelButton=function(){var t=this._isFocus;if(t!==this._isCancelVisible){var e=this._cancelButton.nativeElement,n=e.style;if(this._isCancelVisible=t,t)this._plt.isRTL?n.marginLeft="0":n.marginRight="0";else{var r=e.offsetWidth;r>0&&(this._plt.isRTL?n.marginLeft=-r+"px":n.marginRight=-r+"px")}}},e.prototype.inputChanged=function(t){var e=this;this.value=t.target.value,this._inputDebouncer.debounce(function(){e.ionInput.emit(t)})},e.prototype.inputFocused=function(){this._isActive=!0,this._fireFocus(),this.positionElements()},e.prototype.inputBlurred=function(){if(!1===this._shouldBlur)return this._searchbarInput.nativeElement.focus(),void(this._shouldBlur=!0);this._fireBlur(),this.positionElements()},e.prototype.clearInput=function(t){var e=this;this.ionClear.emit(t),setTimeout(function(){var n=e._value;Object(o.l)(n)&&""!==n&&(e.value="",e.ionInput.emit(t))},64),this._shouldBlur=!1},e.prototype.cancelSearchbar=function(t){this.ionCancel.emit(t),this.clearInput(t),this._shouldBlur=!0,this._isActive=!1},e.prototype.setFocus=function(){this._renderer.invokeElementMethod(this._searchbarInput.nativeElement,"focus")},e}(i.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return h});var r=n(0),i=n(84),o=n(85),a=n(99),s=(n(1),n(12),n(13),n(32)),l=n(2),u=(n(77),n(67)),c=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),h=function(t){function e(e,n,i,o,a,s,u){var c=t.call(this,i,o,a,"select",[],n,s,null)||this;return c._app=e,c.config=i,c.deepLinker=u,c._multi=!1,c._texts=[],c._text="",c._compareWith=l.g,c.cancelText="Cancel",c.okText="OK",c.selectOptions={},c.interface="",c.selectedText="",c.ionCancel=new r.l,c}return c(e,t),Object.defineProperty(e.prototype,"compareWith",{set:function(t){if("function"!=typeof t)throw new Error("compareWith must be a function, but received "+JSON.stringify(t));this._compareWith=t},enumerable:!0,configurable:!0}),e.prototype._click=function(t){t.preventDefault(),t.stopPropagation(),this.open(t)},e.prototype._keyup=function(){this.open()},e.prototype.getValues=function(){return Array.isArray(this._value)?this._value:[this._value]},e.prototype.open=function(t){var e=this;if(!this.isFocus()&&!this._disabled){var n=Object(l.b)(this.selectOptions);n.buttons=[{text:this.cancelText,role:"cancel",handler:function(){e.ionCancel.emit(e)}}],!n.title&&this._item&&(n.title=this._item.getLabelText());var r=this._options.toArray();"action-sheet"!==this.interface&&"popover"!==this.interface||!this._multi||(console.warn('Interface cannot be "'+this.interface+'" with a multi-value select. Using the "alert" interface.'),this.interface="alert"),"popover"!==this.interface||t||(console.warn('Interface cannot be "popover" without UIEvent.'),this.interface="alert");var s;if("action-sheet"===this.interface){n.buttons=n.buttons.concat(r.map(function(t){return{role:t.selected?"selected":"",text:t.text,handler:function(){e.value=t.value,t.ionSelect.emit(t.value)}}}));var c="select-action-sheet";n.cssClass=c+=n.cssClass?" "+n.cssClass:"",s=new i.a(this._app,n,this.config)}else if("popover"===this.interface){var h=r.map(function(t){return{text:t.text,checked:t.selected,disabled:t.disabled,value:t.value,handler:function(){e.value=t.value,t.ionSelect.emit(t.value)}}}),p="select-popover";s=new a.a(this._app,u.a,{options:h},{cssClass:p+=n.cssClass?" "+n.cssClass:""},this.config,this.deepLinker),Object.defineProperty(t,"target",{value:t.currentTarget}),n.ev=t}else{this.interface="alert",n.inputs=this._options.map(function(t){return{type:e._multi?"checkbox":"radio",label:t.text,value:t.value,checked:t.selected,disabled:t.disabled,handler:function(e){e.checked&&t.ionSelect.emit(t.value)}}});var d="select-alert";s=new o.a(this._app,n,this.config),d+=this._multi?" multiple-select-alert":" single-select-alert",s.setCssClass(d+=n.cssClass?" "+n.cssClass:""),s.addButton({text:this.okText,handler:function(t){return e.value=t}})}s.present(n),this._fireFocus(),s.onDidDismiss(function(){e._fireBlur(),e._overlay=void 0}),this._overlay=s}},e.prototype.close=function(){if(this._overlay&&this.isFocus())return this._overlay.dismiss()},Object.defineProperty(e.prototype,"multiple",{get:function(){return this._multi},set:function(t){this._multi=Object(l.o)(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._multi?this._texts:this._texts.join()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{set:function(t){this._options=t;0===this.getValues().length?this.writeValue(t.filter(function(t){return t.selected}).map(function(t){return t.value})):this._updateText()},enumerable:!0,configurable:!0}),e.prototype._inputShouldChange=function(t){return!Object(l.c)(this._value,t)},e.prototype._inputChangeEvent=function(){return this.value},e.prototype._updateText=function(){var t=this;this._texts.length=0,this._options&&this._options.forEach(function(e){e.selected=t.getValues().some(function(n){return t._compareWith(n,e.value)}),e.selected&&t._texts.push(e.text)}),this._text=this._texts.join(", ")},e.prototype._inputUpdated=function(){this._updateText(),t.prototype._inputUpdated.call(this)},e}(s.a)},function(t,e,n){"use strict";n(0),n(17),n(1),n(9),n(13);var r=n(7),i=(n(25),n(2)),o=n(32),a=(n(18),n(22)),s=(n(3),n(57)),l=n(11),u=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),c=function(t){function e(e,n,i,o){var a=t.call(this,e,n.getNativeElement(),{threshold:0,zone:!1,domController:o,gesture:i.createGesture({name:r.k,priority:r.i})})||this;return a.toggle=n,a}return u(e,t),e.prototype.canStart=function(){return!0},e.prototype.onDragStart=function(t){t.preventDefault(),this.toggle._onDragStart(Object(l.f)(t).x)},e.prototype.onDragMove=function(t){t.preventDefault(),this.toggle._onDragMove(Object(l.f)(t).x)},e.prototype.onDragEnd=function(t){t.preventDefault(),this.toggle._onDragEnd(Object(l.f)(t).x)},e}(s.a);n.d(e,"a",function(){return p});var h=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),p=function(t){function e(e,n,r,i,o,a,s,l,u,c){var h=t.call(this,n,i,o,"toggle",!1,e,s,null)||this;return h._plt=r,h._haptic=a,h._gestureCtrl=l,h._domCtrl=u,h._zone=c,h._activated=!1,h}return h(e,t),Object.defineProperty(e.prototype,"checked",{get:function(){return this.value},set:function(t){this.value=t},enumerable:!0,configurable:!0}),e.prototype.ngAfterContentInit=function(){this._initialize(),this._gesture=new c(this._plt,this,this._gestureCtrl,this._domCtrl),this._gesture.listen()},e.prototype._inputUpdated=function(){},e.prototype._inputNormalize=function(t){return Object(i.o)(t)},e.prototype._onDragStart=function(t){var e=this;this._zone.run(function(){e._startX=t,e._fireFocus(),e._activated=!0})},e.prototype._onDragMove=function(t){var e=this;this._startX&&this._shouldToggle(t,-15)&&this._zone.run(function(){e.value=!e.value,e._startX=t,e._haptic.selection()})},e.prototype._onDragEnd=function(t){var e=this;this._startX&&this._zone.run(function(){e._shouldToggle(t,4)&&(e.value=!e.value,e._haptic.selection()),e._activated=!1,e._fireBlur(),e._startX=null})},e.prototype._shouldToggle=function(t,e){var n=!this._plt.isRTL,r=this._startX;return this._value?n&&r+e>t||!n&&r-e<t:n&&r-e<t||!n&&r+e>t},e.prototype._keyup=function(t){t.keyCode!==a.f&&t.keyCode!==a.b||(t.preventDefault(),t.stopPropagation(),this.value=!this.value)},e.prototype.ngOnDestroy=function(){t.prototype.ngOnDestroy.call(this),this._gesture&&this._gesture.destroy()},e}(o.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(1);var r=n(6),i=(n(4),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),o=function(t){function e(e,n,r,i){var o=t.call(this,e,n,r,"header")||this;return i&&i._setHeader(o),o}return i(e,t),e}(r.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(1);var r=n(6),i=(n(41),n(52),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),o=function(t){function e(e,n,r,i,o){var a=t.call(this,e,n,r,"bar-buttons")||this;return a.inToolbar=!(!i&&!o),a}return i(e,t),Object.defineProperty(e.prototype,"_buttons",{set:function(t){this.inToolbar&&t.forEach(function(t){t.setRole("bar-button")})},enumerable:!0,configurable:!0}),e}(r.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(1);var r=n(6),i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(t){function e(e,n,r){return t.call(this,e,n,r,"card")||this}return i(e,t),e}(r.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(1);var r=n(6),i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(t){function e(e,n,r){return t.call(this,e,n,r,"card-content")||this}return i(e,t),e}(r.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(1);var r=n(6),i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(t){function e(e,n,r){return t.call(this,e,n,r,"card-header")||this}return i(e,t),e}(r.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){return function(){}}()},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){return function(){}}()},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){return function(){}}()},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){return function(){}}()},function(t,e,n){"use strict";n.d(e,"a",function(){return r});n(26),n(41),n(4);var r=function(){function t(t,e,n,r){this._menu=t,this._viewCtrl=e,this._button=n,this._isButton=!!n,this._inNavbar=!!r}return t.prototype.ngAfterContentInit=function(){this._isButton&&this._button._setClass("menutoggle",!0)},t.prototype.toggle=function(){var t=this._menu.get(this.menuToggle);t&&t.toggle()},Object.defineProperty(t.prototype,"isHidden",{get:function(){var t=this._menu.get(this.menuToggle);if(this._inNavbar&&this._viewCtrl){if(!t||!t._canOpen())return!0;if(this._viewCtrl.isFirst())return!1;if(t)return!t.persistent}return!1},enumerable:!0,configurable:!0}),t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(1);var r=n(32),i=(n(74),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),o=function(t){function e(e,n,r,i){return t.call(this,e,n,r,"segment",null,null,null,i)||this}return i(e,t),e.prototype.ngAfterContentInit=function(){var t=this;this._initialize(),this._buttons.forEach(function(e){e.ionSelect.subscribe(function(e){t.value=e.value,t._fireTouched()})})},e.prototype._inputUpdated=function(){if(this._buttons)for(var t=this._buttons.toArray(),e=this.value,n=0,r=t;n<r.length;n++){var i=r[n];i.isActive=i.value===e}},e}(r.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){return function(){}}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o});n(1);var r=n(6),i=(n(4),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),o=function(t){function e(e,n,r,i){var o=t.call(this,e,n,r,"footer")||this;return i&&i._setFooter(o),o}return i(e,t),e}(r.a)},function(t,e,n){"use strict";e.isFunction=function(t){return"function"==typeof t}},function(t,e,n){"use strict";e.isArray=Array.isArray||function(t){return t&&"number"==typeof t.length}},function(t,e,n){"use strict";e.isObject=function(t){return null!=t&&"object"==typeof t}},function(t,e,n){"use strict";e.errorObject={e:{}}},function(t,e,n){"use strict";e.empty={closed:!0,next:function(t){},error:function(t){throw t},complete:function(){}}},function(t,e,n){"use strict";function r(t){var e,n=t.Symbol;return"function"==typeof n?n.observable?e=n.observable:(e=n("observable"),n.observable=e):e="@@observable",e}var i=n(33);e.getSymbolObservable=r,e.observable=r(i.root),e.$$observable=e.observable},function(t,e,n){"use strict";var r=n(5).__extends,i=n(14);e.EmptyObservable=function(t){function e(e){t.call(this),this.scheduler=e}return r(e,t),e.create=function(t){return new e(t)},e.dispatch=function(t){t.subscriber.complete()},e.prototype._subscribe=function(t){var n=this.scheduler;if(n)return n.schedule(e.dispatch,0,{subscriber:t});t.complete()},e}(i.Observable)},function(t,e,n){"use strict";e.isScheduler=function(t){return t&&"function"==typeof t.schedule}},function(t,e,n){"use strict";var r=n(5).__extends,i=n(28);e.refCount=function(){return function(t){return t.lift(new o(t))}};var o=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var n=this.connectable;n._refCount++;var r=new a(t,n),i=e.subscribe(r);return r.closed||(r.connection=n.connect()),i},t}(),a=function(t){function e(e,n){t.call(this,e),this.connectable=n}return r(e,t),e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var n=this.connection,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null},e}(i.Subscriber)},,function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(57),i=n(2),o=n(11),a=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),s=function(t){function e(e,n,r){void 0===r&&(r={});var i=t.call(this,e,n,r)||this;return i.slide=null,i}return a(e,t),e.prototype.getSlideBoundaries=function(t,e){return{min:0,max:this.getNativeElement().offsetWidth}},e.prototype.getElementStartPos=function(t,e){return 0},e.prototype.onDragStart=function(t){this.onSlideBeforeStart(t);var e=Object(o.f)(t)[this.direction];this.slide={min:0,max:0,pointerStartPos:e,pos:e,timestamp:Date.now(),elementStartPos:0,started:!0,delta:0,distance:0,velocity:0};var n=this.getSlideBoundaries(this.slide,t),r=n.max;this.slide.min=n.min,this.slide.max=r,this.slide.elementStartPos=this.getElementStartPos(this.slide,t),this.onSlideStart(this.slide,t)},e.prototype.onDragMove=function(t){var e=this.slide,n=Object(o.f)(t)[this.direction],r=Date.now(),a=(this.plt.isRTL?e.pos-n:n-e.pos)/(r-e.timestamp);e.pos=n,e.timestamp=r,e.distance=Object(i.a)(e.min,(this.plt.isRTL?e.pointerStartPos-n:n-e.pointerStartPos)+e.elementStartPos,e.max),e.velocity=a,e.delta=this.plt.isRTL?e.pointerStartPos-n:n-e.pointerStartPos,this.onSlide(e,t)},e.prototype.onDragEnd=function(t){this.onSlideEnd(this.slide,t),this.slide=null},e.prototype.onSlideBeforeStart=function(t){},e.prototype.onSlideStart=function(t,e){},e.prototype.onSlide=function(t,e){},e.prototype.onSlideEnd=function(t,e){},e}(r.a)},function(t,e,n){"use strict";n.d(e,"b",function(){return r}),n.d(e,"a",function(){return o});var r=function(){function t(t,e,n,r,i,o){this.plt=t,this.ele=e,this.pointerDown=n,this.pointerMove=r,this.pointerUp=i,this.option=o,this.rmTouchStart=null,this.rmTouchMove=null,this.rmTouchEnd=null,this.rmTouchCancel=null,this.rmMouseStart=null,this.rmMouseMove=null,this.rmMouseUp=null,this.lastTouchEvent=0,this.mouseWait=2e3,this.bindTouchEnd=this.handleTouchEnd.bind(this),this.bindMouseUp=this.handleMouseUp.bind(this),this.rmTouchStart=this.plt.registerListener(e,"touchstart",this.handleTouchStart.bind(this),o),this.rmMouseStart=this.plt.registerListener(e,"mousedown",this.handleMouseDown.bind(this),o)}return t.prototype.handleTouchStart=function(t){this.lastTouchEvent=Date.now()+this.mouseWait,this.lastEventType=o,this.pointerDown(t,o)&&(!this.rmTouchMove&&this.pointerMove&&(this.rmTouchMove=this.plt.registerListener(this.ele,"touchmove",this.pointerMove,this.option)),this.rmTouchEnd||(this.rmTouchEnd=this.plt.registerListener(this.ele,"touchend",this.bindTouchEnd,this.option)),this.rmTouchCancel||(this.rmTouchCancel=this.plt.registerListener(this.ele,"touchcancel",this.bindTouchEnd,this.option)))},t.prototype.handleMouseDown=function(t){this.lastTouchEvent>Date.now()||(this.lastEventType=i,this.pointerDown(t,i)&&(!this.rmMouseMove&&this.pointerMove&&(this.rmMouseMove=this.plt.registerListener(this.plt.doc(),"mousemove",this.pointerMove,this.option)),this.rmMouseUp||(this.rmMouseUp=this.plt.registerListener(this.plt.doc(),"mouseup",this.bindMouseUp,this.option))))},t.prototype.handleTouchEnd=function(t){this.stopTouch(),this.pointerUp&&this.pointerUp(t,o)},t.prototype.handleMouseUp=function(t){this.stopMouse(),this.pointerUp&&this.pointerUp(t,i)},t.prototype.stopTouch=function(){this.rmTouchMove&&this.rmTouchMove(),this.rmTouchEnd&&this.rmTouchEnd(),this.rmTouchCancel&&this.rmTouchCancel(),this.rmTouchMove=this.rmTouchEnd=this.rmTouchCancel=null},t.prototype.stopMouse=function(){this.rmMouseMove&&this.rmMouseMove(),this.rmMouseUp&&this.rmMouseUp(),this.rmMouseMove=this.rmMouseUp=null},t.prototype.stop=function(){this.stopTouch(),this.stopMouse()},t.prototype.destroy=function(){this.rmTouchStart&&this.rmTouchStart(),this.rmMouseStart&&this.rmMouseStart(),this.stop(),this.ele=this.pointerUp=this.pointerMove=this.pointerDown=this.rmTouchStart=this.rmMouseStart=null},t}(),i=1,o=2},function(t,e,n){"use strict"},function(t,e,n){"use strict";n(1),n(6),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}}()},function(t,e,n){"use strict";n(1),n(6),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}}()},function(t,e,n){"use strict";n(1),n(2),n(13),n(32),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}}()},function(t,e,n){"use strict";var r=n(224);e.map=function(t,e){return r.map(t,e)(this)}},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){function t(t){this.wait=t,this.timer=null}return t.prototype.debounce=function(t){this.callback=t,this.schedule()},t.prototype.schedule=function(){this.cancel(),this.wait<=0?this.callback():this.timer=setTimeout(this.callback,this.wait)},t.prototype.cancel=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(11),i=function(){function t(t,e,n){this._app=t,this._plt=e,this._dom=n,this.isScrolling=!1,this.initialized=!1,this._eventsEnabled=!1,this._t=0,this._l=0,this.ev={timeStamp:0,scrollTop:0,scrollLeft:0,scrollHeight:0,scrollWidth:0,contentHeight:0,contentWidth:0,contentTop:0,contentBottom:0,startY:0,startX:0,deltaY:0,deltaX:0,velocityY:0,velocityX:0,directionY:"down",directionX:null,domWrite:n.write.bind(n)}}return t.prototype.init=function(t,e,n){this._el=t,this.initialized||(this.initialized=!0,this._js?this.enableJsScroll(e,n):this.enableNativeScrolling())},t.prototype.enableEvents=function(){this._eventsEnabled=!0},t.prototype.setScrolling=function(t,e){this.isScrolling?t?this.onScroll&&this.onScroll(e):(this.isScrolling=!1,this.onScrollEnd&&this.onScrollEnd(e)):t&&(this.isScrolling=!0,this.onScrollStart&&this.onScrollStart(e))},t.prototype.enableNativeScrolling=function(){if(this._js=!1,this._el){var t=this,e=t.ev,n=[];t._lsn&&t._lsn(),t._lsn=t._plt.registerListener(t._el,"scroll",function(r){if(t._app.setScrolling(),t._eventsEnabled){if(e.timeStamp=r.timeStamp,e.timeStamp||(e.timeStamp=Date.now()),e.scrollTop=t.getTop(),e.scrollLeft=t.getLeft(),t.isScrolling||(e.startY=e.scrollTop,e.startX=e.scrollLeft,e.velocityY=e.velocityX=0,e.deltaY=e.deltaX=0,n.length=0),n.push(e.scrollTop,e.scrollLeft,e.timeStamp),n.length>3){e.deltaY=e.scrollTop-e.startY,e.deltaX=e.scrollLeft-e.startX;for(var i=n.length-1,a=i,s=e.timeStamp-100,l=i;l>0&&n[l]>s;l-=3)a=l;if(a!==i){var c=n[a-2]-n[i-2],h=n[a-1]-n[i-1],p=u/(n[i]-n[a]);e.velocityY=c*p,e.velocityX=h*p,e.directionY=c>0?"up":"down",e.directionX=h>0?"left":"right"}}t.setScrolling(!0,e),t._dom.cancel(t._endTmr),t._endTmr=t._dom.read(function(){e.velocityY=e.velocityX=0,t.setScrolling(!1,e),t._endTmr=null},o)}},c)}},t.prototype.enableJsScroll=function(t,e){function n(){d||(d=h.scrollHeight-h.parentElement.offsetHeight+t+e)}function i(t){f.timeStamp=t,f.velocityY&&(f.velocityY*=l,n(),o._t=Math.min(Math.max(o._t+f.velocityY,0),d),f.scrollTop=o._t,o.onScroll(f),o._dom.write(function(){o.setTop(o._t),o._t>0&&o._t<d&&Math.abs(f.velocityY)>s?p=o._dom.read(function(t){i(t)}):(o.isScrolling=!1,f.velocityY=f.velocityX=0,o.onScrollEnd(f))}))}var o=this;o._js=!0;var h=o._el;if(h){var p,d,f=o.ev,m=[],v=o._plt,g=v.registerListener(h,"touchstart",function(t){m.length=0,d=null,o._dom.cancel(p),m.push(Object(r.f)(t).y,t.timeStamp)},c),y=v.registerListener(h,"touchmove",function(t){if(m.length){f.timeStamp=t.timeStamp;var e=Object(r.f)(t).y;n(),o._t-=e-m[m.length-2],o._t=Math.min(Math.max(o._t,0),d),m.push(e,f.timeStamp),o.isScrolling||(f.startY=o._t,f.velocityY=f.deltaY=0,o.isScrolling=!0,o.onScrollStart(f)),o._dom.write(function(){o.setTop(o._t)})}},c),b=v.registerListener(h,"touchend",function(t){if(o._dom.cancel(p),!m.length&&o.isScrolling)return o.isScrolling=!1,f.velocityY=f.velocityX=0,void o.onScrollEnd(f);var e=Object(r.f)(t).y;m.push(e,t.timeStamp);for(var s=m.length-1,l=s,c=t.timeStamp-100,h=s;h>0&&m[h]>c;h-=2)l=h;l!==s?(f.velocityY=(m[l-1]-m[s-1])/(m[s]-m[l])*u,Math.abs(f.velocityY)>a&&(n(),p=o._dom.read(function(t){i(t)}))):(o.isScrolling=!1,f.velocityY=0,o.onScrollEnd(f));m.length=0},c);h.parentElement.classList.add("js-scroll"),o._lsn&&o._lsn(),o._lsn=function(){g(),y(),b(),h.parentElement.classList.remove("js-scroll")}}},t.prototype.getTop=function(){return this._js?this._t:this._t=this._el.scrollTop},t.prototype.getLeft=function(){return this._js?0:this._l=this._el.scrollLeft},t.prototype.setTop=function(t){this._t=t,this._js?this._el.style[this._plt.Css.transform]="translate3d("+-1*this._l+"px,"+-1*t+"px,0px)":this._el.scrollTop=t},t.prototype.setLeft=function(t){this._l=t,this._js?this._el.style[this._plt.Css.transform]="translate3d("+-1*t+"px,"+-1*this._t+"px,0px)":this._el.scrollLeft=t},t.prototype.scrollTo=function(t,e,n,r){function i(o){if(d++,!a._el||f||d>h)return a.setScrolling(!1,null),s.style[p]="",void r();var m=Math.min(1,(o-l)/n),v=--m*m*m+1;u!==e&&a.setTop(v*(e-u)+u),c!==t&&a.setLeft(Math.floor(v*(t-c)+c)),v<1?a._plt.raf(i):(f=!0,a.setScrolling(!1,null),s.style[p]="",r())}var o;void 0===r&&(o=new Promise(function(t){r=t}));var a=this,s=a._el;if(!s)return r(),o;if(n<32)return a.setTop(e),a.setLeft(t),r(),o;var l,u=s.scrollTop,c=s.scrollLeft,h=n/16+100,p=a._plt.Css.transform,d=0,f=!1;return a.setScrolling(!0,null),a.isScrolling=!0,a._dom.write(function(t){l=t,i(t)},16),o},t.prototype.scrollToTop=function(t){return this.scrollTo(0,0,t)},t.prototype.scrollToBottom=function(t){var e=0;return this._el&&(e=this._el.scrollHeight-this._el.clientHeight),this.scrollTo(0,e,t)},t.prototype.stop=function(){this.setScrolling(!1,null)},t.prototype.destroy=function(){this.stop(),this._endTmr&&this._dom.cancel(this._endTmr),this._lsn&&this._lsn();var t=this.ev;t.domWrite=t.contentElement=t.fixedElement=t.scrollElement=t.headerElement=null,this._lsn=this._el=this._dom=this.ev=t=null,this.onScrollStart=this.onScroll=this.onScrollEnd=null},t}(),o=80,a=4,s=.12,l=.97,u=1e3/60,c={passive:!0,zone:!1}},function(t,e,n){"use strict";function r(t){return t.$ionIndex}e.b=r,e.a=function(t,e){for(var n=0;t&&n<4;){if(void 0!==r(t))return e&&t.parentNode!==e?null:t;t=t.parentNode,n++}return null}},function(t,e,n){"use strict";n(1),n(6),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}}()},function(t,e,n){"use strict";n(0),n(17),n(1),n(60),n(13),n(32),n(18),n(2),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}}(),this&&this.__assign||Object},function(t,e,n){"use strict";var r=n(0),i=n(2),o=n(61),a=n(15),s=n(34),l=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.init=function(){var t=this.enteringView.pageRef().nativeElement,e=new a.a(this.plt,t.querySelector("ion-backdrop")),n=new a.a(this.plt,t.querySelector(".picker-wrapper"));e.fromTo("opacity",.01,.26),n.fromTo("translateY","100%","0%"),this.easing("cubic-bezier(.36,.66,.04,1)").duration(400).add(e).add(n)},e}(s.a),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.init=function(){var t=this.leavingView.pageRef().nativeElement,e=new a.a(this.plt,t.querySelector("ion-backdrop")),n=new a.a(this.plt,t.querySelector(".picker-wrapper"));e.fromTo("opacity",.26,0),n.fromTo("translateY","0%","100%"),this.easing("cubic-bezier(.36,.66,.04,1)").duration(450).add(e).add(n)},e}(s.a),h=n(4);n.d(e,"a",function(){return d});var p=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),d=function(t){function e(e,n,a){void 0===n&&(n={});var s=this;return n||(n={}),n.columns=n.columns||[],n.buttons=n.buttons||[],n.enableBackdropDismiss=!Object(i.l)(n.enableBackdropDismiss)||Boolean(n.enableBackdropDismiss),s=t.call(this,o.a,n,null)||this,s._app=e,s.isOverlay=!0,s.ionChange=new r.l,a.setTransition("picker-slide-in",u),a.setTransition("picker-slide-out",c),s}return p(e,t),e.prototype.getTransitionName=function(t){return this._nav&&this._nav.config.get("back"===t?"pickerLeave":"pickerEnter")},e.prototype.addButton=function(t){this.data.buttons.push(t)},e.prototype.addColumn=function(t){this.data.columns.push(t)},e.prototype.getColumns=function(){return this.data.columns},e.prototype.getColumn=function(t){return this.getColumns().find(function(e){return e.name===t})},e.prototype.refresh=function(){this._cmp&&this._cmp.instance.refresh&&this._cmp.instance.refresh()},e.prototype.setCssClass=function(t){this.data.cssClass=t},e.prototype.present=function(t){return void 0===t&&(t={}),this._app.present(this,t)},e}(h.a)},function(t,e,n){"use strict";n(21),n(9),n(2),n(3)},function(t,e,n){"use strict";n(1),n(86)},function(t,e,n){"use strict";var r=n(14),i=n(225);r.Observable.prototype.takeUntil=i.takeUntil},function(t,e,n){"use strict";n(1),n(6),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}}()},function(t,e,n){"use strict";n(2),n(3),n(87)},function(t,e,n){"use strict";var r=n(2),i=n(46),o=n(63),a=n(15),s=n(34),l=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.init=function(){var t=this.enteringView.pageRef().nativeElement,e=new a.a(this.plt,t.querySelector("ion-backdrop")),n=new a.a(this.plt,t.querySelector(".loading-wrapper"));n.fromTo("opacity",.01,1).fromTo("scale",1.1,1),e.fromTo("opacity",.01,.3),this.easing("ease-in-out").duration(200).add(e).add(n)},e}(s.a),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.init=function(){var t=this.leavingView.pageRef().nativeElement,e=new a.a(this.plt,t.querySelector("ion-backdrop")),n=new a.a(this.plt,t.querySelector(".loading-wrapper"));n.fromTo("opacity",.99,0).fromTo("scale",1,.9),e.fromTo("opacity",.3,0),this.easing("ease-in-out").duration(200).add(e).add(n)},e}(s.a),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.init=function(){var t=this.enteringView.pageRef().nativeElement,e=new a.a(this.plt,t.querySelector("ion-backdrop")),n=new a.a(this.plt,t.querySelector(".loading-wrapper"));n.fromTo("opacity",.01,1).fromTo("scale",1.1,1),e.fromTo("opacity",.01,.5),this.easing("ease-in-out").duration(200).add(e).add(n)},e}(s.a),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.init=function(){var t=this.leavingView.pageRef().nativeElement,e=new a.a(this.plt,t.querySelector("ion-backdrop")),n=new a.a(this.plt,t.querySelector(".loading-wrapper"));n.fromTo("opacity",.99,0).fromTo("scale",1,.9),e.fromTo("opacity",.5,0),this.easing("ease-in-out").duration(200).add(e).add(n)},e}(s.a),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.init=function(){var t=this.enteringView.pageRef().nativeElement,e=new a.a(this.plt,t.querySelector("ion-backdrop")),n=new a.a(this.plt,t.querySelector(".loading-wrapper"));n.fromTo("opacity",.01,1).fromTo("scale",1.3,1),e.fromTo("opacity",.01,.16),this.easing("cubic-bezier(0,0,0.05,1)").duration(200).add(e).add(n)},e}(s.a),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.init=function(){var t=this.leavingView.pageRef().nativeElement,e=new a.a(this.plt,t.querySelector("ion-backdrop")),n=new a.a(this.plt,t.querySelector(".loading-wrapper"));n.fromTo("opacity",.99,0).fromTo("scale",1,1.3),e.fromTo("opacity",.16,0),this.easing("ease-out").duration(150).add(e).add(n)},e}(s.a),m=n(4);n.d(e,"a",function(){return g});var v=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),g=function(t){function e(e,n,i){void 0===n&&(n={});var a=this;return n.showBackdrop=!Object(r.l)(n.showBackdrop)||!!n.showBackdrop,n.enableBackdropDismiss=!!Object(r.l)(n.enableBackdropDismiss)&&!!n.enableBackdropDismiss,n.dismissOnPageChange=!!Object(r.l)(n.dismissOnPageChange)&&!!n.dismissOnPageChange,a=t.call(this,o.a,n,null)||this,a._app=e,a.isOverlay=!0,i.setTransition("loading-pop-in",u),i.setTransition("loading-pop-out",c),i.setTransition("loading-md-pop-in",h),i.setTransition("loading-md-pop-out",p),i.setTransition("loading-wp-pop-in",d),i.setTransition("loading-wp-pop-out",f),a}return v(e,t),e.prototype.getTransitionName=function(t){return this._nav&&this._nav.config.get("back"===t?"loadingLeave":"loadingEnter")},e.prototype.setContent=function(t){return this.data.content=t,this},e.prototype.setSpinner=function(t){return this.data.spinner=t,this},e.prototype.setCssClass=function(t){return this.data.cssClass=t,this},e.prototype.setShowBackdrop=function(t){return this.data.showBackdrop=t,this},e.prototype.setDuration=function(t){return this.data.duration=t,this},e.prototype.present=function(t){return void 0===t&&(t={}),this._app.present(this,t,i.b)},e.prototype.dismissAll=function(){this._nav&&this._nav.popAll()},e}(m.a)},function(t,e,n){"use strict";n(0),n(8),n(23),n(1),n(21),n(9),n(7),n(2),n(24),n(83),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}}(),n(26),n(49),n(3),n(30),n(35)},function(t,e,n){"use strict";n(26)},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(6),i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(t){function e(e,n,r){return t.call(this,e,n,r,"toolbar")||this}return i(e,t),e.prototype._setTitle=function(t){this._title=t},e.prototype.getTitleText=function(){return this._title&&this._title.getTitleText()||""},e}(r.a)},function(t,e,n){"use strict";var r=n(166),i=n(2),o=n(46),a=n(64),s=n(15),l=n(38),u=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=this.enteringView.pageRef().nativeElement,n=e.querySelector("ion-backdrop"),r=new s.a(this.plt,n),i=new s.a(this.plt,e.querySelector(".modal-wrapper"));i.beforeStyles({opacity:1}),i.fromTo("translateY","100%","0%"),r.fromTo("opacity",.01,.4),this.element(this.enteringView.pageRef()).easing("cubic-bezier(0.36,0.66,0.04,1)").duration(400).add(r).add(i)},e}(l.a),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=this.leavingView.pageRef().nativeElement,n=new s.a(this.plt,e.querySelector("ion-backdrop")),r=e.querySelector(".modal-wrapper"),i=r.getBoundingClientRect(),o=new s.a(this.plt,r);o.fromTo("translateY","0px",this.plt.height()-i.top+"px"),n.fromTo("opacity",.4,0),this.element(this.leavingView.pageRef()).easing("ease-out").duration(250).add(n).add(o)},e}(l.a),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=this.enteringView.pageRef().nativeElement,n=new s.a(this.plt,e.querySelector("ion-backdrop")),r=new s.a(this.plt,e.querySelector(".modal-wrapper"));n.fromTo("opacity",.01,.4),r.fromTo("translateY","40px","0px"),r.fromTo("opacity",.01,1);this.element(this.enteringView.pageRef()).easing("cubic-bezier(0.36,0.66,0.04,1)").duration(280).add(n).add(r)},e}(l.a),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=this.leavingView.pageRef().nativeElement,n=new s.a(this.plt,e.querySelector("ion-backdrop")),r=new s.a(this.plt,e.querySelector(".modal-wrapper"));n.fromTo("opacity",.4,0),r.fromTo("translateY","0px","40px"),r.fromTo("opacity",.99,0),this.element(this.leavingView.pageRef()).duration(200).easing("cubic-bezier(0.47,0,0.745,0.715)").add(r).add(n)},e}(l.a),f=n(4),m=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),v=function(t){function e(e,n,r,o,s){void 0===o&&(o={});var l=this;return r=r||{},r.component=n,o.showBackdrop=!Object(i.l)(o.showBackdrop)||!!o.showBackdrop,o.enableBackdropDismiss=!Object(i.l)(o.enableBackdropDismiss)||!!o.enableBackdropDismiss,r.opts=o,l=t.call(this,a.a,r,null)||this,l._app=e,l._enterAnimation=o.enterAnimation,l._leaveAnimation=o.leaveAnimation,l.isOverlay=!0,s.setTransition("modal-slide-in",c),s.setTransition("modal-slide-out",h),s.setTransition("modal-md-slide-in",p),s.setTransition("modal-md-slide-out",d),l}return m(e,t),e.prototype.getTransitionName=function(t){var e;if("back"===t){if(this._leaveAnimation)return this._leaveAnimation;e="modalLeave"}else{if(this._enterAnimation)return this._enterAnimation;e="modalEnter"}return this._nav&&this._nav.config.get(e)},e.prototype.present=function(t){return void 0===t&&(t={}),t.minClickBlockDuration=t.minClickBlockDuration||400,this._app.present(this,t,o.c)},e}(f.a);n.d(e,"a",function(){return y});var g=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),y=function(t){function e(e,n,r,i,o,a){void 0===i&&(i={});var s=t.call(this,e,n,o,a)||this;return s.data=r,s.opts=i,s.isOverlay=!0,s}return g(e,t),e.prototype.getImplementation=function(){return new v(this._app,this._component,this.data,this.opts,this._config)},e}(r.a)},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(2),i=function(){function t(t,e,n,r){this._app=t,this._component=e,this._config=n,this._deepLinker=r}return t.prototype.getImplementation=function(){throw new Error('Child class must implement "getImplementation" method')},t.prototype.present=function(t){var e=this;void 0===t&&(t={});return Object(r.n)(this._component)?this._deepLinker.getComponentFromName(this._component).then(function(n){return e._component=n,e.createAndPresentOverlay(t)}):this.createAndPresentOverlay(t)},t.prototype.dismiss=function(t,e,n){if(this.overlay)return this.overlay.dismiss(t,e,n)},t.prototype.onDidDismiss=function(t){this._onDidDismiss=t,this.overlay&&this.overlay.onDidDismiss(this._onDidDismiss)},t.prototype.createAndPresentOverlay=function(t){return this.overlay=this.getImplementation(),this.overlay.onWillDismiss(this._onWillDismiss),this.overlay.onDidDismiss(this._onDidDismiss),this.overlay.present(t)},t.prototype.onWillDismiss=function(t){this._onWillDismiss=t,this.overlay&&this.overlay.onWillDismiss(this._onWillDismiss)},t}()},,function(t,e,n){"use strict";var r=n(230),i=n(232);e.async=new i.AsyncScheduler(r.AsyncAction)},function(t,e,n){"use strict";n.d(e,"a",function(){return r});n(1),n(3);var r=function(){function t(t,e,n,r,i){this.plt=n,this.elementRef=r,this.renderer=i,this._showing=!1,t._clickBlock=this;(this.isEnabled=e.getBoolean("clickBlock",!0))&&this._setElementClass("click-block-enabled",!0)}return t.prototype.activate=function(t,e,n){void 0===e&&(e=100),void 0===n&&(n=0),this.isEnabled&&(this.plt.cancelTimeout(this._tmr),t&&(this._start=Date.now(),this._minEnd=this._start+(n||0),this._activate(!0)),this._tmr=this.plt.timeout(this._activate.bind(this,!1),e))},t.prototype._activate=function(t){if(this._showing!==t){if(!t){var e=Date.now();if(e<this._minEnd)return void(this._tmr=this.plt.timeout(this._activate.bind(this,!1),this._minEnd-e))}this._setElementClass("click-block-active",t),this._showing=t}},t.prototype._setElementClass=function(t,e){this.renderer.setElementClass(this.elementRef.nativeElement,t,e)},t}()},function(t,e,n){"use strict";var r=n(2),i=n(46),o=n(68),a=n(15),s=n(34),l=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.init=function(){var t=this.enteringView.pageRef().nativeElement,e=t.querySelector(".toast-wrapper"),n=new a.a(this.plt,e);if(this.enteringView.data&&this.enteringView.data.position===m)n.fromTo("translateY","-100%","10px");else if(this.enteringView.data&&this.enteringView.data.position===v){var r=Math.floor(t.clientHeight/2-e.clientHeight/2);e.style.top=r+"px",n.fromTo("opacity",.01,1)}else n.fromTo("translateY","100%","-10px");this.easing("cubic-bezier(.36,.66,.04,1)").duration(400).add(n)},e}(s.a),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.init=function(){var t=this.leavingView.pageRef().nativeElement.querySelector(".toast-wrapper"),e=new a.a(this.plt,t);this.leavingView.data&&this.leavingView.data.position===m?e.fromTo("translateY","10px","-100%"):this.leavingView.data&&this.leavingView.data.position===v?e.fromTo("opacity",.99,0):e.fromTo("translateY","-10px","100%"),this.easing("cubic-bezier(.36,.66,.04,1)").duration(300).add(e)},e}(s.a),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.init=function(){var t=this.enteringView.pageRef().nativeElement,e=t.querySelector(".toast-wrapper"),n=new a.a(this.plt,e);if(this.enteringView.data&&this.enteringView.data.position===m)n.fromTo("translateY","-100%","0%");else if(this.enteringView.data&&this.enteringView.data.position===v){var r=Math.floor(t.clientHeight/2-e.clientHeight/2);e.style.top=r+"px",n.fromTo("opacity",.01,1)}else n.fromTo("translateY","100%","0%");this.easing("cubic-bezier(.36,.66,.04,1)").duration(400).add(n)},e}(s.a),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.init=function(){var t=this.leavingView.pageRef().nativeElement.querySelector(".toast-wrapper"),e=new a.a(this.plt,t);this.leavingView.data&&this.leavingView.data.position===m?e.fromTo("translateY","0%","-100%"):this.leavingView.data&&this.leavingView.data.position===v?e.fromTo("opacity",.99,0):e.fromTo("translateY","0%","100%"),this.easing("cubic-bezier(.36,.66,.04,1)").duration(450).add(e)},e}(s.a),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.init=function(){var t=this.enteringView.pageRef().nativeElement,e=t.querySelector(".toast-wrapper"),n=new a.a(this.plt,e);if(this.enteringView.data&&this.enteringView.data.position===m)n.fromTo("opacity",.01,1),n.fromTo("scale",1.3,1);else if(this.enteringView.data&&this.enteringView.data.position===v){var r=Math.floor(t.clientHeight/2-e.clientHeight/2);e.style.top=r+"px",n.fromTo("opacity",.01,1),n.fromTo("scale",1.3,1)}else n.fromTo("opacity",.01,1),n.fromTo("scale",1.3,1);this.easing("cubic-bezier(0,0,0.05,1)").duration(200).add(n)},e}(s.a),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.init=function(){var t=this.leavingView.pageRef().nativeElement.querySelector(".toast-wrapper"),e=new a.a(this.plt,t);e.fromTo("opacity",.99,0),e.fromTo("scale",1,1.3);this.easing("ease-out").duration(150).add(e)},e}(s.a),m="top",v="middle",g=n(4);n.d(e,"a",function(){return b});var y=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),b=function(t){function e(e,n,i){void 0===n&&(n={});var a=this;return n.dismissOnPageChange=!!Object(r.l)(n.dismissOnPageChange)&&!!n.dismissOnPageChange,a=t.call(this,o.a,n,null)||this,a._app=e,n.position&&a.isValidPosition(n.position)||(n.position=w),a.isOverlay=!0,i.setTransition("toast-slide-in",u),i.setTransition("toast-slide-out",c),i.setTransition("toast-md-slide-in",h),i.setTransition("toast-md-slide-out",p),i.setTransition("toast-wp-slide-out",f),i.setTransition("toast-wp-slide-in",d),a}return y(e,t),e.prototype.getTransitionName=function(t){return this._nav&&this._nav.config.get("toast"+("back"===t?"Leave":"Enter"))},e.prototype.isValidPosition=function(t){return t===_||t===x||t===w},e.prototype.setMessage=function(t){return this.data.message=t,this},e.prototype.setDuration=function(t){return this.data.duration=t,this},e.prototype.setPosition=function(t){return this.data.position=t,this},e.prototype.setCssClass=function(t){return this.data.cssClass=t,this},e.prototype.setShowCloseButton=function(t){return this.data.showCloseButton=t,this},e.prototype.present=function(t){return void 0===t&&(t={}),t.disableApp=!1,t.keyboardClose=!1,this._app.present(this,t,i.d)},e.prototype.dismissAll=function(){this._nav&&this._nav.popAll()},e}(g.a),_="top",x="middle",w="bottom"},function(t,e,n){"use strict";function r(t){return t.testNavigatorPlatform("iphone|ipad|ipod")}function i(t){return t.testUserAgent("Safari")}e.a=function(t){var e=t.win();return!!(e.cordova||e.PhoneGap||e.phonegap)},e.b=function(t){return t.testUserAgent("Electron")},e.c=r,e.e=i,e.d=function(t){return r(t)&&!function(t){return r(t)&&!!t.win().webkit}(t)&&!i(t)}},function(t,e,n){"use strict";n(12),n(4),n(96)},function(t,e,n){"use strict";n(12),n(97)},function(t,e,n){"use strict";n(1),n(6),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}}()},function(t,e,n){"use strict";n(1),n(100)},function(t,e,n){"use strict";n(2)},function(t,e,n){"use strict";n(101),n(3),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}}()},function(t,e,n){"use strict";n(3),n(101),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}}()},function(t,e,n){"use strict";n(102)},function(t,e,n){"use strict";n(1),n(12),n(9),n(7),n(2),n(56),n(3),n(103),n(31),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}}()},function(t,e,n){"use strict";n(1),n(6),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}}()},function(t,e,n){"use strict";n(1),n(6),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}}()},function(t,e,n){"use strict";n(0),n(1),n(21),n(9),n(2),n(3),n(4),n(107),n(105),n(106)},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(0),i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.handleError=function(e){t.prototype.handleError.call(this,e);try{var n=window,r=void 0;(r=n.IonicDevServer)&&r.handleError&&r.handleError(e),(r=(n.Ionic=n.Ionic||{}).Monitor)&&r.handleError&&r.handleError(e)}catch(t){}},e}(r.k)},function(t,e,n){"use strict";function r(t){return c._22(0,[(t()(),c.Z(0,0,null,null,1,"div",[["class","action-sheet-title"]],[[8,"id",0]],null,null,null,null)),(t()(),c._20(1,null,["",""]))],null,function(t,e){var n=e.component;t(e,0,0,c._2(1,"",n.hdrId,""));t(e,1,0,n.d.title)})}function i(t){return c._22(0,[(t()(),c.Z(0,0,null,null,1,"div",[["class","action-sheet-sub-title"]],[[8,"id",0]],null,null,null,null)),(t()(),c._20(1,null,["",""]))],null,function(t,e){var n=e.component;t(e,0,0,c._2(1,"",n.descId,""));t(e,1,0,n.d.subTitle)})}function o(t){return c._22(0,[(t()(),c.Z(0,0,null,null,1,"ion-icon",[["class","action-sheet-icon"],["role","img"]],[[2,"hide",null]],null,null,null,null)),c.Y(1,147456,null,0,h.a,[p.a,c.j,c.z],{name:[0,"name"]},null)],function(t,e){t(e,1,0,e.parent.context.$implicit.icon)},function(t,e){t(e,0,0,c._11(e,1)._hidden)})}function a(t){return c._22(0,[(t()(),c.Z(0,0,null,null,5,"button",[["class","disable-hover"],["ion-button","action-sheet-button"]],[[1,"icon-start",0]],[[null,"click"]],function(t,e,n){var r=!0;if("click"===e){r=!1!==t.component.click(t.context.$implicit)&&r}return r},d.b,d.a)),c.Y(1,278528,null,0,f.h,[c.p,c.q,c.j,c.A],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),c.Y(2,1097728,null,0,m.a,[[8,"action-sheet-button"],p.a,c.j,c.z],null,null),(t()(),c.U(16777216,null,0,1,null,o)),c.Y(4,16384,null,0,f.j,[c.I,c.F],{ngIf:[0,"ngIf"]},null),(t()(),c._20(5,0,["",""]))],function(t,e){t(e,1,0,"disable-hover",e.context.$implicit.cssClass);t(e,4,0,e.context.$implicit.icon)},function(t,e){t(e,0,0,e.context.$implicit.icon?"":null);t(e,5,0,e.context.$implicit.text)})}function s(t){return c._22(0,[(t()(),c.Z(0,0,null,null,1,"ion-icon",[["class","action-sheet-icon"],["role","img"]],[[2,"hide",null]],null,null,null,null)),c.Y(1,147456,null,0,h.a,[p.a,c.j,c.z],{name:[0,"name"]},null)],function(t,e){t(e,1,0,e.component.cancelButton.icon)},function(t,e){t(e,0,0,c._11(e,1)._hidden)})}function l(t){return c._22(0,[(t()(),c.Z(0,0,null,null,6,"div",[["class","action-sheet-group action-sheet-group-cancel"]],null,null,null,null,null)),(t()(),c.Z(1,0,null,null,5,"button",[["class","action-sheet-cancel disable-hover"],["ion-button","action-sheet-button"]],[[1,"icon-start",0]],[[null,"click"]],function(t,e,n){var r=!0,i=t.component;if("click"===e){r=!1!==i.click(i.cancelButton)&&r}return r},d.b,d.a)),c.Y(2,278528,null,0,f.h,[c.p,c.q,c.j,c.A],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),c.Y(3,1097728,null,0,m.a,[[8,"action-sheet-button"],p.a,c.j,c.z],null,null),(t()(),c.U(16777216,null,0,1,null,s)),c.Y(5,16384,null,0,f.j,[c.I,c.F],{ngIf:[0,"ngIf"]},null),(t()(),c._20(6,0,["",""]))],function(t,e){var n=e.component;t(e,2,0,"action-sheet-cancel disable-hover",n.cancelButton.cssClass);t(e,5,0,n.cancelButton.icon)},function(t,e){var n=e.component;t(e,1,0,n.cancelButton.icon?"":null);t(e,6,0,n.cancelButton.text)})}function u(t){return c._22(0,[(t()(),c.Z(0,0,null,null,1,"ion-backdrop",[["disable-activated",""],["role","presentation"],["tappable",""]],[[2,"backdrop-no-tappable",null]],[[null,"click"]],function(t,e,n){var r=!0;if("click"===e){r=!1!==t.component.bdClick()&&r}return r},null,null)),c.Y(1,16384,null,0,v.a,[c.j,c.z],null,null),(t()(),c.Z(2,0,null,null,10,"div",[["class","action-sheet-wrapper"]],null,null,null,null,null)),(t()(),c.Z(3,0,null,null,9,"div",[["class","action-sheet-container"]],null,null,null,null,null)),(t()(),c.Z(4,0,null,null,6,"div",[["class","action-sheet-group"]],null,null,null,null,null)),(t()(),c.U(16777216,null,null,1,null,r)),c.Y(6,16384,null,0,f.j,[c.I,c.F],{ngIf:[0,"ngIf"]},null),(t()(),c.U(16777216,null,null,1,null,i)),c.Y(8,16384,null,0,f.j,[c.I,c.F],{ngIf:[0,"ngIf"]},null),(t()(),c.U(16777216,null,null,1,null,a)),c.Y(10,802816,null,0,f.i,[c.I,c.F,c.p],{ngForOf:[0,"ngForOf"]},null),(t()(),c.U(16777216,null,null,1,null,l)),c.Y(12,16384,null,0,f.j,[c.I,c.F],{ngIf:[0,"ngIf"]},null)],function(t,e){var n=e.component;t(e,6,0,n.d.title);t(e,8,0,n.d.subTitle);t(e,10,0,n.d.buttons);t(e,12,0,n.cancelButton)},function(t,e){t(e,0,0,!e.component.d.enableBackdropDismiss)})}n.d(e,"a",function(){return w});var c=n(0),h=n(40),p=n(1),d=n(39),f=n(16),m=n(20),v=n(23),g=n(58),y=n(4),b=n(7),_=n(10),x=c.X({encapsulation:2,styles:[],data:{}}),w=c.V("ion-action-sheet",g.a,function(t){return c._22(0,[(t()(),c.Z(0,0,null,null,1,"ion-action-sheet",[["role","dialog"]],[[1,"aria-labelledby",0],[1,"aria-describedby",0]],[["body","keyup"]],function(t,e,n){var r=!0;return"body:keyup"===e&&(r=!1!==c._11(t,1).keyUp(n)&&r),r},u,x)),c.Y(1,180224,null,0,g.a,[y.a,p.a,c.j,b.l,_.a,c.z],null,null)],null,function(t,e){t(e,0,0,c._11(e,1).hdrId,c._11(e,1).descId)})},{},{},[])},function(t,e,n){"use strict";function r(t){return f._22(0,[(t()(),f.Z(0,0,null,null,0,"h2",[["class","alert-title"]],[[8,"id",0],[8,"innerHTML",1]],null,null,null,null))],null,function(t,e){var n=e.component;t(e,0,0,f._2(1,"",n.hdrId,""),n.d.title)})}function i(t){return f._22(0,[(t()(),f.Z(0,0,null,null,0,"h3",[["class","alert-sub-title"]],[[8,"id",0],[8,"innerHTML",1]],null,null,null,null))],null,function(t,e){var n=e.component;t(e,0,0,f._2(1,"",n.subHdrId,""),n.d.subTitle)})}function o(t){return f._22(0,[(t()(),f.Z(0,0,null,null,5,"button",[["class","alert-tappable alert-radio"],["ion-button","alert-radio-button"],["role","radio"]],[[1,"aria-checked",0],[8,"disabled",0],[1,"id",0]],[[null,"click"]],function(t,e,n){var r=!0;if("click"===e){r=!1!==t.component.rbClick(t.context.$implicit)&&r}return r},m.b,m.a)),f.Y(1,1097728,null,0,v.a,[[8,"alert-radio-button"],g.a,f.j,f.z],null,null),(t()(),f.Z(2,0,null,0,1,"div",[["class","alert-radio-icon"]],null,null,null,null,null)),(t()(),f.Z(3,0,null,null,0,"div",[["class","alert-radio-inner"]],null,null,null,null,null)),(t()(),f.Z(4,0,null,0,1,"div",[["class","alert-radio-label"]],null,null,null,null,null)),(t()(),f._20(5,null,["",""]))],null,function(t,e){t(e,0,0,e.context.$implicit.checked,e.context.$implicit.disabled,e.context.$implicit.id);t(e,5,0,e.context.$implicit.label)})}function a(t){return f._22(0,[(t()(),f.Z(0,0,null,null,2,"div",[["class","alert-radio-group"],["role","radiogroup"]],[[1,"aria-labelledby",0],[1,"aria-activedescendant",0]],null,null,null,null)),(t()(),f.U(16777216,null,null,1,null,o)),f.Y(2,802816,null,0,y.i,[f.I,f.F,f.p],{ngForOf:[0,"ngForOf"]},null)],function(t,e){t(e,2,0,e.component.d.inputs)},function(t,e){var n=e.component;t(e,0,0,n.hdrId,n.activeId)})}function s(t){return f._22(0,[(t()(),f.Z(0,0,null,null,5,"button",[["class","alert-tappable alert-checkbox"],["ion-button","alert-checkbox-button"],["role","checkbox"]],[[1,"aria-checked",0],[1,"id",0],[8,"disabled",0]],[[null,"click"]],function(t,e,n){var r=!0;if("click"===e){r=!1!==t.component.cbClick(t.context.$implicit)&&r}return r},m.b,m.a)),f.Y(1,1097728,null,0,v.a,[[8,"alert-checkbox-button"],g.a,f.j,f.z],null,null),(t()(),f.Z(2,0,null,0,1,"div",[["class","alert-checkbox-icon"]],null,null,null,null,null)),(t()(),f.Z(3,0,null,null,0,"div",[["class","alert-checkbox-inner"]],null,null,null,null,null)),(t()(),f.Z(4,0,null,0,1,"div",[["class","alert-checkbox-label"]],null,null,null,null,null)),(t()(),f._20(5,null,["",""]))],null,function(t,e){t(e,0,0,e.context.$implicit.checked,e.context.$implicit.id,e.context.$implicit.disabled);t(e,5,0,e.context.$implicit.label)})}function l(t){return f._22(0,[(t()(),f.Z(0,0,null,null,2,"div",[["class","alert-checkbox-group"]],null,null,null,null,null)),(t()(),f.U(16777216,null,null,1,null,s)),f.Y(2,802816,null,0,y.i,[f.I,f.F,f.p],{ngForOf:[0,"ngForOf"]},null)],function(t,e){t(e,2,0,e.component.d.inputs)},null)}function u(t){return f._22(0,[(t()(),f.Z(0,0,null,null,6,"div",[["class","alert-input-wrapper"]],null,null,null,null,null)),(t()(),f.Z(1,0,null,null,5,"input",[["class","alert-input"],["dir","auto"]],[[8,"placeholder",0],[8,"type",0],[8,"min",0],[8,"max",0],[1,"id",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(t,e,n){var r=!0;if("input"===e){r=!1!==f._11(t,2)._handleInput(n.target.value)&&r}if("blur"===e){r=!1!==f._11(t,2).onTouched()&&r}if("compositionstart"===e){r=!1!==f._11(t,2)._compositionStart()&&r}if("compositionend"===e){r=!1!==f._11(t,2)._compositionEnd(n.target.value)&&r}if("ngModelChange"===e){r=!1!==(t.context.$implicit.value=n)&&r}return r},null,null)),f.Y(2,16384,null,0,b.b,[f.A,f.j,[2,b.a]],null,null),f._16(1024,null,b.e,function(t){return[t]},[b.b]),f.Y(4,671744,null,0,b.h,[[8,null],[8,null],[8,null],[2,b.e]],{model:[0,"model"]},{update:"ngModelChange"}),f._16(2048,null,b.f,null,[b.h]),f.Y(6,16384,null,0,b.g,[b.f],null,null)],function(t,e){t(e,4,0,e.context.$implicit.value)},function(t,e){t(e,1,1,[e.context.$implicit.placeholder,e.context.$implicit.type,e.context.$implicit.min,e.context.$implicit.max,e.context.$implicit.id,f._11(e,6).ngClassUntouched,f._11(e,6).ngClassTouched,f._11(e,6).ngClassPristine,f._11(e,6).ngClassDirty,f._11(e,6).ngClassValid,f._11(e,6).ngClassInvalid,f._11(e,6).ngClassPending])})}function c(t){return f._22(0,[(t()(),f.Z(0,0,null,null,2,"div",[["class","alert-input-group"]],null,null,null,null,null)),(t()(),f.U(16777216,null,null,1,null,u)),f.Y(2,802816,null,0,y.i,[f.I,f.F,f.p],{ngForOf:[0,"ngForOf"]},null)],function(t,e){t(e,2,0,e.component.d.inputs)},null)}function h(t){return f._22(0,[(t()(),f.Z(0,0,null,null,7,"div",[],null,null,null,null,null)),f.Y(1,16384,null,0,y.n,[],{ngSwitch:[0,"ngSwitch"]},null),(t()(),f.U(16777216,null,null,1,null,a)),f.Y(3,278528,null,0,y.o,[f.I,f.F,y.n],{ngSwitchCase:[0,"ngSwitchCase"]},null),(t()(),f.U(16777216,null,null,1,null,l)),f.Y(5,278528,null,0,y.o,[f.I,f.F,y.n],{ngSwitchCase:[0,"ngSwitchCase"]},null),(t()(),f.U(16777216,null,null,1,null,c)),f.Y(7,16384,null,0,y.p,[f.I,f.F,y.n],null,null)],function(t,e){t(e,1,0,e.component.inputType);t(e,3,0,"radio");t(e,5,0,"checkbox")},null)}function p(t){return f._22(0,[(t()(),f.Z(0,0,null,null,3,"button",[["ion-button","alert-button"]],null,[[null,"click"]],function(t,e,n){var r=!0;if("click"===e){r=!1!==t.component.btnClick(t.context.$implicit)&&r}return r},m.b,m.a)),f.Y(1,278528,null,0,y.h,[f.p,f.q,f.j,f.A],{ngClass:[0,"ngClass"]},null),f.Y(2,1097728,null,0,v.a,[[8,"alert-button"],g.a,f.j,f.z],null,null),(t()(),f._20(3,0,["",""]))],function(t,e){t(e,1,0,e.context.$implicit.cssClass)},function(t,e){t(e,3,0,e.context.$implicit.text)})}function d(t){return f._22(0,[(t()(),f.Z(0,0,null,null,1,"ion-backdrop",[["disable-activated",""],["role","presentation"],["tappable",""]],[[2,"backdrop-no-tappable",null]],[[null,"click"]],function(t,e,n){var r=!0;if("click"===e){r=!1!==t.component.bdClick()&&r}return r},null,null)),f.Y(1,16384,null,0,_.a,[f.j,f.z],null,null),(t()(),f.Z(2,0,null,null,13,"div",[["class","alert-wrapper"]],null,null,null,null,null)),(t()(),f.Z(3,0,null,null,4,"div",[["class","alert-head"]],null,null,null,null,null)),(t()(),f.U(16777216,null,null,1,null,r)),f.Y(5,16384,null,0,y.j,[f.I,f.F],{ngIf:[0,"ngIf"]},null),(t()(),f.U(16777216,null,null,1,null,i)),f.Y(7,16384,null,0,y.j,[f.I,f.F],{ngIf:[0,"ngIf"]},null),(t()(),f.Z(8,0,null,null,0,"div",[["class","alert-message"]],[[8,"id",0],[8,"innerHTML",1]],null,null,null,null)),(t()(),f.U(16777216,null,null,1,null,h)),f.Y(10,16384,null,0,y.j,[f.I,f.F],{ngIf:[0,"ngIf"]},null),(t()(),f.Z(11,0,null,null,4,"div",[["class","alert-button-group"]],null,null,null,null,null)),f.Y(12,278528,null,0,y.h,[f.p,f.q,f.j,f.A],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),f._14(13,{"alert-button-group-vertical":0}),(t()(),f.U(16777216,null,null,1,null,p)),f.Y(15,802816,null,0,y.i,[f.I,f.F,f.p],{ngForOf:[0,"ngForOf"]},null)],function(t,e){var n=e.component;t(e,5,0,n.d.title);t(e,7,0,n.d.subTitle);t(e,10,0,n.d.inputs.length);t(e,12,0,"alert-button-group",t(e,13,0,n.d.buttons.length>2));t(e,15,0,n.d.buttons)},function(t,e){var n=e.component;t(e,0,0,!n.d.enableBackdropDismiss);t(e,8,0,f._2(1,"",n.msgId,""),n.d.message)})}n.d(e,"a",function(){return C});var f=n(0),m=n(39),v=n(20),g=n(1),y=n(16),b=n(17),_=n(23),x=n(59),w=n(4),S=n(7),A=n(10),M=n(3),T=f.X({encapsulation:2,styles:[],data:{}}),C=f.V("ion-alert",x.a,function(t){return f._22(0,[(t()(),f.Z(0,0,null,null,1,"ion-alert",[["role","dialog"]],[[1,"aria-labelledby",0],[1,"aria-describedby",0]],[["body","keyup"]],function(t,e,n){var r=!0;return"body:keyup"===e&&(r=!1!==f._11(t,1).keyUp(n)&&r),r},d,T)),f.Y(1,180224,null,0,x.a,[w.a,f.j,g.a,S.l,A.a,f.z,M.a],null,null)],null,function(t,e){t(e,0,0,f._11(e,1).hdrId,f._11(e,1).descId)})},{},{},[])},function(t,e,n){"use strict";function r(t){return i._22(0,[i._18(402653184,1,{_viewport:0}),i._18(402653184,2,{_modalPortal:0}),i._18(402653184,3,{_overlayPortal:0}),i._18(402653184,4,{_loadingPortal:0}),i._18(402653184,5,{_toastPortal:0}),(t()(),i.Z(5,16777216,[[1,3],["viewport",1]],null,0,"div",[["app-viewport",""]],null,null,null,null,null)),(t()(),i.Z(6,16777216,[["modalPortal",1]],null,1,"div",[["overlay-portal",""]],null,null,null,null,null)),i.Y(7,147456,[[2,4]],0,o.a,[a.a,s.a,l.a,i.j,i.u,i.z,i.i,u.l,c.a,[2,h.a],i.I,p.a,i.k],{_overlayPortal:[0,"_overlayPortal"]},null),(t()(),i.Z(8,16777216,[["overlayPortal",1]],null,1,"div",[["overlay-portal",""]],null,null,null,null,null)),i.Y(9,147456,[[3,4]],0,o.a,[a.a,s.a,l.a,i.j,i.u,i.z,i.i,u.l,c.a,[2,h.a],i.I,p.a,i.k],{_overlayPortal:[0,"_overlayPortal"]},null),(t()(),i.Z(10,16777216,[["loadingPortal",1]],null,1,"div",[["class","loading-portal"],["overlay-portal",""]],null,null,null,null,null)),i.Y(11,147456,[[4,4]],0,o.a,[a.a,s.a,l.a,i.j,i.u,i.z,i.i,u.l,c.a,[2,h.a],i.I,p.a,i.k],{_overlayPortal:[0,"_overlayPortal"]},null),(t()(),i.Z(12,16777216,[["toastPortal",1]],null,1,"div",[["class","toast-portal"]],null,null,null,null,null)),i.Y(13,147456,[[5,4]],0,o.a,[a.a,s.a,l.a,i.j,i.u,i.z,i.i,u.l,c.a,[2,h.a],i.I,p.a,i.k],{_overlayPortal:[0,"_overlayPortal"]},null),(t()(),i.Z(14,0,null,null,1,"div",[["class","click-block"]],null,null,null,null,null)),i.Y(15,16384,null,0,d.a,[a.a,s.a,l.a,i.j,i.z],null,null)],function(t,e){t(e,7,0,"");t(e,9,0,"");t(e,11,0,"");t(e,13,0,1e4)},null)}n.d(e,"a",function(){return v});var i=n(0),o=n(82),a=n(8),s=n(1),l=n(3),u=n(7),c=n(31),h=n(12),p=n(9),d=n(169),f=n(45),m=i.X({encapsulation:2,styles:[],data:{}}),v=i.V("ion-app",f.b,function(t){return i._22(0,[(t()(),i.Z(0,0,null,null,1,"ion-app",[],null,null,null,r,m)),i.Y(1,114688,null,0,f.b,[f.a,i.i,i.j,i.z,s.a,l.a,a.a],null,null)],function(t,e){t(e,1,0)},null)},{color:"color",mode:"mode"},{},[])},function(t,e,n){"use strict";function r(t){return a._22(0,[(t()(),a.Z(0,0,null,null,2,"div",[["class","loading-spinner"]],null,null,null,null,null)),(t()(),a.Z(1,0,null,null,1,"ion-spinner",[],[[2,"spinner-paused",null]],null,null,s.b,s.a)),a.Y(2,114688,null,0,l.a,[u.a,a.j,a.z],{name:[0,"name"]},null)],function(t,e){t(e,2,0,e.component.d.spinner)},function(t,e){t(e,1,0,a._11(e,2)._paused)})}function i(t){return a._22(0,[(t()(),a.Z(0,0,null,null,0,"div",[["class","loading-content"]],[[8,"innerHTML",1]],null,null,null,null))],null,function(t,e){t(e,0,0,e.component.d.content)})}function o(t){return a._22(0,[(t()(),a.Z(0,0,null,null,1,"ion-backdrop",[["disable-activated",""],["role","presentation"],["tappable",""]],[[8,"hidden",0],[2,"backdrop-no-tappable",null]],[[null,"click"]],function(t,e,n){var r=!0;if("click"===e){r=!1!==t.component.bdClick()&&r}return r},null,null)),a.Y(1,16384,null,0,c.a,[a.j,a.z],null,null),(t()(),a.Z(2,0,null,null,4,"div",[["class","loading-wrapper"]],null,null,null,null,null)),(t()(),a.U(16777216,null,null,1,null,r)),a.Y(4,16384,null,0,h.j,[a.I,a.F],{ngIf:[0,"ngIf"]},null),(t()(),a.U(16777216,null,null,1,null,i)),a.Y(6,16384,null,0,h.j,[a.I,a.F],{ngIf:[0,"ngIf"]},null)],function(t,e){var n=e.component;t(e,4,0,n.showSpinner);t(e,6,0,n.d.content)},function(t,e){var n=e.component;t(e,0,0,!n.d.showBackdrop,!n.d.enableBackdropDismiss)})}n.d(e,"a",function(){return g});var a=n(0),s=n(197),l=n(55),u=n(1),c=n(23),h=n(16),p=n(63),d=n(4),f=n(7),m=n(10),v=a.X({encapsulation:2,styles:[],data:{}}),g=a.V("ion-loading",p.a,function(t){return a._22(0,[(t()(),a.Z(0,0,null,null,1,"ion-loading",[["role","dialog"]],null,[["body","keyup"]],function(t,e,n){var r=!0;return"body:keyup"===e&&(r=!1!==a._11(t,1).keyUp(n)&&r),r},o,v)),a.Y(1,245760,null,0,p.a,[d.a,u.a,a.j,f.l,m.a,a.z],null,null)],function(t,e){t(e,1,0)},null)},{},{},[])},function(t,e,n){"use strict";function r(t){return i._22(0,[i._18(402653184,1,{_viewport:0}),(t()(),i.Z(1,0,null,null,1,"ion-backdrop",[["disable-activated",""],["role","presentation"],["tappable",""]],[[2,"backdrop-no-tappable",null]],[[null,"click"]],function(t,e,n){var r=!0;if("click"===e){r=!1!==t.component._bdClick()&&r}return r},null,null)),i.Y(2,16384,null,0,o.a,[i.j,i.z],null,null),(t()(),i.Z(3,0,null,null,1,"div",[["class","modal-wrapper"]],null,null,null,null,null)),(t()(),i.Z(4,16777216,[[1,3],["viewport",1]],null,0,"div",[["nav-viewport",""]],null,null,null,null,null))],null,function(t,e){t(e,1,0,!e.component._bdDismiss)})}n.d(e,"a",function(){return p});var i=n(0),o=n(23),a=n(64),s=n(10),l=n(4),u=n(7),c=n(36),h=i.X({encapsulation:2,styles:[],data:{}}),p=i.V("ion-modal",a.a,function(t){return i._22(0,[(t()(),i.Z(0,0,null,null,1,"ion-modal",[],null,[["body","keyup"]],function(t,e,n){var r=!0;return"body:keyup"===e&&(r=!1!==i._11(t,1)._keyUp(n)&&r),r},r,h)),i.Y(1,180224,null,0,a.a,[i.i,i.z,i.j,s.a,l.a,u.l,c.b],null,null)],null,null)},{},{},[])},function(t,e,n){"use strict";function r(t){return c._22(0,[(t()(),c.Z(0,0,null,null,1,"div",[["class","picker-prefix"]],[[4,"width",null]],null,null,null,null)),(t()(),c._20(1,null,["",""]))],null,function(t,e){var n=e.component;t(e,0,0,n.col.prefixWidth);t(e,1,0,n.col.prefix)})}function i(t){return c._22(0,[(t()(),c.Z(0,0,null,null,1,"button",[["class","picker-opt"],["disable-activated",""]],[[2,"picker-opt-disabled",null]],[[null,"click"]],function(t,e,n){var r=!0;if("click"===e){r=!1!==t.component.optClick(n,t.context.index)&&r}return r},null,null)),(t()(),c._20(1,null,["",""]))],null,function(t,e){t(e,0,0,e.context.$implicit.disabled);t(e,1,0,e.context.$implicit.text)})}function o(t){return c._22(0,[(t()(),c.Z(0,0,null,null,1,"div",[["class","picker-suffix"]],[[4,"width",null]],null,null,null,null)),(t()(),c._20(1,null,["",""]))],null,function(t,e){var n=e.component;t(e,0,0,n.col.suffixWidth);t(e,1,0,n.col.suffix)})}function a(t){return c._22(0,[c._18(402653184,1,{colEle:0}),(t()(),c.U(16777216,null,null,1,null,r)),c.Y(2,16384,null,0,h.j,[c.I,c.F],{ngIf:[0,"ngIf"]},null),(t()(),c.Z(3,0,[[1,0],["colEle",1]],null,2,"div",[["class","picker-opts"]],[[4,"max-width",null]],null,null,null,null)),(t()(),c.U(16777216,null,null,1,null,i)),c.Y(5,802816,null,0,h.i,[c.I,c.F,c.p],{ngForOf:[0,"ngForOf"]},null),(t()(),c.U(16777216,null,null,1,null,o)),c.Y(7,16384,null,0,h.j,[c.I,c.F],{ngIf:[0,"ngIf"]},null)],function(t,e){var n=e.component;t(e,2,0,n.col.prefix);t(e,5,0,n.col.options);t(e,7,0,n.col.suffix)},function(t,e){t(e,3,0,e.component.col.optionsWidth)})}function s(t){return c._22(0,[(t()(),c.Z(0,0,null,null,7,"div",[["class","picker-toolbar-button"]],null,null,null,null,null)),c.Y(1,278528,null,0,h.h,[c.p,c.q,c.j,c.A],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),(t()(),c._20(-1,null,["\n          "])),(t()(),c.Z(3,0,null,null,3,"button",[["class","picker-button"],["clear",""],["ion-button",""]],null,[[null,"click"]],function(t,e,n){var r=!0;if("click"===e){r=!1!==t.component.btnClick(t.context.$implicit)&&r}return r},p.b,p.a)),c.Y(4,278528,null,0,h.h,[c.p,c.q,c.j,c.A],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),c.Y(5,1097728,null,0,d.a,[[8,""],f.a,c.j,c.z],{clear:[0,"clear"]},null),(t()(),c._20(6,0,["\n            ","\n          "])),(t()(),c._20(-1,null,["\n        "]))],function(t,e){t(e,1,0,"picker-toolbar-button",e.context.$implicit.cssRole);t(e,4,0,"picker-button",e.context.$implicit.cssClass);t(e,5,0,"")},function(t,e){t(e,6,0,e.context.$implicit.text)})}function l(t){return c._22(0,[(t()(),c.Z(0,0,null,null,1,"div",[["class","picker-col"]],[[4,"max-width",null],[2,"picker-opts-left",null],[2,"picker-opts-right",null]],[[null,"ionChange"]],function(t,e,n){var r=!0;if("ionChange"===e){r=!1!==t.component._colChange(n)&&r}return r},a,b)),c.Y(1,4374528,[[1,4]],0,m.a,[f.a,v.a,c.j,c.u,g.a,v.a,y.a],{col:[0,"col"]},{ionChange:"ionChange"})],function(t,e){t(e,1,0,e.context.$implicit)},function(t,e){t(e,0,0,c._11(e,1).col.columnWidth,"left"==c._11(e,1).col.align,"right"==c._11(e,1).col.align)})}function u(t){return c._22(0,[c._18(671088640,1,{_cols:1}),(t()(),c._20(-1,null,["\n    "])),(t()(),c.Z(2,0,null,null,1,"ion-backdrop",[["disable-activated",""],["role","presentation"],["tappable",""]],null,[[null,"click"]],function(t,e,n){var r=!0;if("click"===e){r=!1!==t.component.bdClick()&&r}return r},null,null)),c.Y(3,16384,null,0,_.a,[c.j,c.z],null,null),(t()(),c._20(-1,null,["\n    "])),(t()(),c.Z(5,0,null,null,17,"div",[["class","picker-wrapper"]],null,null,null,null,null)),(t()(),c._20(-1,null,["\n      "])),(t()(),c.Z(7,0,null,null,4,"div",[["class","picker-toolbar"]],null,null,null,null,null)),(t()(),c._20(-1,null,["\n        "])),(t()(),c.U(16777216,null,null,1,null,s)),c.Y(10,802816,null,0,h.i,[c.I,c.F,c.p],{ngForOf:[0,"ngForOf"]},null),(t()(),c._20(-1,null,["\n      "])),(t()(),c._20(-1,null,["\n      "])),(t()(),c.Z(13,0,null,null,8,"div",[["class","picker-columns"]],null,null,null,null,null)),(t()(),c._20(-1,null,["\n        "])),(t()(),c.Z(15,0,null,null,0,"div",[["class","picker-above-highlight"]],null,null,null,null,null)),(t()(),c._20(-1,null,["\n        "])),(t()(),c.U(16777216,null,null,1,null,l)),c.Y(18,802816,null,0,h.i,[c.I,c.F,c.p],{ngForOf:[0,"ngForOf"]},null),(t()(),c._20(-1,null,["\n        "])),(t()(),c.Z(20,0,null,null,0,"div",[["class","picker-below-highlight"]],null,null,null,null,null)),(t()(),c._20(-1,null,["\n      "])),(t()(),c._20(-1,null,["\n    "])),(t()(),c._20(-1,null,["\n  "]))],function(t,e){var n=e.component;t(e,10,0,n.d.buttons);t(e,18,0,n.d.columns)},null)}var c=n(0),h=n(16),p=n(39),d=n(20),f=n(1),m=n(48),v=n(3),g=n(25),y=n(9),b=c.X({encapsulation:2,styles:[],data:{}}),_=n(23),x=n(61),w=n(4),S=n(7),A=n(10);n.d(e,"a",function(){return T});var M=c.X({encapsulation:2,styles:[],data:{}}),T=c.V("ion-picker-cmp",x.a,function(t){return c._22(0,[(t()(),c.Z(0,0,null,null,1,"ion-picker-cmp",[["role","dialog"]],null,[["body","keyup"]],function(t,e,n){var r=!0;return"body:keyup"===e&&(r=!1!==c._11(t,1)._keyUp(n)&&r),r},u,M)),c.Y(1,180224,null,0,x.a,[w.a,c.j,f.a,S.l,A.a,c.z],null,null)],null,null)},{},{},[])},function(t,e,n){"use strict";function r(t){return i._22(0,[i._18(402653184,1,{_viewport:0}),(t()(),i.Z(1,0,null,null,1,"ion-backdrop",[["disable-activated",""],["role","presentation"],["tappable",""]],[[8,"hidden",0]],[[null,"click"]],function(t,e,n){var r=!0;if("click"===e){r=!1!==t.component._bdClick()&&r}return r},null,null)),i.Y(2,16384,null,0,o.a,[i.j,i.z],null,null),(t()(),i.Z(3,0,null,null,4,"div",[["class","popover-wrapper"]],null,null,null,null,null)),(t()(),i.Z(4,0,null,null,0,"div",[["class","popover-arrow"]],null,null,null,null,null)),(t()(),i.Z(5,0,null,null,2,"div",[["class","popover-content"]],null,null,null,null,null)),(t()(),i.Z(6,0,null,null,1,"div",[["class","popover-viewport"]],null,null,null,null,null)),(t()(),i.Z(7,16777216,[[1,3],["viewport",1]],null,0,"div",[["nav-viewport",""]],null,null,null,null,null))],null,function(t,e){t(e,1,0,!e.component.d.showBackdrop)})}n.d(e,"a",function(){return d});var i=n(0),o=n(23),a=n(65),s=n(1),l=n(10),u=n(4),c=n(7),h=n(36),p=i.X({encapsulation:2,styles:[],data:{}}),d=i.V("ion-popover",a.a,function(t){return i._22(0,[(t()(),i.Z(0,0,null,null,1,"ion-popover",[],null,[["body","keyup"]],function(t,e,n){var r=!0;return"body:keyup"===e&&(r=!1!==i._11(t,1)._keyUp(n)&&r),r},r,p)),i.Y(1,180224,null,0,a.a,[i.i,i.j,i.z,s.a,l.a,u.a,c.l,h.b],null,null)],null,null)},{},{},[])},function(t,e,n){"use strict";function r(t){return a._22(0,[(t()(),a.Z(0,0,null,null,3,"div",[["class","radio-icon"]],[[2,"radio-checked",null]],null,null,null,null)),(t()(),a._20(-1,null,[" "])),(t()(),a.Z(2,0,null,null,0,"div",[["class","radio-inner"]],null,null,null,null,null)),(t()(),a._20(-1,null,[" "])),(t()(),a._20(-1,null,[" "])),(t()(),a.Z(5,0,null,null,2,"button",[["class","item-cover"],["ion-button","item-cover"],["role","radio"],["type","button"]],[[8,"id",0],[1,"aria-checked",0],[1,"aria-labelledby",0],[1,"aria-disabled",0]],null,null,f.b,f.a)),a.Y(6,1097728,null,0,m.a,[[8,"item-cover"],c.a,a.j,a.z],null,null),(t()(),a._20(-1,0,[" "]))],null,function(t,e){var n=e.component;t(e,0,0,n._checked);t(e,5,0,n.id,n._checked,n._labelId,n._disabled)})}function i(t){return a._22(0,[(t()(),a.Z(0,0,null,null,13,"ion-item",[["class","item item-block"]],null,null,null,s.b,s.a)),a.Y(1,1097728,null,3,l.a,[u.a,c.a,a.j,a.z,[2,h.a]],null,null),a._18(335544320,2,{contentLabel:0}),a._18(603979776,3,{_buttons:1}),a._18(603979776,4,{_icons:1}),a.Y(5,16384,null,0,p.a,[],null,null),(t()(),a._20(-1,2,["\n        "])),(t()(),a.Z(7,0,null,1,2,"ion-label",[],null,null,null,null,null)),a.Y(8,16384,[[2,4]],0,d.a,[c.a,a.j,a.z,[8,null],[8,null],[8,null],[8,null]],null,null),(t()(),a._20(9,null,["",""])),(t()(),a._20(-1,2,["\n        "])),(t()(),a.Z(11,0,null,4,1,"ion-radio",[],[[2,"radio-disabled",null]],[[null,"click"]],function(t,e,n){var r=!0;if("click"===e){r=!1!==a._11(t,12)._click(n)&&r}return r},r,y)),a.Y(12,245760,null,0,v.a,[u.a,c.a,a.j,a.z,[2,l.a],[2,g.a]],{value:[0,"value"],checked:[1,"checked"],disabled:[2,"disabled"]},null),(t()(),a._20(-1,2,["\n      "]))],function(t,e){t(e,12,0,e.context.$implicit.value,e.context.$implicit.checked,e.context.$implicit.disabled)},function(t,e){t(e,9,0,e.context.$implicit.text);t(e,11,0,a._11(e,12)._disabled)})}function o(t){return a._22(0,[(t()(),a._20(-1,null,["\n    "])),(t()(),a.Z(1,0,null,null,11,"ion-list",[["radio-group",""],["role","radiogroup"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"]],function(t,e,n){var r=!0;if("ngModelChange"===e){r=!1!==(t.component.value=n)&&r}return r},null,null)),a.Y(2,1064960,null,1,g.a,[a.z,a.j,a.g],null,null),a._18(335544320,1,{_header:0}),a._16(1024,null,b.e,function(t){return[t]},[g.a]),a.Y(5,671744,null,0,b.h,[[8,null],[8,null],[8,null],[2,b.e]],{model:[0,"model"]},{update:"ngModelChange"}),a._16(2048,null,b.f,null,[b.h]),a.Y(7,16384,null,0,b.g,[b.f],null,null),a.Y(8,16384,null,0,_.a,[c.a,a.j,a.z,x.a,w.l,S.a],null,null),(t()(),a._20(-1,null,["\n      "])),(t()(),a.U(16777216,null,null,1,null,i)),a.Y(11,802816,null,0,A.i,[a.I,a.F,a.p],{ngForOf:[0,"ngForOf"]},null),(t()(),a._20(-1,null,["\n    "])),(t()(),a._20(-1,null,["\n  "]))],function(t,e){var n=e.component;t(e,5,0,n.value);t(e,11,0,n.options)},function(t,e){t(e,1,0,a._11(e,7).ngClassUntouched,a._11(e,7).ngClassTouched,a._11(e,7).ngClassPristine,a._11(e,7).ngClassDirty,a._11(e,7).ngClassValid,a._11(e,7).ngClassInvalid,a._11(e,7).ngClassPending)})}var a=n(0),s=n(195),l=n(18),u=n(13),c=n(1),h=n(42),p=n(71),d=n(43),f=n(39),m=n(20),v=n(66),g=n(50),y=a.X({encapsulation:2,styles:[],data:{}}),b=n(17),_=n(54),x=n(3),w=n(7),S=n(9),A=n(16),M=n(67),T=n(10),C=n(4);n.d(e,"a",function(){return P});var E=a.X({encapsulation:2,styles:[],data:{}}),P=a.V("ng-component",M.a,function(t){return a._22(0,[(t()(),a.Z(0,0,null,null,1,"ng-component",[],null,null,null,o,E)),a.Y(1,114688,null,0,M.a,[T.a,C.a],null,null)],function(t,e){t(e,1,0)},null)},{},{},[])},function(t,e,n){"use strict";function r(t){return a._22(0,[(t()(),a.Z(0,0,null,null,1,"div",[["class","toast-message"]],[[8,"id",0]],null,null,null,null)),(t()(),a._20(1,null,["",""]))],null,function(t,e){var n=e.component;t(e,0,0,a._2(1,"",n.hdrId,""));t(e,1,0,n.d.message)})}function i(t){return a._22(0,[(t()(),a.Z(0,0,null,null,2,"button",[["class","toast-button"],["clear",""],["ion-button",""]],null,[[null,"click"]],function(t,e,n){var r=!0;if("click"===e){r=!1!==t.component.cbClick()&&r}return r},s.b,s.a)),a.Y(1,1097728,null,0,l.a,[[8,""],u.a,a.j,a.z],{clear:[0,"clear"]},null),(t()(),a._20(2,0,[" "," "]))],function(t,e){t(e,1,0,"")},function(t,e){t(e,2,0,e.component.d.closeButtonText||"Close")})}function o(t){return a._22(0,[(t()(),a.Z(0,0,null,null,10,"div",[["class","toast-wrapper"]],[[2,"toast-bottom",null],[2,"toast-middle",null],[2,"toast-top",null]],null,null,null,null)),(t()(),a._20(-1,null,[" "])),(t()(),a.Z(2,0,null,null,7,"div",[["class","toast-container"]],null,null,null,null,null)),(t()(),a._20(-1,null,[" "])),(t()(),a.U(16777216,null,null,1,null,r)),a.Y(5,16384,null,0,c.j,[a.I,a.F],{ngIf:[0,"ngIf"]},null),(t()(),a._20(-1,null,[" "])),(t()(),a.U(16777216,null,null,1,null,i)),a.Y(8,16384,null,0,c.j,[a.I,a.F],{ngIf:[0,"ngIf"]},null),(t()(),a._20(-1,null,[" "])),(t()(),a._20(-1,null,[" "]))],function(t,e){var n=e.component;t(e,5,0,n.d.message);t(e,8,0,n.d.showCloseButton)},function(t,e){var n=e.component;t(e,0,0,"bottom"===n.d.position,"middle"===n.d.position,"top"===n.d.position)})}n.d(e,"a",function(){return m});var a=n(0),s=n(39),l=n(20),u=n(1),c=n(16),h=n(68),p=n(4),d=n(10),f=a.X({encapsulation:2,styles:[],data:{}}),m=a.V("ion-toast",h.a,function(t){return a._22(0,[(t()(),a.Z(0,0,null,null,1,"ion-toast",[["role","dialog"]],[[1,"aria-labelledby",0],[1,"aria-describedby",0]],null,null,o,f)),a.Y(1,4243456,null,0,h.a,[p.a,u.a,a.j,d.a,a.z],null,null)],null,function(t,e){t(e,0,0,a._11(e,1).hdrId,a._11(e,1).descId)})},{},{},[])},function(t,e,n){"use strict";function r(t){return i._22(2,[i._18(402653184,1,{_fixedContent:0}),i._18(402653184,2,{_scrollContent:0}),(t()(),i.Z(2,0,[[1,0],["fixedContent",1]],null,1,"div",[["class","fixed-content"]],null,null,null,null,null)),i._10(null,0),(t()(),i.Z(4,0,[[2,0],["scrollContent",1]],null,1,"div",[["class","scroll-content"]],null,null,null,null,null)),i._10(null,1),i._10(null,2)],null,null)}n.d(e,"a",function(){return o}),e.b=r;var i=n(0),o=(n(1),n(3),n(9),n(24),n(4),n(19),i.X({encapsulation:2,styles:[],data:{}}))},function(t,e,n){"use strict";function r(t){return s._22(0,[(t()(),s.Z(0,0,null,null,1,"ion-icon",[["name","reorder"],["role","img"]],[[2,"hide",null]],null,null,null,null)),s.Y(1,147456,null,0,c.a,[u.a,s.j,s.z],{name:[0,"name"]},null)],function(t,e){t(e,1,0,"reorder")},function(t,e){t(e,0,0,s._11(e,1)._hidden)})}function i(t){return s._22(0,[(t()(),s.Z(0,0,null,null,2,"ion-label",[],null,null,null,null,null)),s.Y(1,16384,[[1,4]],0,l.a,[u.a,s.j,s.z,[8,null],[8,null],[8,null],[8,null]],null,null),s._10(null,2)],null,null)}function o(t){return s._22(0,[(t()(),s.Z(0,0,null,null,1,"ion-reorder",[],null,[[null,"click"]],function(t,e,n){var r=!0;if("click"===e){r=!1!==s._11(t,1).onClick(n)&&r}return r},r,p)),s.Y(1,49152,null,0,h.a,[s.j],null,null)],null,null)}function a(t){return s._22(2,[s._18(671088640,1,{viewLabel:0}),s._10(null,0),(t()(),s.Z(2,0,null,null,8,"div",[["class","item-inner"]],null,null,null,null,null)),(t()(),s.Z(3,0,null,null,4,"div",[["class","input-wrapper"]],null,null,null,null,null)),s._10(null,1),(t()(),s.U(16777216,null,null,1,null,i)),s.Y(6,16384,null,0,d.j,[s.I,s.F],{ngIf:[0,"ngIf"]},null),s._10(null,3),s._10(null,4),(t()(),s.U(16777216,null,null,1,null,o)),s.Y(10,16384,null,0,d.j,[s.I,s.F],{ngIf:[0,"ngIf"]},null),(t()(),s.Z(11,0,null,null,0,"div",[["class","button-effect"]],null,null,null,null,null))],function(t,e){var n=e.component;t(e,6,0,n._viewLabel);t(e,10,0,n._hasReorder)},null)}var s=n(0),l=n(43),u=n(1),c=n(40),h=n(62),p=s.X({encapsulation:2,styles:[],data:{}}),d=n(16);n(18),n(13),n(42);n.d(e,"a",function(){return f}),e.b=a;var f=s.X({encapsulation:2,styles:[],data:{}})},function(t,e,n){"use strict";function r(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("Matrix4: the constructor no longer reads arguments. use .set() instead.")}function i(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}function o(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==r?r:1}function a(){}function s(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._order=r||s.DefaultOrder}function l(){this.mask=1}function u(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("Matrix3: the constructor no longer reads arguments. use .set() instead.")}function c(){Object.defineProperty(this,"id",{value:wo++}),this.uuid=xo.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=c.DefaultUp.clone();var t=new i,e=new s,n=new o,a=new i(1,1,1);e.onChange(function(){n.setFromEuler(e,!1)}),n.onChange(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:t},rotation:{enumerable:!0,value:e},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:a},modelViewMatrix:{value:new r},normalMatrix:{value:new u}}),this.matrix=new r,this.matrixWorld=new r,this.matrixAutoUpdate=c.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new l,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function h(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function p(t,e,n,r,o,a){this.a=t,this.b=e,this.c=n,this.normal=r&&r.isVector3?r:new i,this.vertexNormals=Array.isArray(r)?r:[],this.color=o&&o.isColor?o:new h,this.vertexColors=Array.isArray(o)?o:[],this.materialIndex=void 0!==a?a:0}function d(t,e){this.min=void 0!==t?t:new i(1/0,1/0,1/0),this.max=void 0!==e?e:new i(-1/0,-1/0,-1/0)}function f(t,e){this.center=void 0!==t?t:new i,this.radius=void 0!==e?e:0}function m(t,e){this.x=t||0,this.y=e||0}function v(){Object.defineProperty(this,"id",{value:Ao+=2}),this.uuid=xo.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function g(t,e,n,r){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==r?r:1}function y(t,e,n){if(Array.isArray(t))throw new TypeError("BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function b(t,e,n){y.call(this,new Int8Array(t),e,n)}function _(t,e,n){y.call(this,new Uint8Array(t),e,n)}function x(t,e,n){y.call(this,new Uint8ClampedArray(t),e,n)}function w(t,e,n){y.call(this,new Int16Array(t),e,n)}function S(t,e,n){y.call(this,new Uint16Array(t),e,n)}function A(t,e,n){y.call(this,new Int32Array(t),e,n)}function M(t,e,n){y.call(this,new Uint32Array(t),e,n)}function T(t,e,n){y.call(this,new Float32Array(t),e,n)}function C(t,e,n){y.call(this,new Float64Array(t),e,n)}function E(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function P(t){if(0===t.length)return-1/0;for(var e=t[0],n=1,r=t.length;n<r;++n)t[n]>e&&(e=t[n]);return e}function O(){Object.defineProperty(this,"id",{value:Mo+=2}),this.uuid=xo.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function N(t,e,n,r,i,o,a){v.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new L(t,e,n,r,i,o,a)),this.mergeVertices()}function L(t,e,n,r,o,a,s){O.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:o,thetaStart:a,thetaLength:s},t=t||1,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,o=void 0!==o?o:2*Math.PI;var l,u,c=(a=void 0!==a?a:0)+(s=void 0!==s?s:Math.PI),h=0,p=[],d=new i,f=new i,m=[],v=[],g=[],y=[];for(u=0;u<=n;u++){var b=[],_=u/n;for(l=0;l<=e;l++){var x=l/e;d.x=-t*Math.cos(r+x*o)*Math.sin(a+_*s),d.y=t*Math.cos(a+_*s),d.z=t*Math.sin(r+x*o)*Math.sin(a+_*s),v.push(d.x,d.y,d.z),f.set(d.x,d.y,d.z).normalize(),g.push(f.x,f.y,f.z),y.push(x,1-_),b.push(h++)}p.push(b)}for(u=0;u<n;u++)for(l=0;l<e;l++){var w=p[u][l],S=p[u+1][l],A=p[u+1][l+1];(0!==u||a>0)&&m.push(p[u][l+1],w,A),(u!==n-1||c<Math.PI)&&m.push(w,S,A)}this.setIndex(m),this.addAttribute("position",new T(v,3)),this.addAttribute("normal",new T(g,3)),this.addAttribute("uv",new T(y,2))}function I(){Object.defineProperty(this,"id",{value:Xs++}),this.uuid=xo.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=Vo,this.side=Fo,this.flatShading=!1,this.vertexColors=Uo,this.opacity=1,this.transparent=!1,this.blendSrc=na,this.blendDst=ra,this.blendEquation=Yo,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=pa,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function D(t){I.call(this),this.type="MeshBasicMaterial",this.color=new h(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ga,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(t)}function F(t){I.call(this),this.type="LineBasicMaterial",this.color=new h(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(t)}function R(t,e){this.origin=void 0!==t?t:new i,this.direction=void 0!==e?e:new i}function k(t,e){this.start=void 0!==t?t:new i,this.end=void 0!==e?e:new i}function U(t,e){this.normal=void 0!==t?t:new i(1,0,0),this.constant=void 0!==e?e:0}function j(t,e,n){this.a=void 0!==t?t:new i,this.b=void 0!==e?e:new i,this.c=void 0!==n?n:new i}function B(t,e){c.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new O,this.material=void 0!==e?e:new D({color:16777215*Math.random()}),this.drawMode=Ds,this.updateMorphTargets()}function z(t,e,n){1===n&&console.error("Line: parameter LinePieces no longer supported. Created LineSegments instead."),c.call(this),this.type="Line",this.geometry=void 0!==t?t:new O,this.material=void 0!==e?e:new F({color:16777215*Math.random()})}function V(){c.call(this),this.type="Bone"}function G(t,e,n,r,i,o){v.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o},this.fromBufferGeometry(new H(t,e,n,r,i,o)),this.mergeVertices()}function H(t,e,n,r,o,a){function s(t,e,n,r,o,a,s,m,v,g,y){var b,_,x=a/v,w=s/g,S=a/2,A=s/2,M=m/2,T=v+1,C=g+1,E=0,P=0,O=new i;for(_=0;_<C;_++){var N=_*w-A;for(b=0;b<T;b++){O[t]=(b*x-S)*r,O[e]=N*o,O[n]=M,c.push(O.x,O.y,O.z),O[t]=0,O[e]=0,O[n]=m>0?1:-1,h.push(O.x,O.y,O.z),p.push(b/v),p.push(1-_/g),E+=1}}for(_=0;_<g;_++)for(b=0;b<v;b++){var L=d+b+T*(_+1),I=d+(b+1)+T*(_+1),D=d+(b+1)+T*_;u.push(d+b+T*_,L,D),u.push(L,I,D),P+=6}l.addGroup(f,P,y),f+=P,d+=E}O.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:o,depthSegments:a};var l=this;t=t||1,e=e||1,n=n||1,r=Math.floor(r)||1,o=Math.floor(o)||1;var u=[],c=[],h=[],p=[],d=0,f=0;s("z","y","x",-1,-1,n,e,t,a=Math.floor(a)||1,o,0),s("z","y","x",1,-1,n,e,-t,a,o,1),s("x","z","y",1,1,t,n,e,r,a,2),s("x","z","y",1,-1,t,n,-e,r,a,3),s("x","y","z",1,-1,t,e,n,r,o,4),s("x","y","z",-1,-1,t,e,-n,r,o,5),this.setIndex(u),this.addAttribute("position",new T(c,3)),this.addAttribute("normal",new T(h,3)),this.addAttribute("uv",new T(p,2))}function W(t,e,n,r,i,o,a,s){v.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new X(t,e,n,r,i,o,a,s)),this.mergeVertices()}function X(t,e,n,r,o,a,s,l){function u(n){var o,a,u,g=new m,_=new i,x=0,w=!0===n?t:e,S=!0===n?1:-1;for(a=v,o=1;o<=r;o++)p.push(0,y*S,0),d.push(0,S,0),f.push(.5,.5),v++;for(u=v,o=0;o<=r;o++){var A=o/r*l+s,M=Math.cos(A),T=Math.sin(A);_.x=w*T,_.y=y*S,_.z=w*M,p.push(_.x,_.y,_.z),d.push(0,S,0),g.x=.5*M+.5,g.y=.5*T*S+.5,f.push(g.x,g.y),v++}for(o=0;o<r;o++){var C=a+o,E=u+o;!0===n?h.push(E,E+1,C):h.push(E+1,E,C),x+=3}c.addGroup(b,x,!0===n?1:2),b+=x}O.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:o,openEnded:a,thetaStart:s,thetaLength:l};var c=this;t=void 0!==t?t:1,e=void 0!==e?e:1,n=n||1,r=Math.floor(r)||8,o=Math.floor(o)||1,a=void 0!==a&&a,s=void 0!==s?s:0,l=void 0!==l?l:2*Math.PI;var h=[],p=[],d=[],f=[],v=0,g=[],y=n/2,b=0;!function(){var a,u,m=new i,_=new i,x=0,w=(e-t)/n;for(u=0;u<=o;u++){var S=[],A=u/o,M=A*(e-t)+t;for(a=0;a<=r;a++){var T=a/r,C=T*l+s,E=Math.sin(C),P=Math.cos(C);_.x=M*E,_.y=-A*n+y,_.z=M*P,p.push(_.x,_.y,_.z),m.set(E,w,P).normalize(),d.push(m.x,m.y,m.z),f.push(T,1-A),S.push(v++)}g.push(S)}for(a=0;a<r;a++)for(u=0;u<o;u++){var O=g[u+1][a],N=g[u+1][a+1],L=g[u][a+1];h.push(g[u][a],O,L),h.push(O,N,L),x+=6}c.addGroup(b,x,0),b+=x}(),!1===a&&(t>0&&u(!0),e>0&&u(!1)),this.setIndex(h),this.addAttribute("position",new T(p,3)),this.addAttribute("normal",new T(d,3)),this.addAttribute("uv",new T(f,2))}function Y(t,e,n,r){rt.call(this,t,e,n,r)}function q(t,e,n){rt.call(this,t,e,n)}function Z(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function Q(t,e,n,r){Z.call(this,t,e,n,r)}function J(t,e,n,r){rt.call(this,t,e,n,r)}function K(t,e,n,r){rt.call(this,t,e,n,r)}function $(t,e,n,r){rt.call(this,t,e,n,r)}function tt(t,e,n,r){Z.call(this,t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function et(t,e,n,r){Z.call(this,t,e,n,r)}function nt(t,e,n,r){Z.call(this,t,e,n,r)}function rt(t,e,n,r){if(void 0===t)throw new Error("KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Js.convertArray(e,this.TimeBufferType),this.values=Js.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation),this.validate(),this.optimize()}function it(t,e,n,r){rt.call(this,t,e,n,r)}function ot(t,e,n){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.uuid=xo.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function at(){c.call(this),this.type="Camera",this.matrixWorldInverse=new r,this.projectionMatrix=new r}function st(t,e,n,r){at.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function lt(t){I.call(this),this.type="MeshDepthMaterial",this.depthPacking=Hs,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(t)}function ut(){c.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function ct(t,e,n,r,i,o){at.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function ht(t,e,n,r,i,o,a,s,l,c){Object.defineProperty(this,"id",{value:$s++}),this.uuid=xo.generateUUID(),this.name="",this.image=void 0!==t?t:ht.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:ht.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:Da,this.wrapT=void 0!==r?r:Da,this.magFilter=void 0!==i?i:ja,this.minFilter=void 0!==o?o:za,this.anisotropy=void 0!==l?l:1,this.format=void 0!==a?a:ns,this.type=void 0!==s?s:Va,this.offset=new m(0,0),this.repeat=new m(1,1),this.center=new m(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new u,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==c?c:ks,this.version=0,this.onUpdate=null}function pt(t,e,n){this.width=t,this.height=e,this.scissor=new g(0,0,t,e),this.scissorTest=!1,this.viewport=new g(0,0,t,e),void 0===(n=n||{}).minFilter&&(n.minFilter=ja),this.texture=new ht(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function dt(t){I.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("ShaderMaterial: attributes should now be defined in BufferGeometry instead."),this.setValues(t))}function ft(t,e,n,r){v.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new mt(t,e,n,r)),this.mergeVertices()}function mt(t,e,n,r){O.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};var i,o,a=(t=t||1)/2,s=(e=e||1)/2,l=Math.floor(n)||1,u=Math.floor(r)||1,c=l+1,h=u+1,p=t/l,d=e/u,f=[],m=[],v=[],g=[];for(o=0;o<h;o++){var y=o*d-s;for(i=0;i<c;i++){m.push(i*p-a,-y,0),v.push(0,0,1),g.push(i/l),g.push(1-o/u)}}for(o=0;o<u;o++)for(i=0;i<l;i++){var b=i+c*(o+1),_=i+1+c*(o+1),x=i+1+c*o;f.push(i+c*o,b,x),f.push(b,_,x)}this.setIndex(f),this.addAttribute("position",new T(m,3)),this.addAttribute("normal",new T(v,3)),this.addAttribute("uv",new T(g,2))}function vt(t,e,n){var r=this,i=!1,o=0,a=0,s=void 0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===i&&void 0!==r.onStart&&r.onStart(t,o,a),i=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,a),o===a&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this}}function gt(t){this.manager=void 0!==t?t:il}function yt(t){F.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}function bt(t){I.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new i,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(t)}function _t(t){I.call(this),this.type="MeshLambertMaterial",this.color=new h(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new h(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ga,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function xt(t){I.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new m(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function wt(t){I.call(this),this.type="MeshPhongMaterial",this.color=new h(16777215),this.specular=new h(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new h(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new m(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ga,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function St(t){I.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new h(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new h(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new m(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function At(t){St.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(t)}function Mt(t){wt.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(t)}function Tt(t){I.call(this),this.type="PointsMaterial",this.color=new h(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(t)}function Ct(t){dt.call(this,t),this.type="RawShaderMaterial"}function Et(t){I.call(this),this.type="ShadowMaterial",this.color=new h(0),this.transparent=!0,this.setValues(t)}function Pt(t){I.call(this),this.type="SpriteMaterial",this.color=new h(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(t)}function Ot(t){this.manager=void 0!==t?t:il,this.textures={}}function Nt(t){this.manager=void 0!==t?t:il}function Lt(t){this.manager=void 0!==t?t:il}function It(){}function Dt(t){"boolean"==typeof t&&(console.warn("JSONLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:il,this.withCredentials=!1}function Ft(t,e,n,r){this.ray=new R(t,e),this.near=n||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Rt(t,e){return t.distance-e.distance}function kt(t,e,n,r){if(!1!==t.visible&&(t.raycast(e,n),!0===r))for(var i=t.children,o=0,a=i.length;o<a;o++)kt(i[o],e,n,!0)}function Ut(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}function jt(t,e,n,r){v.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},this.fromBufferGeometry(new Bt(t,e,n,r)),this.mergeVertices()}function Bt(t,e,n,r){function o(t){u.push(t.x,t.y,t.z)}function a(e,n){var r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function s(t,e,n,r){r<0&&1===t.x&&(c[e]=t.x-1),0===n.x&&0===n.z&&(c[e]=r/2/Math.PI+.5)}function l(t){return Math.atan2(t.z,-t.x)}O.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},n=n||1;var u=[],c=[];!function(t){for(var n=new i,r=new i,s=new i,l=0;l<e.length;l+=3)a(e[l+0],n),a(e[l+1],r),a(e[l+2],s),function(t,e,n,r){var i,a,s=Math.pow(2,r),l=[];for(i=0;i<=s;i++){l[i]=[];var u=t.clone().lerp(n,i/s),c=e.clone().lerp(n,i/s),h=s-i;for(a=0;a<=h;a++)l[i][a]=0===a&&i===s?u:u.clone().lerp(c,a/h)}for(i=0;i<s;i++)for(a=0;a<2*(s-i)-1;a++){var p=Math.floor(a/2);a%2==0?(o(l[i][p+1]),o(l[i+1][p]),o(l[i][p])):(o(l[i][p+1]),o(l[i+1][p+1]),o(l[i+1][p]))}}(n,r,s,t)}(r=r||0),function(t){for(var e=new i,n=0;n<u.length;n+=3)e.x=u[n+0],e.y=u[n+1],e.z=u[n+2],e.normalize().multiplyScalar(t),u[n+0]=e.x,u[n+1]=e.y,u[n+2]=e.z}(n),function(){for(var t=new i,e=0;e<u.length;e+=3){t.x=u[e+0],t.y=u[e+1],t.z=u[e+2];var n=l(t)/2/Math.PI+.5,r=function(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}(t)/Math.PI+.5;c.push(n,1-r)}!function(){for(var t=new i,e=new i,n=new i,r=new i,o=new m,a=new m,h=new m,p=0,d=0;p<u.length;p+=9,d+=6){t.set(u[p+0],u[p+1],u[p+2]),e.set(u[p+3],u[p+4],u[p+5]),n.set(u[p+6],u[p+7],u[p+8]),o.set(c[d+0],c[d+1]),a.set(c[d+2],c[d+3]),h.set(c[d+4],c[d+5]),r.copy(t).add(e).add(n).divideScalar(3);var f=l(r);s(o,d+0,t,f),s(a,d+2,e,f),s(h,d+4,n,f)}}(),function(){for(var t=0;t<c.length;t+=6){var e=c[t+0],n=c[t+2],r=c[t+4],i=Math.max(e,n,r),o=Math.min(e,n,r);i>.9&&o<.1&&(e<.2&&(c[t+0]+=1),n<.2&&(c[t+2]+=1),r<.2&&(c[t+4]+=1))}}()}(),this.addAttribute("position",new T(u,3)),this.addAttribute("normal",new T(u.slice(),3)),this.addAttribute("uv",new T(c,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function zt(t,e){v.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Vt(t,e)),this.mergeVertices()}function Vt(t,e){Bt.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Gt(t,e,n,r,i){v.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new Ht(t,e,n,r,i)),this.mergeVertices()}function Ht(t,e,n,r,o){O.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:o},t=t||1,e=e||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,o=o||2*Math.PI;var a,s,l=[],u=[],c=[],h=[],p=new i,d=new i,f=new i;for(a=0;a<=n;a++)for(s=0;s<=r;s++){var m=s/r*o,v=a/n*Math.PI*2;d.x=(t+e*Math.cos(v))*Math.cos(m),d.y=(t+e*Math.cos(v))*Math.sin(m),d.z=e*Math.sin(v),u.push(d.x,d.y,d.z),p.x=t*Math.cos(m),p.y=t*Math.sin(m),f.subVectors(d,p).normalize(),c.push(f.x,f.y,f.z),h.push(s/r),h.push(a/n)}for(a=1;a<=n;a++)for(s=1;s<=r;s++){var g=(r+1)*(a-1)+s-1,y=(r+1)*(a-1)+s,b=(r+1)*a+s;l.push((r+1)*a+s-1,g,b),l.push(g,y,b)}this.setIndex(l),this.addAttribute("position",new T(u,3)),this.addAttribute("normal",new T(c,3)),this.addAttribute("uv",new T(h,2))}function Wt(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new qt,this.unassigned=new qt,this.vertices=[]}function Xt(){this.normal=new i,this.midpoint=new i,this.area=0,this.constant=0,this.outside=null,this.mark=Sl,this.edge=null}function Yt(t,e){this.vertex=t,this.prev=null,this.next=null,this.twin=null,this.face=e}function qt(){this.head=null,this.tail=null}function Zt(t){v.call(this),this.fromBufferGeometry(new Qt(t)),this.mergeVertices()}function Qt(t){O.call(this);var e=[],n=[];void 0===Wt&&console.error("ConvexBufferGeometry: ConvexBufferGeometry relies on QuickHull");for(var r=(new Wt).setFromPoints(t).faces,i=0;i<r.length;i++){var o=r[i],a=o.edge;do{var s=a.head().point;e.push(s.x,s.y,s.z),n.push(o.normal.x,o.normal.y,o.normal.z),a=a.next}while(a!==o.edge)}this.addAttribute("position",new T(e,3)),this.addAttribute("normal",new T(n,3))}function Jt(){this.type="Curve",this.arcLengthDivisions=200}function Kt(){Jt.call(this)}function $t(t){Jt.call(this),this.scale=void 0===t?5:t}function te(t){Jt.call(this),this.scale=void 0===t?70:t}function ee(){Jt.call(this)}function ne(){Jt.call(this)}function re(t){Jt.call(this),this.scale=void 0===t?10:t}function ie(t){Jt.call(this),this.scale=void 0===t?10:t}function ae(t){Jt.call(this),this.scale=void 0===t?10:t}function se(t){Jt.call(this),this.scale=void 0===t?10:t}function le(t){Jt.call(this),this.scale=void 0===t?1:t}function ue(t){Jt.call(this),this.scale=void 0===t?40:t}function ce(t){Jt.call(this),this.scale=void 0===t?40:t}function he(t){Jt.call(this),this.scale=void 0===t?40:t}function pe(t){Jt.call(this),this.scale=void 0===t?40:t}function de(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new st,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new st,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function fe(t,e,n){var r=n||me.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function me(t,e,n){this.path=e,this.parsedPath=n||me.parseTrackName(e),this.node=me.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function ve(t,e,n,o){function a(e,n,r){n.applyMatrix4(t.matrix),n.applyMatrix4(f),e.push(new ge(n.clone(),r.clone()))}function s(t,e){for(var n=[],r=.5*Math.abs(o.dot(e)),i=0;i<t.length;i+=3){var a,s,u,c,h,p,d;switch(a=t[i+0].position.dot(e)-r>0,s=t[i+1].position.dot(e)-r>0,u=t[i+2].position.dot(e)-r>0,(a?1:0)+(s?1:0)+(u?1:0)){case 0:n.push(t[i]),n.push(t[i+1]),n.push(t[i+2]);break;case 1:if(a&&(h=t[i+2],p=l(t[i],c=t[i+1],e,r),d=l(t[i],h,e,r)),s){h=t[i+2],p=l(t[i+1],c=t[i],e,r),d=l(t[i+1],h,e,r),n.push(p),n.push(h.clone()),n.push(c.clone()),n.push(h.clone()),n.push(p.clone()),n.push(d);break}u&&(h=t[i+1],p=l(t[i+2],c=t[i],e,r),d=l(t[i+2],h,e,r)),n.push(c.clone()),n.push(h.clone()),n.push(p),n.push(d),n.push(p.clone()),n.push(h.clone());break;case 2:a||(h=l(c=t[i].clone(),t[i+1],e,r),p=l(c,t[i+2],e,r),n.push(c),n.push(h),n.push(p)),s||(h=l(c=t[i+1].clone(),t[i+2],e,r),p=l(c,t[i],e,r),n.push(c),n.push(h),n.push(p)),u||(h=l(c=t[i+2].clone(),t[i],e,r),p=l(c,t[i+1],e,r),n.push(c),n.push(h),n.push(p))}}return n}function l(t,e,n,r){var o=t.position.dot(n)-r,a=o/(o-(e.position.dot(n)-r));return new ge(new i(t.position.x+a*(e.position.x-t.position.x),t.position.y+a*(e.position.y-t.position.y),t.position.z+a*(e.position.z-t.position.z)),new i(t.normal.x+a*(e.normal.x-t.normal.x),t.normal.y+a*(e.normal.y-t.normal.y),t.normal.z+a*(e.normal.z-t.normal.z)))}O.call(this);var u=[],c=[],h=[],p=new i,d=new r;d.makeRotationFromEuler(n),d.setPosition(e);var f=(new r).getInverse(d);!function(){var e,n=new O,r=[],l=new i,f=new i;t.geometry.isGeometry?n.fromGeometry(t.geometry):n.copy(t.geometry);var m=n.attributes.position,v=n.attributes.normal;if(null!==n.index){var g=n.index;for(e=0;e<g.count;e++)l.fromBufferAttribute(m,g.getX(e)),f.fromBufferAttribute(v,g.getX(e)),a(r,l,f)}else for(e=0;e<m.count;e++)l.fromBufferAttribute(m,e),f.fromBufferAttribute(v,e),a(r,l,f);for(r=s(r=s(r=s(r=s(r=s(r=s(r,p.set(1,0,0)),p.set(-1,0,0)),p.set(0,1,0)),p.set(0,-1,0)),p.set(0,0,1)),p.set(0,0,-1)),e=0;e<r.length;e++){var y=r[e];h.push(.5+y.position.x/o.x,.5+y.position.y/o.y),y.position.applyMatrix4(d),u.push(y.position.x,y.position.y,y.position.z),c.push(y.normal.x,y.normal.y,y.normal.z)}}(),this.addAttribute("position",new T(u,3)),this.addAttribute("normal",new T(c,3)),this.addAttribute("uv",new T(h,2))}function ge(t,e){this.position=t,this.normal=e}function ye(t,e,n,r,i,o,a,s,l,u,c,h){ht.call(this,null,o,a,s,l,u,r,i,c,h),this.image={data:t,width:e,height:n},this.magFilter=void 0!==l?l:Ra,this.minFilter=void 0!==u?u:Ra,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function be(t,e){c.call(this),this.type="Points",this.geometry=void 0!==t?t:new O,this.material=void 0!==e?e:new Tt({color:16777215*Math.random()})}function _e(){O.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function xe(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function we(t,e,n){xe.call(this,t,e),this.meshPerAttribute=n||1}function Se(t,e,n,r){this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}function Ae(t){O.call(this),this.type="WireframeGeometry";var e,n,r,o,a,s,l,u,c,h,p=[],d=[0,0],f={},m=["a","b","c"];if(t&&t.isGeometry){var v=t.faces;for(e=0,r=v.length;e<r;e++){var g=v[e];for(n=0;n<3;n++)l=g[m[n]],u=g[m[(n+1)%3]],d[0]=Math.min(l,u),d[1]=Math.max(l,u),void 0===f[c=d[0]+","+d[1]]&&(f[c]={index1:d[0],index2:d[1]})}for(c in f)p.push((h=t.vertices[(s=f[c]).index1]).x,h.y,h.z),p.push((h=t.vertices[s.index2]).x,h.y,h.z)}else if(t&&t.isBufferGeometry){var y,b,_,x,w;if(h=new i,null!==t.index){for(y=t.attributes.position,b=t.index,0===(_=t.groups).length&&(_=[{start:0,count:b.count,materialIndex:0}]),o=0,a=_.length;o<a;++o)for(e=w=(x=_[o]).start,r=w+x.count;e<r;e+=3)for(n=0;n<3;n++)l=b.getX(e+n),u=b.getX(e+(n+1)%3),d[0]=Math.min(l,u),d[1]=Math.max(l,u),void 0===f[c=d[0]+","+d[1]]&&(f[c]={index1:d[0],index2:d[1]});for(c in f)h.fromBufferAttribute(y,(s=f[c]).index1),p.push(h.x,h.y,h.z),h.fromBufferAttribute(y,s.index2),p.push(h.x,h.y,h.z)}else for(e=0,r=(y=t.attributes.position).count/3;e<r;e++)for(n=0;n<3;n++)h.fromBufferAttribute(y,3*e+n),p.push(h.x,h.y,h.z),h.fromBufferAttribute(y,3*e+(n+1)%3),p.push(h.x,h.y,h.z)}this.addAttribute("position",new T(p,3))}function Me(){c.call(this),this.type="Group"}function Te(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new r)}}function Ce(t,e){B.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new r,this.bindMatrixInverse=new r;var n=new Te(this.initBones());this.bind(n,this.matrixWorld),this.normalizeSkinWeights()}function Ee(){this.id=0,this.data=null}function Pe(){}function Oe(t,e){c.call(this),this.type="Light",this.color=new h(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function Ne(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new m(512,512),this.map=null,this.matrix=new r}function Le(t,e,n,r){Oe.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new Ne(new st(90,1,.5,500))}function Ie(){Ne.call(this,new ct(-5,5,5,-5,.5,500))}function De(t,e){Oe.call(this,t,e),this.type="DirectionalLight",this.position.copy(c.DefaultUp),this.updateMatrix(),this.target=new c,this.shadow=new Ie}function Fe(){Ne.call(this,new st(50,1,.5,500))}function Re(t,e,n,r,i,o){Oe.call(this,t,e),this.type="SpotLight",this.position.copy(c.DefaultUp),this.updateMatrix(),this.target=new c,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new Fe}function ke(t,e,n){Oe.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(c.DefaultUp),this.updateMatrix(),this.groundColor=new h(e)}function Ue(t,e){Oe.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function je(t,e){z.call(this,t,e),this.type="LineSegments"}function Be(t,e,n,r,i,o,a,s,l,u,c,h){ht.call(this,null,o,a,s,l,u,r,i,c,h),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function ze(t){this.manager=void 0!==t?t:il,this._parser=null}function Ve(t,e){z.call(this,t,e),this.type="LineLoop"}function Ge(t){this.manager=void 0!==t?t:il,this._parser=null}function He(t){var e={},n={};if("Video"in t.Objects){var r=t.Objects.Video;for(var i in r){var o=r[i];if(e[s=parseInt(i)]=o.Filename,"Content"in o){if(o.Content instanceof ArrayBuffer&&o.Content.byteLength>0||"string"==typeof o.Content&&""!==o.Content){var a=function(t){var e,n=t.Content,r=t.RelativeFilename||t.Filename,i=r.slice(r.lastIndexOf(".")+1).toLowerCase();switch(i){case"bmp":e="image/bmp";break;case"jpg":case"jpeg":e="image/jpeg";break;case"png":e="image/png";break;case"tif":e="image/tiff";break;default:return void console.warn('FBXLoader: Image type "'+i+'" is not supported.')}if("string"==typeof n)return"data:"+e+";base64,"+n;var o=new Uint8Array(n);return window.URL.createObjectURL(new Blob([o],{type:e}))}(r[i]);n[o.Filename]=a}}}}for(var s in e){var l=e[s];e[s]=void 0!==n[l]?n[l]:e[s].split("\\").pop()}return e}function We(t,e,n,r){var i=new Map;if("Texture"in t.Objects){var o=t.Objects.Texture;for(var a in o){var s=function(t,e,n,r){var i=function(t,e,n,r){var i,o=e.path,a=r.get(t.id).children;void 0!==a&&a.length>0&&void 0!==n[a[0].ID]&&(0!==(i=n[a[0].ID]).indexOf("blob:")&&0!==i.indexOf("data:")||e.setPath(void 0));var s=e.load(i);return e.setPath(o),s}(t,e,n,r);i.ID=t.id,i.name=t.attrName;var o=t.WrapModeU,a=t.WrapModeV,s=void 0!==o?o.value:0,l=void 0!==a?a.value:0;if(i.wrapS=0===s?Ia:Da,i.wrapT=0===l?Ia:Da,"Scaling"in t){var u=t.Scaling.value;i.repeat.x=u[0],i.repeat.y=u[1]}return i}(o[a],e,n,r);i.set(parseInt(a),s)}}return i}function Xe(t,e,n){var r=new Map;if("Material"in t.Objects){var i=t.Objects.Material;for(var o in i){var a=function(t,e,n,r){var i=e.id,o=e.attrName,a=e.ShadingModel;"object"==typeof a&&(a=a.value);if(!r.has(i))return null;var s,l=function(t,e,n,r,i){var o={};e.BumpFactor&&(o.bumpScale=e.BumpFactor.value);e.Diffuse?o.color=(new h).fromArray(e.Diffuse.value):e.DiffuseColor&&"Color"===e.DiffuseColor.type&&(o.color=(new h).fromArray(e.DiffuseColor.value));e.DisplacementFactor&&(o.displacementScale=e.DisplacementFactor.value);e.ReflectionFactor&&(o.reflectivity=e.ReflectionFactor.value);e.Specular?o.specular=(new h).fromArray(e.Specular.value):e.SpecularColor&&"Color"===e.SpecularColor.type&&(o.emissive=(new h).fromArray(e.SpecularColor.value));e.Shininess&&(o.shininess=e.Shininess.value);e.Emissive?o.emissive=(new h).fromArray(e.Emissive.value):e.EmissiveColor&&"Color"===e.EmissiveColor.type&&(o.emissive=(new h).fromArray(e.EmissiveColor.value));e.EmissiveFactor&&(o.emissiveIntensity=parseFloat(e.EmissiveFactor.value));e.Opacity&&(o.opacity=parseFloat(e.Opacity.value));o.opacity<1&&(o.transparent=!0);return i.get(r).children.forEach(function(e){var r=e.relationship;switch(r){case"Bump":o.bumpMap=n.get(e.ID);break;case"DiffuseColor":o.map=Ye(t,n,e.ID,i);break;case"DisplacementColor":o.displacementMap=Ye(t,n,e.ID,i);break;case"EmissiveColor":o.emissiveMap=Ye(t,n,e.ID,i);break;case"NormalMap":o.normalMap=Ye(t,n,e.ID,i);break;case"ReflectionColor":o.envMap=Ye(t,n,e.ID,i),o.envMap.mapping=Ea;break;case"SpecularColor":o.specularMap=Ye(t,n,e.ID,i);break;case"TransparentColor":o.alphaMap=Ye(t,n,e.ID,i),o.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("FBXLoader: %s map is not supported in three.js, skipping texture.",r)}}),o}(t,e,n,i,r);switch(a.toLowerCase()){case"phong":s=new wt;break;case"lambert":s=new _t;break;default:console.warn('FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',a),s=new wt({color:3342591})}return s.setValues(l),s.name=o,s}(t,i[o],e,n);null!==a&&r.set(parseInt(o),a)}}return r}function Ye(t,e,n,r){return"LayeredTexture"in t.Objects&&n in t.Objects.LayeredTexture&&(console.warn("FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),n=r.get(n).children[0].ID),e.get(n)}function qe(t,e){var n={};if("Deformer"in t.Objects){var i=t.Objects.Deformer;for(var o in i){if("Skin"===i[o].attrType){var a=e.get(parseInt(o)),s=function(t,e){var n=[];return t.children.forEach(function(t){var i=e[t.ID];if("Cluster"===i.attrType){var o={ID:t.ID,indices:[],weights:[],transform:(new r).fromArray(i.Transform.a),transformLink:(new r).fromArray(i.TransformLink.a),linkMode:i.Mode};"Indexes"in i&&(o.indices=i.Indexes.a,o.weights=i.Weights.a),n.push(o)}}),{rawBones:n,bones:[]}}(a,i);s.ID=o,a.parents.length>1&&console.warn("FBXLoader: skeleton attached to more than one geometry is not supported."),s.geometryID=a.parents[0].ID,n[o]=s}}}return n}function Ze(t,e,n){var o=new Map;if("Geometry"in t.Objects){var a=t.Objects.Geometry;for(var l in a){var c=function(t,e,n,o){switch(n.attrType){case"Mesh":return function(t,e,n,o){var a=e.parents.map(function(e){return t.Objects.Model[e.ID]});if(0===a.length)return;var l=e.children.reduce(function(t,e){return void 0!==o[e.ID]&&(t=o[e.ID]),t},null),c=new r,h=a[0];if("GeometricRotation"in h){var p=h.GeometricRotation.value.map(xo.degToRad);p[3]="ZYX",c.makeRotationFromEuler((new s).fromArray(p))}"GeometricTranslation"in h&&c.setPosition((new i).fromArray(h.GeometricTranslation.value));"GeometricScaling"in h&&c.scale((new i).fromArray(h.GeometricScaling.value));return function(t,e,n,r,i){var o=n.Vertices.a,a=n.PolygonVertexIndex.a,s=[],l=[],c=[],h=[],p=[],d=[],f=[];if(n.LayerElementColor)var m=function(t){var e=t.ReferenceInformationType,n=[];"IndexToDirect"===e&&(n=t.ColorIndex.a);return{dataSize:4,buffer:t.Colors.a,indices:n,mappingType:t.MappingInformationType,referenceType:e}}(n.LayerElementColor[0]);if(n.LayerElementMaterial)var v=function(t){var e=t.MappingInformationType,n=t.ReferenceInformationType;if("NoMappingInformation"===e)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};for(var r=t.Materials.a,i=[],o=0;o<r.length;++o)i.push(o);return{dataSize:1,buffer:r,indices:i,mappingType:e,referenceType:n}}(n.LayerElementMaterial[0]);if(n.LayerElementNormal)var g=function(t){var e=t.ReferenceInformationType,n=[];"IndexToDirect"===e&&("NormalIndex"in t?n=t.NormalIndex.a:"NormalsIndex"in t&&(n=t.NormalsIndex.a));return{dataSize:3,buffer:t.Normals.a,indices:n,mappingType:t.MappingInformationType,referenceType:e}}(n.LayerElementNormal[0]);if(n.LayerElementUV)for(var y=[],b=0;n.LayerElementUV[b];)y.push(function(t){var e=t.ReferenceInformationType,n=[];"IndexToDirect"===e&&(n=t.UVIndex.a);return{dataSize:2,buffer:t.UV.a,indices:n,mappingType:t.MappingInformationType,referenceType:e}}(n.LayerElementUV[b])),b++;var _={};null!==r&&r.rawBones.forEach(function(t,e){t.indices.forEach(function(n,r){void 0===_[n]&&(_[n]=[]),_[n].push({id:e,weight:t.weights[r]})})});var x=0,w=0,S=!1,A=[],M=[],C=[],E=[],P=[],N=[];a.forEach(function(t,e){var n=!1;t<0&&(a[e]=t^=-1,n=!0);var i=[],u=[];if(A.push(3*t,3*t+1,3*t+2),m){var b=Qe(e,x,t,m);C.push(b[0],b[1],b[2])}if(r){if(void 0!==_[t]&&_[t].forEach(function(t){u.push(t.weight),i.push(t.id)}),u.length>4){S||(console.warn("FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),S=!0);var T=[0,0,0,0],O=[0,0,0,0];u.forEach(function(t,e){var n=t,r=i[e];O.forEach(function(t,e,i){if(n>t){i[e]=n,n=t;var o=T[e];T[e]=r,r=o}})}),i=T,u=O}for(;u.length<4;)u.push(0),i.push(0);for(var L=0;L<4;++L)P.push(u[L]),N.push(i[L])}if(g){var b=Qe(e,x,t,g);M.push(b[0],b[1],b[2])}if(v&&"AllSame"!==v.mappingType)var I=Qe(e,x,t,v)[0];if(y&&y.forEach(function(n,r){var i=Qe(e,x,t,n);void 0===E[r]&&(E[r]=[]),E[r].push(i[0]),E[r].push(i[1])}),w++,n){for(var L=2;L<w;L++)s.push(o[A[0]]),s.push(o[A[1]]),s.push(o[A[2]]),s.push(o[A[3*(L-1)]]),s.push(o[A[3*(L-1)+1]]),s.push(o[A[3*(L-1)+2]]),s.push(o[A[3*L]]),s.push(o[A[3*L+1]]),s.push(o[A[3*L+2]]),r&&(d.push(P[0]),d.push(P[1]),d.push(P[2]),d.push(P[3]),d.push(P[4*(L-1)]),d.push(P[4*(L-1)+1]),d.push(P[4*(L-1)+2]),d.push(P[4*(L-1)+3]),d.push(P[4*L]),d.push(P[4*L+1]),d.push(P[4*L+2]),d.push(P[4*L+3]),f.push(N[0]),f.push(N[1]),f.push(N[2]),f.push(N[3]),f.push(N[4*(L-1)]),f.push(N[4*(L-1)+1]),f.push(N[4*(L-1)+2]),f.push(N[4*(L-1)+3]),f.push(N[4*L]),f.push(N[4*L+1]),f.push(N[4*L+2]),f.push(N[4*L+3])),m&&(c.push(C[0]),c.push(C[1]),c.push(C[2]),c.push(C[3*(L-1)]),c.push(C[3*(L-1)+1]),c.push(C[3*(L-1)+2]),c.push(C[3*L]),c.push(C[3*L+1]),c.push(C[3*L+2])),v&&"AllSame"!==v.mappingType&&(p.push(I),p.push(I),p.push(I)),g&&(l.push(M[0]),l.push(M[1]),l.push(M[2]),l.push(M[3*(L-1)]),l.push(M[3*(L-1)+1]),l.push(M[3*(L-1)+2]),l.push(M[3*L]),l.push(M[3*L+1]),l.push(M[3*L+2])),y&&y.forEach(function(t,e){void 0===h[e]&&(h[e]=[]),h[e].push(E[e][0]),h[e].push(E[e][1]),h[e].push(E[e][2*(L-1)]),h[e].push(E[e][2*(L-1)+1]),h[e].push(E[e][2*L]),h[e].push(E[e][2*L+1])});x++,w=0,A=[],M=[],C=[],E=[],P=[],N=[]}});var L=new O;L.name=n.name;var I=new T(s,3);i.applyToBufferAttribute(I),L.addAttribute("position",I),c.length>0&&L.addAttribute("color",new T(c,3));r&&(L.addAttribute("skinIndex",new T(f,4)),L.addAttribute("skinWeight",new T(d,4)),L.FBX_Deformer=r);if(l.length>0){var D=new T(l,3),F=(new u).getNormalMatrix(i);F.applyToBufferAttribute(D),L.addAttribute("normal",D)}if(h.forEach(function(t,e){var n="uv"+(e+1).toString();0===e&&(n="uv"),L.addAttribute(n,new T(h[e],2))}),v&&"AllSame"!==v.mappingType){var R=p[0],k=0;if(p.forEach(function(t,e){t!==R&&(L.addGroup(k,e-k,R),R=t,k=e)}),L.groups.length>0){var U=L.groups[L.groups.length-1],j=U.start+U.count;j!==p.length&&L.addGroup(j,p.length-j,R)}0===L.groups.length&&L.addGroup(0,p.length,p[0])}return L}(0,0,n,l,c)}(t,e,n,o);case"NurbsCurve":return function(t){if(void 0===Tl)return console.error("FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new O;var e=parseInt(t.Order);if(isNaN(e))return console.error("FBXLoader: Invalid Order %s given for geometry ID: %s",t.Order,t.id),new O;for(var n=e-1,r=t.KnotVector.a,i=[],o=t.Points.a,a=0,s=o.length;a<s;a+=4)i.push((new g).fromArray(o,a));var l,u;if("Closed"===t.Form)i.push(i[0]);else if("Periodic"===t.Form){u=r.length-1-(l=n);for(var a=0;a<n;++a)i.push(i[a])}var c=new Tl(n,r,i,l,u).getPoints(7*i.length),h=new Float32Array(3*c.length);c.forEach(function(t,e){t.toArray(h,3*e)});var p=new O;return p.addAttribute("position",new y(h,3)),p}(n)}}(t,e.get(parseInt(l)),a[l],n);o.set(parseInt(l),c)}}return o}function Qe(t,e,n,r){return hu[r.mappingType][r.referenceType](t,e,n,r)}function Je(t,e,n,a,l){var u=new Me,p=function(t,e,n,r,i){var a=new Map,l=t.Objects.Model;for(var u in l){var p=parseInt(u),d=l[u],f=i.get(p),m=function(t,e,n,r){var i=null;return t.parents.forEach(function(t){for(var o in e){var a=e[o];a.rawBones.forEach(function(e,o){if(e.ID===t.ID){var s=i;(i=new V).matrixWorld.copy(e.transformLink),i.name=me.sanitizeNodeName(r),i.ID=n,a.bones[o]=i,null!==s&&i.add(s)}})}}),i}(f,e,p,d.attrName);if(!m){switch(d.attrType){case"Camera":m=function(t,e){var n,r;if(e.children.forEach(function(e){var n=t.Objects.NodeAttribute[e.ID];void 0!==n&&(r=n)}),void 0===r)n=new c;else{var i=0;void 0!==r.CameraProjectionType&&1===r.CameraProjectionType.value&&(i=1);var o=1;void 0!==r.NearPlane&&(o=r.NearPlane.value/1e3);var a=1e3;void 0!==r.FarPlane&&(a=r.FarPlane.value/1e3);var s=window.innerWidth,l=window.innerHeight;void 0!==r.AspectWidth&&void 0!==r.AspectHeight&&(s=r.AspectWidth.value,l=r.AspectHeight.value);var u=s/l,h=45;void 0!==r.FieldOfView&&(h=r.FieldOfView.value);var p=r.FocalLength?r.FocalLength.value:null;switch(i){case 0:n=new st(h,u,o,a),null!==p&&n.setFocalLength(p);break;case 1:n=new ct(-s/2,s/2,l/2,-l/2,o,a);break;default:console.warn("FBXLoader: Unknown camera type "+i+"."),n=new c}}return n}(t,f);break;case"Light":m=function(t,e){var n,r;if(e.children.forEach(function(e){var n=t.Objects.NodeAttribute[e.ID];void 0!==n&&(r=n)}),void 0===r)n=new c;else{var i;i=void 0===r.LightType?0:r.LightType.value;var o=16777215;void 0!==r.Color&&(o=(new h).fromArray(r.Color.value));var a=void 0===r.Intensity?1:r.Intensity.value/100;void 0!==r.CastLightOnObject&&0===r.CastLightOnObject.value&&(a=0);var s=0;void 0!==r.FarAttenuationEnd&&(s=void 0!==r.EnableFarAttenuation&&0===r.EnableFarAttenuation.value?0:r.FarAttenuationEnd.value);switch(i){case 0:n=new Le(o,a,s,1);break;case 1:n=new De(o,a);break;case 2:var l=Math.PI/3;void 0!==r.InnerAngle&&(l=xo.degToRad(r.InnerAngle.value));var u=0;void 0!==r.OuterAngle&&(u=xo.degToRad(r.OuterAngle.value),u=Math.max(u,1)),n=new Re(o,a,s,l,u,1);break;default:console.warn("FBXLoader: Unknown light type "+r.LightType.value+", defaulting to a PointLight."),n=new Le(o,a)}void 0!==r.CastShadows&&1===r.CastShadows.value&&(n.castShadow=!0)}return n}(t,f);break;case"Mesh":m=function(t,e,n,r){var i,o=null,a=null,s=[];e.children.forEach(function(t){n.has(t.ID)&&(o=n.get(t.ID)),r.has(t.ID)&&s.push(r.get(t.ID))}),s.length>1?a=s:s.length>0?a=s[0]:(a=new wt({color:13421772}),s.push(a));"color"in o.attributes&&s.forEach(function(t){t.vertexColors=Bo});o.FBX_Deformer?(s.forEach(function(t){t.skinning=!0}),i=new Ce(o,a)):i=new B(o,a);return i}(0,f,n,r);break;case"NurbsCurve":m=function(t,e){var n=t.children.reduce(function(t,n){return e.has(n.ID)&&(t=e.get(n.ID)),t},null),r=new F({color:3342591,linewidth:1});return new z(n,r)}(f,n);break;case"LimbNode":case"Null":default:m=new Me}m.name=me.sanitizeNodeName(d.attrName),m.ID=p}!function(t,e,n){if("RotationOrder"in n){var r=["XYZ","XZY","YZX","ZXY","YXZ","ZYX","SphericXYZ"],i=parseInt(n.RotationOrder.value,10);i>0&&i<6?console.warn("FBXLoader: unsupported Euler Order: %s. Currently only XYZ order is supported. Animations and rotations may be incorrect.",r[i]):6===i&&console.warn("FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect.")}"Lcl_Translation"in n&&e.position.fromArray(n.Lcl_Translation.value);if("Lcl_Rotation"in n){var a=n.Lcl_Rotation.value.map(xo.degToRad);a.push("ZYX"),e.quaternion.setFromEuler((new s).fromArray(a))}"Lcl_Scaling"in n&&e.scale.fromArray(n.Lcl_Scaling.value);if("PreRotation"in n){var l=n.PreRotation.value.map(xo.degToRad);l[3]="ZYX";var u=(new s).fromArray(l);u=(new o).setFromEuler(u),e.quaternion.premultiply(u)}}(0,m,d),a.set(p,m)}return a}(t,n,a,l,e),d=t.Objects.Model;return p.forEach(function(n){!function(t,e,n,r,o){if("LookAtProperty"in n){var a=r.get(e.ID).children;a.forEach(function(n){if("LookAtProperty"===n.relationship){var r=t.Objects.Model[n.ID];if("Lcl_Translation"in r){var a=r.Lcl_Translation.value;void 0!==e.target?(e.target.position.fromArray(a),o.add(e.target)):e.lookAt((new i).fromArray(a))}}})}}(t,n,d[n.ID],e,u);e.get(n.ID).parents.forEach(function(t){var e=p.get(t.ID);void 0!==e&&e.add(n)}),null===n.parent&&u.add(n)}),function(t,e,n,i,o){var a=function(t){var e={};if("Pose"in t.Objects){var n=t.Objects.Pose;for(var i in n)if("BindPose"===n[i].attrType){var o=n[i].PoseNode;Array.isArray(o)?o.forEach(function(t){e[t.Node]=(new r).fromArray(t.Matrix.a)}):e[o.Node]=(new r).fromArray(o.Matrix.a)}}return e}(t);for(var s in e){var l=e[s],u=o.get(parseInt(l.ID)).parents;u.forEach(function(t){if(n.has(t.ID)){var e=t.ID,r=o.get(e);r.parents.forEach(function(t){if(i.has(t.ID)){var e=i.get(t.ID);e.bind(new Te(l.bones),a[t.ID])}})}})}}(t,n,a,p,e),function(t,e,n){n.animations=[];var r=function(t,e){if(void 0===t.Objects.AnimationCurve)return;var n=function(t){var e=t.Objects.AnimationCurveNode,n=new Map;for(var r in e){var i=e[r];if(null!==i.attrName.match(/S|R|T/)){var o={id:i.id,attr:i.attrName,curves:{}};n.set(o.id,o)}}return n}(t);!function(t,e,n){var r=t.Objects.AnimationCurve;for(var i in r){var o={id:r[i].id,times:r[i].KeyTime.a.map(sn),values:r[i].KeyValueFloat.a},a=e.get(o.id);if(void 0!==a){var s=a.parents[0].ID,l=a.parents[0].relationship,u="";if(l.match(/X/))u="x";else if(l.match(/Y/))u="y";else{if(!l.match(/Z/))continue;u="z"}n.get(s).curves[u]=o}}}(t,e,n);var r=function(t,e,n){var r=t.Objects.AnimationLayer,i=new Map;for(var o in r){var a=[],s=e.get(parseInt(o));if(void 0!==s){var l=s.children;l.forEach(function(r,i){if(n.has(r.ID)){var o=n.get(r.ID);if(void 0!==o.curves.x||void 0!==o.curves.y||void 0!==o.curves.z){if(void 0===a[i]){var s;e.get(r.ID).parents.forEach(function(t){void 0!==t.relationship&&(s=t.ID)});var l=t.Objects.Model[s.toString()],u={modelName:me.sanitizeNodeName(l.attrName),initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};"Lcl_Translation"in l&&(u.initialPosition=l.Lcl_Translation.value),"Lcl_Rotation"in l&&(u.initialRotation=l.Lcl_Rotation.value),"Lcl_Scaling"in l&&(u.initialScale=l.Lcl_Scaling.value),"PreRotation"in l&&(u.preRotations=l.PreRotation.value),a[i]=u}a[i][o.attr]=o}}}),i.set(parseInt(o),a)}}return i}(t,e,n);return function(t,e,n){var r=t.Objects.AnimationStack,i={};for(var o in r){var a=e.get(parseInt(o)).children;a.length>1&&console.warn("FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var s=n.get(a[0].ID);i[o]={name:r[o].attrName,layer:s}}return i}(t,e,r)}(t,e);if(void 0===r)return;for(var i in r){var a=r[i],l=function(t){var e=[];return t.layer.forEach(function(t){e=e.concat(function(t){var e=[];if(void 0!==t.T&&Object.keys(t.T.curves).length>0){var n=Ke(t.modelName,t.T.curves,t.initialPosition,"position");void 0!==n&&e.push(n)}if(void 0!==t.R&&Object.keys(t.R.curves).length>0){var r=function(t,e,n,r){void 0!==e.x&&(e.x.values=e.x.values.map(xo.degToRad)),void 0!==e.y&&(e.y.values=e.y.values.map(xo.degToRad)),void 0!==e.z&&(e.z.values=e.z.values.map(xo.degToRad));var i=tn(e),a=$e(i,e,n);void 0!==r&&((r=r.map(xo.degToRad)).push("ZYX"),r=(new s).fromArray(r),r=(new o).setFromEuler(r));for(var l=new o,u=new s,c=[],h=0;h<a.length;h+=3)u.set(a[h],a[h+1],a[h+2],"ZYX"),l.setFromEuler(u),void 0!==r&&l.premultiply(r),l.toArray(c,h/3*4);return new J(t+".quaternion",i,c)}(t.modelName,t.R.curves,t.initialRotation,t.preRotations);void 0!==r&&e.push(r)}if(void 0!==t.S&&Object.keys(t.S.curves).length>0){var i=Ke(t.modelName,t.S.curves,t.initialScale,"scale");void 0!==i&&e.push(i)}return e}(t))}),new ot(t.name,-1,e)}(a);n.animations.push(l)}}(t,e,u),function(t,e){if("GlobalSettings"in t&&"AmbientColor"in t.GlobalSettings){var n=t.GlobalSettings.AmbientColor.value,r=n[0],i=n[1],o=n[2];if(0!==r||0!==i||0!==o){var a=new h(r,i,o);e.add(new Ue(a,1))}}}(t,u),u}function Ke(t,e,n,r){var i=tn(e);return new $(t+"."+r,i,$e(i,e,n))}function $e(t,e,n){var r=n,i=[],o=-1,a=-1,s=-1;return t.forEach(function(t){if(e.x&&(o=e.x.times.indexOf(t)),e.y&&(a=e.y.times.indexOf(t)),e.z&&(s=e.z.times.indexOf(t)),-1!==o){var n=e.x.values[o];i.push(n),r[0]=n}else i.push(r[0]);if(-1!==a){var l=e.y.values[a];i.push(l),r[1]=l}else i.push(r[1]);if(-1!==s){var u=e.z.values[s];i.push(u),r[2]=u}else i.push(r[2])}),i}function tn(t){var e=[];return void 0!==t.x&&(e=e.concat(t.x.times)),void 0!==t.y&&(e=e.concat(t.y.times)),void 0!==t.z&&(e=e.concat(t.z.times)),e=e.sort(function(t,e){return t-e}).filter(function(t,e,n){return n.indexOf(t)==e})}function en(){}function nn(){}function rn(t,e){this.dv=new DataView(t),this.offset=0,this.littleEndian=void 0===e||e}function on(){}function an(t){var e=t.match(/FBXVersion: (\d+)/);if(e){return parseInt(e[1])}throw new Error("FBXLoader: Cannot find the version number for the file given.")}function sn(t){return t/46186158e3}function ln(t){return t.split(",").map(function(t){return parseFloat(t)})}function un(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=t.byteLength),al.decodeText(new Uint8Array(t,e,n))}function cn(t,e,n,r){for(var i=n,o=0;i<r;i++,o++)t[o]=e[i];return t}function hn(t,e,n,r,i,o,a,s,l,u){ht.call(this,t=void 0!==t?t:[],e=void 0!==e?e:Ta,n,r,i,o,a,s,l,u),this.flipY=!1}function pn(){c.call(this),this.type="AudioListener",this.context=_u.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function dn(t){c.call(this),this.type="Audio",this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function fn(t){this.manager=void 0!==t?t:il}function mn(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null;for(var r=e.tracks,i=r.length,o=new Array(i),a={endingStart:Is,endingEnd:Is},s=0;s!==i;++s){var l=r[s].createInterpolant(null);o[s]=l,l.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Ns,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function vn(t,e,n){this.binding=t,this.valueSize=n;var r,i=Float64Array;switch(e){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function gn(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function yn(){if(null===Gu){var t=new ArrayBuffer(2),e=new Uint8Array(t),n=new Uint16Array(t);e[0]=170,e[1]=187,Gu=43707===n[0]}return Gu}function bn(t,e,n,r,i){var o,a=e.BYTES_PER_ELEMENT;if(i===yn()||1===a)o=new e(t,n,r);else{var s=new DataView(t,n,r*a),l=Wu[e.name],u=!i,c=0;for(o=new e(r);c<r;c++)o[c]=s[l](c*a,u)}return o}function _n(t,e,n){(new gt).load(t,e,n)}function xn(t){c.call(this),this.material=t,this.render=function(){}}function wn(t,e,n,r,i,o,a,s,l){ht.call(this,t,e,n,r,i,o,a,s,l),this.needsUpdate=!0}function Sn(t){c.call(this),this.type="Sprite",this.material=void 0!==t?t:new Pt,this.center=new m(.5,.5)}function An(t){var e=["x","y","z"],n=["x","y"],r=new Hc(0,3,i,Float32Array,3,e),o=new Hc(0,3,p,Uint32Array,3,["a","b","c"]),a=new Hc(0,3,m,Float32Array,2,n),s=new Hc(0,3,i,Float32Array,3,e);r.from_existing(t.getAttribute("position").array),o.from_existing(t.index.array),a.from_existing(t.getAttribute("uv").array),function(t){var e=["x","y","z"],n=new Hc(0,5,i,Float32Array,3,e),r=new Hc(0,3,p,Uint32Array,3,["a","b","c"]);n.from_existing(t.getAttribute("position").array);var o=new Hc(3*n.length,4,i,Float32Array,3,e),a=new Hc(n.length,1,function(){this.x=0},Float32Array,1,["x"]);o.length=n.length,r.from_existing(t.index.array);for(var s,l=[0,0,0],u=0,c=r.length;u<c;u++)r.index_to_register(u,0),n.index_to_register(r.register[0].a,0),n.index_to_register(r.register[0].b,1),n.index_to_register(r.register[0].c,2),o.register[0].subVectors(n.register[1],n.register[0]),o.register[1].subVectors(n.register[2],n.register[1]),o.register[0].cross(o.register[1]),s=Math.abs(o.register[0].length()),a.buffer[r.register[0].a]+=s,a.buffer[r.register[0].b]+=s,a.buffer[r.register[0].c]+=s;for(u=0,c=r.length;u<c;u++)r.index_to_register(u,0),n.index_to_register(r.register[0].a,0),n.index_to_register(r.register[0].b,1),n.index_to_register(r.register[0].c,2),o.register[0].subVectors(n.register[1],n.register[0]),o.register[1].subVectors(n.register[2],n.register[0]),o.register[3].set(0,0,0),o.register[3].x=o.register[0].y*o.register[1].z-o.register[0].z*o.register[1].y,o.register[3].y=o.register[0].z*o.register[1].x-o.register[0].x*o.register[1].z,o.register[3].z=o.register[0].x*o.register[1].y-o.register[0].y*o.register[1].x,o.register[0].cross(o.register[1]),s=Math.abs(o.register[0].length()),l[0]=s/a.buffer[r.register[0].a],l[1]=s/a.buffer[r.register[0].b],l[2]=s/a.buffer[r.register[0].c],o.buffer[3*r.register[0].a+0]+=o.register[3].x*l[0],o.buffer[3*r.register[0].a+1]+=o.register[3].y*l[0],o.buffer[3*r.register[0].a+2]+=o.register[3].z*l[0],o.buffer[3*r.register[0].b+0]+=o.register[3].x*l[1],o.buffer[3*r.register[0].b+1]+=o.register[3].y*l[1],o.buffer[3*r.register[0].b+2]+=o.register[3].z*l[1],o.buffer[3*r.register[0].c+0]+=o.register[3].x*l[2],o.buffer[3*r.register[0].c+1]+=o.register[3].y*l[2],o.buffer[3*r.register[0].c+2]+=o.register[3].z*l[2];o.trim_size(),t.addAttribute("normal",new y(o.buffer,3))}(t),s.from_existing(t.getAttribute("normal").array);for(var l=new Hc(3*o.length,3,i,Float32Array,3,e),u=new Hc(3*o.length,3,i,Float32Array,3,e),c=new Hc(3*o.length,3,m,Float32Array,2,n),h=0,d=o.length;h<d;h++)o.index_to_register(h,0),r.index_to_register(o.register[0].a,0),r.index_to_register(o.register[0].b,1),r.index_to_register(o.register[0].c,2),l.push_element(r.register[0]),l.push_element(r.register[1]),l.push_element(r.register[2]),0!==a.length&&(a.index_to_register(3*h+0,0),a.index_to_register(3*h+1,1),a.index_to_register(3*h+2,2),c.push_element(a.register[0]),c.push_element(a.register[1]),c.push_element(a.register[2])),s.index_to_register(o.register[0].a,0),s.index_to_register(o.register[0].b,1),s.index_to_register(o.register[0].c,2),u.push_element(s.register[0]),u.push_element(s.register[1]),u.push_element(s.register[2]);return l.trim_size(),c.trim_size(),u.trim_size(),t.index=null,t.addAttribute("position",new y(l.buffer,3)),t.addAttribute("normal",new y(u.buffer,3)),0!==c.length&&t.addAttribute("uv",new y(c.buffer,2)),t}function Mn(t,e){this.min=void 0!==t?t:new m(1/0,1/0),this.max=void 0!==e?e:new m(-1/0,-1/0)}function Tn(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Cn(t,e){B.call(this,t),this.type="Water2";var n=this,i=new h(void 0!==(e=e||{}).color?e.color:16777215),o=e.textureWidth||512,a=e.textureHeight||512,s=e.clipBias||0,l=e.flowDirection||new m(1,0),u=e.flowSpeed||.03,c=e.reflectivity||.02,p=e.scale||1,d=e.shader||Cn.Water2Shader,f=new Lt,v=e.flowMap||void 0,g=e.normalMap0||f.load("textures/water/Water2_1_M_Normal.jpg"),y=e.normalMap1||f.load("textures/water/Water2_2_M_Normal.jpg"),b=.15,_=.5*b,x=new r,w=new Tn;if(void 0!==Hh)if(void 0!==Wh){var S=new Hh(t,{textureWidth:o,textureHeight:a,clipBias:s}),A=new Wh(t,{textureWidth:o,textureHeight:a,clipBias:s});S.matrixAutoUpdate=!1,A.matrixAutoUpdate=!1,this.material=new dt({uniforms:tl.merge([Ol.fog,d.uniforms]),vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,transparent:!0,fog:!0}),void 0!==v?(this.material.defines.USE_FLOWMAP="",this.material.uniforms.tFlowMap={type:"t",value:v}):this.material.uniforms.flowDirection={type:"v2",value:l},g.wrapS=g.wrapT=Ia,y.wrapS=y.wrapT=Ia,this.material.uniforms.tReflectionMap.value=S.getRenderTarget().texture,this.material.uniforms.tRefractionMap.value=A.getRenderTarget().texture,this.material.uniforms.tNormalMap0.value=g,this.material.uniforms.tNormalMap1.value=y,this.material.uniforms.color.value=i,this.material.uniforms.reflectivity.value=c,this.material.uniforms.textureMatrix.value=x,this.material.uniforms.config.value.x=0,this.material.uniforms.config.value.y=_,this.material.uniforms.config.value.z=_,this.material.uniforms.config.value.w=p,this.onBeforeRender=function(t,e,r){!function(t){x.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),x.multiply(t.projectionMatrix),x.multiply(t.matrixWorldInverse),x.multiply(n.matrixWorld)}(r),function(){var t=w.getDelta(),e=n.material.uniforms.config;e.value.x+=u*t,e.value.y=e.value.x+_,e.value.x>=b?(e.value.x=0,e.value.y=_):e.value.y>=b&&(e.value.y=e.value.y-b)}(),n.visible=!1,S.matrixWorld.copy(n.matrixWorld),A.matrixWorld.copy(n.matrixWorld),S.onBeforeRender(t,e,r),A.onBeforeRender(t,e,r),n.visible=!0}}else console.error("Water2: Required component Refractor not found.");else console.error("Water2: Required component Reflector not found.")}function En(t,e){this.object=t,void 0===e&&(e=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new O;i.setIndex(new y(n,1)),i.addAttribute("position",new y(r,3)),je.call(this,i,new F({color:e})),this.matrixAutoUpdate=!1,this.update()}function Pn(t){return!isNaN(t)&&isFinite(t)}function On(t){return t?!0!==function(t){return"[object Array]"===Object.prototype.toString.call(t)}(t)?[t]:t:[]}function Nn(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}function Ln(t,e,n){pt.call(this,t,e,n),this.activeCubeFace=0,this.activeMipMapLevel=0}function In(t,e,n,r,i,o,a,s,l,u){if((u=void 0!==u?u:as)!==as&&u!==ss)throw new Error("DepthTexture format must be either DepthFormat or DepthStencilFormat");void 0===n&&u===as&&(n=Wa),void 0===n&&u===ss&&(n=$a),ht.call(this,null,r,i,o,a,s,u,n,l),this.image={width:t,height:e},this.magFilter=void 0!==a?a:Ra,this.minFilter=void 0!==s?s:Ra,this.flipY=!1,this.generateMipmaps=!1}function Dn(t,e,n,r,i,o){this.planes=[void 0!==t?t:new U,void 0!==e?e:new U,void 0!==n?n:new U,void 0!==r?r:new U,void 0!==i?i:new U,void 0!==o?o:new U]}function Fn(t){var e=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),e.get(t)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);var r=e.get(n);r&&(t.deleteBuffer(r.buffer),e.delete(n))},update:function(n,r){n.isInterleavedBufferAttribute&&(n=n.data);var i=e.get(n);void 0===i?e.set(n,function(e,n){var r=e.array,i=e.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW,o=t.createBuffer();t.bindBuffer(n,o),t.bufferData(n,r,i),e.onUploadCallback();var a=t.FLOAT;return r instanceof Float32Array?a=t.FLOAT:r instanceof Float64Array?console.warn("WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?a=t.UNSIGNED_SHORT:r instanceof Int16Array?a=t.SHORT:r instanceof Uint32Array?a=t.UNSIGNED_INT:r instanceof Int32Array?a=t.INT:r instanceof Int8Array?a=t.BYTE:r instanceof Uint8Array&&(a=t.UNSIGNED_BYTE),{buffer:o,type:a,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}(n,r)):i.version<n.version&&(function(e,n,r){var i=n.array,o=n.updateRange;t.bindBuffer(r,e),!1===n.dynamic?t.bufferData(r,i,t.STATIC_DRAW):-1===o.count?t.bufferSubData(r,0,i):0===o.count?console.error("WebGLObjects.updateBuffer: dynamic BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(r,o.offset*i.BYTES_PER_ELEMENT,i.subarray(o.offset,o.offset+o.count)),o.count=-1)}(i.buffer,n,r),i.version=n.version)}}}function Rn(t){var e={};return{get:function(n){if(void 0!==e[n])return e[n];var r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":r=t.getExtension("WEBGL_compressed_texture_etc1");break;default:r=t.getExtension(n)}return null===r&&console.warn("WebGLRenderer: "+n+" extension not supported."),e[n]=r,r}}}function kn(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Un(){this.seq=[],this.map={}}function jn(t,e,n){var r=t[0];if(r<=0||r>0)return t;var i=e*n,o=Qp[i];if(void 0===o&&(o=new Float32Array(i),Qp[i]=o),0!==e){r.toArray(o,0);for(var a=1,s=0;a!==e;++a)t[a].toArray(o,s+=n)}return o}function Bn(t,e){var n=Jp[e];void 0===n&&(n=new Int32Array(e),Jp[e]=n);for(var r=0;r!==e;++r)n[r]=t.allocTextureUnit();return n}function zn(t,e){t.uniform1f(this.addr,e)}function Vn(t,e){t.uniform1i(this.addr,e)}function Gn(t,e){void 0===e.x?t.uniform2fv(this.addr,e):t.uniform2f(this.addr,e.x,e.y)}function Hn(t,e){void 0!==e.x?t.uniform3f(this.addr,e.x,e.y,e.z):void 0!==e.r?t.uniform3f(this.addr,e.r,e.g,e.b):t.uniform3fv(this.addr,e)}function Wn(t,e){void 0===e.x?t.uniform4fv(this.addr,e):t.uniform4f(this.addr,e.x,e.y,e.z,e.w)}function Xn(t,e){t.uniformMatrix2fv(this.addr,!1,e.elements||e)}function Yn(t,e){void 0===e.elements?t.uniformMatrix3fv(this.addr,!1,e):($p.set(e.elements),t.uniformMatrix3fv(this.addr,!1,$p))}function qn(t,e){void 0===e.elements?t.uniformMatrix4fv(this.addr,!1,e):(Kp.set(e.elements),t.uniformMatrix4fv(this.addr,!1,Kp))}function Zn(t,e,n){var r=n.allocTextureUnit();t.uniform1i(this.addr,r),n.setTexture2D(e||qp,r)}function Qn(t,e,n){var r=n.allocTextureUnit();t.uniform1i(this.addr,r),n.setTextureCube(e||Zp,r)}function Jn(t,e){t.uniform2iv(this.addr,e)}function Kn(t,e){t.uniform3iv(this.addr,e)}function $n(t,e){t.uniform4iv(this.addr,e)}function tr(t,e){t.uniform1fv(this.addr,e)}function er(t,e){t.uniform1iv(this.addr,e)}function nr(t,e){t.uniform2fv(this.addr,jn(e,this.size,2))}function rr(t,e){t.uniform3fv(this.addr,jn(e,this.size,3))}function ir(t,e){t.uniform4fv(this.addr,jn(e,this.size,4))}function or(t,e){t.uniformMatrix2fv(this.addr,!1,jn(e,this.size,4))}function ar(t,e){t.uniformMatrix3fv(this.addr,!1,jn(e,this.size,9))}function sr(t,e){t.uniformMatrix4fv(this.addr,!1,jn(e,this.size,16))}function lr(t,e,n){var r=e.length,i=Bn(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.setTexture2D(e[o]||qp,i[o])}function ur(t,e,n){var r=e.length,i=Bn(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.setTextureCube(e[o]||Zp,i[o])}function cr(t,e,n){this.id=t,this.addr=n,this.setValue=function(t){switch(t){case 5126:return zn;case 35664:return Gn;case 35665:return Hn;case 35666:return Wn;case 35674:return Xn;case 35675:return Yn;case 35676:return qn;case 35678:case 36198:return Zn;case 35680:return Qn;case 5124:case 35670:return Vn;case 35667:case 35671:return Jn;case 35668:case 35672:return Kn;case 35669:case 35673:return $n}}(e.type)}function hr(t,e,n){this.id=t,this.addr=n,this.size=e.size,this.setValue=function(t){switch(t){case 5126:return tr;case 35664:return nr;case 35665:return rr;case 35666:return ir;case 35674:return or;case 35675:return ar;case 35676:return sr;case 35678:return lr;case 35680:return ur;case 5124:case 35670:return er;case 35667:case 35671:return Jn;case 35668:case 35672:return Kn;case 35669:case 35673:return $n}}(e.type)}function pr(t){this.id=t,Un.call(this)}function dr(t,e){t.seq.push(e),t.map[e.id]=e}function fr(t,e,n){var r=t.name,i=r.length;for(td.lastIndex=0;;){var o=td.exec(r),a=o[1],s=o[3];if("]"===o[2]&&(a|=0),void 0===s||"["===s&&td.lastIndex+2===i){dr(n,void 0===s?new cr(a,t,e):new hr(a,t,e));break}var l=n.map[a];void 0===l&&dr(n,l=new pr(a)),n=l}}function mr(t,e,n){Un.call(this),this.renderer=n;for(var r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),i=0;i<r;++i){var o=t.getActiveUniform(e,i);fr(o,t.getUniformLocation(e,o.name),this)}}function vr(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),!1===t.getShaderParameter(r,t.COMPILE_STATUS)&&console.error("WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(r)&&console.warn("WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(r),function(t){for(var e=t.split("\n"),n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}(n)),r}function gr(t){switch(t){case ks:return["Linear","( value )"];case Us:return["sRGB","( value )"];case Bs:return["RGBE","( value )"];case zs:return["RGBM","( value, 7.0 )"];case Vs:return["RGBM","( value, 16.0 )"];case Gs:return["RGBD","( value, 256.0 )"];case js:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+t)}}function yr(t,e){var n=gr(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function br(t){return""!==t}function _r(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function xr(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}function wr(t){return t.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(t,e){var n=Pl[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return wr(n)})}function Sr(t){return t.replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(t,e,n,r){for(var i="",o=parseInt(e);o<parseInt(n);o++)i+=r.replace(/\[ i \]/g,"[ "+o+" ]");return i})}function Ar(t,e,n,r,i,o){var a=t.context,s=r.defines,l=i.vertexShader,u=i.fragmentShader,c="SHADOWMAP_TYPE_BASIC";o.shadowMapType===Io?c="SHADOWMAP_TYPE_PCF":o.shadowMapType===Do&&(c="SHADOWMAP_TYPE_PCF_SOFT");var h="ENVMAP_TYPE_CUBE",p="ENVMAP_MODE_REFLECTION",d="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(r.envMap.mapping){case Ta:case Ca:h="ENVMAP_TYPE_CUBE";break;case Na:case La:h="ENVMAP_TYPE_CUBE_UV";break;case Ea:case Pa:h="ENVMAP_TYPE_EQUIREC";break;case Oa:h="ENVMAP_TYPE_SPHERE"}switch(r.envMap.mapping){case Ca:case Pa:p="ENVMAP_MODE_REFRACTION"}switch(r.combine){case ga:d="ENVMAP_BLENDING_MULTIPLY";break;case ya:d="ENVMAP_BLENDING_MIX";break;case ba:d="ENVMAP_BLENDING_ADD"}}var f,m,v=t.gammaFactor>0?t.gammaFactor:1,g=function(t,e,n){return[(t=t||{}).derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(br).join("\n")}(r.extensions,o,e),y=function(t){var e=[];for(var n in t){var r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}(s),b=a.createProgram();r.isRawShaderMaterial?((f=[y].filter(br).join("\n")).length>0&&(f+="\n"),(m=[g,y].filter(br).join("\n")).length>0&&(m+="\n")):(f=["precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,y,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+v,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+p:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+c:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(br).join("\n"),m=[g,"precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,y,o.alphaTest?"#define ALPHATEST "+o.alphaTest:"","#define GAMMA_FACTOR "+v,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+h:"",o.envMap?"#define "+p:"",o.envMap?"#define "+d:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+c:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",o.envMap&&e.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",o.toneMapping!==_a?"#define TONE_MAPPING":"",o.toneMapping!==_a?Pl.tonemapping_pars_fragment:"",o.toneMapping!==_a?function(t,e){var n;switch(e){case xa:n="Linear";break;case wa:n="Reinhard";break;case Sa:n="Uncharted2";break;case Aa:n="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.envMapEncoding||o.emissiveMapEncoding?Pl.encodings_pars_fragment:"",o.mapEncoding?yr("mapTexelToLinear",o.mapEncoding):"",o.envMapEncoding?yr("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?yr("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?function(t,e){var n=gr(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}("linearToOutputTexel",o.outputEncoding):"",o.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(br).join("\n")),l=xr(l=_r(l=wr(l),o),o),u=xr(u=_r(u=wr(u),o),o),l=Sr(l);var _=m+(u=Sr(u)),x=vr(a,a.VERTEX_SHADER,f+l),w=vr(a,a.FRAGMENT_SHADER,_);a.attachShader(b,x),a.attachShader(b,w),void 0!==r.index0AttributeName?a.bindAttribLocation(b,0,r.index0AttributeName):!0===o.morphTargets&&a.bindAttribLocation(b,0,"position"),a.linkProgram(b);var S=a.getProgramInfoLog(b).trim(),A=a.getShaderInfoLog(x).trim(),M=a.getShaderInfoLog(w).trim(),T=!0,C=!0;!1===a.getProgramParameter(b,a.LINK_STATUS)?(T=!1,console.error("WebGLProgram: shader error: ",a.getError(),"gl.VALIDATE_STATUS",a.getProgramParameter(b,a.VALIDATE_STATUS),"gl.getProgramInfoLog",S,A,M)):""!==S?console.warn("WebGLProgram: gl.getProgramInfoLog()",S):""!==A&&""!==M||(C=!1),C&&(this.diagnostics={runnable:T,material:r,programLog:S,vertexShader:{log:A,prefix:f},fragmentShader:{log:M,prefix:m}}),a.deleteShader(x),a.deleteShader(w);var E;this.getUniforms=function(){return void 0===E&&(E=new mr(a,b,t)),E};var P;return this.getAttributes=function(){return void 0===P&&(P=function(t,e){for(var n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),i=0;i<r;i++){var o=t.getActiveAttrib(e,i).name;n[o]=t.getAttribLocation(e,o)}return n}(a,b)),P},this.destroy=function(){a.deleteProgram(b),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=ed++,this.code=n,this.usedTimes=1,this.program=b,this.vertexShader=x,this.fragmentShader=w,this}function Mr(t,e,n){function r(t,e){var n;return t?t.isTexture?n=t.encoding:t.isWebGLRenderTarget&&(console.warn("WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=t.texture.encoding):n=ks,n===ks&&e&&(n=js),n}var i=[],o={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},a=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];this.getParameters=function(e,i,a,s,l,u,c){var h=o[e.type],p=c.isSkinnedMesh?function(t){var e=t.skeleton.bones;if(n.floatVertexTextures)return 1024;var r=n.maxVertexUniforms,i=Math.floor((r-20)/4),o=Math.min(i,e.length);return o<e.length?(console.warn("WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+o+"."),0):o}(c):0,d=n.precision;null!==e.precision&&(d=n.getMaxPrecision(e.precision))!==e.precision&&console.warn("WebGLProgram.getParameters:",e.precision,"not supported, using",d,"instead.");var f=t.getRenderTarget();return{shaderID:h,precision:d,supportsVertexTextures:n.vertexTextures,outputEncoding:r(f?f.texture:null,t.gammaOutput),map:!!e.map,mapEncoding:r(e.map,t.gammaInput),envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,envMapEncoding:r(e.envMap,t.gammaInput),envMapCubeUV:!!e.envMap&&(e.envMap.mapping===Na||e.envMap.mapping===La),lightMap:!!e.lightMap,aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:r(e.emissiveMap,t.gammaInput),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,combine:e.combine,vertexColors:e.vertexColors,fog:!!s,useFog:e.fog,fogExp:s&&s.isFogExp2,flatShading:e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:n.logarithmicDepthBuffer,skinning:e.skinning&&p>0,maxBones:p,useVertexTexture:n.floatVertexTextures,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:i.directional.length,numPointLights:i.point.length,numSpotLights:i.spot.length,numRectAreaLights:i.rectArea.length,numHemiLights:i.hemi.length,numClippingPlanes:l,numClipIntersection:u,dithering:e.dithering,shadowMapEnabled:t.shadowMap.enabled&&c.receiveShadow&&a.length>0,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:e.side===ko,flipSided:e.side===Ro,depthPacking:void 0!==e.depthPacking&&e.depthPacking}},this.getProgramCode=function(e,n){var r=[];if(n.shaderID?r.push(n.shaderID):(r.push(e.fragmentShader),r.push(e.vertexShader)),void 0!==e.defines)for(var i in e.defines)r.push(i),r.push(e.defines[i]);for(var o=0;o<a.length;o++)r.push(n[a[o]]);return r.push(e.onBeforeCompile.toString()),r.push(t.gammaOutput),r.join()},this.acquireProgram=function(n,r,o,a){for(var s,l=0,u=i.length;l<u;l++){var c=i[l];if(c.code===a){++(s=c).usedTimes;break}}return void 0===s&&(s=new Ar(t,e,a,n,r,o),i.push(s)),s},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=i.indexOf(t);i[e]=i[i.length-1],i.pop(),t.destroy()}},this.programs=i}function Tr(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program&&e.program&&t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Cr(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Er(){var t={};return{get:function(e,n){var r=e.id+","+n.id,i=t[r];return void 0===i&&(i=new function(){var t=[],e=0,n=[],r=[];return{opaque:n,transparent:r,init:function(){e=0,n.length=0,r.length=0},push:function(i,o,a,s,l){var u=t[e];void 0===u?t[e]=u={id:i.id,object:i,geometry:o,material:a,program:a.program,renderOrder:i.renderOrder,z:s,group:l}:(u.id=i.id,u.object=i,u.geometry=o,u.material=a,u.program=a.program,u.renderOrder=i.renderOrder,u.z=s,u.group=l),(!0===a.transparent?r:n).push(u),e++},sort:function(){n.length>1&&n.sort(Tr),r.length>1&&r.sort(Cr)}}},t[r]=i),i},dispose:function(){t={}}}}function Pr(){var t=new function(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":n={direction:new i,color:new h,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new m};break;case"SpotLight":n={position:new i,direction:new i,color:new h,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new m};break;case"PointLight":n={position:new i,color:new h,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new m,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":n={direction:new i,skyColor:new h,groundColor:new h};break;case"RectAreaLight":n={color:new h,position:new i,halfWidth:new i,halfHeight:new i}}return t[e.id]=n,n}}},e={id:nd++,hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},n=new i,o=new r,a=new r;return{setup:function(r,i,s){for(var l=0,u=0,c=0,h=0,p=0,d=0,f=0,m=0,v=s.matrixWorldInverse,g=0,y=r.length;g<y;g++){var b=r[g],_=b.color,x=b.intensity,w=b.distance,S=b.shadow&&b.shadow.map?b.shadow.map.texture:null;if(b.isAmbientLight)l+=_.r*x,u+=_.g*x,c+=_.b*x;else if(b.isDirectionalLight)(M=t.get(b)).color.copy(b.color).multiplyScalar(b.intensity),M.direction.setFromMatrixPosition(b.matrixWorld),n.setFromMatrixPosition(b.target.matrixWorld),M.direction.sub(n),M.direction.transformDirection(v),M.shadow=b.castShadow,b.castShadow&&(M.shadowBias=(A=b.shadow).bias,M.shadowRadius=A.radius,M.shadowMapSize=A.mapSize),e.directionalShadowMap[h]=S,e.directionalShadowMatrix[h]=b.shadow.matrix,e.directional[h]=M,h++;else if(b.isSpotLight)(M=t.get(b)).position.setFromMatrixPosition(b.matrixWorld),M.position.applyMatrix4(v),M.color.copy(_).multiplyScalar(x),M.distance=w,M.direction.setFromMatrixPosition(b.matrixWorld),n.setFromMatrixPosition(b.target.matrixWorld),M.direction.sub(n),M.direction.transformDirection(v),M.coneCos=Math.cos(b.angle),M.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),M.decay=0===b.distance?0:b.decay,M.shadow=b.castShadow,b.castShadow&&(M.shadowBias=(A=b.shadow).bias,M.shadowRadius=A.radius,M.shadowMapSize=A.mapSize),e.spotShadowMap[d]=S,e.spotShadowMatrix[d]=b.shadow.matrix,e.spot[d]=M,d++;else if(b.isRectAreaLight)(M=t.get(b)).color.copy(_).multiplyScalar(x),M.position.setFromMatrixPosition(b.matrixWorld),M.position.applyMatrix4(v),a.identity(),o.copy(b.matrixWorld),o.premultiply(v),a.extractRotation(o),M.halfWidth.set(.5*b.width,0,0),M.halfHeight.set(0,.5*b.height,0),M.halfWidth.applyMatrix4(a),M.halfHeight.applyMatrix4(a),e.rectArea[f]=M,f++;else if(b.isPointLight){if((M=t.get(b)).position.setFromMatrixPosition(b.matrixWorld),M.position.applyMatrix4(v),M.color.copy(b.color).multiplyScalar(b.intensity),M.distance=b.distance,M.decay=0===b.distance?0:b.decay,M.shadow=b.castShadow,b.castShadow){var A;M.shadowBias=(A=b.shadow).bias,M.shadowRadius=A.radius,M.shadowMapSize=A.mapSize,M.shadowCameraNear=A.camera.near,M.shadowCameraFar=A.camera.far}e.pointShadowMap[p]=S,e.pointShadowMatrix[p]=b.shadow.matrix,e.point[p]=M,p++}else if(b.isHemisphereLight){var M;(M=t.get(b)).direction.setFromMatrixPosition(b.matrixWorld),M.direction.transformDirection(v),M.direction.normalize(),M.skyColor.copy(b.color).multiplyScalar(x),M.groundColor.copy(b.groundColor).multiplyScalar(x),e.hemi[m]=M,m++}}e.ambient[0]=l,e.ambient[1]=u,e.ambient[2]=c,e.directional.length=h,e.spot.length=d,e.rectArea.length=f,e.point.length=p,e.hemi.length=m,e.hash=e.id+","+h+","+p+","+d+","+f+","+m+","+i.length},state:e}}function Or(){var t={};return{get:function(e,n){var r=e.id+","+n.id,i=t[r];return void 0===i&&(i=new function(){var t=new Pr,e=[],n=[],r=[];return{init:function(){e.length=0,n.length=0,r.length=0},state:{lightsArray:e,shadowsArray:n,spritesArray:r,lights:t},setupLights:function(r){t.setup(e,n,r)},pushLight:function(t){e.push(t)},pushShadow:function(t){n.push(t)},pushSprite:function(t){r.push(t)}}},t[r]=i),i},dispose:function(){t={}}}}function Nr(t,e,n,r,a){function s(){var t=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),n=new Uint16Array([0,1,2,0,2,3]);u=e.createBuffer(),c=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,u),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,c),e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW),h=function(){var t=e.createProgram(),n=e.createShader(e.VERTEX_SHADER),r=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(n,["precision "+a.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 center;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvUV = uvOffset + uv * uvScale;","\tvec2 alignedPosition = ( position - center ) * scale;","\tvec2 rotatedPosition;","\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","\tvec4 mvPosition;","\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","\tmvPosition.xy += rotatedPosition;","\tgl_Position = projectionMatrix * mvPosition;","\tfogDepth = - mvPosition.z;","}"].join("\n")),e.shaderSource(r,["precision "+a.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvec4 texture = texture2D( map, vUV );","\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","\tif ( gl_FragColor.a < alphaTest ) discard;","\tif ( fogType > 0 ) {","\t\tfloat fogFactor = 0.0;","\t\tif ( fogType == 1 ) {","\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );","\t\t} else {","\t\t\tconst float LOG2 = 1.442695;","\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );","\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","\t\t}","\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );","\t}","}"].join("\n")),e.compileShader(n),e.compileShader(r),e.attachShader(t,n),e.attachShader(t,r),e.linkProgram(t),t}(),p={position:e.getAttribLocation(h,"position"),uv:e.getAttribLocation(h,"uv")},d={uvOffset:e.getUniformLocation(h,"uvOffset"),uvScale:e.getUniformLocation(h,"uvScale"),rotation:e.getUniformLocation(h,"rotation"),center:e.getUniformLocation(h,"center"),scale:e.getUniformLocation(h,"scale"),color:e.getUniformLocation(h,"color"),map:e.getUniformLocation(h,"map"),opacity:e.getUniformLocation(h,"opacity"),modelViewMatrix:e.getUniformLocation(h,"modelViewMatrix"),projectionMatrix:e.getUniformLocation(h,"projectionMatrix"),fogType:e.getUniformLocation(h,"fogType"),fogDensity:e.getUniformLocation(h,"fogDensity"),fogNear:e.getUniformLocation(h,"fogNear"),fogFar:e.getUniformLocation(h,"fogFar"),fogColor:e.getUniformLocation(h,"fogColor"),fogDepth:e.getUniformLocation(h,"fogDepth"),alphaTest:e.getUniformLocation(h,"alphaTest")};var r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");r.width=8,r.height=8;var i=r.getContext("2d");i.fillStyle="white",i.fillRect(0,0,8,8),f=new wn(r)}function l(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}var u,c,h,p,d,f,m=new i,v=new o,g=new i;this.render=function(i,o,a){if(0!==i.length){void 0===h&&s(),n.useProgram(h),n.initAttributes(),n.enableAttribute(p.position),n.enableAttribute(p.uv),n.disableUnusedAttributes(),n.disable(e.CULL_FACE),n.enable(e.BLEND),e.bindBuffer(e.ARRAY_BUFFER,u),e.vertexAttribPointer(p.position,2,e.FLOAT,!1,16,0),e.vertexAttribPointer(p.uv,2,e.FLOAT,!1,16,8),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,c),e.uniformMatrix4fv(d.projectionMatrix,!1,a.projectionMatrix.elements),n.activeTexture(e.TEXTURE0),e.uniform1i(d.map,0);var y=0,b=0,_=o.fog;_?(e.uniform3f(d.fogColor,_.color.r,_.color.g,_.color.b),_.isFog?(e.uniform1f(d.fogNear,_.near),e.uniform1f(d.fogFar,_.far),e.uniform1i(d.fogType,1),y=1,b=1):_.isFogExp2&&(e.uniform1f(d.fogDensity,_.density),e.uniform1i(d.fogType,2),y=2,b=2)):(e.uniform1i(d.fogType,0),y=0,b=0);for(var x=0,w=i.length;x<w;x++){(M=i[x]).modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,M.matrixWorld),M.z=-M.modelViewMatrix.elements[14]}i.sort(l);var S=[],A=[];for(x=0,w=i.length;x<w;x++){var M,T=(M=i[x]).material;if(!1!==T.visible){M.onBeforeRender(t,o,a,void 0,T,void 0),e.uniform1f(d.alphaTest,T.alphaTest),e.uniformMatrix4fv(d.modelViewMatrix,!1,M.modelViewMatrix.elements),M.matrixWorld.decompose(m,v,g),S[0]=g.x,S[1]=g.y,A[0]=M.center.x-.5,A[1]=M.center.y-.5;var C=0;o.fog&&T.fog&&(C=b),y!==C&&(e.uniform1i(d.fogType,C),y=C),null!==T.map?(e.uniform2f(d.uvOffset,T.map.offset.x,T.map.offset.y),e.uniform2f(d.uvScale,T.map.repeat.x,T.map.repeat.y)):(e.uniform2f(d.uvOffset,0,0),e.uniform2f(d.uvScale,1,1)),e.uniform1f(d.opacity,T.opacity),e.uniform3f(d.color,T.color.r,T.color.g,T.color.b),e.uniform1f(d.rotation,T.rotation),e.uniform2fv(d.center,A),e.uniform2fv(d.scale,S),n.setBlending(T.blending,T.blendEquation,T.blendSrc,T.blendDst,T.blendEquationAlpha,T.blendSrcAlpha,T.blendDstAlpha,T.premultipliedAlpha),n.buffers.depth.setTest(T.depthTest),n.buffers.depth.setMask(T.depthWrite),n.buffers.color.setMask(T.colorWrite),r.setTexture2D(T.map||f,0),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),M.onAfterRender(t,o,a,void 0,T,void 0)}}n.enable(e.CULL_FACE),n.reset()}}}function Lr(t,e,n){function r(e,n,r){var i=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(var a=0;a<r;a++)t.texImage2D(n+a,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,i);return o}function i(e){!0!==b[e]&&(t.enable(e),b[e]=!0)}function o(e){!1!==b[e]&&(t.disable(e),b[e]=!1)}function a(e,r,a,s,l,u,c,h){if(e!==zo?i(t.BLEND):o(t.BLEND),e!==Xo){if(e!==w||h!==P)switch(e){case Go:h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE));break;case Ho:h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR));break;case Wo:h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR));break;default:h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA))}S=null,A=null,M=null,T=null,C=null,E=null}else l=l||r,u=u||a,c=c||s,r===S&&l===T||(t.blendEquationSeparate(n.convert(r),n.convert(l)),S=r,T=l),a===A&&s===M&&u===C&&c===E||(t.blendFuncSeparate(n.convert(a),n.convert(s),n.convert(u),n.convert(c)),A=a,M=s,C=u,E=c);w=e,P=h}function s(e){O!==e&&(t.frontFace(e?t.CW:t.CCW),O=e)}function l(e){e!==Oo?(i(t.CULL_FACE),e!==N&&t.cullFace(e===No?t.BACK:e===Lo?t.FRONT:t.FRONT_AND_BACK)):o(t.CULL_FACE),N=e}function u(e,n,r){e?(i(t.POLYGON_OFFSET_FILL),I===n&&D===r||(t.polygonOffset(n,r),I=n,D=r)):o(t.POLYGON_OFFSET_FILL)}function c(e){void 0===e&&(e=t.TEXTURE0+F-1),j!==e&&(t.activeTexture(e),j=e)}var h=new function(){var e=!1,n=new g,r=null,i=new g(0,0,0,0);return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,o,a,s){!0===s&&(e*=a,r*=a,o*=a),n.set(e,r,o,a),!1===i.equals(n)&&(t.clearColor(e,r,o,a),i.copy(n))},reset:function(){e=!1,r=null,i.set(-1,0,0,0)}}},p=new function(){var e=!1,n=null,r=null,a=null;return{setTest:function(e){e?i(t.DEPTH_TEST):o(t.DEPTH_TEST)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){if(e)switch(e){case ua:t.depthFunc(t.NEVER);break;case ca:t.depthFunc(t.ALWAYS);break;case ha:t.depthFunc(t.LESS);break;case pa:t.depthFunc(t.LEQUAL);break;case da:t.depthFunc(t.EQUAL);break;case fa:t.depthFunc(t.GEQUAL);break;case ma:t.depthFunc(t.GREATER);break;case va:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);r=e}},setLocked:function(t){e=t},setClear:function(e){a!==e&&(t.clearDepth(e),a=e)},reset:function(){e=!1,n=null,r=null,a=null}}},d=new function(){var e=!1,n=null,r=null,a=null,s=null,l=null,u=null,c=null,h=null;return{setTest:function(e){e?i(t.STENCIL_TEST):o(t.STENCIL_TEST)},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,i){r===e&&a===n&&s===i||(t.stencilFunc(e,n,i),r=e,a=n,s=i)},setOp:function(e,n,r){l===e&&u===n&&c===r||(t.stencilOp(e,n,r),l=e,u=n,c=r)},setLocked:function(t){e=t},setClear:function(e){h!==e&&(t.clearStencil(e),h=e)},reset:function(){e=!1,n=null,r=null,a=null,s=null,l=null,u=null,c=null,h=null}}},f=t.getParameter(t.MAX_VERTEX_ATTRIBS),m=new Uint8Array(f),v=new Uint8Array(f),y=new Uint8Array(f),b={},_=null,x=null,w=null,S=null,A=null,M=null,T=null,C=null,E=null,P=!1,O=null,N=null,L=null,I=null,D=null,F=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),R=!1,k=0,U=t.getParameter(t.VERSION);-1!==U.indexOf("WebGL")?(k=parseFloat(/^WebGL\ ([0-9])/.exec(U)[1]),R=k>=1):-1!==U.indexOf("OpenGL ES")&&(k=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(U)[1]),R=k>=2);var j=null,B={},z=new g,V=new g,G={};return G[t.TEXTURE_2D]=r(t.TEXTURE_2D,t.TEXTURE_2D,1),G[t.TEXTURE_CUBE_MAP]=r(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),h.setClear(0,0,0,1),p.setClear(1),d.setClear(0),i(t.DEPTH_TEST),p.setFunc(pa),s(!1),l(No),i(t.CULL_FACE),i(t.BLEND),a(Vo),{buffers:{color:h,depth:p,stencil:d},initAttributes:function(){for(var t=0,e=m.length;t<e;t++)m[t]=0},enableAttribute:function(n){m[n]=1,0===v[n]&&(t.enableVertexAttribArray(n),v[n]=1),0!==y[n]&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,0),y[n]=0)},enableAttributeAndDivisor:function(n,r){m[n]=1,0===v[n]&&(t.enableVertexAttribArray(n),v[n]=1),y[n]!==r&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,r),y[n]=r)},disableUnusedAttributes:function(){for(var e=0,n=v.length;e!==n;++e)v[e]!==m[e]&&(t.disableVertexAttribArray(e),v[e]=0)},enable:i,disable:o,getCompressedTextureFormats:function(){if(null===_&&(_=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")||e.get("WEBGL_compressed_texture_astc")))for(var n=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),r=0;r<n.length;r++)_.push(n[r]);return _},useProgram:function(e){return x!==e&&(t.useProgram(e),x=e,!0)},setBlending:a,setMaterial:function(e,n){e.side===ko?o(t.CULL_FACE):i(t.CULL_FACE);var r=e.side===Ro;n&&(r=!r),s(r),!0===e.transparent?a(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha):a(zo),p.setFunc(e.depthFunc),p.setTest(e.depthTest),p.setMask(e.depthWrite),h.setMask(e.colorWrite),u(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:s,setCullFace:l,setLineWidth:function(e){e!==L&&(R&&t.lineWidth(e),L=e)},setPolygonOffset:u,setScissorTest:function(e){e?i(t.SCISSOR_TEST):o(t.SCISSOR_TEST)},activeTexture:c,bindTexture:function(e,n){null===j&&c();var r=B[j];void 0===r&&(B[j]=r={type:void 0,texture:void 0}),r.type===e&&r.texture===n||(t.bindTexture(e,n||G[e]),r.type=e,r.texture=n)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("WebGLState:",t)}},scissor:function(e){!1===z.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),z.copy(e))},viewport:function(e){!1===V.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),V.copy(e))},reset:function(){for(var e=0;e<v.length;e++)1===v[e]&&(t.disableVertexAttribArray(e),v[e]=0);b={},_=null,j=null,B={},x=null,w=null,O=null,N=null,h.reset(),p.reset(),d.reset()}}}function Ir(t,e,n,r,i,o,a){function s(t,e){if(t.width>e||t.height>e){if("data"in t)return void console.warn("WebGLRenderer: image in DataTexture is too big ("+t.width+"x"+t.height+").");var n=e/Math.max(t.width,t.height),r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");r.width=Math.floor(t.width*n),r.height=Math.floor(t.height*n);return r.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,r.width,r.height),console.warn("WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+r.width+"x"+r.height,t),r}return t}function l(t){return xo.isPowerOfTwo(t.width)&&xo.isPowerOfTwo(t.height)}function u(t,e){return t.generateMipmaps&&e&&t.minFilter!==Ra&&t.minFilter!==ja}function c(e,n,i,o){t.generateMipmap(e);r.get(n).__maxMipLevel=Math.log2(Math.max(i,o))}function h(e){return e===Ra||e===ka||e===Ua?t.NEAREST:t.LINEAR}function p(e){var n=e.target;n.removeEventListener("dispose",p),function(e){var n=r.get(e);if(e.image&&n.__image__webglTextureCube)t.deleteTexture(n.__image__webglTextureCube);else{if(void 0===n.__webglInit)return;t.deleteTexture(n.__webglTexture)}r.remove(e)}(n),n.isVideoTexture&&delete x[n.id],a.memory.textures--}function d(e){var n=e.target;n.removeEventListener("dispose",d),function(e){var n=r.get(e),i=r.get(e.texture);if(!e)return;void 0!==i.__webglTexture&&t.deleteTexture(i.__webglTexture);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLRenderTargetCube)for(var o=0;o<6;o++)t.deleteFramebuffer(n.__webglFramebuffer[o]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[o]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer);r.remove(e.texture),r.remove(e)}(n),a.memory.textures--}function f(e,h){var d=r.get(e);if(e.isVideoTexture&&function(t){var e=t.id,n=a.render.frame;x[e]!==n&&(x[e]=n,t.update())}(e),e.version>0&&d.__version!==e.version){var f=e.image;if(void 0===f)console.warn("WebGLRenderer: Texture marked for update but image is undefined",e);else{if(!1!==f.complete)return void function(e,r,h){void 0===e.__webglInit&&(e.__webglInit=!0,r.addEventListener("dispose",p),e.__webglTexture=t.createTexture(),a.memory.textures++);n.activeTexture(t.TEXTURE0+h),n.bindTexture(t.TEXTURE_2D,e.__webglTexture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,r.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,r.unpackAlignment);var d=s(r.image,i.maxTextureSize);(function(t){return t.wrapS!==Da||t.wrapT!==Da||t.minFilter!==Ra&&t.minFilter!==ja})(r)&&!1===l(d)&&(d=function(t){if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof ImageBitmap)return void 0===b&&(b=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),b.width=xo.floorPowerOfTwo(t.width),b.height=xo.floorPowerOfTwo(t.height),b.getContext("2d").drawImage(t,0,0,b.width,b.height),console.warn("WebGLRenderer: image is not power of two ("+t.width+"x"+t.height+"). Resized to "+b.width+"x"+b.height,t),b;return t}(d));var f=l(d),v=o.convert(r.format),g=o.convert(r.type);m(t.TEXTURE_2D,r,f);var y,x=r.mipmaps;if(r.isDepthTexture){var w=t.DEPTH_COMPONENT;if(r.type===qa){if(!_)throw new Error("Float Depth Texture only supported in WebGL2.0");w=t.DEPTH_COMPONENT32F}else _&&(w=t.DEPTH_COMPONENT16);r.format===as&&w===t.DEPTH_COMPONENT&&r.type!==Wa&&r.type!==Ya&&(console.warn("WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=Wa,g=o.convert(r.type)),r.format===ss&&(w=t.DEPTH_STENCIL,r.type!==$a&&(console.warn("WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=$a,g=o.convert(r.type))),n.texImage2D(t.TEXTURE_2D,0,w,d.width,d.height,0,v,g,null)}else if(r.isDataTexture)if(x.length>0&&f){for(var S=0,A=x.length;S<A;S++)n.texImage2D(t.TEXTURE_2D,S,v,(y=x[S]).width,y.height,0,v,g,y.data);r.generateMipmaps=!1,e.__maxMipLevel=x.length-1}else n.texImage2D(t.TEXTURE_2D,0,v,d.width,d.height,0,v,g,d.data),e.__maxMipLevel=0;else if(r.isCompressedTexture){for(var S=0,A=x.length;S<A;S++)y=x[S],r.format!==ns&&r.format!==es?n.getCompressedTextureFormats().indexOf(v)>-1?n.compressedTexImage2D(t.TEXTURE_2D,S,v,y.width,y.height,0,y.data):console.warn("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(t.TEXTURE_2D,S,v,y.width,y.height,0,v,g,y.data);e.__maxMipLevel=x.length-1}else if(x.length>0&&f){for(var S=0,A=x.length;S<A;S++)n.texImage2D(t.TEXTURE_2D,S,v,v,g,y=x[S]);r.generateMipmaps=!1,e.__maxMipLevel=x.length-1}else n.texImage2D(t.TEXTURE_2D,0,v,v,g,d),e.__maxMipLevel=0;u(r,f)&&c(t.TEXTURE_2D,r,d.width,d.height);e.__version=r.version,r.onUpdate&&r.onUpdate(r)}(d,e,h);console.warn("WebGLRenderer: Texture marked for update but image is incomplete",e)}}n.activeTexture(t.TEXTURE0+h),n.bindTexture(t.TEXTURE_2D,d.__webglTexture)}function m(n,a,s){var l;if(s?(t.texParameteri(n,t.TEXTURE_WRAP_S,o.convert(a.wrapS)),t.texParameteri(n,t.TEXTURE_WRAP_T,o.convert(a.wrapT)),t.texParameteri(n,t.TEXTURE_MAG_FILTER,o.convert(a.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,o.convert(a.minFilter))):(t.texParameteri(n,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(n,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),a.wrapS===Da&&a.wrapT===Da||console.warn("WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to ClampToEdgeWrapping.",a),t.texParameteri(n,t.TEXTURE_MAG_FILTER,h(a.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,h(a.minFilter)),a.minFilter!==Ra&&a.minFilter!==ja&&console.warn("WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to NearestFilter or LinearFilter.",a)),l=e.get("EXT_texture_filter_anisotropic")){if(a.type===qa&&null===e.get("OES_texture_float_linear"))return;if(a.type===Za&&null===e.get("OES_texture_half_float_linear"))return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(t.texParameterf(n,l.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function v(e,i,a,s){var l=o.convert(i.texture.format),u=o.convert(i.texture.type);n.texImage2D(s,0,l,i.width,i.height,0,l,u,null),t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,a,s,r.get(i.texture).__webglTexture,0),t.bindFramebuffer(t.FRAMEBUFFER,null)}function g(e,n){t.bindRenderbuffer(t.RENDERBUFFER,e),n.depthBuffer&&!n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)):n.depthBuffer&&n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)):t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,n.width,n.height),t.bindRenderbuffer(t.RENDERBUFFER,null)}function y(e){var n=r.get(e),i=!0===e.isWebGLRenderTargetCube;if(e.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,n){if(n&&n.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(t.FRAMEBUFFER,e),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),f(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===as)t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,i,0);else{if(n.depthTexture.format!==ss)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,i,0)}}(n.__webglFramebuffer,e)}else if(i){n.__webglDepthbuffer=[];for(var o=0;o<6;o++)t.bindFramebuffer(t.FRAMEBUFFER,n.__webglFramebuffer[o]),n.__webglDepthbuffer[o]=t.createRenderbuffer(),g(n.__webglDepthbuffer[o],e)}else t.bindFramebuffer(t.FRAMEBUFFER,n.__webglFramebuffer),n.__webglDepthbuffer=t.createRenderbuffer(),g(n.__webglDepthbuffer,e);t.bindFramebuffer(t.FRAMEBUFFER,null)}var b,_="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext,x={};this.setTexture2D=f,this.setTextureCube=function(e,h){var d=r.get(e);if(6===e.image.length)if(e.version>0&&d.__version!==e.version){d.__image__webglTextureCube||(e.addEventListener("dispose",p),d.__image__webglTextureCube=t.createTexture(),a.memory.textures++),n.activeTexture(t.TEXTURE0+h),n.bindTexture(t.TEXTURE_CUBE_MAP,d.__image__webglTextureCube),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var f=e&&e.isCompressedTexture,v=e.image[0]&&e.image[0].isDataTexture,g=[],y=0;y<6;y++)g[y]=f||v?v?e.image[y].image:e.image[y]:s(e.image[y],i.maxCubemapSize);var b=g[0],_=l(b),x=o.convert(e.format),w=o.convert(e.type);for(m(t.TEXTURE_CUBE_MAP,e,_),y=0;y<6;y++)if(f)for(var S,A=g[y].mipmaps,M=0,T=A.length;M<T;M++)S=A[M],e.format!==ns&&e.format!==es?n.getCompressedTextureFormats().indexOf(x)>-1?n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+y,M,x,S.width,S.height,0,S.data):console.warn("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+y,M,x,S.width,S.height,0,x,w,S.data);else v?n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+y,0,x,g[y].width,g[y].height,0,x,w,g[y].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+y,0,x,x,w,g[y]);d.__maxMipLevel=f?A.length-1:0,u(e,_)&&c(t.TEXTURE_CUBE_MAP,e,b.width,b.height),d.__version=e.version,e.onUpdate&&e.onUpdate(e)}else n.activeTexture(t.TEXTURE0+h),n.bindTexture(t.TEXTURE_CUBE_MAP,d.__image__webglTextureCube)},this.setTextureCubeDynamic=function(e,i){n.activeTexture(t.TEXTURE0+i),n.bindTexture(t.TEXTURE_CUBE_MAP,r.get(e).__webglTexture)},this.setupRenderTarget=function(e){var i=r.get(e),o=r.get(e.texture);e.addEventListener("dispose",d),o.__webglTexture=t.createTexture(),a.memory.textures++;var s=!0===e.isWebGLRenderTargetCube,h=l(e);if(s){i.__webglFramebuffer=[];for(var p=0;p<6;p++)i.__webglFramebuffer[p]=t.createFramebuffer()}else i.__webglFramebuffer=t.createFramebuffer();if(s){for(n.bindTexture(t.TEXTURE_CUBE_MAP,o.__webglTexture),m(t.TEXTURE_CUBE_MAP,e.texture,h),p=0;p<6;p++)v(i.__webglFramebuffer[p],e,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+p);u(e.texture,h)&&c(t.TEXTURE_CUBE_MAP,e.texture,e.width,e.height),n.bindTexture(t.TEXTURE_CUBE_MAP,null)}else n.bindTexture(t.TEXTURE_2D,o.__webglTexture),m(t.TEXTURE_2D,e.texture,h),v(i.__webglFramebuffer,e,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),u(e.texture,h)&&c(t.TEXTURE_2D,e.texture,e.width,e.height),n.bindTexture(t.TEXTURE_2D,null);e.depthBuffer&&y(e)},this.updateRenderTargetMipmap=function(e){var i=e.texture;if(u(i,l(e))){var o=e.isWebGLRenderTargetCube?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,a=r.get(i).__webglTexture;n.bindTexture(o,a),c(o,i,e.width,e.height),n.bindTexture(o,null)}}}function Dr(t){st.call(this),this.cameras=t||[]}function Fr(t){function e(){return null===Y?ot:1}function n(){(St=new Rn(G)).get("WEBGL_depth_texture"),St.get("OES_texture_float"),St.get("OES_texture_float_linear"),St.get("OES_texture_half_float"),St.get("OES_texture_half_float_linear"),St.get("OES_standard_derivatives"),St.get("OES_element_index_uint"),St.get("ANGLE_instanced_arrays"),Bt=new function(t,e){return{convert:function(n){var r;if(n===Ia)return t.REPEAT;if(n===Da)return t.CLAMP_TO_EDGE;if(n===Fa)return t.MIRRORED_REPEAT;if(n===Ra)return t.NEAREST;if(n===ka)return t.NEAREST_MIPMAP_NEAREST;if(n===Ua)return t.NEAREST_MIPMAP_LINEAR;if(n===ja)return t.LINEAR;if(n===Ba)return t.LINEAR_MIPMAP_NEAREST;if(n===za)return t.LINEAR_MIPMAP_LINEAR;if(n===Va)return t.UNSIGNED_BYTE;if(n===Qa)return t.UNSIGNED_SHORT_4_4_4_4;if(n===Ja)return t.UNSIGNED_SHORT_5_5_5_1;if(n===Ka)return t.UNSIGNED_SHORT_5_6_5;if(n===Ga)return t.BYTE;if(n===Ha)return t.SHORT;if(n===Wa)return t.UNSIGNED_SHORT;if(n===Xa)return t.INT;if(n===Ya)return t.UNSIGNED_INT;if(n===qa)return t.FLOAT;if(n===Za&&null!==(r=e.get("OES_texture_half_float")))return r.HALF_FLOAT_OES;if(n===ts)return t.ALPHA;if(n===es)return t.RGB;if(n===ns)return t.RGBA;if(n===rs)return t.LUMINANCE;if(n===is)return t.LUMINANCE_ALPHA;if(n===as)return t.DEPTH_COMPONENT;if(n===ss)return t.DEPTH_STENCIL;if(n===Yo)return t.FUNC_ADD;if(n===qo)return t.FUNC_SUBTRACT;if(n===Zo)return t.FUNC_REVERSE_SUBTRACT;if(n===Ko)return t.ZERO;if(n===$o)return t.ONE;if(n===ta)return t.SRC_COLOR;if(n===ea)return t.ONE_MINUS_SRC_COLOR;if(n===na)return t.SRC_ALPHA;if(n===ra)return t.ONE_MINUS_SRC_ALPHA;if(n===ia)return t.DST_ALPHA;if(n===oa)return t.ONE_MINUS_DST_ALPHA;if(n===aa)return t.DST_COLOR;if(n===sa)return t.ONE_MINUS_DST_COLOR;if(n===la)return t.SRC_ALPHA_SATURATE;if((n===ls||n===us||n===cs||n===hs)&&null!==(r=e.get("WEBGL_compressed_texture_s3tc"))){if(n===ls)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===us)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===cs)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===hs)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((n===ps||n===ds||n===fs||n===ms)&&null!==(r=e.get("WEBGL_compressed_texture_pvrtc"))){if(n===ps)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===ds)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===fs)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===ms)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===vs&&null!==(r=e.get("WEBGL_compressed_texture_etc1")))return r.COMPRESSED_RGB_ETC1_WEBGL;if((n===gs||n===ys||n===bs||n===_s||n===xs||n===ws||n===Ss||n===As||n===Ms||n===Ts||n===Cs||n===Es||n===Ps||n===Os)&&null!==(r=e.get("WEBGL_compressed_texture_astc")))return n;if((n===Qo||n===Jo)&&null!==(r=e.get("EXT_blend_minmax"))){if(n===Qo)return r.MIN_EXT;if(n===Jo)return r.MAX_EXT}return n===$a&&null!==(r=e.get("WEBGL_depth_texture"))?r.UNSIGNED_INT_24_8_WEBGL:0}}}(G,St),At=new function(t,e,n){function r(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var i,o=void 0!==n.precision?n.precision:"highp",a=r(o);a!==o&&(console.warn("WebGLRenderer:",o,"not supported, using",a,"instead."),o=a);var s=!0===n.logarithmicDepthBuffer,l=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),u=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),c=t.getParameter(t.MAX_TEXTURE_SIZE),h=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),p=t.getParameter(t.MAX_VERTEX_ATTRIBS),d=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),f=t.getParameter(t.MAX_VARYING_VECTORS),m=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),v=u>0,g=!!e.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!==i)return i;var n=e.get("EXT_texture_filter_anisotropic");return i=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:r,precision:o,logarithmicDepthBuffer:s,maxTextures:l,maxVertexTextures:u,maxTextureSize:c,maxCubemapSize:h,maxAttributes:p,maxVertexUniforms:d,maxVaryings:f,maxFragmentUniforms:m,vertexTextures:v,floatFragmentTextures:g,floatVertexTextures:v&&g}}(G,St,t),(Mt=new Lr(G,St,Bt)).scissor(tt.copy(ut).multiplyScalar(ot)),Mt.viewport($.copy(at).multiplyScalar(ot)),Tt=new function(t){var e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(n,r,i){switch(i=i||1,e.calls++,r){case t.TRIANGLES:e.triangles+=i*(n/3);break;case t.TRIANGLE_STRIP:case t.TRIANGLE_FAN:e.triangles+=i*(n-2);break;case t.LINES:e.lines+=i*(n/2);break;case t.LINE_STRIP:e.lines+=i*(n-1);break;case t.LINE_LOOP:e.lines+=i*n;break;case t.POINTS:e.points+=i*n;break;default:console.error("WebGLInfo: Unknown draw mode:",r)}}}}(G),Ct=new function(){var t=new WeakMap;return{get:function(e){var n=t.get(e);return void 0===n&&t.set(e,n={}),n},remove:function(e){t.delete(e)},update:function(e,n,r){t.get(e)[n]=r},dispose:function(){t=new WeakMap}}},Et=new Ir(G,St,Mt,Ct,At,Bt,Tt),Pt=new Fn(G),Ot=new function(t,e,n){function r(t){var a=t.target,s=i[a.id];null!==s.index&&e.remove(s.index);for(var l in s.attributes)e.remove(s.attributes[l]);a.removeEventListener("dispose",r),delete i[a.id];var u=o[a.id];u&&(e.remove(u),delete o[a.id]),(u=o[s.id])&&(e.remove(u),delete o[s.id]),n.memory.geometries--}var i={},o={};return{get:function(t,e){var o=i[e.id];return o||(e.addEventListener("dispose",r),e.isBufferGeometry?o=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new O).setFromObject(t)),o=e._bufferGeometry),i[e.id]=o,n.memory.geometries++,o)},update:function(n){var r=n.index,i=n.attributes;null!==r&&e.update(r,t.ELEMENT_ARRAY_BUFFER);for(var o in i)e.update(i[o],t.ARRAY_BUFFER);var a=n.morphAttributes;for(var o in a)for(var s=a[o],l=0,u=s.length;l<u;l++)e.update(s[l],t.ARRAY_BUFFER)},getWireframeAttribute:function(n){var r=o[n.id];if(r)return r;var i=[],a=n.index,s=n.attributes;if(null!==a)for(var l=0,u=(c=a.array).length;l<u;l+=3)i.push(h=c[l+0],p=c[l+1],p,d=c[l+2],d,h);else{var c;for(l=0,u=(c=s.position.array).length/3-1;l<u;l+=3){var h,p,d;i.push(h=l+0,p=l+1,p,d=l+2,d,h)}}return r=new(P(i)>65535?M:S)(i,1),e.update(r,t.ELEMENT_ARRAY_BUFFER),o[n.id]=r,r}}}(G,Pt,Tt),Nt=new function(t,e){var n={};return{update:function(r){var i=e.render.frame,o=r.geometry,a=t.get(r,o);return n[a.id]!==i&&(o.isGeometry&&a.updateFromObject(r),t.update(a),n[a.id]=i),a},dispose:function(){n={}}}}(Ot,Tt),Rt=new function(t){var e={},n=new Float32Array(8);return{update:function(r,i,o,a){var s=r.morphTargetInfluences,l=s.length,u=e[i.id];if(void 0===u){u=[];for(var c=0;c<l;c++)u[c]=[c,0];e[i.id]=u}var h=o.morphTargets&&i.morphAttributes.position,p=o.morphNormals&&i.morphAttributes.normal;for(c=0;c<l;c++)0!==(d=u[c])[1]&&(h&&i.removeAttribute("morphTarget"+c),p&&i.removeAttribute("morphNormal"+c));for(c=0;c<l;c++)(d=u[c])[0]=c,d[1]=s[c];for(u.sort(kn),c=0;c<8;c++){var d;if(d=u[c]){var f=d[0],m=d[1];if(m){h&&i.addAttribute("morphTarget"+c,h[f]),p&&i.addAttribute("morphNormal"+c,p[f]),n[c]=m;continue}}n[c]=0}a.getUniforms().setValue(t,"morphTargetInfluences",n)}}}(G),Lt=new Mr(W,St,At),It=new Er,Dt=new Or,Ft=new function(t,e,n,r){function i(t,n){e.buffers.color.setClear(t.r,t.g,t.b,n,r)}var o,a,s,l=new h(0),u=0;return{getClearColor:function(){return l},setClearColor:function(t,e){l.set(t),i(l,u=void 0!==e?e:1)},getClearAlpha:function(){return u},setClearAlpha:function(t){i(l,u=t)},render:function(e,r,c,h){var p=r.background;null===p?i(l,u):p&&p.isColor&&(i(p,1),h=!0),(t.autoClear||h)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),p&&p.isCubeTexture?(void 0===s&&((s=new B(new H(1,1,1),new dt({uniforms:Nl.cube.uniforms,vertexShader:Nl.cube.vertexShader,fragmentShader:Nl.cube.fragmentShader,side:Ro,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),s.geometry.removeAttribute("uv"),s.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},n.update(s.geometry)),s.material.uniforms.tCube.value=p,e.push(s,s.geometry,s.material,0,null)):p&&p.isTexture&&(void 0===o&&(o=new ct(-1,1,1,-1,0,1),a=new B(new mt(2,2),new D({depthTest:!1,depthWrite:!1,fog:!1})),n.update(a.geometry)),a.material.map=p,t.renderBufferDirect(o,null,a.geometry,a.material,a,null))}}}(W,Mt,Ot,R),kt=new function(t,e,n){var r;this.setMode=function(t){r=t},this.render=function(e,i){t.drawArrays(r,e,i),n.update(i,r)},this.renderInstances=function(t,i,o){var a=e.get("ANGLE_instanced_arrays");if(null!==a){var s=t.attributes.position;s.isInterleavedBufferAttribute?a.drawArraysInstancedANGLE(r,0,o=s.data.count,t.maxInstancedCount):a.drawArraysInstancedANGLE(r,i,o,t.maxInstancedCount),n.update(o,r,t.maxInstancedCount)}else console.error("WebGLBufferRenderer: using InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}(G,St,Tt),Ut=new function(t,e,n){var r,i,o;this.setMode=function(t){r=t},this.setIndex=function(t){i=t.type,o=t.bytesPerElement},this.render=function(e,a){t.drawElements(r,a,i,e*o),n.update(a,r)},this.renderInstances=function(t,a,s){var l=e.get("ANGLE_instanced_arrays");null!==l?(l.drawElementsInstancedANGLE(r,s,i,a*o,t.maxInstancedCount),n.update(s,r,t.maxInstancedCount)):console.error("WebGLIndexedBufferRenderer: using InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}(G,St,Tt),jt=new Nr(W,G,Mt,Et,At),Tt.programs=Lt.programs,W.context=G,W.capabilities=At,W.extensions=St,W.properties=Ct,W.renderLists=It,W.state=Mt,W.info=Tt}function a(t){t.preventDefault(),console.log("WebGLRenderer: Context Lost."),X=!0}function s(){console.log("WebGLRenderer: Context Restored."),X=!1,n()}function l(t){var e=t.target;e.removeEventListener("dispose",l),function(t){c(t),Ct.remove(t)}(e)}function c(t){var e=Ct.get(t).program;t.program=void 0,void 0!==e&&Lt.releaseProgram(e)}function p(){Gt=!1}function d(){var t=zt.getDevice();t&&t.isPresenting?t.requestAnimationFrame(f):window.requestAnimationFrame(f)}function f(t){!1!==Gt&&(Ht(t),d())}function v(t,e,n){if(!1!==t.visible){if(t.layers.test(e.layers))if(t.isLight)V.pushLight(t),t.castShadow&&V.pushShadow(t);else if(t.isSprite)t.frustumCulled&&!ft.intersectsSprite(t)||V.pushSprite(t);else if(t.isImmediateRenderObject)n&&xt.setFromMatrixPosition(t.matrixWorld).applyMatrix4(_t),z.push(t,null,t.material,xt.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||ft.intersectsObject(t))){n&&xt.setFromMatrixPosition(t.matrixWorld).applyMatrix4(_t);var r=Nt.update(t),i=t.material;if(Array.isArray(i))for(var o=r.groups,a=0,s=o.length;a<s;a++){var l=o[a],u=i[l.materialIndex];u&&u.visible&&z.push(t,r,u,xt.z,l)}else i.visible&&z.push(t,r,i,xt.z,null)}var c=t.children;for(a=0,s=c.length;a<s;a++)v(c[a],e,n)}}function y(t,e,n,r){for(var i=0,o=t.length;i<o;i++){var a=t[i],s=a.object,l=a.geometry,u=void 0===r?a.material:r,c=a.group;if(n.isArrayCamera){K=n;for(var h=n.cameras,p=0,d=h.length;p<d;p++){var f=h[p];if(s.layers.test(f.layers)){var m=f.bounds;Mt.viewport($.set(m.x*rt,m.y*it,m.z*rt,m.w*it).multiplyScalar(ot)),b(s,e,f,l,u,c)}}}else K=null,b(s,e,n,l,u,c)}}function b(t,e,n,r,i,o){if(t.onBeforeRender(W,e,n,r,i,o),V=Dt.get(e,K||n),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){var a=t.isMesh&&t.matrixWorld.determinant()<0;Mt.setMaterial(i,a);var s=x(n,e.fog,i,t);Q="",function(t,e,n){t.render(function(t){W.renderBufferImmediate(t,e,n)})}(t,s,i)}else W.renderBufferDirect(n,e.fog,r,i,t,o);t.onAfterRender(W,e,n,r,i,o),V=Dt.get(e,K||n)}function _(t,e,n){var r=Ct.get(t),i=V.state.lights,o=Lt.getParameters(t,i.state,V.state.shadowsArray,e,vt.numPlanes,vt.numIntersection,n),a=Lt.getProgramCode(t,o),s=r.program,u=!0;if(void 0===s)t.addEventListener("dispose",l);else if(s.code!==a)c(t);else if(r.lightsHash!==i.state.hash)Ct.update(t,"lightsHash",i.state.hash),u=!1;else{if(void 0!==o.shaderID)return;u=!1}if(u){if(o.shaderID){var h=Nl[o.shaderID];r.shader={name:t.type,uniforms:tl.clone(h.uniforms),vertexShader:h.vertexShader,fragmentShader:h.fragmentShader}}else r.shader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.onBeforeCompile(r.shader,W),s=Lt.acquireProgram(t,r.shader,o,a),r.program=s,t.program=s}var p=s.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var d=0;d<W.maxMorphTargets;d++)p["morphTarget"+d]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(d=0;d<W.maxMorphNormals;d++)p["morphNormal"+d]>=0&&t.numSupportedMorphNormals++}var f=r.shader.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(r.numClippingPlanes=vt.numPlanes,r.numIntersection=vt.numIntersection,f.clippingPlanes=vt.uniform),r.fog=e,r.lightsHash=i.state.hash,t.lights&&(f.ambientLightColor.value=i.state.ambient,f.directionalLights.value=i.state.directional,f.spotLights.value=i.state.spot,f.rectAreaLights.value=i.state.rectArea,f.pointLights.value=i.state.point,f.hemisphereLights.value=i.state.hemi,f.directionalShadowMap.value=i.state.directionalShadowMap,f.directionalShadowMatrix.value=i.state.directionalShadowMatrix,f.spotShadowMap.value=i.state.spotShadowMap,f.spotShadowMatrix.value=i.state.spotShadowMatrix,f.pointShadowMap.value=i.state.pointShadowMap,f.pointShadowMatrix.value=i.state.pointShadowMatrix);var m=r.program.getUniforms(),v=mr.seqWithValue(m.seq,f);r.uniformsList=v}function x(t,e,n,r){nt=0;var i=Ct.get(n),o=V.state.lights;if(gt&&(yt||t!==J)){vt.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,t,i,t===J&&n.id===Z)}!1===n.needsUpdate&&(void 0===i.program?n.needsUpdate=!0:n.fog&&i.fog!==e?n.needsUpdate=!0:n.lights&&i.lightsHash!==o.state.hash?n.needsUpdate=!0:void 0===i.numClippingPlanes||i.numClippingPlanes===vt.numPlanes&&i.numIntersection===vt.numIntersection||(n.needsUpdate=!0)),n.needsUpdate&&(_(n,e,r),n.needsUpdate=!1);var a=!1,s=!1,l=!1,u=i.program,c=u.getUniforms(),h=i.shader.uniforms;if(Mt.useProgram(u.program)&&(a=!0,s=!0,l=!0),n.id!==Z&&(Z=n.id,s=!0),a||t!==J){if(c.setValue(G,"projectionMatrix",t.projectionMatrix),At.logarithmicDepthBuffer&&c.setValue(G,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),J!==(K||t)&&(J=K||t,s=!0,l=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap){var p=c.map.cameraPosition;void 0!==p&&p.setValue(G,xt.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&c.setValue(G,"viewMatrix",t.matrixWorldInverse)}if(n.skinning){c.setOptional(G,r,"bindMatrix"),c.setOptional(G,r,"bindMatrixInverse");var d=r.skeleton;if(d){var f=d.bones;if(At.floatVertexTextures){if(void 0===d.boneTexture){var m=Math.sqrt(4*f.length);m=xo.ceilPowerOfTwo(m),m=Math.max(m,4);var v=new Float32Array(m*m*4);v.set(d.boneMatrices);var g=new ye(v,m,m,ns,qa);g.needsUpdate=!0,d.boneMatrices=v,d.boneTexture=g,d.boneTextureSize=m}c.setValue(G,"boneTexture",d.boneTexture),c.setValue(G,"boneTextureSize",d.boneTextureSize)}else c.setOptional(G,d,"boneMatrices")}}return s&&(c.setValue(G,"toneMappingExposure",W.toneMappingExposure),c.setValue(G,"toneMappingWhitePoint",W.toneMappingWhitePoint),n.lights&&function(t,e){t.ambientLightColor.needsUpdate=e,t.directionalLights.needsUpdate=e,t.pointLights.needsUpdate=e,t.spotLights.needsUpdate=e,t.rectAreaLights.needsUpdate=e,t.hemisphereLights.needsUpdate=e}(h,l),e&&n.fog&&function(t,e){t.fogColor.value=e.color,e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}(h,e),n.isMeshBasicMaterial?w(h,n):n.isMeshLambertMaterial?(w(h,n),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(h,n)):n.isMeshPhongMaterial?(w(h,n),n.isMeshToonMaterial?function(t,e){A(t,e),e.gradientMap&&(t.gradientMap.value=e.gradientMap)}(h,n):A(h,n)):n.isMeshStandardMaterial?(w(h,n),n.isMeshPhysicalMaterial?function(t,e){t.clearCoat.value=e.clearCoat,t.clearCoatRoughness.value=e.clearCoatRoughness,T(t,e)}(h,n):T(h,n)):n.isMeshDepthMaterial?(w(h,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(h,n)):n.isMeshDistanceMaterial?(w(h,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias);t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(h,n)):n.isMeshNormalMaterial?(w(h,n),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale);e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale));e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(h,n)):n.isLineBasicMaterial?(function(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}(h,n),n.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(h,n)):n.isPointsMaterial?function(t,e){if(t.diffuse.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size*ot,t.scale.value=.5*it,t.map.value=e.map,null!==e.map){if(!0===e.map.matrixAutoUpdate){var n=e.map.offset,r=e.map.repeat,i=e.map.rotation,o=e.map.center;e.map.matrix.setUvTransform(n.x,n.y,r.x,r.y,i,o.x,o.y)}t.uvTransform.value.copy(e.map.matrix)}}(h,n):n.isShadowMaterial&&(h.color.value=n.color,h.opacity.value=n.opacity),void 0!==h.ltc_1&&(h.ltc_1.value=Ol.LTC_1),void 0!==h.ltc_2&&(h.ltc_2.value=Ol.LTC_2),mr.upload(G,i.uniformsList,h,W)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(mr.upload(G,i.uniformsList,h,W),n.uniformsNeedUpdate=!1),c.setValue(G,"modelViewMatrix",r.modelViewMatrix),c.setValue(G,"normalMatrix",r.normalMatrix),c.setValue(G,"modelMatrix",r.matrixWorld),u}function w(t,e){t.opacity.value=e.opacity,e.color&&(t.diffuse.value=e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap),e.envMap&&(t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap&&e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.maxMipLevel.value=Ct.get(e.envMap).__maxMipLevel),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity);var n;if(e.map?n=e.map:e.specularMap?n=e.specularMap:e.displacementMap?n=e.displacementMap:e.normalMap?n=e.normalMap:e.bumpMap?n=e.bumpMap:e.roughnessMap?n=e.roughnessMap:e.metalnessMap?n=e.metalnessMap:e.alphaMap?n=e.alphaMap:e.emissiveMap&&(n=e.emissiveMap),void 0!==n){if(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate){var r=n.offset,i=n.repeat,o=n.center;n.matrix.setUvTransform(r.x,r.y,i.x,i.y,n.rotation,o.x,o.y)}t.uvTransform.value.copy(n.matrix)}}function A(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function T(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}console.log("WebGLRenderer",To);var C=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),E=void 0!==t.context?t.context:null,N=void 0!==t.alpha&&t.alpha,L=void 0===t.depth||t.depth,I=void 0===t.stencil||t.stencil,F=void 0!==t.antialias&&t.antialias,R=void 0===t.premultipliedAlpha||t.premultipliedAlpha,k=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,j=void 0!==t.powerPreference?t.powerPreference:"default",z=null,V=null;this.domElement=C,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=xa,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var G,W=this,X=!1,Y=null,q=null,Z=-1,Q="",J=null,K=null,$=new g,tt=new g,et=null,nt=0,rt=C.width,it=C.height,ot=1,at=new g(0,0,rt,it),ut=new g(0,0,rt,it),ht=!1,ft=new Dn,vt=new function(){function t(){c.value!==r&&(c.value=r,c.needsUpdate=i>0),n.numPlanes=i,n.numIntersection=0}function e(t,e,r,i){var o=null!==t?t.length:0,a=null;if(0!==o){if(a=c.value,!0!==i||null===a){var u=r+4*o,h=e.matrixWorldInverse;l.getNormalMatrix(h),(null===a||a.length<u)&&(a=new Float32Array(u));for(var p=0,d=r;p!==o;++p,d+=4)s.copy(t[p]).applyMatrix4(h,l),s.normal.toArray(a,d),a[d+3]=s.constant}c.value=a,c.needsUpdate=!0}return n.numPlanes=o,a}var n=this,r=null,i=0,o=!1,a=!1,s=new U,l=new u,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(t,n,a){var s=0!==t.length||n||0!==i||o;return o=n,r=e(t,a,0),i=t.length,s},this.beginShadows=function(){a=!0,e(null)},this.endShadows=function(){a=!1,t()},this.setState=function(n,s,l,u,h,p){if(!o||null===n||0===n.length||a&&!l)a?e(null):t();else{var d=a?0:i,f=4*d,m=h.clippingState||null;c.value=m,m=e(n,u,f,p);for(var v=0;v!==f;++v)m[v]=r[v];h.clippingState=m,this.numIntersection=s?this.numPlanes:0,this.numPlanes+=d}}},gt=!1,yt=!1,_t=new r,xt=new i;try{var wt={alpha:N,depth:L,stencil:I,antialias:F,premultipliedAlpha:R,preserveDrawingBuffer:k,powerPreference:j};if(C.addEventListener("webglcontextlost",a,!1),C.addEventListener("webglcontextrestored",s,!1),null===(G=E||C.getContext("webgl",wt)||C.getContext("experimental-webgl",wt)))throw null!==C.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===G.getShaderPrecisionFormat&&(G.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){console.error("WebGLRenderer: "+t.message)}var St,At,Mt,Tt,Ct,Et,Pt,Ot,Nt,Lt,It,Dt,Ft,Rt,kt,Ut,jt,Bt;n();var zt=new function(t){function e(){if(null!==a&&a.isPresenting){var e=a.getEyeParameters("left"),r=e.renderWidth,i=e.renderHeight;b=t.getPixelRatio(),y=t.getSize(),t.setDrawingBufferSize(2*r,i,1)}else n.enabled&&t.setDrawingBufferSize(y.width,y.height,b)}var n=this,a=null,s=null,l=null,u=new r,c=new r;"undefined"!=typeof window&&"VRFrameData"in window&&(s=new window.VRFrameData);var h=new r,p=new o,d=new i,f=new st;f.bounds=new g(0,0,.5,1),f.layers.enable(1);var m=new st;m.bounds=new g(.5,0,.5,1),m.layers.enable(2);var v=new Dr([f,m]);v.layers.enable(1),v.layers.enable(2);var y,b;"undefined"!=typeof window&&window.addEventListener("vrdisplaypresentchange",e,!1),this.enabled=!1,this.userHeight=1.6,this.getDevice=function(){return a},this.setDevice=function(t){void 0!==t&&(a=t)},this.setPoseTarget=function(t){void 0!==t&&(l=t)},this.getCamera=function(t){if(null===a)return t;a.depthNear=t.near,a.depthFar=t.far,a.getFrameData(s);var e=a.stageParameters;e?u.fromArray(e.sittingToStandingTransform):u.makeTranslation(0,n.userHeight,0);var r=s.pose,i=null!==l?l:t;if(i.matrix.copy(u),i.matrix.decompose(i.position,i.quaternion,i.scale),null!==r.orientation&&(p.fromArray(r.orientation),i.quaternion.multiply(p)),null!==r.position&&(p.setFromRotationMatrix(u),d.fromArray(r.position),d.applyQuaternion(p),i.position.add(d)),i.updateMatrixWorld(),!1===a.isPresenting)return t;f.near=t.near,m.near=t.near,f.far=t.far,m.far=t.far,v.matrixWorld.copy(t.matrixWorld),v.matrixWorldInverse.copy(t.matrixWorldInverse),f.matrixWorldInverse.fromArray(s.leftViewMatrix),m.matrixWorldInverse.fromArray(s.rightViewMatrix),c.getInverse(u),f.matrixWorldInverse.multiply(c),m.matrixWorldInverse.multiply(c);var o=i.parent;null!==o&&(h.getInverse(o.matrixWorld),f.matrixWorldInverse.multiply(h),m.matrixWorldInverse.multiply(h)),f.matrixWorld.getInverse(f.matrixWorldInverse),m.matrixWorld.getInverse(m.matrixWorldInverse),f.projectionMatrix.fromArray(s.leftProjectionMatrix),m.projectionMatrix.fromArray(s.rightProjectionMatrix),v.projectionMatrix.copy(f.projectionMatrix);var g=a.getLayers();if(g.length){var y=g[0];null!==y.leftBounds&&4===y.leftBounds.length&&f.bounds.fromArray(y.leftBounds),null!==y.rightBounds&&4===y.rightBounds.length&&m.bounds.fromArray(y.rightBounds)}return v},this.getStandingMatrix=function(){return u},this.submitFrame=function(){a&&a.isPresenting&&a.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",e)}}(W);this.vr=zt;var Vt=new function(t,e,n){function o(e,n,r,i,o,a){var s=e.geometry,l=null,u=y,c=e.customDepthMaterial;if(r&&(u=b,c=e.customDistanceMaterial),c)l=c;else{var h=!1;n.morphTargets&&(s&&s.isBufferGeometry?h=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:s&&s.isGeometry&&(h=s.morphTargets&&s.morphTargets.length>0)),e.isSkinnedMesh&&!1===n.skinning&&console.warn("WebGLShadowMap: SkinnedMesh with material.skinning set to false:",e);var p=0;h&&(p|=d),e.isSkinnedMesh&&n.skinning&&(p|=f),l=u[p]}if(t.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var m=l.uuid,v=n.uuid,g=_[m];void 0===g&&(_[m]=g={});var w=g[v];void 0===w&&(w=l.clone(),g[v]=w),l=w}return l.visible=n.visible,l.wireframe=n.wireframe,l.side=null!=n.shadowSide?n.shadowSide:x[n.side],l.clipShadows=n.clipShadows,l.clippingPlanes=n.clippingPlanes,l.clipIntersection=n.clipIntersection,l.wireframeLinewidth=n.wireframeLinewidth,l.linewidth=n.linewidth,r&&l.isMeshDistanceMaterial&&(l.referencePosition.copy(i),l.nearDistance=o,l.farDistance=a),l}function a(n,r,i,l){if(!1!==n.visible){if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&n.castShadow&&(!n.frustumCulled||s.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,n.matrixWorld);var u=e.update(n),c=n.material;if(Array.isArray(c))for(var h=u.groups,d=0,f=h.length;d<f;d++){var m=h[d],v=c[m.materialIndex];if(v&&v.visible){var g=o(n,v,l,p,i.near,i.far);t.renderBufferDirect(i,null,u,g,n,m)}}else c.visible&&(g=o(n,c,l,p,i.near,i.far),t.renderBufferDirect(i,null,u,g,n,null))}for(var y=n.children,b=0,_=y.length;b<_;b++)a(y[b],r,i,l)}}for(var s=new Dn,l=new r,u=new m,c=new m(n,n),h=new i,p=new i,d=1,f=2,v=1+(d|f),y=new Array(v),b=new Array(v),_={},x={0:Ro,1:Fo,2:ko},w=[new i(1,0,0),new i(-1,0,0),new i(0,0,1),new i(0,0,-1),new i(0,1,0),new i(0,-1,0)],S=[new i(0,1,0),new i(0,1,0),new i(0,1,0),new i(0,1,0),new i(0,0,1),new i(0,0,-1)],A=[new g,new g,new g,new g,new g,new g],M=0;M!==v;++M){var T=0!=(M&d),C=0!=(M&f),E=new lt({depthPacking:Ws,morphTargets:T,skinning:C});y[M]=E;var P=new bt({morphTargets:T,skinning:C});b[M]=P}var O=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Io,this.render=function(e,n,r){if(!1!==O.enabled&&(!1!==O.autoUpdate||!1!==O.needsUpdate)&&0!==e.length){var i=t.state;i.disable(t.context.BLEND),i.buffers.color.setClear(1,1,1,1),i.buffers.depth.setTest(!0),i.setScissorTest(!1);for(var o,d=0,f=e.length;d<f;d++){var m=e[d],v=m.shadow,g=m&&m.isPointLight;if(void 0!==v){var y=v.camera;if(u.copy(v.mapSize),u.min(c),g){var b=u.x,_=u.y;A[0].set(2*b,_,b,_),A[1].set(0,_,b,_),A[2].set(3*b,_,b,_),A[3].set(b,_,b,_),A[4].set(3*b,0,b,_),A[5].set(b,0,b,_),u.x*=4,u.y*=2}null===v.map&&(v.map=new pt(u.x,u.y,{minFilter:Ra,magFilter:Ra,format:ns}),v.map.texture.name=m.name+".shadowMap",y.updateProjectionMatrix()),v.isSpotLightShadow&&v.update(m);var x=v.map,M=v.matrix;p.setFromMatrixPosition(m.matrixWorld),y.position.copy(p),g?(o=6,M.makeTranslation(-p.x,-p.y,-p.z)):(o=1,h.setFromMatrixPosition(m.target.matrixWorld),y.lookAt(h),y.updateMatrixWorld(),M.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),M.multiply(y.projectionMatrix),M.multiply(y.matrixWorldInverse)),t.setRenderTarget(x),t.clear();for(var T=0;T<o;T++)g&&(h.copy(y.position),h.add(w[T]),y.up.copy(S[T]),y.lookAt(h),y.updateMatrixWorld(),i.viewport(A[T])),l.multiplyMatrices(y.projectionMatrix,y.matrixWorldInverse),s.setFromMatrix(l),a(n,r,y,g)}else console.warn("WebGLShadowMap:",m,"has no shadow.")}O.needsUpdate=!1}}}(W,Nt,At.maxTextureSize);this.shadowMap=Vt,this.getContext=function(){return G},this.getContextAttributes=function(){return G.getContextAttributes()},this.forceContextLoss=function(){var t=St.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=St.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return ot},this.setPixelRatio=function(t){void 0!==t&&(ot=t,this.setSize(rt,it,!1))},this.getSize=function(){return{width:rt,height:it}},this.setSize=function(t,e,n){var r=zt.getDevice();r&&r.isPresenting?console.warn("WebGLRenderer: Can't change size while VR device is presenting."):(rt=t,it=e,C.width=t*ot,C.height=e*ot,!1!==n&&(C.style.width=t+"px",C.style.height=e+"px"),this.setViewport(0,0,t,e))},this.getDrawingBufferSize=function(){return{width:rt*ot,height:it*ot}},this.setDrawingBufferSize=function(t,e,n){rt=t,it=e,ot=n,C.width=t*n,C.height=e*n,this.setViewport(0,0,t,e)},this.getCurrentViewport=function(){return $},this.setViewport=function(t,e,n,r){at.set(t,it-e-r,n,r),Mt.viewport($.copy(at).multiplyScalar(ot))},this.setScissor=function(t,e,n,r){ut.set(t,it-e-r,n,r),Mt.scissor(tt.copy(ut).multiplyScalar(ot))},this.setScissorTest=function(t){Mt.setScissorTest(ht=t)},this.getClearColor=function(){return Ft.getClearColor()},this.setClearColor=function(){Ft.setClearColor.apply(Ft,arguments)},this.getClearAlpha=function(){return Ft.getClearAlpha()},this.setClearAlpha=function(){Ft.setClearAlpha.apply(Ft,arguments)},this.clear=function(t,e,n){var r=0;(void 0===t||t)&&(r|=G.COLOR_BUFFER_BIT),(void 0===e||e)&&(r|=G.DEPTH_BUFFER_BIT),(void 0===n||n)&&(r|=G.STENCIL_BUFFER_BIT),G.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,n,r){this.setRenderTarget(t),this.clear(e,n,r)},this.dispose=function(){C.removeEventListener("webglcontextlost",a,!1),C.removeEventListener("webglcontextrestored",s,!1),It.dispose(),Dt.dispose(),Ct.dispose(),Nt.dispose(),zt.dispose(),p()},this.renderBufferImmediate=function(t,e,n){Mt.initAttributes();var r=Ct.get(t);t.hasPositions&&!r.position&&(r.position=G.createBuffer()),t.hasNormals&&!r.normal&&(r.normal=G.createBuffer()),t.hasUvs&&!r.uv&&(r.uv=G.createBuffer()),t.hasColors&&!r.color&&(r.color=G.createBuffer());var i=e.getAttributes();if(t.hasPositions&&(G.bindBuffer(G.ARRAY_BUFFER,r.position),G.bufferData(G.ARRAY_BUFFER,t.positionArray,G.DYNAMIC_DRAW),Mt.enableAttribute(i.position),G.vertexAttribPointer(i.position,3,G.FLOAT,!1,0,0)),t.hasNormals){if(G.bindBuffer(G.ARRAY_BUFFER,r.normal),!n.isMeshPhongMaterial&&!n.isMeshStandardMaterial&&!n.isMeshNormalMaterial&&!0===n.flatShading)for(var o=0,a=3*t.count;o<a;o+=9){var s=t.normalArray,l=(s[o+0]+s[o+3]+s[o+6])/3,u=(s[o+1]+s[o+4]+s[o+7])/3,c=(s[o+2]+s[o+5]+s[o+8])/3;s[o+0]=l,s[o+1]=u,s[o+2]=c,s[o+3]=l,s[o+4]=u,s[o+5]=c,s[o+6]=l,s[o+7]=u,s[o+8]=c}G.bufferData(G.ARRAY_BUFFER,t.normalArray,G.DYNAMIC_DRAW),Mt.enableAttribute(i.normal),G.vertexAttribPointer(i.normal,3,G.FLOAT,!1,0,0)}t.hasUvs&&n.map&&(G.bindBuffer(G.ARRAY_BUFFER,r.uv),G.bufferData(G.ARRAY_BUFFER,t.uvArray,G.DYNAMIC_DRAW),Mt.enableAttribute(i.uv),G.vertexAttribPointer(i.uv,2,G.FLOAT,!1,0,0)),t.hasColors&&n.vertexColors!==Uo&&(G.bindBuffer(G.ARRAY_BUFFER,r.color),G.bufferData(G.ARRAY_BUFFER,t.colorArray,G.DYNAMIC_DRAW),Mt.enableAttribute(i.color),G.vertexAttribPointer(i.color,3,G.FLOAT,!1,0,0)),Mt.disableUnusedAttributes(),G.drawArrays(G.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,n,r,i,o,a){var s=o.isMesh&&o.matrixWorld.determinant()<0;Mt.setMaterial(i,s);var l=x(t,n,i,o),u=r.id+"_"+l.id+"_"+(!0===i.wireframe),c=!1;u!==Q&&(Q=u,c=!0),o.morphTargetInfluences&&(Rt.update(o,r,i,l),c=!0);var h=r.index,p=r.attributes.position,d=1;!0===i.wireframe&&(h=Ot.getWireframeAttribute(r),d=2);var f,m=kt;null!==h&&(f=Pt.get(h),(m=Ut).setIndex(f)),c&&(!function(t,e,n,r){if(n&&n.isInstancedBufferGeometry&&null===St.get("ANGLE_instanced_arrays"))console.error("WebGLRenderer.setupVertexAttributes: using InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{void 0===r&&(r=0),Mt.initAttributes();var i=n.attributes,o=e.getAttributes(),a=t.defaultAttributeValues;for(var s in o){var l=o[s];if(l>=0){var u=i[s];if(void 0!==u){var c=u.normalized,h=u.itemSize,p=Pt.get(u);if(void 0===p)continue;var d=p.buffer,f=p.type,m=p.bytesPerElement;if(u.isInterleavedBufferAttribute){var v=u.data,g=v.stride,y=u.offset;v&&v.isInstancedInterleavedBuffer?(Mt.enableAttributeAndDivisor(l,v.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=v.meshPerAttribute*v.count)):Mt.enableAttribute(l),G.bindBuffer(G.ARRAY_BUFFER,d),G.vertexAttribPointer(l,h,f,c,g*m,(r*g+y)*m)}else u.isInstancedBufferAttribute?(Mt.enableAttributeAndDivisor(l,u.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=u.meshPerAttribute*u.count)):Mt.enableAttribute(l),G.bindBuffer(G.ARRAY_BUFFER,d),G.vertexAttribPointer(l,h,f,c,0,r*h*m)}else if(void 0!==a){var b=a[s];if(void 0!==b)switch(b.length){case 2:G.vertexAttrib2fv(l,b);break;case 3:G.vertexAttrib3fv(l,b);break;case 4:G.vertexAttrib4fv(l,b);break;default:G.vertexAttrib1fv(l,b)}}}}Mt.disableUnusedAttributes()}}(i,l,r),null!==h&&G.bindBuffer(G.ELEMENT_ARRAY_BUFFER,f.buffer));var v=1/0;null!==h?v=h.count:void 0!==p&&(v=p.count);var g=r.drawRange.start*d,y=r.drawRange.count*d,b=null!==a?a.start*d:0,_=null!==a?a.count*d:1/0,w=Math.max(g,b),S=Math.min(v,g+y,b+_)-1,A=Math.max(0,S-w+1);if(0!==A){if(o.isMesh)if(!0===i.wireframe)Mt.setLineWidth(i.wireframeLinewidth*e()),m.setMode(G.LINES);else switch(o.drawMode){case Ds:m.setMode(G.TRIANGLES);break;case Fs:m.setMode(G.TRIANGLE_STRIP);break;case Rs:m.setMode(G.TRIANGLE_FAN)}else if(o.isLine){var M=i.linewidth;void 0===M&&(M=1),Mt.setLineWidth(M*e()),m.setMode(o.isLineSegments?G.LINES:o.isLineLoop?G.LINE_LOOP:G.LINE_STRIP)}else o.isPoints&&m.setMode(G.POINTS);r&&r.isInstancedBufferGeometry?r.maxInstancedCount>0&&m.renderInstances(r,w,A):m.render(w,A)}},this.compile=function(t,e){(V=Dt.get(t,e)).init(),t.traverse(function(t){t.isLight&&(V.pushLight(t),t.castShadow&&V.pushShadow(t))}),V.setupLights(e),t.traverse(function(e){if(e.material)if(Array.isArray(e.material))for(var n=0;n<e.material.length;n++)_(e.material[n],t.fog,e);else _(e.material,t.fog,e)})};var Gt=!1,Ht=null;this.animate=function(t){null!==(Ht=t)?Gt||(d(),Gt=!0):p()},this.render=function(t,e,n,r){if(e&&e.isCamera){if(!X){Q="",Z=-1,J=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),zt.enabled&&(e=zt.getCamera(e)),(V=Dt.get(t,e)).init(),t.onBeforeRender(W,t,e,n),_t.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),ft.setFromMatrix(_t),gt=vt.init(this.clippingPlanes,yt=this.localClippingEnabled,e),(z=It.get(t,e)).init(),v(t,e,W.sortObjects),!0===W.sortObjects&&z.sort(),gt&&vt.beginShadows();Vt.render(V.state.shadowsArray,t,e),V.setupLights(e),gt&&vt.endShadows(),this.info.autoReset&&this.info.reset(),void 0===n&&(n=null),this.setRenderTarget(n),Ft.render(z,t,e,r);var i=z.opaque,o=z.transparent;if(t.overrideMaterial){var a=t.overrideMaterial;i.length&&y(i,t,e,a),o.length&&y(o,t,e,a)}else i.length&&y(i,t,e),o.length&&y(o,t,e);jt.render(V.state.spritesArray,t,e),n&&Et.updateRenderTargetMipmap(n),Mt.buffers.depth.setTest(!0),Mt.buffers.depth.setMask(!0),Mt.buffers.color.setMask(!0),Mt.setPolygonOffset(!1),t.onAfterRender(W,t,e),zt.enabled&&zt.submitFrame(),z=null,V=null}}else console.error("WebGLRenderer.render: camera is not an instance of Camera.")},this.allocTextureUnit=function(){var t=nt;return t>=At.maxTextures&&console.warn("WebGLRenderer: Trying to use "+t+" texture units while this GPU supports only "+At.maxTextures),nt+=1,t},this.setTexture2D=function(){var t=!1;return function(e,n){e&&e.isWebGLRenderTarget&&(t||(console.warn("WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),Et.setTexture2D(e,n)}}(),this.setTexture=function(){var t=!1;return function(e,n){t||(console.warn("WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),t=!0),Et.setTexture2D(e,n)}}(),this.setTextureCube=function(){var t=!1;return function(e,n){e&&e.isWebGLRenderTargetCube&&(t||(console.warn("WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?Et.setTextureCube(e,n):Et.setTextureCubeDynamic(e,n)}}(),this.getRenderTarget=function(){return Y},this.setRenderTarget=function(t){Y=t,t&&void 0===Ct.get(t).__webglFramebuffer&&Et.setupRenderTarget(t);var e=null,n=!1;if(t){var r=Ct.get(t).__webglFramebuffer;t.isWebGLRenderTargetCube?(e=r[t.activeCubeFace],n=!0):e=r,$.copy(t.viewport),tt.copy(t.scissor),et=t.scissorTest}else $.copy(at).multiplyScalar(ot),tt.copy(ut).multiplyScalar(ot),et=ht;if(q!==e&&(G.bindFramebuffer(G.FRAMEBUFFER,e),q=e),Mt.viewport($),Mt.scissor(tt),Mt.setScissorTest(et),n){var i=Ct.get(t.texture);G.framebufferTexture2D(G.FRAMEBUFFER,G.COLOR_ATTACHMENT0,G.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,i.__webglTexture,t.activeMipMapLevel)}},this.readRenderTargetPixels=function(t,e,n,r,i,o){if(t&&t.isWebGLRenderTarget){var a=Ct.get(t).__webglFramebuffer;if(a){var s=!1;a!==q&&(G.bindFramebuffer(G.FRAMEBUFFER,a),s=!0);try{var l=t.texture,u=l.format,c=l.type;if(u!==ns&&Bt.convert(u)!==G.getParameter(G.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(c===Va||Bt.convert(c)===G.getParameter(G.IMPLEMENTATION_COLOR_READ_TYPE)||c===qa&&(St.get("OES_texture_float")||St.get("WEBGL_color_buffer_float"))||c===Za&&St.get("EXT_color_buffer_half_float")))return void console.error("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");G.checkFramebufferStatus(G.FRAMEBUFFER)===G.FRAMEBUFFER_COMPLETE?e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&G.readPixels(e,n,r,i,Bt.convert(u),Bt.convert(c),o):console.error("WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&G.bindFramebuffer(G.FRAMEBUFFER,q)}}}else console.error("WebGLRenderer.readRenderTargetPixels: renderTarget is not WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e,n){var r=e.image.width,i=e.image.height,o=Bt.convert(e.format);this.setTexture2D(e,0),G.copyTexImage2D(G.TEXTURE_2D,n||0,o,t.x,t.y,r,i,0)},this.copyTextureToTexture=function(t,e,n,r){var i=e.image.width,o=e.image.height,a=Bt.convert(n.format),s=Bt.convert(n.type),l=e.isDataTexture?e.image.data:e.image;this.setTexture2D(n,0),G.texSubImage2D(G.TEXTURE_2D,r||0,t.x,t.y,i,o,a,s,l)}}function Rr(t){"string"==typeof t&&(console.warn("Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function kr(t,e,n,r){v.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new Ur(t,e,n,r)),this.mergeVertices()}function Ur(t,e,n,r){O.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},t=t||1,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var o,a,s=[],l=[],u=[],c=[],h=new i,p=new m;for(l.push(0,0,0),u.push(0,0,1),c.push(.5,.5),a=0,o=3;a<=e;a++,o+=3){var d=n+a/e*r;h.x=t*Math.cos(d),h.y=t*Math.sin(d),l.push(h.x,h.y,h.z),u.push(0,0,1),p.x=(l[o]/t+1)/2,p.y=(l[o+1]/t+1)/2,c.push(p.x,p.y)}for(o=1;o<=e;o++)s.push(o,o+1,0);this.setIndex(s),this.addAttribute("position",new T(l,3)),this.addAttribute("normal",new T(u,3)),this.addAttribute("uv",new T(c,2))}function jr(t,e){v.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Br(t,e)),this.mergeVertices()}function Br(t,e){var n=(1+Math.sqrt(5))/2;Bt.call(this,[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function zr(t,e,n,r,i,o,a,s){Jt.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function Vr(t,e,n,r,i,o){zr.call(this,t,e,n,n,r,i,o),this.type="ArcCurve"}function Gr(){function t(t,o,a,s){e=t,n=a,r=-3*t+3*o-2*a-s,i=2*t-2*o+a+s}var e=0,n=0,r=0,i=0;return{initCatmullRom:function(e,n,r,i,o){t(n,r,o*(r-e),o*(i-n))},initNonuniformCatmullRom:function(e,n,r,i,o,a,s){var l=(n-e)/o-(r-e)/(o+a)+(r-n)/a,u=(r-n)/a-(i-n)/(a+s)+(i-r)/s;t(n,r,l*=a,u*=a)},calc:function(t){var o=t*t;return e+n*t+r*o+i*(o*t)}}}function Hr(t,e,n,r){Jt.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=n||"centripetal",this.tension=r||.5}function Wr(t,e,n,r,i){var o=.5*(r-e),a=.5*(i-n),s=t*t;return(2*n-2*r+o+a)*(t*s)+(-3*n+3*r-2*o-a)*s+o*t+n}function Xr(t,e,n,r){return function(t,e){var n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,r)}function Yr(t,e,n,r,i){return function(t,e){var n=1-t;return n*n*n*e}(t,e)+function(t,e){var n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,r)+function(t,e){return t*t*t*e}(t,i)}function qr(t,e,n,r){Jt.call(this),this.type="CubicBezierCurve",this.v0=t||new m,this.v1=e||new m,this.v2=n||new m,this.v3=r||new m}function Zr(t,e,n,r){Jt.call(this),this.type="CubicBezierCurve3",this.v0=t||new i,this.v1=e||new i,this.v2=n||new i,this.v3=r||new i}function Qr(t,e){Jt.call(this),this.type="LineCurve",this.v1=t||new m,this.v2=e||new m}function Jr(t,e){Jt.call(this),this.type="LineCurve3",this.v1=t||new i,this.v2=e||new i}function Kr(t,e,n){Jt.call(this),this.type="QuadraticBezierCurve",this.v0=t||new m,this.v1=e||new m,this.v2=n||new m}function $r(t,e,n){Jt.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new i,this.v1=e||new i,this.v2=n||new i}function ti(t){Jt.call(this),this.type="SplineCurve",this.points=t||[]}function ei(){Jt.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function ni(t){ei.call(this),this.type="Path",this.currentPoint=new m,t&&this.setFromPoints(t)}function ri(t){ni.call(this,t),this.uuid=xo.generateUUID(),this.type="Shape",this.holes=[]}function ii(t,e,n,r,i){var o,a;if(i===function(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}(t,e,n,r)>0)for(o=e;o<n;o+=r)a=vi(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=vi(o,t[o],t[o+1],a);return a&&pi(a,a.next)&&(gi(a),a=a.next),a}function oi(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!pi(r,r.next)&&0!==hi(r.prev,r,r.next))r=r.next;else{if(gi(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function ai(t,e,n,r,i,o,a){if(t){!a&&o&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=ui(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,l,u=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<u&&(s++,r=r.nextZ);e++);for(l=u;s>0||l>0&&r;)0!==s&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,l--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,u*=2}while(a>1)}(i)}(t,r,i,o);for(var s,l,u=t;t.prev!==t.next;)if(s=t.prev,l=t.next,o?function(t,e,n,r){var i=t.prev,o=t,a=t.next;if(hi(i,o,a)>=0)return!1;var s=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,u=ui(i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,e,n,r),c=ui(s,l,e,n,r),h=t.nextZ;for(;h&&h.z<=c;){if(h!==t.prev&&h!==t.next&&ci(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&hi(h.prev,h,h.next)>=0)return!1;h=h.nextZ}h=t.prevZ;for(;h&&h.z>=u;){if(h!==t.prev&&h!==t.next&&ci(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&hi(h.prev,h,h.next)>=0)return!1;h=h.prevZ}return!0}(t,r,i,o):function(t){var e=t.prev,n=t,r=t.next;if(hi(e,n,r)>=0)return!1;var i=t.next.next;for(;i!==t.prev;){if(ci(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&hi(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}(t))e.push(s.i/n),e.push(t.i/n),e.push(l.i/n),gi(t),t=l.next,u=l.next;else if((t=l)===u){a?1===a?ai(t=function(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!pi(i,o)&&di(i,r,r.next,o)&&fi(i,o)&&fi(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),gi(r),gi(r.next),r=t=o),r=r.next}while(r!==t);return r}(t,e,n),e,n,r,i,o,2):2===a&&function(t,e,n,r,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&function(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&di(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&fi(t,e)&&fi(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)}(a,s)){var l=mi(a,s);return a=oi(a,a.next),l=oi(l,l.next),ai(a,e,n,r,i,o),void ai(l,e,n,r,i,o)}s=s.next}a=a.next}while(a!==t)}(t,e,n,r,i,o):ai(oi(t),e,n,r,i,o,1);break}}}function si(t,e,n,r){var i,o,a,s=[];for(i=0,o=e.length;i<o;i++)(a=ii(t,e[i]*r,i<o-1?e[i+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),s.push(function(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}(a));for(s.sort(li),i=0;i<s.length;i++)!function(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n.prev;var l,u=n,c=n.x,h=n.y,p=1/0;for(r=n.next;r!==u;)i>=r.x&&r.x>=c&&i!==r.x&&ci(o<h?i:a,o,c,h,o<h?a:i,o,r.x,r.y)&&((l=Math.abs(o-r.y)/(i-r.x))<p||l===p&&r.x>n.x)&&fi(r,t)&&(n=r,p=l),r=r.next;return n}(t,e)){var n=mi(e,t);oi(n,n.next)}}(s[i],n),n=oi(n,n.next);return n}function li(t,e){return t.x-e.x}function ui(t,e,n,r,i){return t=32767*(t-n)*i,e=32767*(e-r)*i,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function ci(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function hi(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function pi(t,e){return t.x===e.x&&t.y===e.y}function di(t,e,n,r){return!!(pi(t,e)&&pi(n,r)||pi(t,r)&&pi(n,e))||hi(t,e,n)>0!=hi(t,e,r)>0&&hi(n,r,t)>0!=hi(n,r,e)>0}function fi(t,e){return hi(t.prev,t,t.next)<0?hi(t,e,t.next)>=0&&hi(t,t.prev,e)>=0:hi(t,e,t.prev)<0||hi(t,t.next,e)<0}function mi(t,e){var n=new yi(t.i,t.x,t.y),r=new yi(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function vi(t,e,n,r){var i=new yi(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function gi(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function yi(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function bi(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function _i(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}function xi(t,e){v.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new wi(t,e)),this.mergeVertices()}function wi(t,e){function n(t){var n,s,u,c=i.length/3,h=t.extractPoints(e),p=h.shape,d=h.holes;if(!1===_d.isClockWise(p))for(p=p.reverse(),n=0,s=d.length;n<s;n++)!0===_d.isClockWise(u=d[n])&&(d[n]=u.reverse());var f=_d.triangulateShape(p,d);for(n=0,s=d.length;n<s;n++)p=p.concat(u=d[n]);for(n=0,s=p.length;n<s;n++){var m=p[n];i.push(m.x,m.y,0),o.push(0,0,1),a.push(m.x,m.y)}for(n=0,s=f.length;n<s;n++){var v=f[n];r.push(v[0]+c,v[1]+c,v[2]+c),l+=3}}O.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var r=[],i=[],o=[],a=[],s=0,l=0;if(!1===Array.isArray(t))n(t);else for(var u=0;u<t.length;u++)n(t[u]),this.addGroup(s,l,u),s+=l,l=0;this.setIndex(r),this.addAttribute("position",new T(i,3)),this.addAttribute("normal",new T(o,3)),this.addAttribute("uv",new T(a,2))}function Si(t,e){if(e.shapes=[],Array.isArray(t))for(var n=0,r=t.length;n<r;n++){e.shapes.push(t[n].uuid)}else e.shapes.push(t.uuid);return e}function Ai(t){dn.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function Mi(t,e,n){c.call(this),this.type="CubeCamera";var r=new st(90,1,t,e);r.up.set(0,-1,0),r.lookAt(new i(1,0,0)),this.add(r);var o=new st(90,1,t,e);o.up.set(0,-1,0),o.lookAt(new i(-1,0,0)),this.add(o);var a=new st(90,1,t,e);a.up.set(0,0,1),a.lookAt(new i(0,1,0)),this.add(a);var s=new st(90,1,t,e);s.up.set(0,0,-1),s.lookAt(new i(0,-1,0)),this.add(s);var l=new st(90,1,t,e);l.up.set(0,-1,0),l.lookAt(new i(0,0,1)),this.add(l);var u=new st(90,1,t,e);u.up.set(0,-1,0),u.lookAt(new i(0,0,-1)),this.add(u);this.renderTarget=new Ln(n,n,{format:es,magFilter:ja,minFilter:ja}),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,i=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,n.activeCubeFace=0,t.render(e,r,n),n.activeCubeFace=1,t.render(e,o,n),n.activeCubeFace=2,t.render(e,a,n),n.activeCubeFace=3,t.render(e,s,n),n.activeCubeFace=4,t.render(e,l,n),n.texture.generateMipmaps=i,n.activeCubeFace=5,t.render(e,u,n),t.setRenderTarget(null)},this.clear=function(t,e,n,r){for(var i=this.renderTarget,o=0;o<6;o++)i.activeCubeFace=o,t.setRenderTarget(i),t.clear(e,n,r);t.setRenderTarget(null)}}function Ti(t,e,n){y.call(this,t,e),this.meshPerAttribute=n||1}function Ci(){this.type="ShapePath",this.subPaths=[],this.currentPath=null}function Ei(t){this.type="Font",this.data=t}function Pi(t,e,n,r){for(var i=String(t).split(""),o=e/r.resolution,a=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*o,s=[],l=0,u=0,c=0;c<i.length;c++){var h=i[c];if("\n"===h)l=0,u-=a;else{var p=function(t,e,n,r,i,o){var a=o.glyphs[t]||o.glyphs["?"];if(!a)return;var s,l,u,c,h,p,d,f,m=new Ci;if(a.o)for(var v=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),g=0,y=v.length;g<y;){var b=v[g++];switch(b){case"m":s=v[g++]*n+r,l=v[g++]*n+i,m.moveTo(s,l);break;case"l":s=v[g++]*n+r,l=v[g++]*n+i,m.lineTo(s,l);break;case"q":u=v[g++]*n+r,c=v[g++]*n+i,h=v[g++]*n+r,p=v[g++]*n+i,m.quadraticCurveTo(h,p,u,c);break;case"b":u=v[g++]*n+r,c=v[g++]*n+i,h=v[g++]*n+r,p=v[g++]*n+i,d=v[g++]*n+r,f=v[g++]*n+i,m.bezierCurveTo(h,p,d,f,u,c)}}return{offsetX:a.ha*n,path:m}}(h,0,o,l,u,r);l+=p.offsetX,s.push(p.path)}}return s}function Oi(t,e,n,r,i,o,a){W.call(this,0,t,e,n,r,i,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function Ni(t,e,n,r,i,o,a){X.call(this,0,t,e,n,r,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function Li(t,e){v.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ii(t,e)),this.mergeVertices()}function Ii(t,e){var n=(1+Math.sqrt(5))/2,r=1/n;Bt.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Di(t,e){O.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;var n,r,i,o,a=[],s=Math.cos(xo.DEG2RAD*e),l=[0,0],u={},c=["a","b","c"];t.isBufferGeometry?(o=new v).fromBufferGeometry(t):o=t.clone(),o.mergeVertices(),o.computeFaceNormals();for(var h=o.vertices,p=o.faces,d=0,f=p.length;d<f;d++)for(var m=p[d],g=0;g<3;g++)n=m[c[g]],r=m[c[(g+1)%3]],l[0]=Math.min(n,r),l[1]=Math.max(n,r),void 0===u[i=l[0]+","+l[1]]?u[i]={index1:l[0],index2:l[1],face1:d,face2:void 0}:u[i].face2=d;for(i in u){var y=u[i];if(void 0===y.face2||p[y.face1].normal.dot(p[y.face2].normal)<=s){var b=h[y.index1];a.push(b.x,b.y,b.z),a.push((b=h[y.index2]).x,b.y,b.z)}}this.addAttribute("position",new T(a,3))}function Fi(t,e){v.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new Ri(t,e)),this.mergeVertices()}function Ri(t,e){void 0!==t&&(O.call(this),this.type="ExtrudeBufferGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),this.computeVertexNormals())}function ki(t,e,n,r){v.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},this.fromBufferGeometry(new Ui(t,e,n,r)),this.mergeVertices()}function Ui(t,e,n,r){O.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e)||12,n=n||0,r=r||2*Math.PI,r=xo.clamp(r,0,2*Math.PI);var o,a,s,l=[],u=[],c=[],h=1/e,p=new i,d=new m;for(a=0;a<=e;a++){var f=n+a*h*r,v=Math.sin(f),g=Math.cos(f);for(s=0;s<=t.length-1;s++)p.x=t[s].x*v,p.y=t[s].y,p.z=t[s].x*g,u.push(p.x,p.y,p.z),d.x=a/e,d.y=s/(t.length-1),c.push(d.x,d.y)}for(a=0;a<e;a++)for(s=0;s<t.length-1;s++){var y=(o=s+a*t.length)+t.length,b=o+t.length+1,_=o+1;l.push(o,y,_),l.push(y,b,_)}if(this.setIndex(l),this.addAttribute("position",new T(u,3)),this.addAttribute("uv",new T(c,2)),this.computeVertexNormals(),r===2*Math.PI){var x=this.attributes.normal.array,w=new i,S=new i,A=new i;for(o=e*t.length*3,a=0,s=0;a<t.length;a++,s+=3)w.x=x[s+0],w.y=x[s+1],w.z=x[s+2],S.x=x[o+s+0],S.y=x[o+s+1],S.z=x[o+s+2],A.addVectors(w,S).normalize(),x[s+0]=x[o+s+0]=A.x,x[s+1]=x[o+s+1]=A.y,x[s+2]=x[o+s+2]=A.z}}function ji(t,e,n){v.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n},this.fromBufferGeometry(new Bi(t,e,n)),this.mergeVertices()}function Bi(t,e,n){O.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:n};var r,o,a=[],s=[],l=[],u=[],c=new i,h=new i,p=new i,d=new i,f=new i,m=e+1;for(r=0;r<=n;r++){var v=r/n;for(o=0;o<=e;o++){var g=o/e;t(g,v,h),s.push(h.x,h.y,h.z),g-1e-5>=0?(t(g-1e-5,v,p),d.subVectors(h,p)):(t(g+1e-5,v,p),d.subVectors(p,h)),v-1e-5>=0?(t(g,v-1e-5,p),f.subVectors(h,p)):(t(g,v+1e-5,p),f.subVectors(p,h)),c.crossVectors(d,f).normalize(),l.push(c.x,c.y,c.z),u.push(g,v)}}for(r=0;r<n;r++)for(o=0;o<e;o++){var y=r*m+o+1,b=(r+1)*m+o+1,_=(r+1)*m+o;a.push(r*m+o,y,_),a.push(y,b,_)}this.setIndex(a),this.addAttribute("position",new T(s,3)),this.addAttribute("normal",new T(l,3)),this.addAttribute("uv",new T(u,2))}function zi(t,e,n,r,i,o){v.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new Vi(t,e,n,r,i,o)),this.mergeVertices()}function Vi(t,e,n,r,o,a){O.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:o,thetaLength:a},t=t||.5,e=e||1,o=void 0!==o?o:0,a=void 0!==a?a:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var s,l,u,c=[],h=[],p=[],d=[],f=t,v=(e-t)/(r=void 0!==r?Math.max(1,r):1),g=new i,y=new m;for(l=0;l<=r;l++){for(u=0;u<=n;u++)s=o+u/n*a,g.x=f*Math.cos(s),g.y=f*Math.sin(s),h.push(g.x,g.y,g.z),p.push(0,0,1),y.x=(g.x/e+1)/2,y.y=(g.y/e+1)/2,d.push(y.x,y.y);f+=v}for(l=0;l<r;l++){var b=l*(n+1);for(u=0;u<n;u++){var _=(s=u+b)+n+1,x=s+n+2,w=s+1;c.push(s,_,w),c.push(_,x,w)}}this.setIndex(c),this.addAttribute("position",new T(h,3)),this.addAttribute("normal",new T(p,3)),this.addAttribute("uv",new T(d,2))}function Gi(t,e){v.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Hi(t,e)),this.mergeVertices()}function Hi(t,e){Bt.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Wi(t,e){v.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new Xi(t,e)),this.mergeVertices()}function Xi(t,e){var n=(e=e||{}).font;if(!n||!n.isFont)return console.error("TextGeometry: font parameter is not an instance of Font."),new v;var r=n.generateShapes(t,e.size,e.curveSegments);e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),Ri.call(this,r,e),this.type="TextBufferGeometry"}function Yi(t,e,n,r,i,o,a){v.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},void 0!==a&&console.warn("TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new qi(t,e,n,r,i,o)),this.mergeVertices()}function qi(t,e,n,r,o,a){function s(t,e,n,r,i){var o=Math.cos(t),a=Math.sin(t),s=n/e*t,l=Math.cos(s);i.x=r*(2+l)*.5*o,i.y=r*(2+l)*a*.5,i.z=r*Math.sin(s)*.5}O.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:o,q:a},t=t||1,e=e||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,o=o||2,a=a||3;var l,u,c=[],h=[],p=[],d=[],f=new i,m=new i,v=new i,g=new i,y=new i,b=new i,_=new i;for(l=0;l<=n;++l){var x=l/n*o*Math.PI*2;for(s(x,o,a,t,v),s(x+.01,o,a,t,g),b.subVectors(g,v),_.addVectors(g,v),y.crossVectors(b,_),_.crossVectors(y,b),y.normalize(),_.normalize(),u=0;u<=r;++u){var w=u/r*Math.PI*2,S=-e*Math.cos(w),A=e*Math.sin(w);f.x=v.x+(S*_.x+A*y.x),f.y=v.y+(S*_.y+A*y.y),f.z=v.z+(S*_.z+A*y.z),h.push(f.x,f.y,f.z),m.subVectors(f,v).normalize(),p.push(m.x,m.y,m.z),d.push(l/n),d.push(u/r)}}for(u=1;u<=n;u++)for(l=1;l<=r;l++){var M=(r+1)*u+(l-1),C=(r+1)*u+l,E=(r+1)*(u-1)+l;c.push((r+1)*(u-1)+(l-1),M,E),c.push(M,C,E)}this.setIndex(c),this.addAttribute("position",new T(h,3)),this.addAttribute("normal",new T(p,3)),this.addAttribute("uv",new T(d,2))}function Zi(t,e,n,r,i,o){v.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},void 0!==o&&console.warn("TubeGeometry: taper has been removed.");var a=new Qi(t,e,n,r,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function Qi(t,e,n,r,o){function a(i){d=t.getPointAt(i/e,d);var o=s.normals[i],a=s.binormals[i];for(u=0;u<=r;u++){var l=u/r*Math.PI*2,p=Math.sin(l),m=-Math.cos(l);h.x=m*o.x+p*a.x,h.y=m*o.y+p*a.y,h.z=m*o.z+p*a.z,h.normalize(),v.push(h.x,h.y,h.z),c.x=d.x+n*h.x,c.y=d.y+n*h.y,c.z=d.z+n*h.z,f.push(c.x,c.y,c.z)}}O.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:o},e=e||64,n=n||1,r=r||8;var s=t.computeFrenetFrames(e,o=o||!1);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;var l,u,c=new i,h=new i,p=new m,d=new i,f=[],v=[],g=[],y=[];!function(){for(l=0;l<e;l++)a(l);a(!1===o?e:0),function(){for(l=0;l<=e;l++)for(u=0;u<=r;u++)p.x=l/e,p.y=u/r,g.push(p.x,p.y)}(),function(){for(u=1;u<=e;u++)for(l=1;l<=r;l++){var t=(r+1)*(u-1)+(l-1),n=(r+1)*u+(l-1),i=(r+1)*u+l,o=(r+1)*(u-1)+l;y.push(t,n,o),y.push(n,i,o)}}()}(),this.setIndex(y),this.addAttribute("position",new T(f,3)),this.addAttribute("normal",new T(v,3)),this.addAttribute("uv",new T(g,2))}function Ji(t,e,n,r,i,o){c.call(this),void 0===r&&(r=16776960),void 0===n&&(n=1),void 0===i&&(i=.2*n),void 0===o&&(o=.2*i),void 0===wd&&((wd=new O).addAttribute("position",new T([0,0,0,0,1,0],3)),(Sd=new X(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new z(wd,new F({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new B(Sd,new D({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,i,o)}function Ki(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=new O;n.addAttribute("position",new T(e,3)),n.addAttribute("color",new T([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var r=new F({vertexColors:Bo});je.call(this,n,r)}function $i(t,e){this.type="Box3Helper",this.box=t;var n=void 0!==e?e:16776960,r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new O;i.setIndex(new y(r,1)),i.addAttribute("position",new T([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),je.call(this,i,new F({color:n})),this.geometry.computeBoundingSphere()}function to(t){function e(t,e,r){n(t,r),n(e,r)}function n(t,e){o.push(0,0,0),a.push(e.r,e.g,e.b),void 0===s[t]&&(s[t]=[]),s[t].push(o.length/3-1)}var r=new O,i=new F({color:16777215,vertexColors:jo}),o=[],a=[],s={},l=new h(16755200),u=new h(16711680),c=new h(43775),p=new h(16777215),d=new h(3355443);e("n1","n2",l),e("n2","n4",l),e("n4","n3",l),e("n3","n1",l),e("f1","f2",l),e("f2","f4",l),e("f4","f3",l),e("f3","f1",l),e("n1","f1",l),e("n2","f2",l),e("n3","f3",l),e("n4","f4",l),e("p","n1",u),e("p","n2",u),e("p","n3",u),e("p","n4",u),e("u1","u2",c),e("u2","u3",c),e("u3","u1",c),e("c","t",p),e("p","c",d),e("cn1","cn2",d),e("cn3","cn4",d),e("cf1","cf2",d),e("cf3","cf4",d),r.addAttribute("position",new T(o,3)),r.addAttribute("color",new T(a,3)),je.call(this,r,i),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}function eo(t,e,n){c.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===e&&(e=1);var r=new O;r.addAttribute("position",new T([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var i=new F({fog:!1});this.lightPlane=new z(r,i),this.add(this.lightPlane),(r=new O).addAttribute("position",new T([0,0,0,0,0,1],3)),this.targetLine=new z(r,i),this.add(this.targetLine),this.update()}function no(t,e,n,r){this.object=t,this.size=void 0!==e?e:1;var i=void 0!==n?n:16776960,o=void 0!==r?r:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=s.faces.length:console.warn("FaceNormalsHelper: only Geometry is supported. Use VertexNormalsHelper, instead.");var l=new O,u=new T(2*a*3,3);l.addAttribute("position",u),je.call(this,l,new F({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function ro(t,e,n,r){t=t||10,e=e||10,n=new h(void 0!==n?n:4473924),r=new h(void 0!==r?r:8947848);for(var i=e/2,o=t/e,a=t/2,s=[],l=[],u=0,c=0,p=-a;u<=e;u++,p+=o){s.push(-a,0,p,a,0,p),s.push(p,0,-a,p,0,a);var d=u===i?n:r;d.toArray(l,c),d.toArray(l,c+=3),d.toArray(l,c+=3),d.toArray(l,c+=3),c+=3}var f=new O;f.addAttribute("position",new T(s,3)),f.addAttribute("color",new T(l,3));var m=new F({vertexColors:Bo});je.call(this,f,m)}function io(t,e,n){c.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var r=new Vt(e);r.rotateY(.5*Math.PI),this.material=new D({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=Bo);var i=r.getAttribute("position"),o=new Float32Array(3*i.count);r.addAttribute("color",new y(o,3)),this.add(new B(r,this.material)),this.update()}function oo(t,e,n){this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e;var r=void 0!==n?n:16776960,i=new O;i.addAttribute("position",new T([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),z.call(this,i,new F({color:r}));var o=new O;o.addAttribute("position",new T([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new B(o,new D({color:r,opacity:.2,transparent:!0,depthWrite:!1})))}function ao(t,e,n){this.light=t,this.light.updateMatrixWorld(),this.color=n;var r=new L(e,4,2),i=new D({wireframe:!0,fog:!1});B.call(this,r,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function so(t,e,n,r,i,o){t=t||10,e=e||16,n=n||8,r=r||64,i=new h(void 0!==i?i:4473924),o=new h(void 0!==o?o:8947848);var a,s,l,u,c,p,d,f=[],m=[];for(u=0;u<=e;u++)l=u/e*(2*Math.PI),a=Math.sin(l)*t,s=Math.cos(l)*t,f.push(0,0,0),f.push(a,0,s),m.push((d=1&u?i:o).r,d.g,d.b),m.push(d.r,d.g,d.b);for(u=0;u<=n;u++)for(d=1&u?i:o,p=t-t/n*u,c=0;c<r;c++)l=c/r*(2*Math.PI),a=Math.sin(l)*p,s=Math.cos(l)*p,f.push(a,0,s),m.push(d.r,d.g,d.b),l=(c+1)/r*(2*Math.PI),a=Math.sin(l)*p,s=Math.cos(l)*p,f.push(a,0,s),m.push(d.r,d.g,d.b);var v=new O;v.addAttribute("position",new T(f,3)),v.addAttribute("color",new T(m,3));var g=new F({vertexColors:Bo});je.call(this,v,g)}function lo(t,e){c.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;var n=new F({fog:!1}),r=new O;r.addAttribute("position",new y(new Float32Array(15),3)),this.line=new z(r,n),this.add(this.line),this.update()}function uo(t){var e=[];t&&t.isBone&&e.push(t);for(var n=0;n<t.children.length;n++)e.push.apply(e,uo(t.children[n]));return e}function co(t){for(var e=uo(t),n=new O,r=[],i=[],o=new h(0,0,1),a=new h(0,1,0),s=0;s<e.length;s++){var l=e[s];l.parent&&l.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}n.addAttribute("position",new T(r,3)),n.addAttribute("color",new T(i,3));var u=new F({vertexColors:Bo,depthTest:!1,depthWrite:!1,transparent:!0});je.call(this,n,u),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function ho(t,e){c.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;for(var n=new O,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,o=1;i<32;i++,o++){var a=i/32*Math.PI*2,s=o/32*Math.PI*2;r.push(Math.cos(a),Math.sin(a),1,Math.cos(s),Math.sin(s),1)}n.addAttribute("position",new T(r,3));var l=new F({fog:!1});this.cone=new je(n,l),this.add(this.cone),this.update()}function po(t,e,n,r){this.object=t,this.size=void 0!==e?e:1;var i=void 0!==n?n:16711680,o=void 0!==r?r:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=3*s.faces.length:s&&s.isBufferGeometry&&(a=s.attributes.normal.count);var l=new O,u=new T(2*a*3,3);l.addAttribute("position",u),je.call(this,l,new F({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function fo(t,e,n,r){Oe.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function mo(t){this.manager=void 0!==t?t:il}function vo(t){"undefined"==typeof createImageBitmap&&console.warn("ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==t?t:il,this.options=void 0}function go(){c.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function yo(t,e,n){this.name="",this.color=new h(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}function bo(t,e){this.name="",this.color=new h(t),this.density=void 0!==e?e:25e-5}function _o(t,e,n,r,i,o,a,s,l){ht.call(this,t,e,n,r,i,o,a,s,l),this.generateMipmaps=!1}n.d(e,"l",function(){return cl}),n.d(e,"d",function(){return sl}),n.d(e,"k",function(){return qc}),n.d(e,"b",function(){return ot}),n.d(e,"c",function(){return gn}),n.d(e,"m",function(){return st}),n.d(e,"f",function(){return ko}),n.d(e,"g",function(){return jo}),n.d(e,"p",function(){return Ft}),n.d(e,"a",function(){return Ue}),n.d(e,"e",function(){return De}),n.d(e,"n",function(){return Le}),n.d(e,"h",function(){return Dt}),n.d(e,"r",function(){return Lt}),n.d(e,"j",function(){return St}),n.d(e,"o",function(){return o}),n.d(e,"s",function(){return m}),n.d(e,"t",function(){return i}),n.d(e,"i",function(){return B}),n.d(e,"u",function(){return Fr}),n.d(e,"q",function(){return ut}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){var e=arguments;if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1;r<arguments.length;r++){var i=e[r];if(void 0!==i&&null!==i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])}return n});var xo={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16).toUpperCase();return function(){var e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&n]+t[n>>8&255]+"-"+t[n>>16&15|64]+t[n>>24&255]+"-"+t[63&r|128]+t[r>>8&255]+"-"+t[r>>16&255]+t[r>>24&255]+t[255&i]+t[i>>8&255]+t[i>>16&255]+t[i>>24&255]}}(),clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*xo.DEG2RAD},radToDeg:function(t){return t*xo.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};Object.assign(r.prototype,{isMatrix4:!0,set:function(t,e,n,r,i,o,a,s,l,u,c,h,p,d,f,m){var v=this.elements;return v[0]=t,v[4]=e,v[8]=n,v[12]=r,v[1]=i,v[5]=o,v[9]=a,v[13]=s,v[2]=l,v[6]=u,v[10]=c,v[14]=h,v[3]=p,v[7]=d,v[11]=f,v[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new r).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(){var t=new i;return function(e){var n=this.elements,r=e.elements,i=1/t.setFromMatrixColumn(e,0).length(),o=1/t.setFromMatrixColumn(e,1).length(),a=1/t.setFromMatrixColumn(e,2).length();return n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[4]=r[4]*o,n[5]=r[5]*o,n[6]=r[6]*o,n[8]=r[8]*a,n[9]=r[9]*a,n[10]=r[10]*a,this}}(),makeRotationFromEuler:function(t){t&&t.isEuler||console.error("Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,r=t.y,i=t.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),l=Math.sin(r),u=Math.cos(i),c=Math.sin(i);if("XYZ"===t.order){var h=o*u,p=o*c,d=a*u,f=a*c;e[0]=s*u,e[4]=-s*c,e[8]=l,e[1]=p+d*l,e[5]=h-f*l,e[9]=-a*s,e[2]=f-h*l,e[6]=d+p*l,e[10]=o*s}else if("YXZ"===t.order){var m=s*c,v=l*u;e[0]=(g=s*u)+(y=l*c)*a,e[4]=v*a-m,e[8]=o*l,e[1]=o*c,e[5]=o*u,e[9]=-a,e[2]=m*a-v,e[6]=y+g*a,e[10]=o*s}else if("ZXY"===t.order){var g,y;m=s*c,v=l*u;e[0]=(g=s*u)-(y=l*c)*a,e[4]=-o*c,e[8]=v+m*a,e[1]=m+v*a,e[5]=o*u,e[9]=y-g*a,e[2]=-o*l,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){h=o*u,p=o*c,d=a*u,f=a*c;e[0]=s*u,e[4]=d*l-p,e[8]=h*l+f,e[1]=s*c,e[5]=f*l+h,e[9]=p*l-d,e[2]=-l,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){var b=o*s,_=o*l,x=a*s,w=a*l;e[0]=s*u,e[4]=w-b*c,e[8]=x*c+_,e[1]=c,e[5]=o*u,e[9]=-a*u,e[2]=-l*u,e[6]=_*c+x,e[10]=b-w*c}else if("XZY"===t.order){b=o*s,_=o*l,x=a*s,w=a*l;e[0]=s*u,e[4]=-c,e[8]=l*u,e[1]=b*c+w,e[5]=o*u,e[9]=_*c-x,e[2]=x*c-_,e[6]=a*u,e[10]=w*c+b}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,n=t._x,r=t._y,i=t._z,o=t._w,a=n+n,s=r+r,l=i+i,u=n*a,c=n*s,h=n*l,p=r*s,d=r*l,f=i*l,m=o*a,v=o*s,g=o*l;return e[0]=1-(p+f),e[4]=c-g,e[8]=h+v,e[1]=c+g,e[5]=1-(u+f),e[9]=d-m,e[2]=h-v,e[6]=d+m,e[10]=1-(u+p),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t=new i,e=new i,n=new i;return function(r,i,o){var a=this.elements;return n.subVectors(r,i),0===n.lengthSq()&&(n.z=1),n.normalize(),t.crossVectors(o,n),0===t.lengthSq()&&(1===Math.abs(o.z)?n.x+=1e-4:n.z+=1e-4,n.normalize(),t.crossVectors(o,n)),t.normalize(),e.crossVectors(n,t),a[0]=t.x,a[4]=e.x,a[8]=n.x,a[1]=t.y,a[5]=e.y,a[9]=n.y,a[2]=t.z,a[6]=e.z,a[10]=n.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[4],s=n[8],l=n[12],u=n[1],c=n[5],h=n[9],p=n[13],d=n[2],f=n[6],m=n[10],v=n[14],g=n[3],y=n[7],b=n[11],_=n[15],x=r[0],w=r[4],S=r[8],A=r[12],M=r[1],T=r[5],C=r[9],E=r[13],P=r[2],O=r[6],N=r[10],L=r[14],I=r[3],D=r[7],F=r[11],R=r[15];return i[0]=o*x+a*M+s*P+l*I,i[4]=o*w+a*T+s*O+l*D,i[8]=o*S+a*C+s*N+l*F,i[12]=o*A+a*E+s*L+l*R,i[1]=u*x+c*M+h*P+p*I,i[5]=u*w+c*T+h*O+p*D,i[9]=u*S+c*C+h*N+p*F,i[13]=u*A+c*E+h*L+p*R,i[2]=d*x+f*M+m*P+v*I,i[6]=d*w+f*T+m*O+v*D,i[10]=d*S+f*C+m*N+v*F,i[14]=d*A+f*E+m*L+v*R,i[3]=g*x+y*M+b*P+_*I,i[7]=g*w+y*T+b*O+_*D,i[11]=g*S+y*C+b*N+_*F,i[15]=g*A+y*E+b*L+_*R,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:function(){var t=new i;return function(e){for(var n=0,r=e.count;n<r;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix4(this),e.setXYZ(n,t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],o=t[1],a=t[5],s=t[9],l=t[13],u=t[2],c=t[6],h=t[10],p=t[14];return t[3]*(+i*s*c-r*l*c-i*a*h+n*l*h+r*a*p-n*s*p)+t[7]*(+e*s*p-e*l*h+i*o*h-r*o*p+r*l*u-i*s*u)+t[11]*(+e*l*c-e*a*p-i*o*c+n*o*p+i*a*u-n*l*u)+t[15]*(-r*a*u-e*s*c+e*a*h+r*o*c-n*o*h+n*s*u)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var n=this.elements,r=t.elements,i=r[0],o=r[1],a=r[2],s=r[3],l=r[4],u=r[5],c=r[6],h=r[7],p=r[8],d=r[9],f=r[10],m=r[11],v=r[12],g=r[13],y=r[14],b=r[15],_=d*y*h-g*f*h+g*c*m-u*y*m-d*c*b+u*f*b,x=v*f*h-p*y*h-v*c*m+l*y*m+p*c*b-l*f*b,w=p*g*h-v*d*h+v*u*m-l*g*m-p*u*b+l*d*b,S=v*d*c-p*g*c-v*u*f+l*g*f+p*u*y-l*d*y,A=i*_+o*x+a*w+s*S;if(0===A){var M="Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(M);return console.warn(M),this.identity()}var T=1/A;return n[0]=_*T,n[1]=(g*f*s-d*y*s-g*a*m+o*y*m+d*a*b-o*f*b)*T,n[2]=(u*y*s-g*c*s+g*a*h-o*y*h-u*a*b+o*c*b)*T,n[3]=(d*c*s-u*f*s-d*a*h+o*f*h+u*a*m-o*c*m)*T,n[4]=x*T,n[5]=(p*y*s-v*f*s+v*a*m-i*y*m-p*a*b+i*f*b)*T,n[6]=(v*c*s-l*y*s-v*a*h+i*y*h+l*a*b-i*c*b)*T,n[7]=(l*f*s-p*c*s+p*a*h-i*f*h-l*a*m+i*c*m)*T,n[8]=w*T,n[9]=(v*d*s-p*g*s-v*o*m+i*g*m+p*o*b-i*d*b)*T,n[10]=(l*g*s-v*u*s+v*o*h-i*g*h-l*o*b+i*u*b)*T,n[11]=(p*u*s-l*d*s-p*o*h+i*d*h+l*o*m-i*u*m)*T,n[12]=S*T,n[13]=(p*g*a-v*d*a+v*o*f-i*g*f-p*o*y+i*d*y)*T,n[14]=(v*u*a-l*g*a-v*o*c+i*g*c+l*o*y-i*u*y)*T,n[15]=(l*d*a-p*u*a+p*o*c-i*d*c-l*o*f+i*u*f)*T,this},scale:function(t){var e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=1-n,o=t.x,a=t.y,s=t.z,l=i*o,u=i*a;return this.set(l*o+n,l*a-r*s,l*s+r*a,0,l*a+r*s,u*a+n,u*s-r*o,0,l*s-r*a,u*s+r*o,i*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){return this.makeRotationFromQuaternion(e),this.scale(n),this.setPosition(t),this},decompose:function(){var t=new i,e=new r;return function(n,r,i){var o=this.elements,a=t.set(o[0],o[1],o[2]).length(),s=t.set(o[4],o[5],o[6]).length(),l=t.set(o[8],o[9],o[10]).length();this.determinant()<0&&(a=-a),n.x=o[12],n.y=o[13],n.z=o[14],e.copy(this);var u=1/a,c=1/s,h=1/l;return e.elements[0]*=u,e.elements[1]*=u,e.elements[2]*=u,e.elements[4]*=c,e.elements[5]*=c,e.elements[6]*=c,e.elements[8]*=h,e.elements[9]*=h,e.elements[10]*=h,r.setFromRotationMatrix(e),i.x=a,i.y=s,i.z=l,this}}(),makePerspective:function(t,e,n,r,i,o){void 0===o&&console.warn("Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(n-r),l=(e+t)/(e-t),u=(n+r)/(n-r),c=-(o+i)/(o-i),h=-2*o*i/(o-i);return a[0]=2*i/(e-t),a[4]=0,a[8]=l,a[12]=0,a[1]=0,a[5]=s,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=c,a[14]=h,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(t,e,n,r,i,o){var a=this.elements,s=1/(e-t),l=1/(n-r),u=1/(o-i),c=(e+t)*s,h=(n+r)*l,p=(o+i)*u;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-p,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}),Object.assign(i.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t=new o;return function(e){return e&&e.isEuler||console.error("Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(t.setFromEuler(e))}}(),applyAxisAngle:function(){var t=new o;return function(e,n){return this.applyQuaternion(t.setFromAxisAngle(e,n))}}(),applyMatrix3:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements,o=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*o,this},applyQuaternion:function(t){var e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,a=t.z,s=t.w,l=s*e+o*r-a*n,u=s*n+a*e-i*r,c=s*r+i*n-o*e,h=-i*e-o*n-a*r;return this.x=l*s+h*-i+u*-a-c*-o,this.y=u*s+h*-o+c*-i-l*-a,this.z=c*s+h*-a+l*-o-u*-i,this},project:function(){var t=new r;return function(e){return t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyMatrix4(t)}}(),unproject:function(){var t=new r;return function(e){return t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyMatrix4(t)}}(),transformDirection:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t=new i,e=new i;return function(n,r){return t.set(n,n,n),e.set(r,r,r),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?(console.warn("Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,r=t.y,i=t.z,o=e.x,a=e.y,s=e.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:function(){var t=new i;return function(e){return t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t=new i;return function(e){return this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(xo.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromCylindrical:function(t){return this.x=t.radius*Math.sin(t.theta),this.y=t.y,this.z=t.radius*Math.cos(t.theta),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}}),Object.assign(o,{slerp:function(t,e,n,r){return n.copy(t).slerp(e,r)},slerpFlat:function(t,e,n,r,i,o,a){var s=n[r+0],l=n[r+1],u=n[r+2],c=n[r+3],h=i[o+0],p=i[o+1],d=i[o+2],f=i[o+3];if(c!==f||s!==h||l!==p||u!==d){var m=1-a,v=s*h+l*p+u*d+c*f,g=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){var b=Math.sqrt(y),_=Math.atan2(b,v*g);m=Math.sin(m*_)/b,a=Math.sin(a*_)/b}var x=a*g;if(s=s*m+h*x,l=l*m+p*x,u=u*m+d*x,c=c*m+f*x,m===1-a){var w=1/Math.sqrt(s*s+l*l+u*u+c*c);s*=w,l*=w,u*=w,c*=w}}t[e]=s,t[e+1]=l,t[e+2]=u,t[e+3]=c}}),Object.defineProperties(o.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback()}}}),Object.assign(o.prototype,{set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,r=t._y,i=t._z,o=t.order,a=Math.cos,s=Math.sin,l=a(n/2),u=a(r/2),c=a(i/2),h=s(n/2),p=s(r/2),d=s(i/2);return"XYZ"===o?(this._x=h*u*c+l*p*d,this._y=l*p*c-h*u*d,this._z=l*u*d+h*p*c,this._w=l*u*c-h*p*d):"YXZ"===o?(this._x=h*u*c+l*p*d,this._y=l*p*c-h*u*d,this._z=l*u*d-h*p*c,this._w=l*u*c+h*p*d):"ZXY"===o?(this._x=h*u*c-l*p*d,this._y=l*p*c+h*u*d,this._z=l*u*d+h*p*c,this._w=l*u*c-h*p*d):"ZYX"===o?(this._x=h*u*c-l*p*d,this._y=l*p*c+h*u*d,this._z=l*u*d-h*p*c,this._w=l*u*c+h*p*d):"YZX"===o?(this._x=h*u*c+l*p*d,this._y=l*p*c+h*u*d,this._z=l*u*d-h*p*c,this._w=l*u*c-h*p*d):"XZY"===o&&(this._x=h*u*c-l*p*d,this._y=l*p*c-h*u*d,this._z=l*u*d+h*p*c,this._w=l*u*c+h*p*d),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,r=n[0],i=n[4],o=n[8],a=n[1],s=n[5],l=n[9],u=n[2],c=n[6],h=n[10],p=r+s+h;return p>0?(e=.5/Math.sqrt(p+1),this._w=.25/e,this._x=(c-l)*e,this._y=(o-u)*e,this._z=(a-i)*e):r>s&&r>h?(e=2*Math.sqrt(1+r-s-h),this._w=(c-l)/e,this._x=.25*e,this._y=(i+a)/e,this._z=(o+u)/e):s>h?(e=2*Math.sqrt(1+s-r-h),this._w=(o-u)/e,this._x=(i+a)/e,this._y=.25*e,this._z=(l+c)/e):(e=2*Math.sqrt(1+h-r-s),this._w=(a-i)/e,this._x=(o+u)/e,this._y=(l+c)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e=new i;return function(n,r){return void 0===e&&(e=new i),(t=n.dot(r)+1)<1e-6?(t=0,Math.abs(n.x)>Math.abs(n.z)?e.set(-n.y,n.x,0):e.set(0,-n.z,n.y)):e.crossVectors(n,r),this._x=e.x,this._y=e.y,this._z=e.z,this._w=t,this.normalize()}}(),inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(this._x=this._x*(t=1/t),this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,r=t._y,i=t._z,o=t._w,a=e._x,s=e._y,l=e._z,u=e._w;return this._x=n*u+o*a+r*l-i*s,this._y=r*u+o*s+i*a-n*l,this._z=i*u+o*l+n*s-r*a,this._w=o*u-n*a-r*s-i*l,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,r=this._y,i=this._z,o=this._w,a=o*t._w+n*t._x+r*t._y+i*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;var s=Math.sqrt(1-a*a);if(Math.abs(s)<.001)return this._w=.5*(o+this._w),this._x=.5*(n+this._x),this._y=.5*(r+this._y),this._z=.5*(i+this._z),this;var l=Math.atan2(s,a),u=Math.sin((1-e)*l)/s,c=Math.sin(e*l)/s;return this._w=o*u+this._w*c,this._x=n*u+this._x*c,this._y=r*u+this._y*c,this._z=i*u+this._z*c,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(a.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,t)}}}}),s.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],s.DefaultOrder="XYZ",Object.defineProperties(s.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback()}}}),Object.assign(s.prototype,{isEuler:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var r=xo.clamp,i=t.elements,o=i[0],a=i[4],s=i[8],l=i[1],u=i[5],c=i[9],h=i[2],p=i[6],d=i[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(p,u),this._z=0)):"YXZ"===e?(this._x=Math.asin(-r(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(s,d),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,o),this._z=0)):"ZXY"===e?(this._x=Math.asin(r(p,-1,1)),Math.abs(p)<.99999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(l,o))):"ZYX"===e?(this._y=Math.asin(-r(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(p,d),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,u))):"YZX"===e?(this._z=Math.asin(r(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(s,d))):"XZY"===e?(this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(p,u),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-c,d),this._y=0)):console.warn("Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:function(){var t=new r;return function(e,n,r){return t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,n,r)}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new o;return function(e){return t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new i(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(l.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},test:function(t){return 0!=(this.mask&t.mask)}}),Object.assign(u.prototype,{isMatrix3:!0,set:function(t,e,n,r,i,o,a,s,l){var u=this.elements;return u[0]=t,u[1]=r,u[2]=a,u[3]=e,u[4]=i,u[5]=s,u[6]=n,u[7]=o,u[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToBufferAttribute:function(){var t=new i;return function(e){for(var n=0,r=e.count;n<r;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix3(this),e.setXYZ(n,t.x,t.y,t.z);return e}}(),multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[3],s=n[6],l=n[1],u=n[4],c=n[7],h=n[2],p=n[5],d=n[8],f=r[0],m=r[3],v=r[6],g=r[1],y=r[4],b=r[7],_=r[2],x=r[5],w=r[8];return i[0]=o*f+a*g+s*_,i[3]=o*m+a*y+s*x,i[6]=o*v+a*b+s*w,i[1]=l*f+u*g+c*_,i[4]=l*m+u*y+c*x,i[7]=l*v+u*b+c*w,i[2]=h*f+p*g+d*_,i[5]=h*m+p*y+d*x,i[8]=h*v+p*b+d*w,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],l=t[7],u=t[8];return e*o*u-e*a*l-n*i*u+n*a*s+r*i*l-r*o*s},getInverse:function(t,e){t&&t.isMatrix4&&console.error("Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=t.elements,r=this.elements,i=n[0],o=n[1],a=n[2],s=n[3],l=n[4],u=n[5],c=n[6],h=n[7],p=n[8],d=p*l-u*h,f=u*c-p*s,m=h*s-l*c,v=i*d+o*f+a*m;if(0===v){var g="Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(g);return console.warn(g),this.identity()}var y=1/v;return r[0]=d*y,r[1]=(a*h-p*o)*y,r[2]=(u*o-a*l)*y,r[3]=f*y,r[4]=(p*i-a*c)*y,r[5]=(a*s-u*i)*y,r[6]=m*y,r[7]=(o*c-h*i)*y,r[8]=(l*i-o*s)*y,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,r,i,o,a){var s=Math.cos(i),l=Math.sin(i);this.set(n*s,n*l,-n*(s*o+l*a)+o+t,-r*l,r*s,-r*(-l*o+s*a)+a+e,0,0,1)},scale:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],o=r[3],a=r[6],s=r[1],l=r[4],u=r[7];return r[0]=e*i+n*s,r[3]=e*o+n*l,r[6]=e*a+n*u,r[1]=-n*i+e*s,r[4]=-n*o+e*l,r[7]=-n*a+e*u,this},translate:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}});var wo=0;c.DefaultUp=new i(0,1,0),c.DefaultMatrixAutoUpdate=!0,c.prototype=Object.assign(Object.create(a.prototype),{constructor:c,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new o;return function(e,n){return t.setFromAxisAngle(e,n),this.quaternion.multiply(t),this}}(),rotateOnWorldAxis:function(){var t=new o;return function(e,n){return t.setFromAxisAngle(e,n),this.quaternion.premultiply(t),this}}(),rotateX:function(){var t=new i(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new i(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new i(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new i;return function(e,n){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(n)),this}}(),translateX:function(){var t=new i(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new i(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new i(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new r;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new r,e=new i;return function(n,r,i){n.isVector3?e.copy(n):e.set(n,r,i),this.isCamera?t.lookAt(this.position,e,this.up):t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){var e=arguments;if(arguments.length>1){for(var n=0;n<arguments.length;n++)this.add(e[n]);return this}return t===this?(console.error("Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("Object3D.add: object not an instance of Object3D.",t),this)},remove:function(t){var e=arguments;if(arguments.length>1){for(var n=0;n<arguments.length;n++)this.remove(e[n]);return this}var r=this.children.indexOf(t);return-1!==r&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(r,1)),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return void 0===t&&(console.warn("Object3D: .getWorldPosition() target is now required"),t=new i),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new i,e=new i;return function(n){return void 0===n&&(console.warn("Object3D: .getWorldQuaternion() target is now required"),n=new o),this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,n,e),n}}(),getWorldScale:function(){var t=new i,e=new o;return function(n){return void 0===n&&(console.warn("Object3D: .getWorldScale() target is now required"),n=new i),this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,n),n}}(),getWorldDirection:function(){var t=new o;return function(e){return void 0===e&&(console.warn("Object3D: .getWorldDirection() target is now required"),e=new i),this.getWorldQuaternion(t),e.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)},toJSON:function(t){function e(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}function n(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}var r=void 0===t||"string"==typeof t,i={};r&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var o={};if(o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),!0===this.castShadow&&(o.castShadow=!0),!0===this.receiveShadow&&(o.receiveShadow=!0),!1===this.visible&&(o.visible=!1),!1===this.frustumCulled&&(o.frustumCulled=!1),0!==this.renderOrder&&(o.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(o.userData=this.userData),o.matrix=this.matrix.toArray(),void 0!==this.geometry){o.geometry=e(t.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var s=a.shapes;if(Array.isArray(s))for(var l=0,u=s.length;l<u;l++){e(t.shapes,s[l])}else e(t.shapes,s)}}if(void 0!==this.material)if(Array.isArray(this.material)){var c=[];for(l=0,u=this.material.length;l<u;l++)c.push(e(t.materials,this.material[l]));o.material=c}else o.material=e(t.materials,this.material);if(this.children.length>0){o.children=[];for(l=0;l<this.children.length;l++)o.children.push(this.children[l].toJSON(t).object)}if(r){var h=n(t.geometries),p=n(t.materials),d=n(t.textures),f=n(t.images);s=n(t.shapes);h.length>0&&(i.geometries=h),p.length>0&&(i.materials=p),d.length>0&&(i.textures=d),f.length>0&&(i.images=f),s.length>0&&(i.shapes=s)}return i.object=o,i},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){this.add(t.children[n].clone())}return this}});var So={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object.assign(h.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(){function t(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}return function(e,n,r){if(e=xo.euclideanModulo(e,1),n=xo.clamp(n,0,1),r=xo.clamp(r,0,1),0===n)this.r=this.g=this.b=r;else{var i=r<=.5?r*(1+n):r+n-r*n,o=2*r-i;this.r=t(o,i,e+1/3),this.g=t(o,i,e),this.b=t(o,i,e-1/3)}return this}}(),setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var r,i=n[2];switch(n[1]){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i)){var o=parseFloat(r[1])/360,a=parseInt(r[2],10)/100,s=parseInt(r[3],10)/100;return e(r[5]),this.setHSL(o,a,s)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var l=(u=n[1]).length;if(3===l)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}if(t&&t.length>0){var u;void 0!==(u=So[t])?this.setHex(u):console.warn("Color: Unknown color "+t)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(){var t=this.r,e=this.g,n=this.b;return this.r=t*t,this.g=e*e,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e,n,r=this.r,i=this.g,o=this.b,a=Math.max(r,i,o),s=Math.min(r,i,o),l=(s+a)/2;if(s===a)e=0,n=0;else{var u=a-s;switch(n=l<=.5?u/(a+s):u/(2-a-s),a){case r:e=(i-o)/u+(i<o?6:0);break;case i:e=(o-r)/u+2;break;case o:e=(r-i)/u+4}e/=6}return t.h=e,t.s=n,t.l=l,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(){var t={};return function(e,n,r){return this.getHSL(t),t.h+=e,t.s+=n,t.l+=r,this.setHSL(t.h,t.s,t.l),this}}(),add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}}),Object.assign(p.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}}),Object.assign(d.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,l=t.length;s<l;s+=3){var u=t[s],c=t[s+1],h=t[s+2];u<e&&(e=u),c<n&&(n=c),h<r&&(r=h),u>i&&(i=u),c>o&&(o=c),h>a&&(a=h)}return this.min.set(e,n,r),this.max.set(i,o,a),this},setFromBufferAttribute:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,l=t.count;s<l;s++){var u=t.getX(s),c=t.getY(s),h=t.getZ(s);u<e&&(e=u),c<n&&(n=c),h<r&&(r=h),u>i&&(i=u),c>o&&(o=c),h>a&&(a=h)}return this.min.set(e,n,r),this.max.set(i,o,a),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new i;return function(e,n){var r=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}}(),setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("Box3: .getCenter() target is now required"),t=new i),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("Box3: .getSize() target is now required"),t=new i),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(){function t(t){var i=t.geometry;if(void 0!==i)if(i.isGeometry){var a=i.vertices;for(n=0,r=a.length;n<r;n++)o.copy(a[n]),o.applyMatrix4(t.matrixWorld),e.expandByPoint(o)}else if(i.isBufferGeometry){var s=i.attributes.position;if(void 0!==s)for(n=0,r=s.count;n<r;n++)o.fromBufferAttribute(s,n).applyMatrix4(t.matrixWorld),e.expandByPoint(o)}}var e,n,r,o=new i;return function(n){return e=this,n.updateMatrixWorld(!0),n.traverse(t),this}}(),containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(console.warn("Box3: .getParameter() target is now required"),e=new i),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(){var t=new i;return function(e){return this.clampPoint(e.center,t),t.distanceToSquared(e.center)<=e.radius*e.radius}}(),intersectsPlane:function(t){var e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=t.constant&&n>=t.constant},intersectsTriangle:function(){function t(t){var i,o;for(i=0,o=t.length-3;i<=o;i+=3){l.fromArray(t,i);var a=c.x*Math.abs(l.x)+c.y*Math.abs(l.y)+c.z*Math.abs(l.z),s=e.dot(l),u=n.dot(l),h=r.dot(l);if(Math.max(-Math.max(s,u,h),Math.min(s,u,h))>a)return!1}return!0}var e=new i,n=new i,r=new i,o=new i,a=new i,s=new i,l=new i,u=new i,c=new i,h=new i;return function(i){if(this.isEmpty())return!1;this.getCenter(u),c.subVectors(this.max,u),e.subVectors(i.a,u),n.subVectors(i.b,u),r.subVectors(i.c,u),o.subVectors(n,e),a.subVectors(r,n),s.subVectors(e,r);var l=[0,-o.z,o.y,0,-a.z,a.y,0,-s.z,s.y,o.z,0,-o.x,a.z,0,-a.x,s.z,0,-s.x,-o.y,o.x,0,-a.y,a.x,0,-s.y,s.x,0];return!!t(l)&&(l=[1,0,0,0,1,0,0,0,1],!!t(l)&&(h.crossVectors(o,a),l=[h.x,h.y,h.z],t(l)))}}(),clampPoint:function(t,e){return void 0===e&&(console.warn("Box3: .clampPoint() target is now required"),e=new i),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new i;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),getBoundingSphere:function(){var t=new i;return function(e){return void 0===e&&(console.warn("Box3: .getBoundingSphere() target is now required"),e=new f),this.getCenter(e.center),e.radius=.5*this.getSize(t).length(),e}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new i,new i,new i,new i,new i,new i,new i,new i];return function(e){return this.isEmpty()?this:(t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(t),this)}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.assign(f.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new d;return function(e,n){var r=this.center;void 0!==n?r.copy(n):t.setFromPoints(e).getCenter(r);for(var i=0,o=0,a=e.length;o<a;o++)i=Math.max(i,r.distanceToSquared(e[o]));return this.radius=Math.sqrt(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t);return void 0===e&&(console.warn("Sphere: .clampPoint() target is now required"),e=new i),e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(console.warn("Sphere: .getBoundingBox() target is now required"),t=new d),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}),Object.defineProperties(m.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(m.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(){var t=new m,e=new m;return function(n,r){return t.set(n,n),e.set(r,r),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,o=this.y-t.y;return this.x=i*n-o*r+t.x,this.y=i*r+o*n+t.y,this}});var Ao=0;v.prototype=Object.assign(Object.create(a.prototype),{constructor:v,isGeometry:!0,applyMatrix:function(t){for(var e=(new u).getNormalMatrix(t),n=0,r=this.vertices.length;n<r;n++){this.vertices[n].applyMatrix4(t)}for(n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(e).normalize();for(var o=0,a=i.vertexNormals.length;o<a;o++)i.vertexNormals[o].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var t=new r;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new r;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new r;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new r;return function(e,n,r){return t.makeTranslation(e,n,r),this.applyMatrix(t),this}}(),scale:function(){var t=new r;return function(e,n,r){return t.makeScale(e,n,r),this.applyMatrix(t),this}}(),lookAt:function(){var t=new c;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){function e(t,e,r,i){var o=new p(t,e,r,void 0!==s?[d[t].clone(),d[e].clone(),d[r].clone()]:[],void 0!==l?[n.colors[t].clone(),n.colors[e].clone(),n.colors[r].clone()]:[],i);n.faces.push(o),void 0!==u&&n.faceVertexUvs[0].push([f[t].clone(),f[e].clone(),f[r].clone()]),void 0!==c&&n.faceVertexUvs[1].push([v[t].clone(),v[e].clone(),v[r].clone()])}var n=this,r=null!==t.index?t.index.array:void 0,o=t.attributes,a=o.position.array,s=void 0!==o.normal?o.normal.array:void 0,l=void 0!==o.color?o.color.array:void 0,u=void 0!==o.uv?o.uv.array:void 0,c=void 0!==o.uv2?o.uv2.array:void 0;void 0!==c&&(this.faceVertexUvs[1]=[]);for(var d=[],f=[],v=[],g=0,y=0;g<a.length;g+=3,y+=2)n.vertices.push(new i(a[g],a[g+1],a[g+2])),void 0!==s&&d.push(new i(s[g],s[g+1],s[g+2])),void 0!==l&&n.colors.push(new h(l[g],l[g+1],l[g+2])),void 0!==u&&f.push(new m(u[y],u[y+1])),void 0!==c&&v.push(new m(c[y],c[y+1]));var b=t.groups;if(b.length>0)for(g=0;g<b.length;g++)for(var _=b[g],x=_.start,w=(y=x,x+_.count);y<w;y+=3)void 0!==r?e(r[y],r[y+1],r[y+2],_.materialIndex):e(y,y+1,y+2,_.materialIndex);else if(void 0!==r)for(g=0;g<r.length;g+=3)e(r[g],r[g+1],r[g+2]);else for(g=0;g<a.length/3;g+=3)e(g,g+1,g+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){var t=new i;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(t).negate(),this.translate(t.x,t.y,t.z),this}}(),normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,n=0===e?1:1/e,i=new r;return i.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix(i),this},computeFaceNormals:function(){for(var t=new i,e=new i,n=0,r=this.faces.length;n<r;n++){var o=this.faces[n],a=this.vertices[o.a],s=this.vertices[o.b];t.subVectors(this.vertices[o.c],s),e.subVectors(a,s),t.cross(e),t.normalize(),o.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);var e,n,r,o,a,s;for(s=new Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)s[e]=new i;if(t){var l,u,c=new i,h=new i;for(r=0,o=this.faces.length;r<o;r++)l=this.vertices[(a=this.faces[r]).a],c.subVectors(this.vertices[a.c],u=this.vertices[a.b]),h.subVectors(l,u),c.cross(h),s[a.a].add(c),s[a.b].add(c),s[a.c].add(c)}else for(this.computeFaceNormals(),r=0,o=this.faces.length;r<o;r++)s[(a=this.faces[r]).a].add(a.normal),s[a.b].add(a.normal),s[a.c].add(a.normal);for(e=0,n=this.vertices.length;e<n;e++)s[e].normalize();for(r=0,o=this.faces.length;r<o;r++){var p=(a=this.faces[r]).vertexNormals;3===p.length?(p[0].copy(s[a.a]),p[1].copy(s[a.b]),p[2].copy(s[a.c])):(p[0]=s[a.a].clone(),p[1]=s[a.b].clone(),p[2]=s[a.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,n;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){var r=(n=this.faces[t]).vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n,r,o;for(n=0,r=this.faces.length;n<r;n++)for((o=this.faces[n]).__originalFaceNormal?o.__originalFaceNormal.copy(o.normal):o.__originalFaceNormal=o.normal.clone(),o.__originalVertexNormals||(o.__originalVertexNormals=[]),t=0,e=o.vertexNormals.length;t<e;t++)o.__originalVertexNormals[t]?o.__originalVertexNormals[t].copy(o.vertexNormals[t]):o.__originalVertexNormals[t]=o.vertexNormals[t].clone();var a=new v;for(a.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var s=this.morphNormals[t].faceNormals,l=this.morphNormals[t].vertexNormals;for(n=0,r=this.faces.length;n<r;n++)c=new i,h={a:new i,b:new i,c:new i},s.push(c),l.push(h)}var u=this.morphNormals[t];a.vertices=this.morphTargets[t].vertices,a.computeFaceNormals(),a.computeVertexNormals();var c,h;for(n=0,r=this.faces.length;n<r;n++)h=u.vertexNormals[n],(c=u.faceNormals[n]).copy((o=this.faces[n]).normal),h.a.copy(o.vertexNormals[0]),h.b.copy(o.vertexNormals[1]),h.c.copy(o.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)(o=this.faces[n]).normal=o.__originalFaceNormal,o.vertexNormals=o.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new d),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new f),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(t&&t.isGeometry){var r,i=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,l=t.faces,c=this.faceVertexUvs[0],h=t.faceVertexUvs[0],d=this.colors,f=t.colors;void 0===n&&(n=0),void 0!==e&&(r=(new u).getNormalMatrix(e));for(var m=0,v=a.length;m<v;m++){var g=a[m].clone();void 0!==e&&g.applyMatrix4(e),o.push(g)}for(m=0,v=f.length;m<v;m++)d.push(f[m].clone());for(m=0,v=l.length;m<v;m++){var y,b,_=l[m],x=_.vertexNormals,w=_.vertexColors;(y=new p(_.a+i,_.b+i,_.c+i)).normal.copy(_.normal),void 0!==r&&y.normal.applyMatrix3(r).normalize();for(var S=0,A=x.length;S<A;S++)b=x[S].clone(),void 0!==r&&b.applyMatrix3(r).normalize(),y.vertexNormals.push(b);y.color.copy(_.color);for(S=0,A=w.length;S<A;S++)y.vertexColors.push(w[S].clone());y.materialIndex=_.materialIndex+n,s.push(y)}for(m=0,v=h.length;m<v;m++){var M=h[m],T=[];if(void 0!==M){for(S=0,A=M.length;S<A;S++)T.push(M[S].clone());c.push(T)}}}else console.error("Geometry.merge(): geometry not an instance of Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("Geometry.mergeMesh(): mesh not an instance of Mesh.",t)},mergeVertices:function(){var t,e,n,r,i,o,a,s,l={},u=[],c=[],h=Math.pow(10,4);for(n=0,r=this.vertices.length;n<r;n++)t=this.vertices[n],void 0===l[e=Math.round(t.x*h)+"_"+Math.round(t.y*h)+"_"+Math.round(t.z*h)]?(l[e]=n,u.push(this.vertices[n]),c[n]=u.length-1):c[n]=c[l[e]];var p=[];for(n=0,r=this.faces.length;n<r;n++){(i=this.faces[n]).a=c[i.a],i.b=c[i.b],i.c=c[i.c],o=[i.a,i.b,i.c];for(var d=0;d<3;d++)if(o[d]===o[(d+1)%3]){p.push(n);break}}for(n=p.length-1;n>=0;n--){var f=p[n];for(this.faces.splice(f,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(f,1)}var m=this.vertices.length-u.length;return this.vertices=u,m},setFromPoints:function(t){this.vertices=[];for(var e=0,n=t.length;e<n;e++){var r=t[e];this.vertices.push(new i(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,n=0;n<e;n++)t[n]._id=n;t.sort(function(t,e){return t.materialIndex-e.materialIndex});var r,i,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];o&&o.length===e&&(r=[]),a&&a.length===e&&(i=[]);for(n=0;n<e;n++){var s=t[n]._id;r&&r.push(o[s]),i&&i.push(a[s])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){function t(t,e,n){return n?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==p[e]?p[e]:(p[e]=h.length/3,h.push(t.x,t.y,t.z),p[e])}function n(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==f[e]?f[e]:(f[e]=d.length,d.push(t.getHex()),f[e])}function r(t){var e=t.x.toString()+t.y.toString();return void 0!==v[e]?v[e]:(v[e]=m.length/2,m.push(t.x,t.y),v[e])}var i={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),void 0!==this.parameters){var o=this.parameters;for(var a in o)void 0!==o[a]&&(i[a]=o[a]);return i}for(var s=[],l=0;l<this.vertices.length;l++){var u=this.vertices[l];s.push(u.x,u.y,u.z)}var c=[],h=[],p={},d=[],f={},m=[],v={};for(l=0;l<this.faces.length;l++){var g=this.faces[l],y=void 0!==this.faceVertexUvs[0][l],b=g.normal.length()>0,_=g.vertexNormals.length>0,x=1!==g.color.r||1!==g.color.g||1!==g.color.b,w=g.vertexColors.length>0,S=0;if(S=t(S,0,0),S=t(S,1,!0),S=t(S,2,!1),S=t(S,3,y),S=t(S,4,b),S=t(S,5,_),S=t(S,6,x),S=t(S,7,w),c.push(S),c.push(g.a,g.b,g.c),c.push(g.materialIndex),y){var A=this.faceVertexUvs[0][l];c.push(r(A[0]),r(A[1]),r(A[2]))}if(b&&c.push(e(g.normal)),_){var M=g.vertexNormals;c.push(e(M[0]),e(M[1]),e(M[2]))}if(x&&c.push(n(g.color)),w){var T=g.vertexColors;c.push(n(T[0]),n(T[1]),n(T[2]))}}return i.data={},i.data.vertices=s,i.data.normals=h,d.length>0&&(i.data.colors=d),m.length>0&&(i.data.uvs=[m]),i.data.faces=c,i},clone:function(){return(new v).copy(this)},copy:function(t){var e,n,r,i,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var s=t.vertices;for(e=0,n=s.length;e<n;e++)this.vertices.push(s[e].clone());var l=t.colors;for(e=0,n=l.length;e<n;e++)this.colors.push(l[e].clone());var u=t.faces;for(e=0,n=u.length;e<n;e++)this.faces.push(u[e].clone());for(e=0,n=t.faceVertexUvs.length;e<n;e++){var c=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),r=0,i=c.length;r<i;r++){var h=c[r],p=[];for(o=0,a=h.length;o<a;o++){p.push(h[o].clone())}this.faceVertexUvs[e].push(p)}}var d=t.morphTargets;for(e=0,n=d.length;e<n;e++){var f={};if(f.name=d[e].name,void 0!==d[e].vertices)for(f.vertices=[],r=0,i=d[e].vertices.length;r<i;r++)f.vertices.push(d[e].vertices[r].clone());if(void 0!==d[e].normals)for(f.normals=[],r=0,i=d[e].normals.length;r<i;r++)f.normals.push(d[e].normals[r].clone());this.morphTargets.push(f)}var m=t.morphNormals;for(e=0,n=m.length;e<n;e++){var v={};if(void 0!==m[e].vertexNormals)for(v.vertexNormals=[],r=0,i=m[e].vertexNormals.length;r<i;r++){var g=m[e].vertexNormals[r],y={};y.a=g.a.clone(),y.b=g.b.clone(),y.c=g.c.clone(),v.vertexNormals.push(y)}if(void 0!==m[e].faceNormals)for(v.faceNormals=[],r=0,i=m[e].faceNormals.length;r<i;r++)v.faceNormals.push(m[e].faceNormals[r].clone());this.morphNormals.push(v)}var b=t.skinWeights;for(e=0,n=b.length;e<n;e++)this.skinWeights.push(b[e].clone());var _=t.skinIndices;for(e=0,n=_.length;e<n;e++)this.skinIndices.push(_[e].clone());var x=t.lineDistances;for(e=0,n=x.length;e<n;e++)this.lineDistances.push(x[e]);var w=t.boundingBox;null!==w&&(this.boundingBox=w.clone());var S=t.boundingSphere;return null!==S&&(this.boundingSphere=S.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.assign(g.prototype,{isVector4:!0,set:function(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*e+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*e+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*e+o[7]*n+o[11]*r+o[15]*i,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,r,i,o=t.elements,a=o[0],s=o[4],l=o[8],u=o[1],c=o[5],h=o[9],p=o[2],d=o[6],f=o[10];if(Math.abs(s-u)<.01&&Math.abs(l-p)<.01&&Math.abs(h-d)<.01){if(Math.abs(s+u)<.1&&Math.abs(l+p)<.1&&Math.abs(h+d)<.1&&Math.abs(a+c+f-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var m=(a+1)/2,v=(c+1)/2,g=(f+1)/2,y=(s+u)/4,b=(l+p)/4,_=(h+d)/4;return m>v&&m>g?m<.01?(n=0,r=.707106781,i=.707106781):(r=y/(n=Math.sqrt(m)),i=b/n):v>g?v<.01?(n=.707106781,r=0,i=.707106781):(n=y/(r=Math.sqrt(v)),i=_/r):g<.01?(n=.707106781,r=.707106781,i=0):(n=b/(i=Math.sqrt(g)),r=_/i),this.set(n,r,i,e),this}var x=Math.sqrt((d-h)*(d-h)+(l-p)*(l-p)+(u-s)*(u-s));return Math.abs(x)<.001&&(x=1),this.x=(d-h)/x,this.y=(l-p)/x,this.z=(u-s)/x,this.w=Math.acos((a+c+f-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t,e;return function(n,r){return void 0===t&&(t=new g,e=new g),t.set(n,n,n,n),e.set(r,r,r,r),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),Object.defineProperty(y.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(y.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(t){if(Array.isArray(t))throw new TypeError("BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.itemSize:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("BufferAttribute.copyColorsArray(): color is undefined",r),o=new h),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new m),e[n++]=o.x,e[n++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,r=0,o=t.length;r<o;r++){var a=t[r];void 0===a&&(console.warn("BufferAttribute.copyVector3sArray(): vector is undefined",r),a=new i),e[n++]=a.x,e[n++]=a.y,e[n++]=a.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new g),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z,e[n++]=o.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),(b.prototype=Object.create(y.prototype)).constructor=b,(_.prototype=Object.create(y.prototype)).constructor=_,(x.prototype=Object.create(y.prototype)).constructor=x,(w.prototype=Object.create(y.prototype)).constructor=w,(S.prototype=Object.create(y.prototype)).constructor=S,(A.prototype=Object.create(y.prototype)).constructor=A,(M.prototype=Object.create(y.prototype)).constructor=M,(T.prototype=Object.create(y.prototype)).constructor=T,(C.prototype=Object.create(y.prototype)).constructor=C,Object.assign(E.prototype,{computeGroups:function(t){for(var e,n=[],r=void 0,i=t.faces,o=0;o<i.length;o++){var a=i[o];a.materialIndex!==r&&(r=a.materialIndex,void 0!==e&&(e.count=3*o-e.start,n.push(e)),e={start:3*o,materialIndex:r})}void 0!==e&&(e.count=3*o-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e,n=t.faces,r=t.vertices,i=t.faceVertexUvs,o=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,s=t.morphTargets,l=s.length;if(l>0){e=[];for(var u=0;u<l;u++)e[u]=[];this.morphTargets.position=e}var c,h=t.morphNormals,p=h.length;if(p>0){c=[];for(u=0;u<p;u++)c[u]=[];this.morphTargets.normal=c}var d=t.skinIndices,f=t.skinWeights,v=d.length===r.length,g=f.length===r.length;for(u=0;u<n.length;u++){var y=n[u];this.vertices.push(r[y.a],r[y.b],r[y.c]);var b=y.vertexNormals;if(3===b.length)this.normals.push(b[0],b[1],b[2]);else{var _=y.normal;this.normals.push(_,_,_)}var x=y.vertexColors;if(3===x.length)this.colors.push(x[0],x[1],x[2]);else{var w=y.color;this.colors.push(w,w,w)}if(!0===o){void 0!==(S=i[0][u])?this.uvs.push(S[0],S[1],S[2]):(console.warn("DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new m,new m,new m))}if(!0===a){var S;void 0!==(S=i[1][u])?this.uvs2.push(S[0],S[1],S[2]):(console.warn("DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new m,new m,new m))}for(var A=0;A<l;A++){var M=s[A].vertices;e[A].push(M[y.a],M[y.b],M[y.c])}for(A=0;A<p;A++){var T=h[A].vertexNormals[u];c[A].push(T.a,T.b,T.c)}v&&this.skinIndices.push(d[y.a],d[y.b],d[y.c]),g&&this.skinWeights.push(f[y.a],f[y.b],f[y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}});var Mo=1;O.prototype=Object.assign(Object.create(a.prototype),{constructor:O,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){this.index=Array.isArray(t)?new(P(t)>65535?M:S)(t,1):t},addAttribute:function(t,e){return e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(e)):(this.attributes[t]=e,this):(console.warn("BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(t,new y(arguments[1],arguments[2])))},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToBufferAttribute(e),e.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){(new u).getNormalMatrix(t).applyToBufferAttribute(n),n.needsUpdate=!0}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t=new r;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new r;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new r;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new r;return function(e,n,r){return t.makeTranslation(e,n,r),this.applyMatrix(t),this}}(),scale:function(){var t=new r;return function(e,n,r){return t.makeScale(e,n,r),this.applyMatrix(t),this}}(),lookAt:function(){var t=new c;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){var t=new i;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(t).negate(),this.translate(t.x,t.y,t.z),this}}(),setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var n=new T(3*e.vertices.length,3),r=new T(3*e.colors.length,3);if(this.addAttribute("position",n.copyVector3sArray(e.vertices)),this.addAttribute("color",r.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var i=new T(e.lineDistances.length,1);this.addAttribute("lineDistance",i.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];e.push(i.x,i.y,i.z||0)}return this.addAttribute("position",new T(e,3)),this},updateFromObject:function(t){var e=t.geometry;if(t.isMesh){var n=e.__directGeometry;if(!0===e.elementsNeedUpdate&&(n=void 0,e.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(e);n.verticesNeedUpdate=e.verticesNeedUpdate,n.normalsNeedUpdate=e.normalsNeedUpdate,n.colorsNeedUpdate=e.colorsNeedUpdate,n.uvsNeedUpdate=e.uvsNeedUpdate,n.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=n}var r;return!0===e.verticesNeedUpdate&&(void 0!==(r=this.attributes.position)&&(r.copyVector3sArray(e.vertices),r.needsUpdate=!0),e.verticesNeedUpdate=!1),!0===e.normalsNeedUpdate&&(void 0!==(r=this.attributes.normal)&&(r.copyVector3sArray(e.normals),r.needsUpdate=!0),e.normalsNeedUpdate=!1),!0===e.colorsNeedUpdate&&(void 0!==(r=this.attributes.color)&&(r.copyColorsArray(e.colors),r.needsUpdate=!0),e.colorsNeedUpdate=!1),e.uvsNeedUpdate&&(void 0!==(r=this.attributes.uv)&&(r.copyVector2sArray(e.uvs),r.needsUpdate=!0),e.uvsNeedUpdate=!1),e.lineDistancesNeedUpdate&&(void 0!==(r=this.attributes.lineDistance)&&(r.copyArray(e.lineDistances),r.needsUpdate=!0),e.lineDistancesNeedUpdate=!1),e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new E).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new y(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var n=new Float32Array(3*t.normals.length);this.addAttribute("normal",new y(n,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var r=new Float32Array(3*t.colors.length);this.addAttribute("color",new y(r,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var i=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new y(i,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var o=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new y(o,2).copyVector2sArray(t.uvs2))}this.groups=t.groups;for(var a in t.morphTargets){for(var s=[],l=t.morphTargets[a],u=0,c=l.length;u<c;u++){var h=l[u],p=new T(3*h.length,3);s.push(p.copyVector3sArray(h))}this.morphAttributes[a]=s}if(t.skinIndices.length>0){var d=new T(4*t.skinIndices.length,4);this.addAttribute("skinIndex",d.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var f=new T(4*t.skinWeights.length,4);this.addAttribute("skinWeight",f.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new d);var t=this.attributes.position;void 0!==t?this.boundingBox.setFromBufferAttribute(t):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var t=new d,e=new i;return function(){null===this.boundingSphere&&(this.boundingSphere=new f);var n=this.attributes.position;if(n){var r=this.boundingSphere.center;t.setFromBufferAttribute(n),t.getCenter(r);for(var i=0,o=0,a=n.count;o<a;o++)e.x=n.getX(o),e.y=n.getY(o),e.z=n.getZ(o),i=Math.max(i,r.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,n=this.groups;if(e.position){var r=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new y(new Float32Array(r.length),3));else for(var o=e.normal.array,a=0,s=o.length;a<s;a++)o[a]=0;var l,u,c,h=e.normal.array,p=new i,d=new i,f=new i,m=new i,v=new i;if(t){var g=t.array;0===n.length&&this.addGroup(0,g.length);for(var b=0,_=n.length;b<_;++b){var x=n[b],w=x.start;for(a=w,s=w+x.count;a<s;a+=3)u=3*g[a+1],c=3*g[a+2],p.fromArray(r,l=3*g[a+0]),d.fromArray(r,u),f.fromArray(r,c),m.subVectors(f,d),v.subVectors(p,d),m.cross(v),h[l]+=m.x,h[l+1]+=m.y,h[l+2]+=m.z,h[u]+=m.x,h[u+1]+=m.y,h[u+2]+=m.z,h[c]+=m.x,h[c+1]+=m.y,h[c+2]+=m.z}}else for(a=0,s=r.length;a<s;a+=9)p.fromArray(r,a),d.fromArray(r,a+3),f.fromArray(r,a+6),m.subVectors(f,d),v.subVectors(p,d),m.cross(v),h[a]=m.x,h[a+1]=m.y,h[a+2]=m.z,h[a+3]=m.x,h[a+4]=m.y,h[a+5]=m.z,h[a+6]=m.x,h[a+7]=m.y,h[a+8]=m.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==t.attributes[r])for(var i=n[r].array,o=t.attributes[r],a=o.array,s=0,l=o.itemSize*e;s<a.length;s++,l++)i[l]=a[s];return this}console.error("BufferGeometry.merge(): geometry not an instance of BufferGeometry.",t)},normalizeNormals:function(){var t=new i;return function(){for(var e=this.attributes.normal,n=0,r=e.count;n<r;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.normalize(),e.setXYZ(n,t.x,t.y,t.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn("BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new O,e=this.index.array,n=this.attributes;for(var r in n){for(var i=n[r],o=i.array,a=i.itemSize,s=new o.constructor(e.length*a),l=0,u=0,c=0,h=e.length;c<h;c++){l=e[c]*a;for(var p=0;p<a;p++)s[u++]=o[l++]}t.addAttribute(r,new y(s,a))}var d=this.groups;for(c=0,h=d.length;c<h;c++){var f=d[c];t.addGroup(f.start,f.count,f.materialIndex)}return t},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};var r=this.index;if(null!==r){var i=Array.prototype.slice.call(r.array);t.data.index={type:r.array.constructor.name,array:i}}var o=this.attributes;for(var n in o){var a=o[n];i=Array.prototype.slice.call(a.array);t.data.attributes[n]={itemSize:a.itemSize,type:a.array.constructor.name,array:i,normalized:a.normalized}}var s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));var l=this.boundingSphere;return null!==l&&(t.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),t},clone:function(){return(new O).copy(this)},copy:function(t){var e,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var i=t.index;null!==i&&this.setIndex(i.clone());var o=t.attributes;for(e in o){this.addAttribute(e,o[e].clone())}var a=t.morphAttributes;for(e in a){var s=[],l=a[e];for(n=0,r=l.length;n<r;n++)s.push(l[n].clone());this.morphAttributes[e]=s}var u=t.groups;for(n=0,r=u.length;n<r;n++){var c=u[n];this.addGroup(c.start,c.count,c.materialIndex)}var h=t.boundingBox;null!==h&&(this.boundingBox=h.clone());var p=t.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(N.prototype=Object.create(v.prototype)).constructor=N,(L.prototype=Object.create(O.prototype)).constructor=L;var To="91",Co=0,Eo=1,Po=2,Oo=0,No=1,Lo=2,Io=1,Do=2,Fo=0,Ro=1,ko=2,Uo=0,jo=1,Bo=2,zo=0,Vo=1,Go=2,Ho=3,Wo=4,Xo=5,Yo=100,qo=101,Zo=102,Qo=103,Jo=104,Ko=200,$o=201,ta=202,ea=203,na=204,ra=205,ia=206,oa=207,aa=208,sa=209,la=210,ua=0,ca=1,ha=2,pa=3,da=4,fa=5,ma=6,va=7,ga=0,ya=1,ba=2,_a=0,xa=1,wa=2,Sa=3,Aa=4,Ma=300,Ta=301,Ca=302,Ea=303,Pa=304,Oa=305,Na=306,La=307,Ia=1e3,Da=1001,Fa=1002,Ra=1003,ka=1004,Ua=1005,ja=1006,Ba=1007,za=1008,Va=1009,Ga=1010,Ha=1011,Wa=1012,Xa=1013,Ya=1014,qa=1015,Za=1016,Qa=1017,Ja=1018,Ka=1019,$a=1020,ts=1021,es=1022,ns=1023,rs=1024,is=1025,os=ns,as=1026,ss=1027,ls=33776,us=33777,cs=33778,hs=33779,ps=35840,ds=35841,fs=35842,ms=35843,vs=36196,gs=37808,ys=37809,bs=37810,_s=37811,xs=37812,ws=37813,Ss=37814,As=37815,Ms=37816,Ts=37817,Cs=37818,Es=37819,Ps=37820,Os=37821,Ns=2201,Ls=2300,Is=2400,Ds=0,Fs=1,Rs=2,ks=3e3,Us=3001,js=3007,Bs=3002,zs=3004,Vs=3005,Gs=3006,Hs=3200,Ws=3201,Xs=0;I.prototype=Object.assign(Object.create(a.prototype),{constructor:I,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0!==n)if("shading"!==e){var r=this[e];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]="overdraw"===e?Number(n):n:console.warn(this.type+": '"+e+"' is not a property of this material.")}else console.warn(this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;else console.warn("Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){function e(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}var n=void 0===t||"string"==typeof t;n&&(t={textures:{},images:{}});var r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearCoat&&(r.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(r.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,r.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Vo&&(r.blending=this.blending),!0===this.flatShading&&(r.flatShading=this.flatShading),this.side!==Fo&&(r.side=this.side),this.vertexColors!==Uo&&(r.vertexColors=this.vertexColors),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,0!==this.rotation&&(r.rotation=this.rotation),1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(r.morphTargets=!0),!0===this.skinning&&(r.skinning=!0),!1===this.visible&&(r.visible=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),n){var i=e(t.textures),o=e(t.images);i.length>0&&(r.textures=i),o.length>0&&(r.images=o)}return r},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this.userData=JSON.parse(JSON.stringify(t.userData)),this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection;var e=t.clippingPlanes,n=null;if(null!==e){var r=e.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.shadowSide=t.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(D.prototype=Object.create(I.prototype)).constructor=D,D.prototype.isMeshBasicMaterial=!0,D.prototype.copy=function(t){return I.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},(F.prototype=Object.create(I.prototype)).constructor=F,F.prototype.isLineBasicMaterial=!0,F.prototype.copy=function(t){return I.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},Object.assign(R.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(console.warn("Ray: .at() target is now required"),e=new i),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(){var t=new i;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){void 0===e&&(console.warn("Ray: .closestPointToPoint() target is now required"),e=new i),e.subVectors(t,this.origin);var n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new i;return function(e){var n=t.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(n).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:function(){var t=new i,e=new i,n=new i;return function(r,i,o,a){t.copy(r).add(i).multiplyScalar(.5),e.copy(i).sub(r).normalize(),n.copy(this.origin).sub(t);var s,l,u,c,h=.5*r.distanceTo(i),p=-this.direction.dot(e),d=n.dot(this.direction),f=-n.dot(e),m=n.lengthSq(),v=Math.abs(1-p*p);if(v>0)if(s=p*f-d,l=p*d-f,c=h*v,s>=0)if(l>=-c)if(l<=c){var g=1/v;u=(s*=g)*(s+p*(l*=g)+2*d)+l*(p*s+l+2*f)+m}else l=h,u=-(s=Math.max(0,-(p*l+d)))*s+l*(l+2*f)+m;else l=-h,u=-(s=Math.max(0,-(p*l+d)))*s+l*(l+2*f)+m;else l<=-c?u=-(s=Math.max(0,-(-p*h+d)))*s+(l=s>0?-h:Math.min(Math.max(-h,-f),h))*(l+2*f)+m:l<=c?(s=0,u=(l=Math.min(Math.max(-h,-f),h))*(l+2*f)+m):u=-(s=Math.max(0,-(p*h+d)))*s+(l=s>0?h:Math.min(Math.max(-h,-f),h))*(l+2*f)+m;else l=p>0?-h:h,u=-(s=Math.max(0,-(p*l+d)))*s+l*(l+2*f)+m;return o&&o.copy(this.direction).multiplyScalar(s).add(this.origin),a&&a.copy(e).multiplyScalar(l).add(t),u}}(),intersectSphere:function(){var t=new i;return function(e,n){t.subVectors(e.center,this.origin);var r=t.dot(this.direction),i=t.dot(t)-r*r,o=e.radius*e.radius;if(i>o)return null;var a=Math.sqrt(o-i),s=r-a,l=r+a;return s<0&&l<0?null:this.at(s<0?l:s,n)}}(),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);if(0===e)return!0;return t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var n,r,i,o,a,s,l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,h=this.origin;return l>=0?(n=(t.min.x-h.x)*l,r=(t.max.x-h.x)*l):(n=(t.max.x-h.x)*l,r=(t.min.x-h.x)*l),u>=0?(i=(t.min.y-h.y)*u,o=(t.max.y-h.y)*u):(i=(t.max.y-h.y)*u,o=(t.min.y-h.y)*u),n>o||i>r?null:((i>n||n!=n)&&(n=i),(o<r||r!=r)&&(r=o),c>=0?(a=(t.min.z-h.z)*c,s=(t.max.z-h.z)*c):(a=(t.max.z-h.z)*c,s=(t.min.z-h.z)*c),n>s||a>r?null:((a>n||n!=n)&&(n=a),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,e)))},intersectsBox:function(){var t=new i;return function(e){return null!==this.intersectBox(e,t)}}(),intersectTriangle:function(){var t=new i,e=new i,n=new i,r=new i;return function(i,o,a,s,l){e.subVectors(o,i),n.subVectors(a,i),r.crossVectors(e,n);var u,c=this.direction.dot(r);if(c>0){if(s)return null;u=1}else{if(!(c<0))return null;u=-1,c=-c}t.subVectors(this.origin,i);var h=u*this.direction.dot(n.crossVectors(t,n));if(h<0)return null;var p=u*this.direction.dot(e.cross(t));if(p<0)return null;if(h+p>c)return null;var d=-u*t.dot(r);return d<0?null:this.at(d/c,l)}}(),applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}}),Object.assign(k.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("Line3: .getCenter() target is now required"),t=new i),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("Line3: .delta() target is now required"),t=new i),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return void 0===e&&(console.warn("Line3: .at() target is now required"),e=new i),this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new i,e=new i;return function(n,r){t.subVectors(n,this.start),e.subVectors(this.end,this.start);var i=e.dot(e),o=e.dot(t)/i;return r&&(o=xo.clamp(o,0,1)),o}}(),closestPointToPoint:function(t,e,n){var r=this.closestPointToPointParameter(t,e);return void 0===n&&(console.warn("Line3: .closestPointToPoint() target is now required"),n=new i),this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),Object.assign(U.prototype,{set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new i,e=new i;return function(n,r,i){var o=t.subVectors(i,r).cross(e.subVectors(n,r)).normalize();return this.setFromNormalAndCoplanarPoint(o,n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(console.warn("Plane: .projectPoint() target is now required"),e=new i),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(){var t=new i;return function(e,n){void 0===n&&(console.warn("Plane: .intersectLine() target is now required"),n=new i);var r=e.delta(t),o=this.normal.dot(r);if(0!==o){var a=-(e.start.dot(this.normal)+this.constant)/o;if(!(a<0||a>1))return n.copy(r).multiplyScalar(a).add(e.start)}else if(0===this.distanceToPoint(e.start))return n.copy(e.start)}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("Plane: .coplanarPoint() target is now required"),t=new i),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new i,e=new u;return function(n,r){var i=r||e.getNormalMatrix(n),o=this.coplanarPoint(t).applyMatrix4(n),a=this.normal.applyMatrix3(i).normalize();return this.constant=-o.dot(a),this}}(),translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}}),Object.assign(j,{getNormal:function(){var t=new i;return function(e,n,r,o){void 0===o&&(console.warn("Triangle: .getNormal() target is now required"),o=new i),o.subVectors(r,n),t.subVectors(e,n),o.cross(t);var a=o.lengthSq();return a>0?o.multiplyScalar(1/Math.sqrt(a)):o.set(0,0,0)}}(),getBarycoord:function(){var t=new i,e=new i,n=new i;return function(r,o,a,s,l){t.subVectors(s,o),e.subVectors(a,o),n.subVectors(r,o);var u=t.dot(t),c=t.dot(e),h=t.dot(n),p=e.dot(e),d=e.dot(n),f=u*p-c*c;if(void 0===l&&(console.warn("Triangle: .getBarycoord() target is now required"),l=new i),0===f)return l.set(-2,-1,-1);var m=1/f,v=(p*h-c*d)*m,g=(u*d-c*h)*m;return l.set(1-v-g,g,v)}}(),containsPoint:function(){var t=new i;return function(e,n,r,i){return j.getBarycoord(e,n,r,i,t),t.x>=0&&t.y>=0&&t.x+t.y<=1}}()}),Object.assign(j.prototype,{set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){var t=new i,e=new i;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),getMidpoint:function(t){return void 0===t&&(console.warn("Triangle: .getMidpoint() target is now required"),t=new i),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return j.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("Triangle: .getPlane() target is now required"),t=new i),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return j.getBarycoord(t,this.a,this.b,this.c,e)},containsPoint:function(t){return j.containsPoint(t,this.a,this.b,this.c)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(){var t=new U,e=[new k,new k,new k],n=new i,r=new i;return function(o,a){void 0===a&&(console.warn("Triangle: .closestPointToPoint() target is now required"),a=new i);var s=1/0;if(t.setFromCoplanarPoints(this.a,this.b,this.c),t.projectPoint(o,n),!0===this.containsPoint(n))a.copy(n);else{e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a);for(var l=0;l<e.length;l++){e[l].closestPointToPoint(n,!0,r);var u=n.distanceToSquared(r);u<s&&(s=u,a.copy(r))}}return a}}(),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}),B.prototype=Object.assign(Object.create(c.prototype),{constructor:B,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return c.prototype.copy.call(this,t),this.drawMode=t.drawMode,void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=a.length;t<e;t++)n=a[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{var s=r.morphTargets;if(void 0!==s&&s.length>0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=s.length;t<e;t++)n=s[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}},raycast:function(){function t(t,e,n,r,i,o,a){return j.getBarycoord(t,e,n,r,_),i.multiplyScalar(_.x),o.multiplyScalar(_.y),a.multiplyScalar(_.z),i.add(o).add(a),i.clone()}function e(t,e,n,r,i,o,a,s){if(null===(e.side===Ro?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,e.side!==ko,s)))return null;w.copy(s),w.applyMatrix4(t.matrixWorld);var l=n.ray.origin.distanceTo(w);return l<n.near||l>n.far?null:{distance:l,point:w.clone(),object:t}}function n(n,r,i,o,a,s,h,d){l.fromBufferAttribute(o,s),u.fromBufferAttribute(o,h),c.fromBufferAttribute(o,d);var f=e(n,n.material,r,i,l,u,c,x);if(f){a&&(g.fromBufferAttribute(a,s),y.fromBufferAttribute(a,h),b.fromBufferAttribute(a,d),f.uv=t(x,l,u,c,g,y,b));var m=new p(s,h,d);j.getNormal(l,u,c,m.normal),f.face=m,f.faceIndex=s}return f}var o=new r,a=new R,s=new f,l=new i,u=new i,c=new i,h=new i,d=new i,v=new i,g=new m,y=new m,b=new m,_=new i,x=new i,w=new i;return function(r,i){var p=this.geometry,f=this.material,m=this.matrixWorld;if(void 0!==f&&(null===p.boundingSphere&&p.computeBoundingSphere(),s.copy(p.boundingSphere),s.applyMatrix4(m),!1!==r.ray.intersectsSphere(s)&&(o.getInverse(m),a.copy(r.ray).applyMatrix4(o),null===p.boundingBox||!1!==a.intersectsBox(p.boundingBox)))){var _;if(p.isBufferGeometry){var w,S,A,M,T,C=p.index,E=p.attributes.position,P=p.attributes.uv;if(null!==C)for(M=0,T=C.count;M<T;M+=3)w=C.getX(M),S=C.getX(M+1),A=C.getX(M+2),(_=n(this,r,a,E,P,w,S,A))&&(_.faceIndex=Math.floor(M/3),i.push(_));else if(void 0!==E)for(M=0,T=E.count;M<T;M+=3)(_=n(this,r,a,E,P,w=M,S=M+1,A=M+2))&&(_.index=w,i.push(_))}else if(p.isGeometry){var O,N,L,I,D=Array.isArray(f),F=p.vertices,R=p.faces,k=p.faceVertexUvs[0];k.length>0&&(I=k);for(var U=0,j=R.length;U<j;U++){var B=R[U],z=D?f[B.materialIndex]:f;if(void 0!==z){if(O=F[B.a],N=F[B.b],L=F[B.c],!0===z.morphTargets){var V=p.morphTargets,G=this.morphTargetInfluences;l.set(0,0,0),u.set(0,0,0),c.set(0,0,0);for(var H=0,W=V.length;H<W;H++){var X=G[H];if(0!==X){var Y=V[H].vertices;l.addScaledVector(h.subVectors(Y[B.a],O),X),u.addScaledVector(d.subVectors(Y[B.b],N),X),c.addScaledVector(v.subVectors(Y[B.c],L),X)}}l.add(O),u.add(N),c.add(L),O=l,N=u,L=c}if(_=e(this,z,r,a,O,N,L,x)){if(I&&I[U]){var q=I[U];g.copy(q[0]),y.copy(q[1]),b.copy(q[2]),_.uv=t(x,O,N,L,g,y,b)}_.face=B,_.faceIndex=U,i.push(_)}}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),z.prototype=Object.assign(Object.create(c.prototype),{constructor:z,isLine:!0,computeLineDistances:function(){var t=new i,e=new i;return function(){var n=this.geometry;if(n.isBufferGeometry)if(null===n.index){for(var r=n.attributes.position,i=[0],o=1,a=r.count;o<a;o++)t.fromBufferAttribute(r,o-1),e.fromBufferAttribute(r,o),i[o]=i[o-1],i[o]+=t.distanceTo(e);n.addAttribute("lineDistance",new T(i,1))}else console.error("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(n.isGeometry){var s=n.vertices;(i=n.lineDistances)[0]=0;for(o=1,a=s.length;o<a;o++)i[o]=i[o-1],i[o]+=s[o-1].distanceTo(s[o])}return this}}(),raycast:function(){var t=new r,e=new R,n=new f;return function(r,o){var a=r.linePrecision,s=a*a,l=this.geometry,u=this.matrixWorld;if(null===l.boundingSphere&&l.computeBoundingSphere(),n.copy(l.boundingSphere),n.applyMatrix4(u),!1!==r.ray.intersectsSphere(n)){t.getInverse(u),e.copy(r.ray).applyMatrix4(t);var c=new i,h=new i,p=new i,d=new i,f=this&&this.isLineSegments?2:1;if(l.isBufferGeometry){var m=l.index,v=l.attributes.position.array;if(null!==m)for(var g=m.array,y=0,b=g.length-1;y<b;y+=f){var _=g[y+1];c.fromArray(v,3*g[y]),h.fromArray(v,3*_);if(!(e.distanceSqToSegment(c,h,d,p)>s)){d.applyMatrix4(this.matrixWorld);(S=r.ray.origin.distanceTo(d))<r.near||S>r.far||o.push({distance:S,point:p.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}else for(y=0,b=v.length/3-1;y<b;y+=f){c.fromArray(v,3*y),h.fromArray(v,3*y+3);if(!(e.distanceSqToSegment(c,h,d,p)>s)){d.applyMatrix4(this.matrixWorld);(S=r.ray.origin.distanceTo(d))<r.near||S>r.far||o.push({distance:S,point:p.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}}else if(l.isGeometry){var x=l.vertices,w=x.length;for(y=0;y<w-1;y+=f){if(!(e.distanceSqToSegment(x[y],x[y+1],d,p)>s)){d.applyMatrix4(this.matrixWorld);var S;(S=r.ray.origin.distanceTo(d))<r.near||S>r.far||o.push({distance:S,point:p.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Ys=function(t){this.mesh=t,this._valid()};Ys.prototype={constructor:Ys,_valid:function(){for(var t=this.mesh.geometry.iks,e=this.mesh.skeleton.bones,n=0,r=t.length;n<r;n++){var i,o,a=t[n],s=a.links;i=e[a.effector];for(var l=0,u=s.length;l<u;l++)i.parent!==(o=e[s[l].index])&&console.warn("CCDIKSolver: bone "+i.name+" is not the child of bone "+o.name),i=o}},_saveOriginalBonesInfo:function(){for(var t=this.mesh.skeleton.bones,e=0,n=t.length;e<n;e++){var r=t[e];void 0===r.userData.ik&&(r.userData.ik={}),r.userData.ik.originalMatrix=r.matrix.toArray()}},update:function(t){var e=new o,n=new i,r=new i,a=new i,s=new i,l=new i,u=new o,c=new i,h=new i,p=this.mesh.skeleton.bones,d=this.mesh.geometry.iks,f=Math;this.mesh.updateMatrixWorld(!0),!0===t&&this._saveOriginalBonesInfo();for(var m=0,v=d.length;m<v;m++){var g=d[m],y=p[g.effector];n.setFromMatrixPosition(p[g.target].matrixWorld);for(var b=g.links,_=void 0!==g.iteration?g.iteration:1,x=0;x<_;x++){for(var w=!1,S=0,A=b.length;S<A;S++){var M=p[b[S].index];if(!1===b[S].enabled)break;var T=b[S].limitation;M.matrixWorld.decompose(l,u,c),u.inverse(),a.setFromMatrixPosition(y.matrixWorld),s.subVectors(a,l),s.applyQuaternion(u),s.normalize(),r.subVectors(n,l),r.applyQuaternion(u),r.normalize();var C=r.dot(s);if(C>1?C=1:C<-1&&(C=-1),!((C=f.acos(C))<1e-5)){if(void 0!==g.minAngle&&C<g.minAngle&&(C=g.minAngle),void 0!==g.maxAngle&&C>g.maxAngle&&(C=g.maxAngle),h.crossVectors(s,r),h.normalize(),e.setFromAxisAngle(h,C),M.quaternion.multiply(e),void 0!==T){var E=M.quaternion.w;E>1&&(E=1);var P=f.sqrt(1-E*E);M.quaternion.set(T.x*P,T.y*P,T.z*P,E)}M.updateMatrixWorld(!0),w=!0}}if(!w)break}}this.mesh.updateMatrixWorld(!0)}};var qs=function(t){if(void 0===t.geometry.iks||void 0===t.skeleton)throw"CCDIKHelper requires iks in mesh.geometry and skeleton in mesh.";c.call(this),this.root=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.sphereGeometry=new L(.25,16,8),this.targetSphereMaterial=new D({color:new h(16746632),depthTest:!1,depthWrite:!1,transparent:!0}),this.effectorSphereMaterial=new D({color:new h(8978312),depthTest:!1,depthWrite:!1,transparent:!0}),this.linkSphereMaterial=new D({color:new h(8947967),depthTest:!1,depthWrite:!1,transparent:!0}),this.lineMaterial=new F({color:new h(16711680),depthTest:!1,depthWrite:!1,transparent:!0}),this._init(),this.update()};(qs.prototype=Object.create(c.prototype)).constructor=qs,qs.prototype._init=function(){function t(){return new B(i.sphereGeometry,i.targetSphereMaterial)}function e(){return new B(i.sphereGeometry,i.effectorSphereMaterial)}function n(){return new B(i.sphereGeometry,i.linkSphereMaterial)}function r(t){return new z(function(t){var e=new O,n=new Float32Array(3*(2+t.links.length));return e.addAttribute("position",new y(n,3)),e}(t),i.lineMaterial)}for(var i=this,o=this.root.geometry.iks,a=0,s=o.length;a<s;a++){var l=o[a];this.add(t()),this.add(e());for(var u=0,c=l.links.length;u<c;u++)this.add(n());this.add(r(l))}},qs.prototype.update=function(){function t(t){return u.setFromMatrixPosition(t.matrixWorld),u.applyMatrix4(l),u}function e(e,n,r){var i=t(r);e[3*n+0]=i.x,e[3*n+1]=i.y,e[3*n+2]=i.z}for(var n=0,o=this.root,a=o.geometry.iks,s=o.skeleton.bones,l=(new r).getInverse(o.matrixWorld),u=new i,c=0,h=a.length;c<h;c++){var p=a[c],d=s[p.target],f=s[p.effector],m=this.children[n++],v=this.children[n++];m.position.copy(t(d)),v.position.copy(t(f));for(var g=0,y=p.links.length;g<y;g++){this.children[n++].position.copy(t(s[p.links[g].index]))}var b=this.children[n++],_=b.geometry.attributes.position.array;e(_,0,d),e(_,1,f);for(g=0,y=p.links.length;g<y;g++){e(_,g+2,s[p.links[g].index])}b.geometry.attributes.position.needsUpdate=!0}},V.prototype=Object.assign(Object.create(c.prototype),{constructor:V,isBone:!0}),(G.prototype=Object.create(v.prototype)).constructor=G,(H.prototype=Object.create(O.prototype)).constructor=H,(W.prototype=Object.create(v.prototype)).constructor=W,(X.prototype=Object.create(O.prototype)).constructor=X;var Zs=function(t,e){void 0===e&&(e={}),this.mesh=t,this.helper=new Zs.ResourceHelper,this.unitStep=void 0!==e.unitStep?e.unitStep:1/65,this.maxStepNum=void 0!==e.maxStepNum?e.maxStepNum:3,this.world=void 0!==e.world?e.world:null,this.bodies=[],this.constraints=[],this.init(t)};Zs.prototype={constructor:Zs,init:function(t){var e=t.parent;null!==e&&e.remove(t);var n=this.helper,r=n.allocThreeVector3(),i=n.allocThreeEuler(),o=n.allocThreeVector3();r.copy(t.position),i.copy(t.rotation),o.copy(t.scale),t.position.set(0,0,0),t.rotation.set(0,0,0),t.scale.set(1,1,1),t.updateMatrixWorld(!0),null===this.world&&this.initWorld(),this.initRigidBodies(),this.initConstraints(),null!==e&&e.add(t),t.position.copy(r),t.rotation.copy(i),t.scale.copy(o),t.updateMatrixWorld(!0),this.reset(),n.freeThreeVector3(r),n.freeThreeEuler(i),n.freeThreeVector3(o)},initWorld:function(){var t=new Ammo.btDefaultCollisionConfiguration,e=new Ammo.btCollisionDispatcher(t),n=new Ammo.btDbvtBroadphase,r=new Ammo.btSequentialImpulseConstraintSolver,i=new Ammo.btDiscreteDynamicsWorld(e,n,r,t);i.setGravity(new Ammo.btVector3(0,-98,0)),this.world=i},initRigidBodies:function(){for(var t=this.mesh.geometry.rigidBodies,e=0;e<t.length;e++){var n=new Zs.RigidBody(this.mesh,this.world,t[e],this.helper);this.bodies.push(n)}},initConstraints:function(){for(var t=this.mesh.geometry.constraints,e=0;e<t.length;e++){var n=t[e],r=new Zs.Constraint(this.mesh,this.world,this.bodies[n.rigidBodyIndex1],this.bodies[n.rigidBodyIndex2],n,this.helper);this.constraints.push(r)}},update:function(t){this.updateRigidBodies(),this.stepSimulation(t),this.updateBones()},stepSimulation:function(t){var e=this.unitStep,n=t,r=1+(t/e|0);n<e&&(n=e,r=1),r>this.maxStepNum&&(r=this.maxStepNum),this.world.stepSimulation(n,r,e)},updateRigidBodies:function(){for(var t=0;t<this.bodies.length;t++)this.bodies[t].updateFromBone()},updateBones:function(){for(var t=0;t<this.bodies.length;t++)this.bodies[t].updateBone()},reset:function(){for(var t=0;t<this.bodies.length;t++)this.bodies[t].reset()},warmup:function(t){for(var e=0;e<t;e++)this.update(1/60)}},Zs.ResourceHelper=function(){this.threeVector3s=[],this.threeMatrix4s=[],this.threeQuaternions=[],this.threeEulers=[],this.transforms=[],this.quaternions=[],this.vector3s=[]},Zs.ResourceHelper.prototype={allocThreeVector3:function(){return this.threeVector3s.length>0?this.threeVector3s.pop():new i},freeThreeVector3:function(t){this.threeVector3s.push(t)},allocThreeMatrix4:function(){return this.threeMatrix4s.length>0?this.threeMatrix4s.pop():new r},freeThreeMatrix4:function(t){this.threeMatrix4s.push(t)},allocThreeQuaternion:function(){return this.threeQuaternions.length>0?this.threeQuaternions.pop():new o},freeThreeQuaternion:function(t){this.threeQuaternions.push(t)},allocThreeEuler:function(){return this.threeEulers.length>0?this.threeEulers.pop():new s},freeThreeEuler:function(t){this.threeEulers.push(t)},allocTransform:function(){return this.transforms.length>0?this.transforms.pop():new Ammo.btTransform},freeTransform:function(t){this.transforms.push(t)},allocQuaternion:function(){return this.quaternions.length>0?this.quaternions.pop():new Ammo.btQuaternion},freeQuaternion:function(t){this.quaternions.push(t)},allocVector3:function(){return this.vector3s.length>0?this.vector3s.pop():new Ammo.btVector3},freeVector3:function(t){this.vector3s.push(t)},setIdentity:function(t){t.setIdentity()},getBasis:function(t){var e=this.allocQuaternion();return t.getBasis().getRotation(e),e},getBasisAsMatrix3:function(t){var e=this.getBasis(t),n=this.quaternionToMatrix3(e);return this.freeQuaternion(e),n},getOrigin:function(t){return t.getOrigin()},setOrigin:function(t,e){t.getOrigin().setValue(e.x(),e.y(),e.z())},copyOrigin:function(t,e){var n=e.getOrigin();this.setOrigin(t,n)},setBasis:function(t,e){t.setRotation(e)},setBasisFromMatrix3:function(t,e){var n=this.matrix3ToQuaternion(e);this.setBasis(t,n),this.freeQuaternion(n)},setOriginFromArray3:function(t,e){t.getOrigin().setValue(e[0],e[1],e[2])},setOriginFromThreeVector3:function(t,e){t.getOrigin().setValue(e.x,e.y,e.z)},setBasisFromArray3:function(t,e){var n=this.allocThreeQuaternion(),r=this.allocThreeEuler();r.set(e[0],e[1],e[2]),this.setBasisFromThreeQuaternion(t,n.setFromEuler(r)),this.freeThreeEuler(r),this.freeThreeQuaternion(n)},setBasisFromThreeQuaternion:function(t,e){var n=this.allocQuaternion();n.setX(e.x),n.setY(e.y),n.setZ(e.z),n.setW(e.w),this.setBasis(t,n),this.freeQuaternion(n)},multiplyTransforms:function(t,e){var n=this.allocTransform();this.setIdentity(n);var r=this.getBasisAsMatrix3(t),i=this.getBasisAsMatrix3(e),o=this.getOrigin(t),a=this.getOrigin(e),s=this.multiplyMatrix3ByVector3(r,a),l=this.addVector3(s,o);this.setOrigin(n,l);var u=this.multiplyMatrices3(r,i);return this.setBasisFromMatrix3(n,u),this.freeVector3(s),this.freeVector3(l),n},inverseTransform:function(t){var e=this.allocTransform(),n=this.getBasisAsMatrix3(t),r=this.getOrigin(t),i=this.transposeMatrix3(n),o=this.negativeVector3(r),a=this.multiplyMatrix3ByVector3(i,o);return this.setOrigin(e,a),this.setBasisFromMatrix3(e,i),this.freeVector3(o),this.freeVector3(a),e},multiplyMatrices3:function(t,e){var n=[],r=this.rowOfMatrix3(t,0),i=this.rowOfMatrix3(t,1),o=this.rowOfMatrix3(t,2),a=this.columnOfMatrix3(e,0),s=this.columnOfMatrix3(e,1),l=this.columnOfMatrix3(e,2);return n[0]=this.dotVectors3(r,a),n[1]=this.dotVectors3(r,s),n[2]=this.dotVectors3(r,l),n[3]=this.dotVectors3(i,a),n[4]=this.dotVectors3(i,s),n[5]=this.dotVectors3(i,l),n[6]=this.dotVectors3(o,a),n[7]=this.dotVectors3(o,s),n[8]=this.dotVectors3(o,l),this.freeVector3(r),this.freeVector3(i),this.freeVector3(o),this.freeVector3(a),this.freeVector3(s),this.freeVector3(l),n},addVector3:function(t,e){var n=this.allocVector3();return n.setValue(t.x()+e.x(),t.y()+e.y(),t.z()+e.z()),n},dotVectors3:function(t,e){return t.x()*e.x()+t.y()*e.y()+t.z()*e.z()},rowOfMatrix3:function(t,e){var n=this.allocVector3();return n.setValue(t[3*e+0],t[3*e+1],t[3*e+2]),n},columnOfMatrix3:function(t,e){var n=this.allocVector3();return n.setValue(t[e+0],t[e+3],t[e+6]),n},negativeVector3:function(t){var e=this.allocVector3();return e.setValue(-t.x(),-t.y(),-t.z()),e},multiplyMatrix3ByVector3:function(t,e){var n=this.allocVector3(),r=this.rowOfMatrix3(t,0),i=this.rowOfMatrix3(t,1),o=this.rowOfMatrix3(t,2),a=this.dotVectors3(r,e),s=this.dotVectors3(i,e),l=this.dotVectors3(o,e);return n.setValue(a,s,l),this.freeVector3(r),this.freeVector3(i),this.freeVector3(o),n},transposeMatrix3:function(t){var e=[];return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],e},quaternionToMatrix3:function(t){var e=[],n=t.x(),r=t.y(),i=t.z(),o=t.w(),a=n*n,s=r*r,l=i*i,u=n*r,c=r*i,h=i*n,p=n*o,d=r*o,f=i*o;return e[0]=1-2*(s+l),e[1]=2*(u-f),e[2]=2*(h+d),e[3]=2*(u+f),e[4]=1-2*(l+a),e[5]=2*(c-p),e[6]=2*(h-d),e[7]=2*(c+p),e[8]=1-2*(a+s),e},matrix3ToQuaternion:function(t){var e,n,r,i,o,a=t[0]+t[4]+t[8];a>0?(o=.25*(e=2*Math.sqrt(a+1)),n=(t[7]-t[5])/e,r=(t[2]-t[6])/e,i=(t[3]-t[1])/e):t[0]>t[4]&&t[0]>t[8]?(e=2*Math.sqrt(1+t[0]-t[4]-t[8]),o=(t[7]-t[5])/e,n=.25*e,r=(t[1]+t[3])/e,i=(t[2]+t[6])/e):t[4]>t[8]?(e=2*Math.sqrt(1+t[4]-t[0]-t[8]),o=(t[2]-t[6])/e,n=(t[1]+t[3])/e,r=.25*e,i=(t[5]+t[7])/e):(e=2*Math.sqrt(1+t[8]-t[0]-t[4]),o=(t[3]-t[1])/e,n=(t[2]+t[6])/e,r=(t[5]+t[7])/e,i=.25*e);var s=this.allocQuaternion();return s.setX(n),s.setY(r),s.setZ(i),s.setW(o),s}},Zs.RigidBody=function(t,e,n,r){this.mesh=t,this.world=e,this.params=n,this.helper=r,this.body=null,this.bone=null,this.boneOffsetForm=null,this.boneOffsetFormInverse=null,this.init()},Zs.RigidBody.prototype={constructor:Zs.RigidBody,init:function(){var t=this.helper,e=this.params,n=this.mesh.skeleton.bones,r=-1===e.boneIndex?new V:n[e.boneIndex],i=function(t){switch(t.shapeType){case 0:return new Ammo.btSphereShape(t.width);case 1:return new Ammo.btBoxShape(new Ammo.btVector3(t.width,t.height,t.depth));case 2:return new Ammo.btCapsuleShape(t.width,t.height);default:throw"unknown shape type "+t.shapeType}}(e),o=0===e.type?0:e.weight,a=t.allocVector3();a.setValue(0,0,0),0!==o&&i.calculateLocalInertia(o,a);var s=t.allocTransform();t.setIdentity(s),t.setOriginFromArray3(s,e.position),t.setBasisFromArray3(s,e.rotation);var l=t.allocThreeVector3(),u=t.allocTransform();t.setIdentity(u),t.setOriginFromThreeVector3(u,r.getWorldPosition(l));var c=t.multiplyTransforms(u,s),h=new Ammo.btDefaultMotionState(c),p=new Ammo.btRigidBodyConstructionInfo(o,h,i,a);p.set_m_friction(e.friction),p.set_m_restitution(e.restitution);var d=new Ammo.btRigidBody(p);0===e.type&&(d.setCollisionFlags(2|d.getCollisionFlags()),d.setActivationState(4)),d.setDamping(e.positionDamping,e.rotationDamping),d.setSleepingThresholds(0,0),this.world.addRigidBody(d,1<<e.groupIndex,e.groupTarget),this.body=d,this.bone=r,this.boneOffsetForm=s,this.boneOffsetFormInverse=t.inverseTransform(s),t.freeVector3(a),t.freeTransform(c),t.freeTransform(u),t.freeThreeVector3(l)},reset:function(){this.setTransformFromBone()},updateFromBone:function(){-1!==this.params.boneIndex&&0===this.params.type&&this.setTransformFromBone()},updateBone:function(){0!==this.params.type&&-1!==this.params.boneIndex&&(this.updateBoneRotation(),1===this.params.type&&this.updateBonePosition(),this.bone.updateMatrixWorld(!0),2===this.params.type&&this.setPositionFromBone())},getBoneTransform:function(){var t=this.helper,e=t.allocThreeVector3(),n=t.allocThreeQuaternion();this.bone.getWorldPosition(e),this.bone.getWorldQuaternion(n);var r=t.allocTransform();t.setOriginFromThreeVector3(r,e),t.setBasisFromThreeQuaternion(r,n);var i=t.multiplyTransforms(r,this.boneOffsetForm);return t.freeTransform(r),t.freeThreeQuaternion(n),t.freeThreeVector3(e),i},getWorldTransformForBone:function(){var t=this.helper,e=t.allocTransform();this.body.getMotionState().getWorldTransform(e);var n=t.multiplyTransforms(e,this.boneOffsetFormInverse);return t.freeTransform(e),n},setTransformFromBone:function(){var t=this.helper,e=this.getBoneTransform();this.body.setCenterOfMassTransform(e),this.body.getMotionState().setWorldTransform(e),t.freeTransform(e)},setPositionFromBone:function(){var t=this.helper,e=this.getBoneTransform(),n=t.allocTransform();this.body.getMotionState().getWorldTransform(n),t.copyOrigin(n,e),this.body.setCenterOfMassTransform(n),this.body.getMotionState().setWorldTransform(n),t.freeTransform(n),t.freeTransform(e)},updateBoneRotation:function(){this.bone.updateMatrixWorld(!0);var t=this.helper,e=this.getWorldTransformForBone(),n=t.getBasis(e),r=t.allocThreeQuaternion(),i=t.allocThreeQuaternion(),o=t.allocThreeQuaternion();r.set(n.x(),n.y(),n.z(),n.w()),i.setFromRotationMatrix(this.bone.matrixWorld),i.conjugate(),i.multiply(r),o.setFromRotationMatrix(this.bone.matrix),this.bone.quaternion.copy(i.multiply(o)),t.freeThreeQuaternion(r),t.freeThreeQuaternion(i),t.freeThreeQuaternion(o),t.freeQuaternion(n),t.freeTransform(e)},updateBonePosition:function(){var t=this.helper,e=this.getWorldTransformForBone(),n=t.allocThreeVector3(),r=t.getOrigin(e);n.set(r.x(),r.y(),r.z());var i=this.bone.worldToLocal(n);this.bone.position.add(i),t.freeThreeVector3(n),t.freeTransform(e)}},Zs.Constraint=function(t,e,n,r,i,o){this.mesh=t,this.world=e,this.bodyA=n,this.bodyB=r,this.params=i,this.helper=o,this.constraint=null,this.init()},Zs.Constraint.prototype={constructor:Zs.Constraint,init:function(){var t=this.helper,e=this.params,n=this.bodyA,r=this.bodyB,i=t.allocTransform();t.setIdentity(i),t.setOriginFromArray3(i,e.position),t.setBasisFromArray3(i,e.rotation);var o=t.allocTransform(),a=t.allocTransform();n.body.getMotionState().getWorldTransform(o),r.body.getMotionState().getWorldTransform(a);var s=t.inverseTransform(o),l=t.inverseTransform(a),u=t.multiplyTransforms(s,i),c=t.multiplyTransforms(l,i),h=new Ammo.btGeneric6DofSpringConstraint(n.body,r.body,u,c,!0),p=t.allocVector3(),d=t.allocVector3(),f=t.allocVector3(),m=t.allocVector3();p.setValue(e.translationLimitation1[0],e.translationLimitation1[1],e.translationLimitation1[2]),d.setValue(e.translationLimitation2[0],e.translationLimitation2[1],e.translationLimitation2[2]),f.setValue(e.rotationLimitation1[0],e.rotationLimitation1[1],e.rotationLimitation1[2]),m.setValue(e.rotationLimitation2[0],e.rotationLimitation2[1],e.rotationLimitation2[2]),h.setLinearLowerLimit(p),h.setLinearUpperLimit(d),h.setAngularLowerLimit(f),h.setAngularUpperLimit(m);for(var v=0;v<3;v++)0!==e.springPosition[v]&&(h.enableSpring(v,!0),h.setStiffness(v,e.springPosition[v]));for(v=0;v<3;v++)0!==e.springRotation[v]&&(h.enableSpring(v+3,!0),h.setStiffness(v+3,e.springRotation[v]));if(void 0!==h.setParam)for(v=0;v<6;v++)h.setParam(2,.475,v);this.world.addConstraint(h,!0),this.constraint=h,t.freeTransform(i),t.freeTransform(o),t.freeTransform(a),t.freeTransform(s),t.freeTransform(l),t.freeTransform(u),t.freeTransform(c),t.freeVector3(p),t.freeVector3(d),t.freeVector3(f),t.freeVector3(m)}};var Qs=function(t){if(void 0===t.physics||void 0===t.geometry.rigidBodies)throw"MMDPhysicsHelper requires physics in mesh and rigidBodies in mesh.geometry.";c.call(this),this.root=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.materials=[],this.materials.push(new D({color:new h(16746632),wireframe:!0,depthTest:!1,depthWrite:!1,opacity:.25,transparent:!0})),this.materials.push(new D({color:new h(8978312),wireframe:!0,depthTest:!1,depthWrite:!1,opacity:.25,transparent:!0})),this.materials.push(new D({color:new h(8947967),wireframe:!0,depthTest:!1,depthWrite:!1,opacity:.25,transparent:!0})),this._init(),this.update()};(Qs.prototype=Object.create(c.prototype)).constructor=Qs,Qs.prototype._init=function(){function t(t){switch(t.shapeType){case 0:return new L(t.width,16,8);case 1:return new H(2*t.width,2*t.height,2*t.depth,8,8,8);case 2:return new function(t,e,n,r){var i=new X(t,t,e,n,r,!0),o=new B(new L(t,n,r,0,2*Math.PI,0,Math.PI/2)),a=new B(new L(t,n,r,0,2*Math.PI,Math.PI/2,Math.PI/2));return o.position.set(0,e/2,0),a.position.set(0,-e/2,0),o.updateMatrix(),a.updateMatrix(),i.merge(o.geometry,o.matrix),i.merge(a.geometry,a.matrix),i}(t.width,t.height,16,8);default:return null}}for(var e=this.root.geometry.rigidBodies,n=0,r=e.length;n<r;n++){var i=e[n];this.add(new B(t(i),this.materials[i.type]))}},Qs.prototype.update=function(){function t(t){return l.set(t.x(),t.y(),t.z()),l.applyMatrix4(s),l}function e(t){return u.set(t.x(),t.y(),t.z(),t.w()),c.setFromRotationMatrix(s),c.multiply(u),c}for(var n=(d=this.root).geometry.rigidBodies,a=d.physics.bodies,s=(new r).getInverse(d.matrixWorld),l=new i,u=new o,c=new o,h=0,p=n.length;h<p;h++){var d=this.children[h],f=a[h].body.getCenterOfMassTransform();d.position.copy(t(f.getOrigin())),d.quaternion.copy(e(f.getRotation()))}},Y.prototype=Object.assign(Object.create(rt.prototype),{constructor:Y,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Ls,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),q.prototype=Object.assign(Object.create(rt.prototype),{constructor:q,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Ls,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Object.assign(Z.prototype,{evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{var o;n:{r:if(!(t<r)){for(var a=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,i)}if(n===a)break;if(i=r,r=e[++n],t<r)break e}o=e.length;break n}if(t>=i)break t;var s=e[1];t<s&&(n=2,i=s);for(a=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===a)break;if(r=i,i=e[--n-1],t>=i)break e}o=n,n=0}for(;n<o;){var l=n+o>>>1;t<e[l]?o=l:n=l+1}if(r=e[n],void 0===(i=e[n-1]))return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r,o=0;o!==r;++o)e[o]=n[i+o];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Z.prototype,{beforeStart_:Z.prototype.copySampleValue_,afterEnd_:Z.prototype.copySampleValue_}),Q.prototype=Object.assign(Object.create(Z.prototype),{constructor:Q,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,l=t*s,u=(n-e)/(r-e),c=l+s;l!==c;l+=4)o.slerpFlat(i,0,a,l-s,a,l,u);return i}}),J.prototype=Object.assign(Object.create(rt.prototype),{constructor:J,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new Q(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),K.prototype=Object.assign(Object.create(rt.prototype),{constructor:K,ValueTypeName:"color"}),$.prototype=Object.assign(Object.create(rt.prototype),{constructor:$,ValueTypeName:"vector"}),tt.prototype=Object.assign(Object.create(Z.prototype),{constructor:tt,DefaultSettings_:{endingStart:Is,endingEnd:Is},intervalChanged_:function(t,e,n){var r=this.parameterPositions,i=t-2,o=t+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:i=t,a=2*e-n;break;case 2402:a=e+r[i=r.length-2]-r[i+1];break;default:i=t,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:o=t,s=2*n-e;break;case 2402:o=1,s=n+r[1]-r[0];break;default:o=t-1,s=e}var l=.5*(n-e),u=this.valueSize;this._weightPrev=l/(e-a),this._weightNext=l/(s-n),this._offsetPrev=i*u,this._offsetNext=o*u},interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,l=s-a,u=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,p=this._weightNext,d=(n-e)/(r-e),f=d*d,m=f*d,v=-h*m+2*h*f-h*d,g=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*d+1,y=(-1-p)*m+(1.5+p)*f+.5*d,b=p*m-p*f,_=0;_!==a;++_)i[_]=v*o[u+_]+g*o[l+_]+y*o[s+_]+b*o[c+_];return i}}),et.prototype=Object.assign(Object.create(Z.prototype),{constructor:et,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,l=s-a,u=(n-e)/(r-e),c=1-u,h=0;h!==a;++h)i[h]=o[l+h]*c+o[s+h]*u;return i}}),nt.prototype=Object.assign(Object.create(Z.prototype),{constructor:nt,interpolate_:function(t){return this.copySampleValue_(t-1)}});var Js={arraySlice:function(t,e,n){return Js.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=new Array(e),r=0;r!==e;++r)n[r]=r;return n.sort(function(e,n){return t[e]-t[n]}),n},sortedArray:function(t,e,n){for(var r=t.length,i=new t.constructor(r),o=0,a=0;a!==r;++o)for(var s=n[o]*e,l=0;l!==e;++l)i[a++]=t[s+l];return i},flattenJSON:function(t,e,n,r){for(var i=1,o=t[0];void 0!==o&&void 0===o[r];)o=t[i++];if(void 0!==o){var a=o[r];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[r])&&(e.push(o.time),n.push.apply(n,a)),o=t[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[r])&&(e.push(o.time),a.toArray(n,n.length)),o=t[i++]}while(void 0!==o);else do{void 0!==(a=o[r])&&(e.push(o.time),n.push(a)),o=t[i++]}while(void 0!==o)}}};Object.assign(rt,{parse:function(t){if(void 0===t.type)throw new Error("KeyframeTrack: track type undefined, can not parse");var e=rt._getTrackTypeForValueTypeName(t.type);if(void 0===t.times){var n=[],r=[];Js.flattenJSON(t.keys,n,r,"value"),t.times=n,t.values=r}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)},toJSON:function(t){var e,n=t.constructor;if(void 0!==n.toJSON)e=n.toJSON(t);else{e={name:t.name,times:Js.convertArray(t.times,Array),values:Js.convertArray(t.values,Array)};var r=t.getInterpolation();r!==t.DefaultInterpolation&&(e.interpolation=r)}return e.type=t.ValueTypeName,e},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return it;case"vector":case"vector2":case"vector3":case"vector4":return $;case"color":return K;case"quaternion":return J;case"bool":case"boolean":return q;case"string":return Y}throw new Error("KeyframeTrack: Unsupported typeName: "+t)}}),Object.assign(rt.prototype,{constructor:rt,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new nt(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new et(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new tt(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case Ls:e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0!==e)this.createInterpolant=e;else{var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}console.warn("KeyframeTrack:",n)}},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ls;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]*=t;return this},trim:function(t,e){for(var n=this.times,r=n.length,i=0,o=r-1;i!==r&&n[i]<t;)++i;for(;-1!==o&&n[o]>e;)--o;if(++o,0!==i||o!==r){i>=o&&(i=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=Js.arraySlice(n,i,o),this.values=Js.arraySlice(this.values,i*a,o*a)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("KeyframeTrack: Invalid value size in track.",this),t=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("KeyframeTrack: Track is empty.",this),t=!1);for(var o=null,a=0;a!==i;a++){var s=n[a];if("number"==typeof s&&isNaN(s)){console.error("KeyframeTrack: Time is not a valid number.",this,a,s),t=!1;break}if(null!==o&&o>s){console.error("KeyframeTrack: Out of order keys.",this,a,s,o),t=!1;break}o=s}if(void 0!==r&&Js.isTypedArray(r)){a=0;for(var l=r.length;a!==l;++a){var u=r[a];if(isNaN(u)){console.error("KeyframeTrack: Value is not a valid number.",this,a,u),t=!1;break}}}return t},optimize:function(){for(var t=this.times,e=this.values,n=this.getValueSize(),r=2302===this.getInterpolation(),i=1,o=t.length-1,a=1;a<o;++a){var s=!1,l=t[a];if(l!==t[a+1]&&(1!==a||l!==l[0]))if(r)s=!0;else for(var u=a*n,c=u-n,h=u+n,p=0;p!==n;++p){var d=e[u+p];if(d!==e[c+p]||d!==e[h+p]){s=!0;break}}if(s){if(a!==i){t[i]=t[a];var f=a*n,m=i*n;for(p=0;p!==n;++p)e[m+p]=e[f+p]}++i}}if(o>0){t[i]=t[o];for(f=o*n,m=i*n,p=0;p!==n;++p)e[m+p]=e[f+p];++i}return i!==t.length&&(this.times=Js.arraySlice(t,0,i),this.values=Js.arraySlice(e,0,i*n)),this}}),it.prototype=Object.assign(Object.create(rt.prototype),{constructor:it,ValueTypeName:"number"}),Object.assign(ot,{parse:function(t){for(var e=[],n=t.tracks,r=1/(t.fps||1),i=0,o=n.length;i!==o;++i)e.push(rt.parse(n[i]).scale(r));return new ot(t.name,t.duration,e)},toJSON:function(t){for(var e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e},i=0,o=n.length;i!==o;++i)e.push(rt.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(t,e,n,r){for(var i=e.length,o=[],a=0;a<i;a++){var s=[],l=[];s.push((a+i-1)%i,a,(a+1)%i),l.push(0,1,0);var u=Js.getKeyframeOrder(s);s=Js.sortedArray(s,1,u),l=Js.sortedArray(l,1,u),r||0!==s[0]||(s.push(i),l.push(l[0])),o.push(new it(".morphTargetInfluences["+e[a].name+"]",s,l).scale(1/n))}return new ot(t,-1,o)},findByName:function(t,e){var n=t;if(!Array.isArray(t)){n=t.geometry&&t.geometry.animations||t.animations}for(var r=0;r<n.length;r++)if(n[r].name===e)return n[r];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,o=0,a=t.length;o<a;o++){var s=t[o],l=s.name.match(i);if(l&&l.length>1){var u=r[h=l[1]];u||(r[h]=u=[]),u.push(s)}}var c=[];for(var h in r)c.push(ot.CreateFromMorphTargetSequence(h,r[h],e,n));return c},parseAnimation:function(t,e){if(!t)return console.error("AnimationClip: No animation in JSONLoader data."),null;for(var n=function(t,e,n,r,i){if(0!==n.length){var o=[],a=[];Js.flattenJSON(n,o,a,r),0!==o.length&&i.push(new t(e,o,a))}},r=[],i=t.name||"default",o=t.length||-1,a=t.fps||30,s=t.hierarchy||[],l=0;l<s.length;l++){var u=s[l].keys;if(u&&0!==u.length)if(u[0].morphTargets){for(var c={},h=0;h<u.length;h++)if(u[h].morphTargets)for(var p=0;p<u[h].morphTargets.length;p++)c[u[h].morphTargets[p]]=-1;for(var d in c){var f=[],m=[];for(p=0;p!==u[h].morphTargets.length;++p){var v=u[h];f.push(v.time),m.push(v.morphTarget===d?1:0)}r.push(new it(".morphTargetInfluence["+d+"]",f,m))}o=c.length*(a||1)}else{var g=".bones["+e[l].name+"]";n($,g+".position",u,"pos",r),n(J,g+".quaternion",u,"rot",r),n($,g+".scale",u,"scl",r)}}if(0===r.length)return null;return new ot(i,o,r)}}),Object.assign(ot.prototype,{resetDuration:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e){var r=this.tracks[e];t=Math.max(t,r.times[r.times.length-1])}this.duration=t},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}});var Ks=function(){};Ks.CreateRotationAnimation=function(t,e){return new ot(null,t,[new it(".rotation["+(e=e||"x")+"]",[0,t],[0,360])])},Ks.CreateScaleAxisAnimation=function(t,e){return new ot(null,t,[new it(".scale["+(e=e||"x")+"]",[0,t],[0,1])])},Ks.CreateShakeAnimation=function(t,e){for(var n=[],r=[],o=new i,a=0;a<10*t;a++)n.push(a/10),o.set(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1).multiply(e).toArray(r,r.length);return new ot(null,t,[new $(".position",n,r)])},Ks.CreatePulsationAnimation=function(t,e){for(var n=[],r=[],o=new i,a=0;a<10*t;a++){n.push(a/10);var s=Math.random()*e;o.set(s,s,s).toArray(r,r.length)}return new ot(null,t,[new $(".scale",n,r)])},Ks.CreateVisibilityAnimation=function(t){return new ot(null,t,[new q(".visible",[0,t/2,t],[!0,!1,!0])])},Ks.CreateMaterialColorAnimation=function(t,e){for(var n=[],r=[],i=t/e.length,o=0;o<=e.length;o++)n.push(o*i),r.push(e[o%e.length]);return new ot(null,t,[new K(".material[0].color",n,r)])};at.prototype=Object.assign(Object.create(c.prototype),{constructor:at,isCamera:!0,copy:function(t,e){return c.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},getWorldDirection:function(){var t=new o;return function(e){return void 0===e&&(console.warn("Camera: .getWorldDirection() target is now required"),e=new i),this.getWorldQuaternion(t),e.set(0,0,-1).applyQuaternion(t)}}(),updateMatrixWorld:function(t){c.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),st.prototype=Object.assign(Object.create(at.prototype),{constructor:st,isPerspectiveCamera:!0,copy:function(t,e){return at.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*xo.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*xo.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*xo.RAD2DEG*Math.atan(Math.tan(.5*xo.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,r,i,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*xo.DEG2RAD*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/a,e-=o.offsetY*n/s,r*=o.width/a,n*=o.height/s}var l=this.filmOffset;0!==l&&(i+=t*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far)},toJSON:function(t){var e=c.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),(lt.prototype=Object.create(I.prototype)).constructor=lt,lt.prototype.isMeshDepthMaterial=!0,lt.prototype.copy=function(t){return I.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},ut.prototype=Object.assign(Object.create(c.prototype),{constructor:ut,copy:function(t,e){return c.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=c.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}),ct.prototype=Object.assign(Object.create(at.prototype),{constructor:ct,isOrthographicCamera:!0,copy:function(t,e){return at.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-t,o=n+t,a=r+e,s=r-e;if(null!==this.view&&this.view.enabled){var l=this.zoom/(this.view.width/this.view.fullWidth),u=this.zoom/(this.view.height/this.view.fullHeight),c=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;o=(i+=c*(this.view.offsetX/l))+c*(this.view.width/l),s=(a-=h*(this.view.offsetY/u))-h*(this.view.height/u)}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far)},toJSON:function(t){var e=c.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}});var $s=0;ht.DEFAULT_IMAGE=void 0,ht.DEFAULT_MAPPING=Ma,ht.prototype=Object.assign(Object.create(a.prototype),{constructor:ht,isTexture:!0,clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var r=this.image;void 0===r.uuid&&(r.uuid=xo.generateUUID()),e||void 0!==t.images[r.uuid]||(t.images[r.uuid]={uuid:r.uuid,url:function(t){var e;if(t instanceof HTMLCanvasElement)e=t;else{(e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=t.width,e.height=t.height;var n=e.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height)}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}(r)}),n.image=r.uuid}return e||(t.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping===Ma){if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Ia:t.x=t.x-Math.floor(t.x);break;case Da:t.x=t.x<0?0:1;break;case Fa:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Ia:t.y=t.y-Math.floor(t.y);break;case Da:t.y=t.y<0?0:1;break;case Fa:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}}),Object.defineProperty(ht.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),pt.prototype=Object.assign(Object.create(a.prototype),{constructor:pt,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var tl={merge:function(t){for(var e={},n=0;n<t.length;n++){var r=this.clone(t[n]);for(var i in r)e[i]=r[i]}return e},clone:function(t){var e={};for(var n in t){e[n]={};for(var r in t[n]){var i=t[n][r];e[n][r]=i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?i.clone():Array.isArray(i)?i.slice():i}}return e}};(dt.prototype=Object.create(I.prototype)).constructor=dt,dt.prototype.isShaderMaterial=!0,dt.prototype.copy=function(t){return I.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=tl.clone(t.uniforms),this.defines=t.defines,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},dt.prototype.toJSON=function(t){var e=I.prototype.toJSON.call(this,t);return e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e},(ft.prototype=Object.create(v.prototype)).constructor=ft,(mt.prototype=Object.create(O.prototype)).constructor=mt;var el={defines:{DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},aspect:{value:1},aperture:{value:.025},maxblur:{value:1},nearClip:{value:1},farClip:{value:1e3}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","uniform sampler2D tColor;","uniform sampler2D tDepth;","uniform float maxblur;","uniform float aperture;","uniform float nearClip;","uniform float farClip;","uniform float focus;","uniform float aspect;","#include <packing>","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, nearClip, farClip );","\t#else","\treturn orthographicDepthToViewZ( depth, nearClip, farClip );","\t#endif","}","void main() {","vec2 aspectcorrect = vec2( 1.0, aspect );","float viewZ = getViewZ( getDepth( vUv ) );","float factor = ( focus + viewZ );","vec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );","vec2 dofblur9 = dofblur * 0.9;","vec2 dofblur7 = dofblur * 0.7;","vec2 dofblur4 = dofblur * 0.4;","vec4 col = vec4( 0.0 );","col += texture2D( tColor, vUv.xy );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );","gl_FragColor = col / 41.0;","gl_FragColor.a = 1.0;","}"].join("\n")},nl=function(t,e,n,r){st.call(this,t,e,n,r),this.type="CinematicCamera",this.postprocessing={enabled:!0},this.shaderSettings={rings:3,samples:4},this.material_depth=new lt,this.setLens(),this.initPostProcessing()};(nl.prototype=Object.create(st.prototype)).constructor=nl,nl.prototype.setLens=function(t,e,n,r){void 0===t&&(t=35),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t),void 0===n&&(n=8),void 0===r&&(r=.019),this.fNumber=n,this.coc=r,this.aperture=t/this.fNumber,this.hyperFocal=t*t/(this.aperture*this.coc)},nl.prototype.linearize=function(t){var e=this.far,n=this.near;return-e*n/(t*(e-n)-e)},nl.prototype.smoothstep=function(t,e,n){var r=this.saturate((n-t)/(e-t));return r*r*(3-2*r)},nl.prototype.saturate=function(t){return Math.max(0,Math.min(1,t))},nl.prototype.focusAt=function(t){void 0===t&&(t=20);var e=this.getFocalLength();this.focus=t,this.nearPoint=this.hyperFocal*this.focus/(this.hyperFocal+(this.focus-e)),this.farPoint=this.hyperFocal*this.focus/(this.hyperFocal-(this.focus-e)),this.depthOfField=this.farPoint-this.nearPoint,this.depthOfField<0&&(this.depthOfField=0),this.sdistance=this.smoothstep(this.near,this.far,this.focus),this.ldistance=this.linearize(1-this.sdistance),this.postprocessing.bokeh_uniforms.focalDepth.value=this.ldistance},nl.prototype.initPostProcessing=function(){if(this.postprocessing.enabled){this.postprocessing.scene=new ut,this.postprocessing.camera=new ct(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,-1e4,1e4),this.postprocessing.scene.add(this.postprocessing.camera);var t={minFilter:ja,magFilter:ja,format:es};this.postprocessing.rtTextureDepth=new pt(window.innerWidth,window.innerHeight,t),this.postprocessing.rtTextureColor=new pt(window.innerWidth,window.innerHeight,t);var e=el;this.postprocessing.bokeh_uniforms=tl.clone(e.uniforms),this.postprocessing.bokeh_uniforms.tColor.value=this.postprocessing.rtTextureColor.texture,this.postprocessing.bokeh_uniforms.tDepth.value=this.postprocessing.rtTextureDepth.texture,this.postprocessing.bokeh_uniforms.manualdof.value=0,this.postprocessing.bokeh_uniforms.shaderFocus.value=0,this.postprocessing.bokeh_uniforms.fstop.value=2.8,this.postprocessing.bokeh_uniforms.showFocus.value=1,this.postprocessing.bokeh_uniforms.focalDepth.value=.1,this.postprocessing.bokeh_uniforms.znear.value=this.near,this.postprocessing.bokeh_uniforms.zfar.value=this.near,this.postprocessing.bokeh_uniforms.textureWidth.value=window.innerWidth,this.postprocessing.bokeh_uniforms.textureHeight.value=window.innerHeight,this.postprocessing.materialBokeh=new dt({uniforms:this.postprocessing.bokeh_uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,defines:{RINGS:this.shaderSettings.rings,SAMPLES:this.shaderSettings.samples}}),this.postprocessing.quad=new B(new mt(window.innerWidth,window.innerHeight),this.postprocessing.materialBokeh),this.postprocessing.quad.position.z=-500,this.postprocessing.scene.add(this.postprocessing.quad)}},nl.prototype.renderCinematic=function(t,e){this.postprocessing.enabled&&(e.clear(),t.overrideMaterial=null,e.render(t,camera,this.postprocessing.rtTextureColor,!0),t.overrideMaterial=this.material_depth,e.render(t,camera,this.postprocessing.rtTextureDepth,!0),e.render(this.postprocessing.scene,this.postprocessing.camera))};var rl={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},il=new vt,ol={};Object.assign(gt.prototype,{load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=rl.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o;if(void 0===ol[t]){var a=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(a){var s=a[1],l=!!a[2],u=a[3];u=window.decodeURIComponent(u),l&&(u=window.atob(u));try{var c,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var p=new Uint8Array(u.length),d=0;d<u.length;d++)p[d]=u.charCodeAt(d);c="blob"===h?new Blob([p.buffer],{type:s}):p.buffer;break;case"document":var f=new DOMParser;c=f.parseFromString(u,s);break;case"json":c=JSON.parse(u);break;default:c=u}window.setTimeout(function(){e&&e(c),i.manager.itemEnd(t)},0)}catch(e){window.setTimeout(function(){r&&r(e),i.manager.itemEnd(t),i.manager.itemError(t)},0)}}else{ol[t]=[],ol[t].push({onLoad:e,onProgress:n,onError:r});var m=new XMLHttpRequest;m.open("GET",t,!0),m.addEventListener("load",function(e){var n=this.response;rl.add(t,n);var r=ol[t];if(delete ol[t],200===this.status){for(var o=0,a=r.length;o<a;o++){(s=r[o]).onLoad&&s.onLoad(n)}i.manager.itemEnd(t)}else if(0===this.status){console.warn("FileLoader: HTTP Status 0 received.");for(o=0,a=r.length;o<a;o++){(s=r[o]).onLoad&&s.onLoad(n)}i.manager.itemEnd(t)}else{for(o=0,a=r.length;o<a;o++){var s;(s=r[o]).onError&&s.onError(e)}i.manager.itemEnd(t),i.manager.itemError(t)}},!1),m.addEventListener("progress",function(e){for(var n=ol[t],r=0,i=n.length;r<i;r++){var o=n[r];o.onProgress&&o.onProgress(e)}},!1),m.addEventListener("error",function(e){var n=ol[t];delete ol[t];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(e)}i.manager.itemEnd(t),i.manager.itemError(t)},!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(var v in this.requestHeader)m.setRequestHeader(v,this.requestHeader[v]);m.send(null)}return i.manager.itemStart(t),m}ol[t].push({onLoad:e,onProgress:n,onError:r})},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),(yt.prototype=Object.create(F.prototype)).constructor=yt,yt.prototype.isLineDashedMaterial=!0,yt.prototype.copy=function(t){return F.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this},(bt.prototype=Object.create(I.prototype)).constructor=bt,bt.prototype.isMeshDistanceMaterial=!0,bt.prototype.copy=function(t){return I.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},(_t.prototype=Object.create(I.prototype)).constructor=_t,_t.prototype.isMeshLambertMaterial=!0,_t.prototype.copy=function(t){return I.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(xt.prototype=Object.create(I.prototype)).constructor=xt,xt.prototype.isMeshNormalMaterial=!0,xt.prototype.copy=function(t){return I.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(wt.prototype=Object.create(I.prototype)).constructor=wt,wt.prototype.isMeshPhongMaterial=!0,wt.prototype.copy=function(t){return I.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(St.prototype=Object.create(I.prototype)).constructor=St,St.prototype.isMeshStandardMaterial=!0,St.prototype.copy=function(t){return I.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(At.prototype=Object.create(St.prototype)).constructor=At,At.prototype.isMeshPhysicalMaterial=!0,At.prototype.copy=function(t){return St.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},(Mt.prototype=Object.create(wt.prototype)).constructor=Mt,Mt.prototype.isMeshToonMaterial=!0,Mt.prototype.copy=function(t){return wt.prototype.copy.call(this,t),this.gradientMap=t.gradientMap,this},(Tt.prototype=Object.create(I.prototype)).constructor=Tt,Tt.prototype.isPointsMaterial=!0,Tt.prototype.copy=function(t){return I.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this},(Ct.prototype=Object.create(dt.prototype)).constructor=Ct,Ct.prototype.isRawShaderMaterial=!0,(Et.prototype=Object.create(I.prototype)).constructor=Et,Et.prototype.isShadowMaterial=!0,Et.prototype.copy=function(t){return I.prototype.copy.call(this,t),this.color.copy(t.color),this},(Pt.prototype=Object.create(I.prototype)).constructor=Pt,Pt.prototype.isSpriteMaterial=!0,Pt.prototype.copy=function(t){return I.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this},Object.assign(Ot.prototype,{load:function(t,e,n,r){var i=this;new gt(i.manager).load(t,function(t){e(i.parse(JSON.parse(t)))},n,r)},setTextures:function(t){this.textures=t},parse:function(t){function e(t){return void 0===n[t]&&console.warn("MaterialLoader: Undefined texture",t),n[t]}var n=this.textures,r=new{LineBasicMaterial:F,LineDashedMaterial:yt,MeshBasicMaterial:D,MeshDepthMaterial:lt,MeshDistanceMaterial:bt,MeshLambertMaterial:_t,MeshNormalMaterial:xt,MeshPhongMaterial:wt,MeshPhysicalMaterial:At,MeshStandardMaterial:St,MeshToonMaterial:Mt,PointsMaterial:Tt,RawShaderMaterial:Ct,ShaderMaterial:dt,ShadowMaterial:Et,SpriteMaterial:Pt}[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearCoat&&(r.clearCoat=t.clearCoat),void 0!==t.clearCoatRoughness&&(r.clearCoatRoughness=t.clearCoatRoughness),void 0!==t.uniforms&&(r.uniforms=t.uniforms),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(r.vertexColors=t.vertexColors),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.polygonOffset&&(r.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(r.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(r.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.shading&&(r.flatShading=1===t.shading),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=e(t.map)),void 0!==t.alphaMap&&(r.alphaMap=e(t.alphaMap),r.transparent=!0),void 0!==t.bumpMap&&(r.bumpMap=e(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=e(t.normalMap)),void 0!==t.normalScale){var i=t.normalScale;!1===Array.isArray(i)&&(i=[i,i]),r.normalScale=(new m).fromArray(i)}return void 0!==t.displacementMap&&(r.displacementMap=e(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=e(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=e(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=e(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=e(t.specularMap)),void 0!==t.envMap&&(r.envMap=e(t.envMap)),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.lightMap&&(r.lightMap=e(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=e(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=e(t.gradientMap)),r}}),Object.assign(Nt.prototype,{crossOrigin:"Anonymous",load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=rl.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");return a.addEventListener("load",function(){rl.add(t,this),e&&e(this),i.manager.itemEnd(t)},!1),a.addEventListener("error",function(e){r&&r(e),i.manager.itemEnd(t),i.manager.itemError(t)},!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(t),a.src=t,a},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Lt.prototype,{crossOrigin:"Anonymous",load:function(t,e,n,r){var i=new ht,o=new Nt(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,function(n){i.image=n;var r=t.search(/\.(jpg|jpeg)$/)>0||0===t.search(/^data\:image\/jpeg/);i.format=r?es:ns,i.needsUpdate=!0,void 0!==e&&e(i)},n,r),i},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),It.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,n=0,r=e.length;n<r;n+=2){var i=e[n+1];if(e[n].test(t))return i}return null}},Object.assign(It.prototype,{crossOrigin:void 0,onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(t,e,n){for(var r=[],i=0;i<t.length;++i)r[i]=this.createMaterial(t[i],e,n);return r},createMaterial:function(){var t={NoBlending:zo,NormalBlending:Vo,AdditiveBlending:Go,SubtractiveBlending:Ho,MultiplyBlending:Wo,CustomBlending:Xo},e=new h,n=new Lt,r=new Ot;return function(i,o,a){function s(t,e,r,i,s){var u,c=o+t,h=It.Handlers.get(c);null!==h?u=h.load(c):(n.setCrossOrigin(a),u=n.load(c)),void 0!==e&&(u.repeat.fromArray(e),1!==e[0]&&(u.wrapS=Ia),1!==e[1]&&(u.wrapT=Ia)),void 0!==r&&u.offset.fromArray(r),void 0!==i&&("repeat"===i[0]&&(u.wrapS=Ia),"mirror"===i[0]&&(u.wrapS=Fa),"repeat"===i[1]&&(u.wrapT=Ia),"mirror"===i[1]&&(u.wrapT=Fa)),void 0!==s&&(u.anisotropy=s);var p=xo.generateUUID();return l[p]=u,p}var l={},u={uuid:xo.generateUUID(),type:"MeshLambertMaterial"};for(var c in i){var h=i[c];switch(c){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":u.name=h;break;case"blending":u.blending=t[h];break;case"colorAmbient":case"mapAmbient":console.warn("Loader.createMaterial:",c,"is no longer supported.");break;case"colorDiffuse":u.color=e.fromArray(h).getHex();break;case"colorSpecular":u.specular=e.fromArray(h).getHex();break;case"colorEmissive":u.emissive=e.fromArray(h).getHex();break;case"specularCoef":u.shininess=h;break;case"shading":"basic"===h.toLowerCase()&&(u.type="MeshBasicMaterial"),"phong"===h.toLowerCase()&&(u.type="MeshPhongMaterial"),"standard"===h.toLowerCase()&&(u.type="MeshStandardMaterial");break;case"mapDiffuse":u.map=s(h,i.mapDiffuseRepeat,i.mapDiffuseOffset,i.mapDiffuseWrap,i.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":u.emissiveMap=s(h,i.mapEmissiveRepeat,i.mapEmissiveOffset,i.mapEmissiveWrap,i.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":u.lightMap=s(h,i.mapLightRepeat,i.mapLightOffset,i.mapLightWrap,i.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":u.aoMap=s(h,i.mapAORepeat,i.mapAOOffset,i.mapAOWrap,i.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":u.bumpMap=s(h,i.mapBumpRepeat,i.mapBumpOffset,i.mapBumpWrap,i.mapBumpAnisotropy);break;case"mapBumpScale":u.bumpScale=h;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":u.normalMap=s(h,i.mapNormalRepeat,i.mapNormalOffset,i.mapNormalWrap,i.mapNormalAnisotropy);break;case"mapNormalFactor":u.normalScale=h;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":u.specularMap=s(h,i.mapSpecularRepeat,i.mapSpecularOffset,i.mapSpecularWrap,i.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":u.metalnessMap=s(h,i.mapMetalnessRepeat,i.mapMetalnessOffset,i.mapMetalnessWrap,i.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":u.roughnessMap=s(h,i.mapRoughnessRepeat,i.mapRoughnessOffset,i.mapRoughnessWrap,i.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":u.alphaMap=s(h,i.mapAlphaRepeat,i.mapAlphaOffset,i.mapAlphaWrap,i.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":u.side=Ro;break;case"doubleSided":u.side=ko;break;case"transparency":console.warn("Loader.createMaterial: transparency has been renamed to opacity"),u.opacity=h;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":u[c]=h;break;case"vertexColors":!0===h&&(u.vertexColors=Bo),"face"===h&&(u.vertexColors=jo);break;default:console.error("Loader.createMaterial: Unsupported",c,h)}}return"MeshBasicMaterial"===u.type&&delete u.emissive,"MeshPhongMaterial"!==u.type&&delete u.specular,u.opacity<1&&(u.transparent=!0),r.setTextures(l),r.parse(u)}}()});var al={decodeText:function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);return decodeURIComponent(escape(e))},extractUrlBase:function(t){var e=t.split("/");return 1===e.length?"./":(e.pop(),e.join("/")+"/")}};Object.assign(Dt.prototype,{load:function(t,e,n,r){var i=this,o=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:al.extractUrlBase(t),a=new gt(this.manager);a.setWithCredentials(this.withCredentials),a.load(t,function(n){var r=JSON.parse(n),a=r.metadata;if(void 0!==a){var s=a.type;if(void 0!==s&&"object"===s.toLowerCase())return void console.error("JSONLoader: "+t+" should be loaded with ObjectLoader instead.")}var l=i.parse(r,o);e(l.geometry,l.materials)},n,r)},setTexturePath:function(t){this.texturePath=t},parse:function(){return function(t,e){void 0!==t.data&&(t=t.data),t.scale=void 0!==t.scale?1/t.scale:1;var n=new v;if(function(t,e){function n(t,e){return t&1<<e}var r,o,a,s,l,u,c,d,f,v,g,y,b,_,x,w,S,A,M,T,C,E,P,O,N,L=t.faces,I=t.vertices,D=t.normals,F=t.colors,R=t.scale,k=0;if(void 0!==t.uvs){for(r=0;r<t.uvs.length;r++)t.uvs[r].length&&k++;for(r=0;r<k;r++)e.faceVertexUvs[r]=[]}for(s=0,l=I.length;s<l;)(A=new i).x=I[s++]*R,A.y=I[s++]*R,A.z=I[s++]*R,e.vertices.push(A);for(s=0,l=L.length;s<l;)if(v=L[s++],g=n(v,0),y=n(v,1),b=n(v,3),_=n(v,4),x=n(v,5),w=n(v,6),S=n(v,7),g){if(T=new p,T.a=L[s],T.b=L[s+1],T.c=L[s+3],C=new p,C.a=L[s+1],C.b=L[s+2],C.c=L[s+3],s+=4,y&&(f=L[s++],T.materialIndex=f,C.materialIndex=f),a=e.faces.length,b)for(r=0;r<k;r++)for(O=t.uvs[r],e.faceVertexUvs[r][a]=[],e.faceVertexUvs[r][a+1]=[],o=0;o<4;o++)N=new m(O[2*(d=L[s++])],O[2*d+1]),2!==o&&e.faceVertexUvs[r][a].push(N),0!==o&&e.faceVertexUvs[r][a+1].push(N);if(_&&(c=3*L[s++],T.normal.set(D[c++],D[c++],D[c]),C.normal.copy(T.normal)),x)for(r=0;r<4;r++)c=3*L[s++],P=new i(D[c++],D[c++],D[c]),2!==r&&T.vertexNormals.push(P),0!==r&&C.vertexNormals.push(P);if(w&&(u=L[s++],T.color.setHex(E=F[u]),C.color.setHex(E)),S)for(r=0;r<4;r++)E=F[u=L[s++]],2!==r&&T.vertexColors.push(new h(E)),0!==r&&C.vertexColors.push(new h(E));e.faces.push(T),e.faces.push(C)}else{if(M=new p,M.a=L[s++],M.b=L[s++],M.c=L[s++],y&&(f=L[s++],M.materialIndex=f),a=e.faces.length,b)for(r=0;r<k;r++)for(O=t.uvs[r],e.faceVertexUvs[r][a]=[],o=0;o<3;o++)N=new m(O[2*(d=L[s++])],O[2*d+1]),e.faceVertexUvs[r][a].push(N);if(_&&(c=3*L[s++],M.normal.set(D[c++],D[c++],D[c])),x)for(r=0;r<3;r++)c=3*L[s++],P=new i(D[c++],D[c++],D[c]),M.vertexNormals.push(P);if(w&&(u=L[s++],M.color.setHex(F[u])),S)for(r=0;r<3;r++)u=L[s++],M.vertexColors.push(new h(F[u]));e.faces.push(M)}}(t,n),function(t,e){var n=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var r=0,i=t.skinWeights.length;r<i;r+=n)e.skinWeights.push(new g(t.skinWeights[r],n>1?t.skinWeights[r+1]:0,n>2?t.skinWeights[r+2]:0,n>3?t.skinWeights[r+3]:0));if(t.skinIndices)for(r=0,i=t.skinIndices.length;r<i;r+=n)e.skinIndices.push(new g(t.skinIndices[r],n>1?t.skinIndices[r+1]:0,n>2?t.skinIndices[r+2]:0,n>3?t.skinIndices[r+3]:0));e.bones=t.bones,e.bones&&e.bones.length>0&&(e.skinWeights.length!==e.skinIndices.length||e.skinIndices.length!==e.vertices.length)&&console.warn("When skinning, number of vertices ("+e.vertices.length+"), skinIndices ("+e.skinIndices.length+"), and skinWeights ("+e.skinWeights.length+") should match.")}(t,n),function(t,e){var n=t.scale;if(void 0!==t.morphTargets)for(var r=0,o=t.morphTargets.length;r<o;r++){e.morphTargets[r]={},e.morphTargets[r].name=t.morphTargets[r].name,e.morphTargets[r].vertices=[];for(var a=e.morphTargets[r].vertices,s=t.morphTargets[r].vertices,l=0,u=s.length;l<u;l+=3){var c=new i;c.x=s[l]*n,c.y=s[l+1]*n,c.z=s[l+2]*n,a.push(c)}}if(void 0!==t.morphColors&&t.morphColors.length>0){console.warn('JSONLoader: "morphColors" no longer supported. Using them as face colors.');var h=e.faces,p=t.morphColors[0].colors;for(r=0,o=h.length;r<o;r++)h[r].color.fromArray(p,3*r)}}(t,n),function(t,e){var n=[],r=[];void 0!==t.animation&&r.push(t.animation),void 0!==t.animations&&(t.animations.length?r=r.concat(t.animations):r.push(t.animations));for(var i=0;i<r.length;i++){var o=ot.parseAnimation(r[i],e.bones);o&&n.push(o)}if(e.morphTargets){var a=ot.CreateClipsFromMorphTargetSequences(e.morphTargets,10);n=n.concat(a)}n.length>0&&(e.animations=n)}(t,n),n.computeFaceNormals(),n.computeBoundingSphere(),void 0===t.materials||0===t.materials.length)return{geometry:n};return{geometry:n,materials:It.prototype.initMaterials(t.materials,e,this.crossOrigin)}}}()});var sl=function(t){"boolean"==typeof t&&(console.warn("BinaryLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:il};sl.prototype={constructor:sl,crossOrigin:"Anonymous",load:function(t,e,n,r){var i=this.texturePath||al.extractUrlBase(t),o=this.binaryPath||al.extractUrlBase(t),a=this;new gt(this.manager).load(t,function(t){var s=JSON.parse(t),l=o+s.buffers,u=new gt(a.manager);u.setResponseType("arraybuffer"),u.load(l,function(t){a.parse(t,e,i,s.materials)},n,r)},n,r)},setBinaryPath:function(t){this.binaryPath=t},setCrossOrigin:function(t){this.crossOrigin=t},setTexturePath:function(t){this.texturePath=t},parse:function(t,e,n,r){var o=function(){function e(t){return t%4?4-t%4:0}function n(t,e){return new Uint8Array(t,e,1)[0]}function r(t,e){return new Uint32Array(t,e,1)[0]}function o(e,n){var r,i,o,a,s,l,u,c,h=new Uint32Array(t,n,3*e);for(r=0;r<e;r++)s=F[2*(o=h[3*r+1])],u=F[2*o+1],l=F[2*(a=h[3*r+2])],c=F[2*a+1],L.faceVertexUvs[0].push([new m(F[2*(i=h[3*r])],F[2*i+1]),new m(s,u),new m(l,c)])}function a(e,n){var r,i,o,a,s,l,u,c,h,p,d,f=new Uint32Array(t,n,4*e);for(r=0;r<e;r++)l=F[2*(o=f[4*r+1])],h=F[2*o+1],u=F[2*(a=f[4*r+2])],p=F[2*a+1],c=F[2*(s=f[4*r+3])],d=F[2*s+1],L.faceVertexUvs[0].push([new m(F[2*(i=f[4*r])],F[2*i+1]),new m(l,h),new m(c,d)]),L.faceVertexUvs[0].push([new m(l,h),new m(u,p),new m(c,d)])}function s(e,n,r){var i,o=new Uint32Array(t,n,3*e),a=new Uint16Array(t,r,e);for(i=0;i<e;i++)L.faces.push(new p(o[3*i],o[3*i+1],o[3*i+2],null,null,a[i]))}function l(e,n,r){var i,o,a,s,l,u=new Uint32Array(t,n,4*e),c=new Uint16Array(t,r,e);for(i=0;i<e;i++)a=u[4*i+2],L.faces.push(new p(u[4*i],o=u[4*i+1],s=u[4*i+3],null,null,l=c[i])),L.faces.push(new p(o,a,s,null,null,l))}function u(e,n,r,o){var a,s,l,u,c,h=new Uint32Array(t,n,3*e),d=new Uint32Array(t,r,3*e),f=new Uint16Array(t,o,e);for(a=0;a<e;a++){s=f[a];var m=D[3*(u=d[3*a+1])],v=D[3*u+1],g=D[3*u+2],y=D[3*(c=d[3*a+2])],b=D[3*c+1],_=D[3*c+2];L.faces.push(new p(h[3*a],h[3*a+1],h[3*a+2],[new i(D[3*(l=d[3*a])],D[3*l+1],D[3*l+2]),new i(m,v,g),new i(y,b,_)],null,s))}}function c(e,n,r,o){var a,s,l,u,c,h,d,f,m,v=new Uint32Array(t,n,4*e),g=new Uint32Array(t,r,4*e),y=new Uint16Array(t,o,e);for(a=0;a<e;a++){l=v[4*a+2],c=y[a];var b=D[3*(d=g[4*a+1])],_=D[3*d+1],x=D[3*d+2],w=D[3*(f=g[4*a+2])],S=D[3*f+1],A=D[3*f+2],M=D[3*(m=g[4*a+3])],T=D[3*m+1],C=D[3*m+2];L.faces.push(new p(v[4*a],s=v[4*a+1],u=v[4*a+3],[new i(D[3*(h=g[4*a])],D[3*h+1],D[3*h+2]),new i(b,_,x),new i(M,T,C)],null,c)),L.faces.push(new p(s,l,u,[new i(b,_,x),new i(w,S,A),new i(M,T,C)],null,c))}}var h,d,f,g,y,b,_,x,w,S,A,M,T,C,E,P,O,N,L=this,I=0,D=[],F=[];v.call(this),I+=(h=function(t,e){return{signature:function(t,e,n){return al.decodeText(new Uint8Array(t,e,n))}(t,e,12),header_bytes:n(t,e+12),vertex_coordinate_bytes:n(t,e+13),normal_coordinate_bytes:n(t,e+14),uv_coordinate_bytes:n(t,e+15),vertex_index_bytes:n(t,e+16),normal_index_bytes:n(t,e+17),uv_index_bytes:n(t,e+18),material_index_bytes:n(t,e+19),nvertices:r(t,e+20),nnormals:r(t,e+20+4),nuvs:r(t,e+20+8),ntri_flat:r(t,e+20+12),ntri_smooth:r(t,e+20+16),ntri_flat_uv:r(t,e+20+20),ntri_smooth_uv:r(t,e+20+24),nquad_flat:r(t,e+20+28),nquad_smooth:r(t,e+20+32),nquad_flat_uv:r(t,e+20+36),nquad_smooth_uv:r(t,e+20+40)}}(t,I)).header_bytes,M=h.ntri_flat*(S=3*h.vertex_index_bytes+h.material_index_bytes),T=h.ntri_smooth*(S+3*h.normal_index_bytes),C=h.ntri_flat_uv*(S+3*h.uv_index_bytes),E=h.ntri_smooth_uv*(S+3*h.normal_index_bytes+3*h.uv_index_bytes),P=h.nquad_flat*(A=4*h.vertex_index_bytes+h.material_index_bytes),O=h.nquad_smooth*(A+4*h.normal_index_bytes),N=h.nquad_flat_uv*(A+4*h.uv_index_bytes),I+=function(e){var n,r=h.nvertices,o=new Float32Array(t,e,3*r);for(n=0;n<r;n++)L.vertices.push(new i(o[3*n],o[3*n+1],o[3*n+2]));return 3*r*Float32Array.BYTES_PER_ELEMENT}(I),I+=function(e){var n=h.nnormals;if(n){var r,i=new Int8Array(t,e,3*n);for(r=0;r<n;r++)D.push(i[3*r]/127,i[3*r+1]/127,i[3*r+2]/127)}return 3*n*Int8Array.BYTES_PER_ELEMENT}(I),I+=e(3*h.nnormals),w=(x=(_=(b=(y=(g=(f=(d=I+=function(e){var n=h.nuvs;if(n){var r,i=new Float32Array(t,e,2*n);for(r=0;r<n;r++)F.push(i[2*r],i[2*r+1])}return 2*n*Float32Array.BYTES_PER_ELEMENT}(I))+M+e(2*h.ntri_flat))+T+e(2*h.ntri_smooth))+C+e(2*h.ntri_flat_uv))+E+e(2*h.ntri_smooth_uv))+P+e(2*h.nquad_flat))+O+e(2*h.nquad_smooth))+N+e(2*h.nquad_flat_uv),function(t){var e=h.ntri_flat_uv;if(e){var n=t+e*Uint32Array.BYTES_PER_ELEMENT*3;s(e,t,n+e*Uint32Array.BYTES_PER_ELEMENT*3),o(e,n)}}(g),function(t){var e=h.ntri_smooth_uv;if(e){var n=t+e*Uint32Array.BYTES_PER_ELEMENT*3,r=n+e*Uint32Array.BYTES_PER_ELEMENT*3;u(e,t,n,r+e*Uint32Array.BYTES_PER_ELEMENT*3),o(e,r)}}(y),function(t){var e=h.nquad_flat_uv;if(e){var n=t+e*Uint32Array.BYTES_PER_ELEMENT*4;l(e,t,n+e*Uint32Array.BYTES_PER_ELEMENT*4),a(e,n)}}(x),function(t){var e=h.nquad_smooth_uv;if(e){var n=t+e*Uint32Array.BYTES_PER_ELEMENT*4,r=n+e*Uint32Array.BYTES_PER_ELEMENT*4;c(e,t,n,r+e*Uint32Array.BYTES_PER_ELEMENT*4),a(e,r)}}(w),function(t){var e=h.ntri_flat;e&&s(e,t,t+e*Uint32Array.BYTES_PER_ELEMENT*3)}(d),function(t){var e=h.ntri_smooth;if(e){var n=t+e*Uint32Array.BYTES_PER_ELEMENT*3;u(e,t,n,n+e*Uint32Array.BYTES_PER_ELEMENT*3)}}(f),function(t){var e=h.nquad_flat;e&&l(e,t,t+e*Uint32Array.BYTES_PER_ELEMENT*4)}(b),function(t){var e=h.nquad_smooth;if(e){var n=t+e*Uint32Array.BYTES_PER_ELEMENT*4;c(e,t,n,n+e*Uint32Array.BYTES_PER_ELEMENT*4)}}(_),this.computeFaceNormals()};(o.prototype=Object.create(v.prototype)).constructor=o;e(new o,It.prototype.initMaterials(r,n,this.crossOrigin))}};Object.assign(Ft.prototype,{linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("Raycaster: Unsupported camera type.")},intersectObject:function(t,e,n){var r=n||[];return kt(t,this,r,e),r.sort(Rt),r},intersectObjects:function(t,e,n){var r=n||[];if(!1===Array.isArray(t))return console.warn("Raycaster.intersectObjects: objects is not an Array."),r;for(var i=0,o=t.length;i<o;i++)kt(t[i],this,r,e);return r.sort(Rt),r}});var ll=function(t,e,n){function r(){n.addEventListener("mousemove",a,!1),n.addEventListener("mousedown",s,!1),n.addEventListener("mouseup",l,!1),n.addEventListener("mouseleave",l,!1),n.addEventListener("touchmove",u,!1),n.addEventListener("touchstart",c,!1),n.addEventListener("touchend",h,!1)}function o(){n.removeEventListener("mousemove",a,!1),n.removeEventListener("mousedown",s,!1),n.removeEventListener("mouseup",l,!1),n.removeEventListener("mouseleave",l,!1),n.removeEventListener("touchmove",u,!1),n.removeEventListener("touchstart",c,!1),n.removeEventListener("touchend",h,!1)}function a(r){r.preventDefault();var i=n.getBoundingClientRect();if(v.x=(r.clientX-i.left)/i.width*2-1,v.y=-(r.clientY-i.top)/i.height*2+1,f.setFromCamera(v,e),b&&x.enabled)return f.ray.intersectPlane(d,y)&&b.position.copy(y.sub(g)),void x.dispatchEvent({type:"drag",object:b});f.setFromCamera(v,e);var o=f.intersectObjects(t);if(o.length>0){var a=o[0].object;d.setFromNormalAndCoplanarPoint(e.getWorldDirection(d.normal),a.position),_!==a&&(x.dispatchEvent({type:"hoveron",object:a}),n.style.cursor="pointer",_=a)}else null!==_&&(x.dispatchEvent({type:"hoveroff",object:_}),n.style.cursor="auto",_=null)}function s(r){r.preventDefault(),f.setFromCamera(v,e);var i=f.intersectObjects(t);i.length>0&&(b=i[0].object,f.ray.intersectPlane(d,y)&&g.copy(y).sub(b.position),n.style.cursor="move",x.dispatchEvent({type:"dragstart",object:b}))}function l(t){t.preventDefault(),b&&(x.dispatchEvent({type:"dragend",object:b}),b=null),n.style.cursor="auto"}function u(t){t.preventDefault(),t=t.changedTouches[0];var r=n.getBoundingClientRect();if(v.x=(t.clientX-r.left)/r.width*2-1,v.y=-(t.clientY-r.top)/r.height*2+1,f.setFromCamera(v,e),b&&x.enabled)return f.ray.intersectPlane(d,y)&&b.position.copy(y.sub(g)),void x.dispatchEvent({type:"drag",object:b})}function c(r){r.preventDefault(),r=r.changedTouches[0];var i=n.getBoundingClientRect();v.x=(r.clientX-i.left)/i.width*2-1,v.y=-(r.clientY-i.top)/i.height*2+1,f.setFromCamera(v,e);var o=f.intersectObjects(t);o.length>0&&(b=o[0].object,d.setFromNormalAndCoplanarPoint(e.getWorldDirection(d.normal),b.position),f.ray.intersectPlane(d,y)&&g.copy(y).sub(b.position),n.style.cursor="move",x.dispatchEvent({type:"dragstart",object:b}))}function h(t){t.preventDefault(),b&&(x.dispatchEvent({type:"dragend",object:b}),b=null),n.style.cursor="auto"}if(t instanceof at){console.warn("DragControls: Constructor now expects ( objects, camera, domElement )");var p=t;t=e,e=p}var d=new U,f=new Ft,v=new m,g=new i,y=new i,b=null,_=null,x=this;r(),this.enabled=!0,this.activate=r,this.deactivate=o,this.dispose=function(){o()},this.setObjects=function(){console.error("DragControls: setObjects() has been removed.")},this.on=function(t,e){console.warn("DragControls: on() has been deprecated. Use addEventListener() instead."),x.addEventListener(t,e)},this.off=function(t,e){console.warn("DragControls: off() has been deprecated. Use removeEventListener() instead."),x.removeEventListener(t,e)},this.notify=function(t){console.error("DragControls: notify() has been deprecated. Use dispatchEvent() instead."),x.dispatchEvent({type:t})}};(ll.prototype=Object.create(a.prototype)).constructor=ll,Object.assign(Ut.prototype,{set:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.radius=t.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t.x,t.z),this.phi=Math.acos(xo.clamp(t.y/this.radius,-1,1))),this}});var ul=function(t,e){function n(t){!1!==h.enabled&&(0===t.button?v=f.ROTATE:1===t.button?v=f.ZOOM:2===t.button&&(v=f.PAN),_.set(t.clientX,t.clientY),e.addEventListener("mousemove",r,!1),e.addEventListener("mouseup",o,!1),e.addEventListener("mouseout",o,!1),e.addEventListener("dblclick",o,!1))}function r(t){if(!1!==h.enabled){b.set(t.clientX,t.clientY);var e=b.x-_.x,n=b.y-_.y;v===f.ROTATE?h.rotate(new i(-e*h.rotationSpeed,-n*h.rotationSpeed,0)):v===f.ZOOM?h.zoom(new i(0,0,n)):v===f.PAN&&h.pan(new i(-e,n,0)),_.set(t.clientX,t.clientY)}}function o(t){e.removeEventListener("mousemove",r,!1),e.removeEventListener("mouseup",o,!1),e.removeEventListener("mouseout",o,!1),e.removeEventListener("dblclick",o,!1),v=f.NONE}function a(t){t.preventDefault(),h.zoom(new i(0,0,t.deltaY))}function s(t){t.preventDefault()}function l(t){if(!1!==h.enabled){switch(t.touches.length){case 1:S[0].set(t.touches[0].pageX,t.touches[0].pageY,0),S[1].set(t.touches[0].pageX,t.touches[0].pageY,0);break;case 2:S[0].set(t.touches[0].pageX,t.touches[0].pageY,0),S[1].set(t.touches[1].pageX,t.touches[1].pageY,0),M=S[0].distanceTo(S[1])}A[0].copy(S[0]),A[1].copy(S[1])}}function c(t){function e(t,e){var n=e[0];for(var r in e)n.distanceTo(t)>e[r].distanceTo(t)&&(n=e[r]);return n}if(!1!==h.enabled){switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:S[0].set(t.touches[0].pageX,t.touches[0].pageY,0),S[1].set(t.touches[0].pageX,t.touches[0].pageY,0),h.rotate(S[0].sub(e(S[0],A)).multiplyScalar(-h.rotationSpeed));break;case 2:S[0].set(t.touches[0].pageX,t.touches[0].pageY,0),S[1].set(t.touches[1].pageX,t.touches[1].pageY,0);var n=S[0].distanceTo(S[1]);h.zoom(new i(0,0,M-n)),M=n;var r=S[0].clone().sub(e(S[0],A)),o=S[1].clone().sub(e(S[1],A));r.x=-r.x,o.x=-o.x,h.pan(r.add(o).multiplyScalar(.5))}A[0].copy(S[0]),A[1].copy(S[1])}}e=void 0!==e?e:document,this.enabled=!0,this.center=new i,this.panSpeed=.001,this.zoomSpeed=.001,this.rotationSpeed=.005;var h=this,p=new i,f={NONE:-1,ROTATE:0,ZOOM:1,PAN:2},v=f.NONE,g=this.center,y=new u,b=new m,_=new m,x=new Ut,w={type:"change"};this.focus=function(e){var n,r=(new d).setFromObject(e);!1===r.isEmpty()?(g.copy(r.getCenter()),n=r.getBoundingSphere().radius):(g.setFromMatrixPosition(e.matrixWorld),n=.1);var o=new i(0,0,1);o.applyQuaternion(t.quaternion),o.multiplyScalar(4*n),t.position.copy(g).add(o),h.dispatchEvent(w)},this.pan=function(e){var n=t.position.distanceTo(g);e.multiplyScalar(n*h.panSpeed),e.applyMatrix3(y.getNormalMatrix(t.matrix)),t.position.add(e),g.add(e),h.dispatchEvent(w)},this.zoom=function(e){var n=t.position.distanceTo(g);e.multiplyScalar(n*h.zoomSpeed),e.length()>n||(e.applyMatrix3(y.getNormalMatrix(t.matrix)),t.position.add(e),h.dispatchEvent(w))},this.rotate=function(e){p.copy(t.position).sub(g),x.setFromVector3(p),x.theta+=e.x,x.phi+=e.y,x.makeSafe(),p.setFromSpherical(x),t.position.copy(g).add(p),t.lookAt(g),h.dispatchEvent(w)},this.dispose=function(){e.removeEventListener("contextmenu",s,!1),e.removeEventListener("mousedown",n,!1),e.removeEventListener("wheel",a,!1),e.removeEventListener("mousemove",r,!1),e.removeEventListener("mouseup",o,!1),e.removeEventListener("mouseout",o,!1),e.removeEventListener("dblclick",o,!1),e.removeEventListener("touchstart",l,!1),e.removeEventListener("touchmove",c,!1)},e.addEventListener("contextmenu",s,!1),e.addEventListener("mousedown",n,!1),e.addEventListener("wheel",a,!1);var S=[new i,new i,new i],A=[new i,new i,new i],M=null;e.addEventListener("touchstart",l,!1),e.addEventListener("touchmove",c,!1)};(ul.prototype=Object.create(a.prototype)).constructor=ul;var cl=function(t,e){function n(){return Math.pow(.95,b.zoomSpeed)}function r(t){C.theta-=t}function a(t){C.phi-=t}function s(t){b.object.isPerspectiveCamera?E/=t:b.object.isOrthographicCamera?(b.object.zoom=Math.max(b.minZoom,Math.min(b.maxZoom,b.object.zoom*t)),b.object.updateProjectionMatrix(),O=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),b.enableZoom=!1)}function l(t){b.object.isPerspectiveCamera?E*=t:b.object.isOrthographicCamera?(b.object.zoom=Math.max(b.minZoom,Math.min(b.maxZoom,b.object.zoom/t)),b.object.updateProjectionMatrix(),O=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),b.enableZoom=!1)}function u(t){if(!1!==b.enabled){switch(t.preventDefault(),t.button){case b.mouseButtons.ORBIT:if(!1===b.enableRotate)return;!function(t){N.set(t.clientX,t.clientY)}(t),A=S.ROTATE;break;case b.mouseButtons.ZOOM:if(!1===b.enableZoom)return;!function(t){k.set(t.clientX,t.clientY)}(t),A=S.DOLLY;break;case b.mouseButtons.PAN:if(!1===b.enablePan)return;!function(t){D.set(t.clientX,t.clientY)}(t),A=S.PAN}A!==S.NONE&&(document.addEventListener("mousemove",c,!1),document.addEventListener("mouseup",h,!1),b.dispatchEvent(x))}}function c(t){if(!1!==b.enabled)switch(t.preventDefault(),A){case S.ROTATE:if(!1===b.enableRotate)return;!function(t){L.set(t.clientX,t.clientY),I.subVectors(L,N).multiplyScalar(b.rotateSpeed);var e=b.domElement===document?b.domElement.body:b.domElement;r(2*Math.PI*I.x/e.clientWidth),a(2*Math.PI*I.y/e.clientHeight),N.copy(L),b.update()}(t);break;case S.DOLLY:if(!1===b.enableZoom)return;!function(t){U.set(t.clientX,t.clientY),j.subVectors(U,k),j.y>0?s(n()):j.y<0&&l(n()),k.copy(U),b.update()}(t);break;case S.PAN:if(!1===b.enablePan)return;!function(t){F.set(t.clientX,t.clientY),R.subVectors(F,D).multiplyScalar(b.panSpeed),V(R.x,R.y),D.copy(F),b.update()}(t)}}function h(t){!1!==b.enabled&&(document.removeEventListener("mousemove",c,!1),document.removeEventListener("mouseup",h,!1),b.dispatchEvent(w),A=S.NONE)}function p(t){!1===b.enabled||!1===b.enableZoom||A!==S.NONE&&A!==S.ROTATE||(t.preventDefault(),t.stopPropagation(),b.dispatchEvent(x),function(t){t.deltaY<0?l(n()):t.deltaY>0&&s(n()),b.update()}(t),b.dispatchEvent(w))}function d(t){!1!==b.enabled&&!1!==b.enableKeys&&!1!==b.enablePan&&function(t){switch(t.keyCode){case b.keys.UP:V(0,b.keyPanSpeed),b.update();break;case b.keys.BOTTOM:V(0,-b.keyPanSpeed),b.update();break;case b.keys.LEFT:V(b.keyPanSpeed,0),b.update();break;case b.keys.RIGHT:V(-b.keyPanSpeed,0),b.update()}}(t)}function f(t){if(!1!==b.enabled){switch(t.touches.length){case 1:if(!1===b.enableRotate)return;!function(t){N.set(t.touches[0].pageX,t.touches[0].pageY)}(t),A=S.TOUCH_ROTATE;break;case 2:if(!1===b.enableZoom)return;!function(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(e*e+n*n);k.set(0,r)}(t),A=S.TOUCH_DOLLY;break;case 3:if(!1===b.enablePan)return;!function(t){D.set(t.touches[0].pageX,t.touches[0].pageY)}(t),A=S.TOUCH_PAN;break;default:A=S.NONE}A!==S.NONE&&b.dispatchEvent(x)}}function v(t){if(!1!==b.enabled)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:if(!1===b.enableRotate)return;if(A!==S.TOUCH_ROTATE)return;!function(t){L.set(t.touches[0].pageX,t.touches[0].pageY),I.subVectors(L,N).multiplyScalar(b.rotateSpeed);var e=b.domElement===document?b.domElement.body:b.domElement;r(2*Math.PI*I.x/e.clientWidth),a(2*Math.PI*I.y/e.clientHeight),N.copy(L),b.update()}(t);break;case 2:if(!1===b.enableZoom)return;if(A!==S.TOUCH_DOLLY)return;!function(t){var e=t.touches[0].pageX-t.touches[1].pageX,r=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(e*e+r*r);U.set(0,i),j.subVectors(U,k),j.y>0?l(n()):j.y<0&&s(n()),k.copy(U),b.update()}(t);break;case 3:if(!1===b.enablePan)return;if(A!==S.TOUCH_PAN)return;!function(t){F.set(t.touches[0].pageX,t.touches[0].pageY),R.subVectors(F,D).multiplyScalar(b.panSpeed),V(R.x,R.y),D.copy(F),b.update()}(t);break;default:A=S.NONE}}function g(t){!1!==b.enabled&&(b.dispatchEvent(w),A=S.NONE)}function y(t){!1!==b.enabled&&t.preventDefault()}this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new i,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.panningMode=hl,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:Co,ZOOM:Eo,PAN:Po},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return T.phi},this.getAzimuthalAngle=function(){return T.theta},this.saveState=function(){b.target0.copy(b.target),b.position0.copy(b.object.position),b.zoom0=b.object.zoom},this.reset=function(){b.target.copy(b.target0),b.object.position.copy(b.position0),b.object.zoom=b.zoom0,b.object.updateProjectionMatrix(),b.dispatchEvent(_),b.update(),A=S.NONE},this.update=function(){var e=new i,n=(new o).setFromUnitVectors(t.up,new i(0,1,0)),a=n.clone().inverse(),s=new i,l=new o;return function(){var t=b.object.position;return e.copy(t).sub(b.target),e.applyQuaternion(n),T.setFromVector3(e),b.autoRotate&&A===S.NONE&&r(2*Math.PI/60/60*b.autoRotateSpeed),T.theta+=C.theta,T.phi+=C.phi,T.theta=Math.max(b.minAzimuthAngle,Math.min(b.maxAzimuthAngle,T.theta)),T.phi=Math.max(b.minPolarAngle,Math.min(b.maxPolarAngle,T.phi)),T.makeSafe(),T.radius*=E,T.radius=Math.max(b.minDistance,Math.min(b.maxDistance,T.radius)),b.target.add(P),e.setFromSpherical(T),e.applyQuaternion(a),t.copy(b.target).add(e),b.object.lookAt(b.target),!0===b.enableDamping?(C.theta*=1-b.dampingFactor,C.phi*=1-b.dampingFactor,P.multiplyScalar(1-b.dampingFactor)):(C.set(0,0,0),P.set(0,0,0)),E=1,!!(O||s.distanceToSquared(b.object.position)>M||8*(1-l.dot(b.object.quaternion))>M)&&(b.dispatchEvent(_),s.copy(b.object.position),l.copy(b.object.quaternion),O=!1,!0)}}(),this.dispose=function(){b.domElement.removeEventListener("contextmenu",y,!1),b.domElement.removeEventListener("mousedown",u,!1),b.domElement.removeEventListener("wheel",p,!1),b.domElement.removeEventListener("touchstart",f,!1),b.domElement.removeEventListener("touchend",g,!1),b.domElement.removeEventListener("touchmove",v,!1),document.removeEventListener("mousemove",c,!1),document.removeEventListener("mouseup",h,!1),window.removeEventListener("keydown",d,!1)};var b=this,_={type:"change"},x={type:"start"},w={type:"end"},S={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},A=S.NONE,M=1e-6,T=new Ut,C=new Ut,E=1,P=new i,O=!1,N=new m,L=new m,I=new m,D=new m,F=new m,R=new m,k=new m,U=new m,j=new m,B=function(){var t=new i;return function(e,n){t.setFromMatrixColumn(n,0),t.multiplyScalar(-e),P.add(t)}}(),z=function(){var t=new i;return function(e,n){switch(b.panningMode){case hl:t.setFromMatrixColumn(n,1);break;case pl:t.setFromMatrixColumn(n,0),t.crossVectors(b.object.up,t)}t.multiplyScalar(e),P.add(t)}}(),V=function(){var t=new i;return function(e,n){var r=b.domElement===document?b.domElement.body:b.domElement;if(b.object.isPerspectiveCamera){t.copy(b.object.position).sub(b.target);var i=t.length();i*=Math.tan(b.object.fov/2*Math.PI/180),B(2*e*i/r.clientHeight,b.object.matrix),z(2*n*i/r.clientHeight,b.object.matrix)}else b.object.isOrthographicCamera?(B(e*(b.object.right-b.object.left)/b.object.zoom/r.clientWidth,b.object.matrix),z(n*(b.object.top-b.object.bottom)/b.object.zoom/r.clientHeight,b.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),b.enablePan=!1)}}();b.domElement.addEventListener("contextmenu",y,!1),b.domElement.addEventListener("mousedown",u,!1),b.domElement.addEventListener("wheel",p,!1),b.domElement.addEventListener("touchstart",f,!1),b.domElement.addEventListener("touchend",g,!1),b.domElement.addEventListener("touchmove",v,!1),window.addEventListener("keydown",d,!1),this.update()};cl.prototype=Object.create(a.prototype),cl.prototype.constructor=cl,Object.defineProperties(cl.prototype,{center:{get:function(){return console.warn("OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(t){console.warn("OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!t}},noRotate:{get:function(){return console.warn("OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(t){console.warn("OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!t}},noPan:{get:function(){return console.warn("OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(t){console.warn("OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!t}},noKeys:{get:function(){return console.warn("OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(t){console.warn("OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!t}},staticMoving:{get:function(){return console.warn("OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(t){console.warn("OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!t}},dynamicDampingFactor:{get:function(){return console.warn("OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(t){console.warn("OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=t}}});var hl=0,pl=1,dl=function(t,e){function n(t){!1!==f.enabled&&(window.removeEventListener("keydown",n),b=y,y===v.NONE&&(t.keyCode!==f.keys[v.ROTATE]||f.noRotate?t.keyCode!==f.keys[v.ZOOM]||f.noZoom?t.keyCode!==f.keys[v.PAN]||f.noPan||(y=v.PAN):y=v.ZOOM:y=v.ROTATE))}function r(t){!1!==f.enabled&&(y=b,window.addEventListener("keydown",n,!1))}function a(t){!1!==f.enabled&&(t.preventDefault(),t.stopPropagation(),y===v.NONE&&(y=t.button),y!==v.ROTATE||f.noRotate?y!==v.ZOOM||f.noZoom?y!==v.PAN||f.noPan||(C.copy(L(t.pageX,t.pageY)),E.copy(C)):(S.copy(L(t.pageX,t.pageY)),A.copy(S)):(x.copy(I(t.pageX,t.pageY)),w.copy(x)),document.addEventListener("mousemove",s,!1),document.addEventListener("mouseup",l,!1),f.dispatchEvent(O))}function s(t){!1!==f.enabled&&(t.preventDefault(),t.stopPropagation(),y!==v.ROTATE||f.noRotate?y!==v.ZOOM||f.noZoom?y!==v.PAN||f.noPan||E.copy(L(t.pageX,t.pageY)):A.copy(L(t.pageX,t.pageY)):w.copy(I(t.pageX,t.pageY)))}function l(t){!1!==f.enabled&&(t.preventDefault(),t.stopPropagation(),y=v.NONE,document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",l),f.dispatchEvent(N))}function u(t){!1!==f.enabled&&(t.preventDefault(),t.stopPropagation(),S.y+=.01*t.deltaY,f.dispatchEvent(O),f.dispatchEvent(N))}function c(t){if(!1!==f.enabled){switch(t.touches.length){case 1:y=v.TOUCH_ROTATE,x.copy(I(t.touches[0].pageX,t.touches[0].pageY)),w.copy(x);break;case 2:y=v.TOUCH_ZOOM_PAN;var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY;T=M=Math.sqrt(e*e+n*n);C.copy(L((t.touches[0].pageX+t.touches[1].pageX)/2,(t.touches[0].pageY+t.touches[1].pageY)/2)),E.copy(C);break;default:y=v.NONE}f.dispatchEvent(O)}}function h(t){if(!1!==f.enabled)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:w.copy(I(t.touches[0].pageX,t.touches[0].pageY));break;case 2:var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY;T=Math.sqrt(e*e+n*n);E.copy(L((t.touches[0].pageX+t.touches[1].pageX)/2,(t.touches[0].pageY+t.touches[1].pageY)/2));break;default:y=v.NONE}}function p(t){if(!1!==f.enabled){switch(t.touches.length){case 1:w.copy(I(t.touches[0].pageX,t.touches[0].pageY)),x.copy(w);break;case 2:M=T=0;E.copy(L((t.touches[0].pageX+t.touches[1].pageX)/2,(t.touches[0].pageY+t.touches[1].pageY)/2)),C.copy(E)}y=v.NONE,f.dispatchEvent(N)}}function d(t){t.preventDefault()}var f=this,v={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.radius=0,this.rotateSpeed=1,this.zoomSpeed=1.2,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.noRoll=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.keys=[65,83,68],this.target=new i;var g=!0,y=v.NONE,b=v.NONE,_=new i,x=new i,w=new i,S=new m,A=new m,M=0,T=0,C=new m,E=new m;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.left0=this.object.left,this.right0=this.object.right,this.top0=this.object.top,this.bottom0=this.object.bottom;var P={type:"change"},O={type:"start"},N={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var t=this.domElement.getBoundingClientRect(),e=this.domElement.ownerDocument.documentElement;this.screen.left=t.left+window.pageXOffset-e.clientLeft,this.screen.top=t.top+window.pageYOffset-e.clientTop,this.screen.width=t.width,this.screen.height=t.height}this.radius=.5*Math.min(this.screen.width,this.screen.height),this.left0=this.object.left,this.right0=this.object.right,this.top0=this.object.top,this.bottom0=this.object.bottom},this.handleEvent=function(t){"function"==typeof this[t.type]&&this[t.type](t)};var L=function(){var t=new m;return function(e,n){return t.set((e-f.screen.left)/f.screen.width,(n-f.screen.top)/f.screen.height),t}}(),I=function(){var t=new i,e=new i,n=new i;return function(r,i){n.set((r-.5*f.screen.width-f.screen.left)/f.radius,(.5*f.screen.height+f.screen.top-i)/f.radius,0);var o=n.length();return f.noRoll?n.z=o<Math.SQRT1_2?Math.sqrt(1-o*o):.5/o:o>1?n.normalize():n.z=Math.sqrt(1-o*o),_.copy(f.object.position).sub(f.target),t.copy(f.object.up).setLength(n.y),t.add(e.copy(f.object.up).cross(_).setLength(n.x)),t.add(_.setLength(n.z)),t}}();this.rotateCamera=function(){var t=new i,e=new o;return function(){var n=Math.acos(x.dot(w)/x.length()/w.length());n&&(t.crossVectors(x,w).normalize(),e.setFromAxisAngle(t,-(n*=f.rotateSpeed)),_.applyQuaternion(e),f.object.up.applyQuaternion(e),w.applyQuaternion(e),f.staticMoving?x.copy(w):(e.setFromAxisAngle(t,n*(f.dynamicDampingFactor-1)),x.applyQuaternion(e)),g=!0)}}(),this.zoomCamera=function(){if(y===v.TOUCH_ZOOM_PAN){var t=T/M;M=T,f.object.zoom*=t,g=!0}else{t=1+(A.y-S.y)*f.zoomSpeed;Math.abs(t-1)>1e-6&&t>0&&(f.object.zoom/=t,f.staticMoving?S.copy(A):S.y+=(A.y-S.y)*this.dynamicDampingFactor,g=!0)}},this.panCamera=function(){var t=new m,e=new i,n=new i;return function(){if(t.copy(E).sub(C),t.lengthSq()){var r=(f.object.top-f.object.bottom)/f.object.zoom;t.x*=(f.object.right-f.object.left)/f.object.zoom,t.y*=r,n.copy(_).cross(f.object.up).setLength(t.x),n.add(e.copy(f.object.up).setLength(t.y)),f.object.position.add(n),f.target.add(n),f.staticMoving?C.copy(E):C.add(t.subVectors(E,C).multiplyScalar(f.dynamicDampingFactor)),g=!0}}}(),this.update=function(){_.subVectors(f.object.position,f.target),f.noRotate||f.rotateCamera(),f.noZoom||(f.zoomCamera(),g&&f.object.updateProjectionMatrix()),f.noPan||f.panCamera(),f.object.position.addVectors(f.target,_),f.object.lookAt(f.target),g&&(f.dispatchEvent(P),g=!1)},this.reset=function(){y=v.NONE,b=v.NONE,f.target.copy(f.target0),f.object.position.copy(f.position0),f.object.up.copy(f.up0),_.subVectors(f.object.position,f.target),f.object.left=f.left0,f.object.right=f.right0,f.object.top=f.top0,f.object.bottom=f.bottom0,f.object.lookAt(f.target),f.dispatchEvent(P),g=!1},this.dispose=function(){this.domElement.removeEventListener("contextmenu",d,!1),this.domElement.removeEventListener("mousedown",a,!1),this.domElement.removeEventListener("wheel",u,!1),this.domElement.removeEventListener("touchstart",c,!1),this.domElement.removeEventListener("touchend",p,!1),this.domElement.removeEventListener("touchmove",h,!1),document.removeEventListener("mousemove",s,!1),document.removeEventListener("mouseup",l,!1),window.removeEventListener("keydown",n,!1),window.removeEventListener("keyup",r,!1)},this.domElement.addEventListener("contextmenu",d,!1),this.domElement.addEventListener("mousedown",a,!1),this.domElement.addEventListener("wheel",u,!1),this.domElement.addEventListener("touchstart",c,!1),this.domElement.addEventListener("touchend",p,!1),this.domElement.addEventListener("touchmove",h,!1),window.addEventListener("keydown",n,!1),window.addEventListener("keyup",r,!1),this.handleResize(),this.update()};(dl.prototype=Object.create(a.prototype)).constructor=dl;var fl=function(t,e){function n(t){!1!==f.enabled&&(window.removeEventListener("keydown",n),b=y,y===v.NONE&&(t.keyCode!==f.keys[v.ROTATE]||f.noRotate?t.keyCode!==f.keys[v.ZOOM]||f.noZoom?t.keyCode!==f.keys[v.PAN]||f.noPan||(y=v.PAN):y=v.ZOOM:y=v.ROTATE))}function r(t){!1!==f.enabled&&(y=b,window.addEventListener("keydown",n,!1))}function a(t){!1!==f.enabled&&(t.preventDefault(),t.stopPropagation(),y===v.NONE&&(y=t.button),y!==v.ROTATE||f.noRotate?y!==v.ZOOM||f.noZoom?y!==v.PAN||f.noPan||(P.copy(D(t.pageX,t.pageY)),O.copy(P)):(M.copy(D(t.pageX,t.pageY)),T.copy(M)):(w.copy(F(t.pageX,t.pageY)),x.copy(w)),document.addEventListener("mousemove",s,!1),document.addEventListener("mouseup",l,!1),f.dispatchEvent(L))}function s(t){!1!==f.enabled&&(t.preventDefault(),t.stopPropagation(),y!==v.ROTATE||f.noRotate?y!==v.ZOOM||f.noZoom?y!==v.PAN||f.noPan||O.copy(D(t.pageX,t.pageY)):T.copy(D(t.pageX,t.pageY)):(x.copy(w),w.copy(F(t.pageX,t.pageY))))}function l(t){!1!==f.enabled&&(t.preventDefault(),t.stopPropagation(),y=v.NONE,document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",l),f.dispatchEvent(I))}function u(t){if(!1!==f.enabled&&!0!==f.noZoom){switch(t.preventDefault(),t.stopPropagation(),t.deltaMode){case 2:M.y-=.025*t.deltaY;break;case 1:M.y-=.01*t.deltaY;break;default:M.y-=25e-5*t.deltaY}f.dispatchEvent(L),f.dispatchEvent(I)}}function c(t){if(!1!==f.enabled){switch(t.touches.length){case 1:y=v.TOUCH_ROTATE,w.copy(F(t.touches[0].pageX,t.touches[0].pageY)),x.copy(w);break;default:y=v.TOUCH_ZOOM_PAN;var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY;E=C=Math.sqrt(e*e+n*n);P.copy(D((t.touches[0].pageX+t.touches[1].pageX)/2,(t.touches[0].pageY+t.touches[1].pageY)/2)),O.copy(P)}f.dispatchEvent(L)}}function h(t){if(!1!==f.enabled)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:x.copy(w),w.copy(F(t.touches[0].pageX,t.touches[0].pageY));break;default:var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY;E=Math.sqrt(e*e+n*n);O.copy(D((t.touches[0].pageX+t.touches[1].pageX)/2,(t.touches[0].pageY+t.touches[1].pageY)/2))}}function p(t){if(!1!==f.enabled){switch(t.touches.length){case 0:y=v.NONE;break;case 1:y=v.TOUCH_ROTATE,w.copy(F(t.touches[0].pageX,t.touches[0].pageY)),x.copy(w)}f.dispatchEvent(I)}}function d(t){!1!==f.enabled&&t.preventDefault()}var f=this,v={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new i;var g=new i,y=v.NONE,b=v.NONE,_=new i,x=new m,w=new m,S=new i,A=0,M=new m,T=new m,C=0,E=0,P=new m,O=new m;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var N={type:"change"},L={type:"start"},I={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var t=this.domElement.getBoundingClientRect(),e=this.domElement.ownerDocument.documentElement;this.screen.left=t.left+window.pageXOffset-e.clientLeft,this.screen.top=t.top+window.pageYOffset-e.clientTop,this.screen.width=t.width,this.screen.height=t.height}},this.handleEvent=function(t){"function"==typeof this[t.type]&&this[t.type](t)};var D=function(){var t=new m;return function(e,n){return t.set((e-f.screen.left)/f.screen.width,(n-f.screen.top)/f.screen.height),t}}(),F=function(){var t=new m;return function(e,n){return t.set((e-.5*f.screen.width-f.screen.left)/(.5*f.screen.width),(f.screen.height+2*(f.screen.top-n))/f.screen.width),t}}();this.rotateCamera=function(){var t,e=new i,n=new o,r=new i,a=new i,s=new i,l=new i;return function(){l.set(w.x-x.x,w.y-x.y,0),(t=l.length())?(_.copy(f.object.position).sub(f.target),r.copy(_).normalize(),a.copy(f.object.up).normalize(),s.crossVectors(a,r).normalize(),a.setLength(w.y-x.y),s.setLength(w.x-x.x),l.copy(a.add(s)),e.crossVectors(l,_).normalize(),n.setFromAxisAngle(e,t*=f.rotateSpeed),_.applyQuaternion(n),f.object.up.applyQuaternion(n),S.copy(e),A=t):!f.staticMoving&&A&&(A*=Math.sqrt(1-f.dynamicDampingFactor),_.copy(f.object.position).sub(f.target),n.setFromAxisAngle(S,A),_.applyQuaternion(n),f.object.up.applyQuaternion(n)),x.copy(w)}}(),this.zoomCamera=function(){var t;y===v.TOUCH_ZOOM_PAN?(t=C/E,C=E,_.multiplyScalar(t)):(1!==(t=1+(T.y-M.y)*f.zoomSpeed)&&t>0&&_.multiplyScalar(t),f.staticMoving?M.copy(T):M.y+=(T.y-M.y)*this.dynamicDampingFactor)},this.panCamera=function(){var t=new m,e=new i,n=new i;return function(){t.copy(O).sub(P),t.lengthSq()&&(t.multiplyScalar(_.length()*f.panSpeed),n.copy(_).cross(f.object.up).setLength(t.x),n.add(e.copy(f.object.up).setLength(t.y)),f.object.position.add(n),f.target.add(n),f.staticMoving?P.copy(O):P.add(t.subVectors(O,P).multiplyScalar(f.dynamicDampingFactor)))}}(),this.checkDistances=function(){f.noZoom&&f.noPan||(_.lengthSq()>f.maxDistance*f.maxDistance&&(f.object.position.addVectors(f.target,_.setLength(f.maxDistance)),M.copy(T)),_.lengthSq()<f.minDistance*f.minDistance&&(f.object.position.addVectors(f.target,_.setLength(f.minDistance)),M.copy(T)))},this.update=function(){_.subVectors(f.object.position,f.target),f.noRotate||f.rotateCamera(),f.noZoom||f.zoomCamera(),f.noPan||f.panCamera(),f.object.position.addVectors(f.target,_),f.checkDistances(),f.object.lookAt(f.target),g.distanceToSquared(f.object.position)>1e-6&&(f.dispatchEvent(N),g.copy(f.object.position))},this.reset=function(){y=v.NONE,b=v.NONE,f.target.copy(f.target0),f.object.position.copy(f.position0),f.object.up.copy(f.up0),_.subVectors(f.object.position,f.target),f.object.lookAt(f.target),f.dispatchEvent(N),g.copy(f.object.position)},this.dispose=function(){this.domElement.removeEventListener("contextmenu",d,!1),this.domElement.removeEventListener("mousedown",a,!1),this.domElement.removeEventListener("wheel",u,!1),this.domElement.removeEventListener("touchstart",c,!1),this.domElement.removeEventListener("touchend",p,!1),this.domElement.removeEventListener("touchmove",h,!1),document.removeEventListener("mousemove",s,!1),document.removeEventListener("mouseup",l,!1),window.removeEventListener("keydown",n,!1),window.removeEventListener("keyup",r,!1)},this.domElement.addEventListener("contextmenu",d,!1),this.domElement.addEventListener("mousedown",a,!1),this.domElement.addEventListener("wheel",u,!1),this.domElement.addEventListener("touchstart",c,!1),this.domElement.addEventListener("touchend",p,!1),this.domElement.addEventListener("touchmove",h,!1),window.addEventListener("keydown",n,!1),window.addEventListener("keyup",r,!1),this.handleResize(),this.update()};(fl.prototype=Object.create(a.prototype)).constructor=fl,(jt.prototype=Object.create(v.prototype)).constructor=jt,(Bt.prototype=Object.create(O.prototype)).constructor=Bt,(zt.prototype=Object.create(v.prototype)).constructor=zt,(Vt.prototype=Object.create(Bt.prototype)).constructor=Vt,(Gt.prototype=Object.create(v.prototype)).constructor=Gt,(Ht.prototype=Object.create(O.prototype)).constructor=Ht;var ml=function(t){D.call(this),this.depthTest=!1,this.depthWrite=!1,this.fog=!1,this.side=Fo,this.transparent=!0,this.setValues(t),this.oldColor=this.color.clone(),this.oldOpacity=this.opacity,this.highlight=function(t){t?(this.color.setRGB(1,1,0),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}};(ml.prototype=Object.create(D.prototype)).constructor=ml;var vl=function(t){F.call(this),this.depthTest=!1,this.depthWrite=!1,this.fog=!1,this.transparent=!0,this.linewidth=1,this.setValues(t),this.oldColor=this.color.clone(),this.oldOpacity=this.opacity,this.highlight=function(t){t?(this.color.setRGB(1,1,0),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}};(vl.prototype=Object.create(F.prototype)).constructor=vl;var gl=new ml({visible:!1,transparent:!1}),yl=function(){this.init=function(){c.call(this),this.handles=new c,this.pickers=new c,this.planes=new c,this.add(this.handles),this.add(this.pickers),this.add(this.planes);var t=new mt(50,50,2,2),e=new D({visible:!1,side:ko}),n={XY:new B(t,e),YZ:new B(t,e),XZ:new B(t,e),XYZE:new B(t,e)};this.activePlane=n.XYZE,n.YZ.rotation.set(0,Math.PI/2,0),n.XZ.rotation.set(-Math.PI/2,0,0);for(var r in n)n[r].name=r,this.planes.add(n[r]),this.planes[r]=n[r];var i=function(t,e){for(var n in t)for(r=t[n].length;r--;){var i=t[n][r][0],o=t[n][r][1],a=t[n][r][2];i.name=n,i.renderOrder=1/0,o&&i.position.set(o[0],o[1],o[2]),a&&i.rotation.set(a[0],a[1],a[2]),e.add(i)}};i(this.handleGizmos,this.handles),i(this.pickerGizmos,this.pickers),this.traverse(function(t){if(t instanceof B){t.updateMatrix();var e=t.geometry.clone();e.applyMatrix(t.matrix),t.geometry=e,t.position.set(0,0,0),t.rotation.set(0,0,0),t.scale.set(1,1,1)}})},this.highlight=function(t){this.traverse(function(e){e.material&&e.material.highlight&&e.material.highlight(e.name===t)})}};(yl.prototype=Object.create(c.prototype)).constructor=yl,yl.prototype.update=function(t,e){var n=new i(0,0,0),o=new i(0,1,0),a=new r;this.traverse(function(r){-1!==r.name.search("E")?r.quaternion.setFromRotationMatrix(a.lookAt(e,n,o)):-1===r.name.search("X")&&-1===r.name.search("Y")&&-1===r.name.search("Z")||r.quaternion.setFromEuler(t)})};var bl=function(){yl.call(this);var t=new v,e=new B(new W(0,.05,.2,12,1,!1));e.position.y=.5,e.updateMatrix(),t.merge(e.geometry,e.matrix);var n=new O;n.addAttribute("position",new T([0,0,0,1,0,0],3));var i=new O;i.addAttribute("position",new T([0,0,0,0,1,0],3));var o=new O;o.addAttribute("position",new T([0,0,0,0,0,1],3)),this.handleGizmos={X:[[new B(t,new ml({color:16711680})),[.5,0,0],[0,0,-Math.PI/2]],[new z(n,new vl({color:16711680}))]],Y:[[new B(t,new ml({color:65280})),[0,.5,0]],[new z(i,new vl({color:65280}))]],Z:[[new B(t,new ml({color:255})),[0,0,.5],[Math.PI/2,0,0]],[new z(o,new vl({color:255}))]],XYZ:[[new B(new zt(.1,0),new ml({color:16777215,opacity:.25})),[0,0,0],[0,0,0]]],XY:[[new B(new mt(.29,.29),new ml({color:16776960,opacity:.25})),[.15,.15,0]]],YZ:[[new B(new mt(.29,.29),new ml({color:65535,opacity:.25})),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new B(new mt(.29,.29),new ml({color:16711935,opacity:.25})),[.15,0,.15],[-Math.PI/2,0,0]]]},this.pickerGizmos={X:[[new B(new X(.2,0,1,4,1,!1),gl),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new B(new X(.2,0,1,4,1,!1),gl),[0,.6,0]]],Z:[[new B(new X(.2,0,1,4,1,!1),gl),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new B(new zt(.2,0),gl)]],XY:[[new B(new mt(.4,.4),gl),[.2,.2,0]]],YZ:[[new B(new mt(.4,.4),gl),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new B(new mt(.4,.4),gl),[.2,0,.2],[-Math.PI/2,0,0]]]},this.setActivePlane=function(t,e){var n=new r;e.applyMatrix4(n.getInverse(n.extractRotation(this.planes.XY.matrixWorld))),"X"===t&&(this.activePlane=this.planes.XY,Math.abs(e.y)>Math.abs(e.z)&&(this.activePlane=this.planes.XZ)),"Y"===t&&(this.activePlane=this.planes.XY,Math.abs(e.x)>Math.abs(e.z)&&(this.activePlane=this.planes.YZ)),"Z"===t&&(this.activePlane=this.planes.XZ,Math.abs(e.x)>Math.abs(e.y)&&(this.activePlane=this.planes.YZ)),"XYZ"===t&&(this.activePlane=this.planes.XYZE),"XY"===t&&(this.activePlane=this.planes.XY),"YZ"===t&&(this.activePlane=this.planes.YZ),"XZ"===t&&(this.activePlane=this.planes.XZ)},this.init()};(bl.prototype=Object.create(yl.prototype)).constructor=bl;var _l=function(){yl.call(this);var t=function(t,e,n){var r=new O,i=[];n=n||1;for(var o=0;o<=64*n;++o)"x"===e&&i.push(0,Math.cos(o/32*Math.PI)*t,Math.sin(o/32*Math.PI)*t),"y"===e&&i.push(Math.cos(o/32*Math.PI)*t,0,Math.sin(o/32*Math.PI)*t),"z"===e&&i.push(Math.sin(o/32*Math.PI)*t,Math.cos(o/32*Math.PI)*t,0);return r.addAttribute("position",new T(i,3)),r};this.handleGizmos={X:[[new z(new t(1,"x",.5),new vl({color:16711680}))]],Y:[[new z(new t(1,"y",.5),new vl({color:65280}))]],Z:[[new z(new t(1,"z",.5),new vl({color:255}))]],E:[[new z(new t(1.25,"z",1),new vl({color:13421568}))]],XYZE:[[new z(new t(1,"z",1),new vl({color:7895160}))]]},this.pickerGizmos={X:[[new B(new Ht(1,.12,4,12,Math.PI),gl),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new B(new Ht(1,.12,4,12,Math.PI),gl),[0,0,0],[Math.PI/2,0,0]]],Z:[[new B(new Ht(1,.12,4,12,Math.PI),gl),[0,0,0],[0,0,-Math.PI/2]]],E:[[new B(new Ht(1.25,.12,2,24),gl)]],XYZE:[[new B]]},this.setActivePlane=function(t){"E"===t&&(this.activePlane=this.planes.XYZE),"X"===t&&(this.activePlane=this.planes.YZ),"Y"===t&&(this.activePlane=this.planes.XZ),"Z"===t&&(this.activePlane=this.planes.XY)},this.update=function(t,e){yl.prototype.update.apply(this,arguments);var n=new r,a=new s(0,0,1),l=new o,u=new i(1,0,0),c=new i(0,1,0),h=new i(0,0,1),p=new o,d=new o,f=new o,m=e.clone();a.copy(this.planes.XY.rotation),l.setFromEuler(a),n.makeRotationFromQuaternion(l).getInverse(n),m.applyMatrix4(n),this.traverse(function(t){l.setFromEuler(a),"X"===t.name&&(p.setFromAxisAngle(u,Math.atan2(-m.y,m.z)),l.multiplyQuaternions(l,p),t.quaternion.copy(l)),"Y"===t.name&&(d.setFromAxisAngle(c,Math.atan2(m.x,m.z)),l.multiplyQuaternions(l,d),t.quaternion.copy(l)),"Z"===t.name&&(f.setFromAxisAngle(h,Math.atan2(m.y,m.x)),l.multiplyQuaternions(l,f),t.quaternion.copy(l))})},this.init()};(_l.prototype=Object.create(yl.prototype)).constructor=_l;var xl=function(){yl.call(this);var t=new v,e=new B(new G(.125,.125,.125));e.position.y=.5,e.updateMatrix(),t.merge(e.geometry,e.matrix);var n=new O;n.addAttribute("position",new T([0,0,0,1,0,0],3));var i=new O;i.addAttribute("position",new T([0,0,0,0,1,0],3));var o=new O;o.addAttribute("position",new T([0,0,0,0,0,1],3)),this.handleGizmos={X:[[new B(t,new ml({color:16711680})),[.5,0,0],[0,0,-Math.PI/2]],[new z(n,new vl({color:16711680}))]],Y:[[new B(t,new ml({color:65280})),[0,.5,0]],[new z(i,new vl({color:65280}))]],Z:[[new B(t,new ml({color:255})),[0,0,.5],[Math.PI/2,0,0]],[new z(o,new vl({color:255}))]],XYZ:[[new B(new H(.125,.125,.125),new ml({color:16777215,opacity:.25}))]]},this.pickerGizmos={X:[[new B(new X(.2,0,1,4,1,!1),gl),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new B(new X(.2,0,1,4,1,!1),gl),[0,.6,0]]],Z:[[new B(new X(.2,0,1,4,1,!1),gl),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new B(new H(.4,.4,.4),gl)]]},this.setActivePlane=function(t,e){var n=new r;e.applyMatrix4(n.getInverse(n.extractRotation(this.planes.XY.matrixWorld))),"X"===t&&(this.activePlane=this.planes.XY,Math.abs(e.y)>Math.abs(e.z)&&(this.activePlane=this.planes.XZ)),"Y"===t&&(this.activePlane=this.planes.XY,Math.abs(e.x)>Math.abs(e.z)&&(this.activePlane=this.planes.YZ)),"Z"===t&&(this.activePlane=this.planes.XZ,Math.abs(e.x)>Math.abs(e.y)&&(this.activePlane=this.planes.YZ)),"XYZ"===t&&(this.activePlane=this.planes.XYZE)},this.init()};(xl.prototype=Object.create(yl.prototype)).constructor=xl;var wl=function(t,e){function n(t){if(void 0!==p.object&&!0!==f&&(void 0===t.button||0===t.button)){var e=h(t.changedTouches?t.changedTouches[0]:t,v[d].pickers.children),n=null;e&&(n=e.object.name,t.preventDefault()),p.axis!==n&&(p.axis=n,p.update(),p.dispatchEvent(b))}}function a(t){if(void 0!==p.object&&!0!==f&&(void 0===t.button||0===t.button)){var e=t.changedTouches?t.changedTouches[0]:t;if(0===e.button||void 0===e.button){var n=h(e,v[d].pickers.children);if(n){t.preventDefault(),t.stopPropagation(),p.axis=n.object.name,p.dispatchEvent(_),p.update(),N.copy(J).sub(q).normalize(),v[d].setActivePlane(p.axis,N);var r=h(e,[v[d].activePlane]);r&&(G.copy(p.object.position),H.copy(p.object.scale),W.extractRotation(p.object.matrix),Q.extractRotation(p.object.matrixWorld),X.extractRotation(p.object.parent.matrixWorld),Y.setFromMatrixScale(L.getInverse(p.object.parent.matrixWorld)),T.copy(r.point))}}f=!0}}function l(t){if(void 0!==p.object&&null!==p.axis&&!1!==f&&(void 0===t.button||0===t.button)){var e=h(t.changedTouches?t.changedTouches[0]:t,[v[d].activePlane]);!1!==e&&(t.preventDefault(),t.stopPropagation(),M.copy(e.point),"translate"===d?(M.sub(T),M.multiply(Y),"local"===p.space&&(M.applyMatrix4(L.getInverse(Q)),-1===p.axis.search("X")&&(M.x=0),-1===p.axis.search("Y")&&(M.y=0),-1===p.axis.search("Z")&&(M.z=0),M.applyMatrix4(W),p.object.position.copy(G),p.object.position.add(M)),"world"!==p.space&&-1===p.axis.search("XYZ")||(-1===p.axis.search("X")&&(M.x=0),-1===p.axis.search("Y")&&(M.y=0),-1===p.axis.search("Z")&&(M.z=0),M.applyMatrix4(L.getInverse(X)),p.object.position.copy(G),p.object.position.add(M)),null!==p.translationSnap&&("local"===p.space&&p.object.position.applyMatrix4(L.getInverse(Q)),-1!==p.axis.search("X")&&(p.object.position.x=Math.round(p.object.position.x/p.translationSnap)*p.translationSnap),-1!==p.axis.search("Y")&&(p.object.position.y=Math.round(p.object.position.y/p.translationSnap)*p.translationSnap),-1!==p.axis.search("Z")&&(p.object.position.z=Math.round(p.object.position.z/p.translationSnap)*p.translationSnap),"local"===p.space&&p.object.position.applyMatrix4(Q))):"scale"===d?(M.sub(T),M.multiply(Y),"local"===p.space&&("XYZ"===p.axis?(P=1+M.y/Math.max(H.x,H.y,H.z),p.object.scale.x=H.x*P,p.object.scale.y=H.y*P,p.object.scale.z=H.z*P):(M.applyMatrix4(L.getInverse(Q)),"X"===p.axis&&(p.object.scale.x=H.x*(1+M.x/H.x)),"Y"===p.axis&&(p.object.scale.y=H.y*(1+M.y/H.y)),"Z"===p.axis&&(p.object.scale.z=H.z*(1+M.z/H.z))))):"rotate"===d&&(M.sub(q),M.multiply(Y),I.copy(T).sub(q),I.multiply(Y),"E"===p.axis?(M.applyMatrix4(L.getInverse(O)),I.applyMatrix4(L.getInverse(O)),C.set(Math.atan2(M.z,M.y),Math.atan2(M.x,M.z),Math.atan2(M.y,M.x)),E.set(Math.atan2(I.z,I.y),Math.atan2(I.x,I.z),Math.atan2(I.y,I.x)),D.setFromRotationMatrix(L.getInverse(X)),V.setFromAxisAngle(N,C.z-E.z),U.setFromRotationMatrix(Q),D.multiplyQuaternions(D,V),D.multiplyQuaternions(D,U),p.object.quaternion.copy(D)):"XYZE"===p.axis?(V.setFromEuler(M.clone().cross(I).normalize()),D.setFromRotationMatrix(L.getInverse(X)),j.setFromAxisAngle(V,-M.clone().angleTo(I)),U.setFromRotationMatrix(Q),D.multiplyQuaternions(D,j),D.multiplyQuaternions(D,U),p.object.quaternion.copy(D)):"local"===p.space?(M.applyMatrix4(L.getInverse(Q)),I.applyMatrix4(L.getInverse(Q)),C.set(Math.atan2(M.z,M.y),Math.atan2(M.x,M.z),Math.atan2(M.y,M.x)),E.set(Math.atan2(I.z,I.y),Math.atan2(I.x,I.z),Math.atan2(I.y,I.x)),U.setFromRotationMatrix(W),null!==p.rotationSnap?(j.setFromAxisAngle(F,Math.round((C.x-E.x)/p.rotationSnap)*p.rotationSnap),B.setFromAxisAngle(R,Math.round((C.y-E.y)/p.rotationSnap)*p.rotationSnap),z.setFromAxisAngle(k,Math.round((C.z-E.z)/p.rotationSnap)*p.rotationSnap)):(j.setFromAxisAngle(F,C.x-E.x),B.setFromAxisAngle(R,C.y-E.y),z.setFromAxisAngle(k,C.z-E.z)),"X"===p.axis&&U.multiplyQuaternions(U,j),"Y"===p.axis&&U.multiplyQuaternions(U,B),"Z"===p.axis&&U.multiplyQuaternions(U,z),p.object.quaternion.copy(U)):"world"===p.space&&(C.set(Math.atan2(M.z,M.y),Math.atan2(M.x,M.z),Math.atan2(M.y,M.x)),E.set(Math.atan2(I.z,I.y),Math.atan2(I.x,I.z),Math.atan2(I.y,I.x)),D.setFromRotationMatrix(L.getInverse(X)),null!==p.rotationSnap?(j.setFromAxisAngle(F,Math.round((C.x-E.x)/p.rotationSnap)*p.rotationSnap),B.setFromAxisAngle(R,Math.round((C.y-E.y)/p.rotationSnap)*p.rotationSnap),z.setFromAxisAngle(k,Math.round((C.z-E.z)/p.rotationSnap)*p.rotationSnap)):(j.setFromAxisAngle(F,C.x-E.x),B.setFromAxisAngle(R,C.y-E.y),z.setFromAxisAngle(k,C.z-E.z)),U.setFromRotationMatrix(Q),"X"===p.axis&&D.multiplyQuaternions(D,j),"Y"===p.axis&&D.multiplyQuaternions(D,B),"Z"===p.axis&&D.multiplyQuaternions(D,z),D.multiplyQuaternions(D,U),p.object.quaternion.copy(D))),p.update(),p.dispatchEvent(b),p.dispatchEvent(w))}}function u(t){t.preventDefault(),void 0!==t.button&&0!==t.button||(f&&null!==p.axis&&(x.mode=d,p.dispatchEvent(x)),f=!1,"TouchEvent"in window&&t instanceof TouchEvent?(p.axis=null,p.update(),p.dispatchEvent(b)):n(t))}function h(n,r){var i=e.getBoundingClientRect();A.set(2*((n.clientX-i.left)/i.width)-1,-2*((n.clientY-i.top)/i.height)+1),S.setFromCamera(A,t);var o=S.intersectObjects(r,!0);return!!o[0]&&o[0]}c.call(this),e=void 0!==e?e:document,this.object=void 0,this.visible=!1,this.translationSnap=null,this.rotationSnap=null,this.space="world",this.size=1,this.axis=null;var p=this,d="translate",f=!1,v={translate:new bl,rotate:new _l,scale:new xl};for(var g in v){var y=v[g];y.visible=g===d,this.add(y)}var b={type:"change"},_={type:"mouseDown"},x={type:"mouseUp",mode:d},w={type:"objectChange"},S=new Ft,A=new m,M=new i,T=new i,C=new i,E=new i,P=1,O=new r,N=new i,L=new r,I=new i,D=new o,F=new i(1,0,0),R=new i(0,1,0),k=new i(0,0,1),U=new o,j=new o,B=new o,z=new o,V=new o,G=new i,H=new i,W=new r,X=new r,Y=new i,q=new i,Z=new s,Q=new r,J=new i,K=new s;e.addEventListener("mousedown",a,!1),e.addEventListener("touchstart",a,!1),e.addEventListener("mousemove",n,!1),e.addEventListener("touchmove",n,!1),e.addEventListener("mousemove",l,!1),e.addEventListener("touchmove",l,!1),e.addEventListener("mouseup",u,!1),e.addEventListener("mouseout",u,!1),e.addEventListener("touchend",u,!1),e.addEventListener("touchcancel",u,!1),e.addEventListener("touchleave",u,!1),this.dispose=function(){e.removeEventListener("mousedown",a),e.removeEventListener("touchstart",a),e.removeEventListener("mousemove",n),e.removeEventListener("touchmove",n),e.removeEventListener("mousemove",l),e.removeEventListener("touchmove",l),e.removeEventListener("mouseup",u),e.removeEventListener("mouseout",u),e.removeEventListener("touchend",u),e.removeEventListener("touchcancel",u),e.removeEventListener("touchleave",u)},this.attach=function(t){this.object=t,this.visible=!0,this.update()},this.detach=function(){this.object=void 0,this.visible=!1,this.axis=null},this.getMode=function(){return d},this.setMode=function(t){"scale"===(d=t||d)&&(p.space="local");for(var e in v)v[e].visible=e===d;this.update(),p.dispatchEvent(b)},this.setTranslationSnap=function(t){p.translationSnap=t},this.setRotationSnap=function(t){p.rotationSnap=t},this.setSize=function(t){p.size=t,this.update(),p.dispatchEvent(b)},this.setSpace=function(t){p.space=t,this.update(),p.dispatchEvent(b)},this.update=function(){void 0!==p.object&&(p.object.updateMatrixWorld(),q.setFromMatrixPosition(p.object.matrixWorld),Z.setFromRotationMatrix(L.extractRotation(p.object.matrixWorld)),t.updateMatrixWorld(),J.setFromMatrixPosition(t.matrixWorld),K.setFromRotationMatrix(L.extractRotation(t.matrixWorld)),P=q.distanceTo(J)/6*p.size,this.position.copy(q),this.scale.set(P,P,P),t instanceof st?N.copy(J).sub(q).normalize():t instanceof ct&&N.copy(J).normalize(),"local"===p.space?v[d].update(Z,N):"world"===p.space&&v[d].update(new s,N),v[d].highlight(p.axis))}};(wl.prototype=Object.create(c.prototype)).constructor=wl;var Sl=0;Object.assign(Wt.prototype,{setFromPoints:function(t){!0!==Array.isArray(t)&&console.error("QuickHull: Points parameter is not an array."),t.length<4&&console.error("QuickHull: The algorithm needs at least four points."),this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.vertices.push(new function(t){this.point=t,this.prev=null,this.next=null,this.face=null}(t[e]));return this.compute(),this},setFromObject:function(t){var e=[];return t.updateMatrixWorld(!0),t.traverse(function(t){var n,r,o,a=t.geometry;if(void 0!==a)if(a.isGeometry){var s=a.vertices;for(n=0,r=s.length;n<r;n++)(o=s[n].clone()).applyMatrix4(t.matrixWorld),e.push(o)}else if(a.isBufferGeometry){var l=a.attributes.position;if(void 0!==l)for(n=0,r=l.count;n<r;n++)(o=new i).fromBufferAttribute(l,n).applyMatrix4(t.matrixWorld),e.push(o)}}),this.setFromPoints(e)},makeEmpty:function(){return this.faces=[],this.vertices=[],this},addVertexToFace:function(t,e){return t.face=e,null===e.outside?this.assigned.append(t):this.assigned.insertBefore(e.outside,t),e.outside=t,this},removeVertexFromFace:function(t,e){return t===e.outside&&(e.outside=null!==t.next&&t.next.face===e?t.next:null),this.assigned.remove(t),this},removeAllVerticesFromFace:function(t){if(null!==t.outside){for(var e=t.outside,n=t.outside;null!==n.next&&n.next.face===t;)n=n.next;return this.assigned.removeSubList(e,n),e.prev=n.next=null,t.outside=null,e}},deleteFaceVertices:function(t,e){var n=this.removeAllVerticesFromFace(t);if(void 0!==n)if(void 0===e)this.unassigned.appendChain(n);else{var r=n;do{var i=r.next;e.distanceToPoint(r.point)>this.tolerance?this.addVertexToFace(r,e):this.unassigned.append(r),r=i}while(null!==r)}return this},resolveUnassignedPoints:function(t){if(!1===this.unassigned.isEmpty()){var e=this.unassigned.first();do{for(var n=e.next,r=this.tolerance,i=null,o=0;o<t.length;o++){var a=t[o];if(a.mark===Sl){var s=a.distanceToPoint(e.point);if(s>r&&(r=s,i=a),r>1e3*this.tolerance)break}}null!==i&&this.addVertexToFace(e,i),e=n}while(null!==e)}return this},computeExtremes:function(){var t,e,n,r=new i,o=new i,a=[],s=[];for(t=0;t<3;t++)a[t]=s[t]=this.vertices[0];for(r.copy(this.vertices[0].point),o.copy(this.vertices[0].point),t=0,e=this.vertices.length;t<e;t++){var l=this.vertices[t],u=l.point;for(n=0;n<3;n++)u.getComponent(n)<r.getComponent(n)&&(r.setComponent(n,u.getComponent(n)),a[n]=l);for(n=0;n<3;n++)u.getComponent(n)>o.getComponent(n)&&(o.setComponent(n,u.getComponent(n)),s[n]=l)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(r.x),Math.abs(o.x))+Math.max(Math.abs(r.y),Math.abs(o.y))+Math.max(Math.abs(r.z),Math.abs(o.z))),{min:a,max:s}},computeInitialHull:function(){var t,e,n;return function(){void 0===t&&(t=new k,e=new U,n=new i);var r,o,a,s,l,u,c,h,p,d=this.vertices,f=this.computeExtremes(),m=f.min,v=f.max,g=0,y=0;for(u=0;u<3;u++)(p=v[u].point.getComponent(u)-m[u].point.getComponent(u))>g&&(g=p,y=u);for(g=0,t.set((o=m[y]).point,(a=v[y]).point),u=0,c=this.vertices.length;u<c;u++)(r=d[u])!==o&&r!==a&&(t.closestPointToPoint(r.point,!0,n),(p=n.distanceToSquared(r.point))>g&&(g=p,s=r));for(g=-1,e.setFromCoplanarPoints(o.point,a.point,s.point),u=0,c=this.vertices.length;u<c;u++)(r=d[u])!==o&&r!==a&&r!==s&&(p=Math.abs(e.distanceToPoint(r.point)))>g&&(g=p,l=r);var b=[];if(e.distanceToPoint(l.point)<0)for(b.push(Xt.create(o,a,s),Xt.create(l,a,o),Xt.create(l,s,a),Xt.create(l,o,s)),u=0;u<3;u++)h=(u+1)%3,b[u+1].getEdge(2).setTwin(b[0].getEdge(h)),b[u+1].getEdge(1).setTwin(b[h+1].getEdge(0));else for(b.push(Xt.create(o,s,a),Xt.create(l,o,a),Xt.create(l,a,s),Xt.create(l,s,o)),u=0;u<3;u++)h=(u+1)%3,b[u+1].getEdge(2).setTwin(b[0].getEdge((3-u)%3)),b[u+1].getEdge(0).setTwin(b[h+1].getEdge(1));for(u=0;u<4;u++)this.faces.push(b[u]);for(u=0,c=d.length;u<c;u++)if((r=d[u])!==o&&r!==a&&r!==s&&r!==l){g=this.tolerance;var _=null;for(h=0;h<4;h++)(p=this.faces[h].distanceToPoint(r.point))>g&&(g=p,_=this.faces[h]);null!==_&&this.addVertexToFace(r,_)}return this}}(),reindexFaces:function(){for(var t=[],e=0;e<this.faces.length;e++){var n=this.faces[e];n.mark===Sl&&t.push(n)}return this.faces=t,this},nextVertexToAdd:function(){if(!1===this.assigned.isEmpty()){var t,e=0,n=this.assigned.first().face,r=n.outside;do{var i=n.distanceToPoint(r.point);i>e&&(e=i,t=r),r=r.next}while(null!==r&&r.face===n);return t}},computeHorizon:function(t,e,n,r){this.deleteFaceVertices(n),n.mark=1;var i;i=null===e?e=n.getEdge(0):e.next;do{var o=i.twin,a=o.face;a.mark===Sl&&(a.distanceToPoint(t)>this.tolerance?this.computeHorizon(t,o,a,r):r.push(i)),i=i.next}while(i!==e);return this},addAdjoiningFace:function(t,e){var n=Xt.create(t,e.tail(),e.head());return this.faces.push(n),n.getEdge(-1).setTwin(e.twin),n.getEdge(0)},addNewFaces:function(t,e){this.newFaces=[];for(var n=null,r=null,i=0;i<e.length;i++){var o=this.addAdjoiningFace(t,e[i]);null===n?n=o:o.next.setTwin(r),this.newFaces.push(o.face),r=o}return n.next.setTwin(r),this},addVertexToHull:function(t){var e=[];return this.unassigned.clear(),this.removeVertexFromFace(t,t.face),this.computeHorizon(t.point,null,t.face,e),this.addNewFaces(t,e),this.resolveUnassignedPoints(this.newFaces),this},cleanup:function(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this},compute:function(){var t;for(this.computeInitialHull();void 0!==(t=this.nextVertexToAdd());)this.addVertexToHull(t);return this.reindexFaces(),this.cleanup(),this}}),Object.assign(Xt,{create:function(t,e,n){var r=new Xt,i=new Yt(t,r),o=new Yt(e,r),a=new Yt(n,r);return i.next=a.prev=o,o.next=i.prev=a,a.next=o.prev=i,r.edge=i,r.compute()}}),Object.assign(Xt.prototype,{getEdge:function(t){for(var e=this.edge;t>0;)e=e.next,t--;for(;t<0;)e=e.prev,t++;return e},compute:function(){var t;return function(){void 0===t&&(t=new j);var e=this.edge.tail(),n=this.edge.head(),r=this.edge.next.head();return t.set(e.point,n.point,r.point),t.getNormal(this.normal),t.getMidpoint(this.midpoint),this.area=t.getArea(),this.constant=this.normal.dot(this.midpoint),this}}(),distanceToPoint:function(t){return this.normal.dot(t)-this.constant}}),Object.assign(Yt.prototype,{head:function(){return this.vertex},tail:function(){return this.prev?this.prev.vertex:null},length:function(){var t=this.head(),e=this.tail();return null!==e?e.point.distanceTo(t.point):-1},lengthSquared:function(){var t=this.head(),e=this.tail();return null!==e?e.point.distanceToSquared(t.point):-1},setTwin:function(t){return this.twin=t,t.twin=this,this}}),Object.assign(qt.prototype,{first:function(){return this.head},last:function(){return this.tail},clear:function(){return this.head=this.tail=null,this},insertBefore:function(t,e){return e.prev=t.prev,e.next=t,null===e.prev?this.head=e:e.prev.next=e,t.prev=e,this},insertAfter:function(t,e){return e.prev=t,e.next=t.next,null===e.next?this.tail=e:e.next.prev=e,t.next=e,this},append:function(t){return null===this.head?this.head=t:this.tail.next=t,t.prev=this.tail,t.next=null,this.tail=t,this},appendChain:function(t){for(null===this.head?this.head=t:this.tail.next=t,t.prev=this.tail;null!==t.next;)t=t.next;return this.tail=t,this},remove:function(t){return null===t.prev?this.head=t.next:t.prev.next=t.next,null===t.next?this.tail=t.prev:t.next.prev=t.prev,this},removeSubList:function(t,e){return null===t.prev?this.head=e.next:t.prev.next=e.next,null===e.next?this.tail=t.prev:e.next.prev=t.prev,this},isEmpty:function(){return null===this.head}}),(Zt.prototype=Object.create(v.prototype)).constructor=Zt,(Qt.prototype=Object.create(O.prototype)).constructor=Qt;var Al=function(t,e){this.minSizeForBreak=t||1.4,this.smallDelta=e||1e-4,this.tempLine1=new k,this.tempPlane1=new U,this.tempPlane2=new U,this.tempCM1=new i,this.tempCM2=new i,this.tempVector3=new i,this.tempVector3_2=new i,this.tempVector3_3=new i,this.tempResultObjects={object1:null,object2:null},this.segments=[];for(var n=0;n<900;n++)this.segments[n]=!1};Al.prototype={constructor:Al,prepareBreakableObject:function(t,e,n,r,i){for(var o=t.geometry.vertices,a=0,s=o.length;a<s;a++)o[a].mark=0;var l=t.userData;l.mass=e,l.velocity=n.clone(),l.angularVelocity=r.clone(),l.breakable=i},subdivideByImpact:function(t,e,n,r,i,o){function a(i,o,p,d){if(Math.random()<.05*d||d>c)s.push(i);else{var f=Math.PI;0===d?(u.normal.copy(l.normal),u.constant=l.constant):d<=r?(f=(p-o)*(.2+.6*Math.random())+o,h.tempVector3_2.copy(t.position).sub(e).applyAxisAngle(n,f).add(e),u.setFromCoplanarPoints(e,h.tempVector3,h.tempVector3_2)):(f=(.5*(1&d)+.2*(2-Math.random()))*Math.PI,h.tempVector3_2.copy(e).sub(i.position).applyAxisAngle(n,f).add(i.position),h.tempVector3_3.copy(n).add(i.position),u.setFromCoplanarPoints(i.position,h.tempVector3_3,h.tempVector3_2)),h.cutByPlane(i,u,h.tempResultObjects);var m=h.tempResultObjects.object1,v=h.tempResultObjects.object2;m&&a(m,o,f,d+1),v&&a(v,f,p,d+1)}}var s=[],l=this.tempPlane1,u=this.tempPlane2;this.tempVector3.addVectors(e,n),l.setFromCoplanarPoints(e,t.position,this.tempVector3);var c=i+r,h=this;return a(t,0,2*Math.PI,0),s},cutByPlane:function(t,e,n){for(var r=t.geometry,i=r.vertices,o=r.faces,a=i.length,s=[],l=[],u=this.smallDelta,c=0;c<a;c++)i[c].mark=0;var h=a*a;for(c=0;c<h;c++)this.segments[c]=!1;c=0;for(var p=o.length-1;c<p;c++)for(var d=o[c],f=c+1,m=o.length;f<m;f++){var v=o[f];if(1-d.normal.dot(v.normal)<u){var g=d.a,y=d.b,b=d.c,_=v.a,x=v.b,w=v.c;g===_||g===x||g===w?y===_||y===x||y===w?(this.segments[g*a+y]=!0,this.segments[y*a+g]=!0):(this.segments[b*a+g]=!0,this.segments[g*a+b]=!0):y!==_&&y!==x&&y!==w||(this.segments[b*a+y]=!0,this.segments[y*a+b]=!0)}}var S=this.tempPlane1;t.updateMatrix(),Al.transformPlaneToLocalSpace(e,t.matrix,S);for(c=0,p=o.length;c<p;c++)for(var A=o[c],M=0;M<3;M++){var T=0===M?A.a:1===M?A.b:A.c,C=0===M?A.b:1===M?A.c:A.a;if(!this.segments[T*a+C]){this.segments[T*a+C]=!0,this.segments[C*a+T]=!0;var E=i[T],P=i[C];if(0===E.mark){if((N=S.distanceToPoint(E))>u)E.mark=2,l.push(E);else if(N<-u)E.mark=1,s.push(E);else{E.mark=3,s.push(E);var O=E.clone();O.mark=3,l.push(O)}}if(0===P.mark){var N;if((N=S.distanceToPoint(P))>u)P.mark=2,l.push(P);else if(N<-u)P.mark=1,s.push(P);else{P.mark=3,s.push(P);var L=P.clone();L.mark=3,l.push(L)}}var I=E.mark,D=P.mark;if(1===I&&2===D||2===I&&1===D){this.tempLine1.start.copy(E),this.tempLine1.end.copy(P);var F=S.intersectLine(this.tempLine1);if(void 0===F)return console.error("Internal error: segment does not intersect plane."),n.segmentedObject1=null,n.segmentedObject2=null,0;F.mark=1,s.push(F);var R=F.clone();R.mark=2,l.push(R)}}}var k=.5*t.userData.mass;this.tempCM1.set(0,0,0);var U=0,j=s.length;if(j>0){for(c=0;c<j;c++)this.tempCM1.add(s[c]);this.tempCM1.divideScalar(j);for(c=0;c<j;c++){(G=s[c]).sub(this.tempCM1),U=Math.max(U,G.x,G.y,G.z)}this.tempCM1.add(t.position)}this.tempCM2.set(0,0,0);var z=0,V=l.length;if(V>0){for(c=0;c<V;c++)this.tempCM2.add(l[c]);this.tempCM2.divideScalar(V);for(c=0;c<V;c++){var G;(G=l[c]).sub(this.tempCM2),z=Math.max(z,G.x,G.y,G.z)}this.tempCM2.add(t.position)}var H=null,W=null,X=0;return j>4&&((H=new B(new Zt(s),t.material)).position.copy(this.tempCM1),H.quaternion.copy(t.quaternion),this.prepareBreakableObject(H,k,t.userData.velocity,t.userData.angularVelocity,2*U>this.minSizeForBreak),X++),V>4&&((W=new B(new Zt(l),t.material)).position.copy(this.tempCM2),W.quaternion.copy(t.quaternion),this.prepareBreakableObject(W,k,t.userData.velocity,t.userData.angularVelocity,2*z>this.minSizeForBreak),X++),n.object1=H,n.object2=W,X}},Al.transformFreeVector=function(t,e){var n=t.x,r=t.y,i=t.z,o=e.elements;return t.x=o[0]*n+o[4]*r+o[8]*i,t.y=o[1]*n+o[5]*r+o[9]*i,t.z=o[2]*n+o[6]*r+o[10]*i,t},Al.transformFreeVectorInverse=function(t,e){var n=t.x,r=t.y,i=t.z,o=e.elements;return t.x=o[0]*n+o[1]*r+o[2]*i,t.y=o[4]*n+o[5]*r+o[6]*i,t.z=o[8]*n+o[9]*r+o[10]*i,t},Al.transformTiedVectorInverse=function(t,e){var n=t.x,r=t.y,i=t.z,o=e.elements;return t.x=o[0]*n+o[1]*r+o[2]*i-o[12],t.y=o[4]*n+o[5]*r+o[6]*i-o[13],t.z=o[8]*n+o[9]*r+o[10]*i-o[14],t},Al.transformPlaneToLocalSpace=function(){var t=new i;new u;return function(e,n,r){r.normal.copy(e.normal),r.constant=e.constant;var i=Al.transformTiedVectorInverse(e.coplanarPoint(t),n);Al.transformFreeVectorInverse(r.normal,n),r.constant=-i.dot(r.normal)}}(),Object.assign(Jt.prototype,{getPoint:function(){return console.warn("Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){var n=this.getUtoTmapping(t);return this.getPoint(n,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,r=[],i=this.getPoint(0),o=0;for(r.push(0),n=1;n<=t;n++)o+=(e=this.getPoint(n/t)).distanceTo(i),r.push(o),i=e;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n,r=this.getLengths(),i=0,o=r.length;n=e||t*r[o-1];for(var a,s=0,l=o-1;s<=l;)if(i=Math.floor(s+(l-s)/2),(a=r[i]-n)<0)s=i+1;else{if(!(a>0)){l=i;break}l=i-1}if(i=l,r[i]===n)return i/(o-1);var u=r[i];return(i+(n-u)/(r[i+1]-u))/(o-1)},getTangent:function(t){var e=t-1e-4,n=t+1e-4;e<0&&(e=0),n>1&&(n=1);var r=this.getPoint(e);return this.getPoint(n).clone().sub(r).normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},computeFrenetFrames:function(t,e){var n,o,a=new i,s=[],l=[],u=[],c=new i,h=new r;for(n=0;n<=t;n++)s[n]=this.getTangentAt(n/t),s[n].normalize();l[0]=new i,u[0]=new i;var p=Number.MAX_VALUE,d=Math.abs(s[0].x),f=Math.abs(s[0].y),m=Math.abs(s[0].z);for(d<=p&&(p=d,a.set(1,0,0)),f<=p&&(p=f,a.set(0,1,0)),m<=p&&a.set(0,0,1),c.crossVectors(s[0],a).normalize(),l[0].crossVectors(s[0],c),u[0].crossVectors(s[0],l[0]),n=1;n<=t;n++)l[n]=l[n-1].clone(),u[n]=u[n-1].clone(),c.crossVectors(s[n-1],s[n]),c.length()>Number.EPSILON&&(c.normalize(),o=Math.acos(xo.clamp(s[n-1].dot(s[n]),-1,1)),l[n].applyMatrix4(h.makeRotationAxis(c,o))),u[n].crossVectors(s[n],l[n]);if(!0===e)for(o=Math.acos(xo.clamp(l[0].dot(l[t]),-1,1)),o/=t,s[0].dot(c.crossVectors(l[0],l[t]))>0&&(o=-o),n=1;n<=t;n++)l[n].applyMatrix4(h.makeRotationAxis(s[n],o*n)),u[n].crossVectors(s[n],l[n]);return{tangents:s,normals:l,binormals:u}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),(Kt.prototype=Object.create(Jt.prototype)).constructor=Kt,Kt.prototype.getPoint=function(t,e){var n=e||new i;t=2*Math.PI*t;var r=-.22*Math.cos(t)-1.28*Math.sin(t)-.44*Math.cos(3*t)-.78*Math.sin(3*t),o=-.1*Math.cos(2*t)-.27*Math.sin(2*t)+.38*Math.cos(4*t)+.46*Math.sin(4*t),a=.7*Math.cos(3*t)-.4*Math.sin(3*t);return n.set(r,o,a).multiplyScalar(20)},($t.prototype=Object.create(Jt.prototype)).constructor=$t,$t.prototype.getPoint=function(t,e){var n=e||new i;t*=2*Math.PI;var r=16*Math.pow(Math.sin(t),3),o=13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t);return n.set(r,o,0).multiplyScalar(this.scale)},(te.prototype=Object.create(Jt.prototype)).constructor=te,te.prototype.getPoint=function(t,e){var n=e||new i;t=4*t*Math.PI;var r=this.scale/2,o=r*(1+Math.cos(t)),a=r*Math.sin(t),s=2*r*Math.sin(t/2);return n.set(o,a,s)},(ee.prototype=Object.create(Jt.prototype)).constructor=ee,ee.prototype.getPoint=function(t,e){var n=e||new i;t*=2*Math.PI;var r=50*Math.sin(t),o=Math.cos(t)*(10+50*Math.cos(t)),a=Math.sin(t)*(10+50*Math.cos(t));return n.set(r,o,a)},(ne.prototype=Object.create(Jt.prototype)).constructor=ne,ne.prototype.getPoint=function(t,e){var n=e||new i,r=2*Math.PI*t*150/30,o=30*Math.cos(r),a=30*Math.sin(r);return n.set(o,a,150*t)},(re.prototype=Object.create(Jt.prototype)).constructor=re,re.prototype.getPoint=function(t,e){var n=e||new i;t*=2*Math.PI;var r=(2+Math.cos(3*t))*Math.cos(2*t),o=(2+Math.cos(3*t))*Math.sin(2*t),a=Math.sin(3*t);return n.set(r,o,a).multiplyScalar(this.scale)},(ie.prototype=Object.create(Jt.prototype)).constructor=ie,ie.prototype.getPoint=function(t,e){var n=e||new i;t*=2*Math.PI;var r=(2+Math.cos(4*t))*Math.cos(3*t),o=(2+Math.cos(4*t))*Math.sin(3*t),a=Math.sin(4*t);return n.set(r,o,a).multiplyScalar(this.scale)},(ae.prototype=Object.create(Jt.prototype)).constructor=ae,ae.prototype.getPoint=function(t,e){var n=e||new i;t*=2*Math.PI;var r=(2+Math.cos(5*t))*Math.cos(2*t),o=(2+Math.cos(5*t))*Math.sin(2*t),a=Math.sin(5*t);return n.set(r,o,a).multiplyScalar(this.scale)},(se.prototype=Object.create(Jt.prototype)).constructor=se,se.prototype.getPoint=function(t,e){var n=e||new i;t=4*t-2;var r=Math.pow(t,3)-3*t,o=Math.pow(t,4)-4*t*t,a=.2*Math.pow(t,5)-2*t;return n.set(r,o,a).multiplyScalar(this.scale)};(le.prototype=Object.create(Jt.prototype)).constructor=le,le.prototype.getPoint=function(t,e){var n=e||new i,r=.4*(t=function(t,e,n){return n*(e-t)+t}(-4,4,t))*(t*t-7)*(t*t-10),o=Math.pow(t,4)-13*t*t;return n.set(r,o,.1*t*(t*t-4)*(t*t-9)*(t*t-12)).multiplyScalar(this.scale)},(ue.prototype=Object.create(Jt.prototype)).constructor=ue,ue.prototype.getPoint=function(t,e){var n=e||new i;t*=2*Math.PI;var r=Math.cos(2*t)*(1+.6*(Math.cos(5*t)+.75*Math.cos(10*t))),o=Math.sin(2*t)*(1+.6*(Math.cos(5*t)+.75*Math.cos(10*t))),a=.35*Math.sin(5*t);return n.set(r,o,a).multiplyScalar(this.scale)},(ce.prototype=Object.create(Jt.prototype)).constructor=ce,ce.prototype.getPoint=function(t,e){var n=e||new i,r=t*Math.PI*2,o=Math.cos(2*r)*(1+.45*Math.cos(3*r)+.4*Math.cos(9*r)),a=Math.sin(2*r)*(1+.45*Math.cos(3*r)+.4*Math.cos(9*r)),s=.2*Math.sin(9*r);return n.set(o,a,s).multiplyScalar(this.scale)},(he.prototype=Object.create(Jt.prototype)).constructor=he,he.prototype.getPoint=function(t,e){var n=e||new i,r=t*Math.PI*2,o=Math.cos(3*r)*(1+.3*Math.cos(5*r)+.5*Math.cos(10*r)),a=Math.sin(3*r)*(1+.3*Math.cos(5*r)+.5*Math.cos(10*r)),s=.2*Math.sin(20*r);return n.set(o,a,s).multiplyScalar(this.scale)},(pe.prototype=Object.create(Jt.prototype)).constructor=pe,pe.prototype.getPoint=function(t,e){var n=e||new i,r=t*Math.PI*2,o=Math.cos(4*r)*(1+.5*(Math.cos(5*r)+.4*Math.cos(20*r))),a=Math.sin(4*r)*(1+.5*(Math.cos(5*r)+.4*Math.cos(20*r))),s=.35*Math.sin(15*r);return n.set(o,a,s).multiplyScalar(this.scale)};var Ml={findSpan:function(t,e,n){var r=n.length-t-1;if(e>=n[r])return r-1;if(e<=n[t])return t;for(var i=t,o=r,a=Math.floor((i+o)/2);e<n[a]||e>=n[a+1];)e<n[a]?o=a:i=a,a=Math.floor((i+o)/2);return a},calcBasisFunctions:function(t,e,n,r){var i=[],o=[],a=[];i[0]=1;for(var s=1;s<=n;++s){o[s]=e-r[t+1-s],a[s]=r[t+s]-e;for(var l=0,u=0;u<s;++u){var c=a[u+1],h=o[s-u],p=i[u]/(c+h);i[u]=l+c*p,l=h*p}i[s]=l}return i},calcBSplinePoint:function(t,e,n,r){for(var i=this.findSpan(t,r,e),o=this.calcBasisFunctions(i,r,t,e),a=new g(0,0,0,0),s=0;s<=t;++s){var l=n[i-t+s],u=o[s],c=l.w*u;a.x+=l.x*c,a.y+=l.y*c,a.z+=l.z*c,a.w+=l.w*u}return a},calcBasisFunctionDerivatives:function(t,e,n,r,i){for(var o=[],a=0;a<=n;++a)o[a]=0;var s=[];for(a=0;a<=r;++a)s[a]=o.slice(0);var l=[];for(a=0;a<=n;++a)l[a]=o.slice(0);l[0][0]=1;for(var u=o.slice(0),c=o.slice(0),h=1;h<=n;++h){u[h]=e-i[t+1-h],c[h]=i[t+h]-e;for(var p=0,d=0;d<h;++d){var f=c[d+1],m=u[h-d];l[h][d]=f+m;var v=l[d][h-1]/l[h][d];l[d][h]=p+f*v,p=m*v}l[h][h]=p}for(h=0;h<=n;++h)s[0][h]=l[h][n];for(d=0;d<=n;++d){var g=0,y=1,b=[];for(a=0;a<=n;++a)b[a]=o.slice(0);b[0][0]=1;for(var _=1;_<=r;++_){var x=0,w=d-_,S=n-_;d>=_&&(b[y][0]=b[g][0]/l[S+1][w],x=b[y][0]*l[w][S]);var A=d-1<=S?_-1:n-d;for(h=w>=-1?1:-w;h<=A;++h)b[y][h]=(b[g][h]-b[g][h-1])/l[S+1][w+h],x+=b[y][h]*l[w+h][S];d<=S&&(b[y][_]=-b[g][_-1]/l[S+1][d],x+=b[y][_]*l[d][S]),s[_][d]=x;h=g;g=y,y=h}}for(d=n,_=1;_<=r;++_){for(h=0;h<=n;++h)s[_][h]*=d;d*=n-_}return s},calcBSplineDerivatives:function(t,e,n,r,i){for(var o=i<t?i:t,a=[],s=this.findSpan(t,r,e),l=this.calcBasisFunctionDerivatives(s,r,t,o,e),u=[],c=0;c<n.length;++c){var h=(d=n[c].clone()).w;d.x*=h,d.y*=h,d.z*=h,u[c]=d}for(var p=0;p<=o;++p){for(var d=u[s-t].clone().multiplyScalar(l[p][0]),f=1;f<=t;++f)d.add(u[s-t+f].clone().multiplyScalar(l[p][f]));a[p]=d}for(p=o+1;p<=i+1;++p)a[p]=new g(0,0,0);return a},calcKoverI:function(t,e){for(var n=1,r=2;r<=t;++r)n*=r;var i=1;for(r=2;r<=e;++r)i*=r;for(r=2;r<=t-e;++r)i*=r;return n/i},calcRationalCurveDerivatives:function(t){for(var e=t.length,n=[],r=[],o=0;o<e;++o){var a=t[o];n[o]=new i(a.x,a.y,a.z),r[o]=a.w}for(var s=[],l=0;l<e;++l){var u=n[l].clone();for(o=1;o<=l;++o)u.sub(s[l-o].clone().multiplyScalar(this.calcKoverI(l,o)*r[o]));s[l]=u.divideScalar(r[0])}return s},calcNURBSDerivatives:function(t,e,n,r,i){var o=this.calcBSplineDerivatives(t,e,n,r,i);return this.calcRationalCurveDerivatives(o)},calcSurfacePoint:function(t,e,n,r,o,a,s){for(var l=this.findSpan(t,a,n),u=this.findSpan(e,s,r),c=this.calcBasisFunctions(l,a,t,n),h=this.calcBasisFunctions(u,s,e,r),p=[],d=0;d<=e;++d){p[d]=new g(0,0,0,0);for(var f=0;f<=t;++f){var m=o[l-t+f][u-e+d].clone(),v=m.w;m.x*=v,m.y*=v,m.z*=v,p[d].add(m.multiplyScalar(c[f]))}}var y=new g(0,0,0,0);for(d=0;d<=e;++d)y.add(p[d].multiplyScalar(h[d]));return y.divideScalar(y.w),new i(y.x,y.y,y.z)}},Tl=function(t,e,n,r,i){Jt.call(this),this.degree=t,this.knots=e,this.controlPoints=[],this.startKnot=r||0,this.endKnot=i||this.knots.length-1;for(var o=0;o<n.length;++o){var a=n[o];this.controlPoints[o]=new g(a.x,a.y,a.z,a.w)}};Tl.prototype=Object.create(Jt.prototype),Tl.prototype.constructor=Tl,Tl.prototype.getPoint=function(t){var e=Ml.calcBSplinePoint(this.degree,this.knots,this.controlPoints,this.knots[this.startKnot]+t*(this.knots[this.endKnot]-this.knots[this.startKnot]));return 1!=e.w&&e.divideScalar(e.w),new i(e.x,e.y,e.z)},Tl.prototype.getTangent=function(t){var e=Ml.calcNURBSDerivatives(this.degree,this.knots,this.controlPoints,this.knots[0]+t*(this.knots[this.knots.length-1]-this.knots[0]),1)[1].clone();return e.normalize(),e};var Cl=function(t,e,n,r,i){this.degree1=t,this.degree2=e,this.knots1=n,this.knots2=r,this.controlPoints=[];for(var o=n.length-t-1,a=r.length-e-1,s=0;s<o;++s){this.controlPoints[s]=[];for(var l=0;l<a;++l){var u=i[s][l];this.controlPoints[s][l]=new g(u.x,u.y,u.z,u.w)}}};Cl.prototype={constructor:Cl,getPoint:function(t,e){return Ml.calcSurfacePoint(this.degree1,this.degree2,this.knots1,this.knots2,this.controlPoints,this.knots1[0]+t*(this.knots1[this.knots1.length-1]-this.knots1[0]),this.knots2[0]+e*(this.knots2[this.knots2.length-1]-this.knots2[0]))}};var El={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var t=document.createElement("canvas");return!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(t){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var t=document.createElement("div");return t.id="webgl-error-message",t.style.fontFamily="monospace",t.style.fontSize="13px",t.style.fontWeight="normal",t.style.textAlign="center",t.style.background="#fff",t.style.color="#000",t.style.padding="1.5em",t.style.width="400px",t.style.margin="5em auto 0",this.webgl||(t.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n")),t},addGetWebGLMessage:function(t){var e,n,r;e=void 0!==(t=t||{}).parent?t.parent:document.body,n=void 0!==t.id?t.id:"oldie",(r=El.getWebGLErrorMessage()).id=n,e.appendChild(r)}};Object.assign(de.prototype,{update:function(){var t,e,n,i,o,a,s,l,u=new r,c=new r;return function(r){if(t!==this||e!==r.focus||n!==r.fov||i!==r.aspect*this.aspect||o!==r.near||a!==r.far||s!==r.zoom||l!==this.eyeSep){t=this,e=r.focus,n=r.fov,i=r.aspect*this.aspect,o=r.near,a=r.far,s=r.zoom;var h,p,d=r.projectionMatrix.clone(),f=(l=this.eyeSep/2)*o/e,m=o*Math.tan(xo.DEG2RAD*n*.5)/s;c.elements[12]=-l,u.elements[12]=l,d.elements[0]=2*o/((p=m*i+f)-(h=-m*i+f)),d.elements[8]=(p+h)/(p-h),this.cameraL.projectionMatrix.copy(d),d.elements[0]=2*o/((p=m*i-f)-(h=-m*i-f)),d.elements[8]=(p+h)/(p-h),this.cameraR.projectionMatrix.copy(d)}this.cameraL.matrixWorld.copy(r.matrixWorld).multiply(c),this.cameraR.matrixWorld.copy(r.matrixWorld).multiply(u)}}()});var Pl={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit(  ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit(  );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars_begin:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n",lights_pars_maps:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance(  const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance(  const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance(  geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance(  geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance(  geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif\n",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\t\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\t\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n"},Ol={common:{diffuse:{value:new h(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new u},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new m(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new h(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new h(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new u}}},Nl={basic:{uniforms:tl.merge([Ol.common,Ol.specularmap,Ol.envmap,Ol.aomap,Ol.lightmap,Ol.fog]),vertexShader:Pl.meshbasic_vert,fragmentShader:Pl.meshbasic_frag},lambert:{uniforms:tl.merge([Ol.common,Ol.specularmap,Ol.envmap,Ol.aomap,Ol.lightmap,Ol.emissivemap,Ol.fog,Ol.lights,{emissive:{value:new h(0)}}]),vertexShader:Pl.meshlambert_vert,fragmentShader:Pl.meshlambert_frag},phong:{uniforms:tl.merge([Ol.common,Ol.specularmap,Ol.envmap,Ol.aomap,Ol.lightmap,Ol.emissivemap,Ol.bumpmap,Ol.normalmap,Ol.displacementmap,Ol.gradientmap,Ol.fog,Ol.lights,{emissive:{value:new h(0)},specular:{value:new h(1118481)},shininess:{value:30}}]),vertexShader:Pl.meshphong_vert,fragmentShader:Pl.meshphong_frag},standard:{uniforms:tl.merge([Ol.common,Ol.envmap,Ol.aomap,Ol.lightmap,Ol.emissivemap,Ol.bumpmap,Ol.normalmap,Ol.displacementmap,Ol.roughnessmap,Ol.metalnessmap,Ol.fog,Ol.lights,{emissive:{value:new h(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Pl.meshphysical_vert,fragmentShader:Pl.meshphysical_frag},points:{uniforms:tl.merge([Ol.points,Ol.fog]),vertexShader:Pl.points_vert,fragmentShader:Pl.points_frag},dashed:{uniforms:tl.merge([Ol.common,Ol.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Pl.linedashed_vert,fragmentShader:Pl.linedashed_frag},depth:{uniforms:tl.merge([Ol.common,Ol.displacementmap]),vertexShader:Pl.depth_vert,fragmentShader:Pl.depth_frag},normal:{uniforms:tl.merge([Ol.common,Ol.bumpmap,Ol.normalmap,Ol.displacementmap,{opacity:{value:1}}]),vertexShader:Pl.normal_vert,fragmentShader:Pl.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Pl.cube_vert,fragmentShader:Pl.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Pl.equirect_vert,fragmentShader:Pl.equirect_frag},distanceRGBA:{uniforms:tl.merge([Ol.common,Ol.displacementmap,{referencePosition:{value:new i},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Pl.distanceRGBA_vert,fragmentShader:Pl.distanceRGBA_frag},shadow:{uniforms:tl.merge([Ol.lights,Ol.fog,{color:{value:new h(0)},opacity:{value:1}}]),vertexShader:Pl.shadow_vert,fragmentShader:Pl.shadow_frag}};Nl.physical={uniforms:tl.merge([Nl.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Pl.meshphysical_vert,fragmentShader:Pl.meshphysical_frag};var Ll="\\[\\]\\.:\\/";Object.assign(fe.prototype,{getValue:function(t,e){this.bind();var n=this._bindings[this._targetGroup.nCachedObjects_];void 0!==n&&n.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(me,{Composite:fe,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new me.Composite(t,e,n):new me(t,e,n)},sanitizeNodeName:function(){var t=new RegExp("["+Ll+"]","g");return function(e){return e.replace(/\s/g,"_").replace(t,"")}}(),parseTrackName:function(){var t="[^"+Ll+"]",e="[^"+Ll.replace("\\.","")+"]",n=/((?:WC+[\/:])*)/.source.replace("WC",t),r=/(WCOD+)?/.source.replace("WCOD",e),i=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",t),o=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",t),a=new RegExp("^"+n+r+i+o+"$"),s=["material","materials","bones"];return function(t){var e=a.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==s.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}}(),findNode:function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){var r=function(t){for(var n=0;n<t.length;n++){var i=t[n];if(i.name===e||i.uuid===e)return i;var o=r(i.children);if(o)return o}return null},i=r(t.children);if(i)return i}return null}}),Object.assign(me.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)t[e++]=n[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,r=e.propertyName,i=e.propertyIndex;if(t||(t=me.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(n){var o=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var a=0;a<t.length;a++)if(t[a].name===o){o=a;break}break;default:if(void 0===t[n])return void console.error("PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==o){if(void 0===t[o])return void console.error("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}var s=t[r];if(void 0!==s){var l=this.Versioning.None;void 0!==t.needsUpdate?(l=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t);var u=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(t.geometry.morphAttributes.position[a].name===i){i=a;break}}else{if(!t.geometry.morphTargets)return void console.error("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(t.geometry.morphTargets[a].name===i){i=a;break}}}u=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(u=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][l]}else{var c=e.nodeName;console.error("PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",t)}}else console.error("PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(me.prototype,{_getValue_unbound:me.prototype.getValue,_setValue_unbound:me.prototype.setValue});var Il={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,FLOAT:5126,UNSIGNED_INT:5125,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987},Dl={1003:Il.NEAREST,1004:Il.NEAREST_MIPMAP_NEAREST,1005:Il.NEAREST_MIPMAP_LINEAR,1006:Il.LINEAR,1007:Il.LINEAR_MIPMAP_NEAREST,1008:Il.LINEAR_MIPMAP_LINEAR},Fl={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},Rl=function(){};Rl.prototype={constructor:Rl,parse:function(t,e,n){function r(t,e){return t.length===e.length&&t.every(function(t,n){return t===e[n]})}function i(t){return 4*Math.ceil(t/4)}function o(t,e){e=e||0;var n=i(t.byteLength);if(n!==t.byteLength){var r=new Uint8Array(n);if(r.set(new Uint8Array(t)),0!==e)for(var o=t.byteLength;o<n;o++)r[o]=e;return r.buffer}return t}function a(t){return v.buffers||(v.buffers=[{byteLength:0}]),b.push(t),0}function s(t,e,r,o){v.accessors||(v.accessors=[]);var s;if(t.array.constructor===Float32Array)s=Il.FLOAT;else if(t.array.constructor===Uint32Array)s=Il.UNSIGNED_INT;else{if(t.array.constructor!==Uint16Array)throw new Error("GLTFExporter: Unsupported bufferAttribute component type.");s=Il.UNSIGNED_SHORT}if(void 0===r&&(r=0),void 0===o&&(o=t.count),n.truncateDrawRange&&void 0!==e&&null===e.index){var l=r+o,u=e.drawRange.count===1/0?t.count:e.drawRange.start+e.drawRange.count;r=Math.max(r,e.drawRange.start),(o=Math.min(l,u)-r)<0&&(o=0)}var c,h=function(t,e,n){for(var r={min:new Array(t.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(t.itemSize).fill(Number.NEGATIVE_INFINITY)},i=e;i<e+n;i++)for(var o=0;o<t.itemSize;o++){var a=t.array[i*t.itemSize+o];r.min[o]=Math.min(r.min[o],a),r.max[o]=Math.max(r.max[o],a)}return r}(t,r,o);void 0!==e&&(c=t===e.index?Il.ELEMENT_ARRAY_BUFFER:Il.ARRAY_BUFFER);var p=function(t,e,n,r,o){v.bufferViews||(v.bufferViews=[]);for(var s=e===Il.UNSIGNED_SHORT?2:4,l=i(r*t.itemSize*s),u=new DataView(new ArrayBuffer(l)),c=0,h=n;h<n+r;h++)for(var p=0;p<t.itemSize;p++){var d=t.array[h*t.itemSize+p];e===Il.FLOAT?u.setFloat32(c,d,!0):e===Il.UNSIGNED_INT?u.setUint32(c,d,!0):e===Il.UNSIGNED_SHORT&&u.setUint16(c,d,!0),c+=s}var f={buffer:a(u.buffer),byteOffset:g,byteLength:l};return void 0!==o&&(f.target=o),o===Il.ARRAY_BUFFER&&(f.byteStride=t.itemSize*s),g+=l,v.bufferViews.push(f),{id:v.bufferViews.length-1,byteLength:0}}(t,s,r,o,c);return v.accessors.push({bufferView:p.id,byteOffset:p.byteOffset,componentType:s,count:o,max:h.max,min:h.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",16:"MAT4"}[t.itemSize]}),v.accessors.length-1}function l(t){v.images||(v.images=[]);var e=t.format===ns?"image/png":"image/jpeg",r={mimeType:e};if(n.embedImages){var i=m=m||document.createElement("canvas");i.width=t.image.width,i.height=t.image.height,n.forcePowerOfTwoTextures&&!function(t){return xo.isPowerOfTwo(t.width)&&xo.isPowerOfTwo(t.height)}(t.image)&&(console.warn("GLTFExporter: Resized non-power-of-two image.",t.image),i.width=xo.floorPowerOfTwo(i.width),i.height=xo.floorPowerOfTwo(i.height));var s=i.getContext("2d");!0===t.flipY&&(s.translate(0,i.height),s.scale(1,-1)),s.drawImage(t.image,0,0,i.width,i.height),!0===n.binary?_.push(new Promise(function(t){i.toBlob(function(e){(function(t){return v.bufferViews||(v.bufferViews=[]),new Promise(function(e){var n=new window.FileReader;n.readAsArrayBuffer(t),n.onloadend=function(){var t=o(n.result),r={buffer:a(t),byteOffset:g,byteLength:t.byteLength};g+=t.byteLength,v.bufferViews.push(r),e(v.bufferViews.length-1)}})})(e).then(function(e){r.bufferView=e,t()})},e)})):r.uri=i.toDataURL(e)}else r.uri=t.image.src;return v.images.push(r),v.images.length-1}function u(t){if(A.textures.has(t))return A.textures.get(t);v.textures||(v.textures=[]);var e={sampler:function(t){return v.samplers||(v.samplers=[]),v.samplers.push({magFilter:Dl[t.magFilter],minFilter:Dl[t.minFilter],wrapS:Dl[t.wrapS],wrapT:Dl[t.wrapT]}),v.samplers.length-1}(t),source:l(t)};v.textures.push(e);var n=v.textures.length-1;return A.textures.set(t,n),n}function c(t){if(A.materials.has(t))return A.materials.get(t);if(v.materials||(v.materials=[]),t.isShaderMaterial)return console.warn("GLTFExporter: ShaderMaterial not supported."),null;var e={pbrMetallicRoughness:{}};t.isMeshBasicMaterial?(e.extensions={KHR_materials_unlit:{}},S.KHR_materials_unlit=!0):t.isMeshStandardMaterial||console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");var n=t.color.toArray().concat([t.opacity]);if(r(n,[1,1,1,1])||(e.pbrMetallicRoughness.baseColorFactor=n),t.isMeshStandardMaterial?(e.pbrMetallicRoughness.metallicFactor=t.metalness,e.pbrMetallicRoughness.roughnessFactor=t.roughness):t.isMeshBasicMaterial?(e.pbrMetallicRoughness.metallicFactor=0,e.pbrMetallicRoughness.roughnessFactor=.9):(e.pbrMetallicRoughness.metallicFactor=.5,e.pbrMetallicRoughness.roughnessFactor=.5),(t.metalnessMap||t.roughnessMap)&&(t.metalnessMap===t.roughnessMap?e.pbrMetallicRoughness.metallicRoughnessTexture={index:u(t.metalnessMap)}:console.warn("GLTFExporter: Ignoring metalnessMap and roughnessMap because they are not the same Texture.")),t.map&&(e.pbrMetallicRoughness.baseColorTexture={index:u(t.map)}),t.isMeshBasicMaterial||t.isLineBasicMaterial||t.isPointsMaterial);else{var i=t.emissive.clone().multiplyScalar(t.emissiveIntensity).toArray();r(i,[0,0,0])||(e.emissiveFactor=i),t.emissiveMap&&(e.emissiveTexture={index:u(t.emissiveMap)})}t.normalMap&&(e.normalTexture={index:u(t.normalMap)},-1!==t.normalScale.x&&(t.normalScale.x!==t.normalScale.y&&console.warn("GLTFExporter: Normal scale components are different, ignoring Y and exporting X."),e.normalTexture.scale=t.normalScale.x)),t.aoMap&&(e.occlusionTexture={index:u(t.aoMap)},1!==t.aoMapIntensity&&(e.occlusionTexture.strength=t.aoMapIntensity)),(t.transparent||t.alphaTest>0)&&(e.alphaMode=t.opacity<1?"BLEND":"MASK",t.alphaTest>0&&.5!==t.alphaTest&&(e.alphaCutoff=t.alphaTest)),t.side===ko&&(e.doubleSided=!0),""!==t.name&&(e.name=t.name),v.materials.push(e);var o=v.materials.length-1;return A.materials.set(t,o),o}function h(t,e){v.animations||(v.animations=[]);for(var n=[],r=[],i=0;i<t.tracks.length;++i){var o=t.tracks[i],a=me.parseTrackName(o.name),l=me.findNode(e,a.nodeName),u=Fl[a.propertyName];if("bones"===a.objectName&&(l=!0===l.isSkinnedMesh?l.skeleton.getBoneByName(a.objectIndex):void 0),!l||!u)return console.warn('GLTFExporter: Could not export animation track "%s".',o.name),null;var c=o.values.length/o.times.length;u===Fl.morphTargetInfluences&&(c/=l.morphTargetInfluences.length);var h;!0===o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(h="CUBICSPLINE",c/=3):h=o.getInterpolation()===Ls?"STEP":"LINEAR",r.push({input:s(new y(o.times,1)),output:s(new y(o.values,c)),interpolation:h}),n.push({sampler:r.length-1,target:{node:x.get(l),path:u}})}return v.animations.push({name:t.name||"clip_"+v.animations.length,samplers:r,channels:n}),v.animations.length-1}function p(t){var e=v.nodes[x.get(t)],n=t.skeleton,r=t.skeleton.bones[0];if(void 0===r)return null;for(var i=[],o=new Float32Array(16*n.bones.length),a=0;a<n.bones.length;++a)i.push(x.get(n.bones[a])),n.boneInverses[a].toArray(o,16*a);void 0===v.skins&&(v.skins=[]),v.skins.push({inverseBindMatrices:s(new y(o,16)),joints:i,skeleton:x.get(r)});return e.skin=v.skins.length-1}function d(t){if(t.isLight)return console.warn("GLTFExporter: Unsupported node type:",t.constructor.name),null;v.nodes||(v.nodes=[]);var e={};if(n.trs){var i=t.quaternion.toArray(),o=t.position.toArray(),a=t.scale.toArray();r(i,[0,0,0,1])||(e.rotation=i),r(o,[0,0,0])||(e.translation=o),r(a,[1,1,1])||(e.scale=a)}else t.updateMatrix(),r(t.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])||(e.matrix=t.matrix.elements);if(""!==t.name&&(e.name=String(t.name)),t.userData&&Object.keys(t.userData).length>0)try{e.extras=JSON.parse(JSON.stringify(t.userData))}catch(t){throw new Error("GLTFExporter: userData can't be serialized")}if(t.isMesh||t.isLine||t.isPoints?e.mesh=function(t){v.meshes||(v.meshes=[]);var e,r=t.geometry;if(t.isLineSegments)e=Il.LINES;else if(t.isLineLoop)e=Il.LINE_LOOP;else if(t.isLine)e=Il.LINE_STRIP;else if(t.isPoints)e=Il.POINTS;else{if(!r.isBufferGeometry){var i=new O;i.fromGeometry(r),r=i}t.drawMode===Rs?(console.warn("GLTFExporter: TriangleFanDrawMode and wireframe incompatible."),e=Il.TRIANGLE_FAN):e=t.drawMode===Fs?t.material.wireframe?Il.LINE_STRIP:Il.TRIANGLE_STRIP:t.material.wireframe?Il.LINES:Il.TRIANGLES}var o={},a={},l=[],u=[],h={uv:"TEXCOORD_0",uv2:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"};for(var p in r.attributes){var d=r.attributes[p];"MORPH"!==(p=h[p]||p.toUpperCase()).substr(0,5)&&(a[p]=s(d,r))}if(void 0!==t.morphTargetInfluences&&t.morphTargetInfluences.length>0){var f=[],m=[],g={};if(void 0!==t.morphTargetDictionary)for(var y in t.morphTargetDictionary)g[t.morphTargetDictionary[y]]=y;for(var b=0;b<t.morphTargetInfluences.length;++b){var _={},x=!1;for(var p in r.morphAttributes)if("position"===p||"normal"===p){for(var w=r.attributes[p],S=(d=r.morphAttributes[p][b]).clone(),A=0,M=d.count;A<M;A++)S.setXYZ(A,d.getX(A)-w.getX(A),d.getY(A)-w.getY(A),d.getZ(A)-w.getZ(A));_[p.toUpperCase()]=s(S,r)}else x||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),x=!0);u.push(_),f.push(t.morphTargetInfluences[b]),void 0!==t.morphTargetDictionary&&m.push(g[b])}o.weights=f,m.length>0&&(o.extras={},o.extras.targetNames=m)}var T=n.forceIndices,C=Array.isArray(t.material);!T&&null===r.index&&C&&(console.warn("GLTFExporter: Creating index for non-indexed multi-material mesh."),T=!0);var E=!1;if(null===r.index&&T){for(var P=[],N=(b=0,r.attributes.position.count);b<N;b++)P[b]=b;r.setIndex(P),E=!0}var L=C?t.material:[t.material],I=C?t.geometry.groups:[{materialIndex:0,start:void 0,count:void 0}];for(b=0,N=I.length;b<N;b++){var D={mode:e,attributes:a};u.length>0&&(D.targets=u);var F=c(L[I[b].materialIndex]);null!==F&&(D.material=F),null!==r.index&&(D.indices=s(r.index,r,I[b].start,I[b].count)),l.push(D)}return E&&r.setIndex(null),o.primitives=l,v.meshes.push(o),v.meshes.length-1}(t):t.isCamera&&(e.camera=function(t){v.cameras||(v.cameras=[]);var e=t.isOrthographicCamera,n={type:e?"orthographic":"perspective"};return e?n.orthographic={xmag:2*t.right,ymag:2*t.top,zfar:t.far<=0?.001:t.far,znear:t.near<0?0:t.near}:n.perspective={aspectRatio:t.aspect,yfov:xo.degToRad(t.fov)/t.aspect,zfar:t.far<=0?.001:t.far,znear:t.near<0?0:t.near},""!==t.name&&(n.name=t.type),v.cameras.push(n),v.cameras.length-1}(t)),t.isSkinnedMesh&&w.push(t),t.children.length>0){for(var l=[],u=0,h=t.children.length;u<h;u++){var p=t.children[u];if(p.visible||!1===n.onlyVisible){var f=d(p);null!==f&&l.push(f)}}l.length>0&&(e.children=l)}v.nodes.push(e);var m=v.nodes.length-1;return x.set(t,m),m}function f(t){v.scenes||(v.scenes=[],v.scene=0);var e={nodes:[]};""!==t.name&&(e.name=t.name),v.scenes.push(e);for(var r=[],i=0,o=t.children.length;i<o;i++){var a=t.children[i];if(a.visible||!1===n.onlyVisible){var s=d(a);null!==s&&r.push(s)}}r.length>0&&(e.nodes=r)}(n=Object.assign({},{trs:!1,onlyVisible:!0,truncateDrawRange:!0,embedImages:!0,animations:[],forceIndices:!1,forcePowerOfTwoTextures:!1},n)).animations.length>0&&(n.trs=!0);var m,v={asset:{version:"2.0",generator:"GLTFExporter"}},g=0,b=[],_=[],x=new Map,w=[],S={},A={materials:new Map,textures:new Map};!function(t){t=t instanceof Array?t:[t];for(var e=[],r=0;r<t.length;r++)t[r]instanceof ut?f(t[r]):e.push(t[r]);for(e.length>0&&function(t){var e=new ut;e.name="AuxScene";for(var n=0;n<t.length;n++)e.children.push(t[n]);f(e)}(e),r=0;r<w.length;++r)p(w[r]);for(r=0;r<n.animations.length;++r)h(n.animations[r],t[0])}(t),Promise.all(_).then(function(){var t=new Blob(b,{type:"application/octet-stream"}),r=Object.keys(S);if(r.length>0&&(v.extensionsUsed=r),v.buffers&&v.buffers.length>0){v.buffers[0].byteLength=t.size;var i=new window.FileReader;if(!0===n.binary){i.readAsArrayBuffer(t),i.onloadend=function(){var t=o(i.result),n=new DataView(new ArrayBuffer(8));n.setUint32(0,t.byteLength,!0),n.setUint32(4,5130562,!0);var r=o(function(t){if(void 0!==window.TextEncoder)return(new TextEncoder).encode(t).buffer;for(var e=new Uint8Array(new ArrayBuffer(t.length)),n=0,r=t.length;n<r;n++){var i=t.charCodeAt(n);e[n]=i>255?32:i}return e.buffer}(JSON.stringify(v)),32),a=new DataView(new ArrayBuffer(8));a.setUint32(0,r.byteLength,!0),a.setUint32(4,1313821514,!0);var s=new ArrayBuffer(12),l=new DataView(s);l.setUint32(0,1179937895,!0),l.setUint32(4,2,!0);l.setUint32(8,12+a.byteLength+r.byteLength+n.byteLength+t.byteLength,!0);var u=new Blob([s,a,r,n,t],{type:"application/octet-stream"}),c=new window.FileReader;c.readAsArrayBuffer(u),c.onloadend=function(){e(c.result)}}}else i.readAsDataURL(t),i.onloadend=function(){v.buffers[0].uri=i.result,e(v)}}else e(v)})}};var kl=function(){};kl.prototype={constructor:kl,parse:function(t){var e,n,r,o,a,s="",l=0,c=0,h=0,p=new i,d=new i,f=new m,g=[];return t.traverse(function(t){t instanceof B&&function(t){var r=0,i=0,m=0,y=t.geometry,b=new u;if(y instanceof v&&(y=(new O).setFromObject(t)),y instanceof O){var _=y.getAttribute("position"),x=y.getAttribute("normal"),w=y.getAttribute("uv"),S=y.getIndex();if(s+="o "+t.name+"\n",t.material&&t.material.name&&(s+="usemtl "+t.material.name+"\n"),void 0!==_)for(e=0,o=_.count;e<o;e++,r++)p.x=_.getX(e),p.y=_.getY(e),p.z=_.getZ(e),p.applyMatrix4(t.matrixWorld),s+="v "+p.x+" "+p.y+" "+p.z+"\n";if(void 0!==w)for(e=0,o=w.count;e<o;e++,m++)f.x=w.getX(e),f.y=w.getY(e),s+="vt "+f.x+" "+f.y+"\n";if(void 0!==x)for(b.getNormalMatrix(t.matrixWorld),e=0,o=x.count;e<o;e++,i++)d.x=x.getX(e),d.y=x.getY(e),d.z=x.getZ(e),d.applyMatrix3(b),s+="vn "+d.x+" "+d.y+" "+d.z+"\n";if(null!==S)for(e=0,o=S.count;e<o;e+=3){for(a=0;a<3;a++)n=S.getX(e+a)+1,g[a]=l+n+(x||w?"/"+(w?c+n:"")+(x?"/"+(h+n):""):"");s+="f "+g.join(" ")+"\n"}else for(e=0,o=_.count;e<o;e+=3){for(a=0;a<3;a++)g[a]=l+(n=e+a+1)+(x||w?"/"+(w?c+n:"")+(x?"/"+(h+n):""):"");s+="f "+g.join(" ")+"\n"}}else console.warn("OBJExporter.parseMesh(): geometry type unsupported",y);l+=r,c+=m,h+=i}(t),t instanceof z&&function(t){var i=0,a=t.geometry,u=t.type;if(a instanceof v&&(a=(new O).setFromObject(t)),a instanceof O){var c=a.getAttribute("position");if(s+="o "+t.name+"\n",void 0!==c)for(e=0,o=c.count;e<o;e++,i++)p.x=c.getX(e),p.y=c.getY(e),p.z=c.getZ(e),p.applyMatrix4(t.matrixWorld),s+="v "+p.x+" "+p.y+" "+p.z+"\n";if("Line"===u){for(s+="l ",n=1,o=c.count;n<=o;n++)s+=l+n+" ";s+="\n"}if("LineSegments"===u)for(r=1+(n=1),o=c.count;n<o;n+=2,r=n+1)s+="l "+(l+n)+" "+(l+r)+"\n"}else console.warn("OBJExporter.parseLine(): geometry type unsupported",a);l+=i}(t)}),s}};var Ul=function(){};Ul.prototype={constructor:Ul,parse:function(t,e){!0!==Array.isArray(e)&&(e=[]);var n=-1===e.indexOf("normal"),r=-1===e.indexOf("color"),o=-1===e.indexOf("uv"),a=0,s=0,l="",c="",h=new i,p=new u;t.traverse(function(t){if(t instanceof B){var e=t,i=e.geometry;if(i instanceof v&&(i=(new O).setFromObject(e)),i instanceof O){var u=i.getAttribute("position"),d=i.getAttribute("normal"),f=i.getAttribute("uv"),m=i.getAttribute("color"),g=i.getIndex();if(p.getNormalMatrix(e.matrixWorld),void 0===u)return;for(b=0,_=u.count;b<_;b++){h.x=u.getX(b),h.y=u.getY(b),h.z=u.getZ(b),h.applyMatrix4(e.matrixWorld);var y=h.x+" "+h.y+" "+h.z;!0===n&&(void 0!==d?(h.x=d.getX(b),h.y=d.getY(b),h.z=d.getZ(b),h.applyMatrix3(p),y+=" "+h.x+" "+h.y+" "+h.z):y+=" 0 0 0"),!0===o&&(void 0!==f?y+=" "+f.getX(b)+" "+f.getY(b):!1!==o&&(y+=" 0 0")),!0===r&&(y+=void 0!==m?" "+Math.floor(m.getX(b))+" "+Math.floor(m.getY(b))+" "+Math.floor(m.getZ(b)):" 255 255 255"),l+=y+"\n"}if(null!==g)for(b=0,_=g.count;b<_;b+=3)c+="3 "+(g.getX(b+0)+a),c+=" "+(g.getX(b+1)+a),c+=" "+(g.getX(b+2)+a)+"\n";else for(var b=0,_=u.count;b<_;b+=3)c+="3 "+(a+b)+" "+(a+b+1)+" "+(a+b+2)+"\n";a+=u.count,s+=g?g.count/3:u.count/3}}});var d="ply\nformat ascii 1.0\nelement vertex "+a+"\nproperty float x\nproperty float y\nproperty float z\n";return!0===n&&(d+="property float nx\nproperty float ny\nproperty float nz\n"),!0===o&&(d+="property float s\nproperty float t\n"),!0===r&&(d+="property uchar red\nproperty uchar green\nproperty uchar blue\n"),d+="element face "+s+"\nproperty list uchar int vertex_index\nend_header\n"+l+"\n"+c+"\n"}};var jl=function(){};jl.prototype={constructor:jl,parse:function(){var t=new i,e=new u;return function(n){var r=[],i=0;n.traverse(function(t){if(t instanceof B){var e=t.geometry;e instanceof O&&(e=(new v).fromBufferGeometry(e)),e instanceof v&&(i+=e.faces.length,r.push({geometry:e,matrix:t.matrixWorld}))}});var o=80,a=2*i+3*i*4*4+80+4,s=new ArrayBuffer(a),l=new DataView(s);return l.setUint32(o,i,!0),o+=4,r.forEach(function(n){var r=n.geometry.vertices,i=n.geometry.faces;e.getNormalMatrix(n.matrix);for(var a=0,s=i.length;a<s;a++){var u=i[a];t.copy(u.normal).applyMatrix3(e).normalize(),l.setFloat32(o,t.x,!0),l.setFloat32(o+=4,t.y,!0),l.setFloat32(o+=4,t.z,!0),o+=4;for(var c=[u.a,u.b,u.c],h=0;h<3;h++)t.copy(r[c[h]]).applyMatrix4(n.matrix),l.setFloat32(o,t.x,!0),l.setFloat32(o+=4,t.y,!0),l.setFloat32(o+=4,t.z,!0),o+=4;l.setUint16(o,0,!0),o+=2}}),l}}()};var Bl=function(){};Bl.prototype={constructor:Bl,parse:function(){var t=new i,e=new u;return function(n){var r="";return r+="solid exported\n",n.traverse(function(n){if(n instanceof B){var i=n.geometry,o=n.matrixWorld;if(i instanceof O&&(i=(new v).fromBufferGeometry(i)),i instanceof v){var a=i.vertices,s=i.faces;e.getNormalMatrix(o);for(var l=0,u=s.length;l<u;l++){var c=s[l];t.copy(c.normal).applyMatrix3(e).normalize(),r+="\tfacet normal "+t.x+" "+t.y+" "+t.z+"\n",r+="\t\touter loop\n";for(var h=[c.a,c.b,c.c],p=0;p<3;p++)t.copy(a[h[p]]).applyMatrix4(o),r+="\t\t\tvertex "+t.x+" "+t.y+" "+t.z+"\n";r+="\t\tendloop\n",r+="\tendfacet\n"}}}}),r+="endsolid exported\n"}}()};var zl=function(){};zl.prototype={constructor:zl,parse:function(t){var e={metadata:{version:4,type:"TypedGeometry",generator:"TypedGeometryExporter"}},n=["vertices","normals","uvs"];for(var r in n){for(var i=n[r],o=t[i],a=[],s=0,l=o.length;s<l;s++)a[s]=o[s];e[i]=a}var u=t.boundingSphere;return null!==u&&(e.boundingSphere={center:u.center.toArray(),radius:u.radius}),e}},(ve.prototype=Object.create(O.prototype)).constructor=ve,ge.prototype.clone=function(){return new ge(this.position.clone(),this.normal.clone())};var Vl=function(t,e,n,o,a,s,l){var u=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,3,16,17,18,7,19,20,21,11,22,23,24,15,25,26,27,18,28,29,30,21,31,32,33,24,34,35,36,27,37,38,39,30,40,41,0,33,42,43,4,36,44,45,8,39,46,47,12,12,13,14,15,48,49,50,51,52,53,54,55,56,57,58,59,15,25,26,27,51,60,61,62,55,63,64,65,59,66,67,68,27,37,38,39,62,69,70,71,65,72,73,74,68,75,76,77,39,46,47,12,71,78,79,48,74,80,81,52,77,82,83,56,56,57,58,59,84,85,86,87,88,89,90,91,92,93,94,95,59,66,67,68,87,96,97,98,91,99,100,101,95,102,103,104,68,75,76,77,98,105,106,107,101,108,109,110,104,111,112,113,77,82,83,56,107,114,115,84,110,116,117,88,113,118,119,92,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,123,136,137,120,127,138,139,124,131,140,141,128,135,142,143,132,132,133,134,135,144,145,146,147,148,149,150,151,68,152,153,154,135,142,143,132,147,155,156,144,151,157,158,148,154,159,160,68,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,164,177,178,161,168,179,180,165,172,181,182,169,176,183,184,173,173,174,175,176,185,186,187,188,189,190,191,192,193,194,195,196,176,183,184,173,188,197,198,185,192,199,200,189,196,201,202,193,203,203,203,203,204,205,206,207,208,208,208,208,209,210,211,212,203,203,203,203,207,213,214,215,208,208,208,208,212,216,217,218,203,203,203,203,215,219,220,221,208,208,208,208,218,222,223,224,203,203,203,203,221,225,226,204,208,208,208,208,224,227,228,209,209,210,211,212,229,230,231,232,233,234,235,236,237,238,239,240,212,216,217,218,232,241,242,243,236,244,245,246,240,247,248,249,218,222,223,224,243,250,251,252,246,253,254,255,249,256,257,258,224,227,228,209,252,259,260,229,255,261,262,233,258,263,264,237,265,265,265,265,266,267,268,269,270,271,272,273,92,119,118,113,265,265,265,265,269,274,275,276,273,277,278,279,113,112,111,104,265,265,265,265,276,280,281,282,279,283,284,285,104,103,102,95,265,265,265,265,282,286,287,266,285,288,289,270,95,94,93,92],c=[1.4,0,2.4,1.4,-.784,2.4,.784,-1.4,2.4,0,-1.4,2.4,1.3375,0,2.53125,1.3375,-.749,2.53125,.749,-1.3375,2.53125,0,-1.3375,2.53125,1.4375,0,2.53125,1.4375,-.805,2.53125,.805,-1.4375,2.53125,0,-1.4375,2.53125,1.5,0,2.4,1.5,-.84,2.4,.84,-1.5,2.4,0,-1.5,2.4,-.784,-1.4,2.4,-1.4,-.784,2.4,-1.4,0,2.4,-.749,-1.3375,2.53125,-1.3375,-.749,2.53125,-1.3375,0,2.53125,-.805,-1.4375,2.53125,-1.4375,-.805,2.53125,-1.4375,0,2.53125,-.84,-1.5,2.4,-1.5,-.84,2.4,-1.5,0,2.4,-1.4,.784,2.4,-.784,1.4,2.4,0,1.4,2.4,-1.3375,.749,2.53125,-.749,1.3375,2.53125,0,1.3375,2.53125,-1.4375,.805,2.53125,-.805,1.4375,2.53125,0,1.4375,2.53125,-1.5,.84,2.4,-.84,1.5,2.4,0,1.5,2.4,.784,1.4,2.4,1.4,.784,2.4,.749,1.3375,2.53125,1.3375,.749,2.53125,.805,1.4375,2.53125,1.4375,.805,2.53125,.84,1.5,2.4,1.5,.84,2.4,1.75,0,1.875,1.75,-.98,1.875,.98,-1.75,1.875,0,-1.75,1.875,2,0,1.35,2,-1.12,1.35,1.12,-2,1.35,0,-2,1.35,2,0,.9,2,-1.12,.9,1.12,-2,.9,0,-2,.9,-.98,-1.75,1.875,-1.75,-.98,1.875,-1.75,0,1.875,-1.12,-2,1.35,-2,-1.12,1.35,-2,0,1.35,-1.12,-2,.9,-2,-1.12,.9,-2,0,.9,-1.75,.98,1.875,-.98,1.75,1.875,0,1.75,1.875,-2,1.12,1.35,-1.12,2,1.35,0,2,1.35,-2,1.12,.9,-1.12,2,.9,0,2,.9,.98,1.75,1.875,1.75,.98,1.875,1.12,2,1.35,2,1.12,1.35,1.12,2,.9,2,1.12,.9,2,0,.45,2,-1.12,.45,1.12,-2,.45,0,-2,.45,1.5,0,.225,1.5,-.84,.225,.84,-1.5,.225,0,-1.5,.225,1.5,0,.15,1.5,-.84,.15,.84,-1.5,.15,0,-1.5,.15,-1.12,-2,.45,-2,-1.12,.45,-2,0,.45,-.84,-1.5,.225,-1.5,-.84,.225,-1.5,0,.225,-.84,-1.5,.15,-1.5,-.84,.15,-1.5,0,.15,-2,1.12,.45,-1.12,2,.45,0,2,.45,-1.5,.84,.225,-.84,1.5,.225,0,1.5,.225,-1.5,.84,.15,-.84,1.5,.15,0,1.5,.15,1.12,2,.45,2,1.12,.45,.84,1.5,.225,1.5,.84,.225,.84,1.5,.15,1.5,.84,.15,-1.6,0,2.025,-1.6,-.3,2.025,-1.5,-.3,2.25,-1.5,0,2.25,-2.3,0,2.025,-2.3,-.3,2.025,-2.5,-.3,2.25,-2.5,0,2.25,-2.7,0,2.025,-2.7,-.3,2.025,-3,-.3,2.25,-3,0,2.25,-2.7,0,1.8,-2.7,-.3,1.8,-3,-.3,1.8,-3,0,1.8,-1.5,.3,2.25,-1.6,.3,2.025,-2.5,.3,2.25,-2.3,.3,2.025,-3,.3,2.25,-2.7,.3,2.025,-3,.3,1.8,-2.7,.3,1.8,-2.7,0,1.575,-2.7,-.3,1.575,-3,-.3,1.35,-3,0,1.35,-2.5,0,1.125,-2.5,-.3,1.125,-2.65,-.3,.9375,-2.65,0,.9375,-2,-.3,.9,-1.9,-.3,.6,-1.9,0,.6,-3,.3,1.35,-2.7,.3,1.575,-2.65,.3,.9375,-2.5,.3,1.125,-1.9,.3,.6,-2,.3,.9,1.7,0,1.425,1.7,-.66,1.425,1.7,-.66,.6,1.7,0,.6,2.6,0,1.425,2.6,-.66,1.425,3.1,-.66,.825,3.1,0,.825,2.3,0,2.1,2.3,-.25,2.1,2.4,-.25,2.025,2.4,0,2.025,2.7,0,2.4,2.7,-.25,2.4,3.3,-.25,2.4,3.3,0,2.4,1.7,.66,.6,1.7,.66,1.425,3.1,.66,.825,2.6,.66,1.425,2.4,.25,2.025,2.3,.25,2.1,3.3,.25,2.4,2.7,.25,2.4,2.8,0,2.475,2.8,-.25,2.475,3.525,-.25,2.49375,3.525,0,2.49375,2.9,0,2.475,2.9,-.15,2.475,3.45,-.15,2.5125,3.45,0,2.5125,2.8,0,2.4,2.8,-.15,2.4,3.2,-.15,2.4,3.2,0,2.4,3.525,.25,2.49375,2.8,.25,2.475,3.45,.15,2.5125,2.9,.15,2.475,3.2,.15,2.4,2.8,.15,2.4,0,0,3.15,.8,0,3.15,.8,-.45,3.15,.45,-.8,3.15,0,-.8,3.15,0,0,2.85,.2,0,2.7,.2,-.112,2.7,.112,-.2,2.7,0,-.2,2.7,-.45,-.8,3.15,-.8,-.45,3.15,-.8,0,3.15,-.112,-.2,2.7,-.2,-.112,2.7,-.2,0,2.7,-.8,.45,3.15,-.45,.8,3.15,0,.8,3.15,-.2,.112,2.7,-.112,.2,2.7,0,.2,2.7,.45,.8,3.15,.8,.45,3.15,.112,.2,2.7,.2,.112,2.7,.4,0,2.55,.4,-.224,2.55,.224,-.4,2.55,0,-.4,2.55,1.3,0,2.55,1.3,-.728,2.55,.728,-1.3,2.55,0,-1.3,2.55,1.3,0,2.4,1.3,-.728,2.4,.728,-1.3,2.4,0,-1.3,2.4,-.224,-.4,2.55,-.4,-.224,2.55,-.4,0,2.55,-.728,-1.3,2.55,-1.3,-.728,2.55,-1.3,0,2.55,-.728,-1.3,2.4,-1.3,-.728,2.4,-1.3,0,2.4,-.4,.224,2.55,-.224,.4,2.55,0,.4,2.55,-1.3,.728,2.55,-.728,1.3,2.55,0,1.3,2.55,-1.3,.728,2.4,-.728,1.3,2.4,0,1.3,2.4,.224,.4,2.55,.4,.224,2.55,.728,1.3,2.55,1.3,.728,2.55,.728,1.3,2.4,1.3,.728,2.4,0,0,0,1.425,0,0,1.425,.798,0,.798,1.425,0,0,1.425,0,1.5,0,.075,1.5,.84,.075,.84,1.5,.075,0,1.5,.075,-.798,1.425,0,-1.425,.798,0,-1.425,0,0,-.84,1.5,.075,-1.5,.84,.075,-1.5,0,.075,-1.425,-.798,0,-.798,-1.425,0,0,-1.425,0,-1.5,-.84,.075,-.84,-1.5,.075,0,-1.5,.075,.798,-1.425,0,1.425,-.798,0,.84,-1.5,.075,1.5,-.84,.075];O.call(this),t=t||50,e=void 0!==e?Math.max(2,Math.floor(e)||10):10,n=void 0===n||n,o=void 0===o||o,a=void 0===a||a,s=void 0===s||s;var h=3.15*((l=void 0===l||l)?1:1.3)/2,p=t/h,d=n?(8*e-4)*e:0;d+=o?(16*e-4)*e:0,d+=a?40*e*e:0;var f=new Uint32Array(3*d),m=n?4:0;m+=o?8:0,m+=a?20:0,m*=(e+1)*(e+1);var v=new Float32Array(3*m),b=new Float32Array(3*m),_=new Float32Array(2*m),x=new r;x.set(-1,3,-3,1,3,-6,3,0,-3,3,0,0,1,0,0,0);var w,S,A,M,T,C,E,P,N,L,I,D,F,R,k,U,j=[],B=[],z=[],V=[],G=[],H=[],W=[],X=[],Y=[],q=new i,Z=0,Q=0,J=new i,K=new r,$=new r,tt=new g,et=new g,nt=new g,rt=new g,it=new i,ot=new i,at=x.clone();at.transpose();var st=function(t,e,n){return!(v[3*t]===v[3*e]&&v[3*t+1]===v[3*e+1]&&v[3*t+2]===v[3*e+2]||v[3*t]===v[3*n]&&v[3*t+1]===v[3*n+1]&&v[3*t+2]===v[3*n+2]||v[3*e]===v[3*n]&&v[3*e+1]===v[3*n+1]&&v[3*e+2]===v[3*n+2])};for(w=0;w<3;w++)H[w]=new r;var lt=n?32:28;E=e+1;for(var ut=0,ct=0,ht=0,pt=0,dt=0,ft=a?0:20;ft<lt;ft++)if(o||ft<20||ft>=28){for(w=0;w<3;w++){for(S=0;S<4;S++)for(A=0;A<4;A++)j[4*A+S]=c[3*u[16*ft+4*S+A]+w],s&&ft>=20&&ft<28&&2!==w&&(j[4*A+S]*=1.077),l||2!==w||(j[4*A+S]*=1.3);K.set(j[0],j[1],j[2],j[3],j[4],j[5],j[6],j[7],j[8],j[9],j[10],j[11],j[12],j[13],j[14],j[15]),$.multiplyMatrices(K,x),H[w].multiplyMatrices(at,$)}for(T=0;T<=e;T++)for(P=T/e,C=0;C<=e;C++){for(N=C/e,D=4,L=I=1;D--;)B[D]=L,z[D]=I,L*=P,I*=N,3===D?(V[D]=G[D]=0,Z=Q=1):(V[D]=Z*(3-D),G[D]=Q*(3-D),Z*=P,Q*=N);for(tt.fromArray(B),et.fromArray(z),nt.fromArray(V),rt.fromArray(G),w=0;w<3;w++)(M=tt.clone()).applyMatrix4(H[w]),W[w]=M.dot(et),(M=nt.clone()).applyMatrix4(H[w]),X[w]=M.dot(et),(M=tt.clone()).applyMatrix4(H[w]),Y[w]=M.dot(rt);it.fromArray(X),ot.fromArray(Y),q.crossVectors(ot,it),q.normalize(),0===W[0]&&0===W[1]?J.set(0,W[2]>h?1:-1,0):J.set(q.x,q.z,-q.y),v[ct++]=p*W[0],v[ct++]=p*(W[2]-h),v[ct++]=-p*W[1],b[ht++]=J.x,b[ht++]=J.y,b[ht++]=J.z,_[pt++]=1-N,_[pt++]=1-P}for(T=0;T<e;T++)for(C=0;C<e;C++)U=(F=ut*E*E+T*E+C)+E,st(F,R=F+1,k=R+E)&&(f[dt++]=F,f[dt++]=R,f[dt++]=k),st(F,k,U)&&(f[dt++]=F,f[dt++]=k,f[dt++]=U);ut++}this.setIndex(new y(f,1)),this.addAttribute("position",new y(v,3)),this.addAttribute("normal",new y(b,3)),this.addAttribute("uv",new y(_,2)),this.computeBoundingSphere()};(Vl.prototype=Object.create(O.prototype)).constructor=Vl,(ye.prototype=Object.create(ht.prototype)).constructor=ye,ye.prototype.isDataTexture=!0,be.prototype=Object.assign(Object.create(c.prototype),{constructor:be,isPoints:!0,raycast:function(){var t=new r,e=new R,n=new f;return function(r,o){function a(t,n){var i=e.distanceSqToPoint(t);if(i<p){e.closestPointToPoint(t,f),f.applyMatrix4(u);var a=r.ray.origin.distanceTo(f);if(a<r.near||a>r.far)return;o.push({distance:a,distanceToRay:Math.sqrt(i),point:f.clone(),index:n,face:null,object:s})}}var s=this,l=this.geometry,u=this.matrixWorld,c=r.params.Points.threshold;if(null===l.boundingSphere&&l.computeBoundingSphere(),n.copy(l.boundingSphere),n.applyMatrix4(u),n.radius+=c,!1!==r.ray.intersectsSphere(n)){t.getInverse(u),e.copy(r.ray).applyMatrix4(t);var h=c/((this.scale.x+this.scale.y+this.scale.z)/3),p=h*h,d=new i,f=new i;if(l.isBufferGeometry){var m=l.index,v=l.attributes.position.array;if(null!==m)for(var g=m.array,y=0,b=g.length;y<b;y++){var _=g[y];d.fromArray(v,3*_),a(d,_)}else{y=0;for(var x=v.length/3;y<x;y++)d.fromArray(v,3*y),a(d,y)}}else{var w=l.vertices;for(y=0,x=w.length;y<x;y++)a(w[y],y)}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Gl=function(t){c.apply(this,arguments),this.PARTICLE_COUNT=(t=t||{}).maxParticles||1e6,this.PARTICLE_CONTAINERS=t.containerCount||1,this.PARTICLE_NOISE_TEXTURE=t.particleNoiseTex||null,this.PARTICLE_SPRITE_TEXTURE=t.particleSpriteTex||null,this.PARTICLES_PER_CONTAINER=Math.ceil(this.PARTICLE_COUNT/this.PARTICLE_CONTAINERS),this.PARTICLE_CURSOR=0,this.time=0,this.particleContainers=[],this.rand=[];var e,n={vertexShader:["uniform float uTime;","uniform float uScale;","uniform sampler2D tNoise;","attribute vec3 positionStart;","attribute float startTime;","attribute vec3 velocity;","attribute float turbulence;","attribute vec3 color;","attribute float size;","attribute float lifeTime;","varying vec4 vColor;","varying float lifeLeft;","void main() {","\tvColor = vec4( color, 1.0 );","\tvec3 newPosition;","\tvec3 v;","\tfloat timeElapsed = uTime - startTime;","\tlifeLeft = 1.0 - ( timeElapsed / lifeTime );","\tgl_PointSize = ( uScale * size ) * lifeLeft;","\tv.x = ( velocity.x - 0.5 ) * 3.0;","\tv.y = ( velocity.y - 0.5 ) * 3.0;","\tv.z = ( velocity.z - 0.5 ) * 3.0;","\tnewPosition = positionStart + ( v * 10.0 ) * timeElapsed;","\tvec3 noise = texture2D( tNoise, vec2( newPosition.x * 0.015 + ( uTime * 0.05 ), newPosition.y * 0.02 + ( uTime * 0.015 ) ) ).rgb;","\tvec3 noiseVel = ( noise.rgb - 0.5 ) * 30.0;","\tnewPosition = mix( newPosition, newPosition + vec3( noiseVel * ( turbulence * 5.0 ) ), ( timeElapsed / lifeTime ) );","\tif( v.y > 0. && v.y < .05 ) {","\t\tlifeLeft = 0.0;","\t}","\tif( v.x < - 1.45 ) {","\t\tlifeLeft = 0.0;","\t}","\tif( timeElapsed > 0.0 ) {","\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );","\t} else {","\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\t\tlifeLeft = 0.0;","\t\tgl_PointSize = 0.;","\t}","}"].join("\n"),fragmentShader:["float scaleLinear( float value, vec2 valueDomain ) {","\treturn ( value - valueDomain.x ) / ( valueDomain.y - valueDomain.x );","}","float scaleLinear( float value, vec2 valueDomain, vec2 valueRange ) {","\treturn mix( valueRange.x, valueRange.y, scaleLinear( value, valueDomain ) );","}","varying vec4 vColor;","varying float lifeLeft;","uniform sampler2D tSprite;","void main() {","\tfloat alpha = 0.;","\tif( lifeLeft > 0.995 ) {","\t\talpha = scaleLinear( lifeLeft, vec2( 1.0, 0.995 ), vec2( 0.0, 1.0 ) );","\t} else {","\t\talpha = lifeLeft * 0.75;","\t}","\tvec4 tex = texture2D( tSprite, gl_PointCoord );","\tgl_FragColor = vec4( vColor.rgb * tex.a, alpha * tex.a );","}"].join("\n")};for(e=1e5;e>0;e--)this.rand.push(Math.random()-.5);this.random=function(){return++e>=this.rand.length?this.rand[e=1]:this.rand[e]};var r=new Lt;this.particleNoiseTex=this.PARTICLE_NOISE_TEXTURE||r.load("textures/perlin-512.png"),this.particleNoiseTex.wrapS=this.particleNoiseTex.wrapT=Ia,this.particleSpriteTex=this.PARTICLE_SPRITE_TEXTURE||r.load("textures/particle2.png"),this.particleSpriteTex.wrapS=this.particleSpriteTex.wrapT=Ia,this.particleShaderMat=new dt({transparent:!0,depthWrite:!1,uniforms:{uTime:{value:0},uScale:{value:1},tNoise:{value:this.particleNoiseTex},tSprite:{value:this.particleSpriteTex}},blending:Go,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader}),this.particleShaderMat.defaultAttributeValues.particlePositionsStartTime=[0,0,0,0],this.particleShaderMat.defaultAttributeValues.particleVelColSizeLife=[0,0,0,0],this.init=function(){for(var t=0;t<this.PARTICLE_CONTAINERS;t++){var e=new Hl(this.PARTICLES_PER_CONTAINER,this);this.particleContainers.push(e),this.add(e)}},this.spawnParticle=function(t){this.PARTICLE_CURSOR++,this.PARTICLE_CURSOR>=this.PARTICLE_COUNT&&(this.PARTICLE_CURSOR=1);this.particleContainers[Math.floor(this.PARTICLE_CURSOR/this.PARTICLES_PER_CONTAINER)].spawnParticle(t)},this.update=function(t){for(var e=0;e<this.PARTICLE_CONTAINERS;e++)this.particleContainers[e].update(t)},this.dispose=function(){this.particleShaderMat.dispose(),this.particleNoiseTex.dispose(),this.particleSpriteTex.dispose();for(var t=0;t<this.PARTICLE_CONTAINERS;t++)this.particleContainers[t].dispose()},this.init()};(Gl.prototype=Object.create(c.prototype)).constructor=Gl;var Hl=function(t,e){c.apply(this,arguments),this.PARTICLE_COUNT=t||1e5,this.PARTICLE_CURSOR=0,this.time=0,this.offset=0,this.count=0,this.DPR=window.devicePixelRatio,this.GPUParticleSystem=e,this.particleUpdate=!1,this.particleShaderGeo=new O,this.particleShaderGeo.addAttribute("position",new y(new Float32Array(3*this.PARTICLE_COUNT),3).setDynamic(!0)),this.particleShaderGeo.addAttribute("positionStart",new y(new Float32Array(3*this.PARTICLE_COUNT),3).setDynamic(!0)),this.particleShaderGeo.addAttribute("startTime",new y(new Float32Array(this.PARTICLE_COUNT),1).setDynamic(!0)),this.particleShaderGeo.addAttribute("velocity",new y(new Float32Array(3*this.PARTICLE_COUNT),3).setDynamic(!0)),this.particleShaderGeo.addAttribute("turbulence",new y(new Float32Array(this.PARTICLE_COUNT),1).setDynamic(!0)),this.particleShaderGeo.addAttribute("color",new y(new Float32Array(3*this.PARTICLE_COUNT),3).setDynamic(!0)),this.particleShaderGeo.addAttribute("size",new y(new Float32Array(this.PARTICLE_COUNT),1).setDynamic(!0)),this.particleShaderGeo.addAttribute("lifeTime",new y(new Float32Array(this.PARTICLE_COUNT),1).setDynamic(!0)),this.particleShaderMat=this.GPUParticleSystem.particleShaderMat;var n=new i,r=new i,o=new h;this.spawnParticle=function(t){var i=this.particleShaderGeo.getAttribute("positionStart"),a=this.particleShaderGeo.getAttribute("startTime"),s=this.particleShaderGeo.getAttribute("velocity"),l=this.particleShaderGeo.getAttribute("turbulence"),u=this.particleShaderGeo.getAttribute("color"),c=this.particleShaderGeo.getAttribute("size"),h=this.particleShaderGeo.getAttribute("lifeTime");n=void 0!==(t=t||{}).position?n.copy(t.position):n.set(0,0,0),r=void 0!==t.velocity?r.copy(t.velocity):r.set(0,0,0),o=o.set(void 0!==t.color?t.color:16777215);var p=void 0!==t.positionRandomness?t.positionRandomness:0,d=void 0!==t.velocityRandomness?t.velocityRandomness:0,f=void 0!==t.colorRandomness?t.colorRandomness:1,m=void 0!==t.turbulence?t.turbulence:1,v=void 0!==t.lifetime?t.lifetime:5,g=void 0!==t.size?t.size:10,y=void 0!==t.sizeRandomness?t.sizeRandomness:0,b=void 0!==t.smoothPosition&&t.smoothPosition;void 0!==this.DPR&&(g*=this.DPR);var _=this.PARTICLE_CURSOR;i.array[3*_+0]=n.x+e.random()*p,i.array[3*_+1]=n.y+e.random()*p,i.array[3*_+2]=n.z+e.random()*p,!0===b&&(i.array[3*_+0]+=-r.x*e.random(),i.array[3*_+1]+=-r.y*e.random(),i.array[3*_+2]+=-r.z*e.random());var x=r.x+e.random()*d,w=r.y+e.random()*d,S=r.z+e.random()*d;x=xo.clamp((x- -2)/4,0,1),w=xo.clamp((w- -2)/4,0,1),S=xo.clamp((S- -2)/4,0,1),s.array[3*_+0]=x,s.array[3*_+1]=w,s.array[3*_+2]=S,o.r=xo.clamp(o.r+e.random()*f,0,1),o.g=xo.clamp(o.g+e.random()*f,0,1),o.b=xo.clamp(o.b+e.random()*f,0,1),u.array[3*_+0]=o.r,u.array[3*_+1]=o.g,u.array[3*_+2]=o.b,l.array[_]=m,c.array[_]=g+e.random()*y,h.array[_]=v,a.array[_]=this.time+.02*e.random(),0===this.offset&&(this.offset=this.PARTICLE_CURSOR),this.count++,this.PARTICLE_CURSOR++,this.PARTICLE_CURSOR>=this.PARTICLE_COUNT&&(this.PARTICLE_CURSOR=0),this.particleUpdate=!0},this.init=function(){this.particleSystem=new be(this.particleShaderGeo,this.particleShaderMat),this.particleSystem.frustumCulled=!1,this.add(this.particleSystem)},this.update=function(t){this.time=t,this.particleShaderMat.uniforms.uTime.value=t,this.geometryUpdate()},this.geometryUpdate=function(){if(!0===this.particleUpdate){this.particleUpdate=!1;var t=this.particleShaderGeo.getAttribute("positionStart"),e=this.particleShaderGeo.getAttribute("startTime"),n=this.particleShaderGeo.getAttribute("velocity"),r=this.particleShaderGeo.getAttribute("turbulence"),i=this.particleShaderGeo.getAttribute("color"),o=this.particleShaderGeo.getAttribute("size"),a=this.particleShaderGeo.getAttribute("lifeTime");this.offset+this.count<this.PARTICLE_COUNT?(t.updateRange.offset=this.offset*t.itemSize,e.updateRange.offset=this.offset*e.itemSize,n.updateRange.offset=this.offset*n.itemSize,r.updateRange.offset=this.offset*r.itemSize,i.updateRange.offset=this.offset*i.itemSize,o.updateRange.offset=this.offset*o.itemSize,a.updateRange.offset=this.offset*a.itemSize,t.updateRange.count=this.count*t.itemSize,e.updateRange.count=this.count*e.itemSize,n.updateRange.count=this.count*n.itemSize,r.updateRange.count=this.count*r.itemSize,i.updateRange.count=this.count*i.itemSize,o.updateRange.count=this.count*o.itemSize,a.updateRange.count=this.count*a.itemSize):(t.updateRange.offset=0,e.updateRange.offset=0,n.updateRange.offset=0,r.updateRange.offset=0,i.updateRange.offset=0,o.updateRange.offset=0,a.updateRange.offset=0,t.updateRange.count=-1,e.updateRange.count=-1,n.updateRange.count=-1,r.updateRange.count=-1,i.updateRange.count=-1,o.updateRange.count=-1,a.updateRange.count=-1),t.needsUpdate=!0,e.needsUpdate=!0,n.needsUpdate=!0,r.needsUpdate=!0,i.needsUpdate=!0,o.needsUpdate=!0,a.needsUpdate=!0,this.offset=0,this.count=0}},this.dispose=function(){this.particleShaderGeo.dispose()},this.init()};Hl.prototype=Object.create(c.prototype),Hl.prototype.constructor=Hl;var Wl=function(){c.call(this)};(Wl.prototype=Object.create(c.prototype)).constructor=Wl,Wl.prototype.updateMatrixWorld=function(){var t=new i,e=new o,n=new i,r=new i,a=new o,s=new i;return function(i){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||i)&&(null!==this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(r,a,s),this.matrix.decompose(t,e,n),this.matrixWorld.compose(r,e,s)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,i=!0);for(var o=0,l=this.children.length;o<l;o++)this.children[o].updateMatrixWorld(i)}}();_e.prototype=Object.assign(Object.create(O.prototype),{constructor:_e,isInstancedBufferGeometry:!0,copy:function(t){return O.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Object.defineProperty(xe.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(xe.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(t){if(Array.isArray(t))throw new TypeError("BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.stride:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}}),we.prototype=Object.assign(Object.create(xe.prototype),{constructor:we,isInstancedInterleavedBuffer:!0,copy:function(t){return xe.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.defineProperties(Se.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(Se.prototype,{isInterleavedBufferAttribute:!0,setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this}}),(Ae.prototype=Object.create(O.prototype)).constructor=Ae;var Xl=function(){_e.call(this),this.type="LineSegmentsGeometry";new O;this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.addAttribute("position",new T([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.addAttribute("uv",new T([0,1,1,1,0,.5,1,.5,0,.5,1,.5,0,0,1,0],2))};Xl.prototype=Object.assign(Object.create(_e.prototype),{constructor:Xl,isLineSegmentsGeometry:!0,applyMatrix:function(t){var e=this.attributes.instanceStart,n=this.attributes.instanceEnd;return void 0!==e&&(t.applyToBufferAttribute(e),t.applyToBufferAttribute(n),e.data.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},setPositions:function(t){var e;t instanceof Float32Array?e=t:Array.isArray(t)&&(e=new Float32Array(t));var n=new we(e,6,1);return this.addAttribute("instanceStart",new Se(n,3,0)),this.addAttribute("instanceEnd",new Se(n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this},setColors:function(t){var e;t instanceof Float32Array?e=t:Array.isArray(t)&&(e=new Float32Array(t));var n=new we(e,6,1);return this.addAttribute("instanceColorStart",new Se(n,3,0)),this.addAttribute("instanceColorEnd",new Se(n,3,3)),this},fromWireframeGeometry:function(t){return this.setPositions(t.attributes.position.array),this},fromEdgesGeometry:function(t){return this.setPositions(t.attributes.position.array),this},fromMesh:function(t){return this.fromWireframeGeometry(new Ae(t.geometry)),this},fromLineSegements:function(t){var e=t.geometry;return e.isGeometry?this.setPositions(e.vertices):e.isBufferGeometry&&this.setPositions(e.position.array),this},computeBoundingBox:function(){var t=new d;return function(){null===this.boundingBox&&(this.boundingBox=new d);var e=this.attributes.instanceStart,n=this.attributes.instanceEnd;void 0!==e&&void 0!==n&&(this.boundingBox.setFromBufferAttribute(e),t.setFromBufferAttribute(n),this.boundingBox.union(t))}}(),computeBoundingSphere:function(){var t=new i;return function(){null===this.boundingSphere&&(this.boundingSphere=new f),null===this.boundingBox&&this.computeBoundingBox();var e=this.attributes.instanceStart,n=this.attributes.instanceEnd;if(void 0!==e&&void 0!==n){var r=this.boundingSphere.center;this.boundingBox.getCenter(r);for(var i=0,o=0,a=e.count;o<a;o++)t.fromBufferAttribute(e,o),i=Math.max(i,r.distanceToSquared(t)),t.fromBufferAttribute(n,o),i=Math.max(i,r.distanceToSquared(t));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error("LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}}(),toJSON:function(){},clone:function(){},copy:function(t){return this}}),Ol.line={linewidth:{value:1},resolution:{value:new m(1,1)},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}},Nl.line={uniforms:tl.merge([Ol.common,Ol.fog,Ol.line]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\tvarying vec2 vUv;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\tvUv = uv;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec2 ndcStart = clipStart.xy / clipStart.w;\n\t\t\tvec2 ndcEnd = clipEnd.xy / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd - ndcStart;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t// perpendicular to dir\n\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\n\t\t\t// undo aspect ratio adjustment\n\t\t\tdir.x /= aspect;\n\t\t\toffset.x /= aspect;\n\n\t\t\t// sign flip\n\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t// endcaps\n\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\toffset += - dir;\n\n\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\toffset += dir;\n\n\t\t\t}\n\n\t\t\t// adjust for linewidth\n\t\t\toffset *= linewidth;\n\n\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\toffset /= resolution.y;\n\n\t\t\t// select end\n\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t// back to clip space\n\t\t\toffset *= clip.w;\n\n\t\t\tclip.xy += offset;\n\n\t\t\tgl_Position = clip;\n\n\t\t\t#include <logdepthbuf_vertex>\n\n\t\t\t#include <worldpos_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < 0.5 || vUv.y > 0.5 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tif ( vUv.y < 0.5 || vUv.y > 0.5 ) {\n\n\t\t\t\tfloat a = vUv.x - 0.5;\n\t\t\t\tfloat b = vUv.y - 0.5;\n\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\tif ( len2 > 0.25 ) discard;\n\n\t\t\t}\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, diffuseColor.a );\n\n\t\t\t#include <premultiplied_alpha_fragment>\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\n\t\t}\n\t\t"};var Yl=function(t){dt.call(this,{type:"LineMaterial",uniforms:tl.clone(Nl.line.uniforms),vertexShader:Nl.line.vertexShader,fragmentShader:Nl.line.fragmentShader}),this.dashed=!1,Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(t){this.uniforms.diffuse.value=t}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(t){this.uniforms.linewidth.value=t}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(t){this.uniforms.dashScale.value=t}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(t){this.uniforms.dashSize.value=t}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(t){this.uniforms.gapSize.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}}}),this.setValues(t)};(Yl.prototype=Object.create(dt.prototype)).constructor=Yl,Yl.prototype.isLineMaterial=!0,Yl.prototype.copy=function(t){return dt.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.resolution=t.resolution,this};var ql=function(t,e){B.call(this),this.type="LineSegments2",this.geometry=void 0!==t?t:new Xl,this.material=void 0!==e?e:new Yl({color:16777215*Math.random()})};ql.prototype=Object.assign(Object.create(B.prototype),{constructor:ql,isLineSegments2:!0,computeLineDistances:function(){var t=new i,e=new i;return function(){for(var n=this.geometry,r=n.attributes.instanceStart,i=n.attributes.instanceEnd,o=new Float32Array(2*r.data.count),a=0,s=0,l=r.data.count;a<l;a++,s+=2)t.fromBufferAttribute(r,a),e.fromBufferAttribute(i,a),o[s]=0===s?0:o[s-1],o[s+1]=o[s]+t.distanceTo(e);var u=new we(o,2,1);return n.addAttribute("instanceDistanceStart",new Se(u,1,0)),n.addAttribute("instanceDistanceEnd",new Se(u,1,1)),this}}(),copy:function(t){return this}});var Zl=function(){Xl.call(this),this.type="LineGeometry"};Zl.prototype=Object.assign(Object.create(Xl.prototype),{constructor:Zl,isLineGeometry:!0,setPositions:function(t){for(var e=t.length-3,n=new Float32Array(2*e),r=0;r<e;r+=3)n[2*r]=t[r],n[2*r+1]=t[r+1],n[2*r+2]=t[r+2],n[2*r+3]=t[r+3],n[2*r+4]=t[r+4],n[2*r+5]=t[r+5];return Xl.prototype.setPositions.call(this,n),this},setColors:function(t){for(var e=t.length-3,n=new Float32Array(2*e),r=0;r<e;r+=3)n[2*r]=t[r],n[2*r+1]=t[r+1],n[2*r+2]=t[r+2],n[2*r+3]=t[r+3],n[2*r+4]=t[r+4],n[2*r+5]=t[r+5];return Xl.prototype.setColors.call(this,n),this},fromLine:function(t){var e=t.geometry;return e.isGeometry?this.setPositions(e.vertices):e.isBufferGeometry&&this.setPositions(e.position.array),this},copy:function(t){return this}});var Ql=function(t,e){ql.call(this),this.type="Line2",this.geometry=void 0!==t?t:new Zl,this.material=void 0!==e?e:new Yl({color:16777215*Math.random()})};Ql.prototype=Object.assign(Object.create(ql.prototype),{constructor:Ql,isLine2:!0,copy:function(t){return this}});var Jl=function(t,e){B.call(this),this.type="Wireframe",this.geometry=void 0!==t?t:new Xl,this.material=void 0!==e?e:new Yl({color:16777215*Math.random()})};Jl.prototype=Object.assign(Object.create(B.prototype),{constructor:Jl,isWireframe:!0,computeLineDistances:function(){var t=new i,e=new i;return function(){for(var n=this.geometry,r=n.attributes.instanceStart,i=n.attributes.instanceEnd,o=new Float32Array(2*r.data.count),a=0,s=0,l=r.data.count;a<l;a++,s+=2)t.fromBufferAttribute(r,a),e.fromBufferAttribute(i,a),o[s]=0===s?0:o[s-1],o[s+1]=o[s]+t.distanceTo(e);var u=new we(o,2,1);return n.addAttribute("instanceDistanceStart",new Se(u,1,0)),n.addAttribute("instanceDistanceEnd",new Se(u,1,1)),this}}(),copy:function(t){return this}});var Kl=function(t){Xl.call(this),this.type="WireframeGeometry2",this.fromWireframeGeometry(new Ae(t))};Kl.prototype=Object.assign(Object.create(Xl.prototype),{constructor:Kl,isWireframeGeometry2:!0,copy:function(t){return this}}),Me.prototype=Object.assign(Object.create(c.prototype),{constructor:Me,isGroup:!0});var $l=function(t){this.manager=void 0!==t?t:il,this.availableExtensions=[]};$l.prototype={constructor:$l,load:function(t,e,n,r){var i=this,o=new gt(i.manager);o.setResponseType("arraybuffer"),o.load(t,function(t){e(i.parse(t))},n,r)},parse:function(t){function e(t){var e={type:t.getAttribute("type")},n=t.getAttribute("id");n&&(e.id=n);var r=t.getAttribute("pid");r&&(e.pid=r);var i=t.getAttribute("pindex");i&&(e.pindex=i);var o=t.getAttribute("thumbnail");o&&(e.thumbnail=o);var a=t.getAttribute("partnumber");a&&(e.partnumber=a);var s=t.getAttribute("name");s&&(e.name=s);var l=t.querySelector("mesh");l&&(e.mesh=function(t,e){for(var n={},r=[],i=t.querySelectorAll("vertices vertex"),o=0;o<i.length;o++){var a=i[o],s=a.getAttribute("x"),l=a.getAttribute("y"),u=a.getAttribute("z");r.push(parseFloat(s),parseFloat(l),parseFloat(u))}for(n.vertices=new Float32Array(r.length),o=0;o<r.length;o++)n.vertices[o]=r[o];var c=[],h=[],p=t.querySelectorAll("triangles triangle");for(o=0;o<p.length;o++){var d=p[o],f=d.getAttribute("v1"),m=d.getAttribute("v2"),v=d.getAttribute("v3"),g=d.getAttribute("p1"),y=d.getAttribute("p2"),b=d.getAttribute("p3"),_=d.getAttribute("pid");h.push(parseInt(f,10),parseInt(m,10),parseInt(v,10));var x={};g&&(x.p1=parseInt(g,10)),y&&(x.p2=parseInt(y,10)),b&&(x.p3=parseInt(b,10)),_&&(x.pid=_),0<Object.keys(x).length&&c.push(x)}for(n.triangleProperties=c,n.triangles=new Uint32Array(h.length),o=0;o<h.length;o++)n.triangles[o]=h[o];return n}(l));var u=t.querySelector("components");return u&&(e.components=void 0),e}function n(t,e){var n=new O;n.setIndex(new y(t.triangles,1)),n.addAttribute("position",new y(t.vertices,3)),t.colors&&n.addAttribute("color",new y(t.colors,3)),n.computeBoundingSphere();var r={flatShading:!0};t.colors&&0<t.colors.length?r.vertexColors=Bo:r.color=11184895;return new B(n,new wt(r))}function i(t,e,n,r){if(t){for(var i=[],a=Object.keys(t),s=0;s<a.length;s++)for(var l=a[s],u=0;u<o.availableExtensions.length;u++){(c=o.availableExtensions[u]).ns===l&&i.push(c)}for(s=0;s<i.length;s++){var c;(c=i[s]).apply(n,t[c.ns],e)}}}var o=this,a=function(t){var n,i,o=null,a=null,s=[],l=[],u={},c={};try{o=new JSZip(t)}catch(t){if(t instanceof ReferenceError)return console.error("ThreeMFLoader: jszip missing and file is compressed."),null}for(a in o.files)a.match(/\.rels$/)?n=a:a.match(/^3D\/.*\.model$/)?s.push(a):a.match(/^3D\/Metadata\/.*\.xml$/)||(a.match(/^3D\/Textures\/.*/)?l.push(a):a.match(/^3D\/Other\/.*/));var h=new Uint8Array(o.file(n).asArrayBuffer());i=function(t){var e=(new DOMParser).parseFromString(t,"application/xml").querySelector("Relationship"),n=e.getAttribute("Target"),r=e.getAttribute("Id"),i=e.getAttribute("Type");return{target:n,id:r,type:i}}(al.decodeText(h));for(var p=0;p<s.length;p++){var d=s[p],f=new Uint8Array(o.file(d).asArrayBuffer()),m=al.decodeText(f),v=(new DOMParser).parseFromString(m,"application/xml");"model"!==v.documentElement.nodeName.toLowerCase()&&console.error("ThreeMFLoader: Error loading 3MF - no 3MF document found: ",d);var g=v.querySelector("model"),y={};for(p=0;p<g.attributes.length;p++){var b=g.attributes[p];b.name.match(/^xmlns:(.+)$/)&&(y[b.value]=RegExp.$1)}var _=function(t){var n={unit:t.getAttribute("unit")||"millimeter"},i=t.querySelectorAll("metadata");i&&(n.metadata=function(t){for(var e={},n=0;n<t.length;n++){var r=t[n],i=r.getAttribute("name"),o=["Title","Designer","Description","Copyright","LicenseTerms","Rating","CreationDate","ModificationDate"];0<=o.indexOf(i)&&(e[i]=r.textContent)}return e}(i));var o=t.querySelector("resources");o&&(n.resources=function(t){var n={},r=t.querySelector("basematerials");r&&(n.basematerial=void 0),n.object={};for(var i=t.querySelectorAll("object"),o=0;o<i.length;o++){var a=i[o],s=e(a);n.object[s.id]=s}return n}(o));var a=t.querySelector("build");return a&&(n.build=function(t){for(var e=[],n=t.querySelectorAll("item"),i=0;i<n.length;i++){var o=n[i],a={objectid:o.getAttribute("objectid")},s=o.getAttribute("transform");if(s){var l=[];s.split(" ").forEach(function(t){l.push(parseFloat(t))});var u=new r;a.transform=u.set(l[0],l[3],l[6],l[9],l[1],l[4],l[7],l[10],l[2],l[5],l[8],l[11],0,0,0,1)}e.push(a)}return e}(a)),n}(g);_.xml=g,0<Object.keys(y).length&&(_.extensions=y),u[d]=_}for(p=0;p<l.length;p++){var x=l[p];c[x]=o.file(x).asBinary()}return{rels:i,model:u,printTicket:{},texture:c,other:{}}}(t);return function(t,e,n){for(var r=new Me,i=n.model[e.target.substring(1)].build,o=0;o<i.length;o++){var a=i[o],s=t[a.objectid];a.transform&&s.geometry.applyMatrix(a.transform),r.add(s)}return r}(function(t){for(var e=t.model,r={},o=Object.keys(e),a=0;a<o.length;a++)for(var s=e[o[a]],l=s.xml,u=s.extensions,c=Object.keys(s.resources.object),h=0;h<c.length;h++){var p=c[h],d=s.resources.object[p].mesh;i(u,d,l),r[p]=n(d)}return r}(a),a.rels,a)},addExtension:function(t){this.availableExtensions.push(t)}};var tu=function(t){this.manager=void 0!==t?t:il};tu.prototype={constructor:tu,load:function(t,e,n,r){var i=this,o=new gt(i.manager);o.setResponseType("arraybuffer"),o.load(t,function(t){e(i.parse(t))},n,r)},parse:function(t){function e(t){for(var e="AMF Material",r=t.attributes.id.textContent,i={r:1,g:1,b:1,a:1},o=null,a=0;a<t.childNodes.length;a++){var s=t.childNodes[a];"metadata"===s.nodeName&&void 0!==s.attributes.type?"name"===s.attributes.type.value&&(e=s.textContent):"color"===s.nodeName&&(i=n(s))}return o=new wt({flatShading:!0,color:new h(i.r,i.g,i.b),name:e}),1!==i.a&&(o.transparent=!0,o.opacity=i.a),{id:r,material:o}}function n(t){for(var e={r:1,g:1,b:1,a:1},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];"r"===r.nodeName?e.r=r.textContent:"g"===r.nodeName?e.g=r.textContent:"b"===r.nodeName?e.b=r.textContent:"a"===r.nodeName&&(e.a=r.textContent)}return e}function r(t){var e={name:"",triangles:[],materialid:null},n=t.firstElementChild;for(void 0!==t.attributes.materialid&&(e.materialId=t.attributes.materialid.nodeValue);n;){if("metadata"===n.nodeName)void 0!==n.attributes.type&&"name"===n.attributes.type.value&&(e.name=n.textContent);else if("triangle"===n.nodeName){var r=n.getElementsByTagName("v1")[0].textContent,i=n.getElementsByTagName("v2")[0].textContent,o=n.getElementsByTagName("v3")[0].textContent;e.triangles.push(r,i,o)}n=n.nextElementSibling}return e}function i(t){for(var e=[],n=[],r=t.firstElementChild;r;){if("vertex"===r.nodeName)for(var i=r.firstElementChild;i;){if("coordinates"===i.nodeName){var o=i.getElementsByTagName("x")[0].textContent,a=i.getElementsByTagName("y")[0].textContent,s=i.getElementsByTagName("z")[0].textContent;e.push(o,a,s)}else if("normal"===i.nodeName){var l=i.getElementsByTagName("nx")[0].textContent,u=i.getElementsByTagName("ny")[0].textContent,c=i.getElementsByTagName("nz")[0].textContent;n.push(l,u,c)}i=i.nextElementSibling}r=r.nextElementSibling}return{vertices:e,normals:n}}function o(t){for(var e=t.attributes.id.textContent,o={name:"amfobject",meshes:[]},a=null,s=t.firstElementChild;s;){if("metadata"===s.nodeName)void 0!==s.attributes.type&&"name"===s.attributes.type.value&&(o.name=s.textContent);else if("color"===s.nodeName)a=n(s);else if("mesh"===s.nodeName){for(var l=s.firstElementChild,u={vertices:[],normals:[],volumes:[],color:a};l;){if("vertices"===l.nodeName){var c=i(l);u.normals=u.normals.concat(c.normals),u.vertices=u.vertices.concat(c.vertices)}else"volume"===l.nodeName&&u.volumes.push(r(l));l=l.nextElementSibling}o.meshes.push(u)}s=s.nextElementSibling}return{id:e,obj:o}}var a,s,l=function(t){var e=new DataView(t);if("PK"===String.fromCharCode(e.getUint8(0),e.getUint8(1))){var n=null,r=null;console.log("AMFLoader: Loading Zip");try{n=new JSZip(t)}catch(t){if(t instanceof ReferenceError)return console.log("AMFLoader: jszip missing and file is compressed."),null}for(r in n.files)if(".amf"===r.toLowerCase().substr(-4))break;console.log("AMFLoader: Trying to load file asset: "+r),e=new DataView(n.file(r).asArrayBuffer())}var i=al.decodeText(e),o=(new DOMParser).parseFromString(i,"application/xml");return"amf"!==o.documentElement.nodeName.toLowerCase()?(console.log("AMFLoader: Error loading AMF - no AMF document found."),null):o}(t),u="",c="",p=function(t){var e=1,n="millimeter";void 0!==t.documentElement.attributes.unit&&(n=t.documentElement.attributes.unit.value.toLowerCase());var r={millimeter:1,inch:25.4,feet:304.8,meter:1e3,micron:.001};return void 0!==r[n]&&(e=r[n]),console.log("AMFLoader: Unit scale: "+e),e}(l),d={},f={},m=l.documentElement.childNodes;for(a=0;a<m.length;a++){var v=m[a];if("metadata"===v.nodeName)void 0!==v.attributes.type&&("name"===v.attributes.type.value?u=v.textContent:"author"===v.attributes.type.value&&(c=v.textContent));else if("material"===v.nodeName){var g=e(v);d[g.id]=g.material}else if("object"===v.nodeName){var y=o(v);f[y.id]=y.obj}}var b=new Me,_=new wt({color:11184895,flatShading:!0});b.name=u,b.userData.author=c,b.userData.loader="AMF";for(var x in f){var w=f[x],S=w.meshes,A=new Me;for(A.name=w.name||"",a=0;a<S.length;a++){var M=_,C=S[a],E=new T(C.vertices,3),P=null;if(C.normals.length&&(P=new T(C.normals,3)),C.color){var N=C.color;(M=_.clone()).color=new h(N.r,N.g,N.b),1!==N.a&&(M.transparent=!0,M.opacity=N.a)}var L=C.volumes;for(s=0;s<L.length;s++){var I=L[s],D=new O,F=M;D.setIndex(I.triangles),D.addAttribute("position",E.clone()),P&&D.addAttribute("normal",P.clone()),void 0!==d[I.materialId]&&(F=d[I.materialId]),D.scale(p,p,p),A.add(new B(D,F.clone()))}}b.add(A)}return b}};var eu=function(t){this.manager=void 0!==t?t:il};eu.prototype={constructor:eu,crossOrigin:"Anonymous",load:function(t,e,n,r){var i=this,o=al.extractUrlBase(t);new gt(this.manager).load(t,function(t){var n=JSON.parse(t),a=n.__metadata__;if(void 0!==a){if("assimp2json"!==a.format)return void r("AssimpJSONLoader: Not an assimp2json scene.");if(a.version<100&&a.version>=200)return void r("AssimpJSONLoader: Unsupported assimp2json file format version.")}e(i.parse(n,o))},n,r)},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){function n(t,e){for(var n=new Array(t.length),r=0;r<t.length;++r)n[r]=e.call(this,t[r]);return n}function i(t,e,n,o){var a,s,l=new c;for(l.name=e.name||"",l.matrix=(new r).fromArray(e.transformation).transpose(),l.matrix.decompose(l.position,l.quaternion,l.scale),a=0;e.meshes&&a<e.meshes.length;a++)l.add(new B(n[s=e.meshes[a]],o[t.meshes[s].materialindex]));for(a=0;e.children&&a<e.children.length;a++)l.add(i(t,e.children[a],n,o));return l}var o=new Lt(this.manager);o.setPath(e).setCrossOrigin(this.crossOrigin);var a=n(t.meshes,function(t){var e,n,r,i=new O,o=[],a=t.vertices||[],s=t.normals||[],l=t.texturecoords||[],u=t.colors||[];for(l=l[0]||[],e=0,n=t.faces.length;e<n;e++)o.push((r=t.faces[e])[0],r[1],r[2]);return i.setIndex(o),i.addAttribute("position",new T(a,3)),s.length>0&&i.addAttribute("normal",new T(s,3)),l.length>0&&i.addAttribute("uv",new T(l,2)),u.length>0&&i.addAttribute("color",new T(u,3)),i.computeBoundingSphere(),i}),s=n(t.materials,function(t){var e=new wt;for(var n in t.properties){var r=t.properties[n],i=r.value;switch(r.key){case"$tex.file":var a=r.semantic;if(1===a||2===a||5===a||6===a){var s;switch(a){case 1:s="map";break;case 2:s="specularMap";break;case 5:s="bumpMap";break;case 6:s="normalMap"}var l=o.load(i);l.wrapS=l.wrapT=Ia,e[s]=l}break;case"?mat.name":e.name=i;break;case"$clr.diffuse":e.color.fromArray(i);break;case"$clr.specular":e.specular.fromArray(i);break;case"$clr.emissive":e.emissive.fromArray(i);break;case"$mat.shininess":e.shininess=i;break;case"$mat.shadingm":e.flatShading=1===i;break;case"$mat.opacity":i<1&&(e.opacity=i,e.transparent=!0)}}return e});return i(t,t.rootnode,a,s)}},Object.assign(Te.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new r;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){var t,e,n;for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){var t=new r,e=new r;return function(){for(var n=this.bones,r=this.boneInverses,i=this.boneMatrices,o=this.boneTexture,a=0,s=n.length;a<s;a++){t.multiplyMatrices(n[a]?n[a].matrixWorld:e,r[a]),t.toArray(i,16*a)}void 0!==o&&(o.needsUpdate=!0)}}(),clone:function(){return new Te(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,n=this.bones.length;e<n;e++){var r=this.bones[e];if(r.name===t)return r}}}),Ce.prototype=Object.assign(Object.create(B.prototype),{constructor:Ce,isSkinnedMesh:!0,initBones:function(){var t,e,n,r,i=[];if(this.geometry&&void 0!==this.geometry.bones){for(n=0,r=this.geometry.bones.length;n<r;n++)e=this.geometry.bones[n],t=new V,i.push(t),t.name=e.name,t.position.fromArray(e.pos),t.quaternion.fromArray(e.rotq),void 0!==e.scl&&t.scale.fromArray(e.scl);for(n=0,r=this.geometry.bones.length;n<r;n++)-1!==(e=this.geometry.bones[n]).parent&&null!==e.parent&&void 0!==i[e.parent]?i[e.parent].add(i[n]):this.add(i[n])}return this.updateMatrixWorld(!0),i},bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var t,e;if(this.geometry&&this.geometry.isGeometry)for(e=0;e<this.geometry.skinWeights.length;e++){var n=this.geometry.skinWeights[e];(t=1/n.manhattanLength())!==1/0?n.multiplyScalar(t):n.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var r=new g,i=this.geometry.attributes.skinWeight;for(e=0;e<i.count;e++)r.x=i.getX(e),r.y=i.getY(e),r.z=i.getZ(e),r.w=i.getW(e),(t=1/r.manhattanLength())!==1/0?r.multiplyScalar(t):r.set(1,0,0,0),i.setXYZW(e,r.x,r.y,r.z,r.w)}},updateMatrixWorld:function(t){B.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var nu=function(t){this.manager=void 0!==t?t:il};nu.prototype={constructor:nu,crossOrigin:"Anonymous",load:function(t,e,n,r){var i=this,o=al.extractUrlBase(t),a=new gt(this.manager);a.setResponseType("arraybuffer"),a.load(t,function(t){e(i.parse(t,o))},n,r)},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){function n(t){return Mt<<t}function a(t){return Tt<<t}function s(t,e){var n=new V;n.matrix.copy(t.matrix),n.matrixWorld.copy(t.matrixWorld),n.position.copy(t.position),n.quaternion.copy(t.quaternion),n.scale.copy(t.scale),e.nodeCount++,n.name="bone_"+t.name+e.nodeCount.toString(),e.nodeToBoneMap[t.name]||(e.nodeToBoneMap[t.name]=[]),e.nodeToBoneMap[t.name].push(n);for(var r in t.children){var i=s(t.children[r],e);i&&n.add(i)}return n}function l(t,e){for(var n=[],r=0;r<t.length;r++)n.push({i:t[r],w:e[r]});for(n.sort(function(t,e){return e.w-t.w});n.length<4;)n.push({i:0,w:0});n.length>4&&(n.length=4);var i=0;for(r=0;r<4;r++)i+=n[r].w*n[r].w;i=Math.sqrt(i);for(r=0;r<4;r++)n[r].w=n[r].w/i,t[r]=n[r].i,e[r]=n[r].w}function u(t,e){if(0==t.name.indexOf("bone_"+e))return t;for(var n in t.children){var r=u(t.children[n],e);if(r)return r}}function p(){this.mPrimitiveTypes=0,this.mNumVertices=0,this.mNumFaces=0,this.mNumBones=0,this.mMaterialIndex=0,this.mVertices=[],this.mNormals=[],this.mTangents=[],this.mBitangents=[],this.mColors=[[]],this.mTextureCoords=[[]],this.mFaces=[],this.mBones=[],this.hookupSkeletons=function(t,e){if(0!=this.mBones.length){for(var n=[],i=[],o=t.findNode(this.mBones[0].mName);o.mParent&&o.mParent.isBone;)o=o.mParent;var a=s(c=o.toTHREE(t),t);this.threeNode.add(a);for(var l=0;l<this.mBones.length;l++){if(h=u(a,this.mBones[l].mName)){n.push(h),i.push(this.mBones[l].mOffsetMatrix.toTHREE())}else{if(!(o=t.findNode(this.mBones[l].mName)))return;var c;c=o.toTHREE(t),a=s(c,t);this.threeNode.add(a);var h=u(a,this.mBones[l].mName);n.push(h),i.push(this.mBones[l].mOffsetMatrix.toTHREE())}}var p=new Te(n,i);this.threeNode.bind(p,new r),this.threeNode.material.skinning=!0}},this.toTHREE=function(t){if(this.threeNode)return this.threeNode;var e,n=new O;if(e=t.mMaterials[this.mMaterialIndex]?t.mMaterials[this.mMaterialIndex].toTHREE(t):new _t,n.setIndex(new y(new Uint32Array(this.mIndexArray),1)),n.addAttribute("position",new y(this.mVertexBuffer,3)),this.mNormalBuffer&&this.mNormalBuffer.length>0&&n.addAttribute("normal",new y(this.mNormalBuffer,3)),this.mColorBuffer&&this.mColorBuffer.length>0&&n.addAttribute("color",new y(this.mColorBuffer,4)),this.mTexCoordsBuffers[0]&&this.mTexCoordsBuffers[0].length>0&&n.addAttribute("uv",new y(new Float32Array(this.mTexCoordsBuffers[0]),2)),this.mTexCoordsBuffers[1]&&this.mTexCoordsBuffers[1].length>0&&n.addAttribute("uv1",new y(new Float32Array(this.mTexCoordsBuffers[1]),2)),this.mTangentBuffer&&this.mTangentBuffer.length>0&&n.addAttribute("tangents",new y(this.mTangentBuffer,3)),this.mBitangentBuffer&&this.mBitangentBuffer.length>0&&n.addAttribute("bitangents",new y(this.mBitangentBuffer,3)),this.mBones.length>0){for(var r=[],i=[],o=0;o<this.mBones.length;o++)for(var a=0;a<this.mBones[o].mWeights.length;a++){var s=this.mBones[o].mWeights[a];s&&(r[s.mVertexId]||(r[s.mVertexId]=[]),i[s.mVertexId]||(i[s.mVertexId]=[]),r[s.mVertexId].push(s.mWeight),i[s.mVertexId].push(parseInt(o)))}for(var o in i)l(i[o],r[o]);var u=[],c=[];for(o=0;o<r.length;o++)for(a=0;a<4;a++)r[o]&&i[o]?(u.push(r[o][a]),c.push(i[o][a])):(u.push(0),c.push(0));n.addAttribute("skinWeight",new y(new Float32Array(u),Rt)),n.addAttribute("skinIndex",new y(new Float32Array(c),Rt))}var h;return 0==this.mBones.length&&(h=new B(n,e)),this.mBones.length>0&&(h=new Ce(n,e)),this.threeNode=h,h}}function d(){this.mNumIndices=0,this.mIndices=[]}function f(){this.data=[],this.toString=function(){var t="";return this.data.forEach(function(e){t+=String.fromCharCode(e)}),t.replace(/[^\x20-\x7E]+/g,"")}}function m(){this.mName="",this.mTransformation=[],this.mNumChildren=0,this.mNumMeshes=0,this.mMeshes=[],this.mChildren=[],this.toTHREE=function(t){if(this.threeNode)return this.threeNode;var e=new c;e.name=this.mName,e.matrix=this.mTransformation.toTHREE();for(var n=0;n<this.mChildren.length;n++)e.add(this.mChildren[n].toTHREE(t));for(n=0;n<this.mMeshes.length;n++)e.add(t.mMeshes[this.mMeshes[n]].toTHREE(t));return this.threeNode=e,e.matrix.decompose(e.position,e.quaternion,e.scale),e}}function v(){this.mName="",this.mNumWeights=0,this.mOffsetMatrix=0}function g(){this.mKey="",this.mSemantic=0,this.mIndex=0,this.mData=[],this.mDataLength=0,this.mType=0,this.dataAsColor=function(){var t=new Uint8Array(this.mData).buffer,e=new DataView(t);return new h(e.getFloat32(0,!0),e.getFloat32(4,!0),e.getFloat32(8,!0))},this.dataAsFloat=function(){var t=new Uint8Array(this.mData).buffer;return new DataView(t).getFloat32(0,!0)},this.dataAsBool=function(){var t=new Uint8Array(this.mData).buffer;return!!new DataView(t).getFloat32(0,!0)},this.dataAsString=function(){var t=new f;return t.data=this.mData,t.toString()},this.dataAsMap=function(){var t=new f;t.data=this.mData;var e=t.toString();return-1!=(e=e.replace(/\\/g,"/")).indexOf("/")&&(e=e.substr(e.lastIndexOf("/")+1)),ot.load(e)}}function b(){this.mNumAllocated=0,this.mNumProperties=0,this.mProperties=[],this.toTHREE=function(t){this.mProperties[0].dataAsString();for(var e=new wt,n=0;n<this.mProperties.length;n++)if("float"==Ut[this.mProperties[n].mKey]&&(e[kt[this.mProperties[n].mKey]]=this.mProperties[n].dataAsFloat()),"color"==Ut[this.mProperties[n].mKey]&&(e[kt[this.mProperties[n].mKey]]=this.mProperties[n].dataAsColor()),"bool"==Ut[this.mProperties[n].mKey]&&(e[kt[this.mProperties[n].mKey]]=this.mProperties[n].dataAsBool()),"string"==Ut[this.mProperties[n].mKey]&&(e[kt[this.mProperties[n].mKey]]=this.mProperties[n].dataAsString()),"map"==Ut[this.mProperties[n].mKey]){var r=this.mProperties[n];r.mSemantic==Nt&&(e.map=this.mProperties[n].dataAsMap()),r.mSemantic==It&&(e.normalMap=this.mProperties[n].dataAsMap()),r.mSemantic==Ft&&(e.lightMap=this.mProperties[n].dataAsMap()),r.mSemantic==Dt&&(e.alphaMap=this.mProperties[n].dataAsMap())}return e.ambient.r=.53,e.ambient.g=.53,e.ambient.b=.53,e.color.r=1,e.color.g=1,e.color.b=1,e}}function _(t,e,n){var r=new i,o=1-n;return r.x=t.x*n+e.x*o,r.y=t.y*n+e.y*o,r.z=t.z*n+e.z*o,r}function x(t,e,n){return t.clone().slerp(e,1-n)}function w(t,e,n,r){if(1==t.length)return t[0].mValue.toTHREE();for(var i=1/0,o=null,a=null,s=0;s<t.length;s++){var l=Math.abs(t[s].mTime-e);l<i&&t[s].mTime<=e&&(i=l,o=t[s],a=t[s+1])}if(o){if(a){var u=(o.mTime-e)/(a.mTime-o.mTime);return r(o.mValue.toTHREE(),a.mValue.toTHREE(),u)}(a=t[0].clone()).mTime+=n;u=(o.mTime-e)/(a.mTime-o.mTime);return r(o.mValue.toTHREE(),a.mValue.toTHREE(),u)}return null}function S(){this.mNodeName="",this.mNumPositionKeys=0,this.mNumRotationKeys=0,this.mNumScalingKeys=0,this.mPositionKeys=[],this.mRotationKeys=[],this.mScalingKeys=[],this.mPreState="",this.mPostState="",this.init=function(t){function e(e){e.mTime/=t}t||(t=1),this.mPositionKeys.forEach(e),this.mRotationKeys.forEach(e),this.mScalingKeys.forEach(e)},this.sortKeys=function(){function t(t,e){return t.mTime-e.mTime}this.mPositionKeys.sort(t),this.mRotationKeys.sort(t),this.mScalingKeys.sort(t)},this.getLength=function(){return Math.max(Math.max.apply(null,this.mPositionKeys.map(function(t){return t.mTime})),Math.max.apply(null,this.mRotationKeys.map(function(t){return t.mTime})),Math.max.apply(null,this.mScalingKeys.map(function(t){return t.mTime})))},this.toTHREE=function(t,e){this.sortKeys();for(var n=this.getLength(),i=new at.KeyFrameTrack,o=0;o<n;o+=.05){var a=new r,s=o,l=w(this.mPositionKeys,s,n,_),u=w(this.mScalingKeys,s,n,_),c=w(this.mRotationKeys,s,n,x);a.compose(l,c,u);var h=new at.KeyFrame(s,a);i.addKey(h)}i.target=t.findNode(this.mNodeName).toTHREE();var p=[i];if(t.nodeToBoneMap[this.mNodeName])for(o=0;o<t.nodeToBoneMap[this.mNodeName].length;o++){var d=i.clone();d.target=t.nodeToBoneMap[this.mNodeName][o],p.push(d)}return p}}function A(){this.mName="",this.mDuration=0,this.mTicksPerSecond=0,this.mNumChannels=0,this.mChannels=[],this.toTHREE=function(t){var e=new at.Animation;for(var n in this.mChannels){this.mChannels[n].init(this.mTicksPerSecond);var r=this.mChannels[n].toTHREE(t);for(var i in r)r[i].init(),e.addTrack(r[i])}return e.length=Math.max.apply(null,e.tracks.map(function(t){return t.length})),e}}function M(){this.mWidth=0,this.mHeight=0,this.texAchFormatHint=[],this.pcData=[]}function T(){this.mName="",this.mType=0,this.mAttenuationConstant=0,this.mAttenuationLinear=0,this.mAttenuationQuadratic=0,this.mAngleInnerCone=0,this.mAngleOuterCone=0,this.mColorDiffuse=null,this.mColorSpecular=null,this.mColorAmbient=null}function C(){this.mName="",this.mPosition=null,this.mLookAt=null,this.mUp=null,this.mHorizontalFOV=0,this.mClipPlaneNear=0,this.mClipPlaneFar=0,this.mAspect=0}function E(t){var e=t.getFloat32(t.readOffset,jt);return t.readOffset+=4,e}function P(t){var e=t.getFloat64(t.readOffset,jt);return t.readOffset+=8,e}function N(t){var e=t.getUint8(t.readOffset);return t.readOffset+=1,e}function L(t){var e=t.getUint16(t.readOffset,jt);return t.readOffset+=2,e}function I(t){var e=t.getUint32(t.readOffset,jt);return t.readOffset+=4,e}function D(t){var e=t.getUint32(t.readOffset,jt);return t.readOffset+=4,e}function F(t){var e=new function(){this.x=0,this.y=0,this.z=0,this.toTHREE=function(){return new i(this.x,this.y,this.z)}};return e.x=E(t),e.y=E(t),e.z=E(t),e}function R(t){var e=new function(){this.r=0,this.g=0,this.b=0,this.a=0,this.toTHREE=function(){return new h(this.r,this.g,this.b,1)}};return e.r=E(t),e.g=E(t),e.b=E(t),e}function k(t){var e=new function(){this.x=0,this.y=0,this.z=0,this.w=0,this.toTHREE=function(){return new o(this.x,this.y,this.z,this.w)}};return e.w=E(t),e.x=E(t),e.y=E(t),e.z=E(t),e}function U(t){var e=new f,n=I(t);return t.ReadBytes(e.data,1,n),e.toString()}function j(t){var e=new function(){this.mVertexId=0,this.mWeight=0};return e.mVertexId=I(t),e.mWeight=E(t),e}function z(t){for(var e=new function(){this.elements=[[],[],[],[]],this.toTHREE=function(){for(var t=new r,e=0;e<4;++e)for(var n=0;n<4;++n)t.elements[4*e+n]=this.elements[n][e];return t}},n=0;n<4;++n)for(var i=0;i<4;++i)e.elements[n][i]=E(t);return e}function G(t){var e=new function(){this.mTime=0,this.mValue=null};return e.mTime=P(t),e.mValue=F(t),e}function H(t){var e=new function(){this.mTime=0,this.mValue=null};return e.mTime=P(t),e.mValue=k(t),e}function W(t,e,n){for(var r=0;r<n;r++)e[r]=G(t)}function X(t,e,n){return t.Seek(sizeof(e)*n,Bt)}function Y(t){if(!t)throw"asset failed"}function q(t,e,n){Y(D(t)==gt),D(t);var r=new m;if(r.mParent=e,r.mDepth=n,r.mName=U(t),r.mTransformation=z(t),r.mNumChildren=I(t),r.mNumMeshes=I(t),r.mNumMeshes){r.mMeshes=[];for(var i=0;i<r.mNumMeshes;++i)r.mMeshes[i]=I(t)}if(r.mNumChildren){r.mChildren=[];for(i=0;i<r.mNumChildren;++i){var o=q(t,r,n++);r.mChildren[i]=o}}return r}function Z(t,e){return Y(D(t)==mt),D(t),e.mName=U(t),e.mNumWeights=I(t),e.mOffsetMatrix=z(t),st?X(t,e.mWeights,e.mNumWeights):(e.mWeights=[],function(t,e,n){for(var r=0;r<n;r++)e[r]=j(t)}(t,e.mWeights,e.mNumWeights)),e}function Q(t,e){Y(D(t)==pt),D(t),e.mPrimitiveTypes=I(t),e.mNumVertices=I(t),e.mNumFaces=I(t),e.mNumBones=I(t),e.mMaterialIndex=I(t),e.mNumUVComponents=[];var r=I(t);r&xt&&(st?X(t,e.mVertices,e.mNumVertices):(e.mVertices=[],e.mVertexBuffer=t.subArray32(t.readOffset,t.readOffset+3*e.mNumVertices*4),t.Seek(3*e.mNumVertices*4,Bt))),r&St&&(st?X(t,e.mNormals,e.mNumVertices):(e.mNormals=[],e.mNormalBuffer=t.subArray32(t.readOffset,t.readOffset+3*e.mNumVertices*4),t.Seek(3*e.mNumVertices*4,Bt))),r&At&&(st?(X(t,e.mTangents,e.mNumVertices),X(t,e.mBitangents,e.mNumVertices)):(e.mTangents=[],e.mTangentBuffer=t.subArray32(t.readOffset,t.readOffset+3*e.mNumVertices*4),t.Seek(3*e.mNumVertices*4,Bt),e.mBitangents=[],e.mBitangentBuffer=t.subArray32(t.readOffset,t.readOffset+3*e.mNumVertices*4),t.Seek(3*e.mNumVertices*4,Bt)));for(var i=0;i<Ct&&r&a(i);++i)st?X(t,e.mColors[i],e.mNumVertices):(e.mColors[i]=[],e.mColorBuffer=t.subArray32(t.readOffset,t.readOffset+4*e.mNumVertices*4),t.Seek(4*e.mNumVertices*4,Bt));e.mTexCoordsBuffers=[];for(i=0;i<Et&&r&n(i);++i)if(e.mNumUVComponents[i]=I(t),st)X(t,e.mTextureCoords[i],e.mNumVertices);else{e.mTextureCoords[i]=[],e.mTexCoordsBuffers[i]=[];for(var o=0;o<e.mNumVertices;o++)e.mTexCoordsBuffers[i].push(E(t)),e.mTexCoordsBuffers[i].push(E(t)),E(t)}if(st)I(t);else{e.mFaces=[],e.mIndexArray=[];for(var s=0;s<e.mNumFaces;++s){var l=e.mFaces[s]=new d;l.mNumIndices=L(t),l.mIndices=[];for(var u=0;u<l.mNumIndices;++u)l.mIndices[u]=e.mNumVertices<65536?L(t):I(t);if(3===l.mNumIndices)e.mIndexArray.push(l.mIndices[0]),e.mIndexArray.push(l.mIndices[1]),e.mIndexArray.push(l.mIndices[2]);else{if(4!==l.mNumIndices)throw new Error("Sorry, can't currently triangulate polys. Use the triangulate preprocessor in Assimp.");e.mIndexArray.push(l.mIndices[0]),e.mIndexArray.push(l.mIndices[1]),e.mIndexArray.push(l.mIndices[2]),e.mIndexArray.push(l.mIndices[2]),e.mIndexArray.push(l.mIndices[3]),e.mIndexArray.push(l.mIndices[0])}}}if(e.mNumBones){e.mBones=[];for(u=0;u<e.mNumBones;++u)e.mBones[u]=new v,Z(t,e.mBones[u])}}function J(t,e){Y(D(t)==bt),D(t),e.mKey=U(t),e.mSemantic=I(t),e.mIndex=I(t),e.mDataLength=I(t),e.mType=I(t),e.mData=[],t.ReadBytes(e.mData,1,e.mDataLength)}function K(t,e){if(Y(D(t)==yt),D(t),e.mNumAllocated=e.mNumProperties=I(t),e.mNumProperties){e.mProperties&&delete e.mProperties,e.mProperties=[];for(var n=0;n<e.mNumProperties;++n)e.mProperties[n]=new g,J(t,e.mProperties[n])}}function $(t,e){Y(D(t)==dt),D(t),e.mNodeName=U(t),e.mNumPositionKeys=I(t),e.mNumRotationKeys=I(t),e.mNumScalingKeys=I(t),e.mPreState=I(t),e.mPostState=I(t),e.mNumPositionKeys&&(st?X(t,e.mPositionKeys,e.mNumPositionKeys):(e.mPositionKeys=[],W(t,e.mPositionKeys,e.mNumPositionKeys))),e.mNumRotationKeys&&(st?X(t,e.mRotationKeys,e.mNumRotationKeys):(e.mRotationKeys=[],function(t,e,n){for(var r=0;r<n;r++)e[r]=H(t)}(t,e.mRotationKeys,e.mNumRotationKeys))),e.mNumScalingKeys&&(st?X(t,e.mScalingKeys,e.mNumScalingKeys):(e.mScalingKeys=[],W(t,e.mScalingKeys,e.mNumScalingKeys)))}function tt(t,e){if(Y(D(t)==vt),D(t),e.mName=U(t),e.mDuration=P(t),e.mTicksPerSecond=P(t),e.mNumChannels=I(t),e.mNumChannels){e.mChannels=[];for(var n=0;n<e.mNumChannels;++n)e.mChannels[n]=new S,$(t,e.mChannels[n])}}function et(t,e){Y(D(t)==ht),D(t),e.mWidth=I(t),e.mHeight=I(t),t.ReadBytes(e.achFormatHint,1,4),st||(e.mHeight?(e.pcData=[],t.ReadBytes(e.pcData,1,e.mWidth*e.mHeight*4)):(e.pcData=[],t.ReadBytes(e.pcData,1,e.mWidth)))}function nt(t,e){Y(D(t)==ct),D(t),e.mName=U(t),e.mType=I(t),e.mType!=Pt&&(e.mAttenuationConstant=E(t),e.mAttenuationLinear=E(t),e.mAttenuationQuadratic=E(t)),e.mColorDiffuse=R(t),e.mColorSpecular=R(t),e.mColorAmbient=R(t),e.mType==Ot&&(e.mAngleInnerCone=E(t),e.mAngleOuterCone=E(t))}function rt(t,e){Y(D(t)==ut),D(t),e.mName=U(t),e.mPosition=F(t),e.mLookAt=F(t),e.mUp=F(t),e.mHorizontalFOV=E(t),e.mClipPlaneNear=E(t),e.mClipPlaneFar=E(t),e.mAspect=E(t)}function it(t,e){if(Y(D(t)==ft),D(t),e.mFlags=I(t),e.mNumMeshes=I(t),e.mNumMaterials=I(t),e.mNumAnimations=I(t),e.mNumTextures=I(t),e.mNumLights=I(t),e.mNumCameras=I(t),e.mRootNode=new m,e.mRootNode=q(t,null,0),e.mNumMeshes){e.mMeshes=[];for(var n=0;n<e.mNumMeshes;++n)e.mMeshes[n]=new p,Q(t,e.mMeshes[n])}if(e.mNumMaterials){e.mMaterials=[];for(n=0;n<e.mNumMaterials;++n)e.mMaterials[n]=new b,K(t,e.mMaterials[n])}if(e.mNumAnimations){e.mAnimations=[];for(n=0;n<e.mNumAnimations;++n)e.mAnimations[n]=new A,tt(t,e.mAnimations[n])}if(e.mNumTextures){e.mTextures=[];for(n=0;n<e.mNumTextures;++n)e.mTextures[n]=new M,et(t,e.mTextures[n])}if(e.mNumLights){e.mLights=[];for(n=0;n<e.mNumLights;++n)e.mLights[n]=new T,nt(t,e.mLights[n])}if(e.mNumCameras){e.mCameras=[];for(n=0;n<e.mNumCameras;++n)e.mCameras[n]=new C,rt(t,e.mCameras[n])}}var ot=new Lt(this.manager);ot.setPath(e).setCrossOrigin(this.crossOrigin);var at={};at.KeyFrame=function(t,e){this.time=t,this.matrix=e.clone(),this.position=new i,this.quaternion=new o,this.scale=new i(1,1,1),this.matrix.decompose(this.position,this.quaternion,this.scale),this.clone=function(){return new at.KeyFrame(this.time,this.matrix)},this.lerp=function(t,e){var n=(e-=this.time)/(t.time-this.time),r=1-n,i=this.position,o=this.quaternion,a=t.position,s=t.quaternion;return at.KeyFrame.tempAniPos.x=i.x*r+a.x*n,at.KeyFrame.tempAniPos.y=i.y*r+a.y*n,at.KeyFrame.tempAniPos.z=i.z*r+a.z*n,at.KeyFrame.tempAniQuat.set(o.x,o.y,o.z,o.w),at.KeyFrame.tempAniQuat.slerp(s,n),at.KeyFrame.tempAniMatrix.compose(at.KeyFrame.tempAniPos,at.KeyFrame.tempAniQuat,at.KeyFrame.tempAniScale)}},at.KeyFrame.tempAniPos=new i,at.KeyFrame.tempAniQuat=new o,at.KeyFrame.tempAniScale=new i(1,1,1),at.KeyFrame.tempAniMatrix=new r,at.KeyFrameTrack=function(){this.keys=[],this.target=null,this.time=0,this.length=0,this._accelTable={},this.fps=20,this.addKey=function(t){this.keys.push(t)},this.init=function(){if(this.sortKeys(),this.length=this.keys.length>0?this.keys[this.keys.length-1].time:0,this.fps)for(var t=0;t<this.length*this.fps;t++)for(var e=0;e<this.keys.length;e++){if(this.keys[e].time==t){this._accelTable[t]=e;break}if(this.keys[e].time<t/this.fps&&this.keys[e+1]&&this.keys[e+1].time>=t/this.fps){this._accelTable[t]=e;break}}},this.parseFromThree=function(t){var e=t.fps;this.target=t.node;for(var n=t.hierarchy[0].keys,r=0;r<n.length;r++)this.addKey(new at.KeyFrame(r/e||n[r].time,n[r].targets[0].data));this.init()},this.parseFromCollada=function(t){for(var e=t.keys,n=this.fps,r=0;r<e.length;r++)this.addKey(new at.KeyFrame(r/n||e[r].time,e[r].matrix));this.init()},this.sortKeys=function(){this.keys.sort(this.keySortFunc)},this.keySortFunc=function(t,e){return t.time-e.time},this.clone=function(){var t=new at.KeyFrameTrack;t.target=this.target,t.time=this.time,t.length=this.length;for(var e=0;e<this.keys.length;e++)t.addKey(this.keys[e].clone());return t.init(),t},this.reTarget=function(t,e){e||(e=at.TrackTargetNodeNameCompare),this.target=e(t,this.target)},this.keySearchAccel=function(t){return t*=this.fps,t=Math.floor(t),this._accelTable[t]||0},this.setTime=function(t){t=Math.abs(t),this.length&&(t=t%this.length+.05);for(var e=null,n=null,r=this.keySearchAccel(t);r<this.keys.length;r++){if(this.keys[r].time==t){e=this.keys[r],n=this.keys[r];break}if(this.keys[r].time<t&&this.keys[r+1]&&this.keys[r+1].time>t){e=this.keys[r],n=this.keys[r+1];break}if(this.keys[r].time<t&&r==this.keys.length-1){e=this.keys[r],(n=this.keys[0].clone()).time+=this.length+.05;break}}return e&&n&&e!==n?(this.target.matrixAutoUpdate=!1,this.target.matrix.copy(e.lerp(n,t)),void(this.target.matrixWorldNeedsUpdate=!0)):e&&n&&e==n?(this.target.matrixAutoUpdate=!1,this.target.matrix.copy(e.matrix),void(this.target.matrixWorldNeedsUpdate=!0)):void 0}},at.TrackTargetNodeNameCompare=function(t,e){function n(t,e){if(t.name==e)return t;for(var r=0;r<t.children.length;r++){var i=n(t.children[r],e);if(i)return i}return null}return n(t,e.name)},at.Animation=function(){this.tracks=[],this.length=0,this.addTrack=function(t){this.tracks.push(t),this.length=Math.max(t.length,this.length)},this.setTime=function(t){this.time=t;for(var e=0;e<this.tracks.length;e++)this.tracks[e].setTime(t)},this.clone=function(t,e){e||(e=at.TrackTargetNodeNameCompare);var n=new at.Animation;n.target=t;for(var r=0;r<this.tracks.length;r++){var i=this.tracks[r].clone();i.reTarget(t,e),n.addTrack(i)}return n}};var st,lt,ut=4660,ct=4661,ht=4662,pt=4663,dt=4664,ft=4665,mt=4666,vt=4667,gt=4668,yt=4669,bt=4670,xt=1,St=2,At=4,Mt=256,Tt=65536,Ct=1,Et=4,Pt=1,Ot=3,Nt=1,It=6,Dt=8,Ft=10,Rt=4,kt={"?mat.name":"name","$mat.shadingm":"shading","$mat.twosided":"twoSided","$mat.wireframe":"wireframe","$clr.ambient":"ambient","$clr.diffuse":"color","$clr.specular":"specular","$clr.emissive":"emissive","$clr.transparent":"transparent","$clr.reflective":"reflect","$mat.shininess":"shininess","$mat.reflectivity":"reflectivity","$mat.refracti":"refraction","$tex.file":"map"},Ut={"?mat.name":"string","$mat.shadingm":"bool","$mat.twosided":"bool","$mat.wireframe":"bool","$clr.ambient":"color","$clr.diffuse":"color","$clr.specular":"color","$clr.emissive":"color","$clr.transparent":"color","$clr.reflective":"color","$mat.shininess":"float","$mat.reflectivity":"float","$mat.refracti":"float","$tex.file":"map"},jt=!0,Bt=0,zt=1;return function(t){var e=new function(){this.mFlags=0,this.mNumMeshes=0,this.mNumMaterials=0,this.mNumAnimations=0,this.mNumTextures=0,this.mNumLights=0,this.mNumCameras=0,this.mRootNode=null,this.mMeshes=[],this.mMaterials=[],this.mAnimations=[],this.mLights=[],this.mCameras=[],this.nodeToBoneMap={},this.findNode=function(t,e){if(e||(e=this.mRootNode),e.mName==t)return e;for(var n=0;n<e.mChildren.length;n++){var r=this.findNode(t,e.mChildren[n]);if(r)return r}return null},this.toTHREE=function(){this.nodeCount=0,function(t){for(var e in t.mMeshes){var n=t.mMeshes[e];for(var r in n.mBones){var i=t.findNode(n.mBones[r].mName);i&&(i.isBone=!0)}}}(this);var t=this.mRootNode.toTHREE(this);for(var e in this.mMeshes)this.mMeshes[e].hookupSkeletons(this,t);if(this.mAnimations.length>0)var n=this.mAnimations[0].toTHREE(this);return{object:t,animation:n}}},n=new DataView(t);if(function(t){t.readOffset=0,t.Seek=function(e,n){n==Bt&&(t.readOffset+=e),n==zt&&(t.readOffset=e)},t.ReadBytes=function(t,e,n){for(var r=e*n,i=0;i<r;i++)t[i]=N(this)},t.subArray32=function(t,e){var n=this.buffer.slice(t,e);return new Float32Array(n)},t.subArrayUint16=function(t,e){var n=this.buffer.slice(t,e);return new Uint16Array(n)},t.subArrayUint8=function(t,e){var n=this.buffer.slice(t,e);return new Uint8Array(n)},t.subArrayUint32=function(t,e){var n=this.buffer.slice(t,e);return new Uint32Array(n)}}(n),n.Seek(44,Bt),I(n),I(n),I(n),I(n),st=L(n)>0,lt=L(n)>0,st)throw"Shortened binaries are not supported!";if(n.Seek(256,Bt),n.Seek(128,Bt),n.Seek(64,Bt),!lt)return it(n,e),e.toTHREE();var r=D(n),i=n.FileSize()-n.Tell(),o=[];n.Read(o,1,i);var a=[];uncompress(a,r,o,i),it(new ArrayBuffer(a),e)}(t)}};Pe.prototype={set:function(t,e){this[t]=e},get:function(t,e){return this.hasOwnProperty(t)?this[t]:e}};var ru=function(t){this.manager=void 0!==t?t:il,this.trunk=new c,this.materialFactory=void 0,this._url="",this._baseDir="",this._data=void 0,this._ptr=0,this._version=[],this._streaming=!1,this._optimized_for_accuracy=!1,this._compression=0,this._bodylen=4294967295,this._blocks=[new Ee],this._accuracyMatrix=!1,this._accuracyGeo=!1,this._accuracyProps=!1};ru.prototype={constructor:ru,load:function(t,e,n,r){var i=this;this._url=t,this._baseDir=t.substr(0,t.lastIndexOf("/")+1);var o=new gt(this.manager);o.setResponseType("arraybuffer"),o.load(t,function(t){e(i.parse(t))},n,r)},parse:function(t){var e=t.byteLength;for(this._ptr=0,this._data=new DataView(t),this._parseHeader(),0!=this._compression&&console.error("compressed AWD not supported"),this._streaming||this._bodylen==t.byteLength-this._ptr||console.error("AWDLoader: body len does not match file length",this._bodylen,e-this._ptr);this._ptr<e;)this.parseNextBlock();return this.trunk},parseNextBlock:function(){var t,e,n=this.readU32(),r=(this.readU8(),this.readU8()),i=(this.readU8(),this.readU32());switch(r){case 1:t=this.parseMeshData(i);break;case 22:t=this.parseContainer(i);break;case 23:t=this.parseMeshInstance(i);break;case 81:t=this.parseMaterial(i);break;case 82:t=this.parseTexture(i);break;case 101:t=this.parseSkeleton(i);break;case 112:t=this.parseMeshPoseAnimation(i,!1);break;case 113:t=this.parseVertexAnimationSet(i);break;case 102:t=this.parseSkeletonPose(i);break;case 103:t=this.parseSkeletonAnimation(i);break;case 122:t=this.parseAnimatorSet(i);break;default:this._ptr+=i}this._blocks[n]=e=new Ee,e.data=t,e.id=n},_parseHeader:function(){var t=this._version;if(4282180!=(this.readU8()<<16|this.readU8()<<8|this.readU8()))throw new Error("AWDLoader - bad magic");t[0]=this.readU8(),t[1]=this.readU8();var e=this.readU16();this._streaming=1==(1&e),2===t[0]&&1===t[1]&&(this._accuracyMatrix=2==(2&e),this._accuracyGeo=4==(4&e),this._accuracyProps=8==(8&e)),this._geoNrType=this._accuracyGeo?8:7,this._matrixNrType=this._accuracyMatrix?8:7,this._propsNrType=this._accuracyProps?8:7,this._optimized_for_accuracy=2==(2&e),this._compression=this.readU8(),this._bodylen=this.readU32()},parseContainer:function(t){var e=new c,n=this.readU32(),r=this.parseMatrix4();return e.name=this.readUTF(),e.applyMatrix(r),(this._blocks[n].data||this.trunk).add(e),this.parseProperties({1:this._matrixNrType,2:this._matrixNrType,3:this._matrixNrType,4:4}),e.extra=this.parseUserAttributes(),e},parseMeshInstance:function(t){var e,n,r,i,o,a,s,l,u,h,p,d,f;for(a=this.readU32(),l=this.parseMatrix4(),e=this.readUTF(),s=this.readU32(),d=this.readU16(),r=this.getBlock(s),u=[],f=0;f<d;f++)p=this.readU32(),h=this.getBlock(p),u.push(h);if(i=r.length,o=[],i>1)for(n=new c,f=0;f<i;f++){var m=new B(r[f]);o.push(m),n.add(m)}else n=new B(r[0]),o.push(n);n.applyMatrix(l),n.name=e,(this.getBlock(a)||this.trunk).add(n);var v=u.length,g=Math.max(i,v);for(f=0;f<g;f++)o[f%i].material=u[f%v];return this.parseProperties(null),n.extra=this.parseUserAttributes(),n},parseMaterial:function(t){var e,n,r,i,o,a;for(e=this.readUTF(),n=this.readU8(),a=this.readU8(),r=this.parseProperties({1:3,2:23,11:21,12:7,13:21}),0;0<a;){this.readU16();this.parseProperties(null),this.parseUserAttributes()}if(o=this.parseUserAttributes(),void 0!==this.materialFactory&&(i=this.materialFactory(e)))return i;if(i=new wt,1===n)i.color.setHex(r.get(1,13421772));else if(2===n){var s=r.get(2,0);i.map=this.getBlock(s)}return i.extra=o,i.alphaThreshold=r.get(12,0),i.repeat=r.get(13,!1),i},parseTexture:function(t){var e,n;this.readUTF();if(0===this.readU8()){n=this.readU32();var r=this.readUTFBytes(n);console.log(r),e=this.loadTexture(r)}return this.parseProperties(null),this.parseUserAttributes(),e},loadTexture:function(t){var e=new ht;return new Nt(this.manager).load(this._baseDir+t,function(t){e.image=t,e.needsUpdate=!0}),e},parseSkeleton:function(t){this.readUTF();var e=this.readU16(),n=[],r=0;for(this.parseProperties(null);r<e;){var i,o;this.readU16(),(i=new V).parent=this.readU16()-1,i.name=this.readUTF(),o=this.parseMatrix4(),i.skinMatrix=o,this.parseProperties(null),this.parseUserAttributes(),n.push(i),r++}return this.parseUserAttributes(),n},parseSkeletonPose:function(t){this.readUTF();var e=this.readU16();this.parseProperties(null);for(var n=[],i=0;i<e;){var o;o=1===this.readU8()?this.parseMatrix4():new r,n[i]=o,i++}return this.parseUserAttributes(),n},parseSkeletonAnimation:function(t){this.readUTF();var e,n,r=[],i=this.readU16();this.parseProperties(null);for(var o=0;o<i;)n=this.readU32(),e=this.readU16(),r.push({pose:this._blocks[n].data,duration:e}),o++;if(0!==r.length)return this.parseUserAttributes(),r},parseVertexAnimationSet:function(t){this.readUTF();for(var e,n=this.readU16(),r=(this.parseProperties({1:5}),0),i=[];r<n;)e=this.readU32(),i.push(this._blocks[e].data),r++;return this.parseUserAttributes(),i},parseAnimatorSet:function(t){this.readUTF();var e,n,r=this.readU16(),i=this.parseProperties({1:23});e=this.readU32();for(var o=this.readU16(),a=[],s=0;s<o;s++)a.push(this.readU32());this.readU16(),Boolean(this.readU8());this.parseUserAttributes(),this.parseUserAttributes();var l=[];for(s=0;s<a.length;s++)l.push(this._blocks[a[s]].data);n=this._blocks[e].data;var u;for(1==r&&(u={animationSet:n,skeleton:this._blocks[i.get(1,0)].data}),s=0;s<l.length;s++)l[s].animator=u;return u},parseMeshData:function(t){var e,n,r=this.readUTF(),i=this.readU16(),o=0,a=[];for(this.parseProperties({1:this._geoNrType,2:this._geoNrType});o<i;){var s,l,u;for((e=new O).name=r,a.push(e),s=this.readU32(),l=this._ptr+s,this.parseProperties({1:this._geoNrType,2:this._geoNrType});this._ptr<l;){var c=0,h=this.readU8(),p=(this.readU8(),this.readU32()),d=p+this._ptr;if(1===h)for(u=new y(n=new Float32Array(p/12*3),3),e.addAttribute("position",u),c=0;this._ptr<d;)n[c]=-this.readF32(),n[c+1]=this.readF32(),n[c+2]=this.readF32(),c+=3;else if(2===h)for(u=new y(n=new Uint16Array(p/2),1),e.setIndex(u),c=0;this._ptr<d;)n[c+1]=this.readU16(),n[c]=this.readU16(),n[c+2]=this.readU16(),c+=3;else if(3===h)for(u=new y(n=new Float32Array(p/8*2),2),e.addAttribute("uv",u),c=0;this._ptr<d;)n[c]=this.readF32(),n[c+1]=1-this.readF32(),c+=2;else if(4===h)for(u=new y(n=new Float32Array(p/12*3),3),e.addAttribute("normal",u),c=0;this._ptr<d;)n[c]=-this.readF32(),n[c+1]=this.readF32(),n[c+2]=this.readF32(),c+=3;else this._ptr=d}this.parseUserAttributes(),e.computeBoundingSphere(),o++}return this.parseUserAttributes(),a},parseMeshPoseAnimation:function(t,e){var n,r,i,o,a,s,l,u,c,h=1,p=0,d={},f=[],m=(this.readUTF(),this.readU32()),v=this.getBlock(m);if(null!==v){for((s=v.geometry).morphTargets=[],e||(h=this.readU16()),n=this.readU16(),l=this.readU16(),u=0;u<l;)f.push(this.readU16()),u++;for(c=this.parseProperties({1:21,2:21}),d.looping=c.get(1,!0),d.stitchFinalFrame=c.get(2,!1),r=0;r<h;){for(this.readU16(),i=0;i<n;)for(u=0,o=this.readU32(),a=this._ptr+o;u<l;){if(1===f[u]){var g=new Float32Array(o/4);for(s.morphTargets.push({array:g}),p=0;this._ptr<a;)g[p]=this.readF32(),g[p+1]=this.readF32(),g[p+2]=this.readF32(),p+=3;i++}else this._ptr=a;u++}r++}return this.parseUserAttributes(),null}console.log("parseMeshPoseAnimation target mesh not found at:",m)},getBlock:function(t){return this._blocks[t].data},parseMatrix4:function(){var t=new r,e=t.elements;return e[0]=this.readF32(),e[1]=this.readF32(),e[2]=this.readF32(),e[3]=0,e[4]=this.readF32(),e[5]=this.readF32(),e[6]=this.readF32(),e[7]=0,e[8]=this.readF32(),e[9]=this.readF32(),e[10]=this.readF32(),e[11]=0,e[12]=-this.readF32(),e[13]=this.readF32(),e[14]=this.readF32(),e[15]=1,t},parseProperties:function(t){var e=this.readU32(),n=this._ptr+e,r=new Pe;if(t)for(;this._ptr<n;){var i=this.readU16(),o=this.readU32();t.hasOwnProperty(i)?r.set(i,this.parseAttrValue(t[i],o)):this._ptr+=o}return r},parseUserAttributes:function(){return this._ptr=this.readU32()+this._ptr,null},parseAttrValue:function(t,e){var n,r;switch(t){case 1:n=1,r=this.readI8;break;case 2:n=2,r=this.readI16;break;case 3:n=4,r=this.readI32;break;case 21:case 4:n=1,r=this.readU8;break;case 5:n=2,r=this.readU16;break;case 6:case 23:n=4,r=this.readU32;break;case 7:n=4,r=this.readF32;break;case 8:n=8,r=this.readF64;break;case 41:case 42:case 43:case 44:case 45:case 46:case 47:n=8,r=this.readF64}if(n<e){var i,o,a;for(i=[],o=0,a=e/n;o<a;)i.push(r.call(this)),o++;return i}return r.call(this)},readU8:function(){return this._data.getUint8(this._ptr++)},readI8:function(){return this._data.getInt8(this._ptr++)},readU16:function(){var t=this._data.getUint16(this._ptr,!0);return this._ptr+=2,t},readI16:function(){var t=this._data.getInt16(this._ptr,!0);return this._ptr+=2,t},readU32:function(){var t=this._data.getUint32(this._ptr,!0);return this._ptr+=4,t},readI32:function(){var t=this._data.getInt32(this._ptr,!0);return this._ptr+=4,t},readF32:function(){var t=this._data.getFloat32(this._ptr,!0);return this._ptr+=4,t},readF64:function(){var t=this._data.getFloat64(this._ptr,!0);return this._ptr+=8,t},readUTF:function(){var t=this.readU16();return this.readUTFBytes(t)},readUTFBytes:function(t){for(var e=[],n=0;e.length<t;){var r=this._data.getUint8(this._ptr++,!0);if(r<128)e[n++]=String.fromCharCode(r);else if(r>191&&r<224){var i=this._data.getUint8(this._ptr++,!0);e[n++]=String.fromCharCode((31&r)<<6|63&i)}else{i=this._data.getUint8(this._ptr++,!0);var o=this._data.getUint8(this._ptr++,!0);e[n++]=String.fromCharCode((15&r)<<12|(63&i)<<6|63&o)}}return e.join("")}},Oe.prototype=Object.assign(Object.create(c.prototype),{constructor:Oe,isLight:!0,copy:function(t){return c.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=c.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),Object.assign(Ne.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),Le.prototype=Object.assign(Object.create(Oe.prototype),{constructor:Le,isPointLight:!0,copy:function(t){return Oe.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),Ie.prototype=Object.assign(Object.create(Ne.prototype),{constructor:Ie}),De.prototype=Object.assign(Object.create(Oe.prototype),{constructor:De,isDirectionalLight:!0,copy:function(t){return Oe.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Fe.prototype=Object.assign(Object.create(Ne.prototype),{constructor:Fe,isSpotLightShadow:!0,update:function(t){var e=this.camera,n=2*xo.RAD2DEG*t.angle,r=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;n===e.fov&&r===e.aspect&&i===e.far||(e.fov=n,e.aspect=r,e.far=i,e.updateProjectionMatrix())}}),Re.prototype=Object.assign(Object.create(Oe.prototype),{constructor:Re,isSpotLight:!0,copy:function(t){return Oe.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),ke.prototype=Object.assign(Object.create(Oe.prototype),{constructor:ke,isHemisphereLight:!0,copy:function(t){return Oe.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}});var iu=function(t){this.manager=void 0!==t?t:il};iu.prototype={constructor:iu,load:function(t,e,n,r){var i=this;new gt(i.manager).load(t,function(t){e(i.parse(JSON.parse(t)))},n,r)},parse:function(t){function e(t){var e=new O,n=t.positions,r=t.normals,i=t.uvs;e.setIndex(t.indices);for(var o=2,a=n.length;o<a;o+=3)n[o]=-n[o];if(e.addAttribute("position",new T(n,3)),r){for(o=2,a=r.length;o<a;o+=3)r[o]=-r[o];e.addAttribute("normal",new T(r,3))}i&&e.addAttribute("uv",new T(i,2));var s=t.subMeshes;if(s)for(o=0,a=s.length;o<a;o++){var l=s[o];e.addGroup(l.indexStart,l.indexCount)}return e}return function(t,n){for(var r={},i=new ut,o=t.cameras,a=0,s=o.length;a<s;a++){var l=new st((p=o[a]).fov/Math.PI*180,1.33,p.minZ,p.maxZ);l.name=p.name,l.position.fromArray(p.position),p.rotation&&l.rotation.fromArray(p.rotation),r[p.id]=l}var u=t.lights;for(a=0,s=u.length;a<s;a++){var c;switch((p=u[a]).type){case 0:c=new Le;break;case 1:c=new De;break;case 2:c=new Re;break;case 3:c=new ke}c.name=p.name,p.position&&c.position.set(p.position[0],p.position[1],-p.position[2]),c.color.fromArray(p.diffuse),p.groundColor&&c.groundColor.fromArray(p.groundColor),p.intensity&&(c.intensity=p.intensity),r[p.id]=c,i.add(c)}var h=t.meshes;for(a=0,s=h.length;a<s;a++){var p,d;(d=(p=h[a]).indices?new B(e(p),n[p.materialId]):new Me).name=p.name,d.position.set(p.position[0],p.position[1],-p.position[2]),d.rotation.fromArray(p.rotation),p.rotationQuaternion&&d.quaternion.fromArray(p.rotationQuaternion),d.scale.fromArray(p.scaling),p.parentId?r[p.parentId].add(d):i.add(d),r[p.id]=d}return i}(t,function(t){for(var e={},n=0,r=t.materials.length;n<r;n++){var i=t.materials[n],o=new wt;o.name=i.name,o.color.fromArray(i.diffuse),o.emissive.fromArray(i.emissive),o.specular.fromArray(i.specular),o.shininess=i.specularPower,o.opacity=i.alpha,e[i.id]=o}if(t.multiMaterials)for(n=0,r=t.multiMaterials.length;n<r;n++)i=t.multiMaterials[n],console.warn("BabylonLoader: Multi materials not yet supported."),e[i.id]=new wt;return e}(t))}};var ou=function(t){this.manager=void 0!==t?t:il,this.animateBonePositions=!0,this.animateBoneRotations=!0};ou.prototype={constructor:ou,load:function(t,e,n,r){var i=this;new gt(i.manager).load(t,function(t){e(i.parse(t))},n,r)},parse:function(t){function e(t,n,r){if("ENDSITE"!==r.type){var a={time:n,position:new i,rotation:new o};r.frames.push(a);for(var s=new o,l=new i(1,0,0),u=new i(0,1,0),c=new i(0,0,1),h=0;h<r.channels.length;h++)switch(r.channels[h]){case"Xposition":a.position.x=parseFloat(t.shift().trim());break;case"Yposition":a.position.y=parseFloat(t.shift().trim());break;case"Zposition":a.position.z=parseFloat(t.shift().trim());break;case"Xrotation":s.setFromAxisAngle(l,parseFloat(t.shift().trim())*Math.PI/180),a.rotation.multiply(s);break;case"Yrotation":s.setFromAxisAngle(u,parseFloat(t.shift().trim())*Math.PI/180),a.rotation.multiply(s);break;case"Zrotation":s.setFromAxisAngle(c,parseFloat(t.shift().trim())*Math.PI/180),a.rotation.multiply(s);break;default:console.warn("BVHLoader: Invalid channel type.")}for(h=0;h<r.children.length;h++)e(t,n,r.children[h])}}function n(t,e,r){var o={name:"",type:"",frames:[]};r.push(o);var s=e.split(/[\s]+/);"END"===s[0].toUpperCase()&&"SITE"===s[1].toUpperCase()?(o.type="ENDSITE",o.name="ENDSITE"):(o.name=s[1],o.type=s[0].toUpperCase()),"{"!==a(t)&&console.error("BVHLoader: Expected opening { after type & name"),"OFFSET"!==(s=a(t).split(/[\s]+/))[0]&&console.error("BVHLoader: Expected OFFSET but got: "+s[0]),4!==s.length&&console.error("BVHLoader: Invalid number of values for OFFSET.");var l=new i(parseFloat(s[1]),parseFloat(s[2]),parseFloat(s[3]));if((isNaN(l.x)||isNaN(l.y)||isNaN(l.z))&&console.error("BVHLoader: Invalid values of OFFSET."),o.offset=l,"ENDSITE"!==o.type){"CHANNELS"!==(s=a(t).split(/[\s]+/))[0]&&console.error("BVHLoader: Expected CHANNELS definition.");var u=parseInt(s[1]);o.channels=s.splice(2,u),o.children=[]}for(;;){var c=a(t);if("}"===c)return o;o.children.push(n(t,c,r))}}function r(t,e){var n=new V;if(e.push(n),n.position.add(t.offset),n.name=t.name,"ENDSITE"!==t.type)for(var i=0;i<t.children.length;i++)n.add(r(t.children[i],e));return n}function a(t){for(var e;0===(e=t.shift().trim()).length;);return e}var s=this,l=function(t){"HIERARCHY"!==a(t)&&console.error("BVHLoader: HIERARCHY expected.");var r=[],i=n(t,a(t),r);"MOTION"!==a(t)&&console.error("BVHLoader: MOTION expected.");var o=a(t).split(/[\s]+/),s=parseInt(o[1]);isNaN(s)&&console.error("BVHLoader: Failed to read number of frames."),o=a(t).split(/[\s]+/);var l=parseFloat(o[2]);isNaN(l)&&console.error("BVHLoader: Failed to read frame time.");for(var u=0;u<s;u++)e(o=a(t).split(/[\s]+/),u*l,i);return r}(t.split(/[\r\n]+/g)),u=[];r(l[0],u);var c=function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];if("ENDSITE"!==r.type){for(var i=[],o=[],a=[],l=0;l<r.frames.length;l++){var u=r.frames[l];i.push(u.time),o.push(u.position.x+r.offset.x),o.push(u.position.y+r.offset.y),o.push(u.position.z+r.offset.z),a.push(u.rotation.x),a.push(u.rotation.y),a.push(u.rotation.z),a.push(u.rotation.w)}s.animateBonePositions&&e.push(new $(".bones["+r.name+"].position",i,o)),s.animateBoneRotations&&e.push(new J(".bones["+r.name+"].quaternion",i,a))}}return new ot("animation",-1,e)}(l);return{skeleton:new Te(u),clip:c}}},Ue.prototype=Object.assign(Object.create(Oe.prototype),{constructor:Ue,isAmbientLight:!0}),je.prototype=Object.assign(Object.create(z.prototype),{constructor:je,isLineSegments:!0,computeLineDistances:function(){var t=new i,e=new i;return function(){var n=this.geometry;if(n.isBufferGeometry)if(null===n.index){for(var r=n.attributes.position,i=[],o=0,a=r.count;o<a;o+=2)t.fromBufferAttribute(r,o),e.fromBufferAttribute(r,o+1),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+t.distanceTo(e);n.addAttribute("lineDistance",new T(i,1))}else console.warn("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(n.isGeometry){var s=n.vertices;for(i=n.lineDistances,o=0,a=s.length;o<a;o+=2)t.copy(s[o]),e.copy(s[o+1]),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+t.distanceTo(e)}return this}}()});var au=function(t){this.manager=void 0!==t?t:il};au.prototype={constructor:au,crossOrigin:"Anonymous",load:function(t,e,n,r){var i=this,o=void 0===i.path?al.extractUrlBase(t):i.path;new gt(i.manager).load(t,function(t){e(i.parse(t,o))},n,r)},setPath:function(t){this.path=t},options:{set convertUpAxis(t){console.warn("ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.")}},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){function n(t,e){for(var n=[],r=t.childNodes,i=0,o=r.length;i<o;i++){var a=r[i];a.nodeName===e&&n.push(a)}return n}function a(t){if(0===t.length)return[];for(var e=t.trim().split(/\s+/),n=new Array(e.length),r=0,i=e.length;r<i;r++)n[r]=e[r];return n}function l(t){if(0===t.length)return[];for(var e=t.trim().split(/\s+/),n=new Array(e.length),r=0,i=e.length;r<i;r++)n[r]=parseFloat(e[r]);return n}function u(t){if(0===t.length)return[];for(var e=t.trim().split(/\s+/),n=new Array(e.length),r=0,i=e.length;r<i;r++)n[r]=parseInt(e[r]);return n}function c(t){return t.substring(1)}function p(){return"three_default_"+Mt++}function d(t){return 0===Object.keys(t).length}function f(t,e,r,i){var o=n(t,e)[0];if(void 0!==o)for(var a=n(o,r),s=0;s<a.length;s++)i(a[s])}function m(t,e){for(var n in t){t[n].build=e(t[n])}}function v(t,e){return void 0!==t.build?t.build:(t.build=e(t),t.build)}function g(t){var e=[],n=t.channels,r=t.samplers,i=t.sources;for(var o in n)if(n.hasOwnProperty(o)){var a=n[o],s=r[a.sampler];!function(t,e){for(var n=t.keyframes,r=t.name,i=[],o=[],a=[],s=[],l=0,u=n.length;l<u;l++){var c=n[l],h=c.time,p=c.value;ft.fromArray(p).transpose(),ft.decompose(ht,dt,pt),i.push(h),o.push(ht.x,ht.y,ht.z),a.push(dt.x,dt.y,dt.z,dt.w),s.push(pt.x,pt.y,pt.z)}o.length>0&&e.push(new $(r+".position",i,o));a.length>0&&e.push(new J(r+".quaternion",i,a));s.length>0&&e.push(new $(r+".scale",i,s))}(function(t,e,n){var r,i,o,a,s,l,u=Tt.nodes[t.id],c=it(u.id),h=u.transforms[t.sid],p=u.matrix.clone().transpose(),d={};switch(h){case"matrix":for(o=0,a=e.array.length;o<a;o++)if(r=e.array[o],i=o*n.stride,void 0===d[r]&&(d[r]={}),!0===t.arraySyntax){var f=n.array[i],m=t.indices[0]+4*t.indices[1];d[r][m]=f}else for(s=0,l=n.stride;s<l;s++)d[r][s]=n.array[i+s];break;case"translate":case"rotate":case"scale":console.warn('ColladaLoader: Animation transform type "%s" not yet implemented.',h)}var v=function(t,e){var n=[];for(var r in t)n.push({time:parseFloat(r),value:t[r]});n.sort(function(t,e){return t.time-e.time});for(var i=0;i<16;i++)!function(t,e,n){var r,i,o,a=!0;for(i=0,o=t.length;i<o;i++)void 0===(r=t[i]).value[e]?r.value[e]=null:a=!1;if(!0===a)for(i=0,o=t.length;i<o;i++)(r=t[i]).value[e]=n;else!function(t,e){for(var n,r,i=0,o=t.length;i<o;i++){var a=t[i];if(null===a.value[e]){if(n=function(t,e,n){for(;e>=0;){var r=t[e];if(null!==r.value[n])return r;e--}return null}(t,i,e),r=function(t,e,n){for(;e<t.length;){var r=t[e];if(null!==r.value[n])return r;e++}return null}(t,i,e),null===n){a.value[e]=r.value[e];continue}if(null===r){a.value[e]=n.value[e];continue}!function(t,e,n,r){if(n.time-e.time==0)return void(t.value[r]=e.value[r]);t.value[r]=(t.time-e.time)*(n.value[r]-e.value[r])/(n.time-e.time)+e.value[r]}(a,n,r,e)}}}(t,e)}(n,i,e.elements[i]);return n}(d,p);return{name:c.uuid,keyframes:v}}(a,i[s.inputs.INPUT],i[s.inputs.OUTPUT]),e)}return e}function y(t){return v(Tt.animations[t],g)}function b(t){for(var e=[],n=t.name,r=t.end-t.start||-1,i=t.animations,o=0,a=i.length;o<a;o++)for(var s=y(i[o]),l=0,u=s.length;l<u;l++)e.push(s[l]);return new ot(n,r,e)}function _(t){return v(Tt.clips[t],b)}function x(t){var e={id:t.id},n=Tt.geometries[e.id];return void 0!==t.skin&&(e.skin=function(t){function e(t,e){return e.weight-t.weight}var n,i,o,a={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},s=t.vertexWeights,l=s.vcount,u=s.v,c=s.inputs.JOINT.offset,h=s.inputs.WEIGHT.offset,p=t.sources[t.joints.inputs.JOINT],d=t.sources[t.joints.inputs.INV_BIND_MATRIX],f=t.sources[s.inputs.WEIGHT.id].array,m=0;for(n=0,o=l.length;n<o;n++){var v=l[n],g=[];for(i=0;i<v;i++){var y=u[m+c],b=u[m+h],_=f[b];g.push({index:y,weight:_}),m+=2}for(g.sort(e),i=0;i<4;i++){var x=g[i];void 0!==x?(a.indices.array.push(x.index),a.weights.array.push(x.weight)):(a.indices.array.push(0),a.weights.array.push(0))}}for(a.bindMatrix=(new r).fromArray(t.bindShapeMatrix).transpose(),n=0,o=p.array.length;n<o;n++){var w=p.array[n],S=(new r).fromArray(d.array,n*d.stride).transpose();a.joints.push({name:w,boneInverse:S})}return a}(t.skin),n.sources.skinIndices=e.skin.indices,n.sources.skinWeights=e.skin.weights),e}function w(t){return v(Tt.controllers[t],x)}function S(t){return void 0!==t.build?t.build:t.init_from}function A(t){return v(Tt.images[t],S)}function M(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"color":e[i.nodeName]=l(i.textContent);break;case"float":e[i.nodeName]=parseFloat(i.textContent);break;case"texture":e[i.nodeName]={id:i.getAttribute("texture"),extra:function(t){for(var e={technique:{}},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"extra":!function(t,e){for(var n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"technique":!function(t,e){for(var n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":e.technique[i.nodeName]=parseFloat(i.textContent);break;case"wrapU":case"wrapV":e.technique[i.nodeName]="TRUE"===i.textContent.toUpperCase()?1:"FALSE"===i.textContent.toUpperCase()?0:parseInt(i.textContent)}}}(i,e)}}}(i,e)}}return e}(i)}}}return e}function C(t){return t}function E(t){function e(t){var e,n=r.profile.samplers[t.id];if(void 0!==n){e=A(r.profile.surfaces[n.source].init_from)}else console.warn("ColladaLoader: Undefined sampler. Access image directly (see #12530)."),e=A(t.id);if(void 0!==e){var i=xt.load(e),o=t.extra;if(void 0!==o&&void 0!==o.technique&&!1===d(o.technique)){var a=o.technique;i.wrapS=a.wrapU?Ia:Da,i.wrapT=a.wrapV?Ia:Da,i.offset.set(a.offsetU||0,a.offsetV||0),i.repeat.set(a.repeatU||1,a.repeatV||1)}else i.wrapS=Ia,i.wrapT=Ia;return i}return console.error("ColladaLoader: Unable to load texture with ID:",t.id),null}var n,r=function(t){return v(Tt.effects[t],C)}(t.url),i=r.profile.technique,o=r.profile.extra;switch(i.type){case"phong":case"blinn":n=new wt;break;case"lambert":n=new _t;break;default:n=new D}n.name=t.name;var a=i.parameters;for(var s in a){var l=a[s];switch(s){case"diffuse":l.color&&n.color.fromArray(l.color),l.texture&&(n.map=e(l.texture));break;case"specular":l.color&&n.specular&&n.specular.fromArray(l.color),l.texture&&(n.specularMap=e(l.texture));break;case"shininess":l.float&&n.shininess&&(n.shininess=l.float);break;case"emission":l.color&&n.emissive&&n.emissive.fromArray(l.color)}}var u=a.transparent,c=a.transparency;if(void 0===c&&u&&(c={float:1}),void 0===u&&c&&(u={opaque:"A_ONE",data:{color:[1,1,1,1]}}),u&&c)if(u.data.texture)n.alphaMap=e(u.data.texture),n.transparent=!0;else{var h=u.data.color;switch(u.opaque){case"A_ONE":n.opacity=h[3]*c.float;break;case"RGB_ZERO":n.opacity=1-h[0]*c.float;break;case"A_ZERO":n.opacity=1-h[3]*c.float;break;case"RGB_ONE":n.opacity=h[0]*c.float;break;default:console.warn('ColladaLoader: Invalid opaque type "%s" of transparent tag.',u.opaque)}n.opacity<1&&(n.transparent=!0)}return void 0!==o&&void 0!==o.technique&&1===o.technique.double_sided&&(n.side=ko),n}function P(t){return v(Tt.materials[t],E)}function N(t){var e;switch(t.optics.technique){case"perspective":e=new st(t.optics.parameters.yfov,t.optics.parameters.aspect_ratio,t.optics.parameters.znear,t.optics.parameters.zfar);break;case"orthographic":var n=t.optics.parameters.ymag,r=t.optics.parameters.xmag,i=t.optics.parameters.aspect_ratio;r=void 0===r?n*i:r,n=void 0===n?r/i:n,e=new ct(-(r*=.5),r,n*=.5,-n,t.optics.parameters.znear,t.optics.parameters.zfar);break;default:e=new st}return e.name=t.name,e}function L(t){var e=Tt.cameras[t];return void 0!==e?v(e,N):(console.warn("ColladaLoader: Couldn't find camera with ID:",t),null)}function I(t){var e;switch(t.technique){case"directional":e=new De;break;case"point":e=new Le;break;case"spot":e=new Re;break;case"ambient":e=new Ue}return t.parameters.color&&e.color.copy(t.parameters.color),t.parameters.distance&&(e.distance=t.parameters.distance),e}function R(t){var e=Tt.lights[t];return void 0!==e?v(e,I):(console.warn("ColladaLoader: Couldn't find light with ID:",t),null)}function k(t){for(var e={array:[],stride:3},r=0;r<t.childNodes.length;r++){var i=t.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"float_array":e.array=l(i.textContent);break;case"Name_array":e.array=a(i.textContent);break;case"technique_common":var o=n(i,"accessor")[0];void 0!==o&&(e.stride=parseInt(o.getAttribute("stride")))}}return e}function U(t){for(var e=0,n=0,r=t.length;n<r;n++){!0===t[n].hasUV&&e++}e>0&&e<t.length&&(t.uvsNeedsFix=!0)}function j(t){var e={},n=t.sources,r=t.vertices,i=t.primitives;if(0===i.length)return{};var o=function(t){for(var e={},n=0;n<t.length;n++){var r=t[n];void 0===e[r.type]&&(e[r.type]=[]),e[r.type].push(r)}return e}(i);for(var a in o){var s=o[a];U(s),e[a]=function(t,e,n){for(var r={},i={array:[],stride:0},o={array:[],stride:0},a={array:[],stride:0},s={array:[],stride:0},l={array:[],stride:4},u={array:[],stride:4},c=new O,h=[],p=0,d=0,f=0;f<t.length;f++){var m=t[f],v=m.inputs,g=1;m.vcount&&4===m.vcount[0]&&(g=2),c.addGroup(p,d="lines"===m.type||"linestrips"===m.type?2*m.count:3*m.count*g,f),p+=d,m.material&&h.push(m.material);for(var y in v){var b=v[y];switch(y){case"VERTEX":for(var _ in n){var x=n[_];switch(_){case"POSITION":var w=i.array.length;if(G(m,e[x],b.offset,i.array),i.stride=e[x].stride,e.skinWeights&&e.skinIndices&&(G(m,e.skinIndices,b.offset,l.array),G(m,e.skinWeights,b.offset,u.array)),!1===m.hasUV&&!0===t.uvsNeedsFix)for(var d=(i.array.length-w)/i.stride,S=0;S<d;S++)a.array.push(0,0);break;case"NORMAL":G(m,e[x],b.offset,o.array),o.stride=e[x].stride;break;case"COLOR":G(m,e[x],b.offset,s.array),s.stride=e[x].stride;break;case"TEXCOORD":G(m,e[x],b.offset,a.array),a.stride=e[x].stride;break;default:console.warn('ColladaLoader: Semantic "%s" not handled in geometry build process.',_)}}break;case"NORMAL":G(m,e[b.id],b.offset,o.array),o.stride=e[b.id].stride;break;case"COLOR":G(m,e[b.id],b.offset,s.array),s.stride=e[b.id].stride;break;case"TEXCOORD":G(m,e[b.id],b.offset,a.array),a.stride=e[b.id].stride}}}i.array.length>0&&c.addAttribute("position",new T(i.array,i.stride));o.array.length>0&&c.addAttribute("normal",new T(o.array,o.stride));s.array.length>0&&c.addAttribute("color",new T(s.array,s.stride));a.array.length>0&&c.addAttribute("uv",new T(a.array,a.stride));l.array.length>0&&c.addAttribute("skinIndex",new T(l.array,l.stride));u.array.length>0&&c.addAttribute("skinWeight",new T(u.array,u.stride));return r.data=c,r.type=t[0].type,r.materialKeys=h,r}(s,n,r)}return e}function G(t,e,n,r){function i(t){for(var e=o[t+n]*c,i=e+c;e<i;e++)r.push(u[e])}var o=t.p,a=t.stride,s=t.vcount,l=0,u=e.array,c=e.stride;if(void 0!==t.vcount){for(var h=0,p=0,d=s.length;p<d;p++){var f=s[p];if(4===f){var m=h+1*a,v=h+2*a,g=h+3*a;i(h+0*a),i(m),i(g),i(m),i(v),i(g)}else if(3===f){m=h+1*a,v=h+2*a;i(h+0*a),i(m),i(v)}else l=Math.max(l,f);h+=a*f}l>0&&console.log("ColladaLoader: Geometry has faces with more than 4 vertices.")}else for(p=0,d=o.length;p<d;p+=a)i(p)}function H(t){return v(Tt.geometries[t],j)}function W(t){return void 0!==t.build?t.build:t}function X(t){for(var e={sid:t.getAttribute("sid"),name:t.getAttribute("name")||"",attachments:[],transforms:[]},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"attachment_full":e.attachments.push(function(t){for(var e={joint:t.getAttribute("joint").split("/").pop(),transforms:[],links:[]},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"link":e.links.push(X(r));break;case"matrix":case"translate":case"rotate":e.transforms.push(Y(r))}}return e}(r));break;case"matrix":case"translate":case"rotate":e.transforms.push(Y(r))}}return e}function Y(t){var e={type:t.nodeName},n=l(t.textContent);switch(e.type){case"matrix":e.obj=new r,e.obj.fromArray(n).transpose();break;case"translate":e.obj=new i,e.obj.fromArray(n);break;case"rotate":e.obj=new i,e.obj.fromArray(n),e.angle=xo.degToRad(n[3])}return e}function q(t){return void 0!==t.build?t.build:t}function Z(t){for(var e={name:t.getAttribute("name")||"",type:t.getAttribute("type"),id:t.getAttribute("id"),sid:t.getAttribute("sid"),matrix:new r,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}},n=0;n<t.childNodes.length;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"node":e.nodes.push(i.getAttribute("id")),Z(i);break;case"instance_camera":e.instanceCameras.push(c(i.getAttribute("url")));break;case"instance_controller":e.instanceControllers.push(Q(i));break;case"instance_light":e.instanceLights.push(c(i.getAttribute("url")));break;case"instance_geometry":e.instanceGeometries.push(Q(i));break;case"instance_node":e.instanceNodes.push(c(i.getAttribute("url")));break;case"matrix":var o=l(i.textContent);e.matrix.multiply(ft.fromArray(o).transpose()),e.transforms[i.getAttribute("sid")]=i.nodeName;break;case"translate":o=l(i.textContent);mt.fromArray(o),e.matrix.multiply(ft.makeTranslation(mt.x,mt.y,mt.z)),e.transforms[i.getAttribute("sid")]=i.nodeName;break;case"rotate":o=l(i.textContent);var a=xo.degToRad(o[3]);e.matrix.multiply(ft.makeRotationAxis(mt.fromArray(o),a)),e.transforms[i.getAttribute("sid")]=i.nodeName;break;case"scale":o=l(i.textContent);e.matrix.scale(mt.fromArray(o)),e.transforms[i.getAttribute("sid")]=i.nodeName;break;case"extra":break;default:console.log(i)}}return Tt.nodes[e.id]=e,e}function Q(t){for(var e={id:c(t.getAttribute("url")),materials:{},skeletons:[]},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];switch(r.nodeName){case"bind_material":for(var i=r.getElementsByTagName("instance_material"),o=0;o<i.length;o++){var a=i[o],s=a.getAttribute("symbol"),l=a.getAttribute("target");e.materials[s]=c(l)}break;case"skeleton":e.skeletons.push(c(r.textContent))}}return e}function K(t,e){var n,r,i=[],o=[];for(n=0;n<t.length;n++){var a=t[n];if(function(t){return void 0!==Tt.nodes[t]}(a))tt(it(a),e,i);else if(function(t){return void 0!==Tt.visualScenes[t]}(a))for(var s=Tt.visualScenes[a].children,l=0;l<s.length;l++){var u=s[l];if("JOINT"===u.type){tt(it(u.id),e,i)}}else console.error("ColladaLoader: Unable to find root bone of skeleton with ID:",a)}for(n=0;n<e.length;n++)for(l=0;l<i.length;l++)if((r=i[l]).bone.name===e[n].name){o[n]=r,r.processed=!0;break}for(n=0;n<i.length;n++)!1===(r=i[n]).processed&&(o.push(r),r.processed=!0);var c=[],h=[];for(n=0;n<o.length;n++)c.push((r=o[n]).bone),h.push(r.boneInverse);return new Te(c,h)}function tt(t,e,n){t.traverse(function(t){if(!0===t.isBone){for(var i,o=0;o<e.length;o++){var a=e[o];if(a.name===t.name){i=a.boneInverse;break}}void 0===i&&(i=new r),n.push({bone:t,boneInverse:i,processed:!1})}})}function et(t){for(var e=[],n=t.matrix,r=t.nodes,i=t.type,o=t.instanceCameras,a=t.instanceControllers,s=t.instanceLights,l=t.instanceGeometries,u=t.instanceNodes,c=0,h=r.length;c<h;c++)e.push(it(r[c]));for(c=0,h=o.length;c<h;c++){var p=L(o[c]);null!==p&&e.push(p.clone())}for(c=0,h=a.length;c<h;c++)for(var d=w((b=a[c]).id),f=rt(H(d.id),b.materials),m=K(b.skeletons,d.skin.joints),v=0,g=f.length;v<g;v++){(_=f[v]).isSkinnedMesh&&(_.bind(m,d.skin.bindMatrix),_.normalizeSkinWeights()),e.push(_)}for(c=0,h=s.length;c<h;c++){var y=R(s[c]);null!==y&&e.push(y.clone())}for(c=0,h=l.length;c<h;c++){var b;for(v=0,g=(f=rt(H((b=l[c]).id),b.materials)).length;v<g;v++)e.push(f[v])}for(c=0,h=u.length;c<h;c++)e.push(it(u[c]).clone());var _;if(0===r.length&&1===e.length)_=e[0];else{_="JOINT"===i?new V:new Me;for(c=0;c<e.length;c++)_.add(e[c])}return""===_.name&&(_.name="JOINT"===i?t.sid:t.name),_.matrix.copy(n),_.matrix.decompose(_.position,_.quaternion,_.scale),_}function nt(t,e){for(var n=[],r=0,i=t.length;r<i;r++){n.push(P(e[t[r]]))}return n}function rt(t,e){var n=[];for(var r in t){var i=t[r],o=nt(i.materialKeys,e);0===o.length&&o.push("lines"===r||"linestrips"===r?new F:new wt);var a=void 0!==i.data.attributes.skinIndex;if(a)for(var s=0,l=o.length;s<l;s++)o[s].skinning=!0;var u,c=1===o.length?o[0]:o;switch(r){case"lines":u=new je(i.data,c);break;case"linestrips":u=new z(i.data,c);break;case"triangles":case"polylist":u=a?new Ce(i.data,c):new B(i.data,c)}n.push(u)}return n}function it(t){return v(Tt.nodes[t],et)}function at(t){var e=new Me;e.name=t.name;for(var n=t.children,r=0;r<n.length;r++){e.add(it(n[r].id))}return e}function lt(t){return v(Tt.visualScenes[t],at)}var ht=new i,pt=new i,dt=new o,ft=new r,mt=new i;if(console.time("ColladaLoader"),0===t.length)return{scene:new ut};console.time("ColladaLoader: DOMParser");var vt=(new DOMParser).parseFromString(t,"application/xml");console.timeEnd("ColladaLoader: DOMParser");var gt=n(vt,"COLLADA")[0],yt=gt.getAttribute("version");console.log("ColladaLoader: File version",yt);var bt=function(t){return{unit:function(t){return void 0!==t&&!0===t.hasAttribute("meter")?parseFloat(t.getAttribute("meter")):1}(n(t,"unit")[0]),upAxis:function(t){return void 0!==t?t.textContent:"Y_UP"}(n(t,"up_axis")[0])}}(n(gt,"asset")[0]),xt=new Lt(this.manager);xt.setPath(e).setCrossOrigin(this.crossOrigin);var St=[],At={},Mt=0,Tt={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},kinematicsScenes:{}};console.time("ColladaLoader: Parse"),f(gt,"library_animations","animation",function(t){for(var e={sources:{},samplers:{},channels:{}},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType){var o;switch(i.nodeName){case"source":o=i.getAttribute("id"),e.sources[o]=k(i);break;case"sampler":o=i.getAttribute("id"),e.samplers[o]=function(t){for(var e={inputs:{}},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"input":var o=c(i.getAttribute("source")),a=i.getAttribute("semantic");e.inputs[a]=o}}return e}(i);break;case"channel":o=i.getAttribute("target"),e.channels[o]=function(t){var e={},n=t.getAttribute("target").split("/"),r=n.shift(),i=n.shift(),o=-1!==i.indexOf("("),a=-1!==i.indexOf(".");if(a)n=i.split("."),i=n.shift(),e.member=n.shift();else if(o){var s=i.split("(");i=s.shift();for(var l=0;l<s.length;l++)s[l]=parseInt(s[l].replace(/\)/,""));e.indices=s}return e.id=r,e.sid=i,e.arraySyntax=o,e.memberSyntax=a,e.sampler=c(t.getAttribute("source")),e}(i);break;default:console.log(i)}}}Tt.animations[t.getAttribute("id")]=e}),f(gt,"library_animation_clips","animation_clip",function(t){for(var e={name:t.getAttribute("id")||"default",start:parseFloat(t.getAttribute("start")||0),end:parseFloat(t.getAttribute("end")||0),animations:[]},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"instance_animation":e.animations.push(c(i.getAttribute("url")))}}Tt.clips[t.getAttribute("id")]=e}),f(gt,"library_controllers","controller",function(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"skin":e.id=c(i.getAttribute("source")),e.skin=function(t){for(var e={sources:{}},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"bind_shape_matrix":e.bindShapeMatrix=l(i.textContent);break;case"source":var o=i.getAttribute("id");e.sources[o]=k(i);break;case"joints":e.joints=function(t){for(var e={inputs:{}},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"input":var o=i.getAttribute("semantic"),a=c(i.getAttribute("source"));e.inputs[o]=a}}return e}(i);break;case"vertex_weights":e.vertexWeights=function(t){for(var e={inputs:{}},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"input":var o=i.getAttribute("semantic"),a=c(i.getAttribute("source")),s=parseInt(i.getAttribute("offset"));e.inputs[o]={id:a,offset:s};break;case"vcount":e.vcount=u(i.textContent);break;case"v":e.v=u(i.textContent)}}return e}(i)}}return e}(i);break;case"morph":e.id=c(i.getAttribute("source")),console.warn("ColladaLoader: Morph target animation not supported yet.")}}Tt.controllers[t.getAttribute("id")]=e}),f(gt,"library_images","image",function(t){var e={init_from:n(t,"init_from")[0].textContent};Tt.images[t.getAttribute("id")]=e}),f(gt,"library_effects","effect",function(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"profile_COMMON":e.profile=function(t){for(var e={surfaces:{},samplers:{}},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"newparam":!function(t,e){for(var n=t.getAttribute("sid"),r=0,i=t.childNodes.length;r<i;r++){var o=t.childNodes[r];if(1===o.nodeType)switch(o.nodeName){case"surface":e.surfaces[n]=function(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"init_from":e.init_from=i.textContent}}return e}(o);break;case"sampler2D":e.samplers[n]=function(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"source":e.source=i.textContent}}return e}(o)}}}(i,e);break;case"technique":e.technique=function(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"constant":case"lambert":case"blinn":case"phong":e.type=i.nodeName,e.parameters=function(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"emission":case"diffuse":case"specular":case"shininess":case"transparency":e[i.nodeName]=M(i);break;case"transparent":e[i.nodeName]={opaque:i.getAttribute("opaque"),data:M(i)}}}return e}(i)}}return e}(i);break;case"extra":e.extra=function(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"technique":e.technique=function(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"double_sided":e[i.nodeName]=parseInt(i.textContent)}}return e}(i)}}return e}(i)}}return e}(i)}}Tt.effects[t.getAttribute("id")]=e}),f(gt,"library_materials","material",function(t){for(var e={name:t.getAttribute("name")},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"instance_effect":e.url=c(i.getAttribute("url"))}}Tt.materials[t.getAttribute("id")]=e}),f(gt,"library_cameras","camera",function(t){for(var e={name:t.getAttribute("name")},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"optics":e.optics=function(t){for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];switch(n.nodeName){case"technique_common":return function(t){for(var e={},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];switch(r.nodeName){case"perspective":case"orthographic":e.technique=r.nodeName,e.parameters=function(t){for(var e={},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];switch(r.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":e[r.nodeName]=parseFloat(r.textContent)}}return e}(r)}}return e}(n)}}return{}}(i)}}Tt.cameras[t.getAttribute("id")]=e}),f(gt,"library_lights","light",function(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"technique_common":e=function(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"directional":case"point":case"spot":case"ambient":e.technique=i.nodeName,e.parameters=function(t){for(var e={},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"color":var o=l(i.textContent);e.color=(new h).fromArray(o);break;case"falloff_angle":e.falloffAngle=parseFloat(i.textContent);break;case"quadratic_attenuation":var a=parseFloat(i.textContent);e.distance=a?Math.sqrt(1/a):0}}return e}(i)}}return e}(i)}}Tt.lights[t.getAttribute("id")]=e}),f(gt,"library_geometries","geometry",function(t){var e={name:t.getAttribute("name"),sources:{},vertices:{},primitives:[]},r=n(t,"mesh")[0];if(void 0!==r){for(var i=0;i<r.childNodes.length;i++){var o=r.childNodes[i];if(1===o.nodeType){var a=o.getAttribute("id");switch(o.nodeName){case"source":e.sources[a]=k(o);break;case"vertices":e.vertices=function(t){for(var e={},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];1===r.nodeType&&(e[r.getAttribute("semantic")]=c(r.getAttribute("source")))}return e}(o);break;case"polygons":console.warn("ColladaLoader: Unsupported primitive type: ",o.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":e.primitives.push(function(t){for(var e={type:t.nodeName,material:t.getAttribute("material"),count:parseInt(t.getAttribute("count")),inputs:{},stride:0,hasUV:!1},n=0,r=t.childNodes.length;n<r;n++){var i=t.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"input":var o=c(i.getAttribute("source")),a=i.getAttribute("semantic"),s=parseInt(i.getAttribute("offset"));e.inputs[a]={id:o,offset:s},e.stride=Math.max(e.stride,s+1),"TEXCOORD"===a&&(e.hasUV=!0);break;case"vcount":e.vcount=u(i.textContent);break;case"p":e.p=u(i.textContent)}}return e}(o));break;default:console.log(o)}}}Tt.geometries[t.getAttribute("id")]=e}}),f(gt,"library_nodes","node",Z),f(gt,"library_visual_scenes","visual_scene",function(t){var e={name:t.getAttribute("name"),children:[]};!function(t){for(var e=t.getElementsByTagName("node"),n=0;n<e.length;n++){var r=e[n];!1===r.hasAttribute("id")&&r.setAttribute("id",p())}}(t);for(var r=n(t,"node"),i=0;i<r.length;i++)e.children.push(Z(r[i]));Tt.visualScenes[t.getAttribute("id")]=e}),f(gt,"library_kinematics_models","kinematics_model",function(t){for(var e={name:t.getAttribute("name")||"",joints:{},links:[]},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"technique_common":!function(t,e){for(var n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"joint":e.joints[r.getAttribute("sid")]=function(t){for(var e,n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"prismatic":case"revolute":e=function(t,e){for(var e={sid:t.getAttribute("sid"),name:t.getAttribute("name")||"",axis:new i,limits:{min:0,max:0},type:t.nodeName,static:!1,zeroPosition:0,middlePosition:0},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"axis":var o=l(r.textContent);e.axis.fromArray(o);break;case"limits":var a=r.getElementsByTagName("max")[0],s=r.getElementsByTagName("min")[0];e.limits.max=parseFloat(a.textContent),e.limits.min=parseFloat(s.textContent)}}return e.limits.min>=e.limits.max&&(e.static=!0),e.middlePosition=(e.limits.min+e.limits.max)/2,e}(r)}}return e}(r);break;case"link":e.links.push(X(r))}}}(r,e)}}Tt.kinematicsModels[t.getAttribute("id")]=e}),f(gt,"scene","instance_kinematics_scene",function(t){for(var e={bindJointAxis:[]},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"bind_joint_axis":e.bindJointAxis.push(function(t){for(var e={target:t.getAttribute("target").split("/").pop()},n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"axis":var i=r.getElementsByTagName("param")[0];e.axis=i.textContent;var o=e.axis.split("inst_").pop().split("axis")[0];e.jointIndex=o.substr(0,o.length-1)}}return e}(r))}}Tt.kinematicsScenes[c(t.getAttribute("url"))]=e}),console.timeEnd("ColladaLoader: Parse"),console.time("ColladaLoader: Build"),m(Tt.animations,g),m(Tt.clips,b),m(Tt.controllers,x),m(Tt.images,S),m(Tt.effects,C),m(Tt.materials,E),m(Tt.cameras,N),m(Tt.lights,I),m(Tt.geometries,j),m(Tt.visualScenes,at),console.timeEnd("ColladaLoader: Build"),function(){var t=Tt.clips;if(!0===d(t)){if(!1===d(Tt.animations)){var e=[];for(var n in Tt.animations)for(var r=y(n),i=0,o=r.length;i<o;i++)e.push(r[i]);St.push(new ot("default",-1,e))}}else for(var n in t)St.push(_(n))}(),function(){function t(t,e){var n=e.getAttribute("name"),o=a.joints[t];u.traverse(function(a){a.name===n&&(h[t]={object:a,transforms:function(t){for(var e=[],n=gt.querySelector('[id="'+t.id+'"]'),o=0;o<n.childNodes.length;o++){var a=n.childNodes[o];if(1===a.nodeType)switch(a.nodeName){case"matrix":var s=l(a.textContent),u=(new r).fromArray(s).transpose();e.push({sid:a.getAttribute("sid"),type:a.nodeName,obj:u});break;case"translate":case"scale":var s=l(a.textContent),c=(new i).fromArray(s);e.push({sid:a.getAttribute("sid"),type:a.nodeName,obj:c});break;case"rotate":var s=l(a.textContent),c=(new i).fromArray(s),h=xo.degToRad(s[3]);e.push({sid:a.getAttribute("sid"),type:a.nodeName,obj:c,angle:h})}}return e}(e),joint:o,position:o.zeroPosition})})}var e=Object.keys(Tt.kinematicsModels)[0],n=Object.keys(Tt.kinematicsScenes)[0],o=Object.keys(Tt.visualScenes)[0];if(void 0!==e&&void 0!==n){for(var a=function(t){return v(Tt.kinematicsModels[t],W)}(e),s=function(t){return v(Tt.kinematicsScenes[t],q)}(n),u=lt(o),c=s.bindJointAxis,h={},p=0,d=c.length;p<d;p++){var f=c[p],m=gt.querySelector('[sid="'+f.target+'"]');m&&t(f.jointIndex,m.parentElement)}var g=new r;At={joints:a&&a.joints,getJointValue:function(t){var e=h[t];if(e)return e.position;console.warn("ColladaLoader: Joint "+t+" doesn't exist.")},setJointValue:function(t,e){var n=h[t];if(n){var r=n.joint;if(e>r.limits.max||e<r.limits.min)console.warn("ColladaLoader: Joint "+t+" value "+e+" outside of limits (min: "+r.limits.min+", max: "+r.limits.max+").");else if(r.static)console.warn("ColladaLoader: Joint "+t+" is static.");else{var i=n.object,o=r.axis,a=n.transforms;ft.identity();for(var s=0;s<a.length;s++){var l=a[s];if(l.sid&&-1!==l.sid.indexOf(t))switch(r.type){case"revolute":ft.multiply(g.makeRotationAxis(o,xo.degToRad(e)));break;case"prismatic":ft.multiply(g.makeTranslation(o.x*e,o.y*e,o.z*e));break;default:console.warn("ColladaLoader: Unknown joint type: "+r.type)}else switch(l.type){case"matrix":ft.multiply(l.obj);break;case"translate":ft.multiply(g.makeTranslation(l.obj.x,l.obj.y,l.obj.z));break;case"scale":ft.scale(l.obj);break;case"rotate":ft.multiply(g.makeRotationAxis(l.obj,l.angle))}}i.matrix.copy(ft),i.matrix.decompose(i.position,i.quaternion,i.scale),h[t].position=e}}else console.log("ColladaLoader: "+t+" does not exist.")}}}}();var Ct=function(t){return lt(c(n(t,"instance_visual_scene")[0].getAttribute("url")))}(n(gt,"scene")[0]);return"Z_UP"===bt.upAxis&&Ct.quaternion.setFromEuler(new s(-Math.PI/2,0,0)),Ct.scale.multiplyScalar(bt.unit),console.timeEnd("ColladaLoader"),{animations:St,kinematics:At,library:Tt,scene:Ct}}},(Be.prototype=Object.create(ht.prototype)).constructor=Be,Be.prototype.isCompressedTexture=!0,Object.assign(ze.prototype,{load:function(t,e,n,r){function i(i){l.load(t[i],function(t){var n=o._parser(t,!0);a[i]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(u+=1)&&(1===n.mipmapCount&&(s.minFilter=ja),s.format=n.format,s.needsUpdate=!0,e&&e(s))},n,r)}var o=this,a=[],s=new Be;s.image=a;var l=new gt(this.manager);if(l.setPath(this.path),l.setResponseType("arraybuffer"),Array.isArray(t))for(var u=0,c=0,h=t.length;c<h;++c)i(c);else l.load(t,function(t){var n=o._parser(t,!0);if(n.isCubemap)for(var r=n.mipmaps.length/n.mipmapCount,i=0;i<r;i++){a[i]={mipmaps:[]};for(var l=0;l<n.mipmapCount;l++)a[i].mipmaps.push(n.mipmaps[i*n.mipmapCount+l]),a[i].format=n.format,a[i].width=n.width,a[i].height=n.height}else s.image.width=n.width,s.image.height=n.height,s.mipmaps=n.mipmaps;1===n.mipmapCount&&(s.minFilter=ja),s.format=n.format,s.needsUpdate=!0,e&&e(s)},n,r);return s},setPath:function(t){return this.path=t,this}});var su=function(){this._parser=su.parse};su.prototype=Object.create(ze.prototype),su.prototype.constructor=su,su.parse=function(t,e){function n(t){return t.charCodeAt(0)+(t.charCodeAt(1)<<8)+(t.charCodeAt(2)<<16)+(t.charCodeAt(3)<<24)}function r(t,e,n,r){for(var i=n*r*4,o=new Uint8Array(t,e,i),a=new Uint8Array(i),s=0,l=0,u=0;u<r;u++)for(var c=0;c<n;c++){var h=o[l],p=o[++l],d=o[++l],f=o[++l];l++,a[s]=d,a[++s]=p,a[++s]=h,a[++s]=f,s++}return a}var i={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},o=n("DXT1"),a=n("DXT3"),s=n("DXT5"),l=n("ETC1"),u=new Int32Array(t,0,31);if(542327876!==u[0])return console.error("DDSLoader.parse: Invalid magic number in DDS header."),i;if(4&!u[20])return console.error("DDSLoader.parse: Unsupported format, must contain a FourCC code."),i;var c,h=u[21],p=!1;switch(h){case o:c=8,i.format=ls;break;case a:c=16,i.format=cs;break;case s:c=16,i.format=hs;break;case l:c=8,i.format=vs;break;default:if(!(32===u[22]&&16711680&u[23]&&65280&u[24]&&255&u[25]&&4278190080&u[26]))return console.error("DDSLoader.parse: Unsupported FourCC code ",function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)}(h)),i;p=!0,c=64,i.format=ns}i.mipmapCount=1,131072&u[2]&&!1!==e&&(i.mipmapCount=Math.max(1,u[7]));var d=u[28];if(i.isCubemap=!!(512&d),i.isCubemap&&(!(1024&d)||!(2048&d)||!(4096&d)||!(8192&d)||!(16384&d)||!(32768&d)))return console.error("DDSLoader.parse: Incomplete cubemap faces"),i;i.width=u[4],i.height=u[3];for(var f=u[1]+4,m=i.isCubemap?6:1,v=0;v<m;v++)for(var g=i.width,y=i.height,b=0;b<i.mipmapCount;b++){if(p)var _=(x=r(t,f,g,y)).length;else{_=Math.max(4,g)/4*Math.max(4,y)/4*c;var x=new Uint8Array(t,f,_)}i.mipmaps.push({data:x,width:g,height:y}),f+=_,g=Math.max(g>>1,1),y=Math.max(y>>1,1)}return i},Ve.prototype=Object.assign(Object.create(z.prototype),{constructor:Ve,isLineLoop:!0});!function(){function t(t){this.manager=void 0!==t?t:il}function e(t,e){var n={},i=t.material.uniforms;for(var o in i){var a=i[o];if(a.semantic){var s=a.node,l=t;s&&(l=e[s]),n[o]={semantic:a.semantic,sourceNode:l,targetNode:t,uniform:a}}}this.boundUniforms=n,this._m4=new r}function n(t){this.name=d.KHR_BINARY_GLTF;var e=new DataView(t,0,v),n={magic:al.decodeText(new Uint8Array(t.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0),contentLength:e.getUint32(12,!0),contentFormat:e.getUint32(16,!0)};for(var r in f){var i=f[r];if(n[r]!==i)throw new Error('Unsupported glTF-Binary header: Expected "%s" to be "%s".',r,i)}var o=new Uint8Array(t,v,n.contentLength);this.header=n,this.content=al.decodeText(o),this.body=t.slice(v+n.contentLength,n.length)}function o(t,e,n){if(!t)return Promise.resolve();var r,i=[];if("[object Array]"===Object.prototype.toString.call(t)){r=[];for(var o=t.length,a=0;a<o;a++){(l=e.call(n||this,t[a],a))&&(i.push(l),l instanceof Promise?l.then(function(t,e){r[t]=e}.bind(this,a)):r[a]=l)}}else{r={};for(var s in t)if(t.hasOwnProperty(s)){var l;(l=e.call(n||this,t[s],s))&&(i.push(l),l instanceof Promise?l.then(function(t,e){r[t]=e}.bind(this,s)):r[s]=l)}}return Promise.all(i).then(function(){return r})}function a(t,e){return"string"!=typeof t||""===t?"":/^(https?:)?\/\//i.test(t)?t:/^data:.*,.*$/i.test(t)?t:(e||"")+t}function s(){return new wt({color:0,emissive:8947848,specular:0,shininess:0,transparent:!1,depthTest:!0,side:Fo})}function l(t){this.isDeferredShaderMaterial=!0,this.params=t}function p(t,e,n){this.json=t||{},this.extensions=e||{},this.options=n||{},this.cache=new function(){var t={};return{get:function(e){return t[e]},add:function(e,n){t[e]=n},remove:function(e){delete t[e]},removeAll:function(){t={}},update:function(e,n){for(var r in t){var i=t[r];i.update&&i.update(e,n)}}}}}t.prototype={constructor:t,crossOrigin:"Anonymous",load:function(t,e,n,r){var i=this,o=this.path&&"string"==typeof this.path?this.path:al.extractUrlBase(t),a=new gt(i.manager);a.setResponseType("arraybuffer"),a.load(t,function(t){i.parse(t,o,e)},n,r)},setCrossOrigin:function(t){this.crossOrigin=t},setPath:function(t){this.path=t},parse:function(t,e,r){var i,o={};al.decodeText(new Uint8Array(t,0,4))===f.magic?(o[d.KHR_BINARY_GLTF]=new n(t),i=o[d.KHR_BINARY_GLTF].content):i=al.decodeText(new Uint8Array(t));var a=JSON.parse(i);a.extensionsUsed&&a.extensionsUsed.indexOf(d.KHR_MATERIALS_COMMON)>=0&&(o[d.KHR_MATERIALS_COMMON]=new function(t){this.name=d.KHR_MATERIALS_COMMON,this.lights={};var e=(t.extensions&&t.extensions[d.KHR_MATERIALS_COMMON]||{}).lights||{};for(var n in e){var r,i=e[n],o=i[i.type],a=(new h).fromArray(o.color);switch(i.type){case"directional":(r=new De(a)).position.set(0,0,1);break;case"point":r=new Le(a);break;case"spot":(r=new Re(a)).position.set(0,0,1);break;case"ambient":r=new Ue(a)}r&&(this.lights[n]=r)}}(a)),console.time("LegacyGLTFLoader");new p(a,o,{path:e||this.path,crossOrigin:this.crossOrigin}).parse(function(t,e,n,i){console.timeEnd("LegacyGLTFLoader");r({scene:t,scenes:e,cameras:n,animations:i})})}},t.Shaders={update:function(){console.warn("LegacyGLTFLoader.Shaders has been deprecated, and now updates automatically.")}},e.prototype.update=function(t,e){var n=this.boundUniforms;for(var r in n){var i=n[r];switch(i.semantic){case"MODELVIEW":i.uniform.value.multiplyMatrices(e.matrixWorldInverse,i.sourceNode.matrixWorld);break;case"MODELVIEWINVERSETRANSPOSE":var o=i.uniform.value;this._m4.multiplyMatrices(e.matrixWorldInverse,i.sourceNode.matrixWorld),o.getNormalMatrix(this._m4);break;case"PROJECTION":i.uniform.value.copy(e.projectionMatrix);break;case"JOINTMATRIX":for(var a=i.uniform.value,s=0;s<a.length;s++)a[s].getInverse(i.sourceNode.matrixWorld).multiply(i.targetNode.skeleton.bones[s].matrixWorld).multiply(i.targetNode.skeleton.boneInverses[s]).multiply(i.targetNode.bindMatrix);break;default:console.warn("Unhandled shader semantic: "+i.semantic)}}},t.Animations={update:function(){console.warn("LegacyGLTFLoader.Animation has been deprecated. Use AnimationMixer instead.")}};var d={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_MATERIALS_COMMON:"KHR_materials_common"},f={magic:"glTF",version:1,contentFormat:0},v=20;n.prototype.loadShader=function(t,e){var n=e[t.extensions[d.KHR_BINARY_GLTF].bufferView],r=new Uint8Array(n);return al.decodeText(r)};var b={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,TRIANGLES:4,LINES:1,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,VERTEX_SHADER:35633,FRAGMENT_SHADER:35632},_={5126:Number,35675:u,35676:r,35664:m,35665:i,35666:g,35678:ht},x={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},w={9728:Ra,9729:ja,9984:ka,9985:Ba,9986:Ua,9987:za},S={33071:Da,33648:Fa,10497:Ia},A={6406:ts,6407:es,6408:ns,6409:rs,6410:is},M={5121:Va,32819:Qa,32820:Ja,33635:Ka},T={1028:Ro,1029:Fo},C={512:ua,513:ha,514:da,515:pa,516:fa,517:va,518:fa,519:ca},E={32774:Yo,32778:qo,32779:Zo},P={0:Ko,1:$o,768:ta,769:ea,770:na,771:ra,772:ia,773:oa,774:aa,775:sa,776:la},N={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},L={scale:"scale",translation:"position",rotation:"quaternion"},I={LINEAR:2301,STEP:Ls},F={2884:"CULL_FACE",2929:"DEPTH_TEST",3042:"BLEND",3089:"SCISSOR_TEST",32823:"POLYGON_OFFSET_FILL",32926:"SAMPLE_ALPHA_TO_COVERAGE"};l.prototype.create=function(){var t=tl.clone(this.params.uniforms);for(var e in this.params.uniforms){var n=this.params.uniforms[e];n.value instanceof ht&&(t[e].value=n.value,t[e].value.needsUpdate=!0),t[e].semantic=n.semantic,t[e].node=n.node}return this.params.uniforms=t,new Ct(this.params)},p.prototype._withDependencies=function(t){for(var e={},n=0;n<t.length;n++){var r=t[n],i="load"+r.charAt(0).toUpperCase()+r.slice(1),a=this.cache.get(r);if(void 0!==a)e[r]=a;else if(this[i]){var s=this[i]();this.cache.add(r,s),e[r]=s}}return o(e,function(t){return t})},p.prototype.parse=function(t){var e=this.json;this.cache.removeAll(),this._withDependencies(["scenes","cameras","animations"]).then(function(n){var r=[];for(var i in n.scenes)r.push(n.scenes[i]);var o=void 0!==e.scene?n.scenes[e.scene]:r[0],a=[];for(var i in n.cameras){a.push(n.cameras[i])}var s=[];for(var i in n.animations)s.push(n.animations[i]);t(o,r,a,s)})},p.prototype.loadShaders=function(){var t=this.json,e=this.extensions,n=this.options;return this._withDependencies(["bufferViews"]).then(function(r){return o(t.shaders,function(t){return t.extensions&&t.extensions[d.KHR_BINARY_GLTF]?e[d.KHR_BINARY_GLTF].loadShader(t,r.bufferViews):new Promise(function(e){var r=new gt;r.setResponseType("text"),r.load(a(t.uri,n.path),function(t){e(t)})})})})},p.prototype.loadBuffers=function(){var t=this.extensions,e=this.options;return o(this.json.buffers,function(n,r){return"binary_glTF"===r?t[d.KHR_BINARY_GLTF].body:"arraybuffer"===n.type||void 0===n.type?new Promise(function(t){var r=new gt;r.setResponseType("arraybuffer"),r.load(a(n.uri,e.path),function(e){t(e)})}):void console.warn("LegacyGLTFLoader: "+n.type+" buffer type is not supported")})},p.prototype.loadBufferViews=function(){var t=this.json;return this._withDependencies(["buffers"]).then(function(e){return o(t.bufferViews,function(t){return e.buffers[t.buffer].slice(t.byteOffset,t.byteOffset+(void 0!==t.byteLength?t.byteLength:0))})})},p.prototype.loadAccessors=function(){var t=this.json;return this._withDependencies(["bufferViews"]).then(function(e){return o(t.accessors,function(t){var n=e.bufferViews[t.bufferView],r=N[t.type],i=x[t.componentType],o=i.BYTES_PER_ELEMENT;if(t.byteStride&&t.byteStride!==o*r){var a=new i(n);return new Se(new xe(a,t.byteStride/o),r,t.byteOffset/o)}return a=new i(n,t.byteOffset,t.count*r),new y(a,r)})})},p.prototype.loadTextures=function(){var t=this.json,e=this.options;return this._withDependencies(["bufferViews"]).then(function(n){return o(t.textures,function(r){if(r.source)return new Promise(function(i){var o=t.images[r.source],s=o.uri,l=!1;if(o.extensions&&o.extensions[d.KHR_BINARY_GLTF]){var u=o.extensions[d.KHR_BINARY_GLTF],c=n.bufferViews[u.bufferView],h=new Blob([c],{type:u.mimeType});s=URL.createObjectURL(h),l=!0}var p=It.Handlers.get(s);null===p&&(p=new Lt),p.setCrossOrigin(e.crossOrigin),p.load(a(s,e.path),function(e){if(l&&URL.revokeObjectURL(s),e.flipY=!1,void 0!==r.name&&(e.name=r.name),e.format=void 0!==r.format?A[r.format]:ns,void 0!==r.internalFormat&&e.format!==A[r.internalFormat]&&console.warn("LegacyGLTFLoader: Three.js doesn't support texture internalFormat which is different from texture format. internalFormat will be forced to be the same value as format."),e.type=void 0!==r.type?M[r.type]:Va,r.sampler){var n=t.samplers[r.sampler];e.magFilter=w[n.magFilter]||ja,e.minFilter=w[n.minFilter]||Ua,e.wrapS=S[n.wrapS]||Ia,e.wrapT=S[n.wrapT]||Ia}i(e)},void 0,function(){l&&URL.revokeObjectURL(s),i()})})})})},p.prototype.loadMaterials=function(){var t=this.json;return this._withDependencies(["shaders","textures"]).then(function(e){return o(t.materials,function(n){var r,i,o={},a={};if(n.extensions&&n.extensions[d.KHR_MATERIALS_COMMON]&&(i=n.extensions[d.KHR_MATERIALS_COMMON]),i){var s=["ambient","emission","transparent","transparency","doubleSided"];switch(i.technique){case"BLINN":case"PHONG":r=wt,s.push("diffuse","specular","shininess");break;case"LAMBERT":r=_t,s.push("diffuse");break;case"CONSTANT":default:r=D}s.forEach(function(t){void 0!==i.values[t]&&(o[t]=i.values[t])}),(i.doubleSided||o.doubleSided)&&(a.side=ko),(i.transparent||o.transparent)&&(a.transparent=!0,a.opacity=void 0!==o.transparency?o.transparency:1)}else if(void 0===n.technique)r=wt,Object.assign(o,n.values);else{r=l;var u=t.techniques[n.technique];a.uniforms={};var c=t.programs[u.program];if(c){a.fragmentShader=e.shaders[c.fragmentShader],a.fragmentShader||(console.warn("ERROR: Missing fragment shader definition:",c.fragmentShader),r=wt);var p=e.shaders[c.vertexShader];p||(console.warn("ERROR: Missing vertex shader definition:",c.vertexShader),r=wt),a.vertexShader=function(t,e){var n={};for(var r in e.attributes)n[r]={type:(u=e.parameters[l=e.attributes[r]]).type,semantic:c=u.semantic};var i=e.parameters,o=e.attributes,a={};for(var r in n){var s=i[l=o[r]];(c=s.semantic)&&(a[r]=s)}for(var l in a){var u,c=(u=a[l]).semantic,h=new RegExp("\\b"+l+"\\b","g");switch(c){case"POSITION":t=t.replace(h,"position");break;case"NORMAL":t=t.replace(h,"normal");break;case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":t=t.replace(h,"uv");break;case"TEXCOORD_1":t=t.replace(h,"uv2");break;case"COLOR_0":case"COLOR0":case"COLOR":t=t.replace(h,"color");break;case"WEIGHT":t=t.replace(h,"skinWeight");break;case"JOINT":t=t.replace(h,"skinIndex")}}return t}(p,u);var f=u.uniforms;for(var m in f){var v=f[m],g=u.parameters[v],y=g.type;if(!_[y])throw new Error("Unknown shader uniform param type: "+y);var x,w=g.count;void 0!==n.values&&(x=n.values[v]);var S=new _[y],A=g.semantic,M=g.node;switch(y){case b.FLOAT:S=g.value,"transparency"==v&&(a.transparent=!0),void 0!==x&&(S=x);break;case b.FLOAT_VEC2:case b.FLOAT_VEC3:case b.FLOAT_VEC4:case b.FLOAT_MAT3:g&&g.value&&S.fromArray(g.value),x&&S.fromArray(x);break;case b.FLOAT_MAT2:console.warn("FLOAT_MAT2 is not a supported uniform type");break;case b.FLOAT_MAT4:if(w){S=new Array(w);for(var O=0;O<w;O++)S[O]=new _[y];if(g&&g.value){S.fromArray(g.value)}x&&S.fromArray(x)}else{if(g&&g.value){S.fromArray(g.value)}x&&S.fromArray(x)}break;case b.SAMPLER_2D:S=void 0!==x?e.textures[x]:void 0!==g.value?e.textures[g.value]:null}a.uniforms[m]={value:S,semantic:A,node:M}}for(var N=u.states||{},L=N.enable||[],I=N.functions||{},R=!1,k=!1,U=!1,j=0,B=L.length;j<B;j++){var z=L[j];switch(F[z]){case"CULL_FACE":R=!0;break;case"DEPTH_TEST":k=!0;break;case"BLEND":U=!0;break;case"SCISSOR_TEST":case"POLYGON_OFFSET_FILL":case"SAMPLE_ALPHA_TO_COVERAGE":break;default:throw new Error("Unknown technique.states.enable: "+z)}}a.side=R?void 0!==I.cullFace?T[I.cullFace]:Fo:ko,a.depthTest=k,a.depthFunc=void 0!==I.depthFunc?C[I.depthFunc]:ha,a.depthWrite=void 0===I.depthMask||I.depthMask[0],a.blending=U?Xo:zo,a.transparent=U;var V=I.blendEquationSeparate;void 0!==V?(a.blendEquation=E[V[0]],a.blendEquationAlpha=E[V[1]]):(a.blendEquation=Yo,a.blendEquationAlpha=Yo);var G=I.blendFuncSeparate;void 0!==G?(a.blendSrc=P[G[0]],a.blendDst=P[G[1]],a.blendSrcAlpha=P[G[2]],a.blendDstAlpha=P[G[3]]):(a.blendSrc=$o,a.blendDst=Ko,a.blendSrcAlpha=$o,a.blendDstAlpha=Ko)}}Array.isArray(o.diffuse)?a.color=(new h).fromArray(o.diffuse):"string"==typeof o.diffuse&&(a.map=e.textures[o.diffuse]),delete a.diffuse,"string"==typeof o.reflective&&(a.envMap=e.textures[o.reflective]),"string"==typeof o.bump&&(a.bumpMap=e.textures[o.bump]),Array.isArray(o.emission)?r===D?a.color=(new h).fromArray(o.emission):a.emissive=(new h).fromArray(o.emission):"string"==typeof o.emission&&(r===D?a.map=e.textures[o.emission]:a.emissiveMap=e.textures[o.emission]),Array.isArray(o.specular)?a.specular=(new h).fromArray(o.specular):"string"==typeof o.specular&&(a.specularMap=e.textures[o.specular]),void 0!==o.shininess&&(a.shininess=o.shininess);var H=new r(a);return void 0!==n.name&&(H.name=n.name),H})})},p.prototype.loadMeshes=function(){var t=this.json;return this._withDependencies(["accessors","materials"]).then(function(e){return o(t.meshes,function(n){var r=new Me;void 0!==n.name&&(r.name=n.name),n.extras&&(r.userData=n.extras);var i=n.primitives||[];for(var o in i){var a=i[o];if(a.mode===b.TRIANGLES||void 0===a.mode){var l=new O,u=a.attributes;for(var c in u){if(!(f=u[c]))return;var h=e.accessors[f];switch(c){case"POSITION":l.addAttribute("position",h);break;case"NORMAL":l.addAttribute("normal",h);break;case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":l.addAttribute("uv",h);break;case"TEXCOORD_1":l.addAttribute("uv2",h);break;case"COLOR_0":case"COLOR0":case"COLOR":l.addAttribute("color",h);break;case"WEIGHT":l.addAttribute("skinWeight",h);break;case"JOINT":l.addAttribute("skinIndex",h);break;default:if(!a.material)break;if(!(v=t.materials[a.material]).technique)break;var p=t.techniques[v.technique].parameters||{};for(var d in p)p[d].semantic===c&&l.addAttribute(d,h)}}a.indices&&l.setIndex(e.accessors[a.indices]);(m=new B(l,v=void 0!==e.materials?e.materials[a.material]:s())).castShadow=!0,m.name="0"===o?r.name:r.name+o,a.extras&&(m.userData=a.extras),r.add(m)}else if(a.mode===b.LINES){l=new O,u=a.attributes;for(var c in u){var f;if(!(f=u[c]))return;h=e.accessors[f];switch(c){case"POSITION":l.addAttribute("position",h);break;case"COLOR_0":case"COLOR0":case"COLOR":l.addAttribute("color",h)}}var m,v=e.materials[a.material];a.indices?(l.setIndex(e.accessors[a.indices]),m=new je(l,v)):m=new z(l,v),m.name="0"===o?r.name:r.name+o,a.extras&&(m.userData=a.extras),r.add(m)}else console.warn("Only triangular and line primitives are supported")}return r})})},p.prototype.loadCameras=function(){return o(this.json.cameras,function(t){if("perspective"==t.type&&t.perspective){var e=void 0!==t.perspective.aspectRatio?t.perspective.aspectRatio:1,n=new st(xo.radToDeg(t.perspective.yfov*e),e,t.perspective.znear||1,t.perspective.zfar||2e6);return void 0!==t.name&&(n.name=t.name),t.extras&&(n.userData=t.extras),n}if("orthographic"==t.type&&t.orthographic){n=new ct(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,t.orthographic.znear,t.orthographic.zfar);return void 0!==t.name&&(n.name=t.name),t.extras&&(n.userData=t.extras),n}})},p.prototype.loadSkins=function(){var t=this.json;return this._withDependencies(["accessors"]).then(function(e){return o(t.skins,function(t){var n=new r;void 0!==t.bindShapeMatrix&&n.fromArray(t.bindShapeMatrix);return{bindShapeMatrix:n,jointNames:t.jointNames,inverseBindMatrices:e.accessors[t.inverseBindMatrices]}})})},p.prototype.loadAnimations=function(){var t=this.json;return this._withDependencies(["accessors","nodes"]).then(function(e){return o(t.animations,function(t,n){var r=[];for(var i in t.channels){var o=t.channels[i],a=t.samplers[o.sampler];if(a){var s=o.target,l=s.id,u=e.accessors[void 0!==t.parameters?t.parameters[a.input]:a.input],c=e.accessors[void 0!==t.parameters?t.parameters[a.output]:a.output],h=e.nodes[l];if(h){h.updateMatrix(),h.matrixAutoUpdate=!0;var p=void 0!==a.interpolation?I[a.interpolation]:2301;r.push(new(L[s.path]===L.rotation?J:$)((h.name?h.name:h.uuid)+"."+L[s.path],Js.arraySlice(u.array,0),Js.arraySlice(c.array,0),p))}}}return new ot(l=void 0!==t.name?t.name:"animation_"+n,void 0,r)})})},p.prototype.loadNodes=function(){var t=this.json,e=this.extensions,n=this;return o(t.nodes,function(t){var e,n=new r;return t.jointName?((e=new V).name=void 0!==t.name?t.name:t.jointName,e.jointName=t.jointName):(e=new c,void 0!==t.name&&(e.name=t.name)),t.extras&&(e.userData=t.extras),void 0!==t.matrix?(n.fromArray(t.matrix),e.applyMatrix(n)):(void 0!==t.translation&&e.position.fromArray(t.translation),void 0!==t.rotation&&e.quaternion.fromArray(t.rotation),void 0!==t.scale&&e.scale.fromArray(t.scale)),e}).then(function(i){return n._withDependencies(["meshes","skins","cameras"]).then(function(n){return o(i,function(o,a){var s=t.nodes[a];if(void 0!==s.meshes)for(var l in s.meshes){var u=s.meshes[l],c=n.meshes[u];if(void 0!==c)for(var h in c.children){var p=c.children[h],f=p.material,m=p.geometry,v=p.userData,g=p.name;switch(f.isDeferredShaderMaterial?f=b=f.create():b=f,p.type){case"LineSegments":p=new je(m,b);break;case"LineLoop":p=new Ve(m,b);break;case"Line":p=new z(m,b);break;default:p=new B(m,b)}p.castShadow=!0,p.userData=v,p.name=g;var y;if(s.skin&&(y=n.skins[s.skin]),y){var b,_=function(t){for(var e=Object.keys(i),n=0,r=e.length;n<r;n++){var o=i[e[n]];if(o.jointName===t)return o}return null},x=m;(b=f).skinning=!0,(p=new Ce(x,b)).castShadow=!0,p.userData=v,p.name=g;for(var w=[],S=[],A=0,M=y.jointNames.length;A<M;A++){var T=y.jointNames[A],C=_(T);if(C){w.push(C);var E=y.inverseBindMatrices.array,P=(new r).fromArray(E,16*A);S.push(P)}else console.warn("WARNING: joint: '"+T+"' could not be found")}p.bind(new Te(w,S),y.bindShapeMatrix);var O=function(e,n,r){var o=e[r];if(void 0!==o)for(var a=0,s=o.length;a<s;a++){var l=o[a],u=i[l],c=t.nodes[l];void 0!==u&&!0===u.isBone&&void 0!==c&&(n.add(u),O(c,u,"children"))}};O(s,p,"skeletons")}o.add(p)}else console.warn("LegacyGLTFLoader: Couldn't find node \""+u+'".')}if(void 0!==s.camera){o.add(n.cameras[s.camera])}if(s.extensions&&s.extensions[d.KHR_MATERIALS_COMMON]&&s.extensions[d.KHR_MATERIALS_COMMON].light){o.add(e[d.KHR_MATERIALS_COMMON].lights[s.extensions[d.KHR_MATERIALS_COMMON].light])}return o})})})},p.prototype.loadScenes=function(){function t(e,r,i){var o=i[e];r.add(o);var a=n.nodes[e];if(a.children)for(var s=a.children,l=0,u=s.length;l<u;l++){t(s[l],o,i)}}var n=this.json;return this._withDependencies(["nodes"]).then(function(r){return o(n.scenes,function(n){var i=new ut;void 0!==n.name&&(i.name=n.name),n.extras&&(i.userData=n.extras);for(var o=n.nodes||[],a=0,s=o.length;a<s;a++){t(o[a],i,r.nodes)}return i.traverse(function(t){t.material&&t.material.isRawShaderMaterial&&(t.gltfShader=new e(t,r.nodes),t.onBeforeRender=function(t,e,n){this.gltfShader.update(e,n)})}),i})})}}();var lu=function(t){this.timeLoaded=0,this.manager=t||il,this.materials=null,this.verbosity=0,this.attributeOptions={},this.drawMode=Ds,this.nativeAttributeMap={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"}};lu.prototype={constructor:lu,load:function(t,e,n,r){var i=this,o=new gt(i.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),o.load(t,function(t){i.decodeDracoFile(t,e)},n,r)},setPath:function(t){this.path=t},setCrossOrigin:function(t){this.crossOrigin=t},setVerbosity:function(t){this.verbosity=t},setDrawMode:function(t){this.drawMode=t},setSkipDequantization:function(t,e){var n=!0;void 0!==e&&(n=e),this.getAttributeOptions(t).skipDequantization=n},decodeDracoFile:function(t,e,n){var r=this;lu.getDecoderModule().then(function(i){r.decodeDracoFileInternal(t,i.decoder,e,n||{})})},decodeDracoFileInternal:function(t,e,n,r){var i=new e.DecoderBuffer;i.Init(new Int8Array(t),t.byteLength);var o=new e.Decoder,a=o.GetEncodedGeometryType(i);if(a==e.TRIANGULAR_MESH)this.verbosity>0&&console.log("Loaded a mesh.");else{if(a!=e.POINT_CLOUD){var s="DRACOLoader: Unknown geometry type.";throw console.error(s),new Error(s)}this.verbosity>0&&console.log("Loaded a point cloud.")}n(this.convertDracoGeometryTo3JS(e,o,a,i,r))},addAttributeToGeometry:function(t,e,n,r,i,o,a){if(0===i.ptr){var s="DRACOLoader: No attribute "+r;throw console.error(s),new Error(s)}var l=i.num_components(),u=new t.DracoFloat32Array;e.GetAttributeFloatForAllPoints(n,i,u);var c=n.num_points()*l;a[r]=new Float32Array(c);for(var h=0;h<c;h++)a[r][h]=u.GetValue(h);o.addAttribute(r,new T(a[r],l)),t.destroy(u)},convertDracoGeometryTo3JS:function(t,e,n,r,i){!0===this.getAttributeOptions("position").skipDequantization&&e.SkipAttributeTransform(t.POSITION);var o,a,s=performance.now();if(n===t.TRIANGULAR_MESH?(o=new t.Mesh,a=e.DecodeBufferToMesh(r,o)):(o=new t.PointCloud,a=e.DecodeBufferToPointCloud(r,o)),!a.ok()||0==o.ptr){var l="DRACOLoader: Decoding failed: ";throw l+=a.error_msg(),console.error(l),t.destroy(e),t.destroy(o),new Error(l)}var u=performance.now();t.destroy(r);var c;n==t.TRIANGULAR_MESH?(c=o.num_faces(),this.verbosity>0&&console.log("Number of faces loaded: "+c.toString())):c=0;var h=o.num_points(),p=o.num_attributes();this.verbosity>0&&(console.log("Number of points loaded: "+h.toString()),console.log("Number of attributes loaded: "+p.toString()));var d=e.GetAttributeId(o,t.POSITION);if(-1==d){l="DRACOLoader: No position attribute found.";throw console.error(l),t.destroy(e),t.destroy(o),new Error(l)}var f=e.GetAttribute(o,d),m={},v=new O;for(var g in this.nativeAttributeMap)if(void 0===i[g]){var y=e.GetAttributeId(o,t[this.nativeAttributeMap[g]]);if(-1!==y){this.verbosity>0&&console.log("Loaded "+g+" attribute.");var b=e.GetAttribute(o,y);this.addAttributeToGeometry(t,e,o,g,b,v,m)}}for(var g in i){b=e.GetAttributeByUniqueId(o,i[g]);this.addAttributeToGeometry(t,e,o,g,b,v,m)}if(n==t.TRIANGULAR_MESH)if(this.drawMode===Fs){var _=new t.DracoInt32Array;e.GetTriangleStripsFromMesh(o,_);m.indices=new Uint32Array(_.size());for(var x=0;x<_.size();++x)m.indices[x]=_.GetValue(x);t.destroy(_)}else{var w=3*c;m.indices=new Uint32Array(w);var A=new t.DracoInt32Array;for(x=0;x<c;++x){e.GetFaceFromMesh(o,x,A);var T=3*x;m.indices[T]=A.GetValue(0),m.indices[T+1]=A.GetValue(1),m.indices[T+2]=A.GetValue(2)}t.destroy(A)}v.drawMode=this.drawMode,n==t.TRIANGULAR_MESH&&v.setIndex(new(m.indices.length>65535?M:S)(m.indices,1));var C=new t.AttributeQuantizationTransform;if(C.InitFromAttribute(f)){v.attributes.position.isQuantized=!0,v.attributes.position.maxRange=C.range(),v.attributes.position.numQuantizationBits=C.quantization_bits(),v.attributes.position.minValues=new Float32Array(3);for(x=0;x<3;++x)v.attributes.position.minValues[x]=C.min_value(x)}return t.destroy(C),t.destroy(e),t.destroy(o),this.decode_time=u-s,this.import_time=performance.now()-u,this.verbosity>0&&(console.log("Decode time: "+this.decode_time),console.log("Import time: "+this.import_time)),v},isVersionSupported:function(t,e){lu.getDecoderModule().then(function(n){e(n.decoder.isVersionSupported(t))})},getAttributeOptions:function(t){return void 0===this.attributeOptions[t]&&(this.attributeOptions[t]={}),this.attributeOptions[t]}},lu.decoderPath="./",lu.decoderConfig={},lu.decoderModulePromise=null,lu.setDecoderPath=function(t){lu.decoderPath=t},lu.setDecoderConfig=function(t){var e=lu.decoderConfig.wasmBinary;lu.decoderConfig=t||{},lu.releaseDecoderModule(),e&&(lu.decoderConfig.wasmBinary=e)},lu.releaseDecoderModule=function(){lu.decoderModulePromise=null},lu.getDecoderModule=function(){var t=this,e=lu.decoderPath,n=lu.decoderConfig,r=lu.decoderModulePromise;return r||("undefined"!=typeof DracoDecoderModule?r=Promise.resolve():"object"!=typeof WebAssembly||"js"===n.type?r=lu._loadScript(e+"draco_decoder.js"):(n.wasmBinaryFile=e+"draco_decoder.wasm",r=lu._loadScript(e+"draco_wasm_wrapper.js").then(function(){return lu._loadArrayBuffer(n.wasmBinaryFile)}).then(function(t){n.wasmBinary=t})),r=r.then(function(){return new Promise(function(e){n.onModuleLoaded=function(n){t.timeLoaded=performance.now(),e({decoder:n})},DracoDecoderModule(n)})}),lu.decoderModulePromise=r,r)},lu._loadScript=function(t){var e=document.getElementById("decoder_script");null!==e&&e.parentNode.removeChild(e);var n=document.getElementsByTagName("head")[0],r=document.createElement("script");return r.id="decoder_script",r.type="text/javascript",r.src=t,new Promise(function(t){r.onload=t,n.appendChild(r)})},lu._loadArrayBuffer=function(t){var e=new gt;return e.setResponseType("arraybuffer"),new Promise(function(n,r){e.load(t,n,void 0,r)})},Object.assign(Ge.prototype,{load:function(t,e,n,r){var i=this,o=new ye,a=new gt(this.manager);return a.setResponseType("arraybuffer"),a.load(t,function(t){var n=i._parser(t);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:Da,o.wrapT=void 0!==n.wrapT?n.wrapT:Da,o.magFilter=void 0!==n.magFilter?n.magFilter:ja,o.minFilter=void 0!==n.minFilter?n.minFilter:za,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps),1===n.mipmapCount&&(o.minFilter=ja),o.needsUpdate=!0,e&&e(o,n))},n,r),o}});var uu=function(t){this.manager=void 0!==t?t:il};(uu.prototype=Object.create(Ge.prototype))._parser=function(t){function e(t,e,n,r,i){for(;n<t;)e=e<<8|m(r,i),n+=8;R.l=e>>(n-=t)&(1<<t)-1,R.c=e,R.lc=n}function n(t,n,r,i,o,a,s){for(var l=r,u=0,c=0;o<=a;o++){if(l.value-r.value>i)return!1;e(6,u,c,t,l);var h=R.l;if(u=R.c,c=R.lc,s[o]=h,h==P){if(l.value-r.value>i)throw"Something wrong with hufUnpackEncTable";e(8,u,c,t,l);if(u=R.c,c=R.lc,o+(p=R.l+O)>a+1)throw"Something wrong with hufUnpackEncTable";for(;p--;)s[o++]=0;o--}else if(h>=E){var p;if(o+(p=h-E+2)>a+1)throw"Something wrong with hufUnpackEncTable";for(;p--;)s[o++]=0;o--}}!function(t){for(var e=0;e<=58;++e)k[e]=0;for(e=0;e<M;++e)k[t[e]]+=1;var n=0;for(e=58;e>0;--e){var r=n+k[e]>>1;k[e]=n,n=r}for(e=0;e<M;++e){var i=t[e];i>0&&(t[e]=i|k[i]++<<6)}}(s)}function r(t){return 63&t}function i(t){return t>>6}function o(t,e,n,r){t=t<<8|m(n,r),e+=8,U.c=t,U.lc=e}function a(t,e,n,r,i,a,s,l,u,c){if(t==e){r<8&&(o(n,r,i,s),n=U.c,r=U.lc);var h=n>>(r-=8);if(out+h>oe)throw"Issue with getCode";for(var p=out[-1];h-- >0;)l[u.value++]=p}else{if(!(u.value<c))throw"Issue with getCode";l[u.value++]=t}j.c=n,j.lc=r}function s(t){var e=function(t){return 65535&t}(t);return e>32767?e-65536:e}function l(t,e){var n=s(t),r=s(e),i=n+(1&r)+(r>>1),o=i-r;B.a=i,B.b=o}function u(t,e,n,r,i,o,a){for(var s,u=n>i?i:n,c=1;c<=u;)c<<=1;for(s=c>>=1,c>>=1;c>=1;){for(var h,p,d,f=0,m=f+o*(i-s),v=o*c,g=o*s,y=r*c,b=r*s;f<=m;f+=g){for(var _=f,x=f+r*(n-s);_<=x;_+=b){var w=_+y,S=(A=_+v)+y;l(e[_+t],e[A+t]),h=B.a,p=B.b,l(e[w+t],e[S+t]),d=B.b,l(h,B.a),e[_+t]=B.a,e[w+t]=B.b,l(p,d),e[A+t]=B.a,e[S+t]=B.b}if(n&c){var A;l(e[_+t],e[(A=_+v)+t]),h=B.a,e[A+t]=B.b,e[_+t]=h}}if(i&c)for(_=f,x=f+r*(n-s);_<=x;_+=b){l(e[_+t],e[(w=_+y)+t]),h=B.a,e[w+t]=B.b,e[_+t]=h}s=c,c>>=1}return f}function c(t,e,s,l,u,c,h){var p=s.value,d=f(e,s),m=f(e,s);s.value+=4;var v=f(e,s);if(s.value+=4,d<0||d>=M||m<0||m>=M)throw"Something wrong with HUF_ENCSIZE";var g=new Array(M),y=new Array(T);!function(t){for(var e=0;e<T;e++)t[e]={},t[e].len=0,t[e].lit=0,t[e].p=null}(y);if(n(t,0,s,l-(s.value-p),d,m,g),v>8*(l-(s.value-p)))throw"Something wrong with hufUncompress";!function(t,e,n,o){for(;e<=n;e++){var a=i(t[e]),s=r(t[e]);if(a>>s)throw"Invalid table entry";if(s>A){if((h=o[a>>s-A]).len)throw"Invalid table entry";if(h.lit++,h.p){var l=h.p;h.p=new Array(h.lit);for(var u=0;u<h.lit-1;++u)h.p[u]=l[u]}else h.p=new Array(1);h.p[h.lit-1]=e}else if(s){var c=0;for(u=1<<A-s;u>0;u--){var h;if((h=o[(a<<A-s)+c]).len||h.p)throw"Invalid table entry";h.len=s,h.lit=e,c++}}}}(g,d,m,y),function(t,e,n,s,l,u,c,h,p,d){for(var f=0,m=0,v=h,g=Math.trunc(l.value+(u+7)/8);l.value<g;)for(o(f,m,n,l),f=U.c,m=U.lc;m>=A;)if((x=e[f>>m-A&C]).len)a(x.lit,c,f,m-=x.len,n,0,l,p,d,v),f=j.c,m=j.lc;else{if(!x.p)throw"hufDecode issues";var y;for(y=0;y<x.lit;y++){for(var b=r(t[x.p[y]]);m<b&&l.value<g;)o(f,m,n,l),f=U.c,m=U.lc;if(m>=b&&i(t[x.p[y]])==(f>>m-b&(1<<b)-1)){a(x.p[y],c,f,m-=b,n,0,l,p,d,v),f=j.c,m=j.lc;break}}if(y==x.lit)throw"hufDecode issues"}var _=8-u&7;for(f>>=_,m-=_;m>0;){var x;if(!(x=e[f<<A-m&C]).len)throw"hufDecode issues";a(x.lit,c,f,m-=x.len,n,0,l,p,d,v),f=j.c,m=j.lc}}(g,y,t,0,s,v,m,h,u,c)}function h(t,e,n,r,i,o,a,s,l,h){var p=new Uint8Array(S),d=b(r,i),m=b(r,i);if(m>=S)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(d<=m)for(var g=0;g<m-d+1;g++)p[g+d]=v(r,i);var y=new Uint16Array(w);!function(t,e){for(var n=0,r=0;r<w;++r)(0==r||t[r>>3]&1<<(7&r))&&(e[n++]=r);for(var i=n-1;n<w;)e[n++]=0}(p,y);c(n,r,i,f(r,i),t,e,o);var _=new Array(a),x=0;for(g=0;g<a;g++){_[g]={},_[g].start=x,_[g].end=_[g].start,_[g].nx=l,_[g].ny=h,_[g].size=1,x+=_[g].nx*_[g].ny*_[g].size}var A=0;for(g=0;g<a;g++)for(var M=0;M<_[g].size;++M)A+=u(M+A,t,_[g].nx,_[g].size,_[g].ny,_[g].nx*_[g].size);return function(t,e,n){for(var r=0;r<n;++r)e[r]=t[e[r]]}(y,t,x),!0}function p(t,e){for(var n=new Uint8Array(t),r=0;0!=n[e.value+r];)r+=1;var i=(new TextDecoder).decode(n.slice(e.value,e.value+r));return e.value=e.value+r+1,i}function d(t,e){var n=t.getUint32(0,!0);return e.value=e.value+N,n}function f(t,e){var n=t.getUint32(e.value,!0);return e.value=e.value+I,n}function m(t,e){var n=t[e.value];return e.value=e.value+F,n}function v(t,e){var n=t.getUint8(e.value);return e.value=e.value+F,n}function g(t,e){var n=t.getFloat32(e.value,!0);return e.value+=L,n}function y(t){var e=(31744&t)>>10,n=1023&t;return(t>>15?-1:1)*(e?31===e?n?NaN:1/0:Math.pow(2,e-15)*(1+n/1024):n/1024*6103515625e-14)}function b(t,e){var n=t.getUint16(e.value,!0);return e.value+=D,n}function _(t,e){return y(b(t,e))}function x(t,e,n,r,i){if("string"==r||"iccProfile"==r)return function(t,e,n){var r=(new TextDecoder).decode(new Uint8Array(t).slice(e.value,e.value+n));return e.value=e.value+n,r}(e,n,i);if("chlist"==r)return function(t,e,n,r){for(var i=n.value,o=[];n.value<i+r-1;){var a=p(e,n),s=f(t,n),l=v(t,n);n.value+=3;var u=f(t,n),c=f(t,n);o.push({name:a,pixelType:s,pLinear:l,xSampling:u,ySampling:c})}return n.value+=1,o}(t,e,n,i);if("chromaticities"==r)return function(t,e){return{redX:g(t,e),redY:g(t,e),greenX:g(t,e),greenY:g(t,e),blueX:g(t,e),blueY:g(t,e),whiteX:g(t,e),whiteY:g(t,e)}}(e,n);if("compression"==r)return function(t,e){return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION"][v(t,e)]}(t,n);if("box2i"==r)return function(t,e){return{xMin:f(t,e),yMin:f(t,e),xMax:f(t,e),yMax:f(t,e)}}(t,n);if("lineOrder"==r)return function(t,e){return["INCREASING_Y"][v(t,e)]}(t,n);if("float"==r)return g(t,n);if("v2f"==r)return function(t,e){return[g(t,e),g(t,e)]}(t,n);throw"Cannot parse value for unsupported type: "+r}for(var w=65536,S=w>>3,A=14,M=65537,T=1<<A,C=T-1,E=59,P=63,O=2+P-E,N=8,L=4,I=4,D=2,F=1,R={l:0,c:0,lc:0},k=new Array(59),U={c:0,lc:0},j={c:0,lc:0},B={a:0,b:0},z=new DataView(t),V=new Uint8Array(t),G={},H=(z.getUint32(0,!0),z.getUint8(4,!0),z.getUint8(5,!0),{value:8}),W=!0;W;){var X=p(t,H);if(0==X)W=!1;else{var Y=x(z,t,H,p(t,H),f(z,H));G[X]=Y}}var q=1;"PIZ_COMPRESSION"==G.compression&&(q=32);for(var Z=(G.dataWindow.yMax+1)/q,Q=0;Q<Z;Q++)d(z,H);var J=G.dataWindow.xMax-G.dataWindow.xMin+1,K=G.dataWindow.yMax-G.dataWindow.yMin+1,$=G.channels.length,tt=new Float32Array(J*K*$),et={R:0,G:1,B:2,A:3};if("NO_COMPRESSION"==G.compression)for(var nt=0;nt<K;nt++)for(var rt=f(t,H),it=(f(t,H),0);it<G.channels.length;it++){var ot=et[G.channels[it].name];if(1!=G.channels[it].pixelType)throw"Only supported pixel format is HALF";for(var at=0;at<J;at++){var st=_(t,H);tt[K*$*(J-rt)+at*$+ot]=st}}else{if("PIZ_COMPRESSION"!=G.compression)throw"Cannot decompress unsupported compression";for(var lt=0;lt<K/q;lt++){f(z,H),f(z,H);var ut=J*q*(2*G.channels.length),ct=new Uint16Array(ut);h(ct,{value:0},V,z,H,ut,$,0,J,q);for(var ht=0;ht<q;ht++)for(it=0;it<G.channels.length;it++){ot=et[G.channels[it].name];if(1!=G.channels[it].pixelType)throw"Only supported pixel format is HALF";for(at=0;at<J;at++){st=y(ct[it*(q*J)+ht*J+at]);tt[J*$*(K-(ht+lt*q))+at*$+ot]=st}}}}return{header:G,width:J,height:K,data:tt,format:es,type:qa}};Object.assign(function(t){this.manager=void 0!==t?t:il}.prototype,{load:function(t,e,n,r){var i=this,o=al.extractUrlBase(t),a=new gt(this.manager);a.setResponseType("arraybuffer"),a.load(t,function(n){try{var a=i.parse(n,o);e(a)}catch(e){window.setTimeout(function(){r&&r(e),i.manager.itemError(t)},0)}},n,r)},parse:function(t,e){var n;if(function(t){var e="Kaydara FBX Binary  \0";return t.byteLength>=e.length&&e===un(t,0,e.length)}(t))n=(new nn).parse(t);else{var r=un(t);if(!function(t){function e(e){var n=t[e-1];return t=t.slice(r+e),r++,n}for(var n=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],r=0,i=0;i<n.length;++i)if(e(1)===n[i])return!1;return!0}(r))throw new Error("FBXLoader: Unknown format.");if(an(r)<7e3)throw new Error("FBXLoader: FBX version not supported, FileVersion: "+an(r));n=(new en).parse(r)}var i=function(t){var e=new Map;"Connections"in t&&t.Connections.connections.forEach(function(t){var n=t[0],r=t[1],i=t[2];e.has(n)||e.set(n,{parents:[],children:[]});var o={ID:r,relationship:i};e.get(n).parents.push(o),e.has(r)||e.set(r,{parents:[],children:[]});var a={ID:n,relationship:i};e.get(r).children.push(a)});return e}(n),o=He(n),a=Xe(n,We(n,new Lt(this.manager).setPath(e),o,i),i),s=qe(n,i);return Je(n,i,s,Ze(n,i,s),a)}});var cu=[],hu={ByPolygonVertex:{Direct:function(t,e,n,r){return cn(cu,r.buffer,t*r.dataSize,t*r.dataSize+r.dataSize)},IndexToDirect:function(t,e,n,r){var i=r.indices[t];return cn(cu,r.buffer,i*r.dataSize,i*r.dataSize+r.dataSize)}},ByPolygon:{Direct:function(t,e,n,r){return cn(cu,r.buffer,e*r.dataSize,e*r.dataSize+r.dataSize)},IndexToDirect:function(t,e,n,r){var i=r.indices[e];return cn(cu,r.buffer,i*r.dataSize,i*r.dataSize+r.dataSize)}},ByVertice:{Direct:function(t,e,n,r){return cn(cu,r.buffer,n*r.dataSize,n*r.dataSize+r.dataSize)}},AllSame:{IndexToDirect:function(t,e,n,r){return cn(cu,r.buffer,r.indices[0]*r.dataSize,r.indices[0]*r.dataSize+r.dataSize)}}};Object.assign(en.prototype,{getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(t){this.nodeStack.push(t),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(t,e){this.currentProp=t,this.currentPropName=e},parse:function(t){this.currentIndent=0,this.allNodes=new on,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var e=this,n=t.split("\n");return n.forEach(function(t,r){var i=t.match(/^[\s\t]*;/),o=t.match(/^[\s\t]*$/);if(!i&&!o){var a=t.match("^\\t{"+e.currentIndent+"}(\\w+):(.*){",""),s=t.match("^\\t{"+e.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),l=t.match("^\\t{"+(e.currentIndent-1)+"}}");a?e.parseNodeBegin(t,a):s?e.parseNodeProperty(t,s,n[++r]):l?e.popStack():t.match(/^[^\s\t}]/)&&e.parseNodePropertyContinued(t)}}),this.allNodes},parseNodeBegin:function(t,e){var n=e[1].trim().replace(/^"/,"").replace(/"$/,""),r=e[2].split(",").map(function(t){return t.trim().replace(/^"/,"").replace(/"$/,"")}),i={name:n},o=this.parseNodeAttr(r),a=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(n,i):n in a?("PoseNode"===n?a.PoseNode.push(i):void 0!==a[n].id&&(a[n]={},a[n][a[n].id]=a[n]),""!==o.id&&(a[n][o.id]=i)):"number"==typeof o.id?(a[n]={},a[n][o.id]=i):"Properties70"!==n&&(a[n]="PoseNode"===n?[i]:i),"number"==typeof o.id&&(i.id=o.id),""!==o.name&&(i.attrName=o.name),""!==o.type&&(i.attrType=o.type),this.pushStack(i)},parseNodeAttr:function(t){var e=t[0];""!==t[0]&&(e=parseInt(t[0]),isNaN(e)&&(e=t[0]));var n="",r="";return t.length>1&&(n=t[1].replace(/^(\w+)::/,""),r=t[2]),{id:e,name:n,type:r}},parseNodeProperty:function(t,e,n){var r=e[1].replace(/^"/,"").replace(/"$/,"").trim(),i=e[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===r&&","===i&&(i=n.replace(/"/g,"").replace(/,$/,"").trim());var o=this.getCurrentNode();if("Properties70"!==o.name){if("C"===r){var a=i.split(",").slice(1),s=parseInt(a[0]),l=parseInt(a[1]),u=i.split(",").slice(3);r="connections",function(t,e){for(var n=0,r=t.length,i=e.length;n<i;n++,r++)t[r]=e[n]}(i=[s,l],u=u.map(function(t){return t.trim().replace(/^"/,"")})),void 0===o[r]&&(o[r]=[])}"Node"===r&&(o.id=i),r in o&&Array.isArray(o[r])?o[r].push(i):"a"!==r?o[r]=i:o.a=i,this.setCurrentProp(o,r),"a"===r&&","!==i.slice(-1)&&(o.a=ln(i))}else this.parseNodeSpecialProperty(t,r,i)},parseNodePropertyContinued:function(t){var e=this.getCurrentNode();e.a+=t,","!==t.slice(-1)&&(e.a=ln(e.a))},parseNodeSpecialProperty:function(t,e,n){var r=n.split('",').map(function(t){return t.trim().replace(/^\"/,"").replace(/\s/,"_")}),i=r[0],o=r[1],a=r[2],s=r[3],l=r[4];switch(o){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":l=parseFloat(l);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":l=ln(l)}this.getPrevNode()[i]={type:o,type2:a,flag:s,value:l},this.setCurrentProp(this.getPrevNode(),i)}}),Object.assign(nn.prototype,{parse:function(t){var e=new rn(t);e.skip(23);var n=e.getUint32();console.log("FBXLoader: FBX binary version: "+n);for(var r=new on;!this.endOfContent(e);){var i=this.parseNode(e,n);null!==i&&r.add(i.name,i)}return r},endOfContent:function(t){return t.size()%16==0?(t.getOffset()+160+16&-16)>=t.size():t.getOffset()+160+16>=t.size()},parseNode:function(t,e){var n={},r=e>=7500?t.getUint64():t.getUint32(),i=e>=7500?t.getUint64():t.getUint32(),o=(e>=7500?t.getUint64():t.getUint32(),t.getUint8()),a=t.getString(o);if(0===r)return null;for(var s=[],l=0;l<i;l++)s.push(this.parseProperty(t));var u=s.length>0?s[0]:"",c=s.length>1?s[1]:"",h=s.length>2?s[2]:"";for(n.singleProperty=1===i&&t.getOffset()===r;r>t.getOffset();){var p=this.parseNode(t,e);null!==p&&this.parseSubNode(a,n,p)}return n.propertyList=s,"number"==typeof u&&(n.id=u),""!==c&&(n.attrName=c),""!==h&&(n.attrType=h),""!==a&&(n.name=a),n},parseSubNode:function(t,e,n){if(!0===n.singleProperty){var r=n.propertyList[0];Array.isArray(r)?(e[n.name]=n,n.a=r):e[n.name]=r}else if("Connections"===t&&"C"===n.name){var i=[];n.propertyList.forEach(function(t,e){0!==e&&i.push(t)}),void 0===e.connections&&(e.connections=[]),e.connections.push(i)}else if("Properties70"===n.name){Object.keys(n).forEach(function(t){e[t]=n[t]})}else if("Properties70"===t&&"P"===n.name){var o,a=n.propertyList[0],s=n.propertyList[1],l=n.propertyList[2],u=n.propertyList[3];0===a.indexOf("Lcl ")&&(a=a.replace("Lcl ","Lcl_")),0===s.indexOf("Lcl ")&&(s=s.replace("Lcl ","Lcl_")),o="Color"===s||"ColorRGB"===s||"Vector"===s||"Vector3D"===s||0===s.indexOf("Lcl_")?[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:n.propertyList[4],e[a]={type:s,type2:l,flag:u,value:o}}else void 0===e[n.name]?"number"==typeof n.id?(e[n.name]={},e[n.name][n.id]=n):e[n.name]=n:"PoseNode"===n.name?(Array.isArray(e[n.name])||(e[n.name]=[e[n.name]]),e[n.name].push(n)):void 0===e[n.name][n.id]&&(e[n.name][n.id]=n)},parseProperty:function(t){var e=t.getString(1);switch(e){case"C":return t.getBoolean();case"D":return t.getFloat64();case"F":return t.getFloat32();case"I":return t.getInt32();case"L":return t.getInt64();case"R":var n=t.getUint32();return t.getArrayBuffer(n);case"S":n=t.getUint32();return t.getString(n);case"Y":return t.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var r=t.getUint32(),i=t.getUint32(),o=t.getUint32();if(0===i)switch(e){case"b":case"c":return t.getBooleanArray(r);case"d":return t.getFloat64Array(r);case"f":return t.getFloat32Array(r);case"i":return t.getInt32Array(r);case"l":return t.getInt64Array(r)}void 0===window.Zlib&&console.error("FBXLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js");var a=new rn(new Zlib.Inflate(new Uint8Array(t.getArrayBuffer(o))).decompress().buffer);switch(e){case"b":case"c":return a.getBooleanArray(r);case"d":return a.getFloat64Array(r);case"f":return a.getFloat32Array(r);case"i":return a.getInt32Array(r);case"l":return a.getInt64Array(r)}default:throw new Error("FBXLoader: Unknown property type "+e)}}}),Object.assign(rn.prototype,{getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(t){this.offset+=t},getBoolean:function(){return 1==(1&this.getUint8())},getBooleanArray:function(t){for(var e=[],n=0;n<t;n++)e.push(this.getBoolean());return e},getUint8:function(){var t=this.dv.getUint8(this.offset);return this.offset+=1,t},getInt16:function(){var t=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,t},getInt32:function(){var t=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,t},getInt32Array:function(t){for(var e=[],n=0;n<t;n++)e.push(this.getInt32());return e},getUint32:function(){var t=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,t},getInt64:function(){var t,e;return this.littleEndian?(t=this.getUint32(),e=this.getUint32()):(e=this.getUint32(),t=this.getUint32()),2147483648&e?(e=4294967295&~e,4294967295===(t=4294967295&~t)&&(e=e+1&4294967295),t=t+1&4294967295,-(4294967296*e+t)):4294967296*e+t},getInt64Array:function(t){for(var e=[],n=0;n<t;n++)e.push(this.getInt64());return e},getUint64:function(){var t,e;return this.littleEndian?(t=this.getUint32(),e=this.getUint32()):(e=this.getUint32(),t=this.getUint32()),4294967296*e+t},getFloat32:function(){var t=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t},getFloat32Array:function(t){for(var e=[],n=0;n<t;n++)e.push(this.getFloat32());return e},getFloat64:function(){var t=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t},getFloat64Array:function(t){for(var e=[],n=0;n<t;n++)e.push(this.getFloat64());return e},getArrayBuffer:function(t){var e=this.dv.buffer.slice(this.offset,this.offset+t);return this.offset+=t,e},getString:function(t){for(var e=new Uint8Array(t),n=0;n<t;n++)e[n]=this.getUint8();var r=e.indexOf(0);return r>=0&&(e=e.slice(0,r)),al.decodeText(e)}}),Object.assign(on.prototype,{add:function(t,e){this[t]=e}});var pu=function(t){this.manager=void 0!==t?t:il,this.splitLayer=!1};pu.prototype.load=function(t,e,n,r){var i=this;new gt(i.manager).load(t,function(t){e(i.parse(t))},n,r)},pu.prototype.parse=function(t){function e(t){l.push(u={vertex:[],pathVertex:[],z:t.z})}function n(t,n){void 0===u&&e(t),g.extruding?(u.vertex.push(t.x,t.y,t.z),u.vertex.push(n.x,n.y,n.z)):(u.pathVertex.push(t.x,t.y,t.z),u.pathVertex.push(n.x,n.y,n.z))}function r(t,e){return a.relative?e:e-t}function i(t,e){return a.relative?t+e:e}function o(t,e){var n=new O;n.addAttribute("position",new T(t,3));var r=new je(n,e?h:c);r.name="layer"+d,y.add(r)}var a={x:0,y:0,z:0,e:0,f:0,extruding:!1,relative:!1},l=[],u=void 0,c=new F({color:16711680});c.name="path";var h=new F({color:65280});h.name="extruded";for(var p=t.replace(/;.+/g,"").split("\n"),d=0;d<p.length;d++){var f=p[d].split(" "),m=f[0].toUpperCase(),v={};if(f.splice(1).forEach(function(t){if(void 0!==t[0]){var e=t[0].toLowerCase(),n=parseFloat(t.substring(1));v[e]=n}}),"G0"===m||"G1"===m){var g={x:void 0!==v.x?i(a.x,v.x):a.x,y:void 0!==v.y?i(a.y,v.y):a.y,z:void 0!==v.z?i(a.z,v.z):a.z,e:void 0!==v.e?i(a.e,v.e):a.e,f:void 0!==v.f?i(a.f,v.f):a.f};r(a.e,g.e)>0&&(g.extruding=r(a.e,g.e)>0,void 0!=u&&g.z==u.z||e(g)),n(a,g),a=g}else if("G2"===m||"G3"===m)console.warn("GCodeLoader: Arc command not supported");else if("G90"===m)a.relative=!1;else if("G91"===m)a.relative=!0;else if("G92"===m){(g=a).x=void 0!==v.x?v.x:g.x,g.y=void 0!==v.y?v.y:g.y,g.z=void 0!==v.z?v.z:g.z,g.e=void 0!==v.e?v.e:g.e,a=g}else console.warn("GCodeLoader: Command not supported:"+m)}var y=new Me;if(y.name="gcode",this.splitLayer)for(d=0;d<l.length;d++){o((x=l[d]).vertex,!0),o(x.pathVertex,!1)}else{var b=[],_=[];for(d=0;d<l.length;d++){var x;b=b.concat((x=l[d]).vertex),_=_.concat(x.pathVertex)}o(b,!0),o(_,!1)}return y.quaternion.setFromEuler(new s(-Math.PI/2,0,0)),y};!function(){function t(t){this.manager=void 0!==t?t:il,this.dracoLoader=null}function e(t){this.name=v.KHR_MATERIALS_UNLIT}function n(t){if(!t)throw new Error("GLTFLoader: No DRACOLoader instance provided.");this.name=v.KHR_DRACO_MESH_COMPRESSION,this.dracoLoader=t}function i(t,e,n,r){Z.call(this,t,e,n,r)}function o(t,e){return"string"!=typeof t||""===t?"":/^(https?:)?\/\//i.test(t)?t:/^data:.*,.*$/i.test(t)?t:/^blob:.*$/i.test(t)?t:e+t}function a(){return new St({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Fo})}function s(t,e,n,r){var i=t.geometry,o=t.material,a=n.targets,s=i.morphAttributes;s.position=[],s.normal=[],o.morphTargets=!0;for(var l=0,u=a.length;l<u;l++){var c,h,d=a[l],f="morphTarget"+l;if(void 0!==d.POSITION){c=p(r[d.POSITION]);for(var m=i.attributes.position,v=0,g=c.count;v<g;v++)c.setXYZ(v,c.getX(v)+m.getX(v),c.getY(v)+m.getY(v),c.getZ(v)+m.getZ(v))}else i.attributes.position&&(c=p(i.attributes.position));if(void 0!==c&&(c.name=f,s.position.push(c)),void 0!==d.NORMAL){o.morphNormals=!0,h=p(r[d.NORMAL]);var y=i.attributes.normal;for(v=0,g=h.count;v<g;v++)h.setXYZ(v,h.getX(v)+y.getX(v),h.getY(v)+y.getY(v),h.getZ(v)+y.getZ(v))}else void 0!==i.attributes.normal&&(h=p(i.attributes.normal));void 0!==h&&(h.name=f,s.normal.push(h))}if(t.updateMorphTargets(),void 0!==e.weights)for(l=0,u=e.weights.length;l<u;l++)t.morphTargetInfluences[l]=e.weights[l];if(e.extras&&Array.isArray(e.extras.targetNames))for(l=0,u=e.extras.targetNames.length;l<u;l++)t.morphTargetDictionary[e.extras.targetNames[l]]=l}function l(t,e){if(t.indices!==e.indices)return!1;var n=t.attributes||{},r=e.attributes||{},i=Object.keys(n),o=Object.keys(r);if(i.length!==o.length)return!1;for(var a=0,s=i.length;a<s;a++){var l=i[a];if(n[l]!==r[l])return!1}return!0}function u(t,e){for(var n=0,r=t.length;n<r;n++){var i=t[n];if(l(i.primitive,e))return i.promise}return null}function p(t){if(t.isInterleavedBufferAttribute){for(var e=t.count,n=t.itemSize,r=t.array.slice(0,e*n),i=0;i<e;++i)r[i]=t.getX(i),n>=2&&(r[i+1]=t.getY(i)),n>=3&&(r[i+2]=t.getZ(i)),n>=4&&(r[i+3]=t.getW(i));return new y(r,n,t.normalized)}return t.clone()}function d(t,e,n){this.json=t||{},this.extensions=e||{},this.options=n||{},this.cache=new function(){var t={};return{get:function(e){return t[e]},add:function(e,n){t[e]=n},remove:function(e){delete t[e]},removeAll:function(){t={}}}},this.primitiveCache=[],this.textureLoader=new Lt(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new gt(this.options.manager),this.fileLoader.setResponseType("arraybuffer")}function f(t,e,n){var r=e.attributes;for(var i in r){var o=U[i];o&&(o in t.attributes||t.addAttribute(o,n[r[i]]))}void 0===e.indices||t.index||t.setIndex(n[e.indices])}t.prototype={constructor:t,crossOrigin:"Anonymous",load:function(t,e,n,r){var i=this,o=void 0!==this.path?this.path:al.extractUrlBase(t),a=new gt(i.manager);a.setResponseType("arraybuffer"),a.load(t,function(t){try{i.parse(t,o,e,r)}catch(t){if(void 0===r)throw t;r(t)}},n,r)},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setDRACOLoader:function(t){return this.dracoLoader=t,this},parse:function(t,r,i,o){var a,s={};if("string"==typeof t)a=t;else{if(al.decodeText(new Uint8Array(t,0,4))===g){try{s[v.KHR_BINARY_GLTF]=new function(t){this.name=v.KHR_BINARY_GLTF,this.content=null,this.body=null;var e=new DataView(t,0,b);if(this.header={magic:al.decodeText(new Uint8Array(t.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==g)throw new Error("GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");for(var n=new DataView(t,b),r=0;r<n.byteLength;){var i=n.getUint32(r,!0),o=n.getUint32(r+=4,!0);if(r+=4,o===_.JSON){var a=new Uint8Array(t,b+r,i);this.content=al.decodeText(a)}else if(o===_.BIN){var s=b+r;this.body=t.slice(s,s+i)}r+=i}if(null===this.content)throw new Error("GLTFLoader: JSON content not found.")}(t)}catch(t){return void(o&&o(t))}a=s[v.KHR_BINARY_GLTF].content}else a=al.decodeText(new Uint8Array(t))}var l=JSON.parse(a);if(void 0===l.asset||l.asset.version[0]<2)o&&o(new Error("GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead."));else{l.extensionsUsed&&(l.extensionsUsed.indexOf(v.KHR_LIGHTS)>=0&&(s[v.KHR_LIGHTS]=new function(t){this.name=v.KHR_LIGHTS,this.lights={};var e=(t.extensions&&t.extensions[v.KHR_LIGHTS]||{}).lights||{};for(var n in e){var r,i=e[n],o=(new h).fromArray(i.color);switch(i.type){case"directional":(r=new De(o)).position.set(0,0,1);break;case"point":r=new Le(o);break;case"spot":(r=new Re(o)).position.set(0,0,1);break;case"ambient":r=new Ue(o)}r&&(void 0!==i.constantAttenuation&&(r.intensity=i.constantAttenuation),void 0!==i.linearAttenuation&&(r.distance=1/i.linearAttenuation),void 0!==i.quadraticAttenuation&&(r.decay=i.quadraticAttenuation),void 0!==i.fallOffAngle&&(r.angle=i.fallOffAngle),void 0!==i.fallOffExponent&&console.warn("GLTFLoader:: light.fallOffExponent not currently supported."),r.name=i.name||"light_"+n,this.lights[n]=r)}}(l)),l.extensionsUsed.indexOf(v.KHR_MATERIALS_UNLIT)>=0&&(s[v.KHR_MATERIALS_UNLIT]=new e(l)),l.extensionsUsed.indexOf(v.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS)>=0&&(s[v.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]=new function(){return{name:v.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return dt},extendParams:function(t,e,n){var r=e.extensions[this.name],i=Nl.standard,o=tl.clone(i.uniforms),a=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),s=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),l=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),u=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),c=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),p=i.fragmentShader.replace("#include <specularmap_fragment>","").replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",a).replace("#include <metalnessmap_pars_fragment>",s).replace("#include <roughnessmap_fragment>",l).replace("#include <metalnessmap_fragment>",u).replace("#include <lights_physical_fragment>",c);delete o.roughness,delete o.metalness,delete o.roughnessMap,delete o.metalnessMap,o.specular={value:(new h).setHex(1118481)},o.glossiness={value:.5},o.specularMap={value:null},o.glossinessMap={value:null},t.vertexShader=i.vertexShader,t.fragmentShader=p,t.uniforms=o,t.defines={STANDARD:""},t.color=new h(1,1,1),t.opacity=1;var d=[];if(Array.isArray(r.diffuseFactor)){var f=r.diffuseFactor;t.color.fromArray(f),t.opacity=f[3]}if(void 0!==r.diffuseTexture&&d.push(n.assignTexture(t,"map",r.diffuseTexture.index)),t.emissive=new h(0,0,0),t.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,t.specular=new h(1,1,1),Array.isArray(r.specularFactor)&&t.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){var m=r.specularGlossinessTexture.index;d.push(n.assignTexture(t,"glossinessMap",m)),d.push(n.assignTexture(t,"specularMap",m))}return Promise.all(d)},createMaterial:function(t){var e=new dt({defines:t.defines,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms,fog:!0,lights:!0,opacity:t.opacity,transparent:t.transparent});return e.isGLTFSpecularGlossinessMaterial=!0,e.color=t.color,e.map=void 0===t.map?null:t.map,e.lightMap=null,e.lightMapIntensity=1,e.aoMap=void 0===t.aoMap?null:t.aoMap,e.aoMapIntensity=1,e.emissive=t.emissive,e.emissiveIntensity=1,e.emissiveMap=void 0===t.emissiveMap?null:t.emissiveMap,e.bumpMap=void 0===t.bumpMap?null:t.bumpMap,e.bumpScale=1,e.normalMap=void 0===t.normalMap?null:t.normalMap,t.normalScale&&(e.normalScale=t.normalScale),e.displacementMap=null,e.displacementScale=1,e.displacementBias=0,e.specularMap=void 0===t.specularMap?null:t.specularMap,e.specular=t.specular,e.glossinessMap=void 0===t.glossinessMap?null:t.glossinessMap,e.glossiness=t.glossiness,e.alphaMap=null,e.envMap=void 0===t.envMap?null:t.envMap,e.envMapIntensity=1,e.refractionRatio=.98,e.extensions.derivatives=!0,e},cloneMaterial:function(t){var e=t.clone();e.isGLTFSpecularGlossinessMaterial=!0;for(var n=this.specularGlossinessParams,r=0,i=n.length;r<i;r++)e[n[r]]=t[n[r]];return e},refreshUniforms:function(t,e,n,r,i,o){if(!0===i.isGLTFSpecularGlossinessMaterial){var a=i.uniforms,s=i.defines;a.opacity.value=i.opacity,a.diffuse.value.copy(i.color),a.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),a.map.value=i.map,a.specularMap.value=i.specularMap,a.alphaMap.value=i.alphaMap,a.lightMap.value=i.lightMap,a.lightMapIntensity.value=i.lightMapIntensity,a.aoMap.value=i.aoMap,a.aoMapIntensity.value=i.aoMapIntensity;var l;if(i.map?l=i.map:i.specularMap?l=i.specularMap:i.displacementMap?l=i.displacementMap:i.normalMap?l=i.normalMap:i.bumpMap?l=i.bumpMap:i.glossinessMap?l=i.glossinessMap:i.alphaMap?l=i.alphaMap:i.emissiveMap&&(l=i.emissiveMap),void 0!==l){l.isWebGLRenderTarget&&(l=l.texture);var u,c;if(void 0!==l.matrix){if(!0===l.matrixAutoUpdate){var h=l.center;l.matrix.setUvTransform((u=l.offset).x,u.y,(c=l.repeat).x,c.y,l.rotation,h.x,h.y)}a.uvTransform.value.copy(l.matrix)}else a.offsetRepeat.value.set((u=l.offset).x,u.y,(c=l.repeat).x,c.y)}a.envMap.value=i.envMap,a.envMapIntensity.value=i.envMapIntensity,a.flipEnvMap.value=i.envMap&&i.envMap.isCubeTexture?-1:1,a.refractionRatio.value=i.refractionRatio,a.specular.value.copy(i.specular),a.glossiness.value=i.glossiness,a.glossinessMap.value=i.glossinessMap,a.emissiveMap.value=i.emissiveMap,a.bumpMap.value=i.bumpMap,a.normalMap.value=i.normalMap,a.displacementMap.value=i.displacementMap,a.displacementScale.value=i.displacementScale,a.displacementBias.value=i.displacementBias,null!==a.glossinessMap.value&&void 0===s.USE_GLOSSINESSMAP&&(s.USE_GLOSSINESSMAP="",s.USE_ROUGHNESSMAP=""),null===a.glossinessMap.value&&void 0!==s.USE_GLOSSINESSMAP&&(delete s.USE_GLOSSINESSMAP,delete s.USE_ROUGHNESSMAP)}}}}),l.extensionsUsed.indexOf(v.KHR_DRACO_MESH_COMPRESSION)>=0&&(s[v.KHR_DRACO_MESH_COMPRESSION]=new n(this.dracoLoader))),console.time("GLTFLoader");new d(l,s,{path:r||this.path||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(function(t,e,n,r,o){console.timeEnd("GLTFLoader");i({scene:t,scenes:e,cameras:n,animations:r,asset:o})},o)}}};var v={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS:"KHR_lights",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit"};e.prototype.getMaterialType=function(t){return D},e.prototype.extendParams=function(t,e,n){var r=[];t.color=new h(1,1,1),t.opacity=1;var i=e.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){var o=i.baseColorFactor;t.color.fromArray(o),t.opacity=o[3]}void 0!==i.baseColorTexture&&r.push(n.assignTexture(t,"map",i.baseColorTexture.index))}return Promise.all(r)};var g="glTF",b=12,_={JSON:1313821514,BIN:5130562};n.prototype.decodePrimitive=function(t,e){var n=this.dracoLoader,r=t.extensions[this.name].bufferView,i=t.extensions[this.name].attributes,o={};for(var a in i)a in U&&(o[U[a]]=i[a]);return e.getDependency("bufferView",r).then(function(t){return new Promise(function(e){n.decodeDracoFile(t,e,o)})})},(i.prototype=Object.create(Z.prototype)).constructor=i,i.prototype.interpolate_=function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=2*a,l=3*a,u=r-e,c=(n-e)/u,h=c*c,p=h*c,d=t*l,f=d-l,m=2*p-3*h+1,v=p-2*h+c,g=-2*p+3*h,y=p-h,b=0;b!==a;b++){i[b]=m*o[f+b+a]+v*(o[f+b+s]*u)+g*o[d+b+a]+y*(o[d+b]*u)}return i};var x=0,w=1,S=2,A=3,M=4,T=5,C=6,E={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},P={9728:Ra,9729:ja,9984:ka,9985:Ba,9986:Ua,9987:za},N={33071:Da,33648:Fa,10497:Ia},L={6406:ts,6407:es,6408:ns,6409:rs,6410:is},R={5121:Va,32819:Qa,32820:Ja,33635:Ka},k={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},U={POSITION:"position",NORMAL:"normal",TEXCOORD_0:"uv",TEXCOORD0:"uv",TEXCOORD:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",COLOR0:"color",COLOR:"color",WEIGHTS_0:"skinWeight",WEIGHT:"skinWeight",JOINTS_0:"skinIndex",JOINT:"skinIndex"},j={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},G={CUBICSPLINE:2302,LINEAR:2301,STEP:Ls},H="OPAQUE",W="MASK",X="BLEND";d.prototype.parse=function(t,e){var n=this.json;this.cache.removeAll(),this.markDefs(),this.getMultiDependencies(["scene","animation","camera"]).then(function(e){var r=e.scenes||[];t(r[n.scene||0],r,e.cameras||[],e.animations||[],n.asset)}).catch(e)},d.prototype.markDefs=function(){for(var t=this.json.nodes||[],e=this.json.skins||[],n=this.json.meshes||[],r={},i={},o=0,a=e.length;o<a;o++)for(var s=e[o].joints,l=0,u=s.length;l<u;l++)t[s[l]].isBone=!0;for(var c=0,h=t.length;c<h;c++){var p=t[c];void 0!==p.mesh&&(void 0===r[p.mesh]&&(r[p.mesh]=i[p.mesh]=0),r[p.mesh]++,void 0!==p.skin&&(n[p.mesh].isSkinnedMesh=!0))}this.json.meshReferences=r,this.json.meshUses=i},d.prototype.getDependency=function(t,e){var n=t+":"+e,r=this.cache.get(n);if(!r){r=this["load"+t.charAt(0).toUpperCase()+t.slice(1)](e),this.cache.add(n,r)}return r},d.prototype.getDependencies=function(t){var e=this.cache.get(t);if(!e){var n=this,r=this.json[t+("mesh"===t?"es":"s")]||[];e=Promise.all(r.map(function(e,r){return n.getDependency(t,r)})),this.cache.add(t,e)}return e},d.prototype.getMultiDependencies=function(t){for(var e={},n=[],r=0,i=t.length;r<i;r++){var o=t[r],a=this.getDependencies(o);a=a.then(function(t,n){e[t]=n}.bind(this,o+("mesh"===o?"es":"s"))),n.push(a)}return Promise.all(n).then(function(){return e})},d.prototype.loadBuffer=function(t){var e=this.json.buffers[t],n=this.fileLoader;if(e.type&&"arraybuffer"!==e.type)throw new Error("GLTFLoader: "+e.type+" buffer type is not supported.");if(void 0===e.uri&&0===t)return Promise.resolve(this.extensions[v.KHR_BINARY_GLTF].body);var r=this.options;return new Promise(function(t,i){n.load(o(e.uri,r.path),t,void 0,function(){i(new Error('GLTFLoader: Failed to load buffer "'+e.uri+'".'))})})},d.prototype.loadBufferView=function(t){var e=this.json.bufferViews[t];return this.getDependency("buffer",e.buffer).then(function(t){var n=e.byteOffset||0;return t.slice(n,n+(e.byteLength||0))})},d.prototype.loadAccessor=function(t){var e=this,n=this.json,r=this.json.accessors[t];if(void 0===r.bufferView&&void 0===r.sparse)return null;var i=[];return i.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(i.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(i).then(function(t){var i,o=t[0],a=k[r.type],s=E[r.componentType],l=s.BYTES_PER_ELEMENT,u=r.byteOffset||0,c=n.bufferViews[r.bufferView].byteStride,h=!0===r.normalized;if(c&&c!==l*a){var p="InterleavedBuffer:"+r.bufferView+":"+r.componentType,d=e.cache.get(p);d||(d=new xe(new s(o),c/l),e.cache.add(p,d)),i=new Se(d,a,u/l,h)}else i=new y(null===o?new s(r.count*a):new s(o,u,r.count*a),a,h);if(void 0!==r.sparse){var f=r.sparse.values.byteOffset||0,m=new(0,E[r.sparse.indices.componentType])(t[1],r.sparse.indices.byteOffset||0,r.sparse.count*k.SCALAR),v=new s(t[2],f,r.sparse.count*a);null!==o&&i.setArray(i.array.slice());for(var g=0,b=m.length;g<b;g++){var _=m[g];if(i.setX(_,v[g*a]),a>=2&&i.setY(_,v[g*a+1]),a>=3&&i.setZ(_,v[g*a+2]),a>=4&&i.setW(_,v[g*a+3]),a>=5)throw new Error("GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return i})},d.prototype.loadTexture=function(t){var e=this.json,n=this.options,r=this.textureLoader,i=window.URL||window.webkitURL,a=e.textures[t],s=e.images[a.source],l=s.uri,u=!1;return void 0!==s.bufferView&&(l=this.getDependency("bufferView",s.bufferView).then(function(t){u=!0;var e=new Blob([t],{type:s.mimeType});return l=i.createObjectURL(e)})),Promise.resolve(l).then(function(t){var e=It.Handlers.get(t)||r;return new Promise(function(r,i){e.load(o(t,n.path),r,void 0,i)})}).then(function(t){!0===u&&i.revokeObjectURL(l),t.flipY=!1,void 0!==a.name&&(t.name=a.name),t.format=void 0!==a.format?L[a.format]:ns,void 0!==a.internalFormat&&t.format!==L[a.internalFormat]&&console.warn("GLTFLoader: Three.js does not support texture internalFormat which is different from texture format. internalFormat will be forced to be the same value as format."),t.type=void 0!==a.type?R[a.type]:Va;var n=(e.samplers||{})[a.sampler]||{};return t.magFilter=P[n.magFilter]||ja,t.minFilter=P[n.minFilter]||za,t.wrapS=N[n.wrapS]||Ia,t.wrapT=N[n.wrapT]||Ia,t})},d.prototype.assignTexture=function(t,e,n){return this.getDependency("texture",n).then(function(n){t[e]=n})},d.prototype.loadMaterial=function(t){var e,n=this.extensions,r=this.json.materials[t],i={},o=r.extensions||{},a=[];if(o[v.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var s=n[v.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];e=s.getMaterialType(r),a.push(s.extendParams(i,r,this))}else if(o[v.KHR_MATERIALS_UNLIT]){var l=n[v.KHR_MATERIALS_UNLIT];e=l.getMaterialType(r),a.push(l.extendParams(i,r,this))}else if(void 0!==r.pbrMetallicRoughness){e=St;var u=r.pbrMetallicRoughness;if(i.color=new h(1,1,1),i.opacity=1,Array.isArray(u.baseColorFactor)){var c=u.baseColorFactor;i.color.fromArray(c),i.opacity=c[3]}if(void 0!==u.baseColorTexture&&a.push(this.assignTexture(i,"map",u.baseColorTexture.index)),i.metalness=void 0!==u.metallicFactor?u.metallicFactor:1,i.roughness=void 0!==u.roughnessFactor?u.roughnessFactor:1,void 0!==u.metallicRoughnessTexture){var p=u.metallicRoughnessTexture.index;a.push(this.assignTexture(i,"metalnessMap",p)),a.push(this.assignTexture(i,"roughnessMap",p))}}else e=wt;!0===r.doubleSided&&(i.side=ko);var d=r.alphaMode||H;return d===X?i.transparent=!0:(i.transparent=!1,d===W&&(i.alphaTest=void 0!==r.alphaCutoff?r.alphaCutoff:.5)),void 0!==r.normalTexture&&e!==D&&(a.push(this.assignTexture(i,"normalMap",r.normalTexture.index)),i.normalScale=new m(1,1),void 0!==r.normalTexture.scale&&i.normalScale.set(r.normalTexture.scale,r.normalTexture.scale)),void 0!==r.occlusionTexture&&e!==D&&(a.push(this.assignTexture(i,"aoMap",r.occlusionTexture.index)),void 0!==r.occlusionTexture.strength&&(i.aoMapIntensity=r.occlusionTexture.strength)),void 0!==r.emissiveFactor&&e!==D&&(i.emissive=(new h).fromArray(r.emissiveFactor)),void 0!==r.emissiveTexture&&e!==D&&a.push(this.assignTexture(i,"emissiveMap",r.emissiveTexture.index)),Promise.all(a).then(function(){var t;return t=e===dt?n[v.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(i):new e(i),void 0!==r.name&&(t.name=r.name),t.normalScale&&(t.normalScale.x=-t.normalScale.x),t.map&&(t.map.encoding=Us),t.emissiveMap&&(t.emissiveMap.encoding=Us),r.extras&&(t.userData=r.extras),t})},d.prototype.loadGeometries=function(t){var e=this,n=this.extensions,r=this.primitiveCache;return this.getDependencies("accessor").then(function(i){for(var o=[],a=[],s=0,l=t.length;s<l;s++){var c,h=t[s],p=u(r,h);if(p)a.push(p.then(function(t){o.push(t)}));else if(h.extensions&&h.extensions[v.KHR_DRACO_MESH_COMPRESSION]){var d=n[v.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(h,e).then(function(t){return f(t,h,i),o.push(t),t});r.push({primitive:h,promise:d}),a.push(d)}else f(c=new O,h,i),r.push({primitive:h,promise:Promise.resolve(c)}),o.push(c)}return Promise.all(a).then(function(){return o})})},d.prototype.loadMesh=function(t){var e=this,n=this.extensions,r=this.json.meshes[t];return this.getMultiDependencies(["accessor","material"]).then(function(i){var o=new Me,l=r.primitives;return e.loadGeometries(l).then(function(u){for(var c=0,h=l.length;c<h;c++){var p=l[c],d=u[c],f=void 0===p.material?a():i.materials[p.material];f.aoMap&&void 0===d.attributes.uv2&&void 0!==d.attributes.uv&&(console.log("GLTFLoader: Duplicating UVs to support aoMap."),d.addAttribute("uv2",new y(d.attributes.uv.array,2)));var m=void 0!==d.attributes.color,g=void 0===d.attributes.normal,b=!0===r.isSkinnedMesh,_=void 0!==p.targets;if(m||g||b||_)if(f.isGLTFSpecularGlossinessMaterial){f=n[v.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(f)}else f=f.clone();m&&(f.vertexColors=Bo,f.needsUpdate=!0),g&&(f.flatShading=!0);var E;if(p.mode===M||p.mode===T||p.mode===C||void 0===p.mode)b?(E=new Ce(d,f),f.skinning=!0):E=new B(d,f),p.mode===T?E.drawMode=Fs:p.mode===C&&(E.drawMode=Rs);else if(p.mode===w||p.mode===A||p.mode===S){var P=e.cache.get(O="LineBasicMaterial:"+f.uuid);P||(P=new F,I.prototype.copy.call(P,f),P.color.copy(f.color),P.lights=!1,e.cache.add(O,P)),f=P,E=p.mode===w?new je(d,f):p.mode===A?new z(d,f):new Ve(d,f)}else{if(p.mode!==x)throw new Error("GLTFLoader: Primitive mode unsupported: "+p.mode);var O,N=e.cache.get(O="PointsMaterial:"+f.uuid);N||(N=new Tt,I.prototype.copy.call(N,f),N.color.copy(f.color),N.map=f.map,N.lights=!1,e.cache.add(O,N)),E=new be(d,f=N)}if(E.name=r.name||"mesh_"+t,_&&s(E,r,p,i.accessors),void 0!==r.extras&&(E.userData=r.extras),void 0!==p.extras&&(E.geometry.userData=p.extras),!0===f.isGLTFSpecularGlossinessMaterial&&(E.onBeforeRender=n[v.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms),!(l.length>1))return E;E.name+="_"+c,o.add(E)}return o})})},d.prototype.loadCamera=function(t){var e,n=this.json.cameras[t],r=n[n.type];if(r){if("perspective"===n.type){var i=r.aspectRatio||1;e=new st(xo.radToDeg(r.yfov*i),i,r.znear||1,r.zfar||2e6)}else"orthographic"===n.type&&(e=new ct(r.xmag/-2,r.xmag/2,r.ymag/2,r.ymag/-2,r.znear,r.zfar));return void 0!==n.name&&(e.name=n.name),n.extras&&(e.userData=n.extras),Promise.resolve(e)}console.warn("GLTFLoader: Missing camera parameters.")},d.prototype.loadSkin=function(t){var e=this.json.skins[t],n={joints:e.joints};return void 0===e.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",e.inverseBindMatrices).then(function(t){return n.inverseBindMatrices=t,n})},d.prototype.loadAnimation=function(t){var e=this.json.animations[t];return this.getMultiDependencies(["accessor","node"]).then(function(n){for(var r=[],o=0,a=e.channels.length;o<a;o++){var s=e.channels[o],l=e.samplers[s.sampler];if(l){var u=s.target,c=void 0!==u.node?u.node:u.id,h=n.accessors[void 0!==e.parameters?e.parameters[l.input]:l.input],p=n.accessors[void 0!==e.parameters?e.parameters[l.output]:l.output],d=n.nodes[c];if(d){d.updateMatrix(),d.matrixAutoUpdate=!0;var f;switch(j[u.path]){case j.weights:f=it;break;case j.rotation:f=J;break;case j.position:case j.scale:default:f=$}var m=d.name?d.name:d.uuid,v=void 0!==l.interpolation?G[l.interpolation]:2301,g=[];j[u.path]===j.weights?d.traverse(function(t){!0===t.isMesh&&!0===t.material.morphTargets&&g.push(t.name?t.name:t.uuid)}):g.push(m);for(var y=0,b=g.length;y<b;y++){var _=new f(g[y]+"."+j[u.path],Js.arraySlice(h.array,0),Js.arraySlice(p.array,0),v);"CUBICSPLINE"===l.interpolation&&(_.createInterpolant=function(t){return new i(this.times,this.values,this.getValueSize()/3,t)},_.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),r.push(_)}}}}return new ot(c=void 0!==e.name?e.name:"animation_"+t,void 0,r)})},d.prototype.loadNode=function(t){var e=this.extensions,n=this.json.meshReferences,i=this.json.meshUses,o=this.json.nodes[t];return this.getMultiDependencies(["mesh","skin","camera"]).then(function(t){var a;if(!0===o.isBone)a=new V;else if(void 0!==o.mesh){var s=t.meshes[o.mesh];if(a=s.clone(),!0===s.isGroup)for(var l=0,u=s.children.length;l<u;l++){var h=s.children[l];h.material&&!0===h.material.isGLTFSpecularGlossinessMaterial&&(a.children[l].onBeforeRender=h.onBeforeRender)}else s.material&&!0===s.material.isGLTFSpecularGlossinessMaterial&&(a.onBeforeRender=s.onBeforeRender);n[o.mesh]>1&&(a.name+="_instance_"+i[o.mesh]++)}else if(void 0!==o.camera)a=t.cameras[o.camera];else if(o.extensions&&o.extensions[v.KHR_LIGHTS]&&void 0!==o.extensions[v.KHR_LIGHTS].light){a=e[v.KHR_LIGHTS].lights[o.extensions[v.KHR_LIGHTS].light]}else a=new c;if(void 0!==o.name&&(a.name=me.sanitizeNodeName(o.name)),o.extras&&(a.userData=o.extras),void 0!==o.matrix){var p=new r;p.fromArray(o.matrix),a.applyMatrix(p)}else void 0!==o.translation&&a.position.fromArray(o.translation),void 0!==o.rotation&&a.quaternion.fromArray(o.rotation),void 0!==o.scale&&a.scale.fromArray(o.scale);return a})},d.prototype.loadScene=function(){function t(e,n,i,o,a){var s=o[e],l=i.nodes[e];if(void 0!==l.skin)for(var u=!0===s.isGroup?s.children:[s],c=0,h=u.length;c<h;c++){for(var p=u[c],d=a[l.skin],f=[],m=[],v=0,g=d.joints.length;v<g;v++){var y=d.joints[v],b=o[y];if(b){f.push(b);var _=new r;void 0!==d.inverseBindMatrices&&_.fromArray(d.inverseBindMatrices.array,16*v),m.push(_)}else console.warn('GLTFLoader: Joint "%s" could not be found.',y)}p.bind(new Te(f,m),p.matrixWorld)}if(n.add(s),l.children){var x=l.children;for(c=0,h=x.length;c<h;c++){t(x[c],s,i,o,a)}}}return function(e){var n=this.json,r=this.extensions,i=this.json.scenes[e];return this.getMultiDependencies(["node","skin"]).then(function(e){var o=new ut;void 0!==i.name&&(o.name=i.name),i.extras&&(o.userData=i.extras);for(var a=i.nodes||[],s=0,l=a.length;s<l;s++)t(a[s],o,n,e.nodes,e.skins);if(i.extensions&&i.extensions[v.KHR_LIGHTS]&&void 0!==i.extensions[v.KHR_LIGHTS].light){o.add(r[v.KHR_LIGHTS].lights[i.extensions[v.KHR_LIGHTS].light])}return o})}}()}();var du=function(t){this.manager=void 0!==t?t:il};(du.prototype=Object.create(Ge.prototype))._parser=function(t){var e=function(t,e){switch(t){case 1:console.error("RGBELoader Read Error: "+(e||""));break;case 2:console.error("RGBELoader Write Error: "+(e||""));break;case 3:console.error("RGBELoader Bad File Format: "+(e||""));break;default:case 4:console.error("RGBELoader: Error: "+(e||""))}return-1},n=function(t,e,n){e=e||1024;for(var r=t.pos,i=-1,o=0,a="",s=String.fromCharCode.apply(null,new Uint16Array(t.subarray(r,r+128)));0>(i=s.indexOf("\n"))&&o<e&&r<t.byteLength;)a+=s,o+=s.length,r+=128,s+=String.fromCharCode.apply(null,new Uint16Array(t.subarray(r,r+128)));return-1<i&&(!1!==n&&(t.pos+=o+i+1),a+s.slice(0,i))},r=new Uint8Array(t);r.pos=0;var i=function(t){var r,i,o=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,a=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*FORMAT=(\S+)\s*$/,l=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,u={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(t.pos>=t.byteLength||!(r=n(t)))return e(1,"no header found");if(!(i=r.match(/^#\?(\S+)$/)))return e(3,"bad initial token");for(u.valid|=1,u.programtype=i[1],u.string+=r+"\n";!1!==(r=n(t));)if(u.string+=r+"\n","#"!==r.charAt(0)){if((i=r.match(o))&&(u.gamma=parseFloat(i[1],10)),(i=r.match(a))&&(u.exposure=parseFloat(i[1],10)),(i=r.match(s))&&(u.valid|=2,u.format=i[1]),(i=r.match(l))&&(u.valid|=4,u.height=parseInt(i[1],10),u.width=parseInt(i[2],10)),2&u.valid&&4&u.valid)break}else u.comments+=r+"\n";return 2&u.valid?4&u.valid?u:e(3,"missing image size specifier"):e(3,"missing format specifier")}(r);if(-1!==i){var o=i.width,a=i.height,s=function(t,n,r){var i,o,a,s,l,u,c,h,p,d,f,m,v,g=n,y=r;if(g<8||g>32767||2!==t[0]||2!==t[1]||128&t[2])return new Uint8Array(t);if(g!==(t[2]<<8|t[3]))return e(3,"wrong scanline width");if(!(i=new Uint8Array(4*n*r))||!i.length)return e(4,"unable to allocate buffer space");for(o=0,a=0,h=4*g,v=new Uint8Array(4),u=new Uint8Array(h);y>0&&a<t.byteLength;){if(a+4>t.byteLength)return e(1);if(v[0]=t[a++],v[1]=t[a++],v[2]=t[a++],v[3]=t[a++],2!=v[0]||2!=v[1]||(v[2]<<8|v[3])!=g)return e(3,"bad rgbe scanline format");for(c=0;c<h&&a<t.byteLength;){if(s=t[a++],(m=s>128)&&(s-=128),0===s||c+s>h)return e(3,"bad scanline data");if(m)for(l=t[a++],p=0;p<s;p++)u[c++]=l;else u.set(t.subarray(a,a+s),c),c+=s,a+=s}for(d=g,p=0;p<d;p++)i[o]=u[p+(f=0)],i[o+1]=u[p+(f+=g)],i[o+2]=u[p+(f+=g)],i[o+3]=u[p+(f+=g)],o+=4;y--}return i}(r.subarray(r.pos),o,a);if(-1!==s)return{width:o,height:a,data:s,header:i.string,gamma:i.gamma,exposure:i.exposure,format:os,type:Va}}return null};(hn.prototype=Object.create(ht.prototype)).constructor=hn,hn.prototype.isCubeTexture=!0,Object.defineProperty(hn.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});(function(t){this.manager=void 0!==t?t:il,this.hdrLoader=new du}).prototype.load=function(t,e,n,r,i){function o(n,r,i,o){var h=new gt(this.manager);h.setResponseType("arraybuffer"),h.load(e[n],function(e){c++;var i=u._parser(e);if(i){if(t===qa){for(var o=i.data.length/4*3,h=new Float32Array(o),p=0;p<o;p++)a(i.data,4*p,h,3*p);i.data=h}else if(t===Za){o=i.data.length/4*3;var d=new Uint16Array(o);for(p=0;p<o;p++)s(i.data,4*p,d,3*p);i.data=d}if(void 0!==i.image)l[n].images=i.image;else if(void 0!==i.data){var f=new ye(i.data,i.width,i.height);f.format=l.format,f.type=l.type,f.encoding=l.encoding,f.minFilter=l.minFilter,f.magFilter=l.magFilter,f.generateMipmaps=l.generateMipmaps,l.images[n]=f}6===c&&(l.needsUpdate=!0,r&&r(l))}},i,o)}var a=function(t,e,n,r){var i=t[e+3],o=Math.pow(2,i-128)/255;n[r+0]=t[e+0]*o,n[r+1]=t[e+1]*o,n[r+2]=t[e+2]*o},s=function(){function t(t){e[0]=t;var r=n[0],i=r>>16&32768,o=r>>12&2047,a=r>>23&255;return a<103?i:a>142?(i|=31744,i|=(255==a?0:1)&&8388607&r):a<113?(o|=2048,i|=(o>>114-a)+(o>>113-a&1)):(i|=a-112<<10|o>>1,i+=1&o)}var e=new Float32Array(1),n=new Int32Array(e.buffer);return function(e,n,r,i){var o=e[n+3],a=Math.pow(2,o-128)/255;r[i+0]=t(e[n+0]*a),r[i+1]=t(e[n+1]*a),r[i+2]=t(e[n+2]*a)}}(),l=new hn;l.type=t,l.encoding=t===Va?Bs:ks,l.format=t===Va?ns:es,l.minFilter=l.encoding===Bs?Ra:ja,l.magFilter=l.encoding===Bs?Ra:ja,l.generateMipmaps=l.encoding!==Bs,l.anisotropy=0;for(var u=this.hdrLoader,c=0,h=0;h<e.length;h++)o(h,n,r,i);return l};var fu=function(t){this.manager=void 0!==t?t:il};fu.prototype={constructor:fu,load:function(t,e,n,r){var i=this,o=new gt(i.manager);o.setResponseType("arraybuffer"),o.load(t,function(t){e(i.parse(t))},n,r)},parse:function(t){function e(t){var e=decodeURI(t.init_from);e=e.replace("../","");var r=new RegExp(e+"$"),i=n.file(r);if(i.length){var o=i[0],a=new Blob([o.asArrayBuffer()],{type:"application/octet-binary"});t.build.src=URL.createObjectURL(a)}}var n=new JSZip(t),r=n.file(/dae$/i);if(r.length){var i=r[0],o=(new au).parse(i.asText()),a=o.library.images;for(var s in a)e(a[s]);return o}return console.error("KMZLoader: Couldn't find .dae file."),{scene:new Me}}};var mu=function(){this._parser=mu.parse};mu.prototype=Object.create(ze.prototype),mu.prototype.constructor=mu,mu.parse=function(t,e){var n=new vu(t,1);return{mipmaps:n.mipmaps(e),width:n.pixelWidth,height:n.pixelHeight,format:n.glInternalFormat,isCubemap:6===n.numberOfFaces,mipmapCount:n.numberOfMipmapLevels}};var vu=function(){function t(e,n,r,i){this.arrayBuffer=e;var o=new Uint8Array(this.arrayBuffer,0,12);if(171===o[0]&&75===o[1]&&84===o[2]&&88===o[3]&&32===o[4]&&49===o[5]&&49===o[6]&&187===o[7]&&13===o[8]&&10===o[9]&&26===o[10]&&10===o[11]){var a=new Int32Array(this.arrayBuffer,12,13),s=16909060===a[0];this.glType=s?this.switchEndainness(a[1]):a[1],this.glTypeSize=s?this.switchEndainness(a[2]):a[2],this.glFormat=s?this.switchEndainness(a[3]):a[3],this.glInternalFormat=s?this.switchEndainness(a[4]):a[4],this.glBaseInternalFormat=s?this.switchEndainness(a[5]):a[5],this.pixelWidth=s?this.switchEndainness(a[6]):a[6],this.pixelHeight=s?this.switchEndainness(a[7]):a[7],this.pixelDepth=s?this.switchEndainness(a[8]):a[8],this.numberOfArrayElements=s?this.switchEndainness(a[9]):a[9],this.numberOfFaces=s?this.switchEndainness(a[10]):a[10],this.numberOfMipmapLevels=s?this.switchEndainness(a[11]):a[11],this.bytesOfKeyValueData=s?this.switchEndainness(a[12]):a[12],0===this.glType?(this.numberOfMipmapLevels=Math.max(1,this.numberOfMipmapLevels),0!==this.pixelHeight&&0===this.pixelDepth?0===this.numberOfArrayElements?this.numberOfFaces===n?this.loadType=t.COMPRESSED_2D:console.warn("number of faces expected"+n+", but found "+this.numberOfFaces):console.warn("texture arrays not currently supported"):console.warn("only 2D textures currently supported")):console.warn("only compressed formats currently supported")}else console.error("texture missing KTX identifier")}return t.prototype.switchEndainness=function(t){return(255&t)<<24|(65280&t)<<8|t>>8&65280|t>>24&255},t.prototype.mipmaps=function(e){for(var n=[],r=t.HEADER_LEN+this.bytesOfKeyValueData,i=this.pixelWidth,o=this.pixelHeight,a=e?this.numberOfMipmapLevels:1,s=0;s<a;s++){for(var l=new Int32Array(this.arrayBuffer,r,1)[0],u=0;u<this.numberOfFaces;u++){var c=new Uint8Array(this.arrayBuffer,r+4,l);n.push({data:c,width:i,height:o}),r+=l+4,r+=3-(l+3)%4}i=Math.max(1,.5*i),o=Math.max(1,.5*o)}return n},t.HEADER_LEN=64,t.COMPRESSED_2D=0,t.COMPRESSED_3D=1,t.TEX_2D=2,t.TEX_3D=3,t}(),gu={};gu.Validator={isValid:function(t){return null!==t&&void 0!==t},verifyInput:function(t,e){return null===t||void 0===t?e:t}},gu.Callbacks=function(){function t(){this.onProgress=null,this.onMeshAlter=null,this.onLoad=null,this.onLoadMaterials=null}var e=gu.Validator;return t.prototype.setCallbackOnProgress=function(t){this.onProgress=e.verifyInput(t,this.onProgress)},t.prototype.setCallbackOnMeshAlter=function(t){this.onMeshAlter=e.verifyInput(t,this.onMeshAlter)},t.prototype.setCallbackOnLoad=function(t){this.onLoad=e.verifyInput(t,this.onLoad)},t.prototype.setCallbackOnLoadMaterials=function(t){this.onLoadMaterials=e.verifyInput(t,this.onLoadMaterials)},t}(),gu.LoadedMeshUserOverride=function(){function t(t,e){this.disregardMesh=!0===t,this.alteredMesh=!0===e,this.meshes=[]}return t.prototype.addMesh=function(t){this.meshes.push(t),this.alteredMesh=!0},t.prototype.isDisregardMesh=function(){return this.disregardMesh},t.prototype.providesAlteredMeshes=function(){return this.alteredMesh},t}(),gu.ResourceDescriptor=function(){function t(t,n){var r=t.split("/");r.length<2?(this.path=null,this.name=t,this.url=t):(this.path=e.verifyInput(r.slice(0,r.length-1).join("/")+"/",null),this.name=e.verifyInput(r[r.length-1],null),this.url=t),this.extension=e.verifyInput(n,"default"),this.extension=this.extension.trim(),this.content=null}var e=gu.Validator;return t.prototype.setContent=function(t){this.content=e.verifyInput(t,null)},t}(),gu.PrepData=function(){function t(t){this.logging={enabled:!0,debug:!1},this.modelName=e.verifyInput(t,""),this.resources=[],this.callbacks=new gu.Callbacks}var e=gu.Validator;return t.prototype.setLogging=function(t,e){this.logging.enabled=!0===t,this.logging.debug=!0===e},t.prototype.getCallbacks=function(){return this.callbacks},t.prototype.addResource=function(t){this.resources.push(t)},t.prototype.clone=function(){var t=new gu.PrepData(this.modelName);t.logging.enabled=this.logging.enabled,t.logging.debug=this.logging.debug,t.resources=this.resources,t.callbacks=this.callbacks;var e,n;for(e in this)n=this[e],t.hasOwnProperty(e)||"function"==typeof this[e]||(t[e]=n);return t},t.prototype.checkResourceDescriptorFiles=function(t,n){var r,i,o,a,s={};for(var l in t)if(r=t[l],a=!1,e.isValid(r.name))if(e.isValid(r.content)){for(o=0;o<n.length&&!a;o++)if(i=n[o],r.extension.toLowerCase()===i.ext.toLowerCase())if(i.ignore)a=!0;else if("ArrayBuffer"===i.type){if(!(r.content instanceof ArrayBuffer||r.content instanceof Uint8Array))throw"Provided content is not of type ArrayBuffer! Aborting...";s[i.ext]=r,a=!0}else if("String"===i.type){if(!("string"==typeof r.content||r.content instanceof String))throw"Provided  content is not of type String! Aborting...";s[i.ext]=r,a=!0}if(!a)throw'Unidentified resource "'+r.name+'": '+r.url}else{if(!("string"==typeof r.name||r.name instanceof String))throw"Provided file is not properly defined! Aborting...";for(o=0;o<n.length&&!a;o++)i=n[o],r.extension.toLowerCase()===i.ext.toLowerCase()&&(i.ignore||(s[i.ext]=r),a=!0);if(!a)throw'Unidentified resource "'+r.name+'": '+r.url}return s},t}(),gu.MeshBuilder=function(){function t(){console.info("Using LoaderSupport.MeshBuilder version: "+e),this.logging={enabled:!0,debug:!1},this.callbacks=new gu.Callbacks,this.materials=[]}var e="1.2.0",n=gu.Validator;return t.prototype.setLogging=function(t,e){this.logging.enabled=!0===t,this.logging.debug=!0===e},t.prototype.init=function(){var t=new St({color:14479871});t.name="defaultMaterial";var e=new St({color:14479871});e.name="defaultVertexColorMaterial",e.vertexColors=Bo;var n=new F;n.name="defaultLineMaterial";var r=new Tt({size:1});r.name="defaultPointMaterial";var i={};i[t.name]=t,i[e.name]=e,i[n.name]=n,i[r.name]=r,this.updateMaterials({cmd:"materialData",materials:{materialCloneInstructions:null,serializedMaterials:null,runtimeMaterials:i}})},t.prototype.setMaterials=function(t){var e={cmd:"materialData",materials:{materialCloneInstructions:null,serializedMaterials:null,runtimeMaterials:n.isValid(this.callbacks.onLoadMaterials)?this.callbacks.onLoadMaterials(t):t}};this.updateMaterials(e)},t.prototype._setCallbacks=function(t){n.isValid(t.onProgress)&&this.callbacks.setCallbackOnProgress(t.onProgress),n.isValid(t.onMeshAlter)&&this.callbacks.setCallbackOnMeshAlter(t.onMeshAlter),n.isValid(t.onLoad)&&this.callbacks.setCallbackOnLoad(t.onLoad),n.isValid(t.onLoadMaterials)&&this.callbacks.setCallbackOnLoadMaterials(t.onLoadMaterials)},t.prototype.processPayload=function(t){return"meshData"===t.cmd?this.buildMeshes(t):"materialData"===t.cmd?(this.updateMaterials(t),null):void 0},t.prototype.buildMeshes=function(t){var e=t.params.meshName,r=new O;r.addAttribute("position",new y(new Float32Array(t.buffers.vertices),3)),n.isValid(t.buffers.indices)&&r.setIndex(new y(new Uint32Array(t.buffers.indices),1));n.isValid(t.buffers.colors)&&r.addAttribute("color",new y(new Float32Array(t.buffers.colors),3)),n.isValid(t.buffers.normals)?r.addAttribute("normal",new y(new Float32Array(t.buffers.normals),3)):r.computeVertexNormals(),n.isValid(t.buffers.uvs)&&r.addAttribute("uv",new y(new Float32Array(t.buffers.uvs),2));var i,o,a=t.materials.materialNames,s=t.materials.multiMaterial,l=[];for(o in a)i=this.materials[a[o]],s&&l.push(i);if(s){i=l;var u,c=t.materials.materialGroups;for(o in c)r.addGroup((u=c[o]).start,u.count,u.index)}var h,p,d=[],f=this.callbacks.onMeshAlter,m=!0,v=n.verifyInput(t.geometryType,0);if(n.isValid(f)&&(p=f({detail:{meshName:e,bufferGeometry:r,material:i,geometryType:v}}),n.isValid(p))){if(!p.isDisregardMesh()&&p.providesAlteredMeshes())for(var g in p.meshes)d.push(p.meshes[g]);m=!1}m&&(t.computeBoundingSphere&&r.computeBoundingSphere(),(h=0===v?new B(r,i):1===v?new je(r,i):new be(r,i)).name=e,d.push(h));var b;if(n.isValid(d)&&d.length>0){var _=[];for(var g in d)_[g]=(h=d[g]).name;b="Adding mesh(es) ("+_.length+": "+_+") from input mesh: "+e,b+=" ("+(100*t.progress.numericalValue).toFixed(2)+"%)"}else b="Not adding mesh: "+e,b+=" ("+(100*t.progress.numericalValue).toFixed(2)+"%)";var x=this.callbacks.onProgress;if(n.isValid(x)){x(new CustomEvent("MeshBuilderEvent",{detail:{type:"progress",modelName:t.params.meshName,text:b,numericalValue:t.progress.numericalValue}}))}return d},t.prototype.updateMaterials=function(t){var e,r,i=t.materials.materialCloneInstructions;if(n.isValid(i)){var o=i.materialNameOrg,a=this.materials[o];if(n.isValid(o)){(e=a.clone()).name=r=i.materialName;var s=i.materialProperties;for(var l in s)e.hasOwnProperty(l)&&s.hasOwnProperty(l)&&(e[l]=s[l]);this.materials[r]=e}else console.warn('Requested material "'+o+'" is not available!')}var u=t.materials.serializedMaterials;if(n.isValid(u)&&Object.keys(u).length>0){var c,h=new Ot;for(r in u)n.isValid(c=u[r])&&(e=h.parse(c),this.logging.enabled&&console.info('De-serialized material with name "'+r+'" will be added.'),this.materials[r]=e)}if(u=t.materials.runtimeMaterials,n.isValid(u)&&Object.keys(u).length>0)for(r in u)e=u[r],this.logging.enabled&&console.info('Material with name "'+r+'" will be added.'),this.materials[r]=e},t.prototype.getMaterialsJSON=function(){var t={};for(var e in this.materials)t[e]=this.materials[e].toJSON();return t},t.prototype.getMaterials=function(){return this.materials},t}(),gu.WorkerRunnerRefImpl=function(){function t(){var t=this;self.addEventListener("message",function(e){t.processMessage(e.data)},!1)}return t.prototype.applyProperties=function(t,e){var n,r,i;for(n in e)r="set"+n.substring(0,1).toLocaleUpperCase()+n.substring(1),i=e[n],"function"==typeof t[r]?t[r](i):t.hasOwnProperty(n)&&(t[n]=i)},t.prototype.processMessage=function(t){if("run"===t.cmd){var e={callbackMeshBuilder:function(t){self.postMessage(t)},callbackProgress:function(e){t.logging.enabled&&t.logging.debug&&console.debug("WorkerRunner: progress: "+e)}},n=new Parser;"function"==typeof n.setLogging&&n.setLogging(t.logging.enabled,t.logging.debug),this.applyProperties(n,t.params),this.applyProperties(n,t.materials),this.applyProperties(n,e),n.workerScope=self,n.parse(t.data.input,t.data.options),t.logging.enabled&&console.log("WorkerRunner: Run complete!"),e.callbackMeshBuilder({cmd:"complete",msg:"WorkerRunner completed run."})}else console.error("WorkerRunner: Received unknown command: "+t.cmd)},t}(),gu.WorkerSupport=function(){function t(){if(console.info("Using LoaderSupport.WorkerSupport version: "+e),this.logging={enabled:!0,debug:!1},void 0===window.Worker)throw"This browser does not support web workers!";if(void 0===window.Blob)throw"This browser does not support Blob!";if("function"!=typeof window.URL.createObjectURL)throw"This browser does not support Object creation from URL!";this.loaderWorker=new r}var e="2.2.0",n=gu.Validator,r=function(){function t(){this._reset()}return t.prototype._reset=function(){this.logging={enabled:!0,debug:!1},this.worker=null,this.runnerImplName=null,this.callbacks={meshBuilder:null,onLoad:null},this.terminateRequested=!1,this.queuedMessage=null,this.started=!1,this.forceCopy=!1},t.prototype.setLogging=function(t,e){this.logging.enabled=!0===t,this.logging.debug=!0===e},t.prototype.setForceCopy=function(t){this.forceCopy=!0===t},t.prototype.initWorker=function(t,e){this.runnerImplName=e;var n=new Blob([t],{type:"application/javascript"});this.worker=new Worker(window.URL.createObjectURL(n)),this.worker.onmessage=this._receiveWorkerMessage,this.worker.runtimeRef=this,this._postMessage()},t.prototype._receiveWorkerMessage=function(t){var e=t.data;switch(e.cmd){case"meshData":case"materialData":case"imageData":this.runtimeRef.callbacks.meshBuilder(e);break;case"complete":this.runtimeRef.queuedMessage=null,this.started=!1,this.runtimeRef.callbacks.onLoad(e.msg),this.runtimeRef.terminateRequested&&(this.runtimeRef.logging.enabled&&console.info("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Run is complete. Terminating application on request!"),this.runtimeRef._terminate());break;case"error":console.error("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Reported error: "+e.msg),this.runtimeRef.queuedMessage=null,this.started=!1,this.runtimeRef.callbacks.onLoad(e.msg),this.runtimeRef.terminateRequested&&(this.runtimeRef.logging.enabled&&console.info("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Run reported error. Terminating application on request!"),this.runtimeRef._terminate());break;default:console.error("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Received unknown command: "+e.cmd)}},t.prototype.setCallbacks=function(t,e){this.callbacks.meshBuilder=n.verifyInput(t,this.callbacks.meshBuilder),this.callbacks.onLoad=n.verifyInput(e,this.callbacks.onLoad)},t.prototype.run=function(t){if(n.isValid(this.queuedMessage))console.warn("Already processing message. Rejecting new run instruction");else{if(this.queuedMessage=t,this.started=!0,!n.isValid(this.callbacks.meshBuilder))throw'Unable to run as no "MeshBuilder" callback is set.';if(!n.isValid(this.callbacks.onLoad))throw'Unable to run as no "onLoad" callback is set.';"run"!==t.cmd&&(t.cmd="run"),n.isValid(t.logging)?(t.logging.enabled=!0===t.logging.enabled,t.logging.debug=!0===t.logging.debug):t.logging={enabled:!0,debug:!1},this._postMessage()}},t.prototype._postMessage=function(){if(n.isValid(this.queuedMessage)&&n.isValid(this.worker))if(this.queuedMessage.data.input instanceof ArrayBuffer){var t;t=this.forceCopy?this.queuedMessage.data.input.slice(0):this.queuedMessage.data.input,this.worker.postMessage(this.queuedMessage,[t])}else this.worker.postMessage(this.queuedMessage)},t.prototype.setTerminateRequested=function(t){this.terminateRequested=!0===t,this.terminateRequested&&n.isValid(this.worker)&&!n.isValid(this.queuedMessage)&&this.started&&(this.logging.enabled&&console.info("Worker is terminated immediately as it is not running!"),this._terminate())},t.prototype._terminate=function(){this.worker.terminate(),this._reset()},t}();t.prototype.setLogging=function(t,e){this.logging.enabled=!0===t,this.logging.debug=!0===e,this.loaderWorker.setLogging(this.logging.enabled,this.logging.debug)},t.prototype.setForceWorkerDataCopy=function(t){this.loaderWorker.setForceCopy(t)},t.prototype.validate=function(t,e,r,a,s){if(!n.isValid(this.loaderWorker.worker)){this.logging.enabled&&(console.info("WorkerSupport: Building worker code..."),console.time("buildWebWorkerCode")),n.isValid(s)?this.logging.enabled&&console.info('WorkerSupport: Using "'+s.name+'" as Runner class for worker.'):(s=gu.WorkerRunnerRefImpl,this.logging.enabled&&console.info('WorkerSupport: Using DEFAULT "LoaderSupport.WorkerRunnerRefImpl" as Runner class for worker.'));var l=t(i,o);l+="var Parser = "+e+";\n\n",l+=o(s.name,s),l+="new "+s.name+"();\n\n";var u=this;if(n.isValid(r)&&r.length>0){var c="",h=function(t,e){if(0===e.length)u.loaderWorker.initWorker(c+l,s.name),u.logging.enabled&&console.timeEnd("buildWebWorkerCode");else{var n=function(n){c+=n,h(t,e)},r=new gt;r.setPath(t),r.setResponseType("text"),r.load(e[0],n),e.shift()}};h(a,r)}else this.loaderWorker.initWorker(l,s.name),this.logging.enabled&&console.timeEnd("buildWebWorkerCode")}},t.prototype.setCallbacks=function(t,e){this.loaderWorker.setCallbacks(t,e)},t.prototype.run=function(t){this.loaderWorker.run(t)},t.prototype.setTerminateRequested=function(t){this.loaderWorker.setTerminateRequested(t)};var i=function(t,e){var n,r=t+" = {\n";for(var i in e)"string"==typeof(n=e[i])||n instanceof String?r+="\t"+i+': "'+(n=(n=n.replace("\n","\\n")).replace("\r","\\r"))+'",\n':n instanceof Array?r+="\t"+i+": ["+n+"],\n":Number.isInteger(n)?r+="\t"+i+": "+n+",\n":"function"==typeof n&&(r+="\t"+i+": "+n+",\n");return r+="}\n\n"},o=function(t,e,r,i,o){var a,s,l="",u=n.isValid(r)?r:e.name;o=n.verifyInput(o,[]);for(var c in e.prototype)a=e.prototype[c],"constructor"===c?s="\tfunction "+u+a.toString().replace("function","")+";\n\n":"function"==typeof a&&o.indexOf(c)<0&&(l+="\t"+u+".prototype."+c+" = "+a.toString()+";\n\n");l+="\treturn "+u+";\n",l+="})();\n\n";var h="";return n.isValid(i)&&(h+="\n",h+=u+".prototype = Object.create( "+i+".prototype );\n",h+=u+".constructor = "+u+";\n",h+="\n"),n.isValid(s)?l=t+" = (function () {\n\n"+h+s+l:(s=t+" = (function () {\n\n",l=(s+=h+"\t"+e.prototype.constructor.toString()+"\n\n")+l),l};return t}(),gu.WorkerDirector=function(){function t(t){if(console.info("Using LoaderSupport.WorkerDirector version: "+e),this.logging={enabled:!0,debug:!1},this.maxQueueSize=i,this.maxWebWorkers=r,this.crossOrigin=null,!n.isValid(t))throw"Provided invalid classDef: "+t;this.workerDescription={classDef:t,globalCallbacks:{},workerSupports:{},forceWorkerDataCopy:!0},this.objectsCompleted=0,this.instructionQueue=[],this.instructionQueuePointer=0,this.callbackOnFinishedProcessing=null}var e="2.2.0",n=gu.Validator,r=16,i=8192;return t.prototype.setLogging=function(t,e){this.logging.enabled=!0===t,this.logging.debug=!0===e},t.prototype.getMaxQueueSize=function(){return this.maxQueueSize},t.prototype.getMaxWebWorkers=function(){return this.maxWebWorkers},t.prototype.setCrossOrigin=function(t){this.crossOrigin=t},t.prototype.setForceWorkerDataCopy=function(t){this.workerDescription.forceWorkerDataCopy=!0===t},t.prototype.prepareWorkers=function(t,e,o){n.isValid(t)&&(this.workerDescription.globalCallbacks=t),this.maxQueueSize=Math.min(e,i),this.maxWebWorkers=Math.min(o,r),this.maxWebWorkers=Math.min(this.maxWebWorkers,this.maxQueueSize),this.objectsCompleted=0,this.instructionQueue=[],this.instructionQueuePointer=0;for(var a=0;a<this.maxWebWorkers;a++){var s=new gu.WorkerSupport;s.setLogging(this.logging.enabled,this.logging.debug),s.setForceWorkerDataCopy(this.workerDescription.forceWorkerDataCopy),this.workerDescription.workerSupports[a]={instanceNo:a,inUse:!1,terminateRequested:!1,workerSupport:s,loader:null}}},t.prototype.enqueueForRun=function(t){this.instructionQueue.length<this.maxQueueSize&&this.instructionQueue.push(t)},t.prototype.isRunning=function(){var t=Object.keys(this.workerDescription.workerSupports);return this.instructionQueue.length>0&&this.instructionQueuePointer<this.instructionQueue.length||t.length>0},t.prototype.processQueue=function(){var t;for(var e in this.workerDescription.workerSupports)(t=this.workerDescription.workerSupports[e]).inUse||(this.instructionQueuePointer<this.instructionQueue.length?(this._kickWorkerRun(this.instructionQueue[this.instructionQueuePointer],t),this.instructionQueuePointer++):this._deregister(t));this.isRunning()||null===this.callbackOnFinishedProcessing||(this.callbackOnFinishedProcessing(),this.callbackOnFinishedProcessing=null)},t.prototype._kickWorkerRun=function(t,e){e.inUse=!0,e.workerSupport.setTerminateRequested(e.terminateRequested),this.logging.enabled&&console.info("\nAssigning next item from queue to worker (queue length: "+this.instructionQueue.length+")\n\n");var r=this,i=t.getCallbacks(),o=this.workerDescription.globalCallbacks;e.loader=this._buildLoader(e.instanceNo);var a=new gu.Callbacks;a.setCallbackOnLoad(function(t){n.isValid(o.onLoad)&&o.onLoad(t),n.isValid(i.onLoad)&&i.onLoad(t),r.objectsCompleted++,e.inUse=!1,r.processQueue()}),a.setCallbackOnProgress(function(t){n.isValid(o.onProgress)&&o.onProgress(t),n.isValid(i.onProgress)&&i.onProgress(t)}),a.setCallbackOnMeshAlter(function(t){n.isValid(o.onMeshAlter)&&o.onMeshAlter(t),n.isValid(i.onMeshAlter)&&i.onMeshAlter(t)}),t.callbacks=a,e.loader.run(t,e.workerSupport)},t.prototype._buildLoader=function(t){var e=this.workerDescription.classDef,r=Object.create(e.prototype);if(e.call(r,il),!r.hasOwnProperty("instanceNo"))throw e.name+' has no property "instanceNo".';if(r.instanceNo=t,!r.hasOwnProperty("workerSupport"))throw e.name+' has no property "workerSupport".';if("function"!=typeof r.run)throw e.name+' has no function "run".';return r.hasOwnProperty("callbacks")&&n.isValid(r.callbacks)||(console.warn(e.name+' has an invalid property "callbacks". Will change to "LoaderSupport.Callbacks"'),r.callbacks=new gu.Callbacks),r},t.prototype._deregister=function(t){if(n.isValid(t)){t.workerSupport.setTerminateRequested(!0),this.logging.enabled&&console.info("Requested termination of worker #"+t.instanceNo+".");var e=t.loader.callbacks;n.isValid(e.onProgress)&&e.onProgress({detail:{text:""}}),delete this.workerDescription.workerSupports[t.instanceNo]}},t.prototype.tearDown=function(t){this.logging.enabled&&console.info("WorkerDirector received the deregister call. Terminating all workers!"),this.instructionQueuePointer=this.instructionQueue.length,this.callbackOnFinishedProcessing=n.verifyInput(t,null);for(var e in this.workerDescription.workerSupports)this.workerDescription.workerSupports[e].terminateRequested=!0},t}();var yu=function(t){this.manager=void 0!==t?t:il};yu.prototype={constructor:yu,load:function(t,e,n,r){var i=this,o=new gt(i.manager);o.setResponseType("arraybuffer"),o.load(t,function(t){e(i.parse(t))},n,r)},parse:function(){var t=[[-.525731,0,.850651],[-.442863,.238856,.864188],[-.295242,0,.955423],[-.309017,.5,.809017],[-.16246,.262866,.951056],[0,0,1],[0,.850651,.525731],[-.147621,.716567,.681718],[.147621,.716567,.681718],[0,.525731,.850651],[.309017,.5,.809017],[.525731,0,.850651],[.295242,0,.955423],[.442863,.238856,.864188],[.16246,.262866,.951056],[-.681718,.147621,.716567],[-.809017,.309017,.5],[-.587785,.425325,.688191],[-.850651,.525731,0],[-.864188,.442863,.238856],[-.716567,.681718,.147621],[-.688191,.587785,.425325],[-.5,.809017,.309017],[-.238856,.864188,.442863],[-.425325,.688191,.587785],[-.716567,.681718,-.147621],[-.5,.809017,-.309017],[-.525731,.850651,0],[0,.850651,-.525731],[-.238856,.864188,-.442863],[0,.955423,-.295242],[-.262866,.951056,-.16246],[0,1,0],[0,.955423,.295242],[-.262866,.951056,.16246],[.238856,.864188,.442863],[.262866,.951056,.16246],[.5,.809017,.309017],[.238856,.864188,-.442863],[.262866,.951056,-.16246],[.5,.809017,-.309017],[.850651,.525731,0],[.716567,.681718,.147621],[.716567,.681718,-.147621],[.525731,.850651,0],[.425325,.688191,.587785],[.864188,.442863,.238856],[.688191,.587785,.425325],[.809017,.309017,.5],[.681718,.147621,.716567],[.587785,.425325,.688191],[.955423,.295242,0],[1,0,0],[.951056,.16246,.262866],[.850651,-.525731,0],[.955423,-.295242,0],[.864188,-.442863,.238856],[.951056,-.16246,.262866],[.809017,-.309017,.5],[.681718,-.147621,.716567],[.850651,0,.525731],[.864188,.442863,-.238856],[.809017,.309017,-.5],[.951056,.16246,-.262866],[.525731,0,-.850651],[.681718,.147621,-.716567],[.681718,-.147621,-.716567],[.850651,0,-.525731],[.809017,-.309017,-.5],[.864188,-.442863,-.238856],[.951056,-.16246,-.262866],[.147621,.716567,-.681718],[.309017,.5,-.809017],[.425325,.688191,-.587785],[.442863,.238856,-.864188],[.587785,.425325,-.688191],[.688191,.587785,-.425325],[-.147621,.716567,-.681718],[-.309017,.5,-.809017],[0,.525731,-.850651],[-.525731,0,-.850651],[-.442863,.238856,-.864188],[-.295242,0,-.955423],[-.16246,.262866,-.951056],[0,0,-1],[.295242,0,-.955423],[.16246,.262866,-.951056],[-.442863,-.238856,-.864188],[-.309017,-.5,-.809017],[-.16246,-.262866,-.951056],[0,-.850651,-.525731],[-.147621,-.716567,-.681718],[.147621,-.716567,-.681718],[0,-.525731,-.850651],[.309017,-.5,-.809017],[.442863,-.238856,-.864188],[.16246,-.262866,-.951056],[.238856,-.864188,-.442863],[.5,-.809017,-.309017],[.425325,-.688191,-.587785],[.716567,-.681718,-.147621],[.688191,-.587785,-.425325],[.587785,-.425325,-.688191],[0,-.955423,-.295242],[0,-1,0],[.262866,-.951056,-.16246],[0,-.850651,.525731],[0,-.955423,.295242],[.238856,-.864188,.442863],[.262866,-.951056,.16246],[.5,-.809017,.309017],[.716567,-.681718,.147621],[.525731,-.850651,0],[-.238856,-.864188,-.442863],[-.5,-.809017,-.309017],[-.262866,-.951056,-.16246],[-.850651,-.525731,0],[-.716567,-.681718,-.147621],[-.716567,-.681718,.147621],[-.525731,-.850651,0],[-.5,-.809017,.309017],[-.238856,-.864188,.442863],[-.262866,-.951056,.16246],[-.864188,-.442863,.238856],[-.809017,-.309017,.5],[-.688191,-.587785,.425325],[-.681718,-.147621,.716567],[-.442863,-.238856,.864188],[-.587785,-.425325,.688191],[-.309017,-.5,.809017],[-.147621,-.716567,.681718],[-.425325,-.688191,.587785],[-.16246,-.262866,.951056],[.442863,-.238856,.864188],[.16246,-.262866,.951056],[.309017,-.5,.809017],[.147621,-.716567,.681718],[0,-.525731,.850651],[.425325,-.688191,.587785],[.587785,-.425325,.688191],[.688191,-.587785,.425325],[-.955423,.295242,0],[-.951056,.16246,.262866],[-1,0,0],[-.850651,0,.525731],[-.955423,-.295242,0],[-.951056,-.16246,.262866],[-.864188,.442863,-.238856],[-.951056,.16246,-.262866],[-.809017,.309017,-.5],[-.864188,-.442863,-.238856],[-.951056,-.16246,-.262866],[-.809017,-.309017,-.5],[-.681718,.147621,-.716567],[-.681718,-.147621,-.716567],[-.850651,0,-.525731],[-.688191,.587785,-.425325],[-.587785,.425325,-.688191],[-.425325,.688191,-.587785],[-.425325,-.688191,-.587785],[-.587785,-.425325,-.688191],[-.688191,-.587785,-.425325]];return function(e){console.time("MD2Loader");for(var n=new DataView(e),r={},o=["ident","version","skinwidth","skinheight","framesize","num_skins","num_vertices","num_st","num_tris","num_glcmds","num_frames","offset_skins","offset_st","offset_tris","offset_frames","offset_glcmds","offset_end"],a=0;a<o.length;a++)r[o[a]]=n.getInt32(4*a,!0);if(844121161===r.ident&&8===r.version){if(r.offset_end===n.byteLength){for(var s=new v,l=[],u=r.offset_st,c=(a=0,r.num_st);a<c;a++){var h=n.getInt16(u+0,!0),d=n.getInt16(u+2,!0);l.push(new m(h/r.skinwidth,1-d/r.skinheight)),u+=4}for(u=r.offset_tris,a=0,c=r.num_tris;a<c;a++){var f=n.getUint16(u+0,!0),g=n.getUint16(u+2,!0),y=n.getUint16(u+4,!0);s.faces.push(new p(f,g,y)),s.faceVertexUvs[0].push([l[n.getUint16(u+6,!0)],l[n.getUint16(u+8,!0)],l[n.getUint16(u+10,!0)]]),u+=12}var b=new i,_=new i,x=[];for(u=r.offset_frames,a=0,c=r.num_frames;a<c;a++){_.set(n.getFloat32(u+0,!0),n.getFloat32(u+4,!0),n.getFloat32(u+8,!0)),b.set(n.getFloat32(u+12,!0),n.getFloat32(u+16,!0),n.getFloat32(u+20,!0)),u+=24;for(var w=0;w<16;w++){var S=n.getUint8(u+w,!0);if(0===S)break;x[w]=S}var A={name:String.fromCharCode.apply(null,x),vertices:[],normals:[]};u+=16;for(w=0;w<r.num_vertices;w++){var M=n.getUint8(u++,!0),T=n.getUint8(u++,!0),C=n.getUint8(u++,!0),E=t[n.getUint8(u++,!0)],P=new i(M*_.x+b.x,C*_.z+b.z,T*_.y+b.y),O=new i(E[0],E[2],E[1]);A.vertices.push(P),A.normals.push(O)}s.morphTargets.push(A)}s.vertices=s.morphTargets[0].vertices;for(var N=s.morphTargets[0],L=(w=0,s.faces.length);w<L;w++){(D=s.faces[w]).vertexNormals=[N.normals[D.a],N.normals[D.b],N.normals[D.c]]}for(a=0,c=s.morphTargets.length;a<c;a++){N=s.morphTargets[a];var I=[];for(w=0,L=s.faces.length;w<L;w++){var D;I.push({a:N.normals[(D=s.faces[w]).a],b:N.normals[D.b],c:N.normals[D.c]})}s.morphNormals.push({vertexNormals:I})}return s.animations=ot.CreateClipsFromMorphTargetSequences(s.morphTargets,10),console.timeEnd("MD2Loader"),s}console.error("Corrupted MD2 file")}else console.error("Not a valid MD2 file")}}()};var bu,_u={getContext:function(){return void 0===bu&&(bu=new(window.AudioContext||window.webkitAudioContext)),bu},setContext:function(t){bu=t}};pn.prototype=Object.assign(Object.create(c.prototype),{constructor:pn,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){this.gain.gain.value=t},updateMatrixWorld:function(){var t=new i,e=new o,n=new i,r=new i;return function(i){c.prototype.updateMatrixWorld.call(this,i);var o=this.context.listener,a=this.up;this.matrixWorld.decompose(t,e,n),r.set(0,0,-1).applyQuaternion(e),o.positionX?(o.positionX.setValueAtTime(t.x,this.context.currentTime),o.positionY.setValueAtTime(t.y,this.context.currentTime),o.positionZ.setValueAtTime(t.z,this.context.currentTime),o.forwardX.setValueAtTime(r.x,this.context.currentTime),o.forwardY.setValueAtTime(r.y,this.context.currentTime),o.forwardZ.setValueAtTime(r.z,this.context.currentTime),o.upX.setValueAtTime(a.x,this.context.currentTime),o.upY.setValueAtTime(a.y,this.context.currentTime),o.upZ.setValueAtTime(a.z,this.context.currentTime)):(o.setPosition(t.x,t.y,t.z),o.setOrientation(r.x,r.y,r.z,a.x,a.y,a.z))}}()}),dn.prototype=Object.assign(Object.create(c.prototype),{constructor:dn,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.onended=this.onEnded.bind(this),t.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,t.start(this.startTime,this.offset),this.isPlaying=!0,this.source=t,this.connect()}console.warn("Audio: this Audio has no playback control.")}else console.warn("Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.offset=0,this.isPlaying=!1,this;console.warn("Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.value=t,this}}),Object.assign(fn.prototype,{load:function(t,e,n,r){var i=new gt(this.manager);i.setResponseType("arraybuffer"),i.load(t,function(t){_u.getContext().decodeAudioData(t,function(t){e(t)})},n,r)}});var xu=function(t){this.manager=void 0!==t?t:il};xu.prototype={constructor:xu,load:function(t,e,n,r){var i=this,o=new ht,a=new gt(this.manager);return a.setResponseType("arraybuffer"),a.load(t,function(t){o.image=i.parse(t),o.needsUpdate=!0,void 0!==e&&e(o)},n,r),o},parse:function(t){var e=0,n=1,r=2,i=3,o=9,a=10,s=11,l=48,u=4,c=0,h=1,p=2,d=3;t.length<19&&console.error("TGALoader: Not enough data to contain header.");var f=new Uint8Array(t),m=0,v={id_length:f[m++],colormap_type:f[m++],image_type:f[m++],colormap_index:f[m++]|f[m++]<<8,colormap_length:f[m++]|f[m++]<<8,colormap_size:f[m++],origin:[f[m++]|f[m++]<<8,f[m++]|f[m++]<<8],width:f[m++]|f[m++]<<8,height:f[m++]|f[m++]<<8,pixel_size:f[m++],flags:f[m++]};!function(t){switch(t.image_type){case n:case o:(t.colormap_length>256||24!==t.colormap_size||1!==t.colormap_type)&&console.error("TGALoader: Invalid type colormap data for indexed type.");break;case r:case i:case a:case s:t.colormap_type&&console.error("TGALoader: Invalid type colormap data for colormap type.");break;case e:console.error("TGALoader: No data.");default:console.error('TGALoader: Invalid type "%s".',t.image_type)}(t.width<=0||t.height<=0)&&console.error("TGALoader: Invalid image size."),8!==t.pixel_size&&16!==t.pixel_size&&24!==t.pixel_size&&32!==t.pixel_size&&console.error('TGALoader: Invalid pixel size "%s".',t.pixel_size)}(v),v.id_length+m>t.length&&console.error("TGALoader: No data."),m+=v.id_length;var g=!1,y=!1,b=!1;switch(v.image_type){case o:g=!0,y=!0;break;case n:y=!0;break;case a:g=!0;break;case r:break;case s:g=!0,b=!0;break;case i:b=!0}var _=document.createElement("canvas");_.width=v.width,_.height=v.height;var x=_.getContext("2d"),w=x.createImageData(v.width,v.height),S=function(t,e,n,r,i){var o,a,s,l;if(a=n.pixel_size>>3,s=n.width*n.height*a,e&&(l=i.subarray(r,r+=n.colormap_length*(n.colormap_size>>3))),t){o=new Uint8Array(s);for(var u,c,h,p=0,d=new Uint8Array(a);p<s;)if(u=i[r++],c=1+(127&u),128&u){for(h=0;h<a;++h)d[h]=i[r++];for(h=0;h<c;++h)o.set(d,p+h*a);p+=a*c}else{for(c*=a,h=0;h<c;++h)o[p+h]=i[r++];p+=c}}else o=i.subarray(r,r+=e?n.width*n.height:s);return{pixel_data:o,palettes:l}}(g,y,v,m,f);!function(t,e,n,r,i){var o,a,s,f,m,g;switch((v.flags&l)>>u){default:case p:o=0,s=1,m=e,a=0,f=1,g=n;break;case c:o=0,s=1,m=e,a=n-1,f=-1,g=-1;break;case d:o=e-1,s=-1,m=-1,a=0,f=1,g=n;break;case h:o=e-1,s=-1,m=-1,a=n-1,f=-1,g=-1}if(b)switch(v.pixel_size){case 8:!function(t,e,n,r,i,o,a,s){var l,u,c,h=0,p=v.width;for(c=e;c!==r;c+=n)for(u=i;u!==a;u+=o,h++)t[4*(u+p*c)+0]=l=s[h],t[4*(u+p*c)+1]=l,t[4*(u+p*c)+2]=l,t[4*(u+p*c)+3]=255}(t,a,f,g,o,s,m,r);break;case 16:!function(t,e,n,r,i,o,a,s){var l,u,c=0,h=v.width;for(u=e;u!==r;u+=n)for(l=i;l!==a;l+=o,c+=2)t[4*(l+h*u)+0]=s[c+0],t[4*(l+h*u)+1]=s[c+0],t[4*(l+h*u)+2]=s[c+0],t[4*(l+h*u)+3]=s[c+1]}(t,a,f,g,o,s,m,r);break;default:console.error("TGALoader: Format not supported.")}else switch(v.pixel_size){case 8:!function(t,e,n,r,i,o,a,s,l){var u,c,h,p=l,d=0,f=v.width;for(h=e;h!==r;h+=n)for(c=i;c!==a;c+=o,d++)u=s[d],t[4*(c+f*h)+3]=255,t[4*(c+f*h)+2]=p[3*u+0],t[4*(c+f*h)+1]=p[3*u+1],t[4*(c+f*h)+0]=p[3*u+2]}(t,a,f,g,o,s,m,r,i);break;case 16:!function(t,e,n,r,i,o,a,s){var l,u,c,h=0,p=v.width;for(c=e;c!==r;c+=n)for(u=i;u!==a;u+=o,h+=2)t[4*(u+p*c)+0]=(31744&(l=s[h+0]+(s[h+1]<<8)))>>7,t[4*(u+p*c)+1]=(992&l)>>2,t[4*(u+p*c)+2]=(31&l)>>3,t[4*(u+p*c)+3]=32768&l?0:255}(t,a,f,g,o,s,m,r);break;case 24:!function(t,e,n,r,i,o,a,s){var l,u,c=0,h=v.width;for(u=e;u!==r;u+=n)for(l=i;l!==a;l+=o,c+=3)t[4*(l+h*u)+3]=255,t[4*(l+h*u)+2]=s[c+0],t[4*(l+h*u)+1]=s[c+1],t[4*(l+h*u)+0]=s[c+2]}(t,a,f,g,o,s,m,r);break;case 32:!function(t,e,n,r,i,o,a,s){var l,u,c=0,h=v.width;for(u=e;u!==r;u+=n)for(l=i;l!==a;l+=o,c+=4)t[4*(l+h*u)+2]=s[c+0],t[4*(l+h*u)+1]=s[c+1],t[4*(l+h*u)+0]=s[c+2],t[4*(l+h*u)+3]=s[c+3]}(t,a,f,g,o,s,m,r);break;default:console.error("TGALoader: Format not supported.")}}(w.data,v.width,v.height,S.pixel_data,S.palettes);return x.putImageData(w,0,0),_}},Object.assign(mn.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){var r=this._clip.duration,i=t._clip.duration,o=r/i;t.warp(1,i/r,e),this.warp(o,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var r=this._mixer,i=r.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,l=o.sampleValues;return s[0]=i,s[1]=i+n,l[0]=t/a,l[1]=e/a,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var o=(t-i)*n;if(o<0||0===n)return;this._startTime=null,e=n*o}e*=this._updateTimeScale(t);var a=this._updateTime(e),s=this._updateWeight(t);if(s>0)for(var l=this._interpolants,u=this._propertyBindings,c=0,h=l.length;c!==h;++c)l[c].evaluate(a),u[c].accumulate(r,s)}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n){e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var n=this._clip.duration,r=this.loop,i=this._loopCount;if(2200===r){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=n)e=n;else{if(!(e<0))break t;e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{var o=2202===r;if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),e>=n||e<0){var a=Math.floor(e/n);e-=n*a,i+=Math.abs(a);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===s){var l=t<0;this._setEndings(l,!l,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}if(o&&1==(1&i))return this.time=e,n-e}return this.time=e,e},_setEndings:function(t,e,n){var r=this._interpolantSettings;n?(r.endingStart=2401,r.endingEnd=2401):(r.endingStart=t?this.zeroSlopeAtStart?2401:Is:2402,r.endingEnd=e?this.zeroSlopeAtEnd?2401:Is:2402)},_scheduleFading:function(t,e,n){var r=this._mixer,i=r.time,o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=e,a[1]=i+t,s[1]=n,this}}),Object.assign(vn.prototype,{accumulate:function(t,e){var n=this.buffer,r=this.valueSize,i=t*r+r,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==r;++a)n[i+a]=n[a];o=e}else{this._mixBufferRegion(n,i,0,e/(o+=e),r)}this.cumulativeWeight=o},apply:function(t){var e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,i<1){this._mixBufferRegion(n,r,3*e,1-i,e)}for(var a=e,s=e+e;a!==s;++a)if(n[a]!==n[a+e]){o.setValue(n,r);break}},saveOriginalState:function(){var t=this.buffer,e=this.valueSize,n=3*e;this.binding.getValue(t,n);for(var r=e,i=n;r!==i;++r)t[r]=t[n+r%e];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_select:function(t,e,n,r,i){if(r>=.5)for(var o=0;o!==i;++o)t[e+o]=t[n+o]},_slerp:function(t,e,n,r){o.slerpFlat(t,e,t,e,t,n,r)},_lerp:function(t,e,n,r,i){for(var o=1-r,a=0;a!==i;++a){var s=e+a;t[s]=t[s]*o+t[n+a]*r}}}),gn.prototype=Object.assign(Object.create(a.prototype),{constructor:gn,_bindAction:function(t,e){var n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,o=t._propertyBindings,a=t._interpolants,s=n.uuid,l=this._bindingsByRootAndName,u=l[s];void 0===u&&(l[s]=u={});for(var c=0;c!==i;++c){var h=r[c],p=h.name,d=u[p];if(void 0!==d)o[c]=d;else{if(void 0!==(d=o[c])){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,s,p));continue}++(d=new vn(me.create(n,p,e&&e._propertyBindings[c].binding.parsedPath),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(d,s,p),o[c]=d}a[c].resultBuffer=d.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}for(var i=t._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){var r=this._actions,i=this._actionsByClip,o=i[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=o;else{var a=o.knownActions;t._byClipCacheIndex=a.length,a.push(t)}t._cacheIndex=r.length,r.push(t),o.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;var i=t._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,l=s[s.length-1],u=t._byClipCacheIndex;l._byClipCacheIndex=u,s[u]=l,s.pop(),t._byClipCacheIndex=null;delete a.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_addInactiveBinding:function(t,e,n){var r=this._bindingsByRootAndName,i=r[e],o=this._bindings;void 0===i&&(r[e]=i={}),i[n]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,a=o[r],s=e[e.length-1],l=t._cacheIndex;s._cacheIndex=l,e[l]=s,e.pop(),delete a[i];t:{for(var u in a)break t;delete o[r]}},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&((n=new et(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?ot.findByName(n,t):t,o=null!==i?i.uuid:t,a=this._actionsByClip[o],s=null;if(void 0!==a){var l=a.actionByRoot[r];if(void 0!==l)return l;s=a.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var u=new mn(this,i,e);return this._bindAction(u,s),this._addInactiveAction(u,o,r),u},existingAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?ot.findByName(n,t):t,o=this._actionsByClip[i?i.uuid:t];return void 0!==o?o.actionByRoot[r]||null:null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==e;++i)t[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(t){for(var e=this._actions,n=this._nActiveActions,r=this.time+=t*=this.timeScale,i=Math.sign(t),o=this._accuIndex^=1,a=0;a!==n;++a){e[a]._update(r,t,i,o)}var s=this._bindings,l=this._nActiveBindings;for(a=0;a!==l;++a)s[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var o=i.knownActions,a=0,s=o.length;a!==s;++a){var l=o[a];this._deactivateAction(l);var u=l._cacheIndex,c=e[e.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,c._cacheIndex=u,e[u]=c,e.pop(),this._removeInactiveBindingsForAction(l)}delete r[n]}},uncacheRoot:function(t){var e=t.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[e];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var o=this._bindingsByRootAndName[e];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}});var wu=function(t){It.call(this),this.manager=void 0!==t?t:il,this.parser=new MMDParser.Parser,this.textureCrossOrigin=null};(wu.prototype=Object.create(It.prototype)).constructor=wu,wu.prototype.defaultToonTextures=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAN0lEQVRYR+3WQREAMBACsZ5/bWiiMvgEBTt5cW37hjsBBAgQIECAwFwgyfYPCCBAgAABAgTWAh8aBHZBl14e8wAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAOUlEQVRYR+3WMREAMAwDsYY/yoDI7MLwIiP40+RJklfcCCBAgAABAgTqArfb/QMCCBAgQIAAgbbAB3z/e0F3js2cAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAN0lEQVRYR+3WQREAMBACsZ5/B5ilMvgEBTt5cW37hjsBBAgQIECAwFwgyfYPCCBAgAABAgTWAh81dWyx0gFwKAAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAOklEQVRYR+3WoREAMAwDsWb/UQtCy9wxTOQJ/oQ8SXKKGwEECBAgQIBAXeDt7f4BAQQIECBAgEBb4AOz8Hzx7WLY4wAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABPUlEQVRYR+1XwW7CMAy1+f9fZOMysSEOEweEOPRNdm3HbdOyIhAcklPrOs/PLy9RygBALxzcCDQFmgJNgaZAU6Ap0BR4PwX8gsRMVLssMRH5HcpzJEaWL7EVg9F1IHRlyqQohgVr4FGUlUcMJSjcUlDw0zvjeun70cLWmneoyf7NgBTQSniBTQQSuJAZsOnnaczjIMb5hCiuHKxokCrJfVnrctyZL0PkJAJe1HMil4nxeyi3Ypfn1kX51jpPvo/JeCNC4PhVdHdJw2XjBR8brF8PEIhNVn12AgP7uHsTBguBn53MUZCqv7Lp07Pn5k1Ro+uWmUNn7D+M57rtk7aG0Vo73xyF/fbFf0bPJjDXngnGocDTdFhygZjwUQrMNrDcmZlQT50VJ/g/UwNyHpu778+yW+/ksOz/BFo54P4AsUXMfRq7XWsAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACMElEQVRYR+2Xv4pTQRTGf2dubhLdICiii2KnYKHVolhauKWPoGAnNr6BD6CvIVaihYuI2i1ia0BY0MZGRHQXjZj/mSPnnskfNWiWZUlzJ5k7M2cm833nO5Mziej2DWWJRUoCpQKlAntSQCqgw39/iUWAGmh37jrRnVsKlgpiqmkoGVABA7E57fvY+pJDdgKqF6HzFCSADkDq+F6AHABtQ+UMVE5D7zXod7fFNhTEckTbj5XQgHzNN+5tQvc5NG7C6BNkp6D3EmpXHDR+dQAjFLchW3VS9rlw3JBh+B7ys5Cf9z0GW1C/7P32AyBAOAz1q4jGliIH3YPuBnSfQX4OGreTIgEYQb/pBDtPnEQ4CivXYPAWBk13oHrB54yA9QuSn2H4AcKRpEILDt0BUzj+RLR1V5EqjD66NPRBVpLcQwjHoHYJOhsQv6U4mnzmrIXJCFr4LDwm/xBUoboG9XX4cc9VKdYoSA2yk5NQLJaKDUjTBoveG3Z2TElTxwjNK4M3LEZgUdDdruvcXzKBpStgp2NPiWi3ks9ZXxIoFVi+AvHLdc9TqtjL3/aYjpPlrzOcEnK62Szhimdd7xX232zFDTgtxezOu3WNMRLjiKgjtOhHVMd1loynVHvOgjuIIJMaELEqhJAV/RCSLbWTcfPFakFgFlALTRRvx+ok6Hlp/Q+v3fmx90bMyUzaEAhmM3KvHlXTL5DxnbGf/1M8RNNACLL5MNtPxP/mypJAqcDSFfgFhpYqWUzhTEAAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII="],wu.prototype.setTextureCrossOrigin=function(t){this.textureCrossOrigin=t},wu.prototype.load=function(t,e,n,r,i){var o=this;this.loadModel(t,function(t){o.loadVmds(e,function(e){o.pourVmdIntoModel(t,e),n(t)},r,i)},r,i)},wu.prototype.loadModel=function(t,e,n,r){var i=this,o=al.extractUrlBase(t),a=this.extractExtension(t);this.loadFileAsBuffer(t,function(t){e(i.createModel(t,a,o,n,r))},n,r)},wu.prototype.createModel=function(t,e,n,r,i){return this.createMesh(this.parseModel(t,e),n,r,i)},wu.prototype.loadVmd=function(t,e,n,r){var i=this;this.loadFileAsBuffer(t,function(t){e(i.parseVmd(t))},n,r)},wu.prototype.loadVmds=function(t,e,n,r){function i(){var s=t.shift();o.loadVmd(s,function(n){a.push(n),t.length>0?i():e(o.mergeVmds(a))},n,r)}var o=this,a=[];t=t.slice(),i()},wu.prototype.loadAudio=function(t,e,n,r){var i=new pn,o=new dn(i);new fn(this.manager).load(t,function(t){o.setBuffer(t),e(o,i)},n,r)},wu.prototype.loadVpd=function(t,e,n,r,i){var o=this;(i&&"unicode"===i.charcode?this.loadFileAsText:this.loadFileAsShiftJISText).bind(this)(t,function(t){e(o.parseVpd(t))},n,r)},wu.prototype.parseModel=function(t,e){switch(e.toLowerCase()){case"pmd":return this.parsePmd(t);case"pmx":return this.parsePmx(t);default:throw"extension "+e+" is not supported."}},wu.prototype.parsePmd=function(t){return this.parser.parsePmd(t,!0)},wu.prototype.parsePmx=function(t){return this.parser.parsePmx(t,!0)},wu.prototype.parseVmd=function(t){return this.parser.parseVmd(t,!0)},wu.prototype.parseVpd=function(t){return this.parser.parseVpd(t,!0)},wu.prototype.mergeVmds=function(t){return this.parser.mergeVmds(t)},wu.prototype.pourVmdIntoModel=function(t,e,n){this.createAnimation(t,e,n)},wu.prototype.pourVmdIntoCamera=function(t,e,n){var r=new wu.DataCreationHelper;!function(){for(var a=r.createOrderedMotionArray(e.cameras),l=[],u=[],c=[],h=[],p=[],d=[],f=[],m=[],v=[],g=new o,y=new s,b=new i,_=new i,x=function(t,e){t.push(e.x),t.push(e.y),t.push(e.z)},w=function(t,e){t.push(e.x),t.push(e.y),t.push(e.z),t.push(e.w)},S=function(t,e,n){t.push(e[4*n+0]/127),t.push(e[4*n+1]/127),t.push(e[4*n+2]/127),t.push(e[4*n+3]/127)},A=function(t,e,n,r,i){if(n.length>2){n=n.slice(),r=r.slice(),i=i.slice();for(var o=r.length/n.length,a=3===o?12:4,s=1,l=2,u=n.length;l<u;l++){for(var c=0;c<o;c++)if(r[s*o+c]!==r[(s-1)*o+c]||r[s*o+c]!==r[l*o+c]){s++;break}if(l>s){for(n[s]=n[l],c=0;c<o;c++)r[s*o+c]=r[l*o+c];for(c=0;c<a;c++)i[s*a+c]=i[l*a+c]}}n.length=s+1,r.length=(s+1)*o,i.length=(s+1)*a}return new wu[e](t,n,r,i)},M=0;M<a.length;M++){var T=a[M],C=T.frameNum/30,E=T.position,P=T.rotation,O=T.fov,N=T.interpolation;b.set(0,0,-T.distance),_.set(E[0],E[1],E[2]),y.set(-P[0],-P[1],-P[2]),g.setFromEuler(y),b.add(_),b.applyQuaternion(g),l.length>0&&C<l[l.length-1]+.05&&(l[l.length-1]=C-1e-13),l.push(C),x(u,_),w(c,g),x(h,b),p.push(O);for(var L=0;L<3;L++)S(d,N,L);for(S(f,N,3),L=0;L<3;L++)S(m,N,4);S(v,N,5)}if(0!==l.length){var I=[];I.push(A(".center","VectorKeyframeTrackEx",l,u,d)),I.push(A(".quaternion","QuaternionKeyframeTrackEx",l,c,f)),I.push(A(".position","VectorKeyframeTrackEx",l,h,m)),I.push(A(".fov","NumberKeyframeTrackEx",l,p,v));var D=new ot(void 0===n?xo.generateUUID():n,-1,I);void 0===t.center&&(t.center=new i(0,0,0)),void 0===t.animations&&(t.animations=[]),t.animations.push(D)}}()},wu.prototype.extractExtension=function(t){var e=t.lastIndexOf(".");return e<0?null:t.slice(e+1)},wu.prototype.loadFile=function(t,e,n,r,i,o){var a=new gt(this.manager);void 0!==o&&a.setMimeType(o),a.setResponseType(i);return a.load(t,function(t){e(t)},n,r)},wu.prototype.loadFileAsBuffer=function(t,e,n,r){this.loadFile(t,e,n,r,"arraybuffer")},wu.prototype.loadFileAsText=function(t,e,n,r){this.loadFile(t,e,n,r,"text")},wu.prototype.loadFileAsShiftJISText=function(t,e,n,r){this.loadFile(t,e,n,r,"text","text/plain; charset=shift_jis")},wu.prototype.createMesh=function(t,e,n,r){var o=this,a=new O,s=[],l={};l.vertices=[],l.uvs=[],l.normals=[],l.skinIndices=[],l.skinWeights=[],l.indices=[];!function(){for(var e=0;e<t.metadata.vertexCount;e++){for(var n=t.vertices[e],r=0,i=n.position.length;r<i;r++)l.vertices.push(n.position[r]);for(r=0,i=n.normal.length;r<i;r++)l.normals.push(n.normal[r]);for(r=0,i=n.uv.length;r<i;r++)l.uvs.push(n.uv[r]);for(r=0;r<4;r++)l.skinIndices.push(n.skinIndices.length-1>=r?n.skinIndices[r]:0);for(r=0;r<4;r++)l.skinWeights.push(n.skinWeights.length-1>=r?n.skinWeights[r]:0)}}(),function(){for(var e=0;e<t.metadata.faceCount;e++)for(var n=t.faces[e],r=0,i=n.indices.length;r<i;r++)l.indices.push(n.indices[r])}(),function(){for(var e=[],n=t.rigidBodies,r={},i=0,o=n.length;i<o;i++){var s=n[i],l=r[s.boneIndex];l=void 0===l?s.type:Math.max(s.type,l),r[s.boneIndex]=l}for(i=0;i<t.metadata.boneCount;i++){var u={},c=t.bones[i];u.parent=c.parentIndex,u.name=c.name,u.pos=[c.position[0],c.position[1],c.position[2]],u.rotq=[0,0,0,1],u.scl=[1,1,1],-1!==u.parent&&(u.pos[0]-=t.bones[u.parent].position[0],u.pos[1]-=t.bones[u.parent].position[1],u.pos[2]-=t.bones[u.parent].position[2]),u.rigidBodyType=void 0!==r[i]?r[i]:-1,e.push(u)}a.bones=e}(),function(){var e=[];if("pmd"===t.metadata.format)for(var n=0;n<t.metadata.ikCount;n++){(s={}).target=(o=t.iks[n]).target,s.effector=o.effector,s.iteration=o.iteration,s.maxAngle=4*o.maxAngle,s.links=[];for(var r=0;r<o.links.length;r++)(l={}).index=o.links[r].index,t.bones[l.index].name.indexOf("")>=0&&(l.limitation=new i(1,0,0)),s.links.push(l);e.push(s)}else for(n=0;n<t.metadata.boneCount;n++){var o;if(void 0!==(o=t.bones[n].ik)){var s;for((s={}).target=n,s.effector=o.effector,s.iteration=o.iteration,s.maxAngle=o.maxAngle,s.links=[],r=0;r<o.links.length;r++){var l;(l={}).index=o.links[r].index,l.enabled=!0,1===o.links[r].angleLimitation&&(l.limitation=new i(1,0,0)),s.links.push(l)}e.push(s)}}a.iks=e}(),function(){if("pmd"!==t.metadata.format){for(var e=[],n=0;n<t.metadata.boneCount;n++){var r=t.bones[n],i=r.grant;if(void 0!==i){var o={};o.index=n,o.parentIndex=i.parentIndex,o.ratio=i.ratio,o.isLocal=i.isLocal,o.affectRotation=i.affectRotation,o.affectPosition=i.affectPosition,o.transformationClass=r.transformationClass,e.push(o)}}e.sort(function(t,e){return t.transformationClass-e.transformationClass}),a.grants=e}}(),function(){function e(t,e,n,r){t.array[3*e+0]+=n.position[0]*r,t.array[3*e+1]+=n.position[1]*r,t.array[3*e+2]+=n.position[2]*r}function n(n,r,i){for(var o=0;o<r.elementCount;o++){var a=r.elements[o];e(n,"pmd"===t.metadata.format?t.morphs[0].elements[a.index].index:a.index,a,i)}}for(var r=[],i=[],o=0;o<t.metadata.morphCount;o++){var s=t.morphs[o],u={name:s.name},c=new T(3*t.metadata.vertexCount,3);c.name=s.name;for(var h=0;h<3*t.metadata.vertexCount;h++)c.array[h]=l.vertices[h];if("pmd"===t.metadata.format)0!==o&&n(c,s,1);else if(0===s.type)for(h=0;h<s.elementCount;h++){var p=t.morphs[s.elements[h].index];1===p.type&&n(c,p,s.elements[h].ratio)}else 1===s.type&&n(c,s,1);r.push(u),i.push(c)}a.morphTargets=r,a.morphAttributes.position=i}(),function(){function i(t,i){void 0===i&&(i={});var a;if(!0===i.defaultTexturePath)try{a=o.defaultToonTextures[parseInt(t.match("toon([0-9]{2}).bmp$")[1])]}catch(e){console.warn("MMDLoader: "+t+" seems like not right default texture path. Using toon00.bmp instead."),a=o.defaultToonTextures[0]}else a=e+t;if(void 0!==u[a])return a;var s=It.Handlers.get(a);null===s&&(s=t.indexOf(".tga")>=0?p:c);var l=s.load(a,function(t){if(!0===i.isToonTexture){var e=t.image,n=e.width,r=e.height;d.width=n,d.height=r,f.clearRect(0,0,n,r),f.translate(n/2,r/2),f.rotate(.5*Math.PI),f.translate(-n/2,-r/2),f.drawImage(e,0,0),t.image=f.getImageData(0,0,n,r)}t.flipY=!1,t.wrapS=Ia,t.wrapT=Ia;for(var o=0;o<l.readyCallbacks.length;o++)l.readyCallbacks[o](l);delete l.readyCallbacks},n,r);return!0===i.sphericalReflectionMapping&&(l.mapping=Oa),l.readyCallbacks=[],u[a]=l,a}function l(t,e){return void 0===e[t]&&console.warn("MMDLoader: Undefined texture",t),e[t]}var u={},c=new Lt(o.manager),p=new xu(o.manager),d=document.createElement("canvas"),f=d.getContext("2d"),m=0,v=[];null!==o.textureCrossOrigin&&c.setCrossOrigin(o.textureCrossOrigin);for(var g=0;g<t.metadata.materialCount;g++){var y=t.materials[g],b={};if(b.faceOffset=m,b.faceNum=y.faceCount,m+=y.faceCount,b.name=y.name,b.color=new h(y.diffuse[0],y.diffuse[1],y.diffuse[2]),b.opacity=y.diffuse[3],b.specular=new h(y.specular[0],y.specular[1],y.specular[2]),b.shininess=y.shininess,1===b.opacity?(b.side=Fo,b.transparent=!1):(b.side=ko,b.transparent=!0),"pmd"===t.metadata.format){if(y.fileName){var _=y.fileName,x=[],w=_.lastIndexOf("*");w>=0?(x.push(_.slice(0,w)),x.push(_.slice(w+1))):x.push(_);for(var S=0;S<x.length;S++)(A=x[S]).indexOf(".sph")>=0||A.indexOf(".spa")>=0?(b.envMap=i(A,{sphericalReflectionMapping:!0}),b.envMapType=A.indexOf(".sph")>=0?ga:ba):b.map=i(A)}}else if(-1!==y.textureIndex&&(b.map=i(A=t.textures[y.textureIndex])),-1!==y.envTextureIndex&&(1===y.envFlag||2==y.envFlag)){var A;b.envMap=i(A=t.textures[y.envTextureIndex],{sphericalReflectionMapping:!0}),b.envMapType=1===y.envFlag?ga:ba}var M=void 0===b.map?1:.2;b.emissive=new h(y.ambient[0]*M,y.ambient[1]*M,y.ambient[2]*M),v.push(b)}for(g=0;g<v.length;g++){var T=v[g],C=t.materials[g];if(y=new Mt,a.addGroup(3*T.faceOffset,3*T.faceNum,g),void 0!==T.name&&(y.name=T.name),y.skinning=a.bones.length>0,y.morphTargets=a.morphTargets.length>0,y.lights=!0,y.side="pmx"===t.metadata.format&&1==(1&C.flag)?ko:T.side,y.transparent=T.transparent,y.fog=!0,y.blending=Xo,y.blendSrc=na,y.blendDst=ra,y.blendSrcAlpha=na,y.blendDstAlpha=ia,void 0!==T.map&&(y.faceOffset=T.faceOffset,y.faceNum=T.faceNum,y.map=l(T.map,u),function(t){t.map.readyCallbacks.push(function(e){function n(t,e){var n=t.width,r=t.height,i=Math.round(e.x*n)%n,o=Math.round(e.y*r)%r;return i<0&&(i+=n),o<0&&(o+=r),t.data[4*(o*n+i)+3]}var r=void 0!==e.image.data?e.image:function(t){var e=document.createElement("canvas");e.width=t.width,e.height=t.height;var n=e.getContext("2d");return n.drawImage(t,0,0),n.getImageData(0,0,e.width,e.height)}(e.image),i=a.index.array.slice(3*t.faceOffset,3*t.faceOffset+3*t.faceNum);(function(t,e,r){if(t.data.length/(t.width*t.height)!=4)return!1;for(var i=0;i<r.length;i+=3){for(var o={x:0,y:0},a=0;a<3;a++){var s=r[3*i+a],l={x:e[2*s+0],y:e[2*s+1]};if(n(t,l)<253)return!0;o.x+=l.x,o.y+=l.y}if(o.x/=3,o.y/=3,n(t,o)<253)return!0}return!1})(r,a.attributes.uv.array,i)&&(t.transparent=!0),delete t.faceOffset,delete t.faceNum})}(y)),void 0!==T.envMap&&(y.envMap=l(T.envMap,u),y.combine=T.envMapType),y.opacity=T.opacity,y.color=T.color,void 0!==T.emissive&&(y.emissive=T.emissive),y.specular=T.specular,y.shininess=Math.max(T.shininess,1e-4),"pmd"===t.metadata.format){y.outlineParameters={thickness:1===C.edgeFlag?.003:0,color:new h(0,0,0),alpha:1},0===y.outlineParameters.thickness&&(y.outlineParameters.visible=!1);var E=i(P=-1===C.toonIndex?"toon00.bmp":t.toonTextures[C.toonIndex].fileName,{isToonTexture:!0,defaultTexturePath:function(t){return 10===t.length&&null!==t.match(/toon(10|0[0-9]).bmp/)}(P)});y.gradientMap=l(E,u)}else{y.outlineParameters={thickness:C.edgeSize/300,color:new h(C.edgeColor[0],C.edgeColor[1],C.edgeColor[2]),alpha:C.edgeColor[3]},0!=(16&C.flag)&&0!==y.outlineParameters.thickness||(y.outlineParameters.visible=!1);var P,O;if(-1===C.toonIndex||0!==C.toonFlag){var N=C.toonIndex+1;P="toon"+(N<10?"0"+N:N)+".bmp",O=!0}else P=t.textures[C.toonIndex],O=!1;E=i(P,{isToonTexture:!0,defaultTexturePath:O}),y.gradientMap=l(E,u)}s.push(y)}if("pmx"===t.metadata.format){function L(t,e){if(8===t.type)for(var n=0;n<e.length;n++){var r=e[n];if(-1!==r.index){var i=s[r.index];i.opacity!==r.diffuse[3]&&(i.transparent=!0)}}}for(g=0;g<t.morphs.length;g++){var I=t.morphs[g],D=I.elements;if(0===I.type)for(S=0;S<D.length;S++){var F=t.morphs[D[S].index];L(F,F.elements)}else L(I,D)}}}(),function(){for(var e=[],n=[],r=0;r<t.metadata.rigidBodyCount;r++){for(var i=t.rigidBodies[r],o=Object.keys(i),s={},l=0;l<o.length;l++)s[h=o[l]]=i[h];if("pmx"===t.metadata.format&&-1!==s.boneIndex){var u=t.bones[s.boneIndex];s.position[0]-=u.position[0],s.position[1]-=u.position[1],s.position[2]-=u.position[2]}e.push(s)}for(r=0;r<t.metadata.constraintCount;r++){var c=t.constraints[r];for(o=Object.keys(c),s={},l=0;l<o.length;l++){var h;s[h=o[l]]=c[h]}var p=e[s.rigidBodyIndex1],d=e[s.rigidBodyIndex2];0!==p.type&&2===d.type&&-1!==p.boneIndex&&-1!==d.boneIndex&&t.bones[d.boneIndex].parentIndex===p.boneIndex&&(d.type=1),n.push(s)}a.rigidBodies=e,a.constraints=n}(),a.setIndex(l.indices),a.addAttribute("position",new T(l.vertices,3)),a.addAttribute("normal",new T(l.normals,3)),a.addAttribute("uv",new T(l.uvs,2)),a.addAttribute("skinIndex",new S(l.skinIndices,4)),a.addAttribute("skinWeight",new T(l.skinWeights,4)),a.computeBoundingSphere(),a.mmdFormat=t.metadata.format;return new Ce(a,s)},wu.prototype.createAnimation=function(t,e,n){var r=new wu.DataCreationHelper;!function(){if(0!==e.metadata.motionCount){for(var i=t.geometry.bones,o=r.createOrderedMotionArrays(i,e.motions,"boneName"),a=[],s=function(t,e,n){t.push(e[n+0]/127),t.push(e[n+8]/127),t.push(e[n+4]/127),t.push(e[n+12]/127)},l=0;l<o.length;l++){for(var u=[],c=[],h=[],p=[],d=[],f=i[l],m=o[l],v=0;v<m.length;v++){var g=m[v].position,y=m[v].rotation,b=m[v].interpolation;u.push(m[v].frameNum/30);for(var _=0;_<3;_++)c.push(f.pos[_]+g[_]);for(_=0;_<4;_++)h.push(y[_]);for(_=0;_<3;_++)s(p,b,_);s(d,b,3)}if(0!==u.length){var x=".bones["+f.name+"]";a.push(new wu.VectorKeyframeTrackEx(x+".position",u,c,p)),a.push(new wu.QuaternionKeyframeTrackEx(x+".quaternion",u,h,d))}}var w=new ot(void 0===n?xo.generateUUID():n,-1,a);void 0===t.geometry.animations&&(t.geometry.animations=[]),t.geometry.animations.push(w)}}(),function(){if(0!==e.metadata.morphCount){for(var i=r.createOrderedMotionArrays(t.geometry.morphTargets,e.morphs,"morphName"),o=[],a=0;a<i.length;a++){for(var s=[],l=[],u=i[a],c=0;c<u.length;c++)s.push(u[c].frameNum/30),l.push(u[c].weight);0!==s.length&&o.push(new it(".morphTargetInfluences["+a+"]",s,l))}var h=new ot(void 0===n?xo.generateUUID():n+"Morph",-1,o);void 0===t.geometry.animations&&(t.geometry.animations=[]),t.geometry.animations.push(h)}}()},(wu.DataCreationHelper=function(){}).prototype={constructor:wu.DataCreationHelper,toCharcodeStrings:function(t){for(var e="",n=0;n<t.length;n++)e+="0x"+("0000"+t[n].charCodeAt().toString(16)).substr(-4);return e},createDictionary:function(t){for(var e={},n=0;n<t.length;n++)e[t[n].name]=n;return e},initializeMotionArrays:function(t){for(var e=[],n=0;n<t.length;n++)e[n]=[];return e},sortMotionArray:function(t){t.sort(function(t,e){return t.frameNum-e.frameNum})},sortMotionArrays:function(t){for(var e=0;e<t.length;e++)this.sortMotionArray(t[e])},createMotionArray:function(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n]);return e},createMotionArrays:function(t,e,n,r){for(var i=0;i<t.length;i++){var o=t[i],a=n[o[r]];void 0!==a&&e[a].push(o)}},createOrderedMotionArray:function(t){var e=this.createMotionArray(t);return this.sortMotionArray(e),e},createOrderedMotionArrays:function(t,e,n){var r=this.createDictionary(t),i=this.initializeMotionArrays(t);return this.createMotionArrays(e,i,r,n),this.sortMotionArrays(i),i}},((wu.VectorKeyframeTrackEx=function(t,e,n,r){this.interpolationParameters=new Float32Array(r),$.call(this,t,e,n)}).prototype=Object.create($.prototype)).constructor=wu.VectorKeyframeTrackEx,wu.VectorKeyframeTrackEx.prototype.TimeBufferType=Float64Array,wu.VectorKeyframeTrackEx.prototype.InterpolantFactoryMethodCubicBezier=function(t){return new wu.CubicBezierInterpolation(this.times,this.values,this.getValueSize(),t,this.interpolationParameters)},wu.VectorKeyframeTrackEx.prototype.setInterpolation=function(t){this.createInterpolant=this.InterpolantFactoryMethodCubicBezier},((wu.QuaternionKeyframeTrackEx=function(t,e,n,r){this.interpolationParameters=new Float32Array(r),J.call(this,t,e,n)}).prototype=Object.create(J.prototype)).constructor=wu.QuaternionKeyframeTrackEx,wu.QuaternionKeyframeTrackEx.prototype.TimeBufferType=Float64Array,wu.QuaternionKeyframeTrackEx.prototype.InterpolantFactoryMethodCubicBezier=function(t){return new wu.CubicBezierInterpolation(this.times,this.values,this.getValueSize(),t,this.interpolationParameters)},wu.QuaternionKeyframeTrackEx.prototype.setInterpolation=function(t){this.createInterpolant=this.InterpolantFactoryMethodCubicBezier},((wu.NumberKeyframeTrackEx=function(t,e,n,r){this.interpolationParameters=new Float32Array(r),it.call(this,t,e,n)}).prototype=Object.create(it.prototype)).constructor=wu.NumberKeyframeTrackEx,wu.NumberKeyframeTrackEx.prototype.TimeBufferType=Float64Array,wu.NumberKeyframeTrackEx.prototype.InterpolantFactoryMethodCubicBezier=function(t){return new wu.CubicBezierInterpolation(this.times,this.values,this.getValueSize(),t,this.interpolationParameters)},wu.NumberKeyframeTrackEx.prototype.setInterpolation=function(t){this.createInterpolant=this.InterpolantFactoryMethodCubicBezier},((wu.CubicBezierInterpolation=function(t,e,n,r,i){Z.call(this,t,e,n,r),this.params=i}).prototype=Object.create(et.prototype)).constructor=wu.CubicBezierInterpolation,wu.CubicBezierInterpolation.prototype.interpolate_=function(t,e,n,r){var i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,l=t*s,u=l-s,c=(n-e)/(r-e);if(4===s){var h=this._calculate(this.params[4*t+0],this.params[4*t+1],this.params[4*t+2],this.params[4*t+3],c);o.slerpFlat(i,0,a,u,a,l,h)}else if(3===s)for(var p=0;p!==s;++p){h=this._calculate(this.params[12*t+4*p+0],this.params[12*t+4*p+1],this.params[12*t+4*p+2],this.params[12*t+4*p+3],c);i[p]=a[u+p]*(1-h)+a[l+p]*h}else{h=this._calculate(this.params[4*t+0],this.params[4*t+1],this.params[4*t+2],this.params[4*t+3],c);i[0]=a[u]*(1-h)+a[l]*h}return i},wu.CubicBezierInterpolation.prototype._calculate=function(t,e,n,r,i){for(var o,a,s,l=.5,u=l,c=1-u,h=Math,p=0;p<15;p++){var d=(o=3*c*c*u)*t+(a=3*c*u*u)*e+(s=u*u*u)-i;if(h.abs(d)<1e-5)break;l/=2,c=1-(u+=d<0?l:-l)}return o*n+a*r+s};var Su=function(t,e,n){var r=null===n||void 0===n?{}:n;this.audio=t,this.listener=e,this.elapsedTime=0,this.currentTime=0,this.delayTime=void 0!==r.delayTime?r.delayTime:0,this.audioDuration=this.audio.buffer.duration,this.duration=this.audioDuration+this.delayTime};Su.prototype={constructor:Su,control:function(t){this.elapsed+=t,this.currentTime+=t,this.checkIfStopAudio()&&this.audio.stop(),this.checkIfStartAudio()&&this.audio.play()},checkIfStartAudio:function(){if(this.audio.isPlaying)return!1;for(;this.currentTime>=this.duration;)this.currentTime-=this.duration;return!(this.currentTime<this.delayTime)&&(this.audio.startTime=this.currentTime-this.delayTime,!0)},checkIfStopAudio:function(){return!!this.audio.isPlaying&&this.currentTime>=this.duration}};var Au=function(t){this.mesh=t};Au.prototype={constructor:Au,update:function(){var t=new o;return function(){for(var e=0;e<this.mesh.geometry.grants.length;e++){var n=this.mesh.geometry.grants[e],r=this.mesh.skeleton.bones[n.index],i=this.mesh.skeleton.bones[n.parentIndex];n.isLocal||n.affectRotation&&(t.set(0,0,0,1),t.slerp(i.quaternion,n.ratio),r.quaternion.multiply(t))}}}()};var Mu=function(){this.meshes=[],this.doAnimation=!0,this.doIk=!0,this.doGrant=!0,this.doPhysics=!0,this.doCameraAnimation=!0,this.sharedPhysics=!1,this.masterPhysics=null,this.audioManager=null,this.camera=null};Mu.prototype={constructor:Mu,add:function(t){if(!(t instanceof Ce))throw new Error("MMDHelper.add() accepts only SkinnedMesh instance.");void 0===t.mixer&&(t.mixer=null),void 0===t.ikSolver&&(t.ikSolver=null),void 0===t.grantSolver&&(t.grantSolver=null),void 0===t.physics&&(t.physics=null),void 0===t.looped&&(t.looped=!1),this.meshes.push(t),this.initBackupBones(t)},setAudio:function(t,e,n){this.audioManager=new Su(t,e,n)},setCamera:function(t){t.mixer=null,this.camera=t},setPhysicses:function(t){for(var e=0;e<this.meshes.length;e++)this.setPhysics(this.meshes[e],t)},setPhysics:function(t,e){if(void 0===(e=void 0===e?{}:Object.assign({},e)).world&&this.sharedPhysics){var n=this.getMasterPhysics();null!==n&&(e.world=n.world)}var r=void 0!==e.warmup?e.warmup:60,i=new Zs(t,e);null!==t.mixer&&void 0!==t.mixer&&!0!==e.preventAnimationWarmup&&(this.animateOneMesh(0,t),i.reset()),i.warmup(r),this.updateIKParametersDependingOnPhysicsEnabled(t,!0),t.physics=i},getMasterPhysics:function(){if(null!==this.masterPhysics)return this.masterPhysics;for(var t=0,e=this.meshes.length;t<e;t++){var n=this.meshes[t].physics;if(void 0!==n&&null!==n)return this.masterPhysics=n,this.masterPhysics}return null},enablePhysics:function(t){this.doPhysics=!0===t;for(var e=0,n=this.meshes.length;e<n;e++)this.updateIKParametersDependingOnPhysicsEnabled(this.meshes[e],t)},updateIKParametersDependingOnPhysicsEnabled:function(t,e){for(var n=t.geometry.iks,r=t.geometry.bones,i=0,o=n.length;i<o;i++)for(var a=n[i].links,s=0,l=a.length;s<l;s++){var u=a[s];u.enabled=!0!==e||!(r[u.index].rigidBodyType>0)}},setAnimations:function(){for(var t=0;t<this.meshes.length;t++)this.setAnimation(this.meshes[t])},setAnimation:function(t){if(void 0!==t.geometry.animations){t.mixer=new gn(t),t.mixer.addEventListener("loop",function(t){if(!(t.action._clip.tracks.length>0&&0!==t.action._clip.tracks[0].name.indexOf(".bones"))){t.target._root.looped=!0}});for(var e=!1,n=!1,r=0;r<t.geometry.animations.length;r++){var i=t.geometry.animations[r],o=t.mixer.clipAction(i);i.tracks.length>0&&0===i.tracks[0].name.indexOf(".morphTargetInfluences")?n||(o.play(),n=!0):e||(o.play(),e=!0)}e&&(t.ikSolver=new Ys(t),void 0!==t.geometry.grants&&(t.grantSolver=new Au(t)))}},setCameraAnimation:function(t){void 0!==t.animations&&(t.mixer=new gn(t),t.mixer.clipAction(t.animations[0]).play())},unifyAnimationDuration:function(t){t=void 0===t?{}:t;for(var e=0,n=this.camera,r=this.audioManager,i=0;i<this.meshes.length;i++){if(null!==(s=this.meshes[i].mixer))for(var o=0;o<s._actions.length;o++){var a=s._actions[o];e=Math.max(e,a._clip.duration)}}if(null!==n&&null!==n.mixer){var s=n.mixer;for(i=0;i<s._actions.length;i++){a=s._actions[i];e=Math.max(e,a._clip.duration)}}null!==r&&(e=Math.max(e,r.duration)),void 0!==t.afterglow&&(e+=t.afterglow);for(i=0;i<this.meshes.length;i++){if(null!==(s=this.meshes[i].mixer))for(o=0;o<s._actions.length;o++){(a=s._actions[o])._clip.duration=e}}if(null!==n&&null!==n.mixer)for(s=n.mixer,i=0;i<s._actions.length;i++){(a=s._actions[i])._clip.duration=e}null!==r&&(r.duration=e)},controlAudio:function(t){null!==this.audioManager&&this.audioManager.control(t)},animate:function(t){this.controlAudio(t);for(var e=0;e<this.meshes.length;e++)this.animateOneMesh(t,this.meshes[e]);this.sharedPhysics&&this.updateSharedPhysics(t),this.animateCamera(t)},animateOneMesh:function(t,e){var n=e.mixer,r=e.ikSolver,i=e.grantSolver,o=e.physics;null!==n&&!0===this.doAnimation&&(this.restoreBones(e),n.update(t),this.backupBones(e)),null!==r&&!0===this.doIk&&r.update(),null!==i&&!0===this.doGrant&&i.update(),!0===e.looped&&(null!==o&&o.reset(),e.looped=!1),null!==o&&this.doPhysics&&!this.sharedPhysics&&o.update(t)},updateSharedPhysics:function(t){if(0!==this.meshes.length&&this.doPhysics&&this.sharedPhysics){var e=this.getMasterPhysics();if(null!==e){for(var n=0,r=this.meshes.length;n<r;n++){null!==(i=this.meshes[n].physics)&&void 0!==i&&i.updateRigidBodies()}e.stepSimulation(t);for(n=0,r=this.meshes.length;n<r;n++){var i;null!==(i=this.meshes[n].physics)&&void 0!==i&&i.updateBones()}}}},animateCamera:function(t){if(null!==this.camera){var e=this.camera.mixer;null!==e&&void 0!==this.camera.center&&!0===this.doCameraAnimation&&(e.update(t),this.camera.updateProjectionMatrix(),this.camera.up.set(0,1,0),this.camera.up.applyQuaternion(this.camera.quaternion),this.camera.lookAt(this.camera.center))}},poseAsVpd:function(t,e,n){void 0===n&&(n={}),!0!==n.preventResetPose&&t.pose();for(var r=t.skeleton.bones,a=e.bones,s={},l=0;l<r.length;l++)s[r[l].name]=l;var u=new i,c=new o;for(l=0;l<a.length;l++){var h=a[l],p=s[h.name];if(void 0!==p){var d=r[p],f=h.translation,m=h.quaternion;u.set(f[0],f[1],f[2]),c.set(m[0],m[1],m[2],m[3]),d.position.add(u),d.quaternion.multiply(c)}}if(t.updateMatrixWorld(!0),!0!==n.preventIk){new Ys(t).update(n.saveOriginalBonesBeforeIK)}if(!0!==n.preventGrant&&void 0!==t.geometry.grants){new Au(t).update()}},initBackupBones:function(t){t.skeleton.backupBones=[];for(var e=0;e<t.skeleton.bones.length;e++)t.skeleton.backupBones.push(t.skeleton.bones[e].clone())},backupBones:function(t){t.skeleton.backupBoneIsSaved=!0;for(var e=0;e<t.skeleton.bones.length;e++){var n=t.skeleton.backupBones[e],r=t.skeleton.bones[e];n.position.copy(r.position),n.quaternion.copy(r.quaternion)}},restoreBones:function(t){if(!0===t.skeleton.backupBoneIsSaved){t.skeleton.backupBoneIsSaved=!1;for(var e=0;e<t.skeleton.bones.length;e++){var n=t.skeleton.bones[e],r=t.skeleton.backupBones[e];n.position.copy(r.position),n.quaternion.copy(r.quaternion)}}}};var Tu=function(t){this.manager=void 0!==t?t:il};Tu.prototype={constructor:Tu,load:function(t,e,n,r){var i=this,o=new gt(this.manager);o.setPath(this.path),o.load(t,function(t){e(i.parse(t))},n,r)},setPath:function(t){this.path=t},setTexturePath:function(t){this.texturePath=t},setBaseUrl:function(t){console.warn("MTLLoader: .setBaseUrl() is deprecated. Use .setTexturePath( path ) for texture path or .setPath( path ) for general base path instead."),this.setTexturePath(t)},setCrossOrigin:function(t){this.crossOrigin=t},setMaterialOptions:function(t){this.materialOptions=t},parse:function(t){for(var e=t.split("\n"),n={},r=/\s+/,i={},o=0;o<e.length;o++){var a=e[o];if(0!==(a=a.trim()).length&&"#"!==a.charAt(0)){var s=a.indexOf(" "),l=s>=0?a.substring(0,s):a;l=l.toLowerCase();var u=s>=0?a.substring(s+1):"";if(u=u.trim(),"newmtl"===l)i[u]=n={name:u};else if(n)if("ka"===l||"kd"===l||"ks"===l){var c=u.split(r,3);n[l]=[parseFloat(c[0]),parseFloat(c[1]),parseFloat(c[2])]}else n[l]=u}}var h=new Tu.MaterialCreator(this.texturePath||this.path,this.materialOptions);return h.setCrossOrigin(this.crossOrigin),h.setManager(this.manager),h.setMaterials(i),h}},(Tu.MaterialCreator=function(t,e){this.baseUrl=t||"",this.options=e,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:Fo,this.wrap=this.options&&this.options.wrap?this.options.wrap:Ia}).prototype={constructor:Tu.MaterialCreator,crossOrigin:"Anonymous",setCrossOrigin:function(t){this.crossOrigin=t},setManager:function(t){this.manager=t},setMaterials:function(t){this.materialsInfo=this.convert(t),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(t){if(!this.options)return t;var e={};for(var n in t){var r=t[n],i={};e[n]=i;for(var o in r){var a=!0,s=r[o],l=o.toLowerCase();switch(l){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===s[0]&&0===s[1]&&0===s[2]&&(a=!1)}a&&(i[l]=s)}}return e},preload:function(){for(var t in this.materialsInfo)this.create(t)},getIndex:function(t){return this.nameLookup[t]},getAsArray:function(){var t=0;for(var e in this.materialsInfo)this.materialsArray[t]=this.create(e),this.nameLookup[e]=t,t++;return this.materialsArray},create:function(t){return void 0===this.materials[t]&&this.createMaterial_(t),this.materials[t]},createMaterial_:function(t){function e(t,e){if(!i[t]){var r=n.getTextureParams(e,i),o=n.loadTexture(function(t,e){return"string"!=typeof e||""===e?"":/^https?:\/\//i.test(e)?e:t+e}(n.baseUrl,r.url));o.repeat.copy(r.scale),o.offset.copy(r.offset),o.wrapS=n.wrap,o.wrapT=n.wrap,i[t]=o}}var n=this,r=this.materialsInfo[t],i={name:t,side:this.side};for(var o in r){var a,s=r[o];if(""!==s)switch(o.toLowerCase()){case"kd":i.color=(new h).fromArray(s);break;case"ks":i.specular=(new h).fromArray(s);break;case"map_kd":e("map",s);break;case"map_ks":e("specularMap",s);break;case"norm":e("normalMap",s);break;case"map_bump":case"bump":e("bumpMap",s);break;case"ns":i.shininess=parseFloat(s);break;case"d":(a=parseFloat(s))<1&&(i.opacity=a,i.transparent=!0);break;case"tr":a=parseFloat(s),this.options&&this.options.invertTrProperty&&(a=1-a),a<1&&(i.opacity=a,i.transparent=!0)}}return this.materials[t]=new wt(i),this.materials[t]},getTextureParams:function(t,e){var n,r={scale:new m(1,1),offset:new m(0,0)},i=t.split(/\s+/);return(n=i.indexOf("-bm"))>=0&&(e.bumpScale=parseFloat(i[n+1]),i.splice(n,2)),(n=i.indexOf("-s"))>=0&&(r.scale.set(parseFloat(i[n+1]),parseFloat(i[n+2])),i.splice(n,4)),(n=i.indexOf("-o"))>=0&&(r.offset.set(parseFloat(i[n+1]),parseFloat(i[n+2])),i.splice(n,4)),r.url=i.join(" ").trim(),r},loadTexture:function(t,e,n,r,i){var o,a=It.Handlers.get(t);return null===a&&(a=new Lt(void 0!==this.manager?this.manager:il)),a.setCrossOrigin&&a.setCrossOrigin(this.crossOrigin),o=a.load(t,n,r,i),void 0!==e&&(o.mapping=e),o}};var Cu=function(t){this.uuid=xo.generateUUID(),this.name="",this.allows={},this.type=t,this.userData={}};Cu.prototype.isNode=!0,Cu.prototype.parse=function(t,e){e=e||{},t.parsing=!0;var n=t.material;this.build(t.addCache(e.cache,e.requires).addSlot(e.slot),"v4"),n.clearVertexNode(),n.clearFragmentNode(),t.removeCache().removeSlot(),t.parsing=!1},Cu.prototype.parseAndBuildCode=function(t,e,n){return n=n||{},this.parse(t,n),this.buildCode(t,e,n)},Cu.prototype.buildCode=function(t,e,n){var r=t.material,i={result:this.build(t.addCache((n=n||{}).cache,n.requires).addSlot(n.slot),e)};return i.code=t.isShader("vertex")?r.clearVertexNode():r.clearFragmentNode(),t.removeCache().removeSlot(),i},Cu.prototype.build=function(t,e,n){e=e||this.getType(t,e);var r=t.material,i=r.getDataNode(n||this.uuid);if(t.parsing&&this.appendDepsNode(t,i,e),!1===this.allows[t.shader])throw new Error("Shader "+shader+" is not compatible with this node.");return-1===r.nodes.indexOf(this)&&r.nodes.push(this),void 0!==this.updateFrame&&-1===r.updaters.indexOf(this)&&r.updaters.push(this),this.generate(t,e,n)},Cu.prototype.appendDepsNode=function(t,e,n){e.deps=(e.deps||0)+1;var r=t.getFormatLength(n);(r>(e.outputMax||0)||this.getType(t,n))&&(e.outputMax=r,e.output=n)},Cu.prototype.getType=function(t,e){return"sampler2D"===e||"samplerCube"===e?e:this.type},Cu.prototype.getJSONNode=function(t){if(!(void 0===t||"string"==typeof t)&&void 0!==t.nodes[this.uuid])return t.nodes[this.uuid]},Cu.prototype.createJSONNode=function(t){var e=void 0===t||"string"==typeof t,n={};if("string"!=typeof this.nodeType)throw new Error("Node does not allow serialization.");return n.uuid=this.uuid,n.type=this.nodeType+"Node",""!==this.name&&(n.name=this.name),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e||(t.nodes[this.uuid]=n),n},Cu.prototype.toJSON=function(t){return this.getJSONNode(t)||this.createJSONNode(t)};var Eu=function(t,e){Cu.call(this,t),this.shared=void 0===(e=e||{}).shared||e.shared,this.unique=void 0!==e.unique&&e.unique};(Eu.prototype=Object.create(Cu.prototype)).constructor=Eu,Eu.prototype.build=function(t,e,n,r){e=e||this.getType(t);var i=t.material;if(this.isShared(t,e)){var o=this.isUnique(t,e);o&&void 0===this.constructor.uuid&&(this.constructor.uuid=xo.generateUUID()),n=t.getUuid(n||this.getUuid(),!o);var a=i.getDataNode(n);if(t.parsing)return a.deps?(this.appendDepsNode(t,a,e),this.generate(t,l,n)):Cu.prototype.build.call(this,t,e,n);if(o)return a.name=a.name||Cu.prototype.build.call(this,t,e,n),a.name;if(!t.optimize||1==a.deps)return Cu.prototype.build.call(this,t,e,n);n=this.getUuid(!1);var s=this.getTemp(t,n),l=a.output||this.getType(t);if(s)return t.format(s,l,e);s=Eu.prototype.generate.call(this,t,e,n,a.output,r);var u=this.generate(t,l,n);return t.isShader("vertex")?i.addVertexNode(s+"="+u+";"):i.addFragmentNode(s+"="+u+";"),t.format(s,l,e)}return Cu.prototype.build.call(this,t,e,n)},Eu.prototype.isShared=function(t,e){return"sampler2D"!==e&&"samplerCube"!==e&&this.shared},Eu.prototype.isUnique=function(t,e){return this.unique},Eu.prototype.getUuid=function(t){var e=t||void 0==t?this.constructor.uuid||this.uuid:this.uuid;return"string"==typeof this.scope&&(e=this.scope+"-"+e),e},Eu.prototype.getTemp=function(t,e){e=e||this.uuid;var n=t.material;return t.isShader("vertex")&&n.vertexTemps[e]?n.vertexTemps[e].name:n.fragmentTemps[e]?n.fragmentTemps[e].name:void 0},Eu.prototype.generate=function(t,e,n,r,i){return this.isShared(t,e)||console.error("TempNode is not shared!"),n=n||this.uuid,t.isShader("vertex")?t.material.getVertexTemp(n,r||this.getType(t),i).name:t.material.getFragmentTemp(n,r||this.getType(t),i).name};var Pu=function(t,e,n,r){t=t||"",this.isMethod="string"!=typeof e,this.useKeywords=!0,Eu.call(this,this.isMethod?null:e),this.isMethod?this.eval(t,e,n,r):this.eval(t,n,r)};Pu.rDeclaration=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\((.*?)\)/i,Pu.rProperties=/[a-z_0-9]+/gi,(Pu.prototype=Object.create(Eu.prototype)).constructor=Pu,Pu.prototype.eval=function(t,e,n,r){if(t=(t||"").trim(),this.includes=e||[],this.extensions=n||{},this.keywords=r||{},this.isMethod){var i=t.match(Pu.rDeclaration);if(this.inputs=[],i&&4==i.length){this.type=i[1],this.name=i[2];var o=i[3].match(Pu.rProperties);if(o)for(var a=0;a<o.length;){var s,l,u=o[a++];"in"==u||"out"==u||"inout"==u?s=o[a++]:(s=u,u=""),l=o[a++],this.inputs.push({name:l,type:s,qualifier:u})}}else this.type="",this.name=""}this.value=t};var Ou={nodes:{},keywords:{},add:function(t){this.nodes[t.name]=t},addKeyword:function(t,e,n){this.keywords[t]={callback:e,cache:n=void 0===n||n}},remove:function(t){delete this.nodes[t.name]},removeKeyword:function(t){delete this.keywords[t]},get:function(t){return this.nodes[t]},getKeyword:function(t,e){return this.keywords[t].callback.call(this,e)},getKeywordData:function(t){return this.keywords[t]},contains:function(t){return void 0!=this.nodes[t]},containsKeyword:function(t){return void 0!=this.keywords[t]}},Nu=function(t){Eu.call(this,"v2",{shared:!1}),this.index=t||0};Nu.vertexDict=["uv","uv2"],Nu.fragmentDict=["vUv","vUv2"],(Nu.prototype=Object.create(Eu.prototype)).constructor=Nu,Nu.prototype.nodeType="UV",Nu.prototype.generate=function(t,e){var n;return t.material.requires.uv[this.index]=!0,n=t.isShader("vertex")?Nu.vertexDict[this.index]:Nu.fragmentDict[this.index],t.format(n,this.getType(t),e)},Nu.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).index=this.index),e};var Lu=function(t){Eu.call(this,"v3"),this.scope=t||Lu.LOCAL};Lu.LOCAL="local",Lu.WORLD="world",Lu.VIEW="view",Lu.PROJECTION="projection",Lu.prototype=Object.create(Eu.prototype),Lu.prototype.constructor=Lu,Lu.prototype.nodeType="Position",Lu.prototype.getType=function(t){switch(this.scope){case Lu.PROJECTION:return"v4"}return this.type},Lu.prototype.isShared=function(t){switch(this.scope){case Lu.LOCAL:case Lu.WORLD:return!1}return!0},Lu.prototype.generate=function(t,e){var n,r=t.material;switch(this.scope){case Lu.LOCAL:r.requires.position=!0,n=t.isShader("vertex")?"transformed":"vPosition";break;case Lu.WORLD:r.requires.worldPosition=!0,n=(t.isShader("vertex"),"vWPosition");break;case Lu.VIEW:n=t.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case Lu.PROJECTION:n=t.isShader("vertex")?"(projectionMatrix * modelViewMatrix * vec4( position, 1.0 ))":"vec4( 0.0 )"}return t.format(n,this.getType(t),e)},Lu.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).scope=this.scope),e};var Iu=function(t){Eu.call(this,"v3"),this.scope=t||Iu.LOCAL};Iu.LOCAL="local",Iu.WORLD="world",Iu.VIEW="view",Iu.prototype=Object.create(Eu.prototype),Iu.prototype.constructor=Iu,Iu.prototype.nodeType="Normal",Iu.prototype.isShared=function(t){switch(this.scope){case Iu.WORLD:return!0}return!1},Iu.prototype.generate=function(t,e){var n,r=t.material;switch(this.scope){case Iu.LOCAL:r.requires.normal=!0,n=t.isShader("vertex")?"normal":"vObjectNormal";break;case Iu.WORLD:r.requires.worldNormal=!0,n=t.isShader("vertex")?"( modelMatrix * vec4( objectNormal, 0.0 ) ).xyz":"vWNormal";break;case Iu.VIEW:n="vNormal"}return t.format(n,this.getType(t),e)},Iu.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).scope=this.scope),e};var Du=function(t,e){(e=e||{}).shared=void 0!==e.shared&&e.shared,Eu.call(this,t,e),this.readonly=!1};(Du.prototype=Object.create(Eu.prototype)).constructor=Du,Du.prototype.isReadonly=function(t){return this.readonly},Du.prototype.generate=function(t,e,n,r,i,o){var a=t.material;n=t.getUuid(n||this.getUuid()),r=r||this.getType(t);var s=a.getDataNode(n);return this.isReadonly(t)&&void 0!==this.generateReadonly?this.generateReadonly(t,e,n,r,i,o):t.isShader("vertex")?(s.vertex||(s.vertex=a.createVertexUniform(r,this.value,i,o)),t.format(s.vertex.name,r,e)):(s.fragment||(s.fragment=a.createFragmentUniform(r,this.value,i,o)),t.format(s.fragment.name,r,e))};var Fu=function(t){Du.call(this,"fv1"),this.value=[t||0]};(Fu.prototype=Object.create(Du.prototype)).constructor=Fu,Fu.prototype.nodeType="Float",Object.defineProperties(Fu.prototype,{number:{get:function(){return this.value[0]},set:function(t){this.value[0]=t}}}),Fu.prototype.generateReadonly=function(t,e,n,r,i,o){var a=this.number;return t.format(Math.floor(a)!==a?a:a+".0",r,e)},Fu.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).number=this.number,!0===this.readonly&&(e.readonly=!0)),e};var Ru=function(t,e){Fu.call(this),this.scale=void 0!==t?t:1,this.scope=e||Ru.GLOBAL,this.timeScale=1!==this.scale};Ru.GLOBAL="global",Ru.LOCAL="local",Ru.DELTA="delta",Ru.prototype=Object.create(Fu.prototype),Ru.prototype.constructor=Ru,Ru.prototype.nodeType="Timer",Ru.prototype.isReadonly=function(t){return!1},Ru.prototype.isUnique=function(t){return this.timeScale&&(this.scope===Ru.GLOBAL||this.scope===Ru.DELTA)},Ru.prototype.updateFrame=function(t){var e=this.timeScale?this.scale:1;switch(this.scope){case Ru.LOCAL:this.number+=t.delta*e;break;case Ru.DELTA:this.number=t.delta*e;break;default:this.number=t.time*e}},Ru.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).scope=this.scope,e.scale=this.scale,e.timeScale=this.timeScale),e};var ku=function(t,e){Eu.call(this),this.eval(t||ku.PI,e)};ku.PI="PI",ku.PI2="PI2",ku.RECIPROCAL_PI="RECIPROCAL_PI",ku.RECIPROCAL_PI2="RECIPROCAL_PI2",ku.LOG2="LOG2",ku.EPSILON="EPSILON",ku.prototype=Object.create(Eu.prototype),ku.prototype.constructor=ku,ku.prototype.nodeType="Const",ku.prototype.getType=function(t){return t.getTypeByFormat(this.type)},ku.prototype.eval=function(t,e){var n,r,i="",o=(t=(t||"").trim()).match(/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i);this.useDefine=e,o&&o.length>1?(r=o[1],n=o[2],i=o[3]):(n=t,r="fv1"),this.name=n,this.type=r,this.value=i},ku.prototype.build=function(t,e){return"source"!==e?(t.include(this),t.format(this.name,this.getType(t),e)):this.value?this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";":void 0},ku.prototype.generate=function(t,e){return t.format(this.name,this.getType(t),e)},ku.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).name=this.name,e.out=this.type,this.value&&(e.value=this.value),!0===e.useDefine&&(e.useDefine=!0)),e},Ou.addKeyword("uv",function(){return new Nu}),Ou.addKeyword("uv2",function(){return new Nu(1)}),Ou.addKeyword("position",function(){return new Lu}),Ou.addKeyword("worldPosition",function(){return new Lu(Lu.WORLD)}),Ou.addKeyword("normal",function(){return new Iu}),Ou.addKeyword("worldNormal",function(){return new Iu(Iu.WORLD)}),Ou.addKeyword("viewPosition",function(){return new Lu(Iu.VIEW)}),Ou.addKeyword("viewNormal",function(){return new Iu(Iu.VIEW)}),Ou.addKeyword("time",function(){return new Ru}),Ou.add(new ku("vec3 LUMA vec3(0.2125, 0.7154, 0.0721)")),Ou.add(new Pu(["vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 map, vec2 mUv, vec2 scale ) {","\tvec3 q0 = dFdx( eye_pos );","\tvec3 q1 = dFdy( eye_pos );","\tvec2 st0 = dFdx( mUv.st );","\tvec2 st1 = dFdy( mUv.st );","\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );","\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );","\tvec3 N = normalize( surf_norm );","\tvec3 mapN = map * 2.0 - 1.0;","\tmapN.xy = scale * mapN.xy;","\tmat3 tsn = mat3( S, T, N );","\treturn normalize( tsn * mapN );","}"].join("\n"),null,{derivatives:!0})),Ou.add(new Pu(["float snoise(vec2 co) {","\treturn fract( sin( dot(co.xy, vec2(12.9898,78.233) ) ) * 43758.5453 );","}"].join("\n"))),Ou.add(new Pu(["vec3 hue_rgb(vec3 rgb, float adjustment) {","\tconst mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.595716, -0.274453, -0.321263, 0.211456, -0.522591, 0.311135);","\tconst mat3 YIQtoRGB = mat3(1.0, 0.9563, 0.6210, 1.0, -0.2721, -0.6474, 1.0, -1.107, 1.7046);","\tvec3 yiq = RGBtoYIQ * rgb;","\tfloat hue = atan(yiq.z, yiq.y) + adjustment;","\tfloat chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);","\treturn YIQtoRGB * vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));","}"].join("\n"))),Ou.add(new Pu(["vec3 saturation_rgb(vec3 rgb, float adjustment) {","\tvec3 intensity = vec3(dot(rgb, LUMA));","\treturn mix(intensity, rgb, adjustment);","}"].join("\n"))),Ou.add(new Pu(["float luminance_rgb(vec3 rgb) {","\treturn dot(rgb, LUMA);","}"].join("\n"))),Ou.add(new Pu(["vec3 vibrance_rgb(vec3 rgb, float adjustment) {","\tfloat average = (rgb.r + rgb.g + rgb.b) / 3.0;","\tfloat mx = max(rgb.r, max(rgb.g, rgb.b));","\tfloat amt = (mx - average) * (-3.0 * adjustment);","\treturn mix(rgb.rgb, vec3(mx), amt);","}"].join("\n"))),Pu.prototype.isShared=function(t,e){return!this.isMethod},Pu.prototype.getType=function(t){return t.getTypeByFormat(this.type)},Pu.prototype.getInputByName=function(t){for(var e=this.inputs.length;e--;)if(this.inputs[e].name===t)return this.inputs[e]},Pu.prototype.getIncludeByName=function(t){for(var e=this.includes.length;e--;)if(this.includes[e].name===t)return this.includes[e]},Pu.prototype.generate=function(t,e){for(var n,r=0,i=this.value,o=0;o<this.includes.length;o++)t.include(this.includes[o],this);for(var a in this.extensions)t.material.extensions[a]=!0;for(;n=Pu.rProperties.exec(this.value);){var s=n[0],l=!this.isMethod||!this.getInputByName(s),u=s;if(this.keywords[s]||this.useKeywords&&l&&Ou.containsKeyword(s)){var c=this.keywords[s];if(!c){var h=Ou.getKeywordData(s);h.cache&&(c=t.keywords[s]),c=c||Ou.getKeyword(s,t),h.cache&&(t.keywords[s]=c)}u=c.build(t)}s!=u&&(i=i.substring(0,n.index+r)+u+i.substring(n.index+s.length+r),r+=u.length-s.length),void 0===this.getIncludeByName(u)&&Ou.contains(u)&&t.include(Ou.get(u))}return"source"===e?i:this.isMethod?(t.include(this,!1,i),this.name):t.format("("+i+")",this.getType(t),e)};var Uu=function(t,e){Eu.call(this,"v3"),this.setScope(t||Uu.POSITION),this.setCamera(e)};Uu.fDepthColor=new Pu(["float depthColor( float mNear, float mFar ) {","\t#ifdef USE_LOGDEPTHBUF_EXT","\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;","\t#else","\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;","\t#endif","\treturn 1.0 - smoothstep( mNear, mFar, depth );","}"].join("\n")),Uu.POSITION="position",Uu.DEPTH="depth",Uu.TO_VERTEX="toVertex",Uu.prototype=Object.create(Eu.prototype),Uu.prototype.constructor=Uu,Uu.prototype.nodeType="Camera",Uu.prototype.setCamera=function(t){this.camera=t,this.updateFrame=void 0!==t?this.onUpdateFrame:void 0},Uu.prototype.setScope=function(t){switch(this.scope){case Uu.DEPTH:delete this.near,delete this.far}switch(this.scope=t,t){case Uu.DEPTH:var e=this.camera;this.near=new Fu(e?e.near:1),this.far=new Fu(e?e.far:1200)}},Uu.prototype.getType=function(t){switch(this.scope){case Uu.DEPTH:return"fv1"}return this.type},Uu.prototype.isUnique=function(t){switch(this.scope){case Uu.DEPTH:case Uu.TO_VERTEX:return!0}return!1},Uu.prototype.isShared=function(t){switch(this.scope){case Uu.POSITION:return!1}return!0},Uu.prototype.generate=function(t,e){var n;switch(this.scope){case Uu.POSITION:n="cameraPosition";break;case Uu.DEPTH:var r=Uu.fDepthColor;t.include(r),n=r.name+"("+this.near.build(t,"fv1")+","+this.far.build(t,"fv1")+")";break;case Uu.TO_VERTEX:n="normalize( "+new Lu(Lu.WORLD).build(t,"v3")+" - cameraPosition )"}return t.format(n,this.getType(t),e)},Uu.prototype.onUpdateFrame=function(t){switch(this.scope){case Uu.DEPTH:var e=this.camera;this.near.number=e.near,this.far.number=e.far}},Uu.prototype.toJSON=function(t){var e=this.getJSONNode(t);if(!e)switch(e=this.createJSONNode(t),e.scope=this.scope,this.camera&&(e.camera=this.camera.uuid),this.scope){case Uu.DEPTH:e.near=this.near.number,e.far=this.far.number}return e};Object.assign(function(t,e){this.manager=void 0!==t?t:il,this.nodes={},this.materials={},this.passes={},this.names={},this.library=e||{}}.prototype,{load:function(t,e,n,r){var i=this;return new gt(i.manager).load(t,function(t){e(i.parse(JSON.parse(t)))},n,r),this},getObjectByName:function(t){return this.names[t]},getObjectById:function(t){return this.library[t]||this.nodes[t]||this.names[t]},getNode:function(t){var e=this.getObjectById(t);return e||console.warn('Node "'+t+'" not found.'),e},parse:function(t){var e,n,r,i,o;for(e in t.nodes)n=t.nodes[e],r=new THREE[n.type],n.name?(r.name=n.name,this.names[r.name]=r):r.readonly=!0,void 0!==n.readonly&&(r.readonly=n.readonly),this.nodes[e]=r;for(e in t.materials)n=t.materials[e],r=new THREE[n.type],n.name&&(r.name=n.name,this.names[r.name]=r),this.materials[e]=r;for(e in t.passes)n=t.passes[e],r=new THREE[n.type],n.name&&(r.name=n.name,this.names[r.name]=r),this.passes[e]=r;t.material&&(this.material=this.materials[e]),t.pass&&(this.pass=this.passes[e]);for(e in t.nodes)switch(n=t.nodes[e],r=this.nodes[e],n.type){case"FloatNode":r.number=n.number;break;case"ColorNode":r.value.copy(n);break;case"Vector2Node":r.x=n.x,r.y=n.y;break;case"Vector3Node":r.x=n.x,r.y=n.y,r.z=n.z;break;case"Vector4Node":r.x=n.x,r.y=n.y,r.z=n.z,r.w=n.w;break;case"Matrix3Node":case"Matrix4Node":r.value.fromArray(n.elements);break;case"OperatorNode":r.a=this.getNode(n.a),r.b=this.getNode(n.b),r.op=n.op;break;case"Math1Node":r.a=this.getNode(n.a),r.method=n.method;break;case"Math2Node":r.a=this.getNode(n.a),r.b=this.getNode(n.b),r.method=n.method;break;case"Math3Node":r.a=this.getNode(n.a),r.b=this.getNode(n.b),r.c=this.getNode(n.c),r.method=n.method;break;case"UVNode":case"ColorsNode":r.index=n.index;break;case"LuminanceNode":r.rgb=this.getNode(n.rgb);break;case"PositionNode":case"NormalNode":case"ReflectNode":case"LightNode":r.scope=n.scope;break;case"SwitchNode":r.node=this.getNode(n.node),r.components=n.components;break;case"JoinNode":for(i in n.inputs)r[i]=this.getNode(n.inputs[i]);break;case"CameraNode":switch(r.setScope(n.scope),n.camera&&r.setCamera(this.getNode(n.camera)),n.scope){case Uu.DEPTH:r.near.number=n.near,r.far.number=n.far}break;case"ColorAdjustmentNode":r.rgb=this.getNode(n.rgb),r.adjustment=this.getNode(n.adjustment),r.method=n.method;break;case"UVTransformNode":r.uv=this.getNode(n.uv),r.transform=this.getNode(n.transform);break;case"BumpNode":r.value=this.getNode(n.value),r.coord=this.getNode(n.coord),r.scale=this.getNode(n.scale);break;case"BlurNode":r.value=this.getNode(n.value),r.coord=this.getNode(n.coord),r.scale=this.getNode(n.scale),r.value=this.getNode(n.value),r.coord=this.getNode(n.coord),r.radius=this.getNode(n.radius),void 0!==n.size&&(r.size=new m(n.size.x,n.size.y)),r.blurX=n.blurX,r.blurY=n.blurY;break;case"ResolutionNode":r.renderer=this.getNode(n.renderer);break;case"ScreenUVNode":r.resolution=this.getNode(n.resolution);break;case"VelocityNode":n.target&&r.setTarget(this.getNode(n.target)),r.setParams(n.params);break;case"TimerNode":r.scope=n.scope,r.scale=n.scale;break;case"ConstNode":r.name=n.name,r.type=n.out,r.value=n.value,r.useDefine=!0===n.useDefine;break;case"AttributeNode":case"VarNode":r.type=n.out;break;case"ReflectorNode":r.setMirror(this.getNode(n.mirror)),n.offset&&(r.offset=this.getNode(n.offset));break;case"NoiseNode":r.coord=this.getNode(n.coord);break;case"FunctionNode":r.isMethod=n.isMethod,r.useKeywords=n.useKeywords,r.extensions=n.extensions,r.keywords={};for(i in n.keywords)r.keywords[i]=this.getNode(n.keywords[i]);if(n.includes)for(o=0;o<n.includes.length;o++)r.includes.push(this.getNode(n.includes[o]));r.eval(n.src,r.includes,r.extensions,r.keywords),r.isMethod||(r.type=n.out);break;case"FunctionCallNode":for(i in n.inputs)r.inputs[i]=this.getNode(n.inputs[i]);r.value=this.getNode(n.value);break;case"TextureNode":case"CubeTextureNode":case"ScreenNode":n.value&&(r.value=this.getNode(n.value)),r.coord=this.getNode(n.coord),n.bias&&(r.bias=this.getNode(n.bias)),void 0!==r.project&&(r.project=n.project);break;case"RoughnessToBlinnExponentNode":break;case"RawNode":r.value=this.getNode(n.value);break;case"StandardNode":case"PhongNode":case"SpriteNode":r.color=this.getNode(n.color),n.alpha&&(r.alpha=this.getNode(n.alpha)),n.specular&&(r.specular=this.getNode(n.specular)),n.shininess&&(r.shininess=this.getNode(n.shininess)),n.roughness&&(r.roughness=this.getNode(n.roughness)),n.metalness&&(r.metalness=this.getNode(n.metalness)),n.reflectivity&&(r.reflectivity=this.getNode(n.reflectivity)),n.clearCoat&&(r.clearCoat=this.getNode(n.clearCoat)),n.clearCoatRoughness&&(r.clearCoatRoughness=this.getNode(n.clearCoatRoughness)),n.normal&&(r.normal=this.getNode(n.normal)),n.normalScale&&(r.normalScale=this.getNode(n.normalScale)),n.emissive&&(r.emissive=this.getNode(n.emissive)),n.ambient&&(r.ambient=this.getNode(n.ambient)),n.shadow&&(r.shadow=this.getNode(n.shadow)),n.light&&(r.light=this.getNode(n.light)),n.ao&&(r.ao=this.getNode(n.ao)),n.environment&&(r.environment=this.getNode(n.environment)),n.environmentAlpha&&(r.environmentAlpha=this.getNode(n.environmentAlpha)),n.transform&&(r.transform=this.getNode(n.transform)),!1===n.spherical&&(r.spherical=!1);break;default:console.warn(n.type,"not supported.")}for(e in t.materials)r=this.materials[e],void 0!==(n=t.materials[e]).name&&(r.name=n.name),void 0!==n.blending&&(r.blending=n.blending),void 0!==n.flatShading&&(r.flatShading=n.flatShading),void 0!==n.side&&(r.side=n.side),r.depthFunc=n.depthFunc,r.depthTest=n.depthTest,r.depthWrite=n.depthWrite,void 0!==n.wireframe&&(r.wireframe=n.wireframe),void 0!==n.wireframeLinewidth&&(r.wireframeLinewidth=n.wireframeLinewidth),void 0!==n.wireframeLinecap&&(r.wireframeLinecap=n.wireframeLinecap),void 0!==n.wireframeLinejoin&&(r.wireframeLinejoin=n.wireframeLinejoin),void 0!==n.skinning&&(r.skinning=n.skinning),void 0!==n.morphTargets&&(r.morphTargets=n.morphTargets),void 0!==n.visible&&(r.visible=n.visible),void 0!==n.userData&&(r.userData=n.userData),r.vertex=this.getNode(n.vertex),r.fragment=this.getNode(n.fragment),r.vertex===r.fragment&&(r.node=r.vertex),r.build(),void 0!==n.fog&&(r.fog=n.fog),void 0!==n.lights&&(r.lights=n.lights),void 0!==n.transparent&&(r.transparent=n.transparent);for(e in t.passes)(r=this.passes[e]).value=this.getNode((n=t.passes[e]).value),r.build();return this.material||this.pass||this}});!function(){function t(t){this.manager=void 0!==t?t:il,this.materials=null}var e=/^[og]\s*(.+)?/,n=/^mtllib /,r=/^usemtl /;t.prototype={constructor:t,load:function(t,e,n,r){var i=this,o=new gt(i.manager);o.setPath(this.path),o.load(t,function(t){e(i.parse(t))},n,r)},setPath:function(t){this.path=t},setMaterials:function(t){return this.materials=t,this},parse:function(t){console.time("OBJLoader");var i=new function(){var t={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materialLibraries:[],startObject:function(t,e){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=t,void(this.object.fromDeclaration=!1!==e);var n=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:!1!==e,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(t,e){var n=this._finalize(!1);n&&(n.inherited||n.groupCount<=0)&&this.materials.splice(n.index,1);var r={index:this.materials.length,name:t||"",mtllib:Array.isArray(e)&&e.length>0?e[e.length-1]:"",smooth:void 0!==n?n.smooth:this.smooth,groupStart:void 0!==n?n.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(t){var e={index:"number"==typeof t?t:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return e.clone=this.clone.bind(e),e}};return this.materials.push(r),r},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(t){var e=this.currentMaterial();if(e&&-1===e.groupEnd&&(e.groupEnd=this.geometry.vertices.length/3,e.groupCount=e.groupEnd-e.groupStart,e.inherited=!1),t&&this.materials.length>1)for(var n=this.materials.length-1;n>=0;n--)this.materials[n].groupCount<=0&&this.materials.splice(n,1);return t&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),e}},n&&n.name&&"function"==typeof n.clone){var r=n.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(t,e){var n=parseInt(t,10);return 3*(n>=0?n-1:n+e/3)},parseNormalIndex:function(t,e){var n=parseInt(t,10);return 3*(n>=0?n-1:n+e/3)},parseUVIndex:function(t,e){var n=parseInt(t,10);return 2*(n>=0?n-1:n+e/2)},addVertex:function(t,e,n){var r=this.vertices,i=this.object.geometry.vertices;i.push(r[t+0],r[t+1],r[t+2]),i.push(r[e+0],r[e+1],r[e+2]),i.push(r[n+0],r[n+1],r[n+2])},addVertexPoint:function(t){var e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addVertexLine:function(t){var e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addNormal:function(t,e,n){var r=this.normals,i=this.object.geometry.normals;i.push(r[t+0],r[t+1],r[t+2]),i.push(r[e+0],r[e+1],r[e+2]),i.push(r[n+0],r[n+1],r[n+2])},addColor:function(t,e,n){var r=this.colors,i=this.object.geometry.colors;i.push(r[t+0],r[t+1],r[t+2]),i.push(r[e+0],r[e+1],r[e+2]),i.push(r[n+0],r[n+1],r[n+2])},addUV:function(t,e,n){var r=this.uvs,i=this.object.geometry.uvs;i.push(r[t+0],r[t+1]),i.push(r[e+0],r[e+1]),i.push(r[n+0],r[n+1])},addUVLine:function(t){var e=this.uvs;this.object.geometry.uvs.push(e[t+0],e[t+1])},addFace:function(t,e,n,r,i,o,a,s,l){var u=this.vertices.length,c=this.parseVertexIndex(t,u),h=this.parseVertexIndex(e,u),p=this.parseVertexIndex(n,u);if(this.addVertex(c,h,p),void 0!==r&&""!==r){var d=this.uvs.length;c=this.parseUVIndex(r,d),h=this.parseUVIndex(i,d),p=this.parseUVIndex(o,d),this.addUV(c,h,p)}if(void 0!==a&&""!==a){var f=this.normals.length;c=this.parseNormalIndex(a,f),h=a===s?c:this.parseNormalIndex(s,f),p=a===l?c:this.parseNormalIndex(l,f),this.addNormal(c,h,p)}this.colors.length>0&&this.addColor(c,h,p)},addPointGeometry:function(t){this.object.geometry.type="Points";for(var e=this.vertices.length,n=0,r=t.length;n<r;n++)this.addVertexPoint(this.parseVertexIndex(t[n],e))},addLineGeometry:function(t,e){this.object.geometry.type="Line";for(var n=this.vertices.length,r=this.uvs.length,i=0,o=t.length;i<o;i++)this.addVertexLine(this.parseVertexIndex(t[i],n));var a=0;for(o=e.length;a<o;a++)this.addUVLine(this.parseUVIndex(e[a],r))}};return t.startObject("",!1),t};-1!==t.indexOf("\r\n")&&(t=t.replace(/\r\n/g,"\n")),-1!==t.indexOf("\\\n")&&(t=t.replace(/\\\n/g,""));for(var o=t.split("\n"),a="",s="",l=[],u="function"==typeof"".trimLeft,c=0,h=o.length;c<h;c++)if(a=o[c],a=u?a.trimLeft():a.trim(),0!==a.length&&"#"!==(s=a.charAt(0)))if("v"===s){var p=a.split(/\s+/);switch(p[0]){case"v":i.vertices.push(parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3])),8===p.length&&i.colors.push(parseFloat(p[4]),parseFloat(p[5]),parseFloat(p[6]));break;case"vn":i.normals.push(parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3]));break;case"vt":i.uvs.push(parseFloat(p[1]),parseFloat(p[2]))}}else if("f"===s){for(var d=a.substr(1).trim().split(/\s+/),f=[],m=0,v=d.length;m<v;m++){var g=d[m];if(g.length>0){var y=g.split("/");f.push(y)}}var b=f[0];for(m=1,v=f.length-1;m<v;m++){var _=f[m],x=f[m+1];i.addFace(b[0],_[0],x[0],b[1],_[1],x[1],b[2],_[2],x[2])}}else if("l"===s){var w=a.substring(1).trim().split(" "),S=[],A=[];if(-1===a.indexOf("/"))S=w;else for(var M=0,C=w.length;M<C;M++){var E=w[M].split("/");""!==E[0]&&S.push(E[0]),""!==E[1]&&A.push(E[1])}i.addLineGeometry(S,A)}else if("p"===s){var P=a.substr(1).trim().split(" ");i.addPointGeometry(P)}else if(null!==(l=e.exec(a))){var N=(" "+l[0].substr(1).trim()).substr(1);i.startObject(N)}else if(r.test(a))i.object.startMaterial(a.substring(7).trim(),i.materialLibraries);else if(n.test(a))i.materialLibraries.push(a.substring(7).trim());else{if("s"!==s){if("\0"===a)continue;throw new Error('OBJLoader: Unexpected line: "'+a+'"')}if((l=a.split(" ")).length>1){var L=l[1].trim().toLowerCase();i.object.smooth="0"!==L&&"off"!==L}else i.object.smooth=!0;(Y=i.object.currentMaterial())&&(Y.smooth=i.object.smooth)}i.finalize();var I=new Me;I.materialLibraries=[].concat(i.materialLibraries);for(c=0,h=i.objects.length;c<h;c++){var D=i.objects[c],R=D.geometry,k=D.materials,U="Line"===R.type,j="Points"===R.type,z=!1;if(0!==R.vertices.length){var V=new O;V.addAttribute("position",new T(R.vertices,3)),R.normals.length>0?V.addAttribute("normal",new T(R.normals,3)):V.computeVertexNormals(),R.colors.length>0&&(z=!0,V.addAttribute("color",new T(R.colors,3))),R.uvs.length>0&&V.addAttribute("uv",new T(R.uvs,2));for(var G=[],H=0,W=k.length;H<W;H++){var X=k[H],Y=void 0;if(null!==this.materials)if(Y=this.materials.create(X.name),!U||!Y||Y instanceof F){if(j&&Y&&!(Y instanceof Tt)){var q=new Tt({size:10,sizeAttenuation:!1});Z.copy(Y),Y=q}}else{var Z=new F;Z.copy(Y),Z.lights=!1,Y=Z}Y||((Y=U?new F:j?new Tt({size:1,sizeAttenuation:!1}):new wt).name=X.name),Y.flatShading=!X.smooth,Y.vertexColors=z?Bo:Uo,G.push(Y)}var Q;if(G.length>1){for(H=0,W=k.length;H<W;H++){V.addGroup((X=k[H]).groupStart,X.groupCount,H)}Q=U?new je(V,G):j?new be(V,G):new B(V,G)}else Q=U?new je(V,G[0]):j?new be(V,G[0]):new B(V,G[0]);Q.name=D.name,I.add(Q)}}return console.timeEnd("OBJLoader"),I}}}();void 0===gu&&console.error('"LoaderSupport" is not available. "OBJLoader2" requires it. Please include "LoaderSupport.js" in your HTML.');!function(){function t(t){console.info("Using OBJLoader2 version: "+e),this.manager=n.verifyInput(t,il),this.logging={enabled:!0,debug:!1},this.modelName="",this.instanceNo=0,this.path="",this.useIndices=!1,this.disregardNormals=!1,this.materialPerSmoothingGroup=!1,this.loaderRootNode=new Me,this.meshBuilder=new gu.MeshBuilder,this.callbacks=new gu.Callbacks,this.workerSupport=new gu.WorkerSupport,this.terminateWorkerOnLoad=!0}var e="2.4.0",n=gu.Validator;t.prototype.setLogging=function(t,e){this.logging.enabled=!0===t,this.logging.debug=!0===e,this.meshBuilder.setLogging(this.logging.enabled,this.logging.debug)},t.prototype.setModelName=function(t){this.modelName=n.verifyInput(t,this.modelName)},t.prototype.setPath=function(t){this.path=n.verifyInput(t,this.path)},t.prototype.setStreamMeshesTo=function(t){this.loaderRootNode=n.verifyInput(t,this.loaderRootNode)},t.prototype.setMaterials=function(t){this.meshBuilder.setMaterials(t)},t.prototype.setUseIndices=function(t){this.useIndices=!0===t},t.prototype.setDisregardNormals=function(t){this.disregardNormals=!0===t},t.prototype.setMaterialPerSmoothingGroup=function(t){this.materialPerSmoothingGroup=!0===t},t.prototype._setCallbacks=function(t){n.isValid(t.onProgress)&&this.callbacks.setCallbackOnProgress(t.onProgress),n.isValid(t.onMeshAlter)&&this.callbacks.setCallbackOnMeshAlter(t.onMeshAlter),n.isValid(t.onLoad)&&this.callbacks.setCallbackOnLoad(t.onLoad),n.isValid(t.onLoadMaterials)&&this.callbacks.setCallbackOnLoadMaterials(t.onLoadMaterials),this.meshBuilder._setCallbacks(this.callbacks)},t.prototype.onProgress=function(t,e,r){var i=n.isValid(e)?e:"",o={detail:{type:t,modelName:this.modelName,instanceNo:this.instanceNo,text:i,numericalValue:r}};n.isValid(this.callbacks.onProgress)&&this.callbacks.onProgress(o),this.logging.enabled&&this.logging.debug&&console.debug(i)},t.prototype._onError=function(t){var e="Error occurred while downloading!";throw t.currentTarget&&null!==t.currentTarget.statusText&&(e+="\nurl: "+t.currentTarget.responseURL+"\nstatus: "+t.currentTarget.statusText),this.onProgress("error",e,-1),e},t.prototype.load=function(t,e,n,r,i,o){var a=new gu.ResourceDescriptor(t,"OBJ");this._loadObj(a,e,n,r,i,o)},t.prototype._loadObj=function(t,e,r,i,o,a){n.isValid(i)||(i=this._onError),n.isValid(t)||i("An invalid ResourceDescriptor was provided. Unable to continue!");var s=this,l=function(n){if(t.content=n,a)s.parseAsync(n,e);else{var r=new gu.Callbacks;r.setCallbackOnMeshAlter(o),s._setCallbacks(r),e({detail:{loaderRootNode:s.parse(n),modelName:s.modelName,instanceNo:s.instanceNo}})}};if(!n.isValid(t.url)||n.isValid(t.content))l(n.isValid(t.content)?t.content:null);else{if(!n.isValid(r)){var u=0,c=0;r=function(e){if(e.lengthComputable&&(c=e.loaded/e.total)>u){u=c;var n='Download of "'+t.url+'": '+(100*c).toFixed(2)+"%";s.onProgress("progressLoad",n,c)}}}var h=new gt(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.load(t.url,l,r,i)}},t.prototype.run=function(t,e){this._applyPrepData(t);var r=t.checkResourceDescriptorFiles(t.resources,[{ext:"obj",type:"ArrayBuffer",ignore:!1},{ext:"mtl",type:"String",ignore:!1},{ext:"zip",type:"String",ignore:!0}]);n.isValid(e)&&(this.terminateWorkerOnLoad=!1,this.workerSupport=e,this.logging.enabled=this.workerSupport.logging.enabled,this.logging.debug=this.workerSupport.logging.debug);var i=this;this._loadMtl(r.mtl,function(e){null!==e&&i.meshBuilder.setMaterials(e),i._loadObj(r.obj,i.callbacks.onLoad,null,null,i.callbacks.onMeshAlter,t.useAsync)},t.crossOrigin,t.materialOptions)},t.prototype._applyPrepData=function(t){n.isValid(t)&&(this.setLogging(t.logging.enabled,t.logging.debug),this.setModelName(t.modelName),this.setStreamMeshesTo(t.streamMeshesTo),this.meshBuilder.setMaterials(t.materials),this.setUseIndices(t.useIndices),this.setDisregardNormals(t.disregardNormals),this.setMaterialPerSmoothingGroup(t.materialPerSmoothingGroup),this._setCallbacks(t.getCallbacks()))},t.prototype.parse=function(t){if(!n.isValid(t))return console.warn("Provided content is not a valid ArrayBuffer or String."),this.loaderRootNode;this.logging.enabled&&console.time("OBJLoader2 parse: "+this.modelName),this.meshBuilder.init();var e=new r;e.setLogging(this.logging.enabled,this.logging.debug),e.setMaterialPerSmoothingGroup(this.materialPerSmoothingGroup),e.setUseIndices(this.useIndices),e.setDisregardNormals(this.disregardNormals),e.setMaterials(this.meshBuilder.getMaterials());var i=this;e.setCallbackMeshBuilder(function(t){var e=i.meshBuilder.processPayload(t);for(var n in e)i.loaderRootNode.add(e[n])});if(e.setCallbackProgress(function(t,e){i.onProgress("progressParse",t,e)}),t instanceof ArrayBuffer||t instanceof Uint8Array)this.logging.enabled&&console.info("Parsing arrayBuffer..."),e.parse(t);else{if(!("string"==typeof t||t instanceof String))throw"Provided content was neither of type String nor Uint8Array! Aborting...";this.logging.enabled&&console.info("Parsing text..."),e.parseText(t)}return this.logging.enabled&&console.timeEnd("OBJLoader2 parse: "+this.modelName),this.loaderRootNode},t.prototype.parseAsync=function(t,e){var i=this,o=!1,a=function(){e({detail:{loaderRootNode:i.loaderRootNode,modelName:i.modelName,instanceNo:i.instanceNo}}),o&&i.logging.enabled&&console.timeEnd("OBJLoader2 parseAsync: "+i.modelName)};n.isValid(t)?o=!0:(console.warn("Provided content is not a valid ArrayBuffer."),a()),o&&this.logging.enabled&&console.time("OBJLoader2 parseAsync: "+this.modelName),this.meshBuilder.init();this.workerSupport.validate(function(t,e){var i="";return i+="\n\n",i+="var LoaderSupport = {};\n\n",i+=t("LoaderSupport.Validator",n),i+=e("Parser",r)},"Parser"),this.workerSupport.setCallbacks(function(t){var e=i.meshBuilder.processPayload(t);for(var n in e)i.loaderRootNode.add(e[n])},a),i.terminateWorkerOnLoad&&this.workerSupport.setTerminateRequested(!0);var s={},l=this.meshBuilder.getMaterials();for(var u in l)s[u]=u;this.workerSupport.run({params:{useAsync:!0,materialPerSmoothingGroup:this.materialPerSmoothingGroup,useIndices:this.useIndices,disregardNormals:this.disregardNormals},logging:{enabled:this.logging.enabled,debug:this.logging.debug},materials:{materials:s},data:{input:t,options:null}})};var r=function(){function t(){this.callbackProgress=null,this.callbackMeshBuilder=null,this.contentRef=null,this.legacyMode=!1,this.materials={},this.useAsync=!1,this.materialPerSmoothingGroup=!1,this.useIndices=!1,this.disregardNormals=!1,this.vertices=[],this.colors=[],this.normals=[],this.uvs=[],this.rawMesh={objectName:"",groupName:"",activeMtlName:"",mtllibName:"",faceType:-1,subGroups:[],subGroupInUse:null,smoothingGroup:{splitMaterials:!1,normalized:-1,real:-1},counts:{doubleIndicesCount:0,faceCount:0,mtlCount:0,smoothingGroupCount:0}},this.inputObjectCount=1,this.outputObjectCount=1,this.globalCounts={vertices:0,faces:0,doubleIndicesCount:0,lineByte:0,currentByte:0,totalBytes:0},this.logging={enabled:!0,debug:!1}}return t.prototype.resetRawMesh=function(){this.rawMesh.subGroups=[],this.rawMesh.subGroupInUse=null,this.rawMesh.smoothingGroup.normalized=-1,this.rawMesh.smoothingGroup.real=-1,this.pushSmoothingGroup(1),this.rawMesh.counts.doubleIndicesCount=0,this.rawMesh.counts.faceCount=0,this.rawMesh.counts.mtlCount=0,this.rawMesh.counts.smoothingGroupCount=0},t.prototype.setUseAsync=function(t){this.useAsync=t},t.prototype.setMaterialPerSmoothingGroup=function(t){this.materialPerSmoothingGroup=t},t.prototype.setUseIndices=function(t){this.useIndices=t},t.prototype.setDisregardNormals=function(t){this.disregardNormals=t},t.prototype.setMaterials=function(t){this.materials=gu.Validator.verifyInput(t,this.materials),this.materials=gu.Validator.verifyInput(this.materials,{})},t.prototype.setCallbackMeshBuilder=function(t){if(!gu.Validator.isValid(t))throw'Unable to run as no "MeshBuilder" callback is set.';this.callbackMeshBuilder=t},t.prototype.setCallbackProgress=function(t){this.callbackProgress=t},t.prototype.setLogging=function(t,e){this.logging.enabled=!0===t,this.logging.debug=!0===e},t.prototype.configure=function(){if(this.pushSmoothingGroup(1),this.logging.enabled){var t=Object.keys(this.materials),e="OBJLoader2.Parser configuration:"+(t.length>0?"\n\tmaterialNames:\n\t\t- "+t.join("\n\t\t- "):"\n\tmaterialNames: None")+"\n\tuseAsync: "+this.useAsync+"\n\tmaterialPerSmoothingGroup: "+this.materialPerSmoothingGroup+"\n\tuseIndices: "+this.useIndices+"\n\tdisregardNormals: "+this.disregardNormals+"\n\tcallbackMeshBuilderName: "+this.callbackMeshBuilder.name+"\n\tcallbackProgressName: "+this.callbackProgress.name;console.info(e)}},t.prototype.parse=function(t){this.logging.enabled&&console.time("OBJLoader2.Parser.parse"),this.configure();var e=new Uint8Array(t);this.contentRef=e;var n=e.byteLength;this.globalCounts.totalBytes=n;for(var r,i=new Array(128),o="",a=0,s=0,l=0;l<n;l++)switch(r=e[l]){case 32:o.length>0&&(i[a++]=o),o="";break;case 47:o.length>0&&(i[a++]=o),s++,o="";break;case 10:o.length>0&&(i[a++]=o),o="",this.globalCounts.lineByte=this.globalCounts.currentByte,this.globalCounts.currentByte=l,this.processLine(i,a,s),a=0,s=0;break;case 13:break;default:o+=String.fromCharCode(r)}this.finalizeParsing(),this.logging.enabled&&console.timeEnd("OBJLoader2.Parser.parse")},t.prototype.parseText=function(t){this.logging.enabled&&console.time("OBJLoader2.Parser.parseText"),this.configure(),this.legacyMode=!0,this.contentRef=t;var e=t.length;this.globalCounts.totalBytes=e;for(var n,r=new Array(128),i="",o=0,a=0,s=0;s<e;s++)switch(n=t[s]){case" ":i.length>0&&(r[o++]=i),i="";break;case"/":i.length>0&&(r[o++]=i),a++,i="";break;case"\n":i.length>0&&(r[o++]=i),i="",this.globalCounts.lineByte=this.globalCounts.currentByte,this.globalCounts.currentByte=s,this.processLine(r,o,a),o=0,a=0;break;case"\r":break;default:i+=n}this.finalizeParsing(),this.logging.enabled&&console.timeEnd("OBJLoader2.Parser.parseText")},t.prototype.processLine=function(t,e,n){if(!(e<1)){var r,i,o,a,s=function(t,e,n,r){var i="";if(r>n){var o;if(e)for(o=n;o<r;o++)i+=t[o];else for(o=n;o<r;o++)i+=String.fromCharCode(t[o]);i=i.trim()}return i};switch(a=t[0]){case"v":this.vertices.push(parseFloat(t[1])),this.vertices.push(parseFloat(t[2])),this.vertices.push(parseFloat(t[3])),e>4&&(this.colors.push(parseFloat(t[4])),this.colors.push(parseFloat(t[5])),this.colors.push(parseFloat(t[6])));break;case"vt":this.uvs.push(parseFloat(t[1])),this.uvs.push(parseFloat(t[2]));break;case"vn":this.normals.push(parseFloat(t[1])),this.normals.push(parseFloat(t[2])),this.normals.push(parseFloat(t[3]));break;case"f":if(r=e-1,0===n)for(this.checkFaceType(0),o=2,i=r;o<i;o++)this.buildFace(t[1]),this.buildFace(t[o]),this.buildFace(t[o+1]);else if(r===2*n)for(this.checkFaceType(1),o=3,i=r-2;o<i;o+=2)this.buildFace(t[1],t[2]),this.buildFace(t[o],t[o+1]),this.buildFace(t[o+2],t[o+3]);else if(2*r==3*n)for(this.checkFaceType(2),o=4,i=r-3;o<i;o+=3)this.buildFace(t[1],t[2],t[3]),this.buildFace(t[o],t[o+1],t[o+2]),this.buildFace(t[o+3],t[o+4],t[o+5]);else for(this.checkFaceType(3),o=3,i=r-2;o<i;o+=2)this.buildFace(t[1],void 0,t[2]),this.buildFace(t[o],void 0,t[o+1]),this.buildFace(t[o+2],void 0,t[o+3]);break;case"l":case"p":if((r=e-1)==2*n)for(this.checkFaceType(4),o=1,i=r+1;o<i;o+=2)this.buildFace(t[o],t[o+1]);else for(this.checkFaceType("l"===a?5:6),o=1,i=r+1;o<i;o++)this.buildFace(t[o]);break;case"s":this.pushSmoothingGroup(t[1]);break;case"g":this.processCompletedMesh(),this.rawMesh.groupName=s(this.contentRef,this.legacyMode,this.globalCounts.lineByte+2,this.globalCounts.currentByte);break;case"o":this.rawMesh.objectName=s(this.contentRef,this.legacyMode,this.globalCounts.lineByte+2,this.globalCounts.currentByte);break;case"mtllib":this.rawMesh.mtllibName=s(this.contentRef,this.legacyMode,this.globalCounts.lineByte+7,this.globalCounts.currentByte);break;case"usemtl":var l=s(this.contentRef,this.legacyMode,this.globalCounts.lineByte+7,this.globalCounts.currentByte);""!==l&&this.rawMesh.activeMtlName!==l&&(this.rawMesh.activeMtlName=l,this.rawMesh.counts.mtlCount++,this.checkSubGroup())}}},t.prototype.pushSmoothingGroup=function(t){var e=parseInt(t);isNaN(e)&&(e="off"===t?0:1);var n=this.rawMesh.smoothingGroup.normalized;this.rawMesh.smoothingGroup.normalized=this.rawMesh.smoothingGroup.splitMaterials?e:0===e?0:1,this.rawMesh.smoothingGroup.real=e,n!==e&&(this.rawMesh.counts.smoothingGroupCount++,this.checkSubGroup())},t.prototype.checkFaceType=function(t){this.rawMesh.faceType!==t&&(this.processCompletedMesh(),this.rawMesh.faceType=t,this.checkSubGroup())},t.prototype.checkSubGroup=function(){var t=this.rawMesh.activeMtlName+"|"+this.rawMesh.smoothingGroup.normalized;this.rawMesh.subGroupInUse=this.rawMesh.subGroups[t],gu.Validator.isValid(this.rawMesh.subGroupInUse)||(this.rawMesh.subGroupInUse={index:t,objectName:this.rawMesh.objectName,groupName:this.rawMesh.groupName,materialName:this.rawMesh.activeMtlName,smoothingGroup:this.rawMesh.smoothingGroup.normalized,vertices:[],indexMappingsCount:0,indexMappings:[],indices:[],colors:[],uvs:[],normals:[]},this.rawMesh.subGroups[t]=this.rawMesh.subGroupInUse)},t.prototype.buildFace=function(t,e,n){this.disregardNormals&&(n=void 0);var r=this,i=function(){var i=parseInt(t),o=3*(i>0?i-1:i+r.vertices.length/3),a=r.rawMesh.subGroupInUse.vertices;a.push(r.vertices[o++]),a.push(r.vertices[o++]),a.push(r.vertices[o]);var s=r.colors.length>0?o:null;if(null!==s){var l=r.rawMesh.subGroupInUse.colors;l.push(r.colors[s++]),l.push(r.colors[s++]),l.push(r.colors[s])}if(e){var u=parseInt(e),c=2*(u>0?u-1:u+r.uvs.length/2),h=r.rawMesh.subGroupInUse.uvs;h.push(r.uvs[c++]),h.push(r.uvs[c])}if(n){var p=parseInt(n),d=3*(p>0?p-1:p+r.normals.length/3),f=r.rawMesh.subGroupInUse.normals;f.push(r.normals[d++]),f.push(r.normals[d++]),f.push(r.normals[d])}};if(this.useIndices){var o=t+(e?"_"+e:"_n")+(n?"_"+n:"_n"),a=this.rawMesh.subGroupInUse.indexMappings[o];gu.Validator.isValid(a)?this.rawMesh.counts.doubleIndicesCount++:(a=this.rawMesh.subGroupInUse.vertices.length/3,i(),this.rawMesh.subGroupInUse.indexMappings[o]=a,this.rawMesh.subGroupInUse.indexMappingsCount++),this.rawMesh.subGroupInUse.indices.push(a)}else i();this.rawMesh.counts.faceCount++},t.prototype.createRawMeshReport=function(t){return"Input Object number: "+t+"\n\tObject name: "+this.rawMesh.objectName+"\n\tGroup name: "+this.rawMesh.groupName+"\n\tMtllib name: "+this.rawMesh.mtllibName+"\n\tVertex count: "+this.vertices.length/3+"\n\tNormal count: "+this.normals.length/3+"\n\tUV count: "+this.uvs.length/2+"\n\tSmoothingGroup count: "+this.rawMesh.counts.smoothingGroupCount+"\n\tMaterial count: "+this.rawMesh.counts.mtlCount+"\n\tReal MeshOutputGroup count: "+this.rawMesh.subGroups.length},t.prototype.finalizeRawMesh=function(){var t,e,n=[],r=0,i=0,o=0,a=0,s=0,l=0;for(var u in this.rawMesh.subGroups)if((t=this.rawMesh.subGroups[u]).vertices.length>0){if((e=t.indices).length>0&&i>0)for(var c in e)e[c]=e[c]+i;n.push(t),r+=t.vertices.length,i+=t.indexMappingsCount,o+=t.indices.length,a+=t.colors.length,l+=t.uvs.length,s+=t.normals.length}var h=null;return n.length>0&&(h={name:""!==this.rawMesh.groupName?this.rawMesh.groupName:this.rawMesh.objectName,subGroups:n,absoluteVertexCount:r,absoluteIndexCount:o,absoluteColorCount:a,absoluteNormalCount:s,absoluteUvCount:l,faceCount:this.rawMesh.counts.faceCount,doubleIndicesCount:this.rawMesh.counts.doubleIndicesCount}),h},t.prototype.processCompletedMesh=function(){var t=this.finalizeRawMesh();if(gu.Validator.isValid(t)){if(this.colors.length>0&&this.colors.length!==this.vertices.length)throw"Vertex Colors were detected, but vertex count and color count do not match!";this.logging.enabled&&this.logging.debug&&console.debug(this.createRawMeshReport(this.inputObjectCount)),this.inputObjectCount++,this.buildMesh(t);var e=this.globalCounts.currentByte/this.globalCounts.totalBytes;return this.callbackProgress("Completed [o: "+this.rawMesh.objectName+" g:"+this.rawMesh.groupName+"] Total progress: "+(100*e).toFixed(2)+"%",e),this.resetRawMesh(),!0}return!1},t.prototype.buildMesh=function(t){var e=t.subGroups,n=new Float32Array(t.absoluteVertexCount);this.globalCounts.vertices+=t.absoluteVertexCount/3,this.globalCounts.faces+=t.faceCount,this.globalCounts.doubleIndicesCount+=t.doubleIndicesCount;var r,i,o,a,s,l,u=t.absoluteIndexCount>0?new Uint32Array(t.absoluteIndexCount):null,c=t.absoluteColorCount>0?new Float32Array(t.absoluteColorCount):null,h=t.absoluteNormalCount>0?new Float32Array(t.absoluteNormalCount):null,p=t.absoluteUvCount>0?new Float32Array(t.absoluteUvCount):null,d=gu.Validator.isValid(c),f=[],m=e.length>1,v=0,g=[],y=[],b=0,_=0,x=0,w=0,S=0,A=0,M=0;for(var T in e)if(e.hasOwnProperty(T)){if(r=e[T],l=r.materialName,s=this.rawMesh.faceType<4?l+(d?"_vertexColor":"")+(0===r.smoothingGroup?"_flat":""):6===this.rawMesh.faceType?"defaultPointMaterial":"defaultLineMaterial",o=this.materials[l],a=this.materials[s],!gu.Validator.isValid(o)&&!gu.Validator.isValid(a)){var C=d?"defaultVertexColorMaterial":"defaultMaterial";o=this.materials[C],this.logging.enabled&&console.warn('object_group "'+r.objectName+"_"+r.groupName+'" was defined with unresolvable material "'+l+'"! Assigning "'+C+'".'),(l=C)===s&&(a=o,s=C)}if(!gu.Validator.isValid(a)){var E={materialNameOrg:l,materialName:s,materialProperties:{vertexColors:d?2:0,flatShading:0===r.smoothingGroup}};this.callbackMeshBuilder({cmd:"materialData",materials:{materialCloneInstructions:E}}),this.useAsync&&(this.materials[s]=E)}if(m?((i=g[s])||(i=v,g[s]=v,f.push(s),v++),y.push({start:A,count:M=this.useIndices?r.indices.length:r.vertices.length/3,index:i}),A+=M):f.push(s),n.set(r.vertices,b),b+=r.vertices.length,u&&(u.set(r.indices,_),_+=r.indices.length),c&&(c.set(r.colors,x),x+=r.colors.length),h&&(h.set(r.normals,w),w+=r.normals.length),p&&(p.set(r.uvs,S),S+=r.uvs.length),this.logging.enabled&&this.logging.debug){var P=gu.Validator.isValid(i)?"\n\t\tmaterialIndex: "+i:"",O="\tOutput Object no.: "+this.outputObjectCount+"\n\t\tgroupName: "+r.groupName+"\n\t\tIndex: "+r.index+"\n\t\tfaceType: "+this.rawMesh.faceType+"\n\t\tmaterialName: "+r.materialName+"\n\t\tsmoothingGroup: "+r.smoothingGroup+P+"\n\t\tobjectName: "+r.objectName+"\n\t\t#vertices: "+r.vertices.length/3+"\n\t\t#indices: "+r.indices.length+"\n\t\t#colors: "+r.colors.length/3+"\n\t\t#uvs: "+r.uvs.length/2+"\n\t\t#normals: "+r.normals.length/3;console.debug(O)}}this.outputObjectCount++,this.callbackMeshBuilder({cmd:"meshData",progress:{numericalValue:this.globalCounts.currentByte/this.globalCounts.totalBytes},params:{meshName:t.name},materials:{multiMaterial:m,materialNames:f,materialGroups:y},buffers:{vertices:n,indices:u,colors:c,normals:h,uvs:p},geometryType:this.rawMesh.faceType<4?0:6===this.rawMesh.faceType?2:1},[n.buffer],gu.Validator.isValid(u)?[u.buffer]:null,gu.Validator.isValid(c)?[c.buffer]:null,gu.Validator.isValid(h)?[h.buffer]:null,gu.Validator.isValid(p)?[p.buffer]:null)},t.prototype.finalizeParsing=function(){if(this.logging.enabled&&console.info("Global output object count: "+this.outputObjectCount),this.processCompletedMesh()&&this.logging.enabled){var t="Overall counts: \n\tVertices: "+this.globalCounts.vertices+"\n\tFaces: "+this.globalCounts.faces+"\n\tMultiple definitions: "+this.globalCounts.doubleIndicesCount;console.info(t)}},t}();t.prototype.loadMtl=function(t,e,n,r,i){var o=new gu.ResourceDescriptor(t,"MTL");o.setContent(e),this._loadMtl(o,n,r,i)},t.prototype._loadMtl=function(t,e,r,i){void 0===Tu&&console.error('"MTLLoader" is not available. "OBJLoader2" requires it for loading MTL files.'),n.isValid(t)&&this.logging.enabled&&console.time("Loading MTL: "+t.name);var o=[],a=this,s=function(r){var i=[];if(n.isValid(r)){r.preload(),i=r.materials;for(var s in i)i.hasOwnProperty(s)&&(o[s]=i[s])}n.isValid(t)&&a.logging.enabled&&console.timeEnd("Loading MTL: "+t.name),e(o,r)};if(n.isValid(t)&&(n.isValid(t.content)||n.isValid(t.url))){var l=new Tu(this.manager);if(r=n.verifyInput(r,"anonymous"),l.setCrossOrigin(r),l.setPath(t.path),n.isValid(i)&&l.setMaterialOptions(i),n.isValid(t.content))s(n.isValid(t.content)?l.parse(t.content):null);else if(n.isValid(t.url)){new gt(this.manager).load(t.url,function(e){t.content=e,s(l.parse(e))},this._onProgress,this._onError)}}else s()}}();var ju=function(t){this.manager=void 0!==t?t:il,this.littleEndian=!0};ju.prototype={constructor:ju,load:function(t,e,n,r){var i=this,o=new gt(i.manager);o.setResponseType("arraybuffer"),o.load(t,function(n){e(i.parse(n,t))},n,r)},parse:function(t,e){var n=al.decodeText(t),r=function(t){var e={},n=t.search(/[\r\n]DATA\s(\S*)\s/i),r=/[\r\n]DATA\s(\S*)\s/i.exec(t.substr(n-1));if(e.data=r[1],e.headerLen=r[0].length+n,e.str=t.substr(0,e.headerLen),e.str=e.str.replace(/\#.*/gi,""),e.version=/VERSION (.*)/i.exec(e.str),e.fields=/FIELDS (.*)/i.exec(e.str),e.size=/SIZE (.*)/i.exec(e.str),e.type=/TYPE (.*)/i.exec(e.str),e.count=/COUNT (.*)/i.exec(e.str),e.width=/WIDTH (.*)/i.exec(e.str),e.height=/HEIGHT (.*)/i.exec(e.str),e.viewpoint=/VIEWPOINT (.*)/i.exec(e.str),e.points=/POINTS (.*)/i.exec(e.str),null!==e.version&&(e.version=parseFloat(e.version[1])),null!==e.fields&&(e.fields=e.fields[1].split(" ")),null!==e.type&&(e.type=e.type[1].split(" ")),null!==e.width&&(e.width=parseInt(e.width[1])),null!==e.height&&(e.height=parseInt(e.height[1])),null!==e.viewpoint&&(e.viewpoint=e.viewpoint[1]),null!==e.points&&(e.points=parseInt(e.points[1],10)),null===e.points&&(e.points=e.width*e.height),null!==e.size&&(e.size=e.size[1].split(" ").map(function(t){return parseInt(t,10)})),null!==e.count)e.count=e.count[1].split(" ").map(function(t){return parseInt(t,10)});else{e.count=[];for(var i=0,o=e.fields.length;i<o;i++)e.count.push(1)}e.offset={};var a=0;for(i=0,o=e.fields.length;i<o;i++)"ascii"===e.data?e.offset[e.fields[i]]=i:(e.offset[e.fields[i]]=a,a+=e.size[i]);return e.rowSize=a,e}(n),i=[],o=[],a=[];if("ascii"===r.data)for(var s=r.offset,l=n.substr(r.headerLen).split("\n"),u=0,c=l.length;u<c;u++){var h=l[u].split(" ");if(void 0!==s.x&&(i.push(parseFloat(h[s.x])),i.push(parseFloat(h[s.y])),i.push(parseFloat(h[s.z]))),void 0!==s.rgb){var p=new Float32Array([parseFloat(h[s.rgb])]),d=new DataView(p.buffer,0);a.push(d.getUint8(0)/255),a.push(d.getUint8(1)/255),a.push(d.getUint8(2)/255)}void 0!==s.normal_x&&(o.push(parseFloat(h[s.normal_x])),o.push(parseFloat(h[s.normal_y])),o.push(parseFloat(h[s.normal_z])))}if("binary_compressed"!==r.data){if("binary"===r.data){d=new DataView(t,r.headerLen),s=r.offset,u=0;for(var f=0;u<r.points;u++,f+=r.rowSize)void 0!==s.x&&(i.push(d.getFloat32(f+s.x,this.littleEndian)),i.push(d.getFloat32(f+s.y,this.littleEndian)),i.push(d.getFloat32(f+s.z,this.littleEndian))),void 0!==s.rgb&&(a.push(d.getUint8(f+s.rgb+0)/255),a.push(d.getUint8(f+s.rgb+1)/255),a.push(d.getUint8(f+s.rgb+2)/255)),void 0!==s.normal_x&&(o.push(d.getFloat32(f+s.normal_x,this.littleEndian)),o.push(d.getFloat32(f+s.normal_y,this.littleEndian)),o.push(d.getFloat32(f+s.normal_z,this.littleEndian)))}var m=new O;i.length>0&&m.addAttribute("position",new T(i,3)),o.length>0&&m.addAttribute("normal",new T(o,3)),a.length>0&&m.addAttribute("color",new T(a,3)),m.computeBoundingSphere();var v=new Tt({size:.005});a.length>0?v.vertexColors=!0:v.color.setHex(16777215*Math.random());var g=new be(m,v),y=e.split("").reverse().join("");return y=/([^\/]*)/.exec(y),y=y[1].split("").reverse().join(""),g.name=y,g}console.error("PCDLoader: binary_compressed files are not supported")}};var Bu=function(t){this.manager=void 0!==t?t:il};Bu.prototype={constructor:Bu,load:function(t,e,n,r){var i=this;new gt(i.manager).load(t,function(t){e(i.parse(t))},n,r)},parse:function(t){function e(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function n(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()}function r(t,e){var n=parseInt(d[f].substr(t,e));if(n){var r=function(t,e){return"s"+Math.min(t,e)+"e"+Math.max(t,e)}(v,n);void 0===p[r]&&(h.push([v-1,n-1,1]),p[r]=h.length-1)}}for(var i,o,a,s,l,u={h:[255,255,255],he:[217,255,255],li:[204,128,255],be:[194,255,0],b:[255,181,181],c:[144,144,144],n:[48,80,248],o:[255,13,13],f:[144,224,80],ne:[179,227,245],na:[171,92,242],mg:[138,255,0],al:[191,166,166],si:[240,200,160],p:[255,128,0],s:[255,255,48],cl:[31,240,31],ar:[128,209,227],k:[143,64,212],ca:[61,255,0],sc:[230,230,230],ti:[191,194,199],v:[166,166,171],cr:[138,153,199],mn:[156,122,199],fe:[224,102,51],co:[240,144,160],ni:[80,208,80],cu:[200,128,51],zn:[125,128,176],ga:[194,143,143],ge:[102,143,143],as:[189,128,227],se:[255,161,0],br:[166,41,41],kr:[92,184,209],rb:[112,46,176],sr:[0,255,0],y:[148,255,255],zr:[148,224,224],nb:[115,194,201],mo:[84,181,181],tc:[59,158,158],ru:[36,143,143],rh:[10,125,140],pd:[0,105,133],ag:[192,192,192],cd:[255,217,143],in:[166,117,115],sn:[102,128,128],sb:[158,99,181],te:[212,122,0],i:[148,0,148],xe:[66,158,176],cs:[87,23,143],ba:[0,201,0],la:[112,212,255],ce:[255,255,199],pr:[217,255,199],nd:[199,255,199],pm:[163,255,199],sm:[143,255,199],eu:[97,255,199],gd:[69,255,199],tb:[48,255,199],dy:[31,255,199],ho:[0,255,156],er:[0,230,117],tm:[0,212,82],yb:[0,191,56],lu:[0,171,36],hf:[77,194,255],ta:[77,166,255],w:[33,148,214],re:[38,125,171],os:[38,102,150],ir:[23,84,135],pt:[208,208,224],au:[255,209,35],hg:[184,184,208],tl:[166,84,77],pb:[87,89,97],bi:[158,79,181],po:[171,92,0],at:[117,79,69],rn:[66,130,150],fr:[66,0,102],ra:[0,125,0],ac:[112,171,250],th:[0,186,255],pa:[0,161,255],u:[0,143,255],np:[0,128,255],pu:[0,107,255],am:[84,92,242],cm:[120,92,227],bk:[138,79,227],cf:[161,54,212],es:[179,31,212],fm:[179,31,186],md:[179,13,166],no:[189,13,135],lr:[199,0,102],rf:[204,0,89],db:[209,0,79],sg:[217,0,69],bh:[224,0,56],hs:[230,0,46],mt:[235,0,38],ds:[235,0,38],rg:[235,0,38],cn:[235,0,38],uut:[235,0,38],uuq:[235,0,38],uup:[235,0,38],uuh:[235,0,38],uus:[235,0,38],uuo:[235,0,38]},c=[],h=[],p={},d=t.split("\n"),f=0,m=d.length;f<m;f++)if("ATOM"===d[f].substr(0,4)||"HETATM"===d[f].substr(0,6))i=parseFloat(d[f].substr(30,7)),o=parseFloat(d[f].substr(38,7)),a=parseFloat(d[f].substr(46,7)),s=parseInt(d[f].substr(6,5))-1,""===(l=e(d[f].substr(76,2)).toLowerCase())&&(l=e(d[f].substr(12,2)).toLowerCase()),c[s]=[i,o,a,u[l],n(l)];else if("CONECT"===d[f].substr(0,6)){var v=parseInt(d[f].substr(6,5));r(11,5),r(16,5),r(21,5),r(26,5)}return function(){var t,e,n={geometryAtoms:new O,geometryBonds:new O,json:{atoms:c,bonds:h}},r=n.geometryAtoms,i=n.geometryBonds,o=[],a=[],s=[];for(t=0,e=c.length;t<e;t++){var l=c[t];o.push(l[0],l[1],l[2]),a.push(l[3][0]/255,l[3][1]/255,l[3][2]/255)}for(t=0,e=h.length;t<e;t++){var u=h[t],p=u[0],d=u[1];s.push(o[3*p+0]),s.push(o[3*p+1]),s.push(o[3*p+2]),s.push(o[3*d+0]),s.push(o[3*d+1]),s.push(o[3*d+2])}return r.addAttribute("position",new T(o,3)),r.addAttribute("color",new T(a,3)),i.addAttribute("position",new T(s,3)),n}()}};var zu=function(t){this.manager=void 0!==t?t:il};zu.prototype={constructor:zu,load:function(t,e,n,r){var i=this;new gt(i.manager).load(t,function(t){e(i.parse(JSON.parse(t)))},n,r)},parse:function(t){function e(t){var e={};for(var n in t){var r,i=t[n],o=i.type,a=i.components;switch(o){case"float32":r=new T(i.data,a);break;case"uint8":r=new _(i.data,a);break;case"uint16":r=new S(i.data,a);break;default:console.log('PlayCanvasLoader: Array type "%s" not yet supported.',o)}e[n]=r}t._attributes=e}function n(t){var e=new O;e.setIndex(t.indices);var n=o.vertices[t.vertices]._attributes;for(var r in n){var i=n[r];"texCoord0"===r&&(r="uv"),e.addAttribute(r,i)}t._geometry=e}function r(t){var e=o.nodes[t.node],n=o.meshes[t.mesh];void 0===e._geometries&&(e._geometries=[]),e._geometries.push(n._geometry)}function i(t){var e=new Me,n=t._geometries;if(void 0!==n)for(var r=new wt,i=0,o=n.length;i<o;i++){e.add(new B(n[i],r))}for(i=0,o=t.rotation.length;i<o;i++)t.rotation[i]*=Math.PI/180;e.name=t.name,e.position.fromArray(t.position),e.quaternion.setFromEuler((new s).fromArray(t.rotation)),e.scale.fromArray(t.scale),t._object=e}for(var o=t.model,a=0,l=o.vertices.length;a<l;a++)e(o.vertices[a]);for(a=0,l=o.meshes.length;a<l;a++)n(o.meshes[a]);for(a=0,l=o.meshInstances.length;a<l;a++)r(o.meshInstances[a]);for(a=0,l=o.nodes.length;a<l;a++)i(o.nodes[a]);for(a=0,l=o.parents.length;a<l;a++){var u=o.parents[a];-1!==u&&o.nodes[u]._object.add(o.nodes[a]._object)}return o.nodes[0]._object}};var Vu=function(t){this.manager=void 0!==t?t:il,this.propertyNameMapping={}};Vu.prototype={constructor:Vu,load:function(t,e,n,r){var i=this,o=new gt(this.manager);o.setResponseType("arraybuffer"),o.load(t,function(t){e(i.parse(t))},n,r)},setPropertyNameMapping:function(t){this.propertyNameMapping=t},parse:function(t){function e(t){function e(t,e){var n={type:t[0]};return"list"===n.type?(n.name=t[3],n.countType=t[1],n.itemType=t[2]):n.name=t[1],n.name in e&&(n.name=e[n.name]),n}var n="",r=0,i=/ply([\s\S]*)end_header\s/.exec(t);null!==i&&(n=i[1],r=i[0].length);for(var o,a,s,l={comments:[],elements:[],headerLength:r},u=n.split("\n"),h=0;h<u.length;h++){var p=u[h];if(""!==(p=p.trim()))switch(s=p.split(/\s+/),a=s.shift(),p=s.join(" "),a){case"format":l.format=s[0],l.version=s[1];break;case"comment":l.comments.push(p);break;case"element":void 0!==o&&l.elements.push(o),(o={}).name=s[0],o.count=parseInt(s[1]),o.properties=[];break;case"property":o.properties.push(e(s,c.propertyNameMapping));break;default:console.log("unhandled",a,s)}}return void 0!==o&&l.elements.push(o),l}function n(t,e){switch(e){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(t);case"float":case"double":case"float32":case"float64":return parseFloat(t)}}function r(t,e){for(var r=e.split(/\s+/),i={},o=0;o<t.length;o++)if("list"===t[o].type){for(var a=[],s=n(r.shift(),t[o].countType),l=0;l<s;l++)a.push(n(r.shift(),t[o].itemType));i[t[o].name]=a}else i[t[o].name]=n(r.shift(),t[o].type);return i}function i(t,e){var n,i={indices:[],vertices:[],normals:[],uvs:[],colors:[]},s="";null!==(n=/end_header\s([\s\S]*)$/.exec(t))&&(s=n[1]);for(var l=s.split("\n"),u=0,c=0,h=0;h<l.length;h++){var p=l[h];if(""!==(p=p.trim())){c>=e.elements[u].count&&(u++,c=0);var d=r(e.elements[u].properties,p);a(i,e.elements[u].name,d),c++}}return o(i)}function o(t){var e=new O;return t.indices.length>0&&e.setIndex(t.indices),e.addAttribute("position",new T(t.vertices,3)),t.normals.length>0&&e.addAttribute("normal",new T(t.normals,3)),t.uvs.length>0&&e.addAttribute("uv",new T(t.uvs,2)),t.colors.length>0&&e.addAttribute("color",new T(t.colors,3)),e.computeBoundingSphere(),e}function a(t,e,n){if("vertex"===e)t.vertices.push(n.x,n.y,n.z),"nx"in n&&"ny"in n&&"nz"in n&&t.normals.push(n.nx,n.ny,n.nz),"s"in n&&"t"in n&&t.uvs.push(n.s,n.t),"red"in n&&"green"in n&&"blue"in n&&t.colors.push(n.red/255,n.green/255,n.blue/255);else if("face"===e){var r=n.vertex_indices||n.vertex_index;3===r.length?t.indices.push(r[0],r[1],r[2]):4===r.length&&(t.indices.push(r[0],r[1],r[3]),t.indices.push(r[1],r[2],r[3]))}}function s(t,e,n,r){switch(n){case"int8":case"char":return[t.getInt8(e),1];case"uint8":case"uchar":return[t.getUint8(e),1];case"int16":case"short":return[t.getInt16(e,r),2];case"uint16":case"ushort":return[t.getUint16(e,r),2];case"int32":case"int":return[t.getInt32(e,r),4];case"uint32":case"uint":return[t.getUint32(e,r),4];case"float32":case"float":return[t.getFloat32(e,r),4];case"float64":case"double":return[t.getFloat64(e,r),8]}}function l(t,e,n,r){for(var i,o={},a=0,l=0;l<n.length;l++)if("list"===n[l].type){var u=[],c=(i=s(t,e+a,n[l].countType,r))[0];a+=i[1];for(var h=0;h<c;h++)i=s(t,e+a,n[l].itemType,r),u.push(i[0]),a+=i[1];o[n[l].name]=u}else i=s(t,e+a,n[l].type,r),o[n[l].name]=i[0],a+=i[1];return[o,a]}var u,c=this;if(t instanceof ArrayBuffer){var h=al.decodeText(new Uint8Array(t)),p=e(h);u="ascii"===p.format?i(h,p):function(t,e){for(var n,r={indices:[],vertices:[],normals:[],uvs:[],colors:[]},i="binary_little_endian"===e.format,s=new DataView(t,e.headerLength),u=0,c=0;c<e.elements.length;c++)for(var h=0;h<e.elements[c].count;h++)u+=(n=l(s,u,e.elements[c].properties,i))[1],a(r,e.elements[c].name,n[0]);return o(r)}(t,p)}else u=i(t,e(t));return u}};var Gu=null,Hu=[null,Float32Array,null,Int8Array,Int16Array,null,Int32Array,Uint8Array,Uint16Array,null,Uint32Array],Wu={Uint16Array:"getUint16",Uint32Array:"getUint32",Int16Array:"getInt16",Int32Array:"getInt32",Float32Array:"getFloat32",Float64Array:"getFloat64"},Xu=function(t){this.manager=void 0!==t?t:il};Xu.prototype={constructor:Xu,load:function(t,e,n,r){var i=this,o=new gt(i.manager);o.setResponseType("arraybuffer"),t=t.replace(/\*/g,yn()?"be":"le"),o.load(t,function(t){e(i.parse(t))},n,r)},parse:function(t){console.time("PRWMLoader");var e,n,r=function(t){var e=new Uint8Array(t),n=e[0],r=e[1],i=!!(r>>7&1),o=r>>6&1,a=1==(r>>5&1),s=31&r,l=0,u=0;if(a?(l=(e[2]<<16)+(e[3]<<8)+e[4],u=(e[5]<<16)+(e[6]<<8)+e[7]):(l=e[2]+(e[3]<<8)+(e[4]<<16),u=e[5]+(e[6]<<8)+(e[7]<<16)),0===n)throw new Error("PRWM decoder: Invalid format version: 0");if(1!==n)throw new Error("PRWM decoder: Unsupported format version: "+n);if(!i){if(0!==o)throw new Error("PRWM decoder: Indices type must be set to 0 for non-indexed geometries");if(0!==u)throw new Error("PRWM decoder: Number of indices must be set to 0 for non-indexed geometries")}var c,h,p,d,f,m,v,g,y=8,b={};for(g=0;g<s;g++){for(c="";y<e.length&&(h=e[y],y++,0!==h);)c+=String.fromCharCode(h);p=(r=e[y])>>7&1,d=1+(r>>4&3),y++,m=bn(t,f=Hu[15&r],y=4*Math.ceil(y/4),d*l,a),y+=f.BYTES_PER_ELEMENT*d*l,b[c]={type:p,cardinality:d,values:m}}return y=4*Math.ceil(y/4),v=null,i&&(v=bn(t,1===o?Uint32Array:Uint16Array,y,u,a)),{version:n,attributes:b,indices:v}}(t),i=Object.keys(r.attributes),o=new O;for(n=0;n<i.length;n++)o.addAttribute(i[n],new y((e=r.attributes[i[n]]).values,e.cardinality,e.normalized));return null!==r.indices&&o.setIndex(new y(r.indices,1)),console.timeEnd("PRWMLoader"),o}},Xu.isBigEndianPlatform=function(){return yn()};var Yu=function(t){this.manager=void 0!==t?t:il,this._parser=Yu.parse};Yu.prototype=Object.create(ze.prototype),Yu.prototype.constructor=Yu,Yu.parse=function(t,e){var n=new Uint32Array(t,0,13),r={buffer:t,header:n,loadMipmaps:e};return 55727696===n[0]?Yu._parseV3(r):559044176===n[11]?Yu._parseV2(r):void console.error("PVRLoader: Unknown PVR format.")},Yu._parseV3=function(t){var e,n,r=t.header,i=r[2],o=r[6],a=r[7],s=r[10],l=r[11];switch(i){case 0:e=2,n=ds;break;case 1:e=2,n=ms;break;case 2:e=4,n=ps;break;case 3:e=4,n=fs;break;default:console.error("PVRLoader: Unsupported PVR format:",i)}return t.dataPtr=52+r[12],t.bpp=e,t.format=n,t.width=a,t.height=o,t.numSurfaces=s,t.numMipmaps=l,t.isCubemap=6===s,Yu._extract(t)},Yu._parseV2=function(t){var e,n,r=t.header,i=r[0],o=r[1],a=r[2],s=r[3],l=r[12],u=255&r[4],c=r[10]>0;return 25===u?(n=c?fs:ps,e=4):24===u?(n=c?ms:ds,e=2):console.error("PVRLoader: Unknown PVR format:",u),t.dataPtr=i,t.bpp=e,t.format=n,t.width=a,t.height=o,t.numSurfaces=l,t.numMipmaps=s+1,t.isCubemap=6===l,Yu._extract(t)},Yu._extract=function(t){var e={mipmaps:[],width:t.width,height:t.height,format:t.format,mipmapCount:t.numMipmaps,isCubemap:t.isCubemap},n=t.buffer,r=t.dataPtr,i=t.bpp,o=t.numSurfaces,a=0,s=0,l=0,u=0,c=0,h=0;2===i?(l=8,u=4):(l=4,u=4),s=l*u*i/8,e.mipmaps.length=t.numMipmaps*o;for(var p=0;p<t.numMipmaps;){var d=t.width>>p,f=t.height>>p;h=f/u,(c=d/l)<2&&(c=2),h<2&&(h=2),a=c*h*s;for(var m=0;m<o;m++){var v=new Uint8Array(n,r,a);e.mipmaps[m*t.numMipmaps+p]={data:v,width:d,height:f},r+=a}p++}return e};var qu=function(t){this.manager=void 0!==t?t:il};qu.prototype={constructor:qu,load:function(t,e,n,r){var i=this,o=new gt(i.manager);o.setResponseType("arraybuffer"),o.load(t,function(t){try{e(i.parse(t))}catch(t){r&&r(t)}},n,r)},parse:function(t){var e=function(t){if("string"==typeof t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=255&t.charCodeAt(n);return e.buffer||e}return t}(t);return function(t){var e;if(e=new DataView(t),84+50*e.getUint32(80,!0)===e.byteLength)return!0;for(var n=[115,111,108,105,100],r=0;r<5;r++)if(n[r]!=e.getUint8(r,!1))return!0;return!1}(e)?function(t){for(var e,n,r,i,o,a,s,l,u=new DataView(t),c=u.getUint32(80,!0),h=!1,p=0;p<70;p++)1129270351==u.getUint32(p,!1)&&82==u.getUint8(p+4)&&61==u.getUint8(p+5)&&(h=!0,i=[],o=u.getUint8(p+6)/255,a=u.getUint8(p+7)/255,s=u.getUint8(p+8)/255,l=u.getUint8(p+9)/255);for(var d=new O,f=[],m=[],v=0;v<c;v++){var g=84+50*v,b=u.getFloat32(g,!0),_=u.getFloat32(g+4,!0),x=u.getFloat32(g+8,!0);if(h){var w=u.getUint16(g+48,!0);0==(32768&w)?(e=(31&w)/31,n=(w>>5&31)/31,r=(w>>10&31)/31):(e=o,n=a,r=s)}for(var S=1;S<=3;S++){var A=g+12*S;f.push(u.getFloat32(A,!0)),f.push(u.getFloat32(A+4,!0)),f.push(u.getFloat32(A+8,!0)),m.push(b,_,x),h&&i.push(e,n,r)}}return d.addAttribute("position",new y(new Float32Array(f),3)),d.addAttribute("normal",new y(new Float32Array(m),3)),h&&(d.addAttribute("color",new y(new Float32Array(i),3)),d.hasColors=!0,d.alpha=l),d}(e):function(t){for(var e,n=new O,r=/facet([\s\S]*?)endfacet/g,o=0,a=/[\s]+([+-]?(?:\d+.\d+|\d+.|\d+|.\d+)(?:[eE][+-]?\d+)?)/.source,s=new RegExp("vertex"+a+a+a,"g"),l=new RegExp("normal"+a+a+a,"g"),u=[],c=[],h=new i;null!==(e=r.exec(t));){for(var p=0,d=0,f=e[0];null!==(e=l.exec(f));)h.x=parseFloat(e[1]),h.y=parseFloat(e[2]),h.z=parseFloat(e[3]),d++;for(;null!==(e=s.exec(f));)u.push(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])),c.push(h.x,h.y,h.z),p++;1!==d&&console.error("STLLoader: Something isn't right with the normal of face number "+o),3!==p&&console.error("STLLoader: Something isn't right with the vertices of face number "+o),o++}return n.addAttribute("position",new T(u,3)),n.addAttribute("normal",new T(c,3)),n}(function(t){return"string"!=typeof t?al.decodeText(new Uint8Array(t)):t}(t))}};var Zu=function(t){this.manager=void 0!==t?t:il};Zu.prototype={constructor:Zu,load:function(t,e,n,r){var i=new DOMParser;new gt(this.manager).load(t,function(t){var n=i.parseFromString(t,"image/svg+xml");e(n.documentElement)},n,r)}};var Qu=function(t){this.manager=void 0!==t?t:il,this.debug=!1,this.group=null,this.position=0,this.materials=[],this.meshes=[]};Qu.prototype={constructor:Qu,load:function(t,e,n,r){var i=this,o=void 0!==this.path?this.path:al.extractUrlBase(t),a=new gt(this.manager);a.setResponseType("arraybuffer"),a.load(t,function(t){e(i.parse(t,o))},n,r)},parse:function(t,e){this.group=new Me,this.position=0,this.materials=[],this.meshes=[],this.readFile(t,e);for(var n=0;n<this.meshes.length;n++)this.group.add(this.meshes[n]);return this.group},readFile:function(t,e){var n=new DataView(t),r=this.readChunk(n);if(r.id===Ku||r.id===$u||r.id===Ju)for(var i=this.nextChunk(n,r);0!==i;){if(i===tc){var o=this.readDWord(n);this.debugMessage("3DS file version: "+o)}else i===oc?(this.resetPosition(n),this.readMeshData(n,e)):this.debugMessage("Unknown main chunk: "+i.toString(16));i=this.nextChunk(n,r)}this.debugMessage("Parsed "+this.meshes.length+" meshes")},readMeshData:function(t,e){for(var n=this.readChunk(t),r=this.nextChunk(t,n);0!==r;){if(r===ac){var i=+this.readDWord(t);this.debugMessage("Mesh Version: "+i)}else if(r===sc){var o=this.readFloat(t);this.debugMessage("Master scale: "+o),this.group.scale.set(o,o,o)}else r===Cc?(this.debugMessage("Named Object"),this.resetPosition(t),this.readNamedObject(t)):r===lc?(this.debugMessage("Material"),this.resetPosition(t),this.readMaterialEntry(t,e)):this.debugMessage("Unknown MDATA chunk: "+r.toString(16));r=this.nextChunk(t,n)}},readNamedObject:function(t){var e=this.readChunk(t),n=this.readString(t,64);e.cur=this.position;for(var r=this.nextChunk(t,e);0!==r;){if(r===Ec){this.resetPosition(t);var i=this.readMesh(t);i.name=n,this.meshes.push(i)}else this.debugMessage("Unknown named object chunk: "+r.toString(16));r=this.nextChunk(t,e)}this.endChunk(e)},readMaterialEntry:function(t,e){for(var n=this.readChunk(t),r=this.nextChunk(t,n),i=new wt;0!==r;){if(r===uc)i.name=this.readString(t,64),this.debugMessage("   Name: "+i.name);else if(r===vc)this.debugMessage("   Wireframe"),i.wireframe=!0;else if(r===gc){var o=this.readByte(t);i.wireframeLinewidth=o,this.debugMessage("   Wireframe Thickness: "+o)}else if(r===fc)i.side=ko,this.debugMessage("   DoubleSided");else if(r===mc)this.debugMessage("   Additive Blending"),i.blending=Go;else if(r===hc)this.debugMessage("   Diffuse Color"),i.color=this.readColor(t);else if(r===pc)this.debugMessage("   Specular Color"),i.specular=this.readColor(t);else if(r===cc)this.debugMessage("   Ambient color"),i.color=this.readColor(t);else if(r===dc){var a=this.readWord(t);i.shininess=a,this.debugMessage("   Shininess : "+a)}else r===yc?(this.debugMessage("   ColorMap"),this.resetPosition(t),i.map=this.readMap(t,e)):r===_c?(this.debugMessage("   BumpMap"),this.resetPosition(t),i.bumpMap=this.readMap(t,e)):r===bc?(this.debugMessage("   OpacityMap"),this.resetPosition(t),i.alphaMap=this.readMap(t,e)):r===xc?(this.debugMessage("   SpecularMap"),this.resetPosition(t),i.specularMap=this.readMap(t,e)):this.debugMessage("   Unknown material chunk: "+r.toString(16));r=this.nextChunk(t,n)}this.endChunk(n),this.materials[i.name]=i},readMesh:function(t){var e=this.readChunk(t),n=this.nextChunk(t,e),o=null,a=[],s=new B(o=new v,new wt);for(s.name="mesh";0!==n;){if(n===Pc){var l=this.readWord(t);this.debugMessage("   Vertex: "+l);for(var u=0;u<l;u++)o.vertices.push(new i(this.readFloat(t),this.readFloat(t),this.readFloat(t)))}else if(n===Oc)this.resetPosition(t),this.readFaceArray(t,s);else if(n===Lc){var c=this.readWord(t);this.debugMessage("   UV: "+c);a=[];for(u=0;u<c;u++)a.push(new m(this.readFloat(t),this.readFloat(t)))}else if(n===Ic){this.debugMessage("   Tranformation Matrix (TODO)");var h=[];for(u=0;u<12;u++)h[u]=this.readFloat(t);var p=new r;p.elements[0]=h[0],p.elements[1]=h[6],p.elements[2]=h[3],p.elements[3]=h[9],p.elements[4]=h[2],p.elements[5]=h[8],p.elements[6]=h[5],p.elements[7]=h[11],p.elements[8]=h[1],p.elements[9]=h[7],p.elements[10]=h[4],p.elements[11]=h[10],p.elements[12]=0,p.elements[13]=0,p.elements[14]=0,p.elements[15]=1,p.transpose();var d=new r;d.getInverse(p,!0),o.applyMatrix(d),p.decompose(s.position,s.quaternion,s.scale)}else this.debugMessage("   Unknown mesh chunk: "+n.toString(16));n=this.nextChunk(t,e)}if(this.endChunk(e),a.length>0){var f=[];for(u=0;u<o.faces.length;u++)f.push([a[o.faces[u].a],a[o.faces[u].b],a[o.faces[u].c]]);o.faceVertexUvs[0]=f}return o.computeVertexNormals(),s},readFaceArray:function(t,e){var n=this.readChunk(t),r=this.readWord(t);this.debugMessage("   Faces: "+r);for(var i=0;i<r;++i){e.geometry.faces.push(new p(this.readWord(t),this.readWord(t),this.readWord(t)));this.readWord(t)}for(;this.position<n.end;){if((n=this.readChunk(t)).id===Nc){this.debugMessage("      Material Group"),this.resetPosition(t);var o=this.readMaterialGroup(t),a=this.materials[o.name];void 0!==a&&(e.material=a,""===a.name&&(a.name=e.name))}else this.debugMessage("      Unknown face array chunk: "+n.toString(16));this.endChunk(n)}this.endChunk(n)},readMap:function(t,e){var n=this.readChunk(t),r=this.nextChunk(t,n),i={},o=new Lt(this.manager);for(o.setPath(e);0!==r;){if(r===wc){var a=this.readString(t,128);i=o.load(a),this.debugMessage("      File: "+e+a)}else r===Mc?(i.offset.x=this.readFloat(t),this.debugMessage("      OffsetX: "+i.offset.x)):r===Tc?(i.offset.y=this.readFloat(t),this.debugMessage("      OffsetY: "+i.offset.y)):r===Sc?(i.repeat.x=this.readFloat(t),this.debugMessage("      RepeatX: "+i.repeat.x)):r===Ac?(i.repeat.y=this.readFloat(t),this.debugMessage("      RepeatY: "+i.repeat.y)):this.debugMessage("      Unknown map chunk: "+r.toString(16));r=this.nextChunk(t,n)}return this.endChunk(n),i},readMaterialGroup:function(t){this.readChunk(t);var e=this.readString(t,64),n=this.readWord(t);this.debugMessage("         Name: "+e),this.debugMessage("         Faces: "+n);for(var r=[],i=0;i<n;++i)r.push(this.readWord(t));return{name:e,index:r}},readColor:function(t){var e=this.readChunk(t),n=new h;if(e.id===nc||e.id===rc){var r=this.readByte(t),i=this.readByte(t),o=this.readByte(t);n.setRGB(r/255,i/255,o/255),this.debugMessage("      Color: "+n.r+", "+n.g+", "+n.b)}else if(e.id===ec||e.id===ic){r=this.readFloat(t),i=this.readFloat(t),o=this.readFloat(t);n.setRGB(r,i,o),this.debugMessage("      Color: "+n.r+", "+n.g+", "+n.b)}else this.debugMessage("      Unknown color chunk: "+e.toString(16));return this.endChunk(e),n},readChunk:function(t){var e={};return e.cur=this.position,e.id=this.readWord(t),e.size=this.readDWord(t),e.end=e.cur+e.size,e.cur+=6,e},endChunk:function(t){this.position=t.end},nextChunk:function(t,e){if(e.cur>=e.end)return 0;this.position=e.cur;try{var n=this.readChunk(t);return e.cur+=n.size,n.id}catch(t){return this.debugMessage("Unable to read chunk at "+this.position),0}},resetPosition:function(){this.position-=6},readByte:function(t){var e=t.getUint8(this.position,!0);return this.position+=1,e},readFloat:function(t){try{var e=t.getFloat32(this.position,!0);return this.position+=4,e}catch(e){this.debugMessage(e+" "+this.position+" "+t.byteLength)}},readInt:function(t){var e=t.getInt32(this.position,!0);return this.position+=4,e},readShort:function(t){var e=t.getInt16(this.position,!0);return this.position+=2,e},readDWord:function(t){var e=t.getUint32(this.position,!0);return this.position+=4,e},readWord:function(t){var e=t.getUint16(this.position,!0);return this.position+=2,e},readString:function(t,e){for(var n="",r=0;r<e;r++){var i=this.readByte(t);if(!i)break;n+=String.fromCharCode(i)}return n},setPath:function(t){return this.path=t,this},debugMessage:function(t){this.debug&&console.log(t)}};var Ju=19789,Ku=15786,$u=49725,tc=2,ec=16,nc=17,rc=18,ic=19,oc=15677,ac=15678,sc=256,lc=45055,uc=40960,cc=40976,hc=40992,pc=41008,dc=41024,fc=41089,mc=41091,vc=41093,gc=41095,yc=41472,bc=41488,_c=41520,xc=41476,wc=41728,Sc=41812,Ac=41814,Mc=41816,Tc=41818,Cc=16384,Ec=16640,Pc=16656,Oc=16672,Nc=16688,Lc=16704,Ic=16736,Dc=function(t){this.manager=void 0!==t?t:il,this.reversed=!1};Dc.prototype={constructor:Dc,load:function(t,e,n,r){var i=this,o=new gt(this.manager);o.setResponseType("arraybuffer"),o.load(t,function(t){e(i.parse(t))},n,r)},parse:function(t){return"undefined"==typeof opentype?(console.warn("TTFLoader: The loader requires opentype.js. Make sure it's included before using the loader."),null):function(t,e){for(var n=Math.round,r={},i=1e5/(72*(t.unitsPerEm||2048)),o=0;o<t.glyphs.length;o++){var a=t.glyphs.glyphs[o];if(void 0!==a.unicode){var s={ha:n(a.advanceWidth*i),x_min:n(a.xMin*i),x_max:n(a.xMax*i),o:""};e&&(a.path.commands=function(t){var e,n=[];t.forEach(function(t){"m"===t.type.toLowerCase()?n.push(e=[t]):"z"!==t.type.toLowerCase()&&e.push(t)});var r=[];return n.forEach(function(t){r.push(i={type:"m",x:t[t.length-1].x,y:t[t.length-1].y});for(var e=t.length-1;e>0;e--){var n=t[e],i={type:n.type};void 0!==n.x2&&void 0!==n.y2?(i.x1=n.x2,i.y1=n.y2,i.x2=n.x1,i.y2=n.y1):void 0!==n.x1&&void 0!==n.y1&&(i.x1=n.x1,i.y1=n.y1),i.x=t[e-1].x,i.y=t[e-1].y,r.push(i)}}),r}(a.path.commands)),a.path.commands.forEach(function(t,e){"c"===t.type.toLowerCase()&&(t.type="b"),s.o+=t.type.toLowerCase()+" ",void 0!==t.x&&void 0!==t.y&&(s.o+=n(t.x*i)+" "+n(t.y*i)+" "),void 0!==t.x1&&void 0!==t.y1&&(s.o+=n(t.x1*i)+" "+n(t.y1*i)+" "),void 0!==t.x2&&void 0!==t.y2&&(s.o+=n(t.x2*i)+" "+n(t.y2*i)+" ")}),r[String.fromCharCode(a.unicode)]=s}}return{glyphs:r,familyName:t.familyName,ascender:n(t.ascender*i),descender:n(t.descender*i),underlinePosition:t.tables.post.underlinePosition,underlineThickness:t.tables.post.underlineThickness,boundingBox:{xMin:t.tables.head.xMin,xMax:t.tables.head.xMax,yMin:t.tables.head.yMin,yMax:t.tables.head.yMax},resolution:1e3,original_font_information:t.tables.name}}(opentype.parse(t),this.reversed)}};var Fc=function(){};Fc.prototype.load=function(t,e,n){this.downloadModelJson(t,e,n)},(Fc.BufferGeometryCreator=function(){}).prototype.create=function(t,e){var n,r,i=e.length/3,o=new O,a=new Float32Array(3*i*3),s=new Float32Array(3*i*3),l=new Float32Array(3*i*2),u=t.length;for(r=0,n=0;n<u;n+=8)a[r++]=t[n],a[r++]=t[n+1],a[r++]=t[n+2];for(r=0,n=3;n<u;n+=8)l[r++]=t[n],l[r++]=t[n+1];for(r=0,n=5;n<u;n+=8)s[r++]=t[n],s[r++]=t[n+1],s[r++]=t[n+2];return o.setIndex(new y(e,1)),o.addAttribute("position",new y(a,3)),o.addAttribute("normal",new y(s,3)),o.addAttribute("uv",new y(l,2)),o.computeBoundingSphere(),o};var Rc={decodeOffsets:[-4095,-4095,-4095,0,0,-511,-511,-511],decodeScales:[1/8191,1/8191,1/8191,1/1023,1/1023,1/1023,1/1023,1/1023]};Fc.prototype.decompressAttribsInner_=function(t,e,n,r,i,o,a,s){for(var l=0,u=e;u<n;u++){var c=t.charCodeAt(u);r[i]=s*((l+=c>>1^-(1&c))+a),i+=o}},Fc.prototype.decompressIndices_=function(t,e,n,r,i){for(var o=0,a=0;a<n;a++){var s=t.charCodeAt(e++);r[i++]=o-s,0===s&&o++}},Fc.prototype.decompressAABBs_=function(t,e,n,r,i){for(var o=6*n,a=e+o,s=0,l=new Float32Array(o),u=e;u<a;u+=6){var c=t.charCodeAt(u+0)+r[0],h=t.charCodeAt(u+1)+r[1],p=t.charCodeAt(u+2)+r[2],d=t.charCodeAt(u+3)+1>>1,f=t.charCodeAt(u+4)+1>>1,m=t.charCodeAt(u+5)+1>>1;l[s++]=i[0]*(c+d),l[s++]=i[1]*(h+f),l[s++]=i[2]*(p+m),l[s++]=i[0]*d,l[s++]=i[1]*f,l[s++]=i[2]*m}return l},Fc.prototype.decompressMesh=function(t,e,n,r,i,o){for(var a=n.decodeScales.length,s=n.decodeOffsets,l=n.decodeScales,u=e.attribRange[1],c=e.attribRange[0],h=new Float32Array(a*u),p=0;p<a;p++){var d=c+u,f=l[p];f&&this.decompressAttribsInner_(t,c,d,h,p,a,s[p],f),c=d}var m=3*e.indexRange[1],v=new Uint16Array(m);this.decompressIndices_(t,c,m,v,0);var g=void 0,y=e.bboxes;y&&(g=this.decompressAABBs_(t,y,e.names.length,s,l)),o(r,i,h,v,g,e)},Fc.prototype.copyAttrib=function(t,e,n,r){for(var i=0;i<t;i++)n[i]=e[t*r+i]},Fc.prototype.decodeAttrib2=function(t,e,n,r,i,o,a,s,l,u){for(var c=0;c<5;c++){var h=t.charCodeAt(i+o*c+u);l[c]+=h>>1^-(1&h),s[e*u+c]=l[c],a[e*u+c]=r[c]*(l[c]+n[c])}},Fc.prototype.accumulateNormal=function(t,e,n,r,i){var o=r[8*t],a=r[8*t+1],s=r[8*t+2],l=r[8*e],u=r[8*e+1],c=r[8*e+2],h=r[8*n],p=r[8*n+1],d=r[8*n+2];u-=a,p-=a,a=(c-=s)*(h-=o)-(l-=o)*(d-=s),s=l*p-u*h,i[3*t]+=o=u*d-c*p,i[3*t+1]+=a,i[3*t+2]+=s,i[3*e]+=o,i[3*e+1]+=a,i[3*e+2]+=s,i[3*n]+=o,i[3*n+1]+=a,i[3*n+2]+=s},Fc.prototype.decompressMesh2=function(t,e,n,r,i,o){for(var a=n.decodeScales.length,s=n.decodeOffsets,l=n.decodeScales,u=e.attribRange[0],c=e.attribRange[1],h=e.codeRange[0],p=3*e.codeRange[2],d=new Uint16Array(p),f=new Int32Array(3*c),m=new Uint16Array(a),v=new Uint16Array(a*c),g=new Float32Array(a*c),y=0,b=0,_=0;_<p;_+=3){var x=t.charCodeAt(h++),w=Math.min(_,96);if(x<w){var S,A,M,T=x%3,C=_-(x-T);switch(T){case 0:S=d[C+2],A=d[C+1],M=d[C+0];break;case 1:S=d[C+0],A=d[C+2],M=d[C+1];break;case 2:S=d[C+1],A=d[C+0],M=d[C+2]}d[b++]=S,d[b++]=A;var E=y-(x=t.charCodeAt(h++));if(d[b++]=E,0===x){for(var P=0;P<5;P++){var O=t.charCodeAt(u+c*P+y),N=(O>>1^-(1&O))+v[a*S+P]+v[a*A+P]-v[a*M+P];m[P]=N,v[a*y+P]=N,g[a*y+P]=l[P]*(N+s[P])}y++}else this.copyAttrib(a,v,m,E);this.accumulateNormal(S,A,E,v,f)}else{var L=y-(x-w);d[b++]=L,x===w?this.decodeAttrib2(t,a,s,l,u,c,g,v,m,y++):this.copyAttrib(a,v,m,L);var I=y-(x=t.charCodeAt(h++));d[b++]=I,0===x?this.decodeAttrib2(t,a,s,l,u,c,g,v,m,y++):this.copyAttrib(a,v,m,I);var D=y-(x=t.charCodeAt(h++));if(d[b++]=D,0===x){for(P=0;P<5;P++)m[P]=(v[a*L+P]+v[a*I+P])/2;this.decodeAttrib2(t,a,s,l,u,c,g,v,m,y++)}else this.copyAttrib(a,v,m,D);this.accumulateNormal(L,I,D,v,f)}}for(_=0;_<c;_++){var F=f[3*_],R=f[3*_+1],k=f[3*_+2],U=511/Math.sqrt(F*F+R*R+k*k),j=t.charCodeAt(u+5*c+_),B=t.charCodeAt(u+6*c+_),z=t.charCodeAt(u+7*c+_);g[a*_+5]=U*F+(j>>1^-(1&j)),g[a*_+6]=U*R+(B>>1^-(1&B)),g[a*_+7]=U*k+(z>>1^-(1&z))}o(r,i,g,d,void 0,e)},Fc.prototype.downloadMesh=function(t,e,n,r,i){var o=this,a=0;_n(t,function(t){!function(t){for(;a<n.length;){var s=n[a],l=s.indexRange;if(l){if(t.length<l[0]+3*l[1])break;o.decompressMesh(t,s,r,e,a,i)}else{var u=s.codeRange;if(t.length<u[0]+u[1])break;o.decompressMesh2(t,s,r,e,a,i)}++a}}(t)})},Fc.prototype.downloadMeshes=function(t,e,n,r){for(var i in e){this.downloadMesh(t+i,i,e[i],n,r)}},Fc.prototype.createMeshCallback=function(t,e,n){var r=0,i=0,o={},a={},s={},l=e.urls;for(var u in l)o[u]=l[u].length,a[u]=0,i++,s[u]=new c;var h=new c,p=new Tu.MaterialCreator(t,e.options);p.setMaterials(e.materials),p.preload();var d=new Fc.BufferGeometryCreator;return function(t,e,l,u,c,f){var m=new B(d.create(l,u),p.create(f.material));s[t].add(m),a[t]++,a[t]===o[t]&&(r++,h.add(s[t]),r===i&&n(h))}},Fc.prototype.downloadModel=function(t,e,n,r){var i=this.createMeshCallback(e,n,r);this.downloadMeshes(t,n.urls,n.decodeParams,i)},Fc.prototype.downloadModelJson=function(t,e,n){!function(t,e){_n(t,function(t){e(JSON.parse(t))},function(){})}(t,function(r){r.decodeParams||(r.decodeParams=n&&n.decodeParams?n.decodeParams:Rc),r.options=n;var i=t.substr(0,t.lastIndexOf("/")+1),o=i;n&&n.geometryBase&&"/"!==(i=n.geometryBase).charAt(i.length-1)&&(i+="/"),n&&n.materialBase&&"/"!==(o=n.materialBase).charAt(o.length-1)&&(o+="/"),this.downloadModel(i,o,r,e)}.bind(this))};var kc=function(t){this.manager=void 0!==t?t:il};kc.prototype={constructor:kc,isRecordingPoints:!1,isRecordingFaces:!1,points:[],indexes:[],isRecordingAngles:!1,isRecordingColors:!1,angles:[],colors:[],recordingFieldname:null,crossOrigin:"Anonymous",load:function(t,e,n,r){var i=this;new gt(this.manager).load(t,function(t){e(i.parse(t))},n,r)},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t){var e=this.texturePath||"",n=new Lt(this.manager);n.setCrossOrigin(this.crossOrigin);for(var r=new ut,o=t.split("\n"),a=o.length-1;a>-1;a--){var s=o[a];if(/{.*[{\[]/.test(s)){(l=s.split("{").join("{\n").split("\n")).unshift(1),l.unshift(a),o.splice.apply(o,l)}else if(/\].*}/.test(s)){(l=s.split("]").join("]\n").split("\n")).unshift(1),l.unshift(a),o.splice.apply(o,l)}if(/}.*}/.test(s)){var l;(l=s.split("}").join("}\n").split("\n")).unshift(1),l.unshift(a),o.splice.apply(o,l)}/^\b[^\s]+\b$/.test(s.trim())?(o[a+1]=s+" "+o[a+1].trim(),o.splice(a,1)):s.indexOf("coord")>-1&&s.indexOf("[")<0&&s.indexOf("{")<0&&(o[a]+=" Coordinate {}")}var u=o.shift();return/V1.0/.exec(u)?console.warn("VRMLLoader: V1.0 not supported yet."):/V2.0/.exec(u)&&function(t,r){function o(t,e,n,r,o){for(var a=!0===o?1:-1,s=[],l={},u={},c=0;c<n.length;c++){var p={x:a*(Math.cos(n[c])*e),y:a*(Math.sin(n[c])*e)};s.push(p)}for(var d=t.index,f=t.attributes.position,m=new y(new Float32Array(3*t.attributes.position.count),3),v=new i,g=new h,b=0;b<d.count;b++){var _=d.getX(b);v.fromBufferAttribute(f,_);for(var x=0;x<r.length;x++)if(0===x?(l.x=0,l.y=!0===o?e:-1*e):(l.x=s[x-1].x,l.y=s[x-1].y),void 0!==(u=s[x]))if(1==(!0===o?v.y<=l.y&&v.y>u.y:v.y>=l.y&&v.y<u.y)){var w=r[x],S=r[x+1],A=Math.abs(v.y-l.y)/(l.y-u.y);g.copy(w).lerp(S,A),m.setXYZ(_,g.r,g.g,g.b)}else{var M=r[!0===o?r.length-1:0];m.setXYZ(_,M.r,M.g,M.b)}}t.addAttribute("color",m)}function a(t,e){for(var n,r,i,o=[],a={},s=/[^\s,\[\]]+/g;null!==(n=s.exec(e));)o.push(n[0]);switch(r=o[0]){case"skyAngle":case"groundAngle":this.recordingFieldname=r,this.isRecordingAngles=!0,this.angles=[];break;case"skyColor":case"groundColor":this.recordingFieldname=r,this.isRecordingColors=!0,this.colors=[];break;case"point":this.recordingFieldname=r,this.isRecordingPoints=!0,this.points=[];break;case"coordIndex":case"texCoordIndex":this.recordingFieldname=r,this.isRecordingFaces=!0,this.indexes=[]}if(this.isRecordingFaces){if(o.length>0)for(var l=0;l<o.length;l++)/(-?\d+)/.test(o[l])&&("-1"===o[l]?(f.length>0&&this.indexes.push(f),f=[]):f.push(parseInt(o[l])));/]/.exec(e)&&(f.length>0&&this.indexes.push(f),f=[],this.isRecordingFaces=!1,t[this.recordingFieldname]=this.indexes)}else if(this.isRecordingPoints){if("Coordinate"==t.nodeType)for(;null!==(o=d.exec(e));)i={x:parseFloat(o[1]),y:parseFloat(o[2]),z:parseFloat(o[3])},this.points.push(i);if("TextureCoordinate"==t.nodeType)for(;null!==(o=p.exec(e));)i={x:parseFloat(o[1]),y:parseFloat(o[2])},this.points.push(i);/]/.exec(e)&&(this.isRecordingPoints=!1,t.points=this.points)}else if(this.isRecordingAngles){if(o.length>0)for(l=0;l<o.length;l++)u.test(o[l])&&this.angles.push(parseFloat(o[l]));/]/.exec(e)&&(this.isRecordingAngles=!1,t[this.recordingFieldname]=this.angles)}else if(this.isRecordingColors){for(;null!==(o=d.exec(e));){var c={r:parseFloat(o[1]),g:parseFloat(o[2]),b:parseFloat(o[3])};this.colors.push(c)}/]/.exec(e)&&(this.isRecordingColors=!1,t[this.recordingFieldname]=this.colors)}else if("NULL"!==o[o.length-1]&&"children"!==r){switch(r){case"diffuseColor":case"emissiveColor":case"specularColor":case"color":if(4!==o.length){console.warn("VRMLLoader: Invalid color format detected for %s.",r);break}a={r:parseFloat(o[1]),g:parseFloat(o[2]),b:parseFloat(o[3])};break;case"location":case"direction":case"translation":case"scale":case"size":if(4!==o.length){console.warn("VRMLLoader: Invalid vector format detected for %s.",r);break}a={x:parseFloat(o[1]),y:parseFloat(o[2]),z:parseFloat(o[3])};break;case"intensity":case"cutOffAngle":case"radius":case"topRadius":case"bottomRadius":case"height":case"transparency":case"shininess":case"ambientIntensity":if(2!==o.length){console.warn("VRMLLoader: Invalid single float value specification detected for %s.",r);break}a=parseFloat(o[1]);break;case"rotation":if(5!==o.length){console.warn("VRMLLoader: Invalid quaternion format detected for %s.",r);break}a={x:parseFloat(o[1]),y:parseFloat(o[2]),z:parseFloat(o[3]),w:parseFloat(o[4])};break;case"on":case"ccw":case"solid":case"colorPerVertex":case"convex":if(2!==o.length){console.warn("VRMLLoader: Invalid format detected for %s.",r);break}a="TRUE"===o[1]}t[r]=a}return a}function s(t,a){var u;if("string"!=typeof t){u=a,t.string.indexOf("AmbientLight")>-1&&"PointLight"===t.nodeType&&(t.nodeType="AmbientLight");var p=void 0===t.on||t.on,d=void 0!==t.intensity?t.intensity:1,f=new h;if(t.color&&f.copy(t.color),"AmbientLight"===t.nodeType)(u=new Ue(f,d)).visible=p,a.add(u);else if("PointLight"===t.nodeType){var v=0;void 0!==t.radius&&t.radius<1e3&&(v=t.radius),(u=new Le(f,d,v)).visible=p,a.add(u)}else if("SpotLight"===t.nodeType){d=1,v=0;var g=Math.PI/3;p=!0,void 0!==t.radius&&t.radius<1e3&&(v=t.radius),void 0!==t.cutOffAngle&&(g=t.cutOffAngle),(u=new Re(f,d,v,g,0)).visible=p,a.add(u)}else if("Transform"===t.nodeType||"Group"===t.nodeType){if(u=new c,/DEF/.exec(t.string)&&(u.name=/DEF\s+([^\s]+)/.exec(t.string)[1],l[u.name]=u),void 0!==t.translation&&u.position.set((tt=t.translation).x,tt.y,tt.z),void 0!==t.rotation){var y=t.rotation;u.quaternion.setFromAxisAngle(new i(y.x,y.y,y.z),y.w)}void 0!==t.scale&&u.scale.set(($=t.scale).x,$.y,$.z),a.add(u)}else if("Shape"===t.nodeType)u=new B,/DEF/.exec(t.string)&&(u.name=/DEF\s+([^\s]+)/.exec(t.string)[1],l[u.name]=u),a.add(u);else if("Background"===t.nodeType){var b=2e4,_=new L(b,20,20),x=new D({fog:!1,side:Ro});if(t.skyColor.length>1)o(_,b,t.skyAngle,t.skyColor,!0),x.vertexColors=Bo;else{var w=t.skyColor[0];x.color.setRGB(w.r,w.b,w.g)}if(r.add(new B(_,x)),void 0!==t.groundColor){var S=new L(b=12e3,20,20,0,2*Math.PI,.5*Math.PI,1.5*Math.PI),A=new D({fog:!1,side:Ro,vertexColors:Bo});o(S,b,t.groundAngle,t.groundColor,!1),r.add(new B(S,A))}}else{if(/geometry/.exec(t.string)){if("Box"===t.nodeType)a.geometry=new H(($=t.size).x,$.y,$.z);else if("Cylinder"===t.nodeType)a.geometry=new X(t.radius,t.radius,t.height);else if("Cone"===t.nodeType)a.geometry=new X(t.topRadius,t.bottomRadius,t.height);else if("Sphere"===t.nodeType)a.geometry=new L(t.radius);else if("IndexedFaceSet"===t.nodeType){var M,C,E,P,N,I=new O,F=[],R=[];for(q=0,E=t.children.length;q<E;q++){if("TextureCoordinate"===(Z=t.children[q]).nodeType&&Z.points)for(P=0,N=Z.points.length;P<N;P++)R.push((C=Z.points[P]).x,C.y);if("Coordinate"===Z.nodeType){if(Z.points)for(P=0,N=Z.points.length;P<N;P++)F.push((M=Z.points[P]).x,M.y,M.z);if(Z.string.indexOf("DEF")>-1){var k=/DEF\s+([^\s]+)/.exec(Z.string)[1];l[k]=F.slice(0)}Z.string.indexOf("USE")>-1&&(rt=/USE\s+([^\s]+)/.exec(Z.string)[1],F=l[rt])}}var U=0;if(t.coordIndex){var j=[],z=[];for(M=new i,C=new m,q=0,E=t.coordIndex.length;q<E;q++){var V=t.coordIndex[q];for(U=0;V.length>=3&&U<V.length-2;){void 0===t.ccw&&(t.ccw=!0);var G=V[0],W=V[U+(t.ccw?1:2)],Y=V[U+(t.ccw?2:1)];M.fromArray(F,3*G),C.fromArray(R,2*G),j.push(M.x,M.y,M.z),z.push(C.x,C.y),M.fromArray(F,3*W),C.fromArray(R,2*W),j.push(M.x,M.y,M.z),z.push(C.x,C.y),M.fromArray(F,3*Y),C.fromArray(R,2*Y),j.push(M.x,M.y,M.z),z.push(C.x,C.y),U++}}F=j,R=z}else a.parent.remove(a);!1===t.solid&&(a.material.side=ko),I.solid=t.solid,I.addAttribute("position",new T(F,3)),R.length>0&&I.addAttribute("uv",new T(R,2)),I.computeVertexNormals(),I.computeBoundingSphere(),/DEF/.exec(t.string)&&(I.name=/DEF ([^\s]+)/.exec(t.string)[1],l[I.name]=I),a.geometry=I}return}if(/appearance/.exec(t.string)){for(var q=0;q<t.children.length;q++){var Z;if("Material"===(Z=t.children[q]).nodeType){var Q=new wt;if(void 0!==Z.diffuseColor){var J=Z.diffuseColor;Q.color.setRGB(J.r,J.g,J.b)}if(void 0!==Z.emissiveColor){var K=Z.emissiveColor;Q.emissive.setRGB(K.r,K.g,K.b)}if(void 0!==Z.specularColor){var $;Q.specular.setRGB(($=Z.specularColor).r,$.g,$.b)}if(void 0!==Z.transparency){var tt=Z.transparency;Q.opacity=Math.abs(1-tt),Q.transparent=!0}/DEF/.exec(t.string)&&(Q.name=/DEF ([^\s]+)/.exec(t.string)[1],l[Q.name]=Q),a.material=Q}if("ImageTexture"===Z.nodeType){var et=/"([^"]+)"/.exec(Z.children[0]);et&&(a.material.name=et[1],a.material.map=n.load(e+et[1]))}}return}}q=0;for(var nt=t.children.length;q<nt;q++)s(t.children[q],u)}else if(/USE/.exec(t)){var rt=/USE\s+?([^\s]+)/.exec(t)[1];void 0==l[rt]?console.warn("VRMLLoader: %s is not defined.",rt):/appearance/.exec(t)&&rt?a.material=l[rt].clone():/geometry/.exec(t)&&rt?(a.geometry=l[rt].clone(),void 0!==l[rt].solid&&!1===l[rt].solid&&(a.geometry.solid=!1,a.material.side=ko)):rt&&(u=l[rt].clone(),a.add(u))}}var l={},u=/(\b|\-|\+)([\d\.e]+)/,p=/([\d\.\+\-e]+)\s+([\d\.\+\-e]+)/g,d=/([\d\.\+\-e]+)\s+([\d\.\+\-e]+)\s+([\d\.\+\-e]+)/g,f=[];s(function(t){for(var e,n,r={string:"Scene",children:[]},i=r,o=0;o<t.length;o++){var s="",l=t[o];if(null===/^\s+?$/g.exec(l)&&""!==(l=l.trim())){if(/#/.exec(l)){var u=l.split("#");l=u[0],s=u[1]}if(e=/([^\s]*){1}(?:\s+)?{/.exec(l)){var c={nodeType:e[1],string:l,parent:i,children:[],comment:s};i.children.push(c),i=c,/}/.exec(l)&&(n=/{(.*)}/.exec(l)[1],c.children.push(n),a(i,n),i=i.parent)}else/}/.exec(l)?i=i.parent:""!==l&&(a(i,l),i.children.push(l))}}return r}(t),r)}(o,r),r}};Object.assign(function(t){this.manager=void 0!==t?t:il}.prototype,a.prototype,{load:function(t,e,n,r){var i=this,o=new gt(i.manager);o.setResponseType("arraybuffer"),o.load(t,function(t){e(i.parse(t))},n,r)},parse:function(t){function e(t,e){var n=t.length,r=new Float32Array(n+e.length);return r.set(t),r.set(e,n),r}function n(t,e){var n=t.length,r=new Int32Array(n+e.length);return r.set(t),r.set(e,n),r}function r(t){for(var e="",n=new Uint8Array(t),r=0,i=n.length;i--;)e+=String.fromCharCode(n[r++]);return e}var o=al.decodeText(new Uint8Array(t,0,250)).split("\n");return-1!==o[0].indexOf("xml")?function(t){function r(t){var e={};if(1===t.nodeType){if(t.attributes&&t.attributes.length>0){e.attributes={};for(var n=0;n<t.attributes.length;n++){var i=t.attributes.item(n);e.attributes[i.nodeName]=i.nodeValue.trim()}}}else 3===t.nodeType&&(e=t.nodeValue.trim());if(t.hasChildNodes())for(var o=0;o<t.childNodes.length;o++){var a=t.childNodes.item(o),s=a.nodeName;if(void 0===e[s])""!==(l=r(a))&&(e[s]=l);else{void 0===e[s].push&&(e[s]=[e[s]]);var l;""!==(l=r(a))&&e[s].push(l)}}return e}function i(t){var e,n="undefined"!=typeof Uint8Array?Uint8Array:Array,r=[],i=[],o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=o.length;for(e=0;e<a;e++)r[e]=o[e];for(e=0;e<a;++e)i[o.charCodeAt(e)]=e;i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63;var s,l,u,c,h;if((a=t.length)%4>0)throw new Error("Invalid string. Length must be a multiple of 4");h=new n(3*a/4-(c="="===t[a-2]?2:"="===t[a-1]?1:0)),l=c>0?a-4:a;var p=0;for(e=0,s=0;e<l;e+=4,s+=3)u=i[t.charCodeAt(e)]<<18|i[t.charCodeAt(e+1)]<<12|i[t.charCodeAt(e+2)]<<6|i[t.charCodeAt(e+3)],h[p++]=(16711680&u)>>16,h[p++]=(65280&u)>>8,h[p++]=255&u;return 2===c?(u=i[t.charCodeAt(e)]<<2|i[t.charCodeAt(e+1)]>>4,h[p++]=255&u):1===c&&(u=i[t.charCodeAt(e)]<<10|i[t.charCodeAt(e+1)]<<4|i[t.charCodeAt(e+2)]>>2,h[p++]=u>>8&255,h[p++]=255&u),h}function o(t,r){var o=0;if("UInt64"===s.attributes.header_type?o=8:"UInt32"===s.attributes.header_type&&(o=4),"binary"===t.attributes.format&&r){var a,l,u,c,h,p;if("Float32"===t.attributes.type)var d=new Float32Array;else"Int64"===t.attributes.type&&(d=new Int32Array);l=(a=i(t["#text"]))[0];for(var f=1;f<o-1;f++)l|=a[f]<<f*o;for(c=(l+3)*o,(h=[]).push(p=c+=c%3>0?3-c%3:0),u=3*o,f=0;f<l;f++){for(var m=a[f*o+u],v=1;v<o-1;v++)m|=a[f*o+u+v]<<8*v;h.push(p+=m)}for(f=0;f<h.length-1;f++)g=(g=new Zlib.Inflate(a.slice(h[f],h[f+1]),{resize:!0,verify:!0}).decompress()).buffer,"Float32"===t.attributes.type?d=e(d,g=new Float32Array(g)):"Int64"===t.attributes.type&&(d=n(d,g=new Int32Array(g)));delete t["#text"],"Float32"===t.attributes.type?"binary"===t.attributes.format&&(r||(d=d.filter(function(t,e){if(0!==e)return!0}))):"Int64"===t.attributes.type&&"binary"===t.attributes.format&&(r||(d=d.filter(function(t,e){if(0!==e)return!0})),d=d.filter(function(t,e){if(e%2!=1)return!0}))}else{if("binary"!==t.attributes.format||r)g=t["#text"]?t["#text"].split(/\s+/).filter(function(t){if(""!==t)return t}):new Int32Array(0).buffer;else{var g;g=(g=i(t["#text"])).slice(o).buffer}delete t["#text"],"Float32"===t.attributes.type?d=new Float32Array(g):"Int32"===t.attributes.type?d=new Int32Array(g):"Int64"===t.attributes.type&&(d=new Int32Array(g),"binary"===t.attributes.format&&(d=d.filter(function(t,e){if(e%2!=1)return!0})))}return d}var a=null;if(window.DOMParser)try{a=(new DOMParser).parseFromString(t,"text/xml")}catch(t){a=null}else{if(!window.ActiveXObject)throw new Error("Cannot parse xml string!");try{if(a=new ActiveXObject("Microsoft.XMLDOM"),a.async=!1,!a.loadXML())throw new Error(a.parseError.reason+a.parseError.srcText)}catch(t){a=null}}var s=r(a.documentElement),l=[],u=[],c=[];if(s.PolyData){for(var h=s.PolyData.Piece,p=s.attributes.hasOwnProperty("compressor"),d=["PointData","Points","Strips","Polys"],f=0,m=d.length;f<m;){var v=h[d[f]];if(v&&v.DataArray){if("[object Array]"===Object.prototype.toString.call(v.DataArray))var g=v.DataArray;else g=[v.DataArray];for(var b=0,_=g.length;b<_;)"#text"in g[b]&&g[b]["#text"].length>0&&(g[b].text=o(g[b],p)),b++;switch(d[f]){case"PointData":var x=parseInt(h.attributes.NumberOfPoints),w=v.attributes.Normals;if(x>0)for(var S=0,A=g.length;S<A;S++)if(w===g[S].attributes.Name){var M=g[S].attributes.NumberOfComponents;(u=new Float32Array(x*M)).set(g[S].text,0)}break;case"Points":(x=parseInt(h.attributes.NumberOfPoints))>0&&(M=v.DataArray.attributes.NumberOfComponents,(l=new Float32Array(x*M)).set(v.DataArray.text,0));break;case"Strips":var T=parseInt(h.attributes.NumberOfStrips);if(T>0){var C=new Int32Array(v.DataArray[0].text.length),E=new Int32Array(v.DataArray[1].text.length);C.set(v.DataArray[0].text,0),E.set(v.DataArray[1].text,0);var P=T+C.length;c=new Uint32Array(3*P-9*T);var N=0;for(S=0,A=T;S<A;S++){for(var L=[],I=0,D=E[S],F=0;I<D-F;I++)L.push(C[I]),S>0&&(F=E[S-1]);var R=0;for(D=E[S],F=0;R<D-F-2;R++)R%2?(c[N++]=L[R],c[N++]=L[R+2],c[N++]=L[R+1]):(c[N++]=L[R],c[N++]=L[R+1],c[N++]=L[R+2]),S>0&&(F=E[S-1])}}break;case"Polys":var k=parseInt(h.attributes.NumberOfPolys);if(k>0){C=new Int32Array(v.DataArray[0].text.length),E=new Int32Array(v.DataArray[1].text.length),C.set(v.DataArray[0].text,0),E.set(v.DataArray[1].text,0),P=k+C.length,c=new Uint32Array(3*P-9*k),N=0;var U=0;for(S=0,A=k,F=0;S<A;){var j=[];for(I=0,D=E[S];I<D-F;)j.push(C[U++]),I++;for(R=1;R<D-F-1;)c[N++]=j[0],c[N++]=j[R],c[N++]=j[R+1],R++;F=E[++S-1]}}}}f++}var B=new O;return B.setIndex(new y(c,1)),B.addAttribute("position",new y(l,3)),u.length===l.length&&B.addAttribute("normal",new y(u,3)),B}}(r(t)):o[2].includes("ASCII")?function(t){var e,n=[],r=[],o=[],a=[],s=/(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)/g,l=/^(\d+)\s+([\s\d]*)/,u=/^POINTS /,c=/^POLYGONS /,d=/^TRIANGLE_STRIPS /,f=/^POINT_DATA[ ]+(\d+)/,m=/^CELL_DATA[ ]+(\d+)/,g=/^COLOR_SCALARS[ ]+(\w+)[ ]+3/,b=/^NORMALS[ ]+(\w+)[ ]+(\w+)/,_=!1,x=!1,w=!1,S=!1,A=!1,M=!1,T=!1,C=t.split("\n");for(var E in C){var P=C[E];if(_)for(;null!==(e=s.exec(P));){var N=parseFloat(e[1]),L=parseFloat(e[2]),I=parseFloat(e[3]);r.push(N,L,I)}else if(x){if(null!==(e=l.exec(P))){var D=parseInt(e[1]),F=e[2].split(/\s+/);if(D>=3)for(var R=parseInt(F[0]),k=1,U=0;U<D-2;++U)j=parseInt(F[k]),B=parseInt(F[k+1]),n.push(R,j,B),k++}}else if(w){if(null!==(e=l.exec(P))&&(D=parseInt(e[1]),F=e[2].split(/\s+/),D>=3)){var j,B;for(U=0;U<D-2;U++)U%2==1?(R=parseInt(F[U]),j=parseInt(F[U+2]),B=parseInt(F[U+1]),n.push(R,j,B)):(R=parseInt(F[U]),j=parseInt(F[U+1]),B=parseInt(F[U+2]),n.push(R,j,B))}}else if(S||A)if(M)for(;null!==(e=s.exec(P));){var z=parseFloat(e[1]),V=parseFloat(e[2]),G=parseFloat(e[3]);o.push(z,V,G)}else if(T)for(;null!==(e=s.exec(P));){var H=parseFloat(e[1]),W=parseFloat(e[2]),X=parseFloat(e[3]);a.push(H,W,X)}null!==c.exec(P)?(x=!0,_=!1,w=!1):null!==u.exec(P)?(x=!1,_=!0,w=!1):null!==d.exec(P)?(x=!1,_=!1,w=!0):null!==f.exec(P)?(S=!0,_=!1,x=!1,w=!1):null!==m.exec(P)?(A=!0,_=!1,x=!1,w=!1):null!==g.exec(P)?(M=!0,T=!1,_=!1,x=!1,w=!1):null!==b.exec(P)&&(T=!0,M=!1,_=!1,x=!1,w=!1)}var Y,q="point";if(o.length===n.length&&(q="cell"),"point"===q)(Y=new O).setIndex(new y(new Uint32Array(n),1)),Y.addAttribute("position",new y(new Float32Array(r),3)),o.length===r.length&&Y.addAttribute("color",new y(new Float32Array(o),3)),a.length===r.length&&Y.addAttribute("normal",new y(new Float32Array(a),3));else{Y=new v;var Z=n.length/3,Q=r.length/3;for(U=0;U<Q;++U)Y.vertices.push(new i(N=r[3*U+0],L=r[3*U+1],I=r[3*U+2]));for(E=0;E<Z;++E)Y.faces.push(new p(n[3*E+0],n[3*E+1],n[3*E+2]));if(o.length===3*Z)for(E=0;E<Z;++E)z=o[3*E+0],V=o[3*E+1],G=o[3*E+2],Y.faces[E].color=(new h).setRGB(z,V,G)}return Y}(r(t)):function(t){function e(t,e){for(var n=e,r=t[n],i=[];10!==r;)i.push(String.fromCharCode(r)),r=t[++n];return{start:e,end:n,next:n+1,parsedString:i.join("")}}for(var n,r,i,o,a,s,l,u=new Uint8Array(t),c=new DataView(t),h=[],p=[],d=[],f=0;;){if(s=e(u,f),0===(l=s.parsedString).indexOf("POINTS")){for(n=4*(o=parseInt(l.split(" ")[1],10))*3,h=new Float32Array(3*o),r=s.next,i=0;i<o;i++)h[3*i]=c.getFloat32(r,!1),h[3*i+1]=c.getFloat32(r+4,!1),h[3*i+2]=c.getFloat32(r+8,!1),r+=12;s.next=s.next+n+1}else if(0===l.indexOf("TRIANGLE_STRIPS")){var m=parseInt(l.split(" ")[1],10);n=4*(x=parseInt(l.split(" ")[2],10)),d=new Uint32Array(3*x-9*m);var v=0;for(r=s.next,i=0;i<m;i++){var g=c.getInt32(r,!1),b=[];for(r+=4,a=0;a<g;a++)b.push(c.getInt32(r,!1)),r+=4;for(var _=0;_<g-2;_++)_%2?(d[v++]=b[_],d[v++]=b[_+2],d[v++]=b[_+1]):(d[v++]=b[_],d[v++]=b[_+1],d[v++]=b[_+2])}s.next=s.next+n+1}else if(0===l.indexOf("POLYGONS")){var x;for(m=parseInt(l.split(" ")[1],10),n=4*(x=parseInt(l.split(" ")[2],10)),d=new Uint32Array(3*x-9*m),v=0,r=s.next,i=0;i<m;i++){for(g=c.getInt32(r,!1),b=[],r+=4,a=0;a<g;a++)b.push(c.getInt32(r,!1)),r+=4;for(_=1;_<g-1;_++)d[v++]=b[0],d[v++]=b[_],d[v++]=b[_+1]}s.next=s.next+n+1}else if(0===l.indexOf("POINT_DATA")){for(o=parseInt(l.split(" ")[1],10),s=e(u,s.next),n=4*o*3,p=new Float32Array(3*o),r=s.next,i=0;i<o;i++)p[3*i]=c.getFloat32(r,!1),p[3*i+1]=c.getFloat32(r+4,!1),p[3*i+2]=c.getFloat32(r+8,!1),r+=12;s.next=s.next+n}if((f=s.next)>=u.byteLength)break}var w=new O;return w.setIndex(new y(d,1)),w.addAttribute("position",new y(h,3)),p.length===h.length&&w.addAttribute("normal",new y(p,3)),w}(t)}}),(xn.prototype=Object.create(c.prototype)).constructor=xn,xn.prototype.isImmediateRenderObject=!0;var Uc=function(t,e,n,r){function o(t,e,n){return t+(e-t)*n}function a(t,e,n,r,i,a,s,l){var u=(n-s)/(l-s),c=h.normal_cache;d[e+0]=r+u*h.delta,d[e+1]=i,d[e+2]=a,f[e+0]=o(c[t+0],c[t+3],u),f[e+1]=o(c[t+1],c[t+4],u),f[e+2]=o(c[t+2],c[t+5],u)}function s(t,e,n,r,i,a,s,l){var u=(n-s)/(l-s),c=h.normal_cache;d[e+0]=r,d[e+1]=i+u*h.delta,d[e+2]=a;var p=t+3*h.yd;f[e+0]=o(c[t+0],c[p+0],u),f[e+1]=o(c[t+1],c[p+1],u),f[e+2]=o(c[t+2],c[p+2],u)}function l(t,e,n,r,i,a,s,l){var u=(n-s)/(l-s),c=h.normal_cache;d[e+0]=r,d[e+1]=i,d[e+2]=a+u*h.delta;var p=t+3*h.zd;f[e+0]=o(c[t+0],c[p+0],u),f[e+1]=o(c[t+1],c[p+1],u),f[e+2]=o(c[t+2],c[p+2],u)}function u(t){var e=3*t;0===h.normal_cache[e]&&(h.normal_cache[e+0]=h.field[t-1]-h.field[t+1],h.normal_cache[e+1]=h.field[t-h.yd]-h.field[t+h.yd],h.normal_cache[e+2]=h.field[t-h.zd]-h.field[t+h.zd])}function c(t,e,n,r,i,o){var c=r+1,p=r+h.yd,m=r+h.zd,v=c+h.yd,g=c+h.zd,y=r+h.yd+h.zd,b=c+h.yd+h.zd,_=0,x=h.field[r],w=h.field[c],S=h.field[p],A=h.field[v],M=h.field[m],T=h.field[g],C=h.field[y],E=h.field[b];x<i&&(_|=1),w<i&&(_|=2),S<i&&(_|=8),A<i&&(_|=4),M<i&&(_|=16),T<i&&(_|=32),C<i&&(_|=128),E<i&&(_|=64);var P=jc[_];if(0===P)return 0;var O=h.delta,N=t+O,L=e+O,I=n+O;1&P&&(u(r),u(c),a(3*r,0,i,t,e,n,x,w)),2&P&&(u(c),u(v),s(3*c,3,i,N,e,n,w,A)),4&P&&(u(p),u(v),a(3*p,6,i,t,L,n,S,A)),8&P&&(u(r),u(p),s(3*r,9,i,t,e,n,x,S)),16&P&&(u(m),u(g),a(3*m,12,i,t,e,I,M,T)),32&P&&(u(g),u(b),s(3*g,15,i,N,e,I,T,E)),64&P&&(u(y),u(b),a(3*y,18,i,t,L,I,C,E)),128&P&&(u(m),u(y),s(3*m,21,i,t,e,I,M,C)),256&P&&(u(r),u(m),l(3*r,24,i,t,e,n,x,M)),512&P&&(u(c),u(g),l(3*c,27,i,N,e,n,w,T)),1024&P&&(u(v),u(b),l(3*v,30,i,N,L,n,A,E)),2048&P&&(u(p),u(y),l(3*p,33,i,t,L,n,S,C)),_<<=4;for(var D,F=0,R=0;-1!=Bc[_+R];)(function(t,e,n,r,i,o){var a=3*h.count;if(h.positionArray[a+0]=t[n],h.positionArray[a+1]=t[n+1],h.positionArray[a+2]=t[n+2],h.positionArray[a+3]=t[r],h.positionArray[a+4]=t[r+1],h.positionArray[a+5]=t[r+2],h.positionArray[a+6]=t[i],h.positionArray[a+7]=t[i+1],h.positionArray[a+8]=t[i+2],h.normalArray[a+0]=e[n],h.normalArray[a+1]=e[n+1],h.normalArray[a+2]=e[n+2],h.normalArray[a+3]=e[r],h.normalArray[a+4]=e[r+1],h.normalArray[a+5]=e[r+2],h.normalArray[a+6]=e[i],h.normalArray[a+7]=e[i+1],h.normalArray[a+8]=e[i+2],h.enableUvs){var s=2*h.count;h.uvArray[s+0]=t[n],h.uvArray[s+1]=t[n+2],h.uvArray[s+2]=t[r],h.uvArray[s+3]=t[r+2],h.uvArray[s+4]=t[i],h.uvArray[s+5]=t[i+2]}h.enableColors&&(h.colorArray[a+0]=t[n],h.colorArray[a+1]=t[n+1],h.colorArray[a+2]=t[n+2],h.colorArray[a+3]=t[r],h.colorArray[a+4]=t[r+1],h.colorArray[a+5]=t[r+2],h.colorArray[a+6]=t[i],h.colorArray[a+7]=t[i+1],h.colorArray[a+8]=t[i+2]);h.count+=3,h.count>=h.maxCount-3&&(h.hasPositions=!0,h.hasNormals=!0,h.enableUvs&&(h.hasUvs=!0),h.enableColors&&(h.hasColors=!0),o(h))})(d,f,3*Bc[D=_+R],3*Bc[D+1],3*Bc[D+2],o),R+=3,F++;return F}xn.call(this,e);var h=this,d=new Float32Array(36),f=new Float32Array(36);this.enableUvs=void 0!==n&&n,this.enableColors=void 0!==r&&r,this.init=function(t){this.resolution=t,this.isolation=80,this.size=t,this.size2=this.size*this.size,this.size3=this.size2*this.size,this.halfsize=this.size/2,this.delta=2/this.size,this.yd=this.size,this.zd=this.size2,this.field=new Float32Array(this.size3),this.normal_cache=new Float32Array(3*this.size3),this.maxCount=4096,this.count=0,this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=new Float32Array(3*this.maxCount),this.normalArray=new Float32Array(3*this.maxCount),this.enableUvs&&(this.uvArray=new Float32Array(2*this.maxCount)),this.enableColors&&(this.colorArray=new Float32Array(3*this.maxCount))},this.begin=function(){this.count=0,this.hasPositions=!1,this.hasNormals=!1,this.hasUvs=!1,this.hasColors=!1},this.end=function(t){if(0!==this.count){for(var e=3*this.count;e<this.positionArray.length;e++)this.positionArray[e]=0;this.hasPositions=!0,this.hasNormals=!0,this.enableUvs&&(this.hasUvs=!0),this.enableColors&&(this.hasColors=!0),t(this)}},this.addBall=function(t,e,n,r,i){var o=Math.sign(r);r=Math.abs(r);var a=this.size*Math.sqrt(r/i),s=n*this.size,l=e*this.size,u=t*this.size,c=Math.floor(s-a);c<1&&(c=1);var h=Math.floor(s+a);h>this.size-1&&(h=this.size-1);var p=Math.floor(l-a);p<1&&(p=1);var d=Math.floor(l+a);d>this.size-1&&(d=this.size-1);var f=Math.floor(u-a);f<1&&(f=1);var m=Math.floor(u+a);m>this.size-1&&(m=this.size-1);var v,g,y,b,_,x,w,S,A,M,T;for(y=c;y<h;y++)for(_=this.size2*y,A=(S=y/this.size-n)*S,g=p;g<d;g++)for(b=_+this.size*g,M=(w=g/this.size-e)*w,v=f;v<m;v++)(T=r/(1e-6+(x=v/this.size-t)*x+M+A)-i)>0&&(this.field[b+v]+=T*o)},this.addPlaneX=function(t,e){var n,r,i,o,a,s,l,u=this.size,c=this.yd,h=this.zd,p=this.field,d=u*Math.sqrt(t/e);for(d>u&&(d=u),n=0;n<d;n++)if(s=n/u,o=s*s,(a=t/(1e-4+o)-e)>0)for(r=0;r<u;r++)for(l=n+r*c,i=0;i<u;i++)p[h*i+l]+=a},this.addPlaneY=function(t,e){var n,r,i,o,a,s,l,u,c=this.size,h=this.yd,p=this.zd,d=this.field,f=c*Math.sqrt(t/e);for(f>c&&(f=c),r=0;r<f;r++)if(s=r/c,o=s*s,(a=t/(1e-4+o)-e)>0)for(l=r*h,n=0;n<c;n++)for(u=l+n,i=0;i<c;i++)d[p*i+u]+=a},this.addPlaneZ=function(t,e){var n,r,i,o,a,s,l,u,c=this.size,h=this.yd,p=this.zd,d=this.field,f=c*Math.sqrt(t/e);for(f>c&&(f=c),i=0;i<f;i++)if(s=i/c,o=s*s,(a=t/(1e-4+o)-e)>0)for(l=p*i,r=0;r<c;r++)for(u=l+r*h,n=0;n<c;n++)d[u+n]+=a},this.reset=function(){var t;for(t=0;t<this.size3;t++)this.normal_cache[3*t]=0,this.field[t]=0},this.render=function(t){this.begin();for(var e=this.size-2,n=1;n<e;n++)for(var r=this.size2*n,i=(n-this.halfsize)/this.halfsize,o=1;o<e;o++)for(var a=r+this.size*o,s=(o-this.halfsize)/this.halfsize,l=1;l<e;l++){c((l-this.halfsize)/this.halfsize,s,i,a+l,this.isolation,t)}this.end(t)},this.generateGeometry=function(){var t=0,e=new v,n=[];return this.render(function(r){for(var o=0;o<r.count;o++){var a=(new i).fromArray(r.positionArray,3*o),s=(new i).fromArray(r.normalArray,3*o);e.vertices.push(a),n.push(s)}var l=r.count/3;for(o=0;o<l;o++){var u=3*(t+o),c=u+1,h=u+2,d=new p(u,c,h,[n[u],n[c],n[h]]);e.faces.push(d)}t+=l,r.count=0}),e},this.init(t)};(Uc.prototype=Object.create(xn.prototype)).constructor=Uc;var jc=new Int32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]),Bc=new Int32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,9,8,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,2,10,0,2,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,8,3,2,10,8,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,8,11,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,11,2,1,9,11,9,8,11,-1,-1,-1,-1,-1,-1,-1,3,10,1,11,10,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,10,1,0,8,10,8,11,10,-1,-1,-1,-1,-1,-1,-1,3,9,0,3,11,9,11,10,9,-1,-1,-1,-1,-1,-1,-1,9,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,7,3,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,1,9,4,7,1,7,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,4,7,3,0,4,1,2,10,-1,-1,-1,-1,-1,-1,-1,9,2,10,9,0,2,8,4,7,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,7,2,7,3,7,9,4,-1,-1,-1,-1,8,4,7,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,4,7,11,2,4,2,0,4,-1,-1,-1,-1,-1,-1,-1,9,0,1,8,4,7,2,3,11,-1,-1,-1,-1,-1,-1,-1,4,7,11,9,4,11,9,11,2,9,2,1,-1,-1,-1,-1,3,10,1,3,11,10,7,8,4,-1,-1,-1,-1,-1,-1,-1,1,11,10,1,4,11,1,0,4,7,11,4,-1,-1,-1,-1,4,7,8,9,0,11,9,11,10,11,0,3,-1,-1,-1,-1,4,7,11,4,11,9,9,11,10,-1,-1,-1,-1,-1,-1,-1,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,5,4,1,5,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,5,4,8,3,5,3,1,5,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,10,4,9,5,-1,-1,-1,-1,-1,-1,-1,5,2,10,5,4,2,4,0,2,-1,-1,-1,-1,-1,-1,-1,2,10,5,3,2,5,3,5,4,3,4,8,-1,-1,-1,-1,9,5,4,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,0,8,11,4,9,5,-1,-1,-1,-1,-1,-1,-1,0,5,4,0,1,5,2,3,11,-1,-1,-1,-1,-1,-1,-1,2,1,5,2,5,8,2,8,11,4,8,5,-1,-1,-1,-1,10,3,11,10,1,3,9,5,4,-1,-1,-1,-1,-1,-1,-1,4,9,5,0,8,1,8,10,1,8,11,10,-1,-1,-1,-1,5,4,0,5,0,11,5,11,10,11,0,3,-1,-1,-1,-1,5,4,8,5,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,9,7,8,5,7,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,3,0,9,5,3,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,7,8,0,1,7,1,5,7,-1,-1,-1,-1,-1,-1,-1,1,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,7,8,9,5,7,10,1,2,-1,-1,-1,-1,-1,-1,-1,10,1,2,9,5,0,5,3,0,5,7,3,-1,-1,-1,-1,8,0,2,8,2,5,8,5,7,10,5,2,-1,-1,-1,-1,2,10,5,2,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,7,9,5,7,8,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,9,5,7,9,7,2,9,2,0,2,7,11,-1,-1,-1,-1,2,3,11,0,1,8,1,7,8,1,5,7,-1,-1,-1,-1,11,2,1,11,1,7,7,1,5,-1,-1,-1,-1,-1,-1,-1,9,5,8,8,5,7,10,1,3,10,3,11,-1,-1,-1,-1,5,7,0,5,0,9,7,11,0,1,0,10,11,10,0,-1,11,10,0,11,0,3,10,5,0,8,0,7,5,7,0,-1,11,10,5,7,11,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,1,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,1,9,8,5,10,6,-1,-1,-1,-1,-1,-1,-1,1,6,5,2,6,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,6,5,1,2,6,3,0,8,-1,-1,-1,-1,-1,-1,-1,9,6,5,9,0,6,0,2,6,-1,-1,-1,-1,-1,-1,-1,5,9,8,5,8,2,5,2,6,3,2,8,-1,-1,-1,-1,2,3,11,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,0,8,11,2,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,0,1,9,2,3,11,5,10,6,-1,-1,-1,-1,-1,-1,-1,5,10,6,1,9,2,9,11,2,9,8,11,-1,-1,-1,-1,6,3,11,6,5,3,5,1,3,-1,-1,-1,-1,-1,-1,-1,0,8,11,0,11,5,0,5,1,5,11,6,-1,-1,-1,-1,3,11,6,0,3,6,0,6,5,0,5,9,-1,-1,-1,-1,6,5,9,6,9,11,11,9,8,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,4,7,3,6,5,10,-1,-1,-1,-1,-1,-1,-1,1,9,0,5,10,6,8,4,7,-1,-1,-1,-1,-1,-1,-1,10,6,5,1,9,7,1,7,3,7,9,4,-1,-1,-1,-1,6,1,2,6,5,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,1,2,5,5,2,6,3,0,4,3,4,7,-1,-1,-1,-1,8,4,7,9,0,5,0,6,5,0,2,6,-1,-1,-1,-1,7,3,9,7,9,4,3,2,9,5,9,6,2,6,9,-1,3,11,2,7,8,4,10,6,5,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,2,4,2,0,2,7,11,-1,-1,-1,-1,0,1,9,4,7,8,2,3,11,5,10,6,-1,-1,-1,-1,9,2,1,9,11,2,9,4,11,7,11,4,5,10,6,-1,8,4,7,3,11,5,3,5,1,5,11,6,-1,-1,-1,-1,5,1,11,5,11,6,1,0,11,7,11,4,0,4,11,-1,0,5,9,0,6,5,0,3,6,11,6,3,8,4,7,-1,6,5,9,6,9,11,4,7,9,7,11,9,-1,-1,-1,-1,10,4,9,6,4,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,10,6,4,9,10,0,8,3,-1,-1,-1,-1,-1,-1,-1,10,0,1,10,6,0,6,4,0,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,6,8,6,4,6,1,10,-1,-1,-1,-1,1,4,9,1,2,4,2,6,4,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,9,2,4,9,2,6,4,-1,-1,-1,-1,0,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,8,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,10,4,9,10,6,4,11,2,3,-1,-1,-1,-1,-1,-1,-1,0,8,2,2,8,11,4,9,10,4,10,6,-1,-1,-1,-1,3,11,2,0,1,6,0,6,4,6,1,10,-1,-1,-1,-1,6,4,1,6,1,10,4,8,1,2,1,11,8,11,1,-1,9,6,4,9,3,6,9,1,3,11,6,3,-1,-1,-1,-1,8,11,1,8,1,0,11,6,1,9,1,4,6,4,1,-1,3,11,6,3,6,0,0,6,4,-1,-1,-1,-1,-1,-1,-1,6,4,8,11,6,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,10,6,7,8,10,8,9,10,-1,-1,-1,-1,-1,-1,-1,0,7,3,0,10,7,0,9,10,6,7,10,-1,-1,-1,-1,10,6,7,1,10,7,1,7,8,1,8,0,-1,-1,-1,-1,10,6,7,10,7,1,1,7,3,-1,-1,-1,-1,-1,-1,-1,1,2,6,1,6,8,1,8,9,8,6,7,-1,-1,-1,-1,2,6,9,2,9,1,6,7,9,0,9,3,7,3,9,-1,7,8,0,7,0,6,6,0,2,-1,-1,-1,-1,-1,-1,-1,7,3,2,6,7,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,11,10,6,8,10,8,9,8,6,7,-1,-1,-1,-1,2,0,7,2,7,11,0,9,7,6,7,10,9,10,7,-1,1,8,0,1,7,8,1,10,7,6,7,10,2,3,11,-1,11,2,1,11,1,7,10,6,1,6,7,1,-1,-1,-1,-1,8,9,6,8,6,7,9,1,6,11,6,3,1,3,6,-1,0,9,1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,7,0,6,3,11,0,11,6,0,-1,-1,-1,-1,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,1,9,8,3,1,11,7,6,-1,-1,-1,-1,-1,-1,-1,10,1,2,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,8,6,11,7,-1,-1,-1,-1,-1,-1,-1,2,9,0,2,10,9,6,11,7,-1,-1,-1,-1,-1,-1,-1,6,11,7,2,10,3,10,8,3,10,9,8,-1,-1,-1,-1,7,2,3,6,2,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,0,8,7,6,0,6,2,0,-1,-1,-1,-1,-1,-1,-1,2,7,6,2,3,7,0,1,9,-1,-1,-1,-1,-1,-1,-1,1,6,2,1,8,6,1,9,8,8,7,6,-1,-1,-1,-1,10,7,6,10,1,7,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,7,6,1,7,10,1,8,7,1,0,8,-1,-1,-1,-1,0,3,7,0,7,10,0,10,9,6,10,7,-1,-1,-1,-1,7,6,10,7,10,8,8,10,9,-1,-1,-1,-1,-1,-1,-1,6,8,4,11,8,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,6,11,3,0,6,0,4,6,-1,-1,-1,-1,-1,-1,-1,8,6,11,8,4,6,9,0,1,-1,-1,-1,-1,-1,-1,-1,9,4,6,9,6,3,9,3,1,11,3,6,-1,-1,-1,-1,6,8,4,6,11,8,2,10,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,11,0,6,11,0,4,6,-1,-1,-1,-1,4,11,8,4,6,11,0,2,9,2,10,9,-1,-1,-1,-1,10,9,3,10,3,2,9,4,3,11,3,6,4,6,3,-1,8,2,3,8,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,0,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,4,2,4,6,4,3,8,-1,-1,-1,-1,1,9,4,1,4,2,2,4,6,-1,-1,-1,-1,-1,-1,-1,8,1,3,8,6,1,8,4,6,6,10,1,-1,-1,-1,-1,10,1,0,10,0,6,6,0,4,-1,-1,-1,-1,-1,-1,-1,4,6,3,4,3,8,6,10,3,0,3,9,10,9,3,-1,10,9,4,6,10,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,5,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,5,11,7,6,-1,-1,-1,-1,-1,-1,-1,5,0,1,5,4,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,11,7,6,8,3,4,3,5,4,3,1,5,-1,-1,-1,-1,9,5,4,10,1,2,7,6,11,-1,-1,-1,-1,-1,-1,-1,6,11,7,1,2,10,0,8,3,4,9,5,-1,-1,-1,-1,7,6,11,5,4,10,4,2,10,4,0,2,-1,-1,-1,-1,3,4,8,3,5,4,3,2,5,10,5,2,11,7,6,-1,7,2,3,7,6,2,5,4,9,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,6,0,6,2,6,8,7,-1,-1,-1,-1,3,6,2,3,7,6,1,5,0,5,4,0,-1,-1,-1,-1,6,2,8,6,8,7,2,1,8,4,8,5,1,5,8,-1,9,5,4,10,1,6,1,7,6,1,3,7,-1,-1,-1,-1,1,6,10,1,7,6,1,0,7,8,7,0,9,5,4,-1,4,0,10,4,10,5,0,3,10,6,10,7,3,7,10,-1,7,6,10,7,10,8,5,4,10,4,8,10,-1,-1,-1,-1,6,9,5,6,11,9,11,8,9,-1,-1,-1,-1,-1,-1,-1,3,6,11,0,6,3,0,5,6,0,9,5,-1,-1,-1,-1,0,11,8,0,5,11,0,1,5,5,6,11,-1,-1,-1,-1,6,11,3,6,3,5,5,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,11,9,11,8,11,5,6,-1,-1,-1,-1,0,11,3,0,6,11,0,9,6,5,6,9,1,2,10,-1,11,8,5,11,5,6,8,0,5,10,5,2,0,2,5,-1,6,11,3,6,3,5,2,10,3,10,5,3,-1,-1,-1,-1,5,8,9,5,2,8,5,6,2,3,8,2,-1,-1,-1,-1,9,5,6,9,6,0,0,6,2,-1,-1,-1,-1,-1,-1,-1,1,5,8,1,8,0,5,6,8,3,8,2,6,2,8,-1,1,5,6,2,1,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,6,1,6,10,3,8,6,5,6,9,8,9,6,-1,10,1,0,10,0,6,9,5,0,5,6,0,-1,-1,-1,-1,0,3,8,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,7,5,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,11,7,5,8,3,0,-1,-1,-1,-1,-1,-1,-1,5,11,7,5,10,11,1,9,0,-1,-1,-1,-1,-1,-1,-1,10,7,5,10,11,7,9,8,1,8,3,1,-1,-1,-1,-1,11,1,2,11,7,1,7,5,1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,7,1,7,5,7,2,11,-1,-1,-1,-1,9,7,5,9,2,7,9,0,2,2,11,7,-1,-1,-1,-1,7,5,2,7,2,11,5,9,2,3,2,8,9,8,2,-1,2,5,10,2,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,2,0,8,5,2,8,7,5,10,2,5,-1,-1,-1,-1,9,0,1,5,10,3,5,3,7,3,10,2,-1,-1,-1,-1,9,8,2,9,2,1,8,7,2,10,2,5,7,5,2,-1,1,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,0,7,1,1,7,5,-1,-1,-1,-1,-1,-1,-1,9,0,3,9,3,5,5,3,7,-1,-1,-1,-1,-1,-1,-1,9,8,7,5,9,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,8,4,5,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,5,0,4,5,11,0,5,10,11,11,3,0,-1,-1,-1,-1,0,1,9,8,4,10,8,10,11,10,4,5,-1,-1,-1,-1,10,11,4,10,4,5,11,3,4,9,4,1,3,1,4,-1,2,5,1,2,8,5,2,11,8,4,5,8,-1,-1,-1,-1,0,4,11,0,11,3,4,5,11,2,11,1,5,1,11,-1,0,2,5,0,5,9,2,11,5,4,5,8,11,8,5,-1,9,4,5,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,5,10,3,5,2,3,4,5,3,8,4,-1,-1,-1,-1,5,10,2,5,2,4,4,2,0,-1,-1,-1,-1,-1,-1,-1,3,10,2,3,5,10,3,8,5,4,5,8,0,1,9,-1,5,10,2,5,2,4,1,9,2,9,4,2,-1,-1,-1,-1,8,4,5,8,5,3,3,5,1,-1,-1,-1,-1,-1,-1,-1,0,4,5,1,0,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,4,5,8,5,3,9,0,5,0,3,5,-1,-1,-1,-1,9,4,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,11,7,4,9,11,9,10,11,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,7,9,11,7,9,10,11,-1,-1,-1,-1,1,10,11,1,11,4,1,4,0,7,4,11,-1,-1,-1,-1,3,1,4,3,4,8,1,10,4,7,4,11,10,11,4,-1,4,11,7,9,11,4,9,2,11,9,1,2,-1,-1,-1,-1,9,7,4,9,11,7,9,1,11,2,11,1,0,8,3,-1,11,7,4,11,4,2,2,4,0,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,2,8,3,4,3,2,4,-1,-1,-1,-1,2,9,10,2,7,9,2,3,7,7,4,9,-1,-1,-1,-1,9,10,7,9,7,4,10,2,7,8,7,0,2,0,7,-1,3,7,10,3,10,2,7,4,10,1,10,0,4,0,10,-1,1,10,2,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,7,1,3,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,0,8,1,8,7,1,-1,-1,-1,-1,4,0,3,7,4,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,11,9,10,-1,-1,-1,-1,-1,-1,-1,0,1,10,0,10,8,8,10,11,-1,-1,-1,-1,-1,-1,-1,3,1,10,11,3,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,11,1,11,9,9,11,8,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,1,2,9,2,11,9,-1,-1,-1,-1,0,2,11,8,0,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,10,8,9,-1,-1,-1,-1,-1,-1,-1,9,10,2,0,9,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,0,1,8,1,10,8,-1,-1,-1,-1,1,10,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,8,9,1,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]);!function(){var t={}}();(wn.prototype=Object.create(ht.prototype)).constructor=wn,Sn.prototype=Object.assign(Object.create(c.prototype),{constructor:Sn,isSprite:!0,raycast:function(){var t=new i,e=new i,n=new i;return function(r,i){e.setFromMatrixPosition(this.matrixWorld),r.ray.closestPointToPoint(e,t),n.setFromMatrixScale(this.matrixWorld);var o=n.x*n.y/4;if(!(e.distanceToSquared(t)>o)){var a=r.ray.origin.distanceTo(t);a<r.near||a>r.far||i.push({distance:a,point:t.clone(),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return c.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}});var zc=function(t,e){this.lut=[],this.map=Vc[t],this.n=e,this.mapname=t;for(var n=1/this.n,r=0;r<=1;r+=n)for(var i=0;i<this.map.length-1;i++)if(r>=this.map[i][0]&&r<this.map[i+1][0]){var o=this.map[i][0],a=this.map[i+1][0],s=new h(16777215).setHex(this.map[i][1]),l=new h(16777215).setHex(this.map[i+1][1]),u=s.lerp(l,(r-o)/(a-o));this.lut.push(u)}return this.set(this)};zc.prototype={constructor:zc,lut:[],map:[],mapname:"rainbow",n:256,minV:0,maxV:1,legend:null,set:function(t){return t instanceof zc&&this.copy(t),this},setMin:function(t){return this.minV=t,this},setMax:function(t){return this.maxV=t,this},changeNumberOfColors:function(t){return this.n=t,new zc(this.mapname,this.n)},changeColorMap:function(t){return this.mapname=t,new zc(this.mapname,this.n)},copy:function(t){return this.lut=t.lut,this.mapname=t.mapname,this.map=t.map,this.n=t.n,this.minV=t.minV,this.maxV=t.maxV,this},getColor:function(t){t<=this.minV?t=this.minV:t>=this.maxV&&(t=this.maxV),t=(t-this.minV)/(this.maxV-this.minV);var e=Math.round(t*this.n);return e==this.n&&(e-=1),this.lut[e]},addColorMap:function(t,e){Vc[t]=e},setLegendOn:function(t){void 0===t&&(t={}),this.legend={},this.legend.layout=t.hasOwnProperty("layout")?t.layout:"vertical",this.legend.position=t.hasOwnProperty("position")?t.position:{x:21.5,y:8,z:5},this.legend.dimensions=t.hasOwnProperty("dimensions")?t.dimensions:{width:.5,height:3},this.legend.canvas=document.createElement("canvas"),this.legend.canvas.setAttribute("id","legend"),this.legend.canvas.setAttribute("hidden",!0),document.body.appendChild(this.legend.canvas),this.legend.ctx=this.legend.canvas.getContext("2d"),this.legend.canvas.setAttribute("width",1),this.legend.canvas.setAttribute("height",this.n),this.legend.texture=new ht(this.legend.canvas);var e=this.legend.ctx.getImageData(0,0,1,this.n),n=e.data;this.map=Vc[this.mapname];for(var r=0,i=1/this.n,o=1;o>=0;o-=i)for(var a=this.map.length-1;a>=0;a--)if(o<this.map[a][0]&&o>=this.map[a-1][0]){var s=this.map[a-1][0],l=this.map[a][0],u=new h(16777215).setHex(this.map[a-1][1]),c=new h(16777215).setHex(this.map[a][1]),p=u.lerp(c,(o-s)/(l-s));n[4*r]=Math.round(255*p.r),n[4*r+1]=Math.round(255*p.g),n[4*r+2]=Math.round(255*p.b),n[4*r+3]=255,r+=1}return this.legend.ctx.putImageData(e,0,0),this.legend.texture.needsUpdate=!0,this.legend.legendGeometry=new mt(this.legend.dimensions.width,this.legend.dimensions.height),this.legend.legendMaterial=new D({map:this.legend.texture,side:ko}),this.legend.mesh=new B(this.legend.legendGeometry,this.legend.legendMaterial),"horizontal"==this.legend.layout&&(this.legend.mesh.rotation.z=Math.PI/180*-90),this.legend.mesh.position.copy(this.legend.position),this.legend.mesh},setLegendOff:function(){return this.legend=null,this.legend},setLegendLayout:function(t){return!!this.legend&&(this.legend.layout!=t&&(("horizontal"==t||"vertical"==t)&&(this.layout=t,"horizontal"==t&&(this.legend.mesh.rotation.z=Math.PI/180*90),"vertical"==t&&(this.legend.mesh.rotation.z=Math.PI/180*-90),this.legend.mesh)))},setLegendPosition:function(t){return this.legend.position=new i(t.x,t.y,t.z),this.legend},setLegendLabels:function(t,e){if(!this.legend)return!1;"function"==typeof t&&(e=t),void 0===t&&(t={}),this.legend.labels={},this.legend.labels.fontsize=t.hasOwnProperty("fontsize")?t.fontsize:24,this.legend.labels.fontface=t.hasOwnProperty("fontface")?t.fontface:"Arial",this.legend.labels.title=t.hasOwnProperty("title")?t.title:"",this.legend.labels.um=t.hasOwnProperty("um")?" [ "+t.um+" ]":"",this.legend.labels.ticks=t.hasOwnProperty("ticks")?t.ticks:0,this.legend.labels.decimal=t.hasOwnProperty("decimal")?t.decimal:2,this.legend.labels.notation=t.hasOwnProperty("notation")?t.notation:"standard";var n=255,r=100,o=100,a=.8,s=255,l=0,u=0,c=1,h=document.createElement("canvas"),p=h.getContext("2d");p.font="Normal "+1.2*this.legend.labels.fontsize+"px "+this.legend.labels.fontface;p.measureText(this.legend.labels.title.toString()+this.legend.labels.um.toString());p.fillStyle="rgba("+n+","+r+","+o+","+a+")",p.strokeStyle="rgba("+s+","+l+","+u+","+c+")",p.lineWidth=4,p.fillStyle="rgba( 0, 0, 0, 1.0 )",p.fillText(this.legend.labels.title.toString()+this.legend.labels.um.toString(),4,this.legend.labels.fontsize+4);var d=new wn(h);d.minFilter=ja;var f=new Sn(new Pt({map:d}));if(f.scale.set(2,1,1),"vertical"==this.legend.layout&&f.position.set(this.legend.position.x+this.legend.dimensions.width,this.legend.position.y+.45*this.legend.dimensions.height,this.legend.position.z),"horizontal"==this.legend.layout&&f.position.set(1.015*this.legend.position.x,this.legend.position.y+.03*this.legend.dimensions.height,this.legend.position.z),this.legend.labels.ticks>0){var m={},v={};if("vertical"==this.legend.layout)var g=this.legend.position.y+.36*this.legend.dimensions.height,y=this.legend.position.y-.61*this.legend.dimensions.height;if("horizontal"==this.legend.layout)var b=this.legend.position.x+.75*this.legend.dimensions.height,_=this.legend.position.x-1.2*this.legend.dimensions.width;for(var x=0;x<this.legend.labels.ticks;x++){var w=(this.maxV-this.minV)/(this.legend.labels.ticks-1)*x+this.minV;w=e?e(w):"scientific"==this.legend.labels.notation?w.toExponential(this.legend.labels.decimal):w.toFixed(this.legend.labels.decimal);var S=document.createElement("canvas"),A=S.getContext("2d");A.font="Normal "+this.legend.labels.fontsize+"px "+this.legend.labels.fontface;A.measureText(w.toString());A.fillStyle="rgba("+n+","+r+","+o+","+a+")",A.strokeStyle="rgba("+s+","+l+","+u+","+c+")",A.lineWidth=4,A.fillStyle="rgba( 0, 0, 0, 1.0 )",A.fillText(w.toString(),4,this.legend.labels.fontsize+4);var M=new wn(S);M.minFilter=ja;var T=new Sn(new Pt({map:M}));if(T.scale.set(2,1,1),"vertical"==this.legend.layout){T.position.set(this.legend.position.x+2.7*this.legend.dimensions.width,C=y+(w-this.minV)/(this.maxV-this.minV)*(g-y),this.legend.position.z)}if("horizontal"==this.legend.layout){var C=_+(w-this.minV)/(this.maxV-this.minV)*(b-_);if(this.legend.labels.ticks>5)if(x%2==0)var E=1.7;else E=2.1;else E=1.7;T.position.set(C,this.legend.position.y-this.legend.dimensions.width*E,this.legend.position.z)}var P=new F({color:0,linewidth:2}),N=[];if("vertical"==this.legend.layout){N.push(new i(this.legend.position.x+.55*this.legend.dimensions.width,L=this.legend.position.y-.5*this.legend.dimensions.height+.01+this.legend.dimensions.height*((w-this.minV)/(this.maxV-this.minV)*.99),this.legend.position.z)),N.push(new i(this.legend.position.x+.7*this.legend.dimensions.width,L,this.legend.position.z))}if("horizontal"==this.legend.layout){var L;N.push(new i(L=this.legend.position.x-.5*this.legend.dimensions.height+.01+this.legend.dimensions.height*((w-this.minV)/(this.maxV-this.minV)*.99),this.legend.position.y-.55*this.legend.dimensions.width,this.legend.position.z)),N.push(new i(L,this.legend.position.y-.7*this.legend.dimensions.width,this.legend.position.z))}var I=new z((new O).setFromPoints(N),P);v[x]=I,m[x]=T}}return{title:f,ticks:m,lines:v}}};var Vc={rainbow:[[0,"0x0000FF"],[.2,"0x00FFFF"],[.5,"0x00FF00"],[.8,"0xFFFF00"],[1,"0xFF0000"]],cooltowarm:[[0,"0x3C4EC2"],[.2,"0x9BBCFF"],[.5,"0xDCDCDC"],[.8,"0xF6A385"],[1,"0xB40426"]],blackbody:[[0,"0x000000"],[.2,"0x780000"],[.5,"0xE63200"],[.8,"0xFFFF00"],[1,"0xFFFFFF"]],grayscale:[[0,"0x000000"],[.2,"0x404040"],[.5,"0x7F7F80"],[.8,"0xBFBFBF"],[1,"0xFFFFFF"]]},Gc=function(t,e){B.call(this,t,e),this.animationsMap={},this.animationsList=[];var n=this.geometry.morphTargets.length;this.createAnimation("__default",0,n-1,n/1),this.setAnimationWeight("__default",1)};Gc.prototype=Object.assign(Object.create(B.prototype),{constructor:Gc,createAnimation:function(t,e,n,r){var i={start:e,end:n,length:n-e+1,fps:r,duration:(n-e)/r,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[t]=i,this.animationsList.push(i)},autoCreateAnimations:function(t){for(var e,n=/([a-z]+)_?(\d+)/i,r={},i=this.geometry,o=0,a=i.morphTargets.length;o<a;o++){var s=i.morphTargets[o].name.match(n);if(s&&s.length>1){r[l=s[1]]||(r[l]={start:1/0,end:-1/0});o<(u=r[l]).start&&(u.start=o),o>u.end&&(u.end=o),e||(e=l)}}for(var l in r){var u;this.createAnimation(l,(u=r[l]).start,u.end,t)}this.firstAnimation=e},setAnimationDirectionForward:function(t){var e=this.animationsMap[t];e&&(e.direction=1,e.directionBackwards=!1)},setAnimationDirectionBackward:function(t){var e=this.animationsMap[t];e&&(e.direction=-1,e.directionBackwards=!0)},setAnimationFPS:function(t,e){var n=this.animationsMap[t];n&&(n.fps=e,n.duration=(n.end-n.start)/n.fps)},setAnimationDuration:function(t,e){var n=this.animationsMap[t];n&&(n.duration=e,n.fps=(n.end-n.start)/n.duration)},setAnimationWeight:function(t,e){var n=this.animationsMap[t];n&&(n.weight=e)},setAnimationTime:function(t,e){var n=this.animationsMap[t];n&&(n.time=e)},getAnimationTime:function(t){var e=0,n=this.animationsMap[t];return n&&(e=n.time),e},getAnimationDuration:function(t){var e=-1,n=this.animationsMap[t];return n&&(e=n.duration),e},playAnimation:function(t){var e=this.animationsMap[t];e?(e.time=0,e.active=!0):console.warn("MorphBlendMesh: animation["+t+"] undefined in .playAnimation()")},stopAnimation:function(t){var e=this.animationsMap[t];e&&(e.active=!1)},update:function(t){for(var e=0,n=this.animationsList.length;e<n;e++){var r=this.animationsList[e];if(r.active){var i=r.duration/r.length;r.time+=r.direction*t,r.mirroredLoop?(r.time>r.duration||r.time<0)&&(r.direction*=-1,r.time>r.duration&&(r.time=r.duration,r.directionBackwards=!0),r.time<0&&(r.time=0,r.directionBackwards=!1)):(r.time=r.time%r.duration,r.time<0&&(r.time+=r.duration));var o=r.start+xo.clamp(Math.floor(r.time/i),0,r.length-1),a=r.weight;o!==r.currentFrame&&(this.morphTargetInfluences[r.lastFrame]=0,this.morphTargetInfluences[r.currentFrame]=1*a,this.morphTargetInfluences[o]=0,r.lastFrame=r.currentFrame,r.currentFrame=o);var s=r.time%i/i;r.directionBackwards&&(s=1-s),r.currentFrame!==r.lastFrame?(this.morphTargetInfluences[r.currentFrame]=s*a,this.morphTargetInfluences[r.lastFrame]=(1-s)*a):this.morphTargetInfluences[r.currentFrame]=a}}}});p.prototype.set=function(t,e,n){this.a=t,this.b=e,this.c=n};var Hc=function(t,e,n,r,i,o){this.array_type=r,this.register_type=n,this.unit_size=i,this.accessors=o,this.buffer=new r(t*i),this.register=[],this.length=0,this.real_length=t,this.available_registers=e;for(var a=0;a<e;a++)this.register.push(new n)};Hc.prototype={constructor:Hc,index_to_register:function(t,e,n){var r=t*this.unit_size;if(e>=this.available_registers)throw new Error("BufferSubdivisionModifier: Not enough registers in TypedArrayHelper.");if(t>this.length)throw new Error("BufferSubdivisionModifier: Index is out of range in TypedArrayHelper.");for(var i=0;i<this.unit_size;i++)this.register[e][this.accessors[i]]=this.buffer[r+i]},resize:function(t){if(0===t&&(t=8),t<this.length)this.buffer=this.buffer.subarray(0,this.length*this.unit_size);else{var e;this.buffer.length<t*this.unit_size?((e=new this.array_type(t*this.unit_size)).set(this.buffer),this.buffer=e,this.real_length=t):((e=new this.array_type(t*this.unit_size)).set(this.buffer.subarray(0,this.length*this.unit_size)),this.buffer=e,this.real_length=t)}},from_existing:function(t){this.buffer=new this.array_type(t.length),this.buffer.set(t),this.length=t.length/this.unit_size,this.real_length=this.length},push_element:function(t){this.length+1>this.real_length&&this.resize(2*this.real_length);for(var e=this.length*this.unit_size,n=0;n<this.unit_size;n++)this.buffer[e+n]=t[this.accessors[n]];this.length++},trim_size:function(){this.length<this.real_length&&this.resize(this.length)}};var Wc=function(t){this.subdivisions=void 0===t?1:t};Wc.prototype.modify=function(t){t instanceof v?(t.mergeVertices(),void 0===t.normals&&(t.normals=[]),t=function(t){for(var e=new O,n=new Hc(t.vertices.length,0,i,Float32Array,3,["x","y","z"]),r=new Hc(t.faces.length,0,p,Uint32Array,3,["a","b","c"]),o=new Hc(3*t.faceVertexUvs[0].length*3,0,m,Float32Array,2,["x","y"]),a=0,s=t.vertices.length;a<s;a++)n.push_element(t.vertices[a]);for(a=0,s=t.faces.length;a<s;a++)r.push_element(t.faces[a]);for(a=0,s=t.faceVertexUvs[0].length;a<s;a++)o.push_element(t.faceVertexUvs[0][a][0]),o.push_element(t.faceVertexUvs[0][a][1]),o.push_element(t.faceVertexUvs[0][a][2]);return r.trim_size(),n.trim_size(),o.trim_size(),e.setIndex(new y(r.buffer,3)),e.addAttribute("position",new y(n.buffer,3)),e.addAttribute("uv",new y(o.buffer,2)),e}(t)):t instanceof O||console.error("BufferSubdivisionModifier: Geometry is not an instance of BufferGeometry or Geometry");for(var e=this.subdivisions;e-- >0;)this.smooth(t);return An(t)};var Xc=function(t,e){this.a=t,this.b=e,this.faces=[],this.newEdge=null};!function(){function t(t,e,n){return n[Math.min(t,e)+"_"+Math.max(t,e)]}function e(t,e,n,r,i,o){var a,s=Math.min(t,e),l=Math.max(t,e),u=s+"_"+l;u in r?a=r[u]:(a=new Xc(s,l),r[u]=a),a.faces.push(i),o[t].edges.push(a),o[e].edges.push(a)}function n(t,e){t.push_element(e)}function r(t,e){return Math.abs(e-t)/2+Math.min(t,e)}function o(t,e,n,r){t.push_element(e),t.push_element(n),t.push_element(r)}var a=["a","b","c"],s=["x","y","z"],l=["x","y"];Wc.prototype.smooth=function(u){var c,h,d,f,v,g,b,_,x,w,S,A,M;c=new Hc(0,3,i,Float32Array,3,s),h=new Hc(0,3,p,Uint32Array,3,a),d=new Hc(0,3,m,Float32Array,2,l),c.from_existing(u.getAttribute("position").array),h.from_existing(u.index.array),d.from_existing(u.getAttribute("uv").array);var T=!1;void 0!==d&&0!==d.length&&(T=!0),function(t,n,r,i){var o,a,s;for(o=0,a=t.length;o<a;o++)r[o]={edges:[]};for(o=0,a=n.length;o<a;o++)n.index_to_register(o,0),e((s=n.register[0]).a,s.b,0,i,o,r),e(s.b,s.c,0,i,o,r),e(s.c,s.a,0,i,o,r)}(c,h,A=new Array(c.length),M={});var C,E,P,O,N,L,I,D=(f=new Hc(2*u.getAttribute("position").array.length/3,2,i,Float32Array,3,s)).register[1];for(_ in M){for(P=f.register[0],N=3/8,L=1/8,2!==(I=(E=M[_]).faces.length)&&(N=.5,L=0),c.index_to_register(E.a,0),c.index_to_register(E.b,1),P.addVectors(c.register[0],c.register[1]).multiplyScalar(N),D.set(0,0,0),w=0;w<I;w++){for(h.index_to_register(E.faces[w],0),O=h.register[0],S=0;S<3&&(c.index_to_register(O[a[S]],2),C=c.register[2],O[a[S]]===E.a||O[a[S]]===E.b);S++);D.add(C)}D.multiplyScalar(L),P.add(D),E.newEdge=f.length,f.push_element(P)}var F,R,k,U,j,B,z,V=f.length;for(_=0,x=c.length;_<x;_++){for(c.index_to_register(_,0,s),B=c.register[0],3===(b=(j=A[_].edges).length)?F=3/16:b>3&&(F=3/(8*b)),R=1-b*F,k=F,b<=2&&2===b&&(R=.75,k=1/8),z=B.multiplyScalar(R),D.set(0,0,0),w=0;w<b;w++)c.index_to_register(C=(U=j[w]).a!==_?U.a:U.b,1,s),D.add(c.register[1]);D.multiplyScalar(k),z.add(D),f.push_element(z,s)}var G,H,W;v=new Hc(4*u.index.array.length/3,1,p,Float32Array,3,a);var X=(g=new Hc(4*u.getAttribute("uv").array.length/2,3,m,Float32Array,2,l)).register[0],Y=g.register[1],q=g.register[2],Z=v.register[0];for(_=0,x=h.length;_<x;_++)if(h.index_to_register(_,0),O=h.register[0],G=t(O.a,O.b,M).newEdge,H=t(O.b,O.c,M).newEdge,W=t(O.c,O.a,M).newEdge,Z.set(G,H,W),n(v,Z),Z.set(O.a+V,G,W),n(v,Z),Z.set(O.b+V,H,G),n(v,Z),Z.set(O.c+V,W,H),n(v,Z),!0===T){d.index_to_register(3*_+0,0),d.index_to_register(3*_+1,1),d.index_to_register(3*_+2,2);var Q=d.register[0],J=d.register[1],K=d.register[2];X.set(r(Q.x,J.x),r(Q.y,J.y)),Y.set(r(J.x,K.x),r(J.y,K.y)),q.set(r(Q.x,K.x),r(Q.y,K.y)),o(g,X,Y,q),o(g,Q,X,q),o(g,J,Y,X),o(g,K,q,Y)}v.trim_size(),f.trim_size(),g.trim_size(),u.setIndex(new y(v.buffer,3)),u.addAttribute("position",new y(f.buffer,3)),u.addAttribute("uv",new y(g.buffer,2))}}();(function(){}).prototype.modify=function(t){for(var e=[],n=0,r=t.faces.length;n<r;n++){var i=e.length,o=t.faces[n],a=t.vertices[o.b],s=t.vertices[o.c];e.push(t.vertices[o.a].clone()),e.push(a.clone()),e.push(s.clone()),o.a=i,o.b=i+1,o.c=i+2}t.vertices=e};!function(){function t(t,e){var n=t.indexOf(e);n>-1&&t.splice(n,1)}function e(t,e){var n,r,i=e.position.distanceTo(t.position),o=0,a=[],s=t.faces.length;for(n=0;n<s;n++)(r=t.faces[n]).hasVertex(e)&&a.push(r);for(n=0;n<s;n++){var l=1;r=t.faces[n];for(var u=0;u<a.length;u++){var c=r.normal.dot(a[u].normal);l=Math.min(l,(1.001-c)/2)}o=Math.max(o,l)}a.length<2&&(o=1);return i*o+0}function n(t){if(0===t.neighbors.length)return t.collapseNeighbor=null,void(t.collapseCost=-.01);t.collapseCost=1e5,t.collapseNeighbor=null;for(var n=0;n<t.neighbors.length;n++){var r=e(t,t.neighbors[n]);t.collapseNeighbor||(t.collapseNeighbor=t.neighbors[n],t.collapseCost=r,t.minCost=r,t.totalCost=0,t.costCount=0),t.costCount++,t.totalCost+=r,r<t.minCost&&(t.collapseNeighbor=t.neighbors[n],t.minCost=r)}t.collapseCost=t.totalCost/t.costCount}function r(e,n){for(console.assert(0===e.faces.length);e.neighbors.length;){t(e.neighbors.pop().neighbors,e)}t(n,e)}function o(e,n){t(n,e),e.v1&&t(e.v1.faces,e),e.v2&&t(e.v2.faces,e),e.v3&&t(e.v3.faces,e);for(var r,i,o=[this.v1,this.v2,this.v3],a=0;a<3;a++)i=o[(a+1)%3],(r=o[a])&&i&&(r.removeIfNonNeighbor(i),i.removeIfNonNeighbor(r))}function a(t,e,i,a){if(a){var s,l=[];for(s=0;s<i.neighbors.length;s++)l.push(i.neighbors[s]);for(s=i.faces.length-1;s>=0;s--)i.faces[s].hasVertex(a)&&o(i.faces[s],e);for(s=i.faces.length-1;s>=0;s--)i.faces[s].replaceVertex(i,a);for(r(i,t),s=0;s<l.length;s++)n(l[s])}else r(i,t)}function s(t){for(var e=t[0],n=0;n<t.length;n++)t[n].collapseCost<e.collapseCost&&(e=t[n]);return e}function l(t,e,n,r,o,a){this.a=r,this.b=o,this.c=a,this.v1=t,this.v2=e,this.v3=n,this.normal=new i,this.computeNormal(),t.faces.push(this),t.addUniqueNeighbor(e),t.addUniqueNeighbor(n),e.faces.push(this),e.addUniqueNeighbor(t),e.addUniqueNeighbor(n),n.faces.push(this),n.addUniqueNeighbor(t),n.addUniqueNeighbor(e)}function u(t,e){this.position=t,this.id=e,this.faces=[],this.neighbors=[],this.collapseCost=0,this.collapseNeighbor=null}var c=new i,h=new i;l.prototype.computeNormal=function(){var t=this.v1.position,e=this.v2.position;c.subVectors(this.v3.position,e),h.subVectors(t,e),c.cross(h).normalize(),this.normal.copy(c)},l.prototype.hasVertex=function(t){return t===this.v1||t===this.v2||t===this.v3},l.prototype.replaceVertex=function(e,n){e===this.v1?this.v1=n:e===this.v2?this.v2=n:e===this.v3&&(this.v3=n),t(e.faces,this),n.faces.push(this),e.removeIfNonNeighbor(this.v1),this.v1.removeIfNonNeighbor(e),e.removeIfNonNeighbor(this.v2),this.v2.removeIfNonNeighbor(e),e.removeIfNonNeighbor(this.v3),this.v3.removeIfNonNeighbor(e),this.v1.addUniqueNeighbor(this.v2),this.v1.addUniqueNeighbor(this.v3),this.v2.addUniqueNeighbor(this.v1),this.v2.addUniqueNeighbor(this.v3),this.v3.addUniqueNeighbor(this.v1),this.v3.addUniqueNeighbor(this.v2),this.computeNormal()},u.prototype.addUniqueNeighbor=function(t){!function(t,e){-1===t.indexOf(e)&&t.push(e)}(this.neighbors,t)},u.prototype.removeIfNonNeighbor=function(t){var e=this.neighbors,n=this.faces,r=e.indexOf(t);if(-1!==r){for(var i=0;i<n.length;i++)if(n[i].hasVertex(t))return;e.splice(r,1)}},function(){}.prototype.modify=function(t,e){t instanceof O&&!t.vertices&&!t.faces&&(console.log("converting BufferGeometry to Geometry"),t=(new v).fromBufferGeometry(t)),t.mergeVertices();var r,i,o,c=t.vertices,h=t.faces,d=(new v,new Array(c.length)),f=new Array(h.length);for(r=0,i=c.length;r<i;r++)d[r]=new u(c[r],r);for(r=0,i=h.length;r<i;r++)f[r]=new l(d[(o=h[r]).a],d[o.b],d[o.c],o.a,o.b,o.c);for(r=0,i=d.length;r<i;r++)n(d[r]);for(var m,g=e;g--;){if(!(m=s(d))){console.log("no next vertex");break}a(d,f,m,m.collapseNeighbor)}var y=new v;for(r=0;r<d.length;r++){y.vertices.push(d[r].position)}for(r=0;r<f.length;r++){var b=f[r];y.faces.push(new p(d.indexOf(b.v1),d.indexOf(b.v2),d.indexOf(b.v3)))}return y}}();var Yc=function(t){this.subdivisions=void 0===t?1:t};Yc.prototype.modify=function(t){for(var e=this.subdivisions;e-- >0;)this.smooth(t);t.computeFaceNormals(),t.computeVertexNormals()},function(){function t(t,e,n){return n[Math.min(t,e)+"_"+Math.max(t,e)]}function e(t,e,n,r,i,o){var a,s=Math.min(t,e),l=Math.max(t,e),u=s+"_"+l;if(u in r)a=r[u];else{r[u]=a={a:n[s],b:n[l],newEdge:null,faces:[]}}a.faces.push(i),o[t].edges.push(a),o[e].edges.push(a)}function n(t,e,n,r){t.push(new p(e,n,r))}function r(t,e){return Math.abs(e-t)/2+Math.min(t,e)}function o(t,e,n,r){t.push([e.clone(),n.clone(),r.clone()])}var a=["a","b","c"];Yc.prototype.smooth=function(s){var l,u,c,h,p,d,f,v,g,y,b,_,x,w,S=new i,A=[];l=s.vertices,u=s.faces;var M=void 0!==(c=s.faceVertexUvs[0])&&c.length>0;(function(t,n,r,i){var o,a,s;for(o=0,a=t.length;o<a;o++)r[o]={edges:[]};for(o=0,a=n.length;o<a;o++)e((s=n[o]).a,s.b,t,i,s,r),e(s.b,s.c,t,i,s,r),e(s.c,s.a,t,i,s,r)})(l,u,b=new Array(l.length),_={}),x=[];var T,C,E,P,O,N,L;for(f in _){for(C=_[f],E=new i,O=3/8,N=1/8,2!=(L=C.faces.length)&&(O=.5,N=0),E.addVectors(C.a,C.b).multiplyScalar(O),S.set(0,0,0),g=0;g<L;g++){for(P=C.faces[g],y=0;y<3&&((T=l[P[a[y]]])===C.a||T===C.b);y++);S.add(T)}S.multiplyScalar(N),E.add(S),C.newEdge=x.length,x.push(E)}var I,D,F,R,k,U,j;for(w=[],f=0,v=l.length;f<v;f++){for(U=l[f],3==(d=(k=b[f].edges).length)?I=3/16:d>3&&(I=3/(8*d)),D=1-d*I,F=I,d<=2&&2==d&&(D=.75,F=1/8),j=U.clone().multiplyScalar(D),S.set(0,0,0),g=0;g<d;g++)S.add(T=(R=k[g]).a!==U?R.a:R.b);S.multiplyScalar(F),j.add(S),w.push(j)}h=w.concat(x);var B,z,V,G=w.length;p=[];var H,W,X,Y,q=new m,Z=new m,Q=new m;for(f=0,v=u.length;f<v;f++)n(p,B=t((P=u[f]).a,P.b,_).newEdge+G,z=t(P.b,P.c,_).newEdge+G,V=t(P.c,P.a,_).newEdge+G),n(p,P.a,B,V),n(p,P.b,z,B),n(p,P.c,V,z),M&&(Y=(H=c[f])[2],q.set(r((W=H[0]).x,(X=H[1]).x),r(W.y,X.y)),Z.set(r(X.x,Y.x),r(X.y,Y.y)),Q.set(r(W.x,Y.x),r(W.y,Y.y)),o(A,q,Z,Q),o(A,W,q,Q),o(A,X,Z,q),o(A,Y,Q,Z));s.vertices=h,s.faces=p,M&&(s.faceVertexUvs[0]=A)}}();(function(t){this.maxEdgeLength=t}).prototype.modify=function(t){for(var e,n=[],r=[],i=this.maxEdgeLength*this.maxEdgeLength,o=0,a=t.faceVertexUvs.length;o<a;o++)r[o]=[];for(o=0,a=t.faces.length;o<a;o++){var s=t.faces[o];if(s instanceof p){var l=s.a,u=s.b,c=s.c,h=t.vertices[l],d=t.vertices[u],f=t.vertices[c],m=h.distanceToSquared(d),v=d.distanceToSquared(f),g=h.distanceToSquared(f);if(m>i||v>i||g>i){var y=t.vertices.length,b=s.clone(),_=s.clone();if(m>=v&&m>=g){if((x=h.clone()).lerp(d,.5),b.a=l,b.b=y,b.c=c,_.a=y,_.b=u,_.c=c,3===s.vertexNormals.length){(w=s.vertexNormals[0].clone()).lerp(s.vertexNormals[1],.5),b.vertexNormals[1].copy(w),_.vertexNormals[0].copy(w)}if(3===s.vertexColors.length){(S=s.vertexColors[0].clone()).lerp(s.vertexColors[1],.5),b.vertexColors[1].copy(S),_.vertexColors[0].copy(S)}e=0}else if(v>=m&&v>=g){if((x=d.clone()).lerp(f,.5),b.a=l,b.b=u,b.c=y,_.a=y,_.b=c,_.c=l,3===s.vertexNormals.length){(w=s.vertexNormals[1].clone()).lerp(s.vertexNormals[2],.5),b.vertexNormals[2].copy(w),_.vertexNormals[0].copy(w),_.vertexNormals[1].copy(s.vertexNormals[2]),_.vertexNormals[2].copy(s.vertexNormals[0])}if(3===s.vertexColors.length){(S=s.vertexColors[1].clone()).lerp(s.vertexColors[2],.5),b.vertexColors[2].copy(S),_.vertexColors[0].copy(S),_.vertexColors[1].copy(s.vertexColors[2]),_.vertexColors[2].copy(s.vertexColors[0])}e=1}else{var x;if((x=h.clone()).lerp(f,.5),b.a=l,b.b=u,b.c=y,_.a=y,_.b=u,_.c=c,3===s.vertexNormals.length){var w;(w=s.vertexNormals[0].clone()).lerp(s.vertexNormals[2],.5),b.vertexNormals[2].copy(w),_.vertexNormals[0].copy(w)}if(3===s.vertexColors.length){var S;(S=s.vertexColors[0].clone()).lerp(s.vertexColors[2],.5),b.vertexColors[2].copy(S),_.vertexColors[0].copy(S)}e=2}n.push(b,_),t.vertices.push(x);for(var A=0,M=t.faceVertexUvs.length;A<M;A++)if(t.faceVertexUvs[A].length){var T=t.faceVertexUvs[A][o],C=T[0],E=T[1],P=T[2];if(0===e){(L=C.clone()).lerp(E,.5);var O=[C.clone(),L.clone(),P.clone()],N=[L.clone(),E.clone(),P.clone()]}else if(1===e){(L=E.clone()).lerp(P,.5);O=[C.clone(),E.clone(),L.clone()],N=[L.clone(),P.clone(),C.clone()]}else{var L;(L=C.clone()).lerp(P,.5);O=[C.clone(),E.clone(),L.clone()],N=[L.clone(),E.clone(),P.clone()]}r[A].push(O,N)}}else{n.push(s);for(A=0,M=t.faceVertexUvs.length;A<M;A++)r[A].push(t.faceVertexUvs[A][o])}}}t.faces=n,t.faceVertexUvs=r};var qc=function(t,e){B.call(this,t,e),this.type="MorphAnimMesh",this.mixer=new gn(this),this.activeAction=null};qc.prototype=Object.create(B.prototype),qc.prototype.constructor=qc,qc.prototype.setDirectionForward=function(){this.mixer.timeScale=1},qc.prototype.setDirectionBackward=function(){this.mixer.timeScale=-1},qc.prototype.playAnimation=function(t,e){this.activeAction&&(this.activeAction.stop(),this.activeAction=null);var n=ot.findByName(this,t);if(!n)throw new Error("MorphAnimMesh: animations["+t+"] undefined in .playAnimation()");var r=this.mixer.clipAction(n);r.timeScale=n.tracks.length*e/n.duration,this.activeAction=r.play()},qc.prototype.updateAnimation=function(t){this.mixer.update(t)},qc.prototype.copy=function(t){return B.prototype.copy.call(this,t),this.mixer=new gn(this),this};var Zc=function(t){Eu.call(this,"v4",{shared:!1}),this.index=t||0};Zc.vertexDict=["color","color2"],Zc.fragmentDict=["vColor","vColor2"],(Zc.prototype=Object.create(Eu.prototype)).constructor=Zc,Zc.prototype.generate=function(t,e){var n;return t.material.requires.color[this.index]=!0,n=t.isShader("vertex")?Zc.vertexDict[this.index]:Zc.fragmentDict[this.index],t.format(n,this.getType(t),e)},Zc.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).index=this.index),e};var Qc=function(t){Eu.call(this,"v3",{shared:!1}),this.scope=t||Qc.TOTAL};Qc.TOTAL="total",Qc.prototype=Object.create(Eu.prototype),Qc.prototype.constructor=Qc,Qc.prototype.nodeType="Light",Qc.prototype.generate=function(t,e){return t.isCache("light")?t.format("reflectedLight.directDiffuse",this.getType(t),e):(console.warn('LightNode is only compatible in "light" channel.'),t.format("vec3( 0.0 )",this.getType(t),e))},Qc.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).scope=this.scope),e};var Jc=function(t){Eu.call(this,"v3",{unique:!0}),this.scope=t||Jc.CUBE};Jc.CUBE="cube",Jc.SPHERE="sphere",Jc.VECTOR="vector",Jc.prototype=Object.create(Eu.prototype),Jc.prototype.constructor=Jc,Jc.prototype.nodeType="Reflect",Jc.prototype.getType=function(t){switch(this.scope){case Jc.SPHERE:return"v2"}return this.type},Jc.prototype.generate=function(t,e){var n;switch(this.scope){case Jc.VECTOR:t.material.addFragmentNode("vec3 reflectVec = inverseTransformDirection( reflect( -normalize( vViewPosition ), normal ), viewMatrix );"),n="reflectVec";break;case Jc.CUBE:var r=new Jc(Jc.VECTOR).build(t,"v3");t.material.addFragmentNode("vec3 reflectCubeVec = vec3( -1.0 * "+r+".x, "+r+".yz );"),n="reflectCubeVec";break;case Jc.SPHERE:r=new Jc(Jc.VECTOR).build(t,"v3");t.material.addFragmentNode("vec2 reflectSphereVec = normalize((viewMatrix * vec4("+r+", 0.0 )).xyz + vec3(0.0,0.0,1.0)).xy * 0.5 + 0.5;"),n="reflectSphereVec"}return t.format(n,this.getType(this.type),e)},Jc.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).scope=this.scope),e};var Kc=function(t){Eu.call(this,"v2"),this.resolution=t};(Kc.prototype=Object.create(Eu.prototype)).constructor=Kc,Kc.prototype.nodeType="ScreenUV",Kc.prototype.generate=function(t,e){var n;return t.isShader("fragment")?n="(gl_FragCoord.xy/"+this.resolution.build(t,"v2")+")":(console.warn("ScreenUVNode is not compatible with "+t.shader+" shader."),n="vec2( 0.0 )"),t.format(n,this.getType(t),e)},Kc.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).resolution=this.resolution.toJSON(t).uuid),e};var $c=function(t,e){Cu.call(this,e),this.name=t};($c.prototype=Object.create(Cu.prototype)).constructor=$c,$c.prototype.nodeType="Attribute",$c.prototype.getAttributeType=function(t){return"number"==typeof this.type?t.getConstructorFromLength(this.type):this.type},$c.prototype.getType=function(t){var e=this.getAttributeType(t);return t.getTypeByFormat(e)},$c.prototype.generate=function(t,e){var n=this.getAttributeType(t),r=t.material.getAttribute(this.name,n);return t.format(t.isShader("vertex")?this.name:r.varying.name,this.getType(t),e)},$c.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).out=this.type),e};var th=function(t,e){Eu.call(this),this.setFunction(t,e)};(th.prototype=Object.create(Eu.prototype)).constructor=th,th.prototype.nodeType="FunctionCall",th.prototype.setFunction=function(t,e){this.value=t,this.inputs=e||[]},th.prototype.getFunction=function(){return this.value},th.prototype.getType=function(t){return this.value.getType(t)},th.prototype.generate=function(t,e){for(var n=this.getType(t),r=this.value,i=r.build(t,e)+"(",o=[],a=0;a<r.inputs.length;a++){var s=r.inputs[a];o.push((this.inputs[a]||this.inputs[s.name]).build(t,t.getTypeByFormat(s.type)))}return i+=o.join(",")+")",t.format(i,n,e)},th.prototype.toJSON=function(t){var e=this.getJSONNode(t);if(!e){var n=this.value;if(e=this.createJSONNode(t),e.value=this.value.toJSON(t).uuid,n.inputs.length){e.inputs={};for(var r=0;r<n.inputs.length;r++){var i=n.inputs[r];e.inputs[i.name]=(this.inputs[r]||this.inputs[i.name]).toJSON(t).uuid}}}return e};var eh=function(t){Cu.call(this,"v4"),this.value=t};(eh.prototype=Object.create(Cu.prototype)).constructor=eh,eh.prototype.nodeType="Raw",eh.prototype.generate=function(t){var e=this.value.parseAndBuildCode(t,this.type),n=e.code+"\n";return n+="vertex"==t.shader?"gl_Position = "+e.result+";":"gl_FragColor = "+e.result+";"},eh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).value=this.value.toJSON(t).uuid),e};var nh=function(t){this.material=t,this.caches=[],this.slots=[],this.keywords={},this.parsing=!1,this.optimize=!0,this.update()};nh.type={float:"fv1",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"iv1"},nh.constructors=["float","vec2","vec3","vec4"],nh.elements=["x","y","z","w"],nh.prototype={constructor:nh,addCache:function(t,e){return this.caches.push({name:t||"",requires:e||{}}),this.update()},removeCache:function(){return this.caches.pop(),this.update()},addSlot:function(t){return this.slots.push({name:t||""}),this.update()},removeSlot:function(){return this.slots.pop(),this.update()},isCache:function(t){for(var e=this.caches.length;e--;)if(this.caches[e].name==t)return!0;return!1},isSlot:function(t){for(var e=this.slots.length;e--;)if(this.slots[e].name==t)return!0;return!1},update:function(){var t=this.caches[this.caches.length-1],e=this.slots[this.slots.length-1];return this.slot=e?e.name:"",this.cache=t?t.name:"",this.requires=t?t.requires:{},this},require:function(t,e){return this.requires[t]=e,this},include:function(t,e,n){return this.material.include(this,t,e,n),this},colorToVector:function(t){return t.replace("r","x").replace("g","y").replace("b","z").replace("a","w")},getConstructorFromLength:function(t){return nh.constructors[t-1]},getFormatName:function(t){return t.replace(/c/g,"v3").replace(/fv1/g,"v1").replace(/iv1/g,"i")},isFormatMatrix:function(t){return/^m/.test(t)},getFormatLength:function(t){return parseInt(this.getFormatName(t).substr(1))},getFormatFromLength:function(t){return 1==t?"fv1":"v"+t},format:function(t,e,n){switch(this.getFormatName(n+"="+e)){case"v1=v2":case"v1=v3":case"v1=v4":return t+".x";case"v1=i":return"float("+t+")";case"v2=v1":return"vec2("+t+")";case"v2=v3":case"v2=v4":return t+".xy";case"v2=i":return"vec2(float("+t+"))";case"v3=v1":return"vec3("+t+")";case"v3=v2":return"vec3("+t+",0.0)";case"v3=v4":return t+".xyz";case"v3=i":return"vec2(float("+t+"))";case"v4=v1":return"vec4("+t+")";case"v4=v2":return"vec4("+t+",0.0,1.0)";case"v4=v3":return"vec4("+t+",1.0)";case"v4=i":return"vec4(float("+t+"))";case"i=v1":return"int("+t+")";case"i=v2":case"i=v3":case"i=v4":return"int("+t+".x)"}return t},getTypeByFormat:function(t){return nh.type[t]||t},getUuid:function(t,e){return(e=void 0===e||e)&&this.cache&&(t=this.cache+"-"+t),t},getElementByIndex:function(t){return nh.elements[t]},getIndexByElement:function(t){return nh.elements.indexOf(t)},isShader:function(t){return this.shader==t},setShader:function(t){return this.shader=t,this}};var rh=function(t,e){dt.call(this),this.vertex=t||new eh(new Lu(Lu.PROJECTION)),this.fragment=e||new eh(new ih(16711680)),this.updaters=[]};rh.types={t:"sampler2D",tc:"samplerCube",bv1:"bool",iv1:"int",fv1:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4"},rh.addShortcuts=function(t,e,n){function r(t,e){return{get:function(){return this[t][e]},set:function(n){this[t][e]=n}}}return function(){for(var i={},o=0;o<n.length;++o){var a=n[o];i[a]=r(e,a)}Object.defineProperties(t,i)}()},(rh.prototype=Object.create(dt.prototype)).constructor=rh,rh.prototype.type="NodeMaterial",rh.prototype.updateFrame=function(t){for(var e=0;e<this.updaters.length;++e)t.updateNode(this.updaters[e])},rh.prototype.build=function(){var t,e;this.nodes=[],this.defines={},this.uniforms={},this.attributes={},this.extensions={},this.nodeData={},this.vertexUniform=[],this.fragmentUniform=[],this.vars=[],this.vertexTemps=[],this.fragmentTemps=[],this.uniformList=[],this.consts=[],this.functions=[],this.updaters=[],this.requires={uv:[],color:[],lights:this.lights,fog:this.fog},this.vertexPars="",this.fragmentPars="",this.vertexCode="",this.fragmentCode="",this.vertexNode="",this.fragmentNode="",this.prefixCode=["#ifdef GL_EXT_shader_texture_lod","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCube(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif","#include <packing>"].join("\n");var n=new nh(this);return t=this.vertex.build(n.setShader("vertex"),"v4"),e=this.fragment.build(n.setShader("fragment"),"v4"),this.requires.uv[0]&&(this.addVertexPars("varying vec2 vUv;"),this.addFragmentPars("varying vec2 vUv;"),this.addVertexCode("vUv = uv;")),this.requires.uv[1]&&(this.addVertexPars("varying vec2 vUv2; attribute vec2 uv2;"),this.addFragmentPars("varying vec2 vUv2;"),this.addVertexCode("vUv2 = uv2;")),this.requires.color[0]&&(this.addVertexPars("varying vec4 vColor; attribute vec4 color;"),this.addFragmentPars("varying vec4 vColor;"),this.addVertexCode("vColor = color;")),this.requires.color[1]&&(this.addVertexPars("varying vec4 vColor2; attribute vec4 color2;"),this.addFragmentPars("varying vec4 vColor2;"),this.addVertexCode("vColor2 = color2;")),this.requires.position&&(this.addVertexPars("varying vec3 vPosition;"),this.addFragmentPars("varying vec3 vPosition;"),this.addVertexCode("vPosition = transformed;")),this.requires.worldPosition&&(this.addVertexPars("varying vec3 vWPosition;"),this.addFragmentPars("varying vec3 vWPosition;"),this.addVertexCode("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;")),this.requires.normal&&(this.addVertexPars("varying vec3 vObjectNormal;"),this.addFragmentPars("varying vec3 vObjectNormal;"),this.addVertexCode("vObjectNormal = normal;")),this.requires.worldNormal&&(this.addVertexPars("varying vec3 vWNormal;"),this.addFragmentPars("varying vec3 vWNormal;"),this.addVertexCode("vWNormal = ( modelMatrix * vec4( objectNormal, 0.0 ) ).xyz;")),this.fog=this.requires.fog,this.lights=this.requires.lights,this.transparent=this.requires.transparent||this.blending>Vo,this.vertexShader=[this.prefixCode,this.vertexPars,this.getCodePars(this.vertexUniform,"uniform"),this.getIncludes(this.consts.vertex),this.getIncludes(this.functions.vertex),"void main(){",this.getCodePars(this.vertexTemps),t,this.vertexCode,"}"].join("\n"),this.fragmentShader=[this.prefixCode,this.fragmentPars,this.getCodePars(this.fragmentUniform,"uniform"),this.getIncludes(this.consts.fragment),this.getIncludes(this.functions.fragment),"void main(){",this.getCodePars(this.fragmentTemps),this.fragmentCode,e,"}"].join("\n"),this.needsUpdate=!0,this.dispose(),this},rh.prototype.define=function(t,e){this.defines[t]=void 0==e?1:e},rh.prototype.isDefined=function(t){return void 0!=this.defines[t]},rh.prototype.mergeUniform=function(t){for(var e in t)this.uniforms[e]=t[e]},rh.prototype.createUniform=function(t,e,n,r){var i={type:t,value:e,name:n||"nVu"+this.uniformList.length,needsUpdate:r};return this.uniformList.push(i),i},rh.prototype.getVertexTemp=function(t,e,n){var r=this.vertexTemps[t];if(!r){this.vertexTemps.push(r={name:n||"nVt"+this.vertexTemps.length,type:e}),this.vertexTemps[t]=r}return r},rh.prototype.getFragmentTemp=function(t,e,n){var r=this.fragmentTemps[t];if(!r){this.fragmentTemps.push(r={name:n||"nVt"+this.fragmentTemps.length,type:e}),this.fragmentTemps[t]=r}return r},rh.prototype.getVar=function(t,e,n){var r=this.vars[t];if(!r){var i=n||"nVv"+this.vars.length;this.vars.push(r={name:i,type:e}),this.vars[t]=r,this.addVertexPars("varying "+e+" "+i+";"),this.addFragmentPars("varying "+e+" "+i+";")}return r},rh.prototype.getAttribute=function(t,e){if(!this.attributes[t]){var n=this.getVar(t,e);this.addVertexPars("attribute "+e+" "+t+";"),this.addVertexCode(n.name+" = "+t+";"),this.attributes[t]={varying:n,name:t,type:e}}return this.attributes[t]},rh.prototype.getIncludes=function(){function t(t,e){return t.deps.length-e.deps.length}return function(e){if(!e)return"";for(var n="",r=(e=e.sort(t),0);r<e.length;r++)e[r].src&&(n+=e[r].src+"\n");return n}}(),rh.prototype.addVertexPars=function(t){this.vertexPars+=t+"\n"},rh.prototype.addFragmentPars=function(t){this.fragmentPars+=t+"\n"},rh.prototype.addVertexCode=function(t){this.vertexCode+=t+"\n"},rh.prototype.addFragmentCode=function(t){this.fragmentCode+=t+"\n"},rh.prototype.addVertexNode=function(t){this.vertexNode+=t+"\n"},rh.prototype.clearVertexNode=function(){var t=this.vertexNode;return this.vertexNode="",t},rh.prototype.addFragmentNode=function(t){this.fragmentNode+=t+"\n"},rh.prototype.clearFragmentNode=function(){var t=this.fragmentNode;return this.fragmentNode="",t},rh.prototype.getCodePars=function(t,e){e=e||"";for(var n="",r=0,i=t.length;r<i;++r){var o=t[r].type,a=t[r].name;"t"==o&&t[r].value instanceof hn&&(o="tc");var s=rh.types[o];if(void 0==s)throw new Error("Node pars "+o+" not found.");n+=e+" "+s+" "+a+";\n"}return n},rh.prototype.createVertexUniform=function(t,e,n,r){var i=this.createUniform(t,e,n,r);return this.vertexUniform.push(i),this.vertexUniform[i.name]=i,this.uniforms[i.name]=i,i},rh.prototype.createFragmentUniform=function(t,e,n,r){var i=this.createUniform(t,e,n,r);return this.fragmentUniform.push(i),this.fragmentUniform[i.name]=i,this.uniforms[i.name]=i,i},rh.prototype.getDataNode=function(t){return this.nodeData[t]=this.nodeData[t]||{}},rh.prototype.include=function(t,e,n,r){var i;(e="string"==typeof e?Ou.get(e):e)instanceof Pu?i=this.functions[t.shader]=this.functions[t.shader]||[]:e instanceof ku&&(i=this.consts[t.shader]=this.consts[t.shader]||[]);var o=i[e.name];if(o||(o=i[e.name]={node:e,deps:[]},i.push(o),o.src=e.build(t,"source")),e instanceof Pu&&n&&i[n.name]&&-1==i[n.name].deps.indexOf(e)&&(i[n.name].deps.push(e),e.includes&&e.includes.length)){var a=0;do{this.include(t,e.includes[a++],n)}while(a<e.includes.length)}r&&(o.src=r)},rh.prototype.toJSON=function(t){if((void 0===t||"string"==typeof t)&&(t={nodes:{}}),t&&!t.materials&&(t.materials={}),!t.materials[this.uuid]){var e={};e.uuid=this.uuid,e.type=this.type,t.materials[e.uuid]=e,""!==this.name&&(e.name=this.name),this.blending!==Vo&&(e.blending=this.blending),!0===this.flatShading&&(e.flatShading=this.flatShading),this.side!==Fo&&(e.side=this.side),!0===this.transparent&&(e.transparent=this.transparent),e.depthFunc=this.depthFunc,e.depthTest=this.depthTest,e.depthWrite=this.depthWrite,!0===this.wireframe&&(e.wireframe=this.wireframe),this.wireframeLinewidth>1&&(e.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(e.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(e.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(e.morphTargets=!0),!0===this.skinning&&(e.skinning=!0),e.fog=this.fog,e.lights=this.lights,!1===this.visible&&(e.visible=!1),"{}"!==JSON.stringify(this.userData)&&(e.userData=this.userData),e.vertex=this.vertex.toJSON(t).uuid,e.fragment=this.fragment.toJSON(t).uuid}return t.material=this.uuid,t};var ih=function(t){Du.call(this,"c"),this.value=new h(t||0)};ih.prototype=Object.create(Du.prototype),ih.prototype.constructor=ih,ih.prototype.nodeType="Color",rh.addShortcuts(ih.prototype,"value",["r","g","b"]),ih.prototype.generateReadonly=function(t,e,n,r,i,o){return t.format("vec3( "+this.r+", "+this.g+", "+this.b+" )",r,e)},ih.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).r=this.r,e.g=this.g,e.b=this.b,!0===this.readonly&&(e.readonly=!0)),e};var oh=function(t,e,n){Du.call(this,"v4",{shared:!0}),this.value=t,this.coord=e||new Jc,this.bias=n};(oh.prototype=Object.create(Du.prototype)).constructor=oh,oh.prototype.nodeType="CubeTexture",oh.prototype.getTexture=function(t,e){return Du.prototype.generate.call(this,t,e,this.value.uuid,"t")},oh.prototype.generate=function(t,e){if("samplerCube"===e)return this.getTexture(t,e);var n=this.getTexture(t,e),r=this.coord.build(t,"v3"),i=this.bias?this.bias.build(t,"fv1"):void 0;void 0==i&&t.requires.bias&&(i=t.requires.bias.build(t,"fv1"));var o;return o=i?"texCubeBias("+n+","+r+","+i+")":"texCube("+n+","+r+")",t.isSlot("color")?o="mapTexelToLinear("+o+")":t.isSlot("emissive")?o="emissiveMapTexelToLinear("+o+")":t.isSlot("environment")&&(o="envMapTexelToLinear("+o+")"),t.format(o,this.type,e)},oh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).value=this.value.uuid,e.coord=this.coord.toJSON(t).uuid,this.bias&&(e.bias=this.bias.toJSON(t).uuid)),e};var ah=function(t){Du.call(this,"iv1"),this.value=[Math.floor(t||0)]};(ah.prototype=Object.create(Du.prototype)).constructor=ah,ah.prototype.nodeType="Int",Object.defineProperties(ah.prototype,{number:{get:function(){return this.value[0]},set:function(t){this.value[0]=Math.floor(t)}}}),ah.prototype.generateReadonly=function(t,e,n,r,i,o){return t.format(this.number,r,e)},ah.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).number=this.number,!0===this.readonly&&(e.readonly=!0)),e};var sh=function(t){Du.call(this,"m3"),this.value=t||new u};(sh.prototype=Object.create(Du.prototype)).constructor=sh,sh.prototype.nodeType="Matrix3",sh.prototype.generateReadonly=function(t,e,n,r,i,o){return t.format("mat3( "+this.value.elements.join(", ")+" )",r,e)},sh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).elements=this.value.elements.concat(),!0===this.readonly&&(e.readonly=!0)),e};var lh=function(t){Du.call(this,"m4"),this.value=t||new r};(lh.prototype=Object.create(Du.prototype)).constructor=lh,lh.prototype.nodeType="Matrix4",lh.prototype.generateReadonly=function(t,e,n,r,i,o){return t.format("mat4( "+this.value.elements.join(", ")+" )",r,e)},lh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).elements=this.value.elements.concat(),!0===this.readonly&&(e.readonly=!0)),e};var uh=function(t,e,n){Eu.call(this),this.a=t,this.b=e,this.op=n||uh.ADD};uh.ADD="+",uh.SUB="-",uh.MUL="*",uh.DIV="/",uh.prototype=Object.create(Eu.prototype),uh.prototype.constructor=uh,uh.prototype.nodeType="Operator",uh.prototype.getType=function(t){var e=this.a.getType(t),n=this.b.getType(t);return t.isFormatMatrix(e)?"v4":t.getFormatLength(n)>t.getFormatLength(e)?n:e},uh.prototype.generate=function(t,e){t.material.getDataNode(this.uuid);var n=this.getType(t),r=this.a.build(t,n),i=this.b.build(t,n);return t.format("("+r+this.op+i+")",n,e)},uh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).a=this.a.toJSON(t).uuid,e.b=this.b.toJSON(t).uuid,e.op=this.op),e};var ch=function(t,e,n,r){Du.call(this,"v4",{shared:!0}),this.value=t,this.coord=e||new Nu,this.bias=n,this.project=void 0!==r&&r};(ch.prototype=Object.create(Du.prototype)).constructor=ch,ch.prototype.nodeType="Texture",ch.prototype.getTexture=function(t,e){return Du.prototype.generate.call(this,t,e,this.value.uuid,"t")},ch.prototype.generate=function(t,e){if("sampler2D"===e)return this.getTexture(t,e);var n=this.getTexture(t,e),r=this.coord.build(t,this.project?"v4":"v2"),i=this.bias?this.bias.build(t,"fv1"):void 0;void 0==i&&t.requires.bias&&(i=t.requires.bias.build(t,"fv1"));var o,a;return o=this.project?"texture2DProj":i?"tex2DBias":"tex2D",a=i?o+"("+n+","+r+","+i+")":o+"("+n+","+r+")",t.isSlot("color")?a="mapTexelToLinear("+a+")":t.isSlot("emissive")?a="emissiveMapTexelToLinear("+a+")":t.isSlot("environment")&&(a="envMapTexelToLinear("+a+")"),t.format(a,this.type,e)},ch.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||(e=this.createJSONNode(t),this.value&&(e.value=this.value.uuid),e.coord=this.coord.toJSON(t).uuid,e.project=this.project,this.bias&&(e.bias=this.bias.toJSON(t).uuid)),e};var hh=function(t){Eu.call(this,"v4"),t&&this.setMirror(t)};(hh.prototype=Object.create(Eu.prototype)).constructor=hh,hh.prototype.nodeType="Reflector",hh.prototype.setMirror=function(t){this.mirror=t,this.textureMatrix=new lh(this.mirror.material.uniforms.textureMatrix.value),this.localPosition=new Lu(Lu.LOCAL),this.coord=new uh(this.textureMatrix,this.localPosition,uh.MUL),this.coordResult=new uh(null,this.coord,uh.ADD),this.texture=new ch(this.mirror.material.uniforms.tDiffuse.value,this.coord,null,!0)},hh.prototype.generate=function(t,e){return t.isShader("fragment")?(this.coordResult.a=this.offset,this.texture.coord=this.offset?this.coordResult:this.coord,"sampler2D"===e?this.texture.build(t,e):t.format(this.texture.build(t,this.type),this.type,e)):(console.warn("ReflectorNode is not compatible with "+t.shader+" shader."),t.format("vec4(0.0)",this.type,e))},hh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).mirror=this.mirror.uuid,this.offset&&(e.offset=this.offset.toJSON(t).uuid)),e};var ph=function(t){ch.call(this,void 0,t)};(ph.prototype=Object.create(ch.prototype)).constructor=ph,ph.prototype.nodeType="Screen",ph.prototype.isUnique=function(){return!0},ph.prototype.getTexture=function(t,e){return Du.prototype.generate.call(this,t,e,this.getUuid(),"t","renderTexture")};var dh=function(t,e){Du.call(this,"v2"),this.value=new m(t,e)};(dh.prototype=Object.create(Du.prototype)).constructor=dh,dh.prototype.nodeType="Vector2",rh.addShortcuts(dh.prototype,"value",["x","y"]),dh.prototype.generateReadonly=function(t,e,n,r,i,o){return t.format("vec2( "+this.x+", "+this.y+" )",r,e)},dh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).x=this.x,e.y=this.y,!0===this.readonly&&(e.readonly=!0)),e};var fh=function(t,e,n){Du.call(this,"v3"),this.type="v3",this.value=new i(t,e,n)};(fh.prototype=Object.create(Du.prototype)).constructor=fh,fh.prototype.nodeType="Vector3",rh.addShortcuts(fh.prototype,"value",["x","y","z"]),fh.prototype.generateReadonly=function(t,e,n,r,i,o){return t.format("vec3( "+this.x+", "+this.y+", "+this.z+" )",r,e)},fh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).x=this.x,e.y=this.y,e.z=this.z,!0===this.readonly&&(e.readonly=!0)),e};var mh=function(t,e,n,r){Du.call(this,"v4"),this.value=new g(t,e,n,r)};(mh.prototype=Object.create(Du.prototype)).constructor=mh,mh.prototype.nodeType="Vector4",rh.addShortcuts(mh.prototype,"value",["x","y","z","w"]),mh.prototype.generateReadonly=function(t,e,n,r,i,o){return t.format("vec4( "+this.x+", "+this.y+", "+this.z+", "+this.w+" )",r,e)},mh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).x=this.x,e.y=this.y,e.z=this.z,e.w=this.w,!0===this.readonly&&(e.readonly=!0)),e};var vh=function(){Cu.call(this),this.color=new ih(15658734),this.specular=new ih(1118481),this.shininess=new Fu(30)};(vh.prototype=Object.create(Cu.prototype)).constructor=vh,vh.prototype.nodeType="Phong",vh.prototype.build=function(t){var e,n=t.material;if(n.define("PHONG"),n.define("ALPHATEST","0.0"),n.requires.lights=!0,t.isShader("vertex")){var r=this.transform?this.transform.parseAndBuildCode(t,"v3",{cache:"transform"}):void 0;n.mergeUniform(tl.merge([Ol.fog,Ol.lights])),n.addVertexPars(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <common>","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <shadowmap_pars_vertex>","#include <logdepthbuf_pars_vertex>"].join("\n"));var i=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif","#include <begin_vertex>"];r&&i.push(r.code,"transformed = "+r.result+";"),i.push("\t#include <morphtarget_vertex>","\t#include <skinning_vertex>","\t#include <project_vertex>","\t#include <fog_vertex>","\t#include <logdepthbuf_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\t#include <shadowmap_vertex>"),e=i.join("\n")}else{this.color.parse(t,{slot:"color"}),this.specular.parse(t),this.shininess.parse(t),this.alpha&&this.alpha.parse(t),this.normal&&this.normal.parse(t),this.normalScale&&this.normal&&this.normalScale.parse(t),this.light&&this.light.parse(t,{cache:"light"}),this.ao&&this.ao.parse(t),this.ambient&&this.ambient.parse(t),this.shadow&&this.shadow.parse(t),this.emissive&&this.emissive.parse(t,{slot:"emissive"}),this.environment&&this.environment.parse(t,{slot:"environment"}),this.environmentAlpha&&this.environment&&this.environmentAlpha.parse(t);var o=this.color.buildCode(t,"c",{slot:"color"}),a=this.specular.buildCode(t,"c"),s=this.shininess.buildCode(t,"fv1"),l=this.alpha?this.alpha.buildCode(t,"fv1"):void 0,u=this.normal?this.normal.buildCode(t,"v3"):void 0,c=this.normalScale&&this.normal?this.normalScale.buildCode(t,"v2"):void 0,h=this.light?this.light.buildCode(t,"v3",{cache:"light"}):void 0,p=this.ao?this.ao.buildCode(t,"fv1"):void 0,d=this.ambient?this.ambient.buildCode(t,"c"):void 0,f=this.shadow?this.shadow.buildCode(t,"c"):void 0,m=this.emissive?this.emissive.buildCode(t,"c",{slot:"emissive"}):void 0,v=this.environment?this.environment.buildCode(t,"c",{slot:"environment"}):void 0,g=this.environmentAlpha&&this.environment?this.environmentAlpha.buildCode(t,"fv1"):void 0;n.requires.transparent=void 0!=l,n.addFragmentPars(["#include <common>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <logdepthbuf_pars_fragment>"].join("\n"));i=["#include <normal_fragment_begin>","\tBlinnPhongMaterial material;",o.code,"\tvec3 diffuseColor = "+o.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","#include <logdepthbuf_fragment>",a.code,"\tvec3 specular = "+a.result+";",s.code,"\tfloat shininess = max(0.0001,"+s.result+");","\tfloat specularStrength = 1.0;"];l&&i.push(l.code,"if ( "+l.result+" <= ALPHATEST ) discard;"),u&&(t.include("perturbNormal2Arb"),i.push(u.code),c&&i.push(c.code),i.push("normal = perturbNormal2Arb(-vViewPosition,normal,"+u.result+","+(new Nu).build(t,"v2")+","+(c?c.result:"vec2( 1.0 )")+");")),i.push("material.diffuseColor = "+(h?"vec3( 1.0 )":"diffuseColor")+";"),i.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),h&&(i.push(h.code,"reflectedLight.directDiffuse = "+h.result+";"),i.push("reflectedLight.directDiffuse *= diffuseColor;","reflectedLight.indirectDiffuse *= diffuseColor;")),p&&i.push(p.code,"reflectedLight.indirectDiffuse *= "+p.result+";"),d&&i.push(d.code,"reflectedLight.indirectDiffuse += "+d.result+";"),f&&i.push(f.code,"reflectedLight.directDiffuse *= "+f.result+";","reflectedLight.directSpecular *= "+f.result+";"),m&&i.push(m.code,"reflectedLight.directDiffuse += "+m.result+";"),i.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular;"),v&&(i.push(v.code),g?i.push(g.code,"outgoingLight = mix( outgoingLight, "+v.result+", "+g.result+" );"):i.push("outgoingLight = "+v.result+";")),i.push(l?"gl_FragColor = vec4( outgoingLight, "+l.result+" );":"gl_FragColor = vec4( outgoingLight, 1.0 );"),i.push("#include <premultiplied_alpha_fragment>","#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>"),e=i.join("\n")}return e},vh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||(e=this.createJSONNode(t),this.transform&&(e.transform=this.transform.toJSON(t).uuid),e.color=this.color.toJSON(t).uuid,e.specular=this.specular.toJSON(t).uuid,e.shininess=this.shininess.toJSON(t).uuid,this.alpha&&(e.alpha=this.alpha.toJSON(t).uuid),this.normal&&(e.normal=this.normal.toJSON(t).uuid),this.normalScale&&(e.normalScale=this.normalScale.toJSON(t).uuid),this.light&&(e.light=this.light.toJSON(t).uuid),this.ao&&(e.ao=this.ao.toJSON(t).uuid),this.ambient&&(e.ambient=this.ambient.toJSON(t).uuid),this.shadow&&(e.shadow=this.shadow.toJSON(t).uuid),this.emissive&&(e.emissive=this.emissive.toJSON(t).uuid),this.environment&&(e.environment=this.environment.toJSON(t).uuid),this.environmentAlpha&&(e.environmentAlpha=this.environmentAlpha.toJSON(t).uuid)),e};var gh=function(){this.node=new vh,rh.call(this,this.node,this.node),this.type="PhongNodeMaterial"};(gh.prototype=Object.create(rh.prototype)).constructor=gh,rh.addShortcuts(gh.prototype,"node",["color","alpha","specular","shininess","normal","normalScale","emissive","ambient","light","shadow","ao","environment","environmentAlpha","transform"]);var yh=function(){Cu.call(this),this.color=new ih(15658734),this.spherical=!0};(yh.prototype=Object.create(Cu.prototype)).constructor=yh,yh.prototype.nodeType="Sprite",yh.prototype.build=function(t){var e,n=t.material;if(n.define("SPRITE"),n.requires.lights=!1,n.requires.transparent=void 0!=this.alpha,t.isShader("vertex")){var r=this.transform?this.transform.parseAndBuildCode(t,"v3",{cache:"transform"}):void 0;n.mergeUniform(tl.merge([Ol.fog])),n.addVertexPars(["#include <fog_pars_vertex>"].join("\n")),e=["#include <begin_vertex>"],r&&e.push(r.code,"transformed = "+r.result+";"),e.push("#include <project_vertex>","#include <fog_vertex>","mat4 modelViewMtx = modelViewMatrix;","mat4 modelMtx = modelMatrix;","modelMtx[3][0] = 0.0;","modelMtx[3][1] = 0.0;","modelMtx[3][2] = 0.0;"),this.spherical||e.push("modelMtx[1][1] = 1.0;"),e.push("modelViewMtx[0][0] = 1.0;","modelViewMtx[0][1] = 0.0;","modelViewMtx[0][2] = 0.0;"),this.spherical&&e.push("modelViewMtx[1][0] = 0.0;","modelViewMtx[1][1] = 1.0;","modelViewMtx[1][2] = 0.0;"),e.push("modelViewMtx[2][0] = 0.0;","modelViewMtx[2][1] = 0.0;","modelViewMtx[2][2] = 1.0;","gl_Position = projectionMatrix * modelViewMtx * modelMtx * vec4( transformed, 1.0 );")}else{n.addFragmentPars(["#include <fog_pars_fragment>"].join("\n")),this.color.parse(t,{slot:"color"}),this.alpha&&this.alpha.parse(t);var i=this.color.buildCode(t,"c",{slot:"color"}),o=this.alpha?this.alpha.buildCode(t,"fv1"):void 0;e=[i.code],o?e.push(o.code,"gl_FragColor = vec4( "+i.result+", "+o.result+" );"):e.push("gl_FragColor = vec4( "+i.result+", 1.0 );"),e.push("#include <fog_fragment>")}return e.join("\n")},yh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||(e=this.createJSONNode(t),this.transform&&(e.transform=this.transform.toJSON(t).uuid),e.color=this.color.toJSON(t).uuid,!1===this.spherical&&(e.spherical=!1),this.alpha&&(e.alpha=this.alpha.toJSON(t).uuid)),e};var bh=function(){this.node=new yh,rh.call(this,this.node,this.node),this.type="SpriteNodeMaterial"};(bh.prototype=Object.create(rh.prototype)).constructor=bh,rh.addShortcuts(bh.prototype,"node",["color","alpha","transform","spherical"]);var _h=function(){Eu.call(this,"fv1")};_h.getSpecularMIPLevel=new Pu(["float getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {","\tfloat maxMIPLevelScalar = float( maxMIPLevel );","\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );","\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );","}"].join("\n")),(_h.prototype=Object.create(Eu.prototype)).constructor=_h,_h.prototype.nodeType="RoughnessToBlinnExponent",_h.prototype.generate=function(t,e){var n=t.material;return t.isShader("fragment")?n.isDefined("PHYSICAL")?(t.include(_h.getSpecularMIPLevel),t.isCache("clearCoat")?t.format("getSpecularMIPLevel( Material_ClearCoat_BlinnShininessExponent( material ), 8 )",this.type,e):t.format("getSpecularMIPLevel( Material_BlinnShininessExponent( material ), 8 )",this.type,e)):(console.warn("RoughnessToBlinnExponentNode is only compatible with PhysicalMaterial."),t.format("0.0",this.type,e)):(console.warn("RoughnessToBlinnExponentNode is not compatible with "+t.shader+" shader."),t.format("0.0",this.type,e))};var xh=function(){Cu.call(this),this.color=new ih(15658734),this.roughness=new Fu(.5),this.metalness=new Fu(.5)};(xh.prototype=Object.create(Cu.prototype)).constructor=xh,xh.prototype.nodeType="Standard",xh.prototype.build=function(t){var e,n=t.material;if(n.define("PHYSICAL"),this.clearCoat||this.clearCoatRoughness||n.define("STANDARD"),n.define("ALPHATEST","0.0"),n.requires.lights=!0,n.extensions.shaderTextureLOD=!0,t.isShader("vertex")){var r=this.transform?this.transform.parseAndBuildCode(t,"v3",{cache:"transform"}):void 0;n.mergeUniform(tl.merge([Ol.fog,Ol.lights])),n.addVertexPars(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <common>","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <shadowmap_pars_vertex>","#include <logdepthbuf_pars_vertex>"].join("\n"));var i=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#include <logdepthbuf_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <logdepthbuf_pars_vertex>","#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif","#include <begin_vertex>"];r&&i.push(r.code,"transformed = "+r.result+";"),i.push("#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","#include <fog_vertex>","#include <logdepthbuf_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),e=i.join("\n")}else{var o={bias:new _h,offsetU:0,offsetV:0},a=!n.isDefined("STANDARD");this.color.parse(t,{slot:"color"}),this.roughness.parse(t),this.metalness.parse(t),this.alpha&&this.alpha.parse(t),this.normal&&this.normal.parse(t),this.normalScale&&this.normal&&this.normalScale.parse(t),this.clearCoat&&this.clearCoat.parse(t),this.clearCoatRoughness&&this.clearCoatRoughness.parse(t),this.reflectivity&&this.reflectivity.parse(t),this.light&&this.light.parse(t,{cache:"light"}),this.ao&&this.ao.parse(t),this.ambient&&this.ambient.parse(t),this.shadow&&this.shadow.parse(t),this.emissive&&this.emissive.parse(t,{slot:"emissive"}),this.environment&&this.environment.parse(t,{cache:"env",requires:o,slot:"environment"});var s=this.color.buildCode(t,"c",{slot:"color"}),l=this.roughness.buildCode(t,"fv1"),u=this.metalness.buildCode(t,"fv1"),c=this.alpha?this.alpha.buildCode(t,"fv1"):void 0,h=this.normal?this.normal.buildCode(t,"v3"):void 0,p=this.normalScale&&this.normal?this.normalScale.buildCode(t,"v2"):void 0,d=this.clearCoat?this.clearCoat.buildCode(t,"fv1"):void 0,f=this.clearCoatRoughness?this.clearCoatRoughness.buildCode(t,"fv1"):void 0,m=this.reflectivity?this.reflectivity.buildCode(t,"fv1"):void 0,v=this.light?this.light.buildCode(t,"v3",{cache:"light"}):void 0,g=this.ao?this.ao.buildCode(t,"fv1"):void 0,y=this.ambient?this.ambient.buildCode(t,"c"):void 0,b=this.shadow?this.shadow.buildCode(t,"c"):void 0,_=this.emissive?this.emissive.buildCode(t,"c",{slot:"emissive"}):void 0,x=this.environment?this.environment.buildCode(t,"c",{cache:"env",requires:o,slot:"environment"}):void 0,w=a&&x?this.environment.buildCode(t,"c",{cache:"clearCoat",requires:o,slot:"environment"}):void 0;n.requires.transparent=void 0!=c,n.addFragmentPars(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <common>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>","#include <logdepthbuf_pars_fragment>","#include <logdepthbuf_vertex>"].join("\n"));i=["\t#include <normal_fragment_begin>","\tPhysicalMaterial material;","\tmaterial.diffuseColor = vec3( 1.0 );",s.code,"\tvec3 diffuseColor = "+s.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","#include <logdepthbuf_fragment>",l.code,"\tfloat roughnessFactor = "+l.result+";",u.code,"\tfloat metalnessFactor = "+u.result+";"];c&&i.push(c.code,"if ( "+c.result+" <= ALPHATEST ) discard;"),h&&(t.include("perturbNormal2Arb"),i.push(h.code),p&&i.push(p.code),i.push("normal = perturbNormal2Arb(-vViewPosition,normal,"+h.result+","+(new Nu).build(t,"v2")+","+(p?p.result:"vec2( 1.0 )")+");")),i.push("material.diffuseColor = "+(v?"vec3( 1.0 )":"diffuseColor * (1.0 - metalnessFactor)")+";"),i.push("material.specularRoughness = clamp( roughnessFactor, DEFAULT_SPECULAR_COEFFICIENT, 1.0 );"),d?i.push(d.code,"material.clearCoat = saturate( "+d.result+" );"):a&&i.push("material.clearCoat = 0.0;"),f?i.push(f.code,"material.clearCoatRoughness = clamp( "+f.result+", DEFAULT_SPECULAR_COEFFICIENT, 1.0 );"):a&&i.push("material.clearCoatRoughness = 0.0;"),m?i.push(m.code,"material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( "+m.result+" ) ), diffuseColor, metalnessFactor );"):i.push("material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor, metalnessFactor );"),i.push("#include <lights_fragment_begin>","#include <lights_fragment_end>"),v&&(i.push(v.code,"reflectedLight.directDiffuse = "+v.result+";"),i.push("diffuseColor *= 1.0 - metalnessFactor;","reflectedLight.directDiffuse *= diffuseColor;","reflectedLight.indirectDiffuse *= diffuseColor;")),g&&i.push(g.code,"reflectedLight.indirectDiffuse *= "+g.result+";","float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );","reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, "+g.result+", material.specularRoughness );"),y&&i.push(y.code,"reflectedLight.indirectDiffuse += "+y.result+";"),b&&i.push(b.code,"reflectedLight.directDiffuse *= "+b.result+";","reflectedLight.directSpecular *= "+b.result+";"),_&&i.push(_.code,"reflectedLight.directDiffuse += "+_.result+";"),x&&(i.push(x.code),w&&i.push(w.code,"clearCoatRadiance += "+w.result+";"),i.push("RE_IndirectSpecular("+x.result+", clearCoatRadiance, geometry, material, reflectedLight );")),i.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular;"),i.push(c?"gl_FragColor = vec4( outgoingLight, "+c.result+" );":"gl_FragColor = vec4( outgoingLight, 1.0 );"),i.push("#include <premultiplied_alpha_fragment>","#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>"),e=i.join("\n")}return e},xh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||(e=this.createJSONNode(t),this.transform&&(e.transform=this.transform.toJSON(t).uuid),e.color=this.color.toJSON(t).uuid,e.roughness=this.roughness.toJSON(t).uuid,e.metalness=this.metalness.toJSON(t).uuid,this.alpha&&(e.alpha=this.alpha.toJSON(t).uuid),this.normal&&(e.normal=this.normal.toJSON(t).uuid),this.normalScale&&(e.normalScale=this.normalScale.toJSON(t).uuid),this.clearCoat&&(e.clearCoat=this.clearCoat.toJSON(t).uuid),this.clearCoatRoughness&&(e.clearCoatRoughness=this.clearCoatRoughness.toJSON(t).uuid),this.reflectivity&&(e.reflectivity=this.reflectivity.toJSON(t).uuid),this.light&&(e.light=this.light.toJSON(t).uuid),this.ao&&(e.ao=this.ao.toJSON(t).uuid),this.ambient&&(e.ambient=this.ambient.toJSON(t).uuid),this.shadow&&(e.shadow=this.shadow.toJSON(t).uuid),this.emissive&&(e.emissive=this.emissive.toJSON(t).uuid),this.environment&&(e.environment=this.environment.toJSON(t).uuid)),e};var wh=function(){this.node=new xh,rh.call(this,this.node,this.node),this.type="StandardNodeMaterial"};(wh.prototype=Object.create(rh.prototype)).constructor=wh,rh.addShortcuts(wh.prototype,"node",["color","alpha","roughness","metalness","reflectivity","clearCoat","clearCoatRoughness","normal","normalScale","emissive","ambient","light","shadow","ao","environment","transform"]);var Sh=function(t,e){Eu.call(this),this.a=t,this.method=e||Sh.SIN};Sh.RAD="radians",Sh.DEG="degrees",Sh.EXP="exp",Sh.EXP2="exp2",Sh.LOG="log",Sh.LOG2="log2",Sh.SQRT="sqrt",Sh.INV_SQRT="inversesqrt",Sh.FLOOR="floor",Sh.CEIL="ceil",Sh.NORMALIZE="normalize",Sh.FRACT="fract",Sh.SAT="saturate",Sh.SIN="sin",Sh.COS="cos",Sh.TAN="tan",Sh.ASIN="asin",Sh.ACOS="acos",Sh.ARCTAN="atan",Sh.ABS="abs",Sh.SIGN="sign",Sh.LENGTH="length",Sh.NEGATE="negate",Sh.INVERT="invert",Sh.prototype=Object.create(Eu.prototype),Sh.prototype.constructor=Sh,Sh.prototype.nodeType="Math1",Sh.prototype.getType=function(t){switch(this.method){case Sh.LENGTH:return"fv1"}return this.a.getType(t)},Sh.prototype.generate=function(t,e){var n=this.getType(t),r=this.a.build(t,n);switch(this.method){case Sh.NEGATE:r="(-"+r+")";break;case Sh.INVERT:r="(1.0-"+r+")";break;default:r=this.method+"("+r+")"}return t.format(r,n,e)},Sh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).a=this.a.toJSON(t).uuid,e.method=this.method),e};var Ah=function(t,e,n){Eu.call(this),this.a=t,this.b=e,this.method=n||Ah.DISTANCE};Ah.MIN="min",Ah.MAX="max",Ah.MOD="mod",Ah.STEP="step",Ah.REFLECT="reflect",Ah.DISTANCE="distance",Ah.DOT="dot",Ah.CROSS="cross",Ah.POW="pow",Ah.prototype=Object.create(Eu.prototype),Ah.prototype.constructor=Ah,Ah.prototype.nodeType="Math2",Ah.prototype.getInputType=function(t){return t.getFormatLength(this.b.getType(t))>t.getFormatLength(this.a.getType(t))?this.b.getType(t):this.a.getType(t)},Ah.prototype.getType=function(t){switch(this.method){case Ah.DISTANCE:case Ah.DOT:return"fv1";case Ah.CROSS:return"v3"}return this.getInputType(t)},Ah.prototype.generate=function(t,e){var n,r,i=this.getInputType(t),o=t.getFormatLength(this.a.getType(t)),a=t.getFormatLength(this.b.getType(t));switch(this.method){case Ah.CROSS:n=this.a.build(t,"v3"),r=this.b.build(t,"v3");break;case Ah.STEP:n=this.a.build(t,1==o?"fv1":i),r=this.b.build(t,i);break;case Ah.MIN:case Ah.MAX:case Ah.MOD:n=this.a.build(t,i),r=this.b.build(t,1==a?"fv1":i);break;default:n=this.a.build(t,i),r=this.b.build(t,i)}return t.format(this.method+"("+n+","+r+")",this.getType(t),e)},Ah.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).a=this.a.toJSON(t).uuid,e.b=this.b.toJSON(t).uuid,e.method=this.method),e};var Mh=function(t,e,n,r){Eu.call(this),this.a=t,this.b=e,this.c=n,this.method=r||Mh.MIX};Mh.MIX="mix",Mh.REFRACT="refract",Mh.SMOOTHSTEP="smoothstep",Mh.FACEFORWARD="faceforward",Mh.prototype=Object.create(Eu.prototype),Mh.prototype.constructor=Mh,Mh.prototype.nodeType="Math3",Mh.prototype.getType=function(t){var e=t.getFormatLength(this.a.getType(t)),n=t.getFormatLength(this.b.getType(t)),r=t.getFormatLength(this.c.getType(t));return e>n&&e>r?this.a.getType(t):n>r?this.b.getType(t):this.c.getType(t)},Mh.prototype.generate=function(t,e){var n,r,i,o=this.getType(t),a=(t.getFormatLength(this.a.getType(t)),t.getFormatLength(this.b.getType(t)),t.getFormatLength(this.c.getType(t)));switch(this.method){case Mh.REFRACT:n=this.a.build(t,o),r=this.b.build(t,o),i=this.c.build(t,"fv1");break;case Mh.MIX:n=this.a.build(t,o),r=this.b.build(t,o),i=this.c.build(t,1==a?"fv1":o);break;default:n=this.a.build(t,o),r=this.b.build(t,o),i=this.c.build(t,o)}return t.format(this.method+"("+n+","+r+","+i+")",o,e)},Mh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).a=this.a.toJSON(t).uuid,e.b=this.b.toJSON(t).uuid,e.c=this.c.toJSON(t).uuid,e.method=this.method),e};var Th=function(t){this.time=void 0!==t?t:0,this.frameId=0};Th.prototype.update=function(t){return++this.frameId,this.time+=t,this.delta=t,this},Th.prototype.updateNode=function(t){return t.frameId===this.frameId?this:(t.updateFrame(this),t.frameId=this.frameId,this)};var Ch=function(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1};Object.assign(Ch.prototype,{setSize:function(t,e){},render:function(t,e,n,r,i){console.error("Pass: .render() must be implemented in derived pass.")}});var Eh=function(t,e){Ch.call(this),this.textureID=void 0!==e?e:"tDiffuse",t instanceof dt?(this.uniforms=t.uniforms,this.material=t):t&&(this.uniforms=tl.clone(t.uniforms),this.material=new dt({defines:Object.assign({},t.defines),uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})),this.camera=new ct(-1,1,1,-1,0,1),this.scene=new ut,this.quad=new B(new mt(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};Eh.prototype=Object.assign(Object.create(Ch.prototype),{constructor:Eh,render:function(t,e,n,r,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.quad.material=this.material,this.renderToScreen?t.render(this.scene,this.camera):t.render(this.scene,this.camera,e,this.clear)}});var Ph=function(){Eh.call(this),this.name="",this.uuid=xo.generateUUID(),this.userData={},this.textureID="renderTexture",this.fragment=new eh(new ph),this.node=new rh,this.node.fragment=this.fragment,this.build()};(Ph.prototype=Object.create(Eh.prototype)).constructor=Ph,rh.addShortcuts(Ph.prototype,"fragment",["value"]),Ph.prototype.build=function(){this.node.build(),this.uniforms=this.node.uniforms,this.material=this.node},Ph.prototype.toJSON=function(t){if((void 0===t||"string"==typeof t)&&(t={nodes:{}}),t&&!t.passes&&(t.passes={}),!t.passes[this.uuid]){var e={};e.uuid=this.uuid,e.type="NodePass",t.passes[this.uuid]=e,""!==this.name&&(e.name=this.name),"{}"!==JSON.stringify(this.userData)&&(e.userData=this.userData),e.value=this.value.toJSON(t).uuid}return t.pass=this.uuid,t};var Oh=function(t,e,n,r){Eu.call(this,"v4"),this.value=t,this.coord=e||new Nu,this.radius=new dh(1,1),this.size=r,this.blurX=!0,this.blurY=!0,this.horizontal=new Fu(1/64),this.vertical=new Fu(1/64)};Oh.fBlurX=new Pu(["vec4 blurX( sampler2D texture, vec2 uv, float s ) {","\tvec4 sum = vec4( 0.0 );","\tsum += texture2D( texture, vec2( uv.x - 4.0 * s, uv.y ) ) * 0.051;","\tsum += texture2D( texture, vec2( uv.x - 3.0 * s, uv.y ) ) * 0.0918;","\tsum += texture2D( texture, vec2( uv.x - 2.0 * s, uv.y ) ) * 0.12245;","\tsum += texture2D( texture, vec2( uv.x - 1.0 * s, uv.y ) ) * 0.1531;","\tsum += texture2D( texture, vec2( uv.x, uv.y ) ) * 0.1633;","\tsum += texture2D( texture, vec2( uv.x + 1.0 * s, uv.y ) ) * 0.1531;","\tsum += texture2D( texture, vec2( uv.x + 2.0 * s, uv.y ) ) * 0.12245;","\tsum += texture2D( texture, vec2( uv.x + 3.0 * s, uv.y ) ) * 0.0918;","\tsum += texture2D( texture, vec2( uv.x + 4.0 * s, uv.y ) ) * 0.051;","\treturn sum;","}"].join("\n")),Oh.fBlurY=new Pu(["vec4 blurY( sampler2D texture, vec2 uv, float s ) {","\tvec4 sum = vec4( 0.0 );","\tsum += texture2D( texture, vec2( uv.x, uv.y - 4.0 * s ) ) * 0.051;","\tsum += texture2D( texture, vec2( uv.x, uv.y - 3.0 * s ) ) * 0.0918;","\tsum += texture2D( texture, vec2( uv.x, uv.y - 2.0 * s ) ) * 0.12245;","\tsum += texture2D( texture, vec2( uv.x, uv.y - 1.0 * s ) ) * 0.1531;","\tsum += texture2D( texture, vec2( uv.x, uv.y ) ) * 0.1633;","\tsum += texture2D( texture, vec2( uv.x, uv.y + 1.0 * s ) ) * 0.1531;","\tsum += texture2D( texture, vec2( uv.x, uv.y + 2.0 * s ) ) * 0.12245;","\tsum += texture2D( texture, vec2( uv.x, uv.y + 3.0 * s ) ) * 0.0918;","\tsum += texture2D( texture, vec2( uv.x, uv.y + 4.0 * s ) ) * 0.051;","\treturn sum;","}"].join("\n")),(Oh.prototype=Object.create(Eu.prototype)).constructor=Oh,Oh.prototype.nodeType="Blur",Oh.prototype.updateFrame=function(t){if(this.size)this.horizontal.number=this.radius.x/this.size.x,this.vertical.number=this.radius.y/this.size.y;else if(this.value.value&&this.value.value.image){var e=this.value.value.image;this.horizontal.number=this.radius.x/e.width,this.vertical.number=this.radius.y/e.height}},Oh.prototype.generate=function(t,e){var n=Oh.fBlurX,r=Oh.fBlurY;if(t.include(n),t.include(r),t.isShader("fragment")){var i,o=[];return this.blurX&&o.push(n.name+"("+this.value.build(t,"sampler2D")+","+this.coord.build(t,"v2")+","+this.horizontal.build(t,"fv1")+")"),this.blurY&&o.push(r.name+"("+this.value.build(t,"sampler2D")+","+this.coord.build(t,"v2")+","+this.vertical.build(t,"fv1")+")"),i=2==o.length?"("+o.join("+")+"/2.0)":o.length?"("+o[0]+")":"vec4( 0.0 )",t.format(i,this.getType(t),e)}return console.warn("BlurNode is not compatible with "+t.shader+" shader."),t.format("vec4( 0.0 )",this.getType(t),e)},Oh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).value=this.value.toJSON(t).uuid,e.coord=this.coord.toJSON(t).uuid,e.radius=this.radius.toJSON(t).uuid,this.size&&(e.size={x:this.size.x,y:this.size.y}),e.blurX=this.blurX,e.blurY=this.blurY),e};var Nh=function(t,e,n){Eu.call(this,"v3"),this.value=t,this.coord=e||new Nu,this.scale=n||new dh(1,1)};Nh.fBumpToNormal=new Pu(["vec3 bumpToNormal( sampler2D bumpMap, vec2 uv, vec2 scale ) {","\tvec2 dSTdx = dFdx( uv );","\tvec2 dSTdy = dFdy( uv );","\tfloat Hll = texture2D( bumpMap, uv ).x;","\tfloat dBx = texture2D( bumpMap, uv + dSTdx ).x - Hll;","\tfloat dBy = texture2D( bumpMap, uv + dSTdy ).x - Hll;","\treturn vec3( .5 + ( dBx * scale.x ), .5 + ( dBy * scale.y ), 1.0 );","}"].join("\n"),null,{derivatives:!0}),(Nh.prototype=Object.create(Eu.prototype)).constructor=Nh,Nh.prototype.nodeType="Bump",Nh.prototype.generate=function(t,e){var n=Nh.fBumpToNormal;return t.include(n),t.isShader("fragment")?t.format(n.name+"("+this.value.build(t,"sampler2D")+","+this.coord.build(t,"v2")+","+this.scale.build(t,"v2")+")",this.getType(t),e):(console.warn("BumpNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e))},Nh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).value=this.value.toJSON(t).uuid,e.coord=this.coord.toJSON(t).uuid,e.scale=this.scale.toJSON(t).uuid),e};var Lh=function(t,e,n){Eu.call(this,"v3"),this.rgb=t,this.adjustment=e,this.method=n||Lh.SATURATION};Lh.SATURATION="saturation",Lh.HUE="hue",Lh.VIBRANCE="vibrance",Lh.BRIGHTNESS="brightness",Lh.CONTRAST="contrast",Lh.prototype=Object.create(Eu.prototype),Lh.prototype.constructor=Lh,Lh.prototype.nodeType="ColorAdjustment",Lh.prototype.generate=function(t,e){var n,r=this.rgb.build(t,"v3"),i=this.adjustment.build(t,"fv1");switch(this.method){case Lh.SATURATION:n="saturation_rgb";break;case Lh.HUE:n="hue_rgb";break;case Lh.VIBRANCE:n="vibrance_rgb";break;case Lh.BRIGHTNESS:return t.format("("+r+"+"+i+")",this.getType(t),e);case Lh.CONTRAST:return t.format("("+r+"*"+i+")",this.getType(t),e)}return t.include(n),t.format(n+"("+r+","+i+")",this.getType(t),e)},Lh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).rgb=this.rgb.toJSON(t).uuid,e.adjustment=this.adjustment.toJSON(t).uuid,e.method=this.method),e};var Ih=function(t,e,n,r){Eu.call(this,"fv1"),this.x=t,this.y=e,this.z=n,this.w=r};Ih.inputs=["x","y","z","w"],(Ih.prototype=Object.create(Eu.prototype)).constructor=Ih,Ih.prototype.nodeType="Join",Ih.prototype.getNumElements=function(){for(var t=Ih.inputs,e=t.length;e--;)if(void 0!==this[t[e]]){++e;break}return Math.max(e,2)},Ih.prototype.getType=function(t){return t.getFormatFromLength(this.getNumElements())},Ih.prototype.generate=function(t,e){for(var n=this.getType(t),r=this.getNumElements(),i=Ih.inputs,o=[],a=0;a<r;a++){var s=this[i[a]];o.push(s?s.build(t,"fv1"):"0.")}var l=(r>1?t.getConstructorFromLength(r):"")+"("+o.join(",")+")";return t.format(l,n,e)},Ih.prototype.toJSON=function(t){var e=this.getJSONNode(t);if(!e){(e=this.createJSONNode(t)).inputs={};for(var n=this.getNumElements(),r=Ih.inputs,i=0;i<n;i++){var o=this[r[i]];o&&(e.inputs[r[i]]=o.toJSON(t).uuid)}}return e};var Dh=function(t){Eu.call(this,"fv1"),this.rgb=t};(Dh.prototype=Object.create(Eu.prototype)).constructor=Dh,Dh.prototype.nodeType="Luminance",Dh.prototype.generate=function(t,e){return t.include("luminance_rgb"),t.format("luminance_rgb("+this.rgb.build(t,"v3")+")",this.getType(t),e)},Dh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).rgb=this.rgb.toJSON(t).uuid),e};var Fh=function(t){Eu.call(this,"fv1"),this.coord=t};(Fh.prototype=Object.create(Eu.prototype)).constructor=Fh,Fh.prototype.nodeType="Noise",Fh.prototype.generate=function(t,e){return t.include("snoise"),t.format("snoise("+this.coord.build(t,"v2")+")",this.getType(t),e)},Fh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).coord=this.coord.toJSON(t).uuid),e};var Rh=function(t,e,n,r,i){Eu.call(this,"v3"),this.value=t,this.scale=n||new Fu(1),this.normal=r||new Iu(Iu.LOCAL),this.position=i||new Lu(Iu.VIEW)};(Rh.prototype=Object.create(Eu.prototype)).constructor=Rh,Rh.prototype.nodeType="NormalMap",Rh.prototype.generate=function(t,e){return t.include("perturbNormal2Arb"),t.isShader("fragment")?t.format("perturbNormal2Arb(-"+this.position.build(t,"v3")+","+this.normal.build(t,"v3")+","+this.value.build(t,"v3")+","+this.value.coord.build(t,"v2")+","+this.scale.build(t,"v2")+")",this.getType(t),e):(console.warn("NormalMapNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e))},Rh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).value=this.value.uuid,e.scale=this.scale.toJSON(t).uuid,e.normal=this.normal.toJSON(t).uuid,e.position=this.position.toJSON(t).uuid),e};var kh=function(t){dh.call(this),this.renderer=t};(kh.prototype=Object.create(dh.prototype)).constructor=kh,kh.prototype.nodeType="Resolution",kh.prototype.updateFrame=function(t){var e=this.renderer.getSize(),n=this.renderer.getPixelRatio();this.x=e.width*n,this.y=e.height*n},kh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).renderer=this.renderer.uuid),e};var Uh=function(t,e){Cu.call(this),this.node=t,this.components=e||"x"};(Uh.prototype=Object.create(Cu.prototype)).constructor=Uh,Uh.prototype.nodeType="Switch",Uh.prototype.getType=function(t){return t.getFormatFromLength(this.components.length)},Uh.prototype.generate=function(t,e){var n=this.node.getType(t),r=t.getFormatLength(n)-1,i=this.node.build(t,n);if(r>0){var o,a=0,s=t.colorToVector(this.components),l=s.length;for(o=0;o<l;o++)a=Math.max(a,t.getIndexByElement(s.charAt(o)));for(a>r&&(a=r),i+=".",o=0;o<l;o++){s.charAt(o);var u=t.getIndexByElement(s.charAt(o));u>a&&(u=a),i+=t.getElementByIndex(u)}return t.format(i,this.getType(t),e)}return t.format(i,n,e)},Uh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).node=this.node.toJSON(t).uuid,e.components=this.components),e};var jh=function(){Pu.call(this,"( uvTransform * vec3( uvNode, 1 ) ).xy","vec2"),this.uv=new Nu,this.transform=new sh};(jh.prototype=Object.create(Pu.prototype)).constructor=jh,jh.prototype.nodeType="UVTransform",jh.prototype.generate=function(t,e){return this.keywords.uvNode=this.uv,this.keywords.uvTransform=this.transform,Pu.prototype.generate.call(this,t,e)},jh.prototype.setUvTransform=function(t,e,n,r,i,o,a){this.transform.value.setUvTransform(t,e,n,r,i,o=void 0!==o?o:.5,a=void 0!==a?a:.5)},jh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).uv=this.uv.toJSON(t).uuid,e.transform=this.transform.toJSON(t).uuid),e};var Bh=function(t,e){fh.call(this),this.params={},this.velocity=new i,this.setTarget(t),this.setParams(e)};(Bh.prototype=Object.create(fh.prototype)).constructor=Bh,Bh.prototype.nodeType="Velocity",Bh.prototype.isReadonly=function(t){return!1},Bh.prototype.setParams=function(t){switch(this.params.type){case"elastic":delete this.moment,delete this.speed,delete this.springVelocity,delete this.lastVelocity}switch(this.params=t||{},this.params.type){case"elastic":this.moment=new i,this.speed=new i,this.springVelocity=new i,this.lastVelocity=new i}},Bh.prototype.setTarget=function(t){this.target&&(delete this.position,delete this.oldPosition),this.target=t,t&&(this.position=t.getWorldPosition(),this.oldPosition=this.position.clone())},Bh.prototype.updateFrameVelocity=function(t){this.target&&(this.position=this.target.getWorldPosition(),this.velocity.subVectors(this.position,this.oldPosition),this.oldPosition.copy(this.position))},Bh.prototype.updateFrame=function(t){switch(this.updateFrameVelocity(t),this.params.type){case"elastic":var e=t.delta*(this.params.fps||60),n=Math.pow(this.params.spring,e),r=Math.pow(this.params.damping,e);this.velocity.multiplyScalar(Math.exp(-this.params.damping*e)),this.velocity.add(this.springVelocity),this.velocity.add(this.speed.multiplyScalar(r).multiplyScalar(1-n)),this.speed.subVectors(this.velocity,this.lastVelocity),this.springVelocity.add(this.speed),this.springVelocity.multiplyScalar(n),this.moment.add(this.springVelocity),this.moment.multiplyScalar(r),this.lastVelocity.copy(this.velocity),this.value.copy(this.moment);break;default:this.value.copy(this.velocity)}},Bh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||(e=this.createJSONNode(t),this.target&&(e.target=this.target.uuid),e.params=JSON.parse(JSON.stringify(this.params))),e};var zh=function(t){Cu.call(this,t)};(zh.prototype=Object.create(Cu.prototype)).constructor=zh,zh.prototype.nodeType="Var",zh.prototype.getType=function(t){return t.getTypeByFormat(this.type)},zh.prototype.generate=function(t,e){var n=t.material.getVar(this.uuid,this.type);return t.format(n.name,this.getType(t),e)},zh.prototype.toJSON=function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).out=this.type),e},Object.assign(Mn.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new m;return function(e,n){var r=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("Box2: .getCenter() target is now required"),t=new m),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("Box2: .getSize() target is now required"),t=new m),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return void 0===e&&(console.warn("Box2: .getParameter() target is now required"),e=new m),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return void 0===e&&(console.warn("Box2: .clampPoint() target is now required"),e=new m),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new m;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var Vh=function(){B.call(this,Vh.Geometry,new D({opacity:0,transparent:!0})),this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;var t=new i,e=new ye(new Uint8Array(768),16,16,es);e.minFilter=Ra,e.magFilter=Ra,e.wrapS=Da,e.wrapT=Da,e.needsUpdate=!0;var n=new ye(new Uint8Array(768),16,16,es);n.minFilter=Ra,n.magFilter=Ra,n.wrapS=Da,n.wrapT=Da,n.needsUpdate=!0;var r=Vh.Geometry,o=new Ct({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","attribute vec3 position;","void main() {","\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","void main() {","\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );","}"].join("\n"),depthTest:!0,depthWrite:!1,transparent:!1}),a=new Ct({uniforms:{map:{value:e},scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","attribute vec3 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","\tvUV = uv;","\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","uniform sampler2D map;","varying vec2 vUV;","void main() {","\tgl_FragColor = texture2D( map, vUV );","}"].join("\n"),depthTest:!1,depthWrite:!1,transparent:!1}),s=new B(r,o),l=[],u=Gh.Shader,c=new Ct({uniforms:{map:{value:null},occlusionMap:{value:n},color:{value:new h(16777215)},scale:{value:new m},screenPosition:{value:new i}},vertexShader:u.vertexShader,fragmentShader:u.fragmentShader,blending:Go,transparent:!0,depthWrite:!1}),p=new B(r,c);this.addElement=function(t){l.push(t)};var d=new m,f=new m,v=new Mn,y=new g;this.onBeforeRender=function(i,u,h){y.copy(i.getCurrentViewport());var m=y.z/2,g=y.w/2;if(d.set((M=16/y.w)*(y.w/y.z),M),v.min.set(y.x,y.y),v.max.set(y.x+(y.z-16),y.y+(y.w-16)),t.setFromMatrixPosition(this.matrixWorld),t.applyMatrix4(h.matrixWorldInverse),t.applyMatrix4(h.projectionMatrix),f.x=y.x+t.x*m+m-8,f.y=y.y+t.y*g+g-8,v.containsPoint(f)){i.copyFramebufferToTexture(f,e);(S=o.uniforms).scale.value=d,S.screenPosition.value=t,i.renderBufferDirect(h,null,r,o,s,null),i.copyFramebufferToTexture(f,n);(S=a.uniforms).scale.value=d,S.screenPosition.value=t,i.renderBufferDirect(h,null,r,a,s,null);for(var b=2*-t.x,_=2*-t.y,x=0,w=l.length;x<w;x++){var S,A=l[x];(S=c.uniforms).color.value.copy(A.color),S.map.value=A.texture,S.screenPosition.value.x=t.x+b*A.distance,S.screenPosition.value.y=t.y+_*A.distance;var M;S.scale.value.set((M=A.size/y.w)*(y.w/y.z),M),c.uniformsNeedUpdate=!0,i.renderBufferDirect(h,null,r,c,p,null)}}},this.dispose=function(){o.dispose(),a.dispose(),c.dispose(),e.dispose(),n.dispose();for(var t=0,r=l.length;t<r;t++)l[t].texture.dispose()}};Vh.prototype=Object.create(B.prototype),Vh.prototype.constructor=Vh,Vh.prototype.isLensflare=!0;var Gh=function(t,e,n,r){this.texture=t,this.size=e||1,this.distance=n||0,this.color=r||new h(16777215)};Gh.Shader={uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform sampler2D occlusionMap;","attribute vec3 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvUV = uv;","\tvec2 pos = position.xy;","\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","\tvVisibility =        visibility.r / 9.0;","\tvVisibility *= 1.0 - visibility.g / 9.0;","\tvVisibility *=       visibility.b / 9.0;","\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","uniform sampler2D map;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvec4 texture = texture2D( map, vUV );","\ttexture.a *= vVisibility;","\tgl_FragColor = texture;","\tgl_FragColor.rgb *= color;","}"].join("\n")},Vh.Geometry=function(){var t=new O,e=new xe(new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),5);return t.setIndex([0,1,2,0,2,3]),t.addAttribute("position",new Se(e,3,0,!1)),t.addAttribute("uv",new Se(e,2,3,!1)),t}();var Hh=function(t,e){B.call(this,t),this.type="Reflector";var n=this,o=new h(void 0!==(e=e||{}).color?e.color:8355711),a=e.textureWidth||512,s=e.textureHeight||512,l=e.clipBias||0,u=e.shader||Hh.ReflectorShader,c=void 0!==e.recursion?e.recursion:0,p=new U,d=new i,f=new i,m=new i,v=new r,y=new i(0,0,-1),b=new g,_=new g,x=new i,w=new i,S=new g,A=new r,M=new st,T=new pt(a,s,{minFilter:ja,magFilter:ja,format:es,stencilBuffer:!1});xo.isPowerOfTwo(a)&&xo.isPowerOfTwo(s)||(T.texture.generateMipmaps=!1);var C=new dt({uniforms:tl.clone(u.uniforms),fragmentShader:u.fragmentShader,vertexShader:u.vertexShader});C.uniforms.tDiffuse.value=T.texture,C.uniforms.color.value=o,C.uniforms.textureMatrix.value=A,this.material=C,this.onBeforeRender=function(t,e,r){if("recursion"in r.userData){if(r.userData.recursion===c)return;r.userData.recursion++}if(f.setFromMatrixPosition(n.matrixWorld),m.setFromMatrixPosition(r.matrixWorld),v.extractRotation(n.matrixWorld),d.set(0,0,1),d.applyMatrix4(v),x.subVectors(f,m),!(x.dot(d)>0)){x.reflect(d).negate(),x.add(f),v.extractRotation(r.matrixWorld),y.set(0,0,-1),y.applyMatrix4(v),y.add(m),w.subVectors(f,y),w.reflect(d).negate(),w.add(f),M.position.copy(x),M.up.set(0,1,0),M.up.applyMatrix4(v),M.up.reflect(d),M.lookAt(w),M.far=r.far,M.updateMatrixWorld(),M.projectionMatrix.copy(r.projectionMatrix),M.userData.recursion=0,A.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),A.multiply(M.projectionMatrix),A.multiply(M.matrixWorldInverse),A.multiply(n.matrixWorld),p.setFromNormalAndCoplanarPoint(d,f),p.applyMatrix4(M.matrixWorldInverse),b.set(p.normal.x,p.normal.y,p.normal.z,p.constant);var i=M.projectionMatrix;S.x=(Math.sign(b.x)+i.elements[8])/i.elements[0],S.y=(Math.sign(b.y)+i.elements[9])/i.elements[5],S.z=-1,S.w=(1+i.elements[10])/i.elements[14],b.multiplyScalar(2/b.dot(S)),i.elements[2]=b.x,i.elements[6]=b.y,i.elements[10]=b.z+1-l,i.elements[14]=b.w,n.visible=!1;var o=t.getRenderTarget(),a=t.vr.enabled,s=t.shadowMap.autoUpdate;t.vr.enabled=!1,t.shadowMap.autoUpdate=!1,t.render(e,M,T,!0),t.vr.enabled=a,t.shadowMap.autoUpdate=s,t.setRenderTarget(o);var u=r.bounds;if(void 0!==u){var h=t.getSize(),g=t.getPixelRatio();_.x=u.x*h.width*g,_.y=u.y*h.height*g,_.z=u.z*h.width*g,_.w=u.w*h.height*g,t.state.viewport(_)}n.visible=!0}},this.getRenderTarget=function(){return T}};Hh.prototype=Object.create(B.prototype),Hh.prototype.constructor=Hh,Hh.ReflectorShader={uniforms:{color:{type:"c",value:null},tDiffuse:{type:"t",value:null},textureMatrix:{type:"m4",value:null}},vertexShader:["uniform mat4 textureMatrix;","varying vec4 vUv;","void main() {","\tvUv = textureMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","\tvec4 base = texture2DProj( tDiffuse, vUv );","\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};(function(t,e){Hh.call(this,t,e),this.geometry.setDrawRange(0,0),this.renderOrder=-1/0}).prototype=Object.create(Hh.prototype);var Wh=function(t,e){B.call(this,t),this.type="Refractor";var n=this,a=new h(void 0!==(e=e||{}).color?e.color:8355711),s=e.textureWidth||512,l=e.textureHeight||512,u=e.clipBias||0,c=e.shader||Wh.RefractorShader,p=new st;p.matrixAutoUpdate=!1,p.userData.refractor=!0;var d=new U,f=new r,m=new pt(s,l,{minFilter:ja,magFilter:ja,format:es,stencilBuffer:!1});xo.isPowerOfTwo(s)&&xo.isPowerOfTwo(l)||(m.texture.generateMipmaps=!1),this.material=new dt({uniforms:tl.clone(c.uniforms),vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,transparent:!0}),this.material.uniforms.color.value=a,this.material.uniforms.tDiffuse.value=m.texture,this.material.uniforms.textureMatrix.value=f;var v=function(){var t=new i,e=new i,o=new r,a=new i,s=new i;return function(r){return t.setFromMatrixPosition(n.matrixWorld),e.setFromMatrixPosition(r.matrixWorld),a.subVectors(t,e),o.extractRotation(n.matrixWorld),s.set(0,0,1),s.applyMatrix4(o),a.dot(s)<0}}(),y=function(){var t=new i,e=new i,r=new o,a=new i;return function(){n.matrixWorld.decompose(e,r,a),t.set(0,0,1).applyQuaternion(r).normalize(),t.negate(),d.setFromNormalAndCoplanarPoint(t,e)}}(),b=function(){var t=new U,e=new g,n=new g;return function(r){p.matrixWorld.copy(r.matrixWorld),p.matrixWorldInverse.getInverse(p.matrixWorld),p.projectionMatrix.copy(r.projectionMatrix),p.far=r.far,t.copy(d),t.applyMatrix4(p.matrixWorldInverse),e.set(t.normal.x,t.normal.y,t.normal.z,t.constant);var i=p.projectionMatrix;n.x=(Math.sign(e.x)+i.elements[8])/i.elements[0],n.y=(Math.sign(e.y)+i.elements[9])/i.elements[5],n.z=-1,n.w=(1+i.elements[10])/i.elements[14],e.multiplyScalar(2/e.dot(n)),i.elements[2]=e.x,i.elements[6]=e.y,i.elements[10]=e.z+1-u,i.elements[14]=e.w}}(),_=function(){var t=new g;return function(e,r,i){n.visible=!1;var o=e.getRenderTarget(),a=e.vr.enabled,s=e.shadowMap.autoUpdate;e.vr.enabled=!1,e.shadowMap.autoUpdate=!1,e.render(r,p,m,!0),e.vr.enabled=a,e.shadowMap.autoUpdate=s,e.setRenderTarget(o);var l=i.bounds;if(void 0!==l){var u=e.getSize(),c=e.getPixelRatio();t.x=l.x*u.width*c,t.y=l.y*u.height*c,t.z=l.z*u.width*c,t.w=l.w*u.height*c,e.state.viewport(t)}n.visible=!0}}();this.onBeforeRender=function(t,e,r){!0!==r.userData.refractor&&!0!=!v(r)&&(y(),function(t){f.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),f.multiply(t.projectionMatrix),f.multiply(t.matrixWorldInverse),f.multiply(n.matrixWorld)}(r),b(r),_(t,e,r))},this.getRenderTarget=function(){return m}};Wh.prototype=Object.create(B.prototype),Wh.prototype.constructor=Wh,Wh.RefractorShader={uniforms:{color:{type:"c",value:null},tDiffuse:{type:"t",value:null},textureMatrix:{type:"m4",value:null}},vertexShader:["uniform mat4 textureMatrix;","varying vec4 vUv;","void main() {","\tvUv = textureMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","\tvec4 base = texture2DProj( tDiffuse, vUv );","\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};var Xh=function(t){var e=new D({color:0,transparent:!0,opacity:.6,depthWrite:!1});B.call(this,t.geometry,e),this.meshMatrix=t.matrixWorld,this.frustumCulled=!1,this.matrixAutoUpdate=!1};(Xh.prototype=Object.create(B.prototype)).constructor=Xh,Xh.prototype.update=function(){var t=new r;return function(e,n){var r=e.normal.x*n.x+e.normal.y*n.y+e.normal.z*n.z+-e.constant*n.w,i=t.elements;i[0]=r-n.x*e.normal.x,i[4]=-n.x*e.normal.y,i[8]=-n.x*e.normal.z,i[12]=-n.x*-e.constant,i[1]=-n.y*e.normal.x,i[5]=r-n.y*e.normal.y,i[9]=-n.y*e.normal.z,i[13]=-n.y*-e.constant,i[2]=-n.z*e.normal.x,i[6]=-n.z*e.normal.y,i[10]=r-n.z*e.normal.z,i[14]=-n.z*-e.constant,i[3]=-n.w*e.normal.x,i[7]=-n.w*e.normal.y,i[11]=-n.w*e.normal.z,i[15]=r-n.w*-e.constant,this.matrix.multiplyMatrices(t,this.meshMatrix)}}();var Yh=function(){var t=Yh.SkyShader,e=new dt({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:tl.clone(t.uniforms),side:Ro});B.call(this,new H(1,1,1),e)};Yh.prototype=Object.create(B.prototype),Yh.SkyShader={uniforms:{luminance:{value:1},turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new i}},vertexShader:["uniform vec3 sunPosition;","uniform float rayleigh;","uniform float turbidity;","uniform float mieCoefficient;","varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","const vec3 up = vec3( 0.0, 1.0, 0.0 );","const float e = 2.71828182845904523536028747135266249775724709369995957;","const float pi = 3.141592653589793238462643383279502884197169;","const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );","const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );","const float v = 4.0;","const vec3 K = vec3( 0.686, 0.678, 0.666 );","const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );","const float cutoffAngle = 1.6110731556870734;","const float steepness = 1.5;","const float EE = 1000.0;","float sunIntensity( float zenithAngleCos ) {","\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );","\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );","}","vec3 totalMie( float T ) {","\tfloat c = ( 0.2 * T ) * 10E-18;","\treturn 0.434 * c * MieConst;","}","void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvWorldPosition = worldPosition.xyz;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\tgl_Position.z = gl_Position.w;","\tvSunDirection = normalize( sunPosition );","\tvSunE = sunIntensity( dot( vSunDirection, up ) );","\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );","\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );","\tvBetaR = totalRayleigh * rayleighCoefficient;","\tvBetaM = totalMie( turbidity ) * mieCoefficient;","}"].join("\n"),fragmentShader:["varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","uniform float luminance;","uniform float mieDirectionalG;","const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );","const float pi = 3.141592653589793238462643383279502884197169;","const float n = 1.0003;","const float N = 2.545E25;","const float rayleighZenithLength = 8.4E3;","const float mieZenithLength = 1.25E3;","const vec3 up = vec3( 0.0, 1.0, 0.0 );","const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;","const float THREE_OVER_SIXTEENPI = 0.05968310365946075;","const float ONE_OVER_FOURPI = 0.07957747154594767;","float rayleighPhase( float cosTheta ) {","\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );","}","float hgPhase( float cosTheta, float g ) {","\tfloat g2 = pow( g, 2.0 );","\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );","\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );","}","const float A = 0.15;","const float B = 0.50;","const float C = 0.10;","const float D = 0.20;","const float E = 0.02;","const float F = 0.30;","const float whiteScale = 1.0748724675633854;","vec3 Uncharted2Tonemap( vec3 x ) {","\treturn ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;","}","void main() {","\tfloat zenithAngle = acos( max( 0.0, dot( up, normalize( vWorldPosition - cameraPos ) ) ) );","\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );","\tfloat sR = rayleighZenithLength * inverse;","\tfloat sM = mieZenithLength * inverse;","\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );","\tfloat cosTheta = dot( normalize( vWorldPosition - cameraPos ), vSunDirection );","\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );","\tvec3 betaRTheta = vBetaR * rPhase;","\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );","\tvec3 betaMTheta = vBetaM * mPhase;","\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );","\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );","\tvec3 direction = normalize( vWorldPosition - cameraPos );","\tfloat theta = acos( direction.y ); // elevation --\x3e y-axis, [-pi/2, pi/2]","\tfloat phi = atan( direction.z, direction.x ); // azimuth --\x3e x-axis [-pi/2, pi/2]","\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );","\tvec3 L0 = vec3( 0.1 ) * Fex;","\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );","\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;","\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );","\tvec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );","\tvec3 color = curr * whiteScale;","\tvec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );","\tgl_FragColor = vec4( retColor, 1.0 );","}"].join("\n")};var qh=function(t,e){B.call(this,t);var n=this,o=void 0!==(e=e||{}).textureWidth?e.textureWidth:512,a=void 0!==e.textureHeight?e.textureHeight:512,s=void 0!==e.clipBias?e.clipBias:0,l=void 0!==e.alpha?e.alpha:1,u=void 0!==e.time?e.time:0,c=void 0!==e.waterNormals?e.waterNormals:null,p=void 0!==e.sunDirection?e.sunDirection:new i(.70707,.70707,0),d=new h(void 0!==e.sunColor?e.sunColor:16777215),f=new h(void 0!==e.waterColor?e.waterColor:8355711),m=void 0!==e.eye?e.eye:new i(0,0,0),v=void 0!==e.distortionScale?e.distortionScale:20,y=void 0!==e.side?e.side:Fo,b=void 0!==e.fog&&e.fog,_=new U,x=new i,w=new i,S=new i,A=new r,M=new i(0,0,-1),T=new g,C=new i,E=new i,P=new g,O=new r,N=new st,L=new pt(o,a,{minFilter:ja,magFilter:ja,format:es,stencilBuffer:!1});xo.isPowerOfTwo(o)&&xo.isPowerOfTwo(a)||(L.texture.generateMipmaps=!1);var I={uniforms:tl.merge([Ol.fog,Ol.lights,{normalSampler:{value:null},mirrorSampler:{value:null},alpha:{value:1},time:{value:0},size:{value:1},distortionScale:{value:20},textureMatrix:{value:new r},sunColor:{value:new h(8355711)},sunDirection:{value:new i(.70707,.70707,0)},eye:{value:new i},waterColor:{value:new h(5592405)}}]),vertexShader:["uniform mat4 textureMatrix;","uniform float time;","varying vec4 mirrorCoord;","varying vec4 worldPosition;",Pl.fog_pars_vertex,Pl.shadowmap_pars_vertex,"void main() {","\tmirrorCoord = modelMatrix * vec4( position, 1.0 );","\tworldPosition = mirrorCoord.xyzw;","\tmirrorCoord = textureMatrix * mirrorCoord;","\tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * mvPosition;",Pl.fog_vertex,Pl.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform sampler2D mirrorSampler;","uniform float alpha;","uniform float time;","uniform float size;","uniform float distortionScale;","uniform sampler2D normalSampler;","uniform vec3 sunColor;","uniform vec3 sunDirection;","uniform vec3 eye;","uniform vec3 waterColor;","varying vec4 mirrorCoord;","varying vec4 worldPosition;","vec4 getNoise( vec2 uv ) {","\tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);","\tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );","\tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );","\tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );","\tvec4 noise = texture2D( normalSampler, uv0 ) +","\t\ttexture2D( normalSampler, uv1 ) +","\t\ttexture2D( normalSampler, uv2 ) +","\t\ttexture2D( normalSampler, uv3 );","\treturn noise * 0.5 - 1.0;","}","void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {","\tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );","\tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );","\tspecularColor += pow( direction, shiny ) * sunColor * spec;","\tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;","}",Pl.common,Pl.packing,Pl.bsdfs,Pl.fog_pars_fragment,Pl.lights_pars_begin,Pl.shadowmap_pars_fragment,Pl.shadowmask_pars_fragment,"void main() {","\tvec4 noise = getNoise( worldPosition.xz * size );","\tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );","\tvec3 diffuseLight = vec3(0.0);","\tvec3 specularLight = vec3(0.0);","\tvec3 worldToEye = eye-worldPosition.xyz;","\tvec3 eyeDirection = normalize( worldToEye );","\tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );","\tfloat distance = length(worldToEye);","\tvec2 distortion = surfaceNormal.xz * ( 0.001 + 1.0 / distance ) * distortionScale;","\tvec3 reflectionSample = vec3( texture2D( mirrorSampler, mirrorCoord.xy / mirrorCoord.z + distortion ) );","\tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );","\tfloat rf0 = 0.3;","\tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );","\tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;","\tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ) * getShadowMask(), ( vec3( 0.1 ) + reflectionSample * 0.9 + reflectionSample * specularLight ), reflectance);","\tvec3 outgoingLight = albedo;","\tgl_FragColor = vec4( outgoingLight, alpha );",Pl.tonemapping_fragment,Pl.fog_fragment,"}"].join("\n")},D=new dt({fragmentShader:I.fragmentShader,vertexShader:I.vertexShader,uniforms:tl.clone(I.uniforms),transparent:!0,lights:!0,side:y,fog:b});D.uniforms.mirrorSampler.value=L.texture,D.uniforms.textureMatrix.value=O,D.uniforms.alpha.value=l,D.uniforms.time.value=u,D.uniforms.normalSampler.value=c,D.uniforms.sunColor.value=d,D.uniforms.waterColor.value=f,D.uniforms.sunDirection.value=p,D.uniforms.distortionScale.value=v,D.uniforms.eye.value=m,n.material=D,n.onBeforeRender=function(t,e,r){if(w.setFromMatrixPosition(n.matrixWorld),S.setFromMatrixPosition(r.matrixWorld),A.extractRotation(n.matrixWorld),x.set(0,0,1),x.applyMatrix4(A),C.subVectors(w,S),!(C.dot(x)>0)){C.reflect(x).negate(),C.add(w),A.extractRotation(r.matrixWorld),M.set(0,0,-1),M.applyMatrix4(A),M.add(S),E.subVectors(w,M),E.reflect(x).negate(),E.add(w),N.position.copy(C),N.up.set(0,1,0),N.up.applyMatrix4(A),N.up.reflect(x),N.lookAt(E),N.far=r.far,N.updateMatrixWorld(),N.projectionMatrix.copy(r.projectionMatrix),O.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),O.multiply(N.projectionMatrix),O.multiply(N.matrixWorldInverse),_.setFromNormalAndCoplanarPoint(x,w),_.applyMatrix4(N.matrixWorldInverse),T.set(_.normal.x,_.normal.y,_.normal.z,_.constant);var i=N.projectionMatrix;P.x=(Math.sign(T.x)+i.elements[8])/i.elements[0],P.y=(Math.sign(T.y)+i.elements[9])/i.elements[5],P.z=-1,P.w=(1+i.elements[10])/i.elements[14],T.multiplyScalar(2/T.dot(P)),i.elements[2]=T.x,i.elements[6]=T.y,i.elements[10]=T.z+1-s,i.elements[14]=T.w,m.setFromMatrixPosition(r.matrixWorld);var o=t.getRenderTarget(),a=t.vr.enabled,l=t.shadowMap.autoUpdate;n.visible=!1,t.vr.enabled=!1,t.shadowMap.autoUpdate=!1,t.render(e,N,L,!0),n.visible=!0,t.vr.enabled=a,t.shadowMap.autoUpdate=l,t.setRenderTarget(o)}}};(qh.prototype=Object.create(B.prototype)).constructor=qh,Object.assign(Tn.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"==typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}),(Cn.prototype=Object.create(B.prototype)).constructor=Cn,Cn.Water2Shader={uniforms:{color:{type:"c",value:null},reflectivity:{type:"f",value:0},tReflectionMap:{type:"t",value:null},tRefractionMap:{type:"t",value:null},tNormalMap0:{type:"t",value:null},tNormalMap1:{type:"t",value:null},textureMatrix:{type:"m4",value:null},config:{type:"v4",value:new g}},vertexShader:["#include <fog_pars_vertex>","uniform mat4 textureMatrix;","varying vec4 vCoord;","varying vec2 vUv;","varying vec3 vToEye;","void main() {","\tvUv = uv;","\tvCoord = textureMatrix * vec4( position, 1.0 );","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvToEye = cameraPosition - worldPosition.xyz;","\tvec4 mvPosition =  viewMatrix * worldPosition;","\tgl_Position = projectionMatrix * mvPosition;","\t#include <fog_vertex>","}"].join("\n"),fragmentShader:["#include <fog_pars_fragment>","uniform sampler2D tReflectionMap;","uniform sampler2D tRefractionMap;","uniform sampler2D tNormalMap0;","uniform sampler2D tNormalMap1;","#ifdef USE_FLOWMAP","\tuniform sampler2D tFlowMap;","#else","\tuniform vec2 flowDirection;","#endif","uniform vec3 color;","uniform float reflectivity;","uniform vec4 config;","varying vec4 vCoord;","varying vec2 vUv;","varying vec3 vToEye;","void main() {","\tfloat flowMapOffset0 = config.x;","\tfloat flowMapOffset1 = config.y;","\tfloat halfCycle = config.z;","\tfloat scale = config.w;","\tvec3 toEye = normalize( vToEye );","\tvec2 flow;","\t#ifdef USE_FLOWMAP","\t\tflow = texture2D( tFlowMap, vUv ).rg * 2.0 - 1.0;","\t#else","\t\tflow = flowDirection;","\t#endif","\tflow.x *= - 1.0;","\tvec4 normalColor0 = texture2D( tNormalMap0, ( vUv * scale ) + flow * flowMapOffset0 );","\tvec4 normalColor1 = texture2D( tNormalMap1, ( vUv * scale ) + flow * flowMapOffset1 );","\tfloat flowLerp = abs( halfCycle - flowMapOffset0 ) / halfCycle;","\tvec4 normalColor = mix( normalColor0, normalColor1, flowLerp );","\tvec3 normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );","\tfloat theta = max( dot( toEye, normal ), 0.0 );","\tfloat reflectance = reflectivity + ( 1.0 - reflectivity ) * pow( ( 1.0 - theta ), 5.0 );","\tvec3 coord = vCoord.xyz / vCoord.w;","\tvec2 uv = coord.xy + coord.z * normal.xz * 0.05;","\tvec4 reflectColor = texture2D( tReflectionMap, vec2( 1.0 - uv.x, uv.y ) );","\tvec4 refractColor = texture2D( tRefractionMap, uv );","\tgl_FragColor = vec4( color, 1.0 ) * mix( refractColor, reflectColor, reflectance );","\t#include <tonemapping_fragment>","\t#include <encodings_fragment>","\t#include <fog_fragment>","}"].join("\n")};var Zh=function(t,e,n,r){function o(t,e){return void 0!==t?t:e}this.changed=!0,this.initial=!0,this.oceanCamera=new ct,this.oceanCamera.position.z=1,this.renderer=t,this.renderer.clearColor(16777215),this.scene=new ut,this.clearColor=o((r=r||{}).CLEAR_COLOR,[1,1,1,0]),this.geometryOrigin=o(r.GEOMETRY_ORIGIN,[-1e3,-1e3]),this.sunDirectionX=o(r.SUN_DIRECTION[0],-1),this.sunDirectionY=o(r.SUN_DIRECTION[1],1),this.sunDirectionZ=o(r.SUN_DIRECTION[2],1),this.oceanColor=o(r.OCEAN_COLOR,new i(.004,.016,.047)),this.skyColor=o(r.SKY_COLOR,new i(3.2,9.6,12.8)),this.exposure=o(r.EXPOSURE,.35),this.geometryResolution=o(r.GEOMETRY_RESOLUTION,32),this.geometrySize=o(r.GEOMETRY_SIZE,2e3),this.resolution=o(r.RESOLUTION,64),this.floatSize=o(r.SIZE_OF_FLOAT,4),this.windX=o(r.INITIAL_WIND[0],10),this.windY=o(r.INITIAL_WIND[1],10),this.size=o(r.INITIAL_SIZE,250),this.choppiness=o(r.INITIAL_CHOPPINESS,1.5),this.matrixNeedsUpdate=!1;var a=o(r.USE_HALF_FLOAT,!1)?Za:qa,s={minFilter:ja,magFilter:ja,wrapS:Da,wrapT:Da,format:ns,stencilBuffer:!1,depthBuffer:!1,premultiplyAlpha:!1,type:a},l={minFilter:Ra,magFilter:Ra,wrapS:Da,wrapT:Da,format:ns,stencilBuffer:!1,depthBuffer:!1,premultiplyAlpha:!1,type:a};this.initialSpectrumFramebuffer=new pt(this.resolution,this.resolution,{minFilter:Ra,magFilter:Ra,wrapS:Ia,wrapT:Ia,format:ns,stencilBuffer:!1,depthBuffer:!1,premultiplyAlpha:!1,type:a}),this.spectrumFramebuffer=new pt(this.resolution,this.resolution,l),this.pingPhaseFramebuffer=new pt(this.resolution,this.resolution,l),this.pongPhaseFramebuffer=new pt(this.resolution,this.resolution,l),this.pingTransformFramebuffer=new pt(this.resolution,this.resolution,l),this.pongTransformFramebuffer=new pt(this.resolution,this.resolution,l),this.displacementMapFramebuffer=new pt(this.resolution,this.resolution,s),this.normalMapFramebuffer=new pt(this.resolution,this.resolution,s);var u=Nl.ocean_sim_vertex,c=Nl.ocean_subtransform,h=tl.clone(c.uniforms);this.materialOceanHorizontal=new dt({uniforms:h,vertexShader:u.vertexShader,fragmentShader:"#define HORIZONTAL \n"+c.fragmentShader}),this.materialOceanHorizontal.uniforms.u_transformSize={value:this.resolution},this.materialOceanHorizontal.uniforms.u_subtransformSize={value:null},this.materialOceanHorizontal.uniforms.u_input={value:null},this.materialOceanHorizontal.depthTest=!1;var p=Nl.ocean_subtransform,d=tl.clone(p.uniforms);this.materialOceanVertical=new dt({uniforms:d,vertexShader:u.vertexShader,fragmentShader:p.fragmentShader}),this.materialOceanVertical.uniforms.u_transformSize={value:this.resolution},this.materialOceanVertical.uniforms.u_subtransformSize={value:null},this.materialOceanVertical.uniforms.u_input={value:null},this.materialOceanVertical.depthTest=!1;var f=Nl.ocean_initial_spectrum,v=tl.clone(f.uniforms);this.materialInitialSpectrum=new dt({uniforms:v,vertexShader:u.vertexShader,fragmentShader:f.fragmentShader}),this.materialInitialSpectrum.uniforms.u_wind={value:new m},this.materialInitialSpectrum.uniforms.u_resolution={value:this.resolution},this.materialInitialSpectrum.depthTest=!1;var g=Nl.ocean_phase,y=tl.clone(g.uniforms);this.materialPhase=new dt({uniforms:y,vertexShader:u.vertexShader,fragmentShader:g.fragmentShader}),this.materialPhase.uniforms.u_resolution={value:this.resolution},this.materialPhase.depthTest=!1;var b=Nl.ocean_spectrum,_=tl.clone(b.uniforms);this.materialSpectrum=new dt({uniforms:_,vertexShader:u.vertexShader,fragmentShader:b.fragmentShader}),this.materialSpectrum.uniforms.u_initialSpectrum={value:null},this.materialSpectrum.uniforms.u_resolution={value:this.resolution},this.materialSpectrum.depthTest=!1;var x=Nl.ocean_normals,w=tl.clone(x.uniforms);this.materialNormal=new dt({uniforms:w,vertexShader:u.vertexShader,fragmentShader:x.fragmentShader}),this.materialNormal.uniforms.u_displacementMap={value:null},this.materialNormal.uniforms.u_resolution={value:this.resolution},this.materialNormal.depthTest=!1;var S=Nl.ocean_main,A=tl.clone(S.uniforms);this.materialOcean=new dt({uniforms:A,vertexShader:S.vertexShader,fragmentShader:S.fragmentShader}),this.materialOcean.uniforms.u_geometrySize={value:this.resolution},this.materialOcean.uniforms.u_displacementMap={value:this.displacementMapFramebuffer.texture},this.materialOcean.uniforms.u_normalMap={value:this.normalMapFramebuffer.texture},this.materialOcean.uniforms.u_oceanColor={value:this.oceanColor},this.materialOcean.uniforms.u_skyColor={value:this.skyColor},this.materialOcean.uniforms.u_sunDirection={value:new i(this.sunDirectionX,this.sunDirectionY,this.sunDirectionZ)},this.materialOcean.uniforms.u_exposure={value:this.exposure},this.materialOceanHorizontal.blending=0,this.materialOceanVertical.blending=0,this.materialInitialSpectrum.blending=0,this.materialPhase.blending=0,this.materialSpectrum.blending=0,this.materialNormal.blending=0,this.materialOcean.blending=0,this.screenQuad=new B(new mt(2,2)),this.scene.add(this.screenQuad),this.generateSeedPhaseTexture(),this.generateMesh()};Zh.prototype.generateMesh=function(){var t=new mt(this.geometrySize,this.geometrySize,this.geometryResolution,this.geometryResolution);t.rotateX(-Math.PI/2),this.oceanMesh=new B(t,this.materialOcean)},Zh.prototype.render=function(){this.scene.overrideMaterial=null,this.changed&&this.renderInitialSpectrum(),this.renderWavePhase(),this.renderSpectrum(),this.renderSpectrumFFT(),this.renderNormalMap(),this.scene.overrideMaterial=null},Zh.prototype.generateSeedPhaseTexture=function(){this.pingPhase=!0;for(var t=new window.Float32Array(this.resolution*this.resolution*4),e=0;e<this.resolution;e++)for(var n=0;n<this.resolution;n++)t[e*this.resolution*4+4*n]=2*Math.random()*Math.PI,t[e*this.resolution*4+4*n+1]=0,t[e*this.resolution*4+4*n+2]=0,t[e*this.resolution*4+4*n+3]=0;this.pingPhaseTexture=new ye(t,this.resolution,this.resolution,ns),this.pingPhaseTexture.wrapS=Da,this.pingPhaseTexture.wrapT=Da,this.pingPhaseTexture.type=qa,this.pingPhaseTexture.needsUpdate=!0},Zh.prototype.renderInitialSpectrum=function(){this.scene.overrideMaterial=this.materialInitialSpectrum,this.materialInitialSpectrum.uniforms.u_wind.value.set(this.windX,this.windY),this.materialInitialSpectrum.uniforms.u_size.value=this.size,this.renderer.render(this.scene,this.oceanCamera,this.initialSpectrumFramebuffer,!0)},Zh.prototype.renderWavePhase=function(){this.scene.overrideMaterial=this.materialPhase,this.screenQuad.material=this.materialPhase,this.initial?(this.materialPhase.uniforms.u_phases.value=this.pingPhaseTexture,this.initial=!1):this.materialPhase.uniforms.u_phases.value=this.pingPhase?this.pingPhaseFramebuffer.texture:this.pongPhaseFramebuffer.texture,this.materialPhase.uniforms.u_deltaTime.value=this.deltaTime,this.materialPhase.uniforms.u_size.value=this.size,this.renderer.render(this.scene,this.oceanCamera,this.pingPhase?this.pongPhaseFramebuffer:this.pingPhaseFramebuffer),this.pingPhase=!this.pingPhase},Zh.prototype.renderSpectrum=function(){this.scene.overrideMaterial=this.materialSpectrum,this.materialSpectrum.uniforms.u_initialSpectrum.value=this.initialSpectrumFramebuffer.texture,this.materialSpectrum.uniforms.u_phases.value=this.pingPhase?this.pingPhaseFramebuffer.texture:this.pongPhaseFramebuffer.texture,this.materialSpectrum.uniforms.u_choppiness.value=this.choppiness,this.materialSpectrum.uniforms.u_size.value=this.size,this.renderer.render(this.scene,this.oceanCamera,this.spectrumFramebuffer)},Zh.prototype.renderSpectrumFFT=function(){var t=Math.log(this.resolution)/Math.log(2);this.scene.overrideMaterial=this.materialOceanHorizontal;for(var e=0;e<t;e++)0===e?(this.materialOceanHorizontal.uniforms.u_input.value=this.spectrumFramebuffer.texture,this.materialOceanHorizontal.uniforms.u_subtransformSize.value=Math.pow(2,e%t+1),this.renderer.render(this.scene,this.oceanCamera,this.pingTransformFramebuffer)):e%2==1?(this.materialOceanHorizontal.uniforms.u_input.value=this.pingTransformFramebuffer.texture,this.materialOceanHorizontal.uniforms.u_subtransformSize.value=Math.pow(2,e%t+1),this.renderer.render(this.scene,this.oceanCamera,this.pongTransformFramebuffer)):(this.materialOceanHorizontal.uniforms.u_input.value=this.pongTransformFramebuffer.texture,this.materialOceanHorizontal.uniforms.u_subtransformSize.value=Math.pow(2,e%t+1),this.renderer.render(this.scene,this.oceanCamera,this.pingTransformFramebuffer));this.scene.overrideMaterial=this.materialOceanVertical;for(e=t;e<2*t;e++)e===2*t-1?(this.materialOceanVertical.uniforms.u_input.value=t%2==0?this.pingTransformFramebuffer.texture:this.pongTransformFramebuffer.texture,this.materialOceanVertical.uniforms.u_subtransformSize.value=Math.pow(2,e%t+1),this.renderer.render(this.scene,this.oceanCamera,this.displacementMapFramebuffer)):e%2==1?(this.materialOceanVertical.uniforms.u_input.value=this.pingTransformFramebuffer.texture,this.materialOceanVertical.uniforms.u_subtransformSize.value=Math.pow(2,e%t+1),this.renderer.render(this.scene,this.oceanCamera,this.pongTransformFramebuffer)):(this.materialOceanVertical.uniforms.u_input.value=this.pongTransformFramebuffer.texture,this.materialOceanVertical.uniforms.u_subtransformSize.value=Math.pow(2,e%t+1),this.renderer.render(this.scene,this.oceanCamera,this.pingTransformFramebuffer))},Zh.prototype.renderNormalMap=function(){this.scene.overrideMaterial=this.materialNormal,this.changed&&(this.materialNormal.uniforms.u_size.value=this.size),this.materialNormal.uniforms.u_displacementMap.value=this.displacementMapFramebuffer.texture,this.renderer.render(this.scene,this.oceanCamera,this.normalMapFramebuffer,!0)},(En.prototype=Object.create(je.prototype)).constructor=En,En.prototype.update=function(){var t=new d;return function(e){if(void 0!==e&&console.warn("BoxHelper: .update() has no longer arguments."),void 0!==this.object&&t.setFromObject(this.object),!t.isEmpty()){var n=t.min,r=t.max,i=this.geometry.attributes.position,o=i.array;o[0]=r.x,o[1]=r.y,o[2]=r.z,o[3]=n.x,o[4]=r.y,o[5]=r.z,o[6]=n.x,o[7]=n.y,o[8]=r.z,o[9]=r.x,o[10]=n.y,o[11]=r.z,o[12]=r.x,o[13]=r.y,o[14]=n.z,o[15]=n.x,o[16]=r.y,o[17]=n.z,o[18]=n.x,o[19]=n.y,o[20]=n.z,o[21]=r.x,o[22]=n.y,o[23]=n.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),En.prototype.setFromObject=function(t){return this.object=t,this.update(),this};var Qh=function(t){if(t=t||{},t.tree=this,this.nodeCount=0,this.INDEX_INSIDE_CROSS=-1,this.INDEX_OUTSIDE_OFFSET=2,this.INDEX_OUTSIDE_POS_X=Pn(t.INDEX_OUTSIDE_POS_X)?t.INDEX_OUTSIDE_POS_X:0,this.INDEX_OUTSIDE_NEG_X=Pn(t.INDEX_OUTSIDE_NEG_X)?t.INDEX_OUTSIDE_NEG_X:1,this.INDEX_OUTSIDE_POS_Y=Pn(t.INDEX_OUTSIDE_POS_Y)?t.INDEX_OUTSIDE_POS_Y:2,this.INDEX_OUTSIDE_NEG_Y=Pn(t.INDEX_OUTSIDE_NEG_Y)?t.INDEX_OUTSIDE_NEG_Y:3,this.INDEX_OUTSIDE_POS_Z=Pn(t.INDEX_OUTSIDE_POS_Z)?t.INDEX_OUTSIDE_POS_Z:4,this.INDEX_OUTSIDE_NEG_Z=Pn(t.INDEX_OUTSIDE_NEG_Z)?t.INDEX_OUTSIDE_NEG_Z:5,this.INDEX_OUTSIDE_MAP=[],this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_POS_X]={index:this.INDEX_OUTSIDE_POS_X,count:0,x:1,y:0,z:0},this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_NEG_X]={index:this.INDEX_OUTSIDE_NEG_X,count:0,x:-1,y:0,z:0},this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_POS_Y]={index:this.INDEX_OUTSIDE_POS_Y,count:0,x:0,y:1,z:0},this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_NEG_Y]={index:this.INDEX_OUTSIDE_NEG_Y,count:0,x:0,y:-1,z:0},this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_POS_Z]={index:this.INDEX_OUTSIDE_POS_Z,count:0,x:0,y:0,z:1},this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_NEG_Z]={index:this.INDEX_OUTSIDE_NEG_Z,count:0,x:0,y:0,z:-1},this.FLAG_POS_X=1<<this.INDEX_OUTSIDE_POS_X+1,this.FLAG_NEG_X=1<<this.INDEX_OUTSIDE_NEG_X+1,this.FLAG_POS_Y=1<<this.INDEX_OUTSIDE_POS_Y+1,this.FLAG_NEG_Y=1<<this.INDEX_OUTSIDE_NEG_Y+1,this.FLAG_POS_Z=1<<this.INDEX_OUTSIDE_POS_Z+1,this.FLAG_NEG_Z=1<<this.INDEX_OUTSIDE_NEG_Z+1,this.utilVec31Search=new i,this.utilVec32Search=new i,this.scene=t.scene,this.scene){var e=new En(new B(new G(1,1,1)),16711782);this.visualGeometry=e.geometry,this.visualMaterial=e.material}this.objects=[],this.objectsMap={},this.objectsData=[],this.objectsDeferred=[],this.depthMax=Pn(t.depthMax)?t.depthMax:1/0,this.objectsThreshold=Pn(t.objectsThreshold)?t.objectsThreshold:8,this.overlapPct=Pn(t.overlapPct)?t.overlapPct:.15,this.undeferred=t.undeferred||!1,this.root=t.root instanceof Kh?t.root:new Kh(t)};Qh.prototype={update:function(){if(this.objectsDeferred.length>0){for(var t=0,e=this.objectsDeferred.length;t<e;t++){var n=this.objectsDeferred[t];this.addDeferred(n.object,n.options)}this.objectsDeferred.length=0}},add:function(t,e){this.undeferred?(this.updateObject(t),this.addDeferred(t,e)):this.objectsDeferred.push({object:t,options:e})},addDeferred:function(t,e){var n,r,i,o,a,s;if(t instanceof Jh&&(t=t.object),t.uuid||(t.uuid=xo.generateUUID()),!this.objectsMap[t.uuid])if(this.objects.push(t),this.objectsMap[t.uuid]=t,e&&(o=e.useFaces,s=e.useVertices),!0===s)for(n=0,r=(a=t.geometry.vertices).length;n<r;n++)this.addObjectData(t,a[n]);else if(!0===o)for(n=0,r=(i=t.geometry.faces).length;n<r;n++)this.addObjectData(t,i[n]);else this.addObjectData(t)},addObjectData:function(t,e){var n=new Jh(t,e);this.objectsData.push(n),this.root.addObject(n)},remove:function(t){var e,n,r,i,o=t;if(t instanceof Jh&&(t=t.object),this.objectsMap[t.uuid]){if(this.objectsMap[t.uuid]=void 0,-1!==(r=Nn(this.objects,t)))for(this.objects.splice(r,1),e=0,n=(i=this.root.removeObject(o)).length;e<n;e++)-1!==(r=Nn(this.objectsData,o=i[e]))&&this.objectsData.splice(r,1)}else this.objectsDeferred.length>0&&-1!==(r=function(t,e,n){for(var r=0,i=t.length;r<i;r++)if(t[r][e]===n)return r;return-1}(this.objectsDeferred,"object",t))&&this.objectsDeferred.splice(r,1)},extend:function(t){var e,n,r,i;if(t instanceof Qh)for(e=0,n=(r=t.objectsData).length;e<n;e++)this.add(i=r[e],{useFaces:i.faces,useVertices:i.vertices})},rebuild:function(){var t,e,n,r,i,o=[];for(t=0,e=this.objectsData.length;t<e;t++)n=(r=this.objectsData[t]).node,r.update(),n instanceof Kh&&!r.positionLast.equals(r.position)&&(i=r.indexOctant,n.getOctantIndex(r)!==i&&o.push(r));for(t=0,e=o.length;t<e;t++)(r=o[t]).node.removeObject(r),this.root.addObject(r)},updateObject:function(t){var e,n,r,i,o=[t];for(r=t.parent;r;)o.push(r),r=r.parent;for(e=0,n=o.length;e<n;e++)!0===(r=o[e]).matrixWorldNeedsUpdate&&(i=r);void 0!==i&&i.updateMatrixWorld()},search:function(t,e,n,r){var o,a,s,l,u,c,h,p,d,f;for(s=[].concat(this.root.objects),e>0||(e=Number.MAX_VALUE),r instanceof i&&(r=this.utilVec31Search.copy(r).normalize(),f=this.utilVec32Search.set(1,1,1).divide(r)),o=0,a=this.root.nodesIndices.length;o<a;o++)s=this.root.nodesByIndex[this.root.nodesIndices[o]].search(t,e,s,r,f);if(!0===n)for(c=[],p=[],o=0,a=s.length;o<a;o++)-1===(d=Nn(p,u=(l=s[o]).object))?(c.push(h={object:u,faces:[],vertices:[]}),p.push(u)):h=c[d],l.faces?h.faces.push(l.faces):l.vertices&&h.vertices.push(l.vertices);else c=s;return c},setRoot:function(t){t instanceof Kh&&(this.root=t,this.root.updateProperties())},getDepthEnd:function(){return this.root.getDepthEnd()},getNodeCountEnd:function(){return this.root.getNodeCountEnd()},getObjectCountEnd:function(){return this.root.getObjectCountEnd()},toConsole:function(){this.root.toConsole()}};var Jh=function(t,e){this.object=t,e instanceof p?(this.faces=e,this.face3=!0,this.utilVec31FaceBounds=new i):e instanceof i&&(this.vertices=e),this.radius=0,this.position=new i,this.object instanceof c&&this.update(),this.positionLast=this.position.clone()};Jh.prototype={update:function(){this.face3?(this.radius=this.getFace3BoundingRadius(this.object,this.faces),this.position.copy(this.faces.centroid).applyMatrix4(this.object.matrixWorld)):this.vertices?(this.radius=this.object.material.size||1,this.position.copy(this.vertices).applyMatrix4(this.object.matrixWorld)):this.object.geometry?(null===this.object.geometry.boundingSphere&&this.object.geometry.computeBoundingSphere(),this.radius=this.object.geometry.boundingSphere.radius,this.position.copy(this.object.geometry.boundingSphere.center).applyMatrix4(this.object.matrixWorld)):(this.radius=this.object.boundRadius,this.position.setFromMatrixPosition(this.object.matrixWorld)),this.radius=this.radius*Math.max(this.object.scale.x,this.object.scale.y,this.object.scale.z)},getFace3BoundingRadius:function(t,e){void 0===e.centroid&&(e.centroid=new i);var n=(t.geometry||t).vertices,r=e.centroid,o=n[e.a],a=n[e.b],s=n[e.c],l=this.utilVec31FaceBounds;return r.addVectors(o,a).add(s).divideScalar(3),Math.max(l.subVectors(r,o).length(),l.subVectors(r,a).length(),l.subVectors(r,s).length())}};var Kh=function(t){this.utilVec31Branch=new i,this.utilVec31Expand=new i,this.utilVec31Ray=new i,(t=t||{}).tree instanceof Qh?this.tree=t.tree:t.parent instanceof Kh!=!0&&(t.root=this,this.tree=new Qh(t)),this.id=this.tree.nodeCount++,this.position=t.position instanceof i?t.position:new i,this.radius=t.radius>0?t.radius:1,this.indexOctant=t.indexOctant,this.depth=0,this.reset(),this.setParent(t.parent),this.overlap=this.radius*this.tree.overlapPct,this.radiusOverlap=this.radius+this.overlap,this.left=this.position.x-this.radiusOverlap,this.right=this.position.x+this.radiusOverlap,this.bottom=this.position.y-this.radiusOverlap,this.top=this.position.y+this.radiusOverlap,this.back=this.position.z-this.radiusOverlap,this.front=this.position.z+this.radiusOverlap,this.tree.scene&&(this.visual=new je(this.tree.visualGeometry,this.tree.visualMaterial),this.visual.scale.set(2*this.radiusOverlap,2*this.radiusOverlap,2*this.radiusOverlap),this.visual.position.copy(this.position),this.tree.scene.add(this.visual))};Kh.prototype={setParent:function(t){t!==this&&this.parent!==t&&(this.parent=t,this.updateProperties())},updateProperties:function(){var t,e;for(this.parent instanceof Kh?(this.tree=this.parent.tree,this.depth=this.parent.depth+1):this.depth=0,t=0,e=this.nodesIndices.length;t<e;t++)this.nodesByIndex[this.nodesIndices[t]].updateProperties()},reset:function(t,e){var n,r,i,o=this.nodesIndices||[],a=this.nodesByIndex;for(this.objects=[],this.nodesIndices=[],this.nodesByIndex={},n=0,r=o.length;n<r;n++)(i=a[o[n]]).setParent(void 0),!0===t&&i.reset(t,e);!0===e&&this.visual&&this.visual.parent&&this.visual.parent.remove(this.visual)},addNode:function(t,e){t.indexOctant=e,-1===Nn(this.nodesIndices,e)&&this.nodesIndices.push(e),this.nodesByIndex[e]=t,t.parent!==this&&t.setParent(this)},removeNode:function(t){var e,n;e=Nn(this.nodesIndices,t),this.nodesIndices.splice(e,1),n=n||this.nodesByIndex[t],delete this.nodesByIndex[t],n.parent===this&&n.setParent(void 0)},addObject:function(t){var e;(e=this.getOctantIndex(t))>-1&&this.nodesIndices.length>0?this.branch(e).addObject(t):e<-1&&this.parent instanceof Kh?this.parent.addObject(t):(-1===Nn(this.objects,t)&&this.objects.push(t),t.node=this,this.checkGrow())},addObjectWithoutCheck:function(t){var e,n,r;for(e=0,n=t.length;e<n;e++)this.objects.push(r=t[e]),r.node=this},removeObject:function(t){var e,n,r,i;if(i=this.removeObjectRecursive(t,{searchComplete:!1,nodesRemovedFrom:[],objectsDataRemoved:[]}),(r=i.nodesRemovedFrom).length>0)for(e=0,n=r.length;e<n;e++)r[e].shrink();return i.objectsDataRemoved},removeObjectRecursive:function(t,e){var n,r,i,o,a,s=-1;if(t instanceof Jh)-1!==(s=Nn(this.objects,t))&&(this.objects.splice(s,1),t.node=void 0,e.objectsDataRemoved.push(t),e.searchComplete=a=!0);else for(n=this.objects.length-1;n>=0;n--)if((i=this.objects[n]).object===t&&(this.objects.splice(n,1),i.node=void 0,e.objectsDataRemoved.push(i),a=!0,!i.faces&&!i.vertices)){e.searchComplete=!0;break}if(!0===a&&e.nodesRemovedFrom.push(this),!0!==e.searchComplete)for(n=0,r=this.nodesIndices.length;n<r&&(o=this.nodesByIndex[this.nodesIndices[n]],!0!==(e=o.removeObjectRecursive(t,e)).searchComplete);n++);return e},checkGrow:function(){this.objects.length>this.tree.objectsThreshold&&this.tree.objectsThreshold>0&&this.grow()},grow:function(){var t,e,n,r,i=[],o=[],a=[],s=[],l=[];for(n=0,r=this.objects.length;n<r;n++)(t=this.getOctantIndex(e=this.objects[n]))>-1?(a.push(e),s.push(t)):t<-1?(i.push(e),o.push(t)):l.push(e);a.length>0&&(l=l.concat(this.split(a,s))),i.length>0&&(l=l.concat(this.expand(i,o))),this.objects=l,this.checkMerge()},split:function(t,e){var n,r,i,o,a;if(this.depth<this.tree.depthMax){for(t=t||this.objects,e=e||[],a=[],n=0,r=t.length;n<r;n++)o=t[n],(i=e[n])>-1?this.branch(i).addObject(o):a.push(o);t===this.objects&&(this.objects=a)}else a=this.objects;return a},branch:function(t){var e,n,r,o,a;return this.nodesByIndex[t]instanceof Kh?e=this.nodesByIndex[t]:(r=(n=.5*this.radiusOverlap)-n*this.tree.overlapPct,o=this.utilVec31Branch.set(1&t?r:-r,2&t?r:-r,4&t?r:-r),a=(new i).addVectors(this.position,o),e=new Kh({tree:this.tree,parent:this,position:a,radius:n,indexOctant:t}),this.addNode(e,t)),e},expand:function(t,e){var n,r,o,a,s,l,u,c,h,p,d,f,m,v,g,y,b,_,x,w,S,A,M,T,C,E,P,O,N=this.tree.INDEX_OUTSIDE_MAP,L=this.utilVec31Expand;if(this.tree.root.getDepthEnd()<this.tree.depthMax){for(t=t||this.objects,e=e||[],a=[],s=[],n=0,r=N.length;n<r;n++)N[n].count=0;for(n=0,r=t.length;n<r;n++)o=t[n],(l=e[n])<-1?((u=-l-this.tree.INDEX_OUTSIDE_OFFSET)&this.tree.FLAG_POS_X?N[this.tree.INDEX_OUTSIDE_POS_X].count++:u&this.tree.FLAG_NEG_X&&N[this.tree.INDEX_OUTSIDE_NEG_X].count++,u&this.tree.FLAG_POS_Y?N[this.tree.INDEX_OUTSIDE_POS_Y].count++:u&this.tree.FLAG_NEG_Y&&N[this.tree.INDEX_OUTSIDE_NEG_Y].count++,u&this.tree.FLAG_POS_Z?N[this.tree.INDEX_OUTSIDE_POS_Z].count++:u&this.tree.FLAG_NEG_Z&&N[this.tree.INDEX_OUTSIDE_NEG_Z].count++,s.push(o)):a.push(o);if(s.length>0)for((h=N.slice(0)).sort(function(t,e){return e.count-t.count}),y=h[2],v=1|(d=(1|(g=h[1]).index)!==(m=1|(p=h[0]).index)?g:y).index,b=h[4],x=1|(y=h[3]).index,l=this.getOctantIndexFromPosition(w=p.x+d.x+(f=(_=1|(g=h[2]).index)!==m&&_!==v?g:x!==m&&x!==v?y:b).x,S=p.y+d.y+f.y,A=p.z+d.z+f.z),c=this.getOctantIndexFromPosition(-w,-S,-A),M=this.overlap,T=this.radius,C=(E=this.tree.overlapPct>0?M/(.5*this.tree.overlapPct*(1+this.tree.overlapPct)):2*T)+E*this.tree.overlapPct-(T+M),L.set(1&l?C:-C,2&l?C:-C,4&l?C:-C),P=(new i).addVectors(this.position,L),(O=new Kh({tree:this.tree,position:P,radius:E})).addNode(this,c),this.tree.setRoot(O),n=0,r=s.length;n<r;n++)this.tree.root.addObject(s[n]);t===this.objects&&(this.objects=a)}else a=t;return a},shrink:function(){this.checkMerge(),this.tree.root.checkContract()},checkMerge:function(){for(var t,e=this;e.parent instanceof Kh&&e.getObjectCountEnd()<this.tree.objectsThreshold;)t=e,e=e.parent;e!==this&&e.merge(t)},merge:function(t){var e,n,r;for(e=0,n=(t=On(t)).length;e<n;e++)this.addObjectWithoutCheck((r=t[e]).getObjectsEnd()),r.reset(!0,!0),this.removeNode(r.indexOctant,r);this.checkMerge()},checkContract:function(){var t,e,n,r,i,o,a;if(this.nodesIndices.length>0){for(o=0,a=this.objects.length,t=0,e=this.nodesIndices.length;t<e;t++)a+=r=(n=this.nodesByIndex[this.nodesIndices[t]]).getObjectCountEnd(),(i instanceof Kh==!1||r>o)&&(i=n,o=r);(a-=o)<this.tree.objectsThreshold&&i instanceof Kh&&this.contract(i)}},contract:function(t){var e,n,r;for(e=0,n=this.nodesIndices.length;e<n;e++)(r=this.nodesByIndex[this.nodesIndices[e]])!==t&&(t.addObjectWithoutCheck(r.getObjectsEnd()),r.reset(!0,!0));t.addObjectWithoutCheck(this.objects),this.reset(!1,!0),this.tree.setRoot(t),t.checkContract()},getOctantIndex:function(t){var e,n,r,i,o,a,s,l,u=this.position,c=this.radiusOverlap,h=this.overlap,p=0;if(t instanceof Jh?(n=t.radius,t.positionLast.copy(e=t.position)):t instanceof Kh&&(e=t.position,n=0),r=e.x-u.x,i=e.y-u.y,o=e.z-u.z,a=Math.abs(r),s=Math.abs(i),l=Math.abs(o),Math.max(a,s,l)+n>c)return a+n>c&&(p^=r>0?this.tree.FLAG_POS_X:this.tree.FLAG_NEG_X),s+n>c&&(p^=i>0?this.tree.FLAG_POS_Y:this.tree.FLAG_NEG_Y),l+n>c&&(p^=o>0?this.tree.FLAG_POS_Z:this.tree.FLAG_NEG_Z),t.indexOctant=-p-this.tree.INDEX_OUTSIDE_OFFSET,t.indexOctant;if(r-n>-h)p|=1;else if(!(r+n<h))return t.indexOctant=this.tree.INDEX_INSIDE_CROSS,t.indexOctant;if(i-n>-h)p|=2;else if(!(i+n<h))return t.indexOctant=this.tree.INDEX_INSIDE_CROSS,t.indexOctant;if(o-n>-h)p|=4;else if(!(o+n<h))return t.indexOctant=this.tree.INDEX_INSIDE_CROSS,t.indexOctant;return t.indexOctant=p,t.indexOctant},getOctantIndexFromPosition:function(t,e,n){var r=0;return t>0&&(r|=1),e>0&&(r|=2),n>0&&(r|=4),r},search:function(t,e,n,r,i){var o,a;if(!0===(r?this.intersectRay(t,r,e,i):this.intersectSphere(t,e)))for(n=n.concat(this.objects),o=0,a=this.nodesIndices.length;o<a;o++)n=this.nodesByIndex[this.nodesIndices[o]].search(t,e,n,r);return n},intersectSphere:function(t,e){var n=e*e,r=t.x,i=t.y,o=t.z;return r<this.left?n-=Math.pow(r-this.left,2):r>this.right&&(n-=Math.pow(r-this.right,2)),i<this.bottom?n-=Math.pow(i-this.bottom,2):i>this.top&&(n-=Math.pow(i-this.top,2)),o<this.back?n-=Math.pow(o-this.back,2):o>this.front&&(n-=Math.pow(o-this.front,2)),n>=0},intersectRay:function(t,e,n,r){void 0===r&&(r=this.utilVec31Ray.set(1,1,1).divide(e));var i,o=(this.left-t.x)*r.x,a=(this.right-t.x)*r.x,s=(this.bottom-t.y)*r.y,l=(this.top-t.y)*r.y,u=(this.back-t.z)*r.z,c=(this.front-t.z)*r.z,h=Math.min(Math.min(Math.max(o,a),Math.max(s,l)),Math.max(u,c));return!(h<0)&&!((i=Math.max(Math.max(Math.min(o,a),Math.min(s,l)),Math.min(u,c)))>h||i>n)},getDepthEnd:function(t){var e,n;if(this.nodesIndices.length>0)for(e=0,n=this.nodesIndices.length;e<n;e++)t=this.nodesByIndex[this.nodesIndices[e]].getDepthEnd(t);else t=!t||this.depth>t?this.depth:t;return t},getNodeCountEnd:function(){return this.tree.root.getNodeCountRecursive()+1},getNodeCountRecursive:function(){var t,e,n=this.nodesIndices.length;for(t=0,e=this.nodesIndices.length;t<e;t++)n+=this.nodesByIndex[this.nodesIndices[t]].getNodeCountRecursive();return n},getObjectsEnd:function(t){var e,n;for(t=(t||[]).concat(this.objects),e=0,n=this.nodesIndices.length;e<n;e++)t=this.nodesByIndex[this.nodesIndices[e]].getObjectsEnd(t);return t},getObjectCountEnd:function(){var t,e,n=this.objects.length;for(t=0,e=this.nodesIndices.length;t<e;t++)n+=this.nodesByIndex[this.nodesIndices[t]].getObjectCountEnd();return n},getObjectCountStart:function(){for(var t=this.objects.length,e=this.parent;e instanceof Kh;)t+=e.objects.length,e=e.parent;return t},toConsole:function(t){var e,n;for(t="string"==typeof t?t:"   ",console.log(this.parent?t+" octree NODE > ":" octree ROOT > ",this," // id: ",this.id," // indexOctant: ",this.indexOctant," // position: ",this.position.x,this.position.y,this.position.z," // radius: ",this.radius," // depth: ",this.depth),console.log(this.parent?t+" ":" ","+ objects ( ",this.objects.length," ) ",this.objects),console.log(this.parent?t+" ":" ","+ children ( ",this.nodesIndices.length," )",this.nodesIndices,this.nodesByIndex),e=0,n=this.nodesIndices.length;e<n;e++)this.nodesByIndex[this.nodesIndices[e]].toConsole(t+"   ")}},Ft.prototype.intersectOctreeObject=function(t,e){var n,r,i,o;return t.object instanceof c?(i=(t=(r=t).object).geometry.faces,(o=r.faces).length>0&&(t.geometry.faces=o),n=this.intersectObject(t,e),o.length>0&&(t.geometry.faces=i)):n=this.intersectObject(t,e),n},Ft.prototype.intersectOctreeObjects=function(t,e){var n,r,i=[];for(n=0,r=t.length;n<r;n++)i=i.concat(this.intersectOctreeObject(t[n],e));return i};var $h=function(t,e){this.cubeLods=t,this.numLods=e;var n=4*t[0].width,r=t[0].texture,i={format:r.format,magFilter:r.magFilter,minFilter:r.minFilter,type:r.type,generateMipmaps:r.generateMipmaps,anisotropy:r.anisotropy,encoding:r.encoding===Bs?Vs:r.encoding};i.encoding===Vs&&(i.magFilter=ja,i.minFilter=ja),this.CubeUVRenderTarget=new pt(n,n,i),this.CubeUVRenderTarget.texture.name="PMREMCubeUVPacker.cubeUv",this.CubeUVRenderTarget.texture.mapping=Na,this.camera=new ct(.5*-n,.5*n,.5*-n,.5*n,0,1e3),this.scene=new ut,this.scene.add(this.camera),this.objects=[];var o=[];o.push(new m(0,0)),o.push(new m(1,0)),o.push(new m(2,0)),o.push(new m(0,1)),o.push(new m(1,1)),o.push(new m(2,1));var a=n;n=t[0].width;var s=0,l=4;this.numLods=Math.log(t[0].width)/Math.log(2)-2;for(var u=0;u<this.numLods;u++){var c=.5*(a-a/l);n>16&&(l*=2);for(var h=n>16?6:1,p=0,d=0,f=n,v=0;v<h;v++){for(var g=0;g<6;g++){var y=this.getShader();y.uniforms.envMap.value=this.cubeLods[u].texture,y.envMap=this.cubeLods[u].texture,y.uniforms.faceIndex.value=g,y.uniforms.mapSize.value=f;var b=new B(new ft(f,f,0),y);b.position.x=o[g].x*f-c+p,b.position.y=o[g].y*f-c+s+d,b.material.side=ko,this.scene.add(b),this.objects.push(b)}d+=1.75*f,p+=1.25*f,f/=2}s+=2*n,n>16&&(n/=2)}};$h.prototype={constructor:$h,update:function(t){var e=t.gammaInput,n=t.gammaOutput,r=t.toneMapping,i=t.toneMappingExposure,o=t.getRenderTarget();t.gammaInput=!1,t.gammaOutput=!1,t.toneMapping=xa,t.toneMappingExposure=1,t.render(this.scene,this.camera,this.CubeUVRenderTarget,!1),t.setRenderTarget(o),t.toneMapping=r,t.toneMappingExposure=i,t.gammaInput=e,t.gammaOutput=n},getShader:function(){return new dt({uniforms:{faceIndex:{value:0},mapSize:{value:0},envMap:{value:null},testColor:{value:new i(1,1,1)}},vertexShader:"precision highp float;\t\t\t\tvarying vec2 vUv;\t\t\t\tvoid main() {\t\t\t\t\tvUv = uv;\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\t\t\t\t}",fragmentShader:"precision highp float;\t\t\t\tvarying vec2 vUv;\t\t\t\tuniform samplerCube envMap;\t\t\t\tuniform float mapSize;\t\t\t\tuniform vec3 testColor;\t\t\t\tuniform int faceIndex;\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tvec3 sampleDirection;\t\t\t\t\tvec2 uv = vUv;\t\t\t\t\tuv = uv * 2.0 - 1.0;\t\t\t\t\tuv.y *= -1.0;\t\t\t\t\tif(faceIndex == 0) {\t\t\t\t\t\tsampleDirection = normalize(vec3(1.0, uv.y, -uv.x));\t\t\t\t\t} else if(faceIndex == 1) {\t\t\t\t\t\tsampleDirection = normalize(vec3(uv.x, 1.0, uv.y));\t\t\t\t\t} else if(faceIndex == 2) {\t\t\t\t\t\tsampleDirection = normalize(vec3(uv.x, uv.y, 1.0));\t\t\t\t\t} else if(faceIndex == 3) {\t\t\t\t\t\tsampleDirection = normalize(vec3(-1.0, uv.y, uv.x));\t\t\t\t\t} else if(faceIndex == 4) {\t\t\t\t\t\tsampleDirection = normalize(vec3(uv.x, -1.0, -uv.y));\t\t\t\t\t} else {\t\t\t\t\t\tsampleDirection = normalize(vec3(-uv.x, uv.y, -1.0));\t\t\t\t\t}\t\t\t\t\tvec4 color = envMapTexelToLinear( textureCube( envMap, sampleDirection ) );\t\t\t\t\tgl_FragColor = linearToOutputTexel( color );\t\t\t\t}",blending:Xo,premultipliedAlpha:!1,blendSrc:$o,blendDst:Ko,blendSrcAlpha:$o,blendDstAlpha:Ko,blendEquation:Yo})}},(Ln.prototype=Object.create(pt.prototype)).constructor=Ln,Ln.prototype.isWebGLRenderTargetCube=!0;var tp=function(t,e,n){this.sourceTexture=t,this.resolution=void 0!==n?n:256,this.samplesPerLevel=void 0!==e?e:16;var r=t.encoding===ks||t.encoding===js||t.encoding===Us;this.sourceTexture.minFilter=r?ja:Ra,this.sourceTexture.magFilter=r?ja:Ra,this.sourceTexture.generateMipmaps=this.sourceTexture.generateMipmaps&&r,this.cubeLods=[];var i=this.resolution,o={format:this.sourceTexture.format,magFilter:this.sourceTexture.magFilter,minFilter:this.sourceTexture.minFilter,type:this.sourceTexture.type,generateMipmaps:this.sourceTexture.generateMipmaps,anisotropy:this.sourceTexture.anisotropy,encoding:this.sourceTexture.encoding};this.numLods=Math.log(i)/Math.log(2)-2;for(var a=0;a<this.numLods;a++){var s=new Ln(i,i,o);s.texture.name="PMREMGenerator.cube"+a,this.cubeLods.push(s),i=Math.max(16,i/2)}this.camera=new ct(-1,1,1,-1,0,1e3),this.shader=this.getShader(),this.shader.defines.SAMPLES_PER_LEVEL=this.samplesPerLevel,this.planeMesh=new B(new ft(2,2,0),this.shader),this.planeMesh.material.side=ko,this.scene=new ut,this.scene.add(this.planeMesh),this.scene.add(this.camera),this.shader.uniforms.envMap.value=this.sourceTexture,this.shader.envMap=this.sourceTexture};tp.prototype={constructor:tp,update:function(t){this.shader.uniforms.envMap.value=this.sourceTexture,this.shader.envMap=this.sourceTexture;var e=t.gammaInput,n=t.gammaOutput,r=t.toneMapping,i=t.toneMappingExposure,o=t.getRenderTarget();t.toneMapping=xa,t.toneMappingExposure=1,t.gammaInput=!1,t.gammaOutput=!1;for(var a=0;a<this.numLods;a++){this.shader.uniforms.roughness.value=.9*(a/(this.numLods-1)),this.shader.uniforms.queryScale.value.x=0==a?-1:1;this.shader.uniforms.mapSize.value=this.cubeLods[a].width,this.renderToCubeMapTarget(t,this.cubeLods[a]),a<5&&(this.shader.uniforms.envMap.value=this.cubeLods[a].texture)}t.setRenderTarget(o),t.toneMapping=r,t.toneMappingExposure=i,t.gammaInput=e,t.gammaOutput=n},renderToCubeMapTarget:function(t,e){for(var n=0;n<6;n++)this.renderToCubeMapTargetFace(t,e,n)},renderToCubeMapTargetFace:function(t,e,n){e.activeCubeFace=n,this.shader.uniforms.faceIndex.value=n,t.render(this.scene,this.camera,e,!0)},getShader:function(){return new dt({defines:{SAMPLES_PER_LEVEL:20},uniforms:{faceIndex:{value:0},roughness:{value:.5},mapSize:{value:.5},envMap:{value:null},queryScale:{value:new i(1,1,1)},testColor:{value:new i(1,1,1)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform int faceIndex;\n\t\t\t\tuniform float roughness;\n\t\t\t\tuniform samplerCube envMap;\n\t\t\t\tuniform float mapSize;\n\t\t\t\tuniform vec3 testColor;\n\t\t\t\tuniform vec3 queryScale;\n\t\t\t\t\n\t\t\t\tfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\t\t\t\t\tfloat a = ggxRoughness + 0.0001;\n\t\t\t\t\ta *= a;\n\t\t\t\t\treturn ( 2.0 / a - 2.0 );\n\t\t\t\t}\n\t\t\t\tvec3 ImportanceSamplePhong(vec2 uv, mat3 vecSpace, float specPow) {\n\t\t\t\t\tfloat phi = uv.y * 2.0 * PI;\n\t\t\t\t\tfloat cosTheta = pow(1.0 - uv.x, 1.0 / (specPow + 1.0));\n\t\t\t\t\tfloat sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n\t\t\t\t\tvec3 sampleDir = vec3(cos(phi) * sinTheta, sin(phi) * sinTheta, cosTheta);\n\t\t\t\t\treturn vecSpace * sampleDir;\n\t\t\t\t}\n\t\t\t\tvec3 ImportanceSampleGGX( vec2 uv, mat3 vecSpace, float Roughness )\n\t\t\t\t{\n\t\t\t\t\tfloat a = Roughness * Roughness;\n\t\t\t\t\tfloat Phi = 2.0 * PI * uv.x;\n\t\t\t\t\tfloat CosTheta = sqrt( (1.0 - uv.y) / ( 1.0 + (a*a - 1.0) * uv.y ) );\n\t\t\t\t\tfloat SinTheta = sqrt( 1.0 - CosTheta * CosTheta );\n\t\t\t\t\treturn vecSpace * vec3(SinTheta * cos( Phi ), SinTheta * sin( Phi ), CosTheta);\n\t\t\t\t}\n\t\t\t\tmat3 matrixFromVector(vec3 n) {\n\t\t\t\t\tfloat a = 1.0 / (1.0 + n.z);\n\t\t\t\t\tfloat b = -n.x * n.y * a;\n\t\t\t\t\tvec3 b1 = vec3(1.0 - n.x * n.x * a, b, -n.x);\n\t\t\t\t\tvec3 b2 = vec3(b, 1.0 - n.y * n.y * a, -n.y);\n\t\t\t\t\treturn mat3(b1, b2, n);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvec4 testColorMap(float Roughness) {\n\t\t\t\t\tvec4 color;\n\t\t\t\t\tif(faceIndex == 0)\n\t\t\t\t\t\tcolor = vec4(1.0,0.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 1)\n\t\t\t\t\t\tcolor = vec4(0.0,1.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 2)\n\t\t\t\t\t\tcolor = vec4(0.0,0.0,1.0,1.0);\n\t\t\t\t\telse if(faceIndex == 3)\n\t\t\t\t\t\tcolor = vec4(1.0,1.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 4)\n\t\t\t\t\t\tcolor = vec4(0.0,1.0,1.0,1.0);\n\t\t\t\t\telse\n\t\t\t\t\t\tcolor = vec4(1.0,0.0,1.0,1.0);\n\t\t\t\t\tcolor *= ( 1.0 - Roughness );\n\t\t\t\t\treturn color;\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec3 sampleDirection;\n\t\t\t\t\tvec2 uv = vUv*2.0 - 1.0;\n\t\t\t\t\tfloat offset = -1.0/mapSize;\n\t\t\t\t\tconst float a = -1.0;\n\t\t\t\t\tconst float b = 1.0;\n\t\t\t\t\tfloat c = -1.0 + offset;\n\t\t\t\t\tfloat d = 1.0 - offset;\n\t\t\t\t\tfloat bminusa = b - a;\n\t\t\t\t\tuv.x = (uv.x - a)/bminusa * d - (uv.x - b)/bminusa * c;\n\t\t\t\t\tuv.y = (uv.y - a)/bminusa * d - (uv.y - b)/bminusa * c;\n\t\t\t\t\tif (faceIndex==0) {\n\t\t\t\t\t\tsampleDirection = vec3(1.0, -uv.y, -uv.x);\n\t\t\t\t\t} else if (faceIndex==1) {\n\t\t\t\t\t\tsampleDirection = vec3(-1.0, -uv.y, uv.x);\n\t\t\t\t\t} else if (faceIndex==2) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, 1.0, uv.y);\n\t\t\t\t\t} else if (faceIndex==3) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, -1.0, -uv.y);\n\t\t\t\t\t} else if (faceIndex==4) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, -uv.y, 1.0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsampleDirection = vec3(-uv.x, -uv.y, -1.0);\n\t\t\t\t\t}\n\t\t\t\t\tmat3 vecSpace = matrixFromVector(normalize(sampleDirection * queryScale));\n\t\t\t\t\tvec3 rgbColor = vec3(0.0);\n\t\t\t\t\tconst int NumSamples = SAMPLES_PER_LEVEL;\n\t\t\t\t\tvec3 vect;\n\t\t\t\t\tfloat weight = 0.0;\n\t\t\t\t\tfor( int i = 0; i < NumSamples; i ++ ) {\n\t\t\t\t\t\tfloat sini = sin(float(i));\n\t\t\t\t\t\tfloat cosi = cos(float(i));\n\t\t\t\t\t\tfloat r = rand(vec2(sini, cosi));\n\t\t\t\t\t\tvect = ImportanceSampleGGX(vec2(float(i) / float(NumSamples), r), vecSpace, roughness);\n\t\t\t\t\t\tfloat dotProd = dot(vect, normalize(sampleDirection));\n\t\t\t\t\t\tweight += dotProd;\n\t\t\t\t\t\tvec3 color = envMapTexelToLinear(textureCube(envMap,vect)).rgb;\n\t\t\t\t\t\trgbColor.rgb += color;\n\t\t\t\t\t}\n\t\t\t\t\trgbColor /= float(NumSamples);\n\t\t\t\t\t//rgbColor = testColorMap( roughness ).rgb;\n\t\t\t\t\tgl_FragColor = linearToOutputTexel( vec4( rgbColor, 1.0 ) );\n\t\t\t\t}",blending:Xo,blendSrc:$o,blendDst:Ko,blendSrcAlpha:$o,blendDstAlpha:Ko,blendEquation:Yo})}};var ep={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")},np={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","float l = linearToRelativeLuminance( texel.rgb );","gl_FragColor = vec4( l, l, l, texel.w );","}"].join("\n")},rp={uniforms:{tDiffuse:{value:null},averageLuminance:{value:1},luminanceMap:{value:null},maxLuminance:{value:16},minLuminance:{value:.01},middleGrey:{value:.6}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform sampler2D tDiffuse;","varying vec2 vUv;","uniform float middleGrey;","uniform float minLuminance;","uniform float maxLuminance;","#ifdef ADAPTED_LUMINANCE","uniform sampler2D luminanceMap;","#else","uniform float averageLuminance;","#endif","vec3 ToneMap( vec3 vColor ) {","#ifdef ADAPTED_LUMINANCE","float fLumAvg = texture2D(luminanceMap, vec2(0.5, 0.5)).r;","#else","float fLumAvg = averageLuminance;","#endif","float fLumPixel = linearToRelativeLuminance( vColor );","float fLumScaled = (fLumPixel * middleGrey) / max( minLuminance, fLumAvg );","float fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (maxLuminance * maxLuminance)))) / (1.0 + fLumScaled);","return fLumCompressed * vColor;","}","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = vec4( ToneMap( texel.xyz ), texel.w );","}"].join("\n")},ip=function(t,e){Ch.call(this),this.resolution=void 0!==e?e:256,this.needsInit=!0,this.adaptive=void 0===t||!!t,this.luminanceRT=null,this.previousLuminanceRT=null,this.currentLuminanceRT=null,void 0===ep&&console.error("AdaptiveToneMappingPass relies on CopyShader");var n=ep;this.copyUniforms=tl.clone(n.uniforms),this.materialCopy=new dt({uniforms:this.copyUniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,blending:zo,depthTest:!1}),void 0===np&&console.error("AdaptiveToneMappingPass relies on LuminosityShader"),this.materialLuminance=new dt({uniforms:tl.clone(np.uniforms),vertexShader:np.vertexShader,fragmentShader:np.fragmentShader,blending:zo}),this.adaptLuminanceShader={defines:{MIP_LEVEL_1X1:(Math.log(this.resolution)/Math.log(2)).toFixed(1)},uniforms:{lastLum:{value:null},currentLum:{value:null},minLuminance:{value:.01},delta:{value:.016},tau:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform sampler2D lastLum;","uniform sampler2D currentLum;","uniform float minLuminance;","uniform float delta;","uniform float tau;","void main() {","vec4 lastLum = texture2D( lastLum, vUv, MIP_LEVEL_1X1 );","vec4 currentLum = texture2D( currentLum, vUv, MIP_LEVEL_1X1 );","float fLastLum = max( minLuminance, lastLum.r );","float fCurrentLum = max( minLuminance, currentLum.r );","fCurrentLum *= fCurrentLum;","float fAdaptedLum = fLastLum + (fCurrentLum - fLastLum) * (1.0 - exp(-delta * tau));","gl_FragColor.r = fAdaptedLum;","}"].join("\n")},this.materialAdaptiveLum=new dt({uniforms:tl.clone(this.adaptLuminanceShader.uniforms),vertexShader:this.adaptLuminanceShader.vertexShader,fragmentShader:this.adaptLuminanceShader.fragmentShader,defines:Object.assign({},this.adaptLuminanceShader.defines),blending:zo}),void 0===rp&&console.error("AdaptiveToneMappingPass relies on ToneMapShader"),this.materialToneMap=new dt({uniforms:tl.clone(rp.uniforms),vertexShader:rp.vertexShader,fragmentShader:rp.fragmentShader,blending:zo}),this.camera=new ct(-1,1,1,-1,0,1),this.scene=new ut,this.quad=new B(new mt(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};ip.prototype=Object.assign(Object.create(Ch.prototype),{constructor:ip,render:function(t,e,n,r,i){this.needsInit&&(this.reset(t),this.luminanceRT.texture.type=n.texture.type,this.previousLuminanceRT.texture.type=n.texture.type,this.currentLuminanceRT.texture.type=n.texture.type,this.needsInit=!1),this.adaptive&&(this.quad.material=this.materialLuminance,this.materialLuminance.uniforms.tDiffuse.value=n.texture,t.render(this.scene,this.camera,this.currentLuminanceRT),this.quad.material=this.materialAdaptiveLum,this.materialAdaptiveLum.uniforms.delta.value=r,this.materialAdaptiveLum.uniforms.lastLum.value=this.previousLuminanceRT.texture,this.materialAdaptiveLum.uniforms.currentLum.value=this.currentLuminanceRT.texture,t.render(this.scene,this.camera,this.luminanceRT),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.luminanceRT.texture,t.render(this.scene,this.camera,this.previousLuminanceRT)),this.quad.material=this.materialToneMap,this.materialToneMap.uniforms.tDiffuse.value=n.texture,this.renderToScreen?t.render(this.scene,this.camera):t.render(this.scene,this.camera,e,this.clear)},reset:function(t){this.luminanceRT&&this.luminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose();var e={minFilter:ja,magFilter:ja,format:ns};this.luminanceRT=new pt(this.resolution,this.resolution,e),this.luminanceRT.texture.name="AdaptiveToneMappingPass.l",this.luminanceRT.texture.generateMipmaps=!1,this.previousLuminanceRT=new pt(this.resolution,this.resolution,e),this.previousLuminanceRT.texture.name="AdaptiveToneMappingPass.pl",this.previousLuminanceRT.texture.generateMipmaps=!1,e.minFilter=za,this.currentLuminanceRT=new pt(this.resolution,this.resolution,e),this.currentLuminanceRT.texture.name="AdaptiveToneMappingPass.cl",this.adaptive&&(this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture),this.quad.material=new D({color:7829367}),this.materialLuminance.needsUpdate=!0,this.materialAdaptiveLum.needsUpdate=!0,this.materialToneMap.needsUpdate=!0},setAdaptive:function(t){t?(this.adaptive=!0,this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture):(this.adaptive=!1,delete this.materialToneMap.defines.ADAPTED_LUMINANCE,this.materialToneMap.uniforms.luminanceMap.value=null),this.materialToneMap.needsUpdate=!0},setAdaptionRate:function(t){t&&(this.materialAdaptiveLum.uniforms.tau.value=Math.abs(t))},setMinLuminance:function(t){t&&(this.materialToneMap.uniforms.minLuminance.value=t,this.materialAdaptiveLum.uniforms.minLuminance.value=t)},setMaxLuminance:function(t){t&&(this.materialToneMap.uniforms.maxLuminance.value=t)},setAverageLuminance:function(t){t&&(this.materialToneMap.uniforms.averageLuminance.value=t)},setMiddleGrey:function(t){t&&(this.materialToneMap.uniforms.middleGrey.value=t)},dispose:function(){this.luminanceRT&&this.luminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.materialLuminance&&this.materialLuminance.dispose(),this.materialAdaptiveLum&&this.materialAdaptiveLum.dispose(),this.materialCopy&&this.materialCopy.dispose(),this.materialToneMap&&this.materialToneMap.dispose()}});var op={defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{value:null},uImageIncrement:{value:new m(.001953125,0)},cKernel:{value:[]}},vertexShader:["uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","vUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float cKernel[ KERNEL_SIZE_INT ];","uniform sampler2D tDiffuse;","uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","vec2 imageCoord = vUv;","vec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );","for( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {","sum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];","imageCoord += uImageIncrement;","}","gl_FragColor = sum;","}"].join("\n"),buildKernel:function(t){function e(t,e){return Math.exp(-t*t/(2*e*e))}var n,r,i,o,a=2*Math.ceil(3*t)+1;for(a>25&&(a=25),o=.5*(a-1),r=new Array(a),i=0,n=0;n<a;++n)r[n]=e(n-o,t),i+=r[n];for(n=0;n<a;++n)r[n]/=i;return r}},ap=function(t,e,n,r){Ch.call(this),t=void 0!==t?t:1,e=void 0!==e?e:25,n=void 0!==n?n:4;var i={minFilter:ja,magFilter:ja,format:ns};this.renderTargetX=new pt(r=void 0!==r?r:256,r,i),this.renderTargetX.texture.name="BloomPass.x",this.renderTargetY=new pt(r,r,i),this.renderTargetY.texture.name="BloomPass.y",void 0===ep&&console.error("BloomPass relies on CopyShader");var o=ep;this.copyUniforms=tl.clone(o.uniforms),this.copyUniforms.opacity.value=t,this.materialCopy=new dt({uniforms:this.copyUniforms,vertexShader:o.vertexShader,fragmentShader:o.fragmentShader,blending:Go,transparent:!0}),void 0===op&&console.error("BloomPass relies on ConvolutionShader");var a=op;this.convolutionUniforms=tl.clone(a.uniforms),this.convolutionUniforms.uImageIncrement.value=ap.blurX,this.convolutionUniforms.cKernel.value=op.buildKernel(n),this.materialConvolution=new dt({uniforms:this.convolutionUniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,defines:{KERNEL_SIZE_FLOAT:e.toFixed(1),KERNEL_SIZE_INT:e.toFixed(0)}}),this.needsSwap=!1,this.camera=new ct(-1,1,1,-1,0,1),this.scene=new ut,this.quad=new B(new mt(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};ap.prototype=Object.assign(Object.create(Ch.prototype),{constructor:ap,render:function(t,e,n,r,i){i&&t.context.disable(t.context.STENCIL_TEST),this.quad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=n.texture,this.convolutionUniforms.uImageIncrement.value=ap.blurX,t.render(this.scene,this.camera,this.renderTargetX,!0),this.convolutionUniforms.tDiffuse.value=this.renderTargetX.texture,this.convolutionUniforms.uImageIncrement.value=ap.blurY,t.render(this.scene,this.camera,this.renderTargetY,!0),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetY.texture,i&&t.context.enable(t.context.STENCIL_TEST),t.render(this.scene,this.camera,n,this.clear)}}),ap.blurX=new m(.001953125,0),ap.blurY=new m(0,.001953125);var sp=function(t,e,n){Ch.call(this),this.scene=t,this.camera=e;var r=void 0!==n.focus?n.focus:1,i=void 0!==n.aspect?n.aspect:e.aspect,o=void 0!==n.aperture?n.aperture:.025,a=void 0!==n.maxblur?n.maxblur:1,s=n.width||window.innerWidth||1,l=n.height||window.innerHeight||1;this.renderTargetColor=new pt(s,l,{minFilter:ja,magFilter:ja,format:es}),this.renderTargetColor.texture.name="BokehPass.color",this.renderTargetDepth=this.renderTargetColor.clone(),this.renderTargetDepth.texture.name="BokehPass.depth",this.materialDepth=new lt,this.materialDepth.depthPacking=Ws,this.materialDepth.blending=zo,void 0===el&&console.error("BokehPass relies on BokehShader");var u=el,c=tl.clone(u.uniforms);c.tDepth.value=this.renderTargetDepth.texture,c.focus.value=r,c.aspect.value=i,c.aperture.value=o,c.maxblur.value=a,c.nearClip.value=e.near,c.farClip.value=e.far,this.materialBokeh=new dt({defines:Object.assign({},u.defines),uniforms:c,vertexShader:u.vertexShader,fragmentShader:u.fragmentShader}),this.uniforms=c,this.needsSwap=!1,this.camera2=new ct(-1,1,1,-1,0,1),this.scene2=new ut,this.quad2=new B(new mt(2,2),null),this.quad2.frustumCulled=!1,this.scene2.add(this.quad2),this.oldClearColor=new h,this.oldClearAlpha=1};sp.prototype=Object.assign(Object.create(Ch.prototype),{constructor:sp,render:function(t,e,n,r,i){this.quad2.material=this.materialBokeh,this.scene.overrideMaterial=this.materialDepth,this.oldClearColor.copy(t.getClearColor()),this.oldClearAlpha=t.getClearAlpha();t.autoClear=!1,t.setClearColor(16777215),t.setClearAlpha(1),t.render(this.scene,this.camera,this.renderTargetDepth,!0),this.uniforms.tColor.value=n.texture,this.uniforms.nearClip.value=this.camera.near,this.uniforms.farClip.value=this.camera.far,this.renderToScreen?t.render(this.scene2,this.camera2):t.render(this.scene2,this.camera2,e,this.clear),this.scene.overrideMaterial=null,t.setClearColor(this.oldClearColor),t.setClearAlpha(this.oldClearAlpha),t.autoClear=this.oldAutoClear}});var lp=function(t,e){Ch.call(this),this.needsSwap=!1,this.clearColor=void 0!==t?t:0,this.clearAlpha=void 0!==e?e:0};lp.prototype=Object.assign(Object.create(Ch.prototype),{constructor:lp,render:function(t,e,n,r,i){var o,a;this.clearColor&&(o=t.getClearColor().getHex(),a=t.getClearAlpha(),t.setClearColor(this.clearColor,this.clearAlpha)),t.setRenderTarget(this.renderToScreen?null:n),t.clear(),this.clearColor&&t.setClearColor(o,a)}});var up=function(t,e,n){Ch.call(this),this.camera=t,this.needsSwap=!1,this.cubeShader=Nl.cube,this.cubeMesh=new B(new H(10,10,10),new dt({uniforms:this.cubeShader.uniforms,vertexShader:this.cubeShader.vertexShader,fragmentShader:this.cubeShader.fragmentShader,depthTest:!1,depthWrite:!1,side:Ro})),this.envMap=e,this.opacity=void 0!==n?n:1,this.cubeScene=new ut,this.cubeCamera=new st,this.cubeScene.add(this.cubeMesh)};up.prototype=Object.assign(Object.create(Ch.prototype),{constructor:up,render:function(t,e,n,r,i){var o=t.autoClear;t.autoClear=!1,this.cubeCamera.projectionMatrix.copy(this.camera.projectionMatrix),this.cubeCamera.quaternion.setFromRotationMatrix(this.camera.matrixWorld),this.cubeMesh.material.uniforms.tCube.value=this.envMap,this.cubeMesh.material.uniforms.opacity.value=this.opacity,this.cubeMesh.material.transparent=this.opacity<1,t.render(this.cubeScene,this.cubeCamera,this.renderToScreen?null:n,this.clear),t.autoClear=o}});var cp={uniforms:{tDiffuse:{value:null},tSize:{value:new m(256,256)},center:{value:new m(.5,.5)},angle:{value:1.57},scale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec2 center;","uniform float angle;","uniform float scale;","uniform vec2 tSize;","uniform sampler2D tDiffuse;","varying vec2 vUv;","float pattern() {","float s = sin( angle ), c = cos( angle );","vec2 tex = vUv * tSize - center;","vec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;","return ( sin( point.x ) * sin( point.y ) ) * 4.0;","}","void main() {","vec4 color = texture2D( tDiffuse, vUv );","float average = ( color.r + color.g + color.b ) / 3.0;","gl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );","}"].join("\n")},hp=function(t,e,n){Ch.call(this),void 0===cp&&console.error("DotScreenPass relies on DotScreenShader");var r=cp;this.uniforms=tl.clone(r.uniforms),void 0!==t&&this.uniforms.center.value.copy(t),void 0!==e&&(this.uniforms.angle.value=e),void 0!==n&&(this.uniforms.scale.value=n),this.material=new dt({uniforms:this.uniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}),this.camera=new ct(-1,1,1,-1,0,1),this.scene=new ut,this.quad=new B(new mt(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};hp.prototype=Object.assign(Object.create(Ch.prototype),{constructor:hp,render:function(t,e,n,r,i){this.uniforms.tDiffuse.value=n.texture,this.uniforms.tSize.value.set(n.width,n.height),this.quad.material=this.material,this.renderToScreen?t.render(this.scene,this.camera):t.render(this.scene,this.camera,e,this.clear)}});var pp=function(t,e){Ch.call(this),this.scene=t,this.camera=e,this.clear=!0,this.needsSwap=!1,this.inverse=!1};pp.prototype=Object.assign(Object.create(Ch.prototype),{constructor:pp,render:function(t,e,n,r,i){var o=t.context,a=t.state;a.buffers.color.setMask(!1),a.buffers.depth.setMask(!1),a.buffers.color.setLocked(!0),a.buffers.depth.setLocked(!0);var s,l;this.inverse?(s=0,l=1):(s=1,l=0),a.buffers.stencil.setTest(!0),a.buffers.stencil.setOp(o.REPLACE,o.REPLACE,o.REPLACE),a.buffers.stencil.setFunc(o.ALWAYS,s,4294967295),a.buffers.stencil.setClear(l),t.render(this.scene,this.camera,n,this.clear),t.render(this.scene,this.camera,e,this.clear),a.buffers.color.setLocked(!1),a.buffers.depth.setLocked(!1),a.buffers.stencil.setFunc(o.EQUAL,1,4294967295),a.buffers.stencil.setOp(o.KEEP,o.KEEP,o.KEEP)}});var dp=function(){Ch.call(this),this.needsSwap=!1};dp.prototype=Object.create(Ch.prototype),Object.assign(dp.prototype,{render:function(t,e,n,r,i){t.state.buffers.stencil.setTest(!1)}});var fp=function(t,e){if(this.renderer=t,void 0===e){var n={minFilter:ja,magFilter:ja,format:ns,stencilBuffer:!1},r=t.getDrawingBufferSize();(e=new pt(r.width,r.height,n)).texture.name="EffectComposer.rt1"}this.renderTarget1=e,this.renderTarget2=e.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.passes=[],void 0===ep&&console.error("EffectComposer relies on CopyShader"),void 0===Eh&&console.error("EffectComposer relies on ShaderPass"),this.copyPass=new Eh(ep)};Object.assign(fp.prototype,{swapBuffers:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t},addPass:function(t){this.passes.push(t);var e=this.renderer.getDrawingBufferSize();t.setSize(e.width,e.height)},insertPass:function(t,e){this.passes.splice(e,0,t)},render:function(t){var e,n,r=!1,i=this.passes.length;for(n=0;n<i;n++)if(!1!==(e=this.passes[n]).enabled){if(e.render(this.renderer,this.writeBuffer,this.readBuffer,t,r),e.needsSwap){if(r){var o=this.renderer.context;o.stencilFunc(o.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),o.stencilFunc(o.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==pp&&(e instanceof pp?r=!0:e instanceof dp&&(r=!1))}},reset:function(t){if(void 0===t){var e=this.renderer.getDrawingBufferSize();(t=this.renderTarget1.clone()).setSize(e.width,e.height)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(t,e){this.renderTarget1.setSize(t,e),this.renderTarget2.setSize(t,e);for(var n=0;n<this.passes.length;n++)this.passes[n].setSize(t,e)}});var mp={uniforms:{tDiffuse:{value:null},time:{value:0},nIntensity:{value:.5},sIntensity:{value:.05},sCount:{value:4096},grayscale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform float time;","uniform bool grayscale;","uniform float nIntensity;","uniform float sIntensity;","uniform float sCount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 cTextureScreen = texture2D( tDiffuse, vUv );","float dx = rand( vUv + time );","vec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx, 0.0, 1.0 );","vec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );","cResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;","cResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );","if( grayscale ) {","cResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );","}","gl_FragColor =  vec4( cResult, cTextureScreen.a );","}"].join("\n")},vp=function(t,e,n,r){Ch.call(this),void 0===mp&&console.error("FilmPass relies on FilmShader");var i=mp;this.uniforms=tl.clone(i.uniforms),this.material=new dt({uniforms:this.uniforms,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader}),void 0!==r&&(this.uniforms.grayscale.value=r),void 0!==t&&(this.uniforms.nIntensity.value=t),void 0!==e&&(this.uniforms.sIntensity.value=e),void 0!==n&&(this.uniforms.sCount.value=n),this.camera=new ct(-1,1,1,-1,0,1),this.scene=new ut,this.quad=new B(new mt(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};vp.prototype=Object.assign(Object.create(Ch.prototype),{constructor:vp,render:function(t,e,n,r,i){this.uniforms.tDiffuse.value=n.texture,this.uniforms.time.value+=r,this.quad.material=this.material,this.renderToScreen?t.render(this.scene,this.camera):t.render(this.scene,this.camera,e,this.clear)}});var gp={uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform int byp;","uniform sampler2D tDiffuse;","uniform sampler2D tDisp;","uniform float amount;","uniform float angle;","uniform float seed;","uniform float seed_x;","uniform float seed_y;","uniform float distortion_x;","uniform float distortion_y;","uniform float col_s;","varying vec2 vUv;","float rand(vec2 co){","return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);","}","void main() {","if(byp<1) {","vec2 p = vUv;","float xs = floor(gl_FragCoord.x / 0.5);","float ys = floor(gl_FragCoord.y / 0.5);","vec4 normal = texture2D (tDisp, p*seed*seed);","if(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {","if(seed_x>0.){","p.y = 1. - (p.y + distortion_y);","}","else {","p.y = distortion_y;","}","}","if(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {","if(seed_y>0.){","p.x=distortion_x;","}","else {","p.x = 1. - (p.x + distortion_x);","}","}","p.x+=normal.x*seed_x*(seed/5.);","p.y+=normal.y*seed_y*(seed/5.);","vec2 offset = amount * vec2( cos(angle), sin(angle));","vec4 cr = texture2D(tDiffuse, p + offset);","vec4 cga = texture2D(tDiffuse, p);","vec4 cb = texture2D(tDiffuse, p - offset);","gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);","vec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);","gl_FragColor = gl_FragColor+ snow;","}","else {","gl_FragColor=texture2D (tDiffuse, vUv);","}","}"].join("\n")},yp=function(t){Ch.call(this),void 0===gp&&console.error("GlitchPass relies on DigitalGlitch");var e=gp;this.uniforms=tl.clone(e.uniforms),void 0==t&&(t=64),this.uniforms.tDisp.value=this.generateHeightmap(t),this.material=new dt({uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader}),this.camera=new ct(-1,1,1,-1,0,1),this.scene=new ut,this.quad=new B(new mt(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.goWild=!1,this.curF=0,this.generateTrigger()};yp.prototype=Object.assign(Object.create(Ch.prototype),{constructor:yp,render:function(t,e,n,r,i){this.uniforms.tDiffuse.value=n.texture,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this.curF%this.randX==0||1==this.goWild?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=xo.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=xo.randFloat(-1,1),this.uniforms.seed_y.value=xo.randFloat(-1,1),this.uniforms.distortion_x.value=xo.randFloat(0,1),this.uniforms.distortion_y.value=xo.randFloat(0,1),this.curF=0,this.generateTrigger()):this.curF%this.randX<this.randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=xo.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=xo.randFloat(0,1),this.uniforms.distortion_y.value=xo.randFloat(0,1),this.uniforms.seed_x.value=xo.randFloat(-.3,.3),this.uniforms.seed_y.value=xo.randFloat(-.3,.3)):0==this.goWild&&(this.uniforms.byp.value=1),this.curF++,this.quad.material=this.material,this.renderToScreen?t.render(this.scene,this.camera):t.render(this.scene,this.camera,e,this.clear)},generateTrigger:function(){this.randX=xo.randInt(120,240)},generateHeightmap:function(t){for(var e=new Float32Array(t*t*3),n=t*t,r=0;r<n;r++){var i=xo.randFloat(0,1);e[3*r+0]=i,e[3*r+1]=i,e[3*r+2]=i}var o=new ye(e,t,t,es,qa);return o.needsUpdate=!0,o}});var bp=function(t,e,n,i){this.renderScene=e,this.renderCamera=n,this.selectedObjects=void 0!==i?i:[],this.visibleEdgeColor=new h(1,1,1),this.hiddenEdgeColor=new h(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,Ch.call(this),this.resolution=void 0!==t?new m(t.x,t.y):new m(256,256);var o={minFilter:ja,magFilter:ja,format:ns},a=Math.round(this.resolution.x/this.downSampleRatio),s=Math.round(this.resolution.y/this.downSampleRatio);this.maskBufferMaterial=new D({color:16777215}),this.maskBufferMaterial.side=ko,this.renderTargetMaskBuffer=new pt(this.resolution.x,this.resolution.y,o),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new lt,this.depthMaterial.side=ko,this.depthMaterial.depthPacking=Ws,this.depthMaterial.blending=zo,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=ko,this.prepareMaskMaterial.fragmentShader=function(t,e){return t.replace(/DEPTH_TO_VIEW_Z/g,(e.isPerspectiveCamera?"perspective":"orthographic")+"DepthToViewZ")}(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new pt(this.resolution.x,this.resolution.y,o),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new pt(a,s,o),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new pt(a,s,o),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new pt(Math.round(a/2),Math.round(s/2),o),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new pt(a,s,o),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new pt(Math.round(a/2),Math.round(s/2),o),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1;this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value=new m(a,s),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value=new m(Math.round(a/2),Math.round(s/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial(),void 0===ep&&console.error("OutlinePass relies on CopyShader");var l=ep;this.copyUniforms=tl.clone(l.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new dt({uniforms:this.copyUniforms,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader,blending:zo,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new h,this.oldClearAlpha=1,this.camera=new ct(-1,1,1,-1,0,1),this.scene=new ut,this.quad=new B(new mt(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.tempPulseColor1=new h,this.tempPulseColor2=new h,this.textureMatrix=new r};bp.prototype=Object.assign(Object.create(Ch.prototype),{constructor:bp,dispose:function(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()},setSize:function(t,e){this.renderTargetMaskBuffer.setSize(t,e);var n=Math.round(t/this.downSampleRatio),r=Math.round(e/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(n,r),this.renderTargetBlurBuffer1.setSize(n,r),this.renderTargetEdgeBuffer1.setSize(n,r),this.separableBlurMaterial1.uniforms.texSize.value=new m(n,r),n=Math.round(n/2),r=Math.round(r/2),this.renderTargetBlurBuffer2.setSize(n,r),this.renderTargetEdgeBuffer2.setSize(n,r),this.separableBlurMaterial2.uniforms.texSize.value=new m(n,r)},changeVisibilityOfSelectedObjects:function(t){function e(e){e instanceof B&&(e.visible=t)}for(var n=0;n<this.selectedObjects.length;n++){this.selectedObjects[n].traverse(e)}},changeVisibilityOfNonSelectedObjects:function(t){function e(t){t instanceof B&&n.push(t)}for(var n=[],r=0;r<this.selectedObjects.length;r++){this.selectedObjects[r].traverse(e)}this.renderScene.traverse(function(e){if(e instanceof B||e instanceof z||e instanceof Sn){for(var r=!1,i=0;i<n.length;i++)if(n[i].id===e.id){r=!0;break}if(!r){var o=e.visible;t&&!e.bVisible||(e.visible=t),e.bVisible=o}}})},updateTextureMatrix:function(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)},render:function(t,e,n,r,i){if(0!==this.selectedObjects.length){this.oldClearColor.copy(t.getClearColor()),this.oldClearAlpha=t.getClearAlpha();var o=t.autoClear;t.autoClear=!1,i&&t.context.disable(t.context.STENCIL_TEST),t.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);var a=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,t.render(this.renderScene,this.renderCamera,this.renderTargetDepthBuffer,!0),this.changeVisibilityOfSelectedObjects(!0),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value=new m(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,t.render(this.renderScene,this.renderCamera,this.renderTargetMaskBuffer,!0),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this.renderScene.background=a,this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,t.render(this.scene,this.camera,this.renderTargetMaskDownSampleBuffer,!0),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){var s=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(s),this.tempPulseColor2.multiplyScalar(s)}this.quad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value=new m(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,t.render(this.scene,this.camera,this.renderTargetEdgeBuffer1,!0),this.quad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=bp.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,t.render(this.scene,this.camera,this.renderTargetBlurBuffer1,!0),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=bp.BlurDirectionY,t.render(this.scene,this.camera,this.renderTargetEdgeBuffer1,!0),this.quad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=bp.BlurDirectionX,t.render(this.scene,this.camera,this.renderTargetBlurBuffer2,!0),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=bp.BlurDirectionY,t.render(this.scene,this.camera,this.renderTargetEdgeBuffer2,!0),this.quad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,i&&t.context.enable(t.context.STENCIL_TEST),t.render(this.scene,this.camera,n,!1),t.setClearColor(this.oldClearColor,this.oldClearAlpha),t.autoClear=o}},getPrepareMaskMaterial:function(){return new dt({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new m(.5,.5)},textureMatrix:{value:new r}},vertexShader:["varying vec4 projTexCoord;","varying vec4 vPosition;","uniform mat4 textureMatrix;","void main() {","\tvPosition = modelViewMatrix * vec4( position, 1.0 );","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tprojTexCoord = textureMatrix * worldPosition;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <packing>","varying vec4 vPosition;","varying vec4 projTexCoord;","uniform sampler2D depthTexture;","uniform vec2 cameraNearFar;","void main() {","\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));","\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );","\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;","\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);","}"].join("\n")})},getEdgeDetectionMaterial:function(){return new dt({uniforms:{maskTexture:{value:null},texSize:{value:new m(.5,.5)},visibleEdgeColor:{value:new i(1,1,1)},hiddenEdgeColor:{value:new i(1,1,1)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec3 visibleEdgeColor;\t\t\t\tuniform vec3 hiddenEdgeColor;\t\t\t\t\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\t\t\t\t}"})},getSeperableBlurMaterial:function(t){return new dt({defines:{MAX_RADIUS:t},uniforms:{colorTexture:{value:null},texSize:{value:new m(.5,.5)},direction:{value:new m(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\t\t\t\tuniform sampler2D colorTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\tuniform float kernelRadius;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, kernelRadius);\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\t\t\t\t\tvec2 uvOffset = delta;\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\t\t\t\t\t\tfloat w = gaussianPdf(uvOffset.x, kernelRadius);\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\t\t\t\t\t\tweightSum += (2.0 * w);\t\t\t\t\t\tuvOffset += delta;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\t\t\t\t}"})},getOverlayMaterial:function(){return new dt({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform sampler2D edgeTexture1;\t\t\t\tuniform sampler2D edgeTexture2;\t\t\t\tuniform sampler2D patternTexture;\t\t\t\tuniform float edgeStrength;\t\t\t\tuniform float edgeGlow;\t\t\t\tuniform bool usePatternTexture;\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\t\t\t\t\tif(usePatternTexture)\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\t\t\t\t\tgl_FragColor = finalColor;\t\t\t\t}",blending:Go,depthTest:!1,depthWrite:!1,transparent:!0})}}),bp.BlurDirectionX=new m(1,0),bp.BlurDirectionY=new m(0,1);var _p=function(t,e,n,r,i){Ch.call(this),this.scene=t,this.camera=e,this.overrideMaterial=n,this.clearColor=r,this.clearAlpha=void 0!==i?i:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1};_p.prototype=Object.assign(Object.create(Ch.prototype),{constructor:_p,render:function(t,e,n,r,i){var o=t.autoClear;t.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial;var a,s;this.clearColor&&(a=t.getClearColor().getHex(),s=t.getClearAlpha(),t.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&t.clearDepth(),t.render(this.scene,this.camera,this.renderToScreen?null:n,this.clear),this.clearColor&&t.setClearColor(a,s),this.scene.overrideMaterial=null,t.autoClear=o}}),(In.prototype=Object.create(ht.prototype)).constructor=In,In.prototype.isDepthTexture=!0;var xp={defines:{NUM_SAMPLES:7,NUM_RINGS:4,NORMAL_TEXTURE:0,DIFFUSE_TEXTURE:0,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{type:"t",value:null},tDiffuse:{type:"t",value:null},tNormal:{type:"t",value:null},size:{type:"v2",value:new m(512,512)},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},cameraProjectionMatrix:{type:"m4",value:new r},cameraInverseProjectionMatrix:{type:"m4",value:new r},scale:{type:"f",value:1},intensity:{type:"f",value:.1},bias:{type:"f",value:.5},minResolution:{type:"f",value:0},kernelRadius:{type:"f",value:100},randomSeed:{type:"f",value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","#if DIFFUSE_TEXTURE == 1","uniform sampler2D tDiffuse;","#endif","uniform sampler2D tDepth;","#if NORMAL_TEXTURE == 1","uniform sampler2D tNormal;","#endif","uniform float cameraNear;","uniform float cameraFar;","uniform mat4 cameraProjectionMatrix;","uniform mat4 cameraInverseProjectionMatrix;","uniform float scale;","uniform float intensity;","uniform float bias;","uniform float kernelRadius;","uniform float minResolution;","uniform vec2 size;","uniform float randomSeed;","// RGBA depth","#include <packing>","vec4 getDefaultColor( const in vec2 screenPosition ) {","\t#if DIFFUSE_TEXTURE == 1","\treturn texture2D( tDiffuse, vUv );","\t#else","\treturn vec4( 1.0 );","\t#endif","}","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {","\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];","\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );","\tclipPosition *= clipW; // unprojection.","\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;","}","vec3 getViewNormal( const in vec3 viewPosition, const in vec2 screenPosition ) {","\t#if NORMAL_TEXTURE == 1","\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );","\t#else","\treturn normalize( cross( dFdx( viewPosition ), dFdy( viewPosition ) ) );","\t#endif","}","float scaleDividedByCameraFar;","float minResolutionMultipliedByCameraFar;","float getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {","\tvec3 viewDelta = sampleViewPosition - centerViewPosition;","\tfloat viewDistance = length( viewDelta );","\tfloat scaledScreenDistance = scaleDividedByCameraFar * viewDistance;","\treturn max(0.0, (dot(centerViewNormal, viewDelta) - minResolutionMultipliedByCameraFar) / scaledScreenDistance - bias) / (1.0 + pow2( scaledScreenDistance ) );","}","// moving costly divides into consts","const float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );","const float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );","float getAmbientOcclusion( const in vec3 centerViewPosition ) {","\t// precompute some variables require in getOcclusion.","\tscaleDividedByCameraFar = scale / cameraFar;","\tminResolutionMultipliedByCameraFar = minResolution * cameraFar;","\tvec3 centerViewNormal = getViewNormal( centerViewPosition, vUv );","\t// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/","\tfloat angle = rand( vUv + randomSeed ) * PI2;","\tvec2 radius = vec2( kernelRadius * INV_NUM_SAMPLES ) / size;","\tvec2 radiusStep = radius;","\tfloat occlusionSum = 0.0;","\tfloat weightSum = 0.0;","\tfor( int i = 0; i < NUM_SAMPLES; i ++ ) {","\t\tvec2 sampleUv = vUv + vec2( cos( angle ), sin( angle ) ) * radius;","\t\tradius += radiusStep;","\t\tangle += ANGLE_STEP;","\t\tfloat sampleDepth = getDepth( sampleUv );","\t\tif( sampleDepth >= ( 1.0 - EPSILON ) ) {","\t\t\tcontinue;","\t\t}","\t\tfloat sampleViewZ = getViewZ( sampleDepth );","\t\tvec3 sampleViewPosition = getViewPosition( sampleUv, sampleDepth, sampleViewZ );","\t\tocclusionSum += getOcclusion( centerViewPosition, centerViewNormal, sampleViewPosition );","\t\tweightSum += 1.0;","\t}","\tif( weightSum == 0.0 ) discard;","\treturn occlusionSum * ( intensity / weightSum );","}","void main() {","\tfloat centerDepth = getDepth( vUv );","\tif( centerDepth >= ( 1.0 - EPSILON ) ) {","\t\tdiscard;","\t}","\tfloat centerViewZ = getViewZ( centerDepth );","\tvec3 viewPosition = getViewPosition( vUv, centerDepth, centerViewZ );","\tfloat ambientOcclusion = getAmbientOcclusion( viewPosition );","\tgl_FragColor = getDefaultColor( vUv );","\tgl_FragColor.xyz *=  1.0 - ambientOcclusion;","}"].join("\n")},wp={defines:{KERNEL_RADIUS:4,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDiffuse:{type:"t",value:null},size:{type:"v2",value:new m(512,512)},sampleUvOffsets:{type:"v2v",value:[new m(0,0)]},sampleWeights:{type:"1fv",value:[1]},tDepth:{type:"t",value:null},cameraNear:{type:"f",value:10},cameraFar:{type:"f",value:1e3},depthCutoff:{type:"f",value:10}},vertexShader:["#include <common>","uniform vec2 size;","varying vec2 vUv;","varying vec2 vInvSize;","void main() {","\tvUv = uv;","\tvInvSize = 1.0 / size;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","#include <packing>","uniform sampler2D tDiffuse;","uniform sampler2D tDepth;","uniform float cameraNear;","uniform float cameraFar;","uniform float depthCutoff;","uniform vec2 sampleUvOffsets[ KERNEL_RADIUS + 1 ];","uniform float sampleWeights[ KERNEL_RADIUS + 1 ];","varying vec2 vUv;","varying vec2 vInvSize;","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","void main() {","\tfloat depth = getDepth( vUv );","\tif( depth >= ( 1.0 - EPSILON ) ) {","\t\tdiscard;","\t}","\tfloat centerViewZ = -getViewZ( depth );","\tbool rBreak = false, lBreak = false;","\tfloat weightSum = sampleWeights[0];","\tvec4 diffuseSum = texture2D( tDiffuse, vUv ) * weightSum;","\tfor( int i = 1; i <= KERNEL_RADIUS; i ++ ) {","\t\tfloat sampleWeight = sampleWeights[i];","\t\tvec2 sampleUvOffset = sampleUvOffsets[i] * vInvSize;","\t\tvec2 sampleUv = vUv + sampleUvOffset;","\t\tfloat viewZ = -getViewZ( getDepth( sampleUv ) );","\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) rBreak = true;","\t\tif( ! rBreak ) {","\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;","\t\t\tweightSum += sampleWeight;","\t\t}","\t\tsampleUv = vUv - sampleUvOffset;","\t\tviewZ = -getViewZ( getDepth( sampleUv ) );","\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) lBreak = true;","\t\tif( ! lBreak ) {","\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;","\t\t\tweightSum += sampleWeight;","\t\t}","\t}","\tgl_FragColor = diffuseSum / weightSum;","}"].join("\n")},Sp={createSampleWeights:function(t,e){for(var n=function(t,e){return Math.exp(-t*t/(e*e*2))/(Math.sqrt(2*Math.PI)*e)},r=[],i=0;i<=t;i++)r.push(n(i,e));return r},createSampleOffsets:function(t,e){for(var n=[],r=0;r<=t;r++)n.push(e.clone().multiplyScalar(r));return n},configure:function(t,e,n,r){t.defines.KERNEL_RADIUS=e,t.uniforms.sampleUvOffsets.value=Sp.createSampleOffsets(e,r),t.uniforms.sampleWeights.value=Sp.createSampleWeights(e,n),t.needsUpdate=!0}},Ap={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","#include <packing>","void main() {","float depth = 1.0 - unpackRGBAToDepth( texture2D( tDiffuse, vUv ) );","gl_FragColor = vec4( vec3( depth ), opacity );","}"].join("\n")},Mp=function(t,e,n,r,i){if(Ch.call(this),this.scene=t,this.camera=e,this.clear=!0,this.needsSwap=!1,this.supportsDepthTextureExtension=void 0!==n&&n,this.supportsNormalTexture=void 0!==r&&r,this.oldClearColor=new h,this.oldClearAlpha=1,this.params={output:0,saoBias:.5,saoIntensity:.18,saoScale:1,saoKernelRadius:100,saoMinResolution:0,saoBlur:!0,saoBlurRadius:8,saoBlurStdDev:4,saoBlurDepthCutoff:.01},this.resolution=void 0!==i?new m(i.x,i.y):new m(256,256),this.saoRenderTarget=new pt(this.resolution.x,this.resolution.y,{minFilter:ja,magFilter:ja,format:ns}),this.blurIntermediateRenderTarget=this.saoRenderTarget.clone(),this.beautyRenderTarget=this.saoRenderTarget.clone(),this.normalRenderTarget=new pt(this.resolution.x,this.resolution.y,{minFilter:Ra,magFilter:Ra,format:ns}),this.depthRenderTarget=this.normalRenderTarget.clone(),this.supportsDepthTextureExtension){(n=new In).type=Wa,n.minFilter=Ra,n.maxFilter=Ra,this.beautyRenderTarget.depthTexture=n,this.beautyRenderTarget.depthBuffer=!0}this.depthMaterial=new lt,this.depthMaterial.depthPacking=Ws,this.depthMaterial.blending=zo,this.normalMaterial=new xt,this.normalMaterial.blending=zo,void 0===xp&&console.error("SAOPass relies on SAOShader"),this.saoMaterial=new dt({defines:Object.assign({},xp.defines),fragmentShader:xp.fragmentShader,vertexShader:xp.vertexShader,uniforms:tl.clone(xp.uniforms)}),this.saoMaterial.extensions.derivatives=!0,this.saoMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.saoMaterial.defines.NORMAL_TEXTURE=this.supportsNormalTexture?1:0,this.saoMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.saoMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?n:this.depthRenderTarget.texture,this.saoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.saoMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.getInverse(this.camera.projectionMatrix),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.blending=zo,void 0===wp&&console.error("SAOPass relies on DepthLimitedBlurShader"),this.vBlurMaterial=new dt({uniforms:tl.clone(wp.uniforms),defines:Object.assign({},wp.defines),vertexShader:wp.vertexShader,fragmentShader:wp.fragmentShader}),this.vBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.vBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.vBlurMaterial.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.vBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?n:this.depthRenderTarget.texture,this.vBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.vBlurMaterial.blending=zo,this.hBlurMaterial=new dt({uniforms:tl.clone(wp.uniforms),defines:Object.assign({},wp.defines),vertexShader:wp.vertexShader,fragmentShader:wp.fragmentShader}),this.hBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.hBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.hBlurMaterial.uniforms.tDiffuse.value=this.blurIntermediateRenderTarget.texture,this.hBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?n:this.depthRenderTarget.texture,this.hBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.hBlurMaterial.blending=zo,void 0===ep&&console.error("SAOPass relies on CopyShader"),this.materialCopy=new dt({uniforms:tl.clone(ep.uniforms),vertexShader:ep.vertexShader,fragmentShader:ep.fragmentShader,blending:zo}),this.materialCopy.transparent=!0,this.materialCopy.depthTest=!1,this.materialCopy.depthWrite=!1,this.materialCopy.blending=Xo,this.materialCopy.blendSrc=aa,this.materialCopy.blendDst=Ko,this.materialCopy.blendEquation=Yo,this.materialCopy.blendSrcAlpha=ia,this.materialCopy.blendDstAlpha=Ko,this.materialCopy.blendEquationAlpha=Yo,void 0===ep&&console.error("SAOPass relies on UnpackDepthRGBAShader"),this.depthCopy=new dt({uniforms:tl.clone(Ap.uniforms),vertexShader:Ap.vertexShader,fragmentShader:Ap.fragmentShader,blending:zo}),this.quadCamera=new ct(-1,1,1,-1,0,1),this.quadScene=new ut,this.quad=new B(new ft(2,2),null),this.quadScene.add(this.quad)};Mp.OUTPUT={Beauty:1,Default:0,SAO:2,Depth:3,Normal:4},Mp.prototype=Object.assign(Object.create(Ch.prototype),{constructor:Mp,render:function(t,e,n,r,i){if(this.renderToScreen&&(this.materialCopy.blending=zo,this.materialCopy.uniforms.tDiffuse.value=n.texture,this.materialCopy.needsUpdate=!0,this.renderPass(t,this.materialCopy,null)),1!==this.params.output){this.oldClearColor.copy(t.getClearColor()),this.oldClearAlpha=t.getClearAlpha();var o=t.autoClear;t.autoClear=!1,t.clearTarget(this.depthRenderTarget),this.saoMaterial.uniforms.bias.value=this.params.saoBias,this.saoMaterial.uniforms.intensity.value=this.params.saoIntensity,this.saoMaterial.uniforms.scale.value=this.params.saoScale,this.saoMaterial.uniforms.kernelRadius.value=this.params.saoKernelRadius,this.saoMaterial.uniforms.minResolution.value=this.params.saoMinResolution,this.saoMaterial.uniforms.cameraNear.value=this.camera.near,this.saoMaterial.uniforms.cameraFar.value=this.camera.far;var a=this.params.saoBlurDepthCutoff*(this.camera.far-this.camera.near);this.vBlurMaterial.uniforms.depthCutoff.value=a,this.hBlurMaterial.uniforms.depthCutoff.value=a,this.vBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.vBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.hBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.hBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.params.saoBlurRadius=Math.floor(this.params.saoBlurRadius),this.prevStdDev===this.params.saoBlurStdDev&&this.prevNumSamples===this.params.saoBlurRadius||(Sp.configure(this.vBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new m(0,1)),Sp.configure(this.hBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new m(1,0)),this.prevStdDev=this.params.saoBlurStdDev,this.prevNumSamples=this.params.saoBlurRadius),t.setClearColor(0),t.render(this.scene,this.camera,this.beautyRenderTarget,!0),this.supportsDepthTextureExtension||this.renderOverride(t,this.depthMaterial,this.depthRenderTarget,0,1),this.supportsNormalTexture&&this.renderOverride(t,this.normalMaterial,this.normalRenderTarget,7829503,1),this.renderPass(t,this.saoMaterial,this.saoRenderTarget,16777215,1),this.params.saoBlur&&(this.renderPass(t,this.vBlurMaterial,this.blurIntermediateRenderTarget,16777215,1),this.renderPass(t,this.hBlurMaterial,this.saoRenderTarget,16777215,1));var s=this.materialCopy;3===this.params.output?this.supportsDepthTextureExtension?(this.materialCopy.uniforms.tDiffuse.value=this.beautyRenderTarget.depthTexture,this.materialCopy.needsUpdate=!0):(this.depthCopy.uniforms.tDiffuse.value=this.depthRenderTarget.texture,this.depthCopy.needsUpdate=!0,s=this.depthCopy):4===this.params.output?(this.materialCopy.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.materialCopy.needsUpdate=!0):(this.materialCopy.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.materialCopy.needsUpdate=!0),s.blending=0===this.params.output?Xo:zo,this.renderPass(t,s,this.renderToScreen?null:n),t.setClearColor(this.oldClearColor,this.oldClearAlpha),t.autoClear=o}},renderPass:function(t,e,n,r,i){var o=t.getClearColor(),a=t.getClearAlpha(),s=t.autoClear;t.autoClear=!1;var l=void 0!==r&&null!==r;l&&(t.setClearColor(r),t.setClearAlpha(i||0)),this.quad.material=e,t.render(this.quadScene,this.quadCamera,n,l),t.autoClear=s,t.setClearColor(o),t.setClearAlpha(a)},renderOverride:function(t,e,n,r,i){var o=t.getClearColor(),a=t.getClearAlpha(),s=t.autoClear;t.autoClear=!1,r=e.clearColor||r,i=e.clearAlpha||i;var l=void 0!==r&&null!==r;l&&(t.setClearColor(r),t.setClearAlpha(i||0)),this.scene.overrideMaterial=e,t.render(this.scene,this.camera,n,l),this.scene.overrideMaterial=null,t.autoClear=s,t.setClearColor(o),t.setClearAlpha(a)},setSize:function(t,e){this.beautyRenderTarget.setSize(t,e),this.saoRenderTarget.setSize(t,e),this.blurIntermediateRenderTarget.setSize(t,e),this.normalRenderTarget.setSize(t,e),this.depthRenderTarget.setSize(t,e),this.saoMaterial.uniforms.size.value.set(t,e),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.getInverse(this.camera.projectionMatrix),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.needsUpdate=!0,this.vBlurMaterial.uniforms.size.value.set(t,e),this.vBlurMaterial.needsUpdate=!0,this.hBlurMaterial.uniforms.size.value.set(t,e),this.hBlurMaterial.needsUpdate=!0}});var Tp=function(t){Ch.call(this),void 0===ep&&console.error("SavePass relies on CopyShader");var e=ep;this.textureID="tDiffuse",this.uniforms=tl.clone(e.uniforms),this.material=new dt({uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader}),this.renderTarget=t,void 0===this.renderTarget&&(this.renderTarget=new pt(window.innerWidth,window.innerHeight,{minFilter:ja,magFilter:ja,format:es,stencilBuffer:!1}),this.renderTarget.texture.name="SavePass.rt"),this.needsSwap=!1,this.camera=new ct(-1,1,1,-1,0,1),this.scene=new ut,this.quad=new B(new mt(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};Tp.prototype=Object.assign(Object.create(Ch.prototype),{constructor:Tp,render:function(t,e,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.quad.material=this.material,t.render(this.scene,this.camera,this.renderTarget,this.clear)}});var Cp=[{defines:{SMAA_THRESHOLD:"0.1"},uniforms:{tDiffuse:{value:null},resolution:{value:new m(1/1024,1/512)}},vertexShader:["uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 3 ];","void SMAAEdgeDetectionVS( vec2 texcoord ) {","vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 );","vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 );","vOffset[ 2 ] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 );","}","void main() {","vUv = uv;","SMAAEdgeDetectionVS( vUv );","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","varying vec4 vOffset[ 3 ];","vec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {","vec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );","vec4 delta;","vec3 C = texture2D( colorTex, texcoord ).rgb;","vec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;","vec3 t = abs( C - Cleft );","delta.x = max( max( t.r, t.g ), t.b );","vec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;","t = abs( C - Ctop );","delta.y = max( max( t.r, t.g ), t.b );","vec2 edges = step( threshold, delta.xy );","if ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )","discard;","vec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;","t = abs( C - Cright );","delta.z = max( max( t.r, t.g ), t.b );","vec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;","t = abs( C - Cbottom );","delta.w = max( max( t.r, t.g ), t.b );","float maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );","vec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;","t = abs( C - Cleftleft );","delta.z = max( max( t.r, t.g ), t.b );","vec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;","t = abs( C - Ctoptop );","delta.w = max( max( t.r, t.g ), t.b );","maxDelta = max( max( maxDelta, delta.z ), delta.w );","edges.xy *= step( 0.5 * maxDelta, delta.xy );","return vec4( edges, 0.0, 0.0 );","}","void main() {","gl_FragColor = SMAAColorEdgeDetectionPS( vUv, vOffset, tDiffuse );","}"].join("\n")},{defines:{SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )"},uniforms:{tDiffuse:{value:null},tArea:{value:null},tSearch:{value:null},resolution:{value:new m(1/1024,1/512)}},vertexShader:["uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 3 ];","varying vec2 vPixcoord;","void SMAABlendingWeightCalculationVS( vec2 texcoord ) {","vPixcoord = texcoord / resolution;","vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 );","vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 );","vOffset[ 2 ] = vec4( vOffset[ 0 ].xz, vOffset[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );","}","void main() {","vUv = uv;","SMAABlendingWeightCalculationVS( vUv );","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )","uniform sampler2D tDiffuse;","uniform sampler2D tArea;","uniform sampler2D tSearch;","uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[3];","varying vec2 vPixcoord;","vec2 round( vec2 x ) {","return sign( x ) * floor( abs( x ) + 0.5 );","}","float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {","e.r = bias + e.r * scale;","return 255.0 * texture2D( searchTex, e, 0.0 ).r;","}","float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","vec2 e = vec2( 0.0, 1.0 );","for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","e = texture2D( edgesTex, texcoord, 0.0 ).rg;","texcoord -= vec2( 2.0, 0.0 ) * resolution;","if ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;","}","texcoord.x += 0.25 * resolution.x;","texcoord.x += resolution.x;","texcoord.x += 2.0 * resolution.x;","texcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);","return texcoord.x;","}","float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","vec2 e = vec2( 0.0, 1.0 );","for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","e = texture2D( edgesTex, texcoord, 0.0 ).rg;","texcoord += vec2( 2.0, 0.0 ) * resolution;","if ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;","}","texcoord.x -= 0.25 * resolution.x;","texcoord.x -= resolution.x;","texcoord.x -= 2.0 * resolution.x;","texcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );","return texcoord.x;","}","float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","vec2 e = vec2( 1.0, 0.0 );","for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","e = texture2D( edgesTex, texcoord, 0.0 ).rg;","texcoord += vec2( 0.0, 2.0 ) * resolution;","if ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;","}","texcoord.y -= 0.25 * resolution.y;","texcoord.y -= resolution.y;","texcoord.y -= 2.0 * resolution.y;","texcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 );","return texcoord.y;","}","float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","vec2 e = vec2( 1.0, 0.0 );","for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","e = texture2D( edgesTex, texcoord, 0.0 ).rg;","texcoord -= vec2( 0.0, 2.0 ) * resolution;","if ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;","}","texcoord.y += 0.25 * resolution.y;","texcoord.y += resolution.y;","texcoord.y += 2.0 * resolution.y;","texcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 );","return texcoord.y;","}","vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {","vec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;","texcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );","texcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;","return texture2D( areaTex, texcoord, 0.0 ).rg;","}","vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {","vec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );","vec2 e = texture2D( edgesTex, texcoord ).rg;","if ( e.g > 0.0 ) {","vec2 d;","vec2 coords;","coords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );","coords.y = offset[ 1 ].y;","d.x = coords.x;","float e1 = texture2D( edgesTex, coords, 0.0 ).r;","coords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );","d.y = coords.x;","d = d / resolution.x - pixcoord.x;","vec2 sqrt_d = sqrt( abs( d ) );","coords.y -= 1.0 * resolution.y;","float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;","weights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );","}","if ( e.r > 0.0 ) {","vec2 d;","vec2 coords;","coords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );","coords.x = offset[ 0 ].x;","d.x = coords.y;","float e1 = texture2D( edgesTex, coords, 0.0 ).g;","coords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );","d.y = coords.y;","d = d / resolution.y - pixcoord.y;","vec2 sqrt_d = sqrt( abs( d ) );","coords.y -= 1.0 * resolution.y;","float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;","weights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );","}","return weights;","}","void main() {","gl_FragColor = SMAABlendingWeightCalculationPS( vUv, vPixcoord, vOffset, tDiffuse, tArea, tSearch, ivec4( 0.0 ) );","}"].join("\n")},{uniforms:{tDiffuse:{value:null},tColor:{value:null},resolution:{value:new m(1/1024,1/512)}},vertexShader:["uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 2 ];","void SMAANeighborhoodBlendingVS( vec2 texcoord ) {","vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 );","vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 );","}","void main() {","vUv = uv;","SMAANeighborhoodBlendingVS( vUv );","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D tColor;","uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 2 ];","vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {","vec4 a;","a.xz = texture2D( blendTex, texcoord ).xz;","a.y = texture2D( blendTex, offset[ 1 ].zw ).g;","a.w = texture2D( blendTex, offset[ 1 ].xy ).a;","if ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {","return texture2D( colorTex, texcoord, 0.0 );","} else {","vec2 offset;","offset.x = a.a > a.b ? a.a : -a.b;","offset.y = a.g > a.r ? -a.g : a.r;","if ( abs( offset.x ) > abs( offset.y )) {","offset.y = 0.0;","} else {","offset.x = 0.0;","}","vec4 C = texture2D( colorTex, texcoord, 0.0 );","texcoord += sign( offset ) * resolution;","vec4 Cop = texture2D( colorTex, texcoord, 0.0 );","float s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );","C.xyz = pow(C.xyz, vec3(2.2));","Cop.xyz = pow(Cop.xyz, vec3(2.2));","vec4 mixed = mix(C, Cop, s);","mixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));","return mixed;","}","}","void main() {","gl_FragColor = SMAANeighborhoodBlendingPS( vUv, vOffset, tColor, tDiffuse );","}"].join("\n")}],Ep=function(t,e){Ch.call(this),this.edgesRT=new pt(t,e,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:ja,format:es}),this.edgesRT.texture.name="SMAAPass.edges",this.weightsRT=new pt(t,e,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:ja,format:ns}),this.weightsRT.texture.name="SMAAPass.weights";var n=new Image;n.src=this.getAreaTexture(),this.areaTexture=new ht,this.areaTexture.name="SMAAPass.area",this.areaTexture.image=n,this.areaTexture.format=es,this.areaTexture.minFilter=ja,this.areaTexture.generateMipmaps=!1,this.areaTexture.needsUpdate=!0,this.areaTexture.flipY=!1;var r=new Image;r.src=this.getSearchTexture(),this.searchTexture=new ht,this.searchTexture.name="SMAAPass.search",this.searchTexture.image=r,this.searchTexture.magFilter=Ra,this.searchTexture.minFilter=Ra,this.searchTexture.generateMipmaps=!1,this.searchTexture.needsUpdate=!0,this.searchTexture.flipY=!1,void 0===Cp&&console.error("SMAAPass relies on SMAAShader"),this.uniformsEdges=tl.clone(Cp[0].uniforms),this.uniformsEdges.resolution.value.set(1/t,1/e),this.materialEdges=new dt({defines:Object.assign({},Cp[0].defines),uniforms:this.uniformsEdges,vertexShader:Cp[0].vertexShader,fragmentShader:Cp[0].fragmentShader}),this.uniformsWeights=tl.clone(Cp[1].uniforms),this.uniformsWeights.resolution.value.set(1/t,1/e),this.uniformsWeights.tDiffuse.value=this.edgesRT.texture,this.uniformsWeights.tArea.value=this.areaTexture,this.uniformsWeights.tSearch.value=this.searchTexture,this.materialWeights=new dt({defines:Object.assign({},Cp[1].defines),uniforms:this.uniformsWeights,vertexShader:Cp[1].vertexShader,fragmentShader:Cp[1].fragmentShader}),this.uniformsBlend=tl.clone(Cp[2].uniforms),this.uniformsBlend.resolution.value.set(1/t,1/e),this.uniformsBlend.tDiffuse.value=this.weightsRT.texture,this.materialBlend=new dt({uniforms:this.uniformsBlend,vertexShader:Cp[2].vertexShader,fragmentShader:Cp[2].fragmentShader}),this.needsSwap=!1,this.camera=new ct(-1,1,1,-1,0,1),this.scene=new ut,this.quad=new B(new mt(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};Ep.prototype=Object.assign(Object.create(Ch.prototype),{constructor:Ep,render:function(t,e,n,r,i){this.uniformsEdges.tDiffuse.value=n.texture,this.quad.material=this.materialEdges,t.render(this.scene,this.camera,this.edgesRT,this.clear),this.quad.material=this.materialWeights,t.render(this.scene,this.camera,this.weightsRT,this.clear),this.uniformsBlend.tColor.value=n.texture,this.quad.material=this.materialBlend,this.renderToScreen?t.render(this.scene,this.camera):t.render(this.scene,this.camera,e,this.clear)},setSize:function(t,e){this.edgesRT.setSize(t,e),this.weightsRT.setSize(t,e),this.materialEdges.uniforms.resolution.value.set(1/t,1/e),this.materialWeights.uniforms.resolution.value.set(1/t,1/e),this.materialBlend.uniforms.resolution.value.set(1/t,1/e)},getAreaTexture:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAIAAACOVPcQAACBeklEQVR42u39W4xlWXrnh/3WWvuciIzMrKxrV8/0rWbY0+SQFKcb4owIkSIFCjY9AC1BT/LYBozRi+EX+cV+8IMsYAaCwRcBwjzMiw2jAWtgwC8WR5Q8mDFHZLNHTarZGrLJJllt1W2qKrsumZWZcTvn7L3W54e1vrXX3vuciLPPORFR1XE2EomorB0nVuz//r71re/y/1eMvb4Cb3N11xV/PP/2v4UBAwJG/7H8urx6/25/Gf8O5hypMQ0EEEQwAqLfoN/Z+97f/SW+/NvcgQk4sGBJK6H7N4PFVL+K+e0N11yNfkKvwUdwdlUAXPHHL38oa15f/i/46Ih6SuMSPmLAYAwyRKn7dfMGH97jaMFBYCJUgotIC2YAdu+LyW9vvubxAP8kAL8H/koAuOKP3+q6+xGnd5kdYCeECnGIJViwGJMAkQKfDvB3WZxjLKGh8VSCCzhwEWBpMc5/kBbjawT4HnwJfhr+pPBIu7uu+OOTo9vsmtQcniMBGkKFd4jDWMSCRUpLjJYNJkM+IRzQ+PQvIeAMTrBS2LEiaiR9b/5PuT6Ap/AcfAFO4Y3dA3DFH7/VS+M8k4baEAQfMI4QfbVDDGIRg7GKaIY52qAjTAgTvGBAPGIIghOCYAUrGFNgzA7Q3QhgCwfwAnwe5vDejgG44o/fbm1C5ZlYQvQDARPAIQGxCWBM+wWl37ZQESb4gImexGMDouhGLx1Cst0Saa4b4AqO4Hk4gxo+3DHAV/nx27p3JziPM2pVgoiia5MdEzCGULprIN7gEEeQ5IQxEBBBQnxhsDb5auGmAAYcHMA9eAAz8PBol8/xij9+C4Djlim4gJjWcwZBhCBgMIIYxGAVIkH3ZtcBuLdtRFMWsPGoY9rN+HoBji9VBYdwD2ZQg4cnO7OSq/z4rU5KKdwVbFAjNojCQzTlCLPFSxtamwh2jMUcEgg2Wm/6XgErIBhBckQtGN3CzbVacERgCnfgLswhnvqf7QyAq/z4rRZm1YglYE3affGITaZsdIe2FmMIpnOCap25I6jt2kCwCW0D1uAD9sZctNGXcQIHCkINDQgc78aCr+zjtw3BU/ijdpw3zhCwcaONwBvdeS2YZKkJNJsMPf2JKEvC28RXxxI0ASJyzQCjCEQrO4Q7sFArEzjZhaFc4cdv+/JFdKULM4px0DfUBI2hIsy06BqLhGTQEVdbfAIZXYMPesq6VoCHICzUyjwInO4Y411//LYLs6TDa9wvg2CC2rElgAnpTBziThxaL22MYhzfkghz6GAs2VHbbdM91VZu1MEEpupMMwKyVTb5ij9+u4VJG/5EgEMMmFF01cFai3isRbKbzb+YaU/MQbAm2XSMoUPAmvZzbuKYRIFApbtlrfFuUGd6vq2hXNnH78ZLh/iFhsQG3T4D1ib7k5CC6vY0DCbtrohgLEIClXiGtl10zc0CnEGIhhatLBva7NP58Tvw0qE8yWhARLQ8h4+AhQSP+I4F5xoU+VilGRJs6wnS7ruti/4KvAY/CfdgqjsMy4pf8fodQO8/gnuX3f/3xi3om1/h7THr+co3x93PP9+FBUfbNUjcjEmhcrkT+8K7ml7V10Jo05mpIEFy1NmCJWx9SIKKt+EjAL4Ez8EBVOB6havuT/rByPvHXK+9zUcfcbb254+9fydJknYnRr1oGfdaiAgpxu1Rx/Rek8KISftx3L+DfsLWAANn8Hvw0/AFeAGO9DFV3c6D+CcWbL8Dj9e7f+T1k8AZv/d7+PXWM/Z+VvdCrIvuAKO09RpEEQJM0Ci6+B4xhTWr4cZNOvhktabw0ta0rSJmqz3Yw5/AKXwenod7cAhTmBSPKf6JBdvH8IP17h95pXqw50/+BFnj88fev4NchyaK47OPhhtI8RFSvAfDSNh0Ck0p2gLxGkib5NJj/JWCr90EWQJvwBzO4AHcgztwAFN1evHPUVGwfXON+0debT1YeGON9Yy9/63X+OguiwmhIhQhD7l4sMqlG3D86Suc3qWZ4rWjI1X7u0Ytw6x3rIMeIOPDprfe2XzNgyj6PahhBjO4C3e6puDgXrdg+/5l948vF3bqwZetZ+z9Rx9zdIY5pInPK4Nk0t+l52xdK2B45Qd87nM8fsD5EfUhIcJcERw4RdqqH7Yde5V7m1vhNmtedkz6EDzUMF/2jJYWbC+4fzzA/Y+/8PPH3j9dcBAPIRP8JLXd5BpAu03aziOL3VVHZzz3CXWDPWd+SH2AnxIqQoTZpo9Ckc6HIrFbAbzNmlcg8Ag8NFDDAhbJvTBZXbC94P7t68EXfv6o+21gUtPETU7bbkLxvNKRFG2+KXzvtObonPP4rBvsgmaKj404DlshFole1Glfh02fE7bYR7dZ82oTewIBGn1Md6CG6YUF26X376oevOLzx95vhUmgblI6LBZwTCDY7vMq0op5WVXgsObOXJ+1x3qaBl9j1FeLxbhU9w1F+Wiba6s1X/TBz1LnUfuYDi4r2C69f1f14BWfP+p+W2GFKuC9phcELMYRRLur9DEZTUdEH+iEqWdaM7X4WOoPGI+ZYD2+wcQ+y+ioHUZ9dTDbArzxmi/bJI9BND0Ynd6lBdve/butBw8+f/T9D3ABa3AG8W3VPX4hBin+bj8dMMmSpp5pg7fJ6xrBFE2WQQEWnV8Qg3FbAWzYfM1rREEnmvkN2o1+acG2d/9u68GDzx91v3mAjb1zkpqT21OipPKO0b9TO5W0nTdOmAQm0TObts3aBKgwARtoPDiCT0gHgwnbArzxmtcLc08HgF1asN0C4Ms/fvD5I+7PhfqyXE/b7RbbrGyRQRT9ARZcwAUmgdoz0ehJ9Fn7QAhUjhDAQSw0bV3T3WbNa59jzmiP6GsWbGXDX2ytjy8+f9T97fiBPq9YeLdBmyuizZHaqXITnXiMUEEVcJ7K4j3BFPurtB4bixW8wTpweL8DC95szWMOqucFYGsWbGU7p3TxxxefP+r+oTVktxY0v5hbq3KiOKYnY8ddJVSBxuMMVffNbxwIOERShst73HZ78DZrHpmJmH3K6sGz0fe3UUj0eyRrSCGTTc+rjVNoGzNSv05srAxUBh8IhqChiQgVNIIBH3AVPnrsnXQZbLTm8ammv8eVXn/vWpaTem5IXRlt+U/LA21zhSb9cye6jcOfCnOwhIAYXAMVTUNV0QhVha9xjgA27ODJbLbmitt3tRN80lqG6N/khgot4ZVlOyO4WNg3OIMzhIZQpUEHieg2im6F91hB3I2tubql6BYNN9Hj5S7G0G2tahslBWKDnOiIvuAEDzakDQKDNFQT6gbn8E2y4BBubM230YIpBnDbMa+y3dx0n1S0BtuG62lCCXwcY0F72T1VRR3t2ONcsmDjbmzNt9RFs2LO2hQNyb022JisaI8rAWuw4HI3FuAIhZdOGIcdjLJvvObqlpqvWTJnnQbyi/1M9O8UxWhBs//H42I0q1Yb/XPGONzcmm+ri172mHKvZBpHkJaNJz6v9jxqiklDj3U4CA2ugpAaYMWqNXsdXbmJNd9egCnJEsphXNM+MnK3m0FCJ5S1kmJpa3DgPVbnQnPGWIDspW9ozbcO4K/9LkfaQO2KHuqlfFXSbdNzcEcwoqNEFE9zcIXu9/6n/ym/BC/C3aJLzEKPuYVlbFnfhZ8kcWxV3dbv4bKl28566wD+8C53aw49lTABp9PWbsB+knfc/Li3eVizf5vv/xmvnPKg5ihwKEwlrcHqucuVcVOxEv8aH37E3ZqpZypUulrHEtIWKUr+txHg+ojZDGlwnqmkGlzcVi1dLiNSJiHjfbRNOPwKpx9TVdTn3K05DBx4psIk4Ei8aCkJahRgffk4YnEXe07T4H2RR1u27E6wfQsBDofUgjFUFnwC2AiVtA+05J2zpiDK2Oa0c5fmAecN1iJzmpqFZxqYBCYhFTCsUNEmUnIcZ6aEA5rQVhEywG6w7HSW02XfOoBlQmjwulOFQAg66SvJblrTEX1YtJ3uG15T/BH1OfOQeuR8g/c0gdpT5fx2SKbs9EfHTKdM8A1GaJRHLVIwhcGyydZsbifAFVKl5EMKNU2Hryo+06BeTgqnxzYjThVySDikbtJPieco75lYfKAJOMEZBTjoITuWHXXZVhcUDIS2hpiXHV9Ku4u44bN5OYLDOkJo8w+xJSMbhBRHEdEs9JZUCkQrPMAvaHyLkxgkEHxiNkx/x2YB0mGsQ8EUWj/stW5YLhtS5SMu+/YBbNPDCkGTUybN8krRLBGPlZkVOA0j+a1+rkyQKWGaPHPLZOkJhioQYnVZ2hS3zVxMtgC46KuRwbJNd9nV2PHgb36F194ecf/Yeu2vAFe5nm/bRBFrnY4BauE8ERmZRFUn0k8hbftiVYSKMEme2dJCJSCGYAlNqh87bXOPdUkGy24P6d1ll21MBqqx48Fvv8ZHH8HZFY7j/uAq1xMJUFqCSUlJPmNbIiNsmwuMs/q9CMtsZsFO6SprzCS1Z7QL8xCQClEelpjTduDMsmWD8S1PT152BtvmIGvUeDA/yRn83u/x0/4qxoPHjx+PXY9pqX9bgMvh/Nz9kpP4pOe1/fYf3axUiMdHLlPpZCNjgtNFAhcHEDxTumNONhHrBduW+vOyY++70WWnPXj98eA4kOt/mj/5E05l9+O4o8ePx67HFqyC+qSSnyselqjZGaVK2TadbFLPWAQ4NBhHqDCCV7OTpo34AlSSylPtIdd2AJZlyzYQrDJ5lcWGNceD80CunPLGGzsfD+7wRb95NevJI5docQ3tgCyr5bGnyaPRlmwNsFELViOOx9loebGNq2moDOKpHLVP5al2cymWHbkfzGXL7kfRl44H9wZy33tvt+PB/Xnf93e+nh5ZlU18wCiRUa9m7kib9LYuOk+hudQNbxwm0AQqbfloimaB2lM5fChex+ylMwuTbfmXQtmWlenZljbdXTLuOxjI/fDDHY4Hjx8/Hrse0zXfPFxbUN1kKqSCCSk50m0Ajtx3ub9XHBKHXESb8iO6E+qGytF4nO0OG3SXzbJlhxBnKtKyl0NwybjvYCD30aMdjgePHz8eu56SVTBbgxJMliQ3Oauwg0QHxXE2Ez/EIReLdQj42Gzb4CLS0YJD9xUx7bsi0vJi5mUbW1QzL0h0PFk17rtiIPfJk52MB48fPx67npJJwyrBa2RCCQRTbGZSPCxTPOiND4G2pYyOQ4h4jINIJh5wFU1NFZt+IsZ59LSnDqBjZ2awbOku+yInunLcd8VA7rNnOxkPHj9+PGY9B0MWJJNozOJmlglvDMXDEozdhQWbgs/U6oBanGzLrdSNNnZFjOkmbi5bNt1lX7JLLhn3vXAg9/h4y/Hg8ePHI9dzQMEkWCgdRfYykYKnkP7D4rIujsujaKPBsB54vE2TS00ccvFY/Tth7JXeq1hz+qgVy04sAJawTsvOknHfCwdyT062HA8eP348Zj0vdoXF4pilKa2BROed+9fyw9rWRXeTFXESMOanvDZfJuJaSXouQdMdDJZtekZcLLvEeK04d8m474UDuaenW44Hjx8/Xns9YYqZpszGWB3AN/4VHw+k7WSFtJ3Qicuqb/NlVmgXWsxh570xg2UwxUw3WfO6B5nOuO8aA7lnZxuPB48fPx6znm1i4bsfcbaptF3zNT78eFPtwi1OaCNOqp1x3zUGcs/PN++AGD1+fMXrSVm2baTtPhPahbPhA71wIHd2bXzRa69nG+3CraTtPivahV/55tXWg8fyRY/9AdsY8VbSdp8V7cKrrgdfM//z6ILQFtJ2nxHtwmuoB4/kf74+gLeRtvvMaBdeSz34+vifx0YG20jbfTa0C6+tHrwe//NmOG0L8EbSdp8R7cLrrQe/996O+ai3ujQOskpTNULa7jOjXXj99eCd8lHvoFiwsbTdZ0a78PrrwTvlo966pLuRtB2fFe3Cm6oHP9kNH/W2FryxtN1nTLvwRurBO+Kj3pWXHidtx2dFu/Bm68Fb81HvykuPlrb7LGkX3mw9eGs+6h1Y8MbSdjegXcguQLjmevDpTQLMxtJ2N6NdyBZu9AbrwVvwUW+LbteULUpCdqm0HTelXbhNPe8G68Gb8lFvVfYfSNuxvrTdTWoXbozAzdaDZzfkorOj1oxVxlIMlpSIlpLrt8D4hrQL17z+c3h6hU/wv4Q/utps4+bm+6P/hIcf0JwQ5oQGPBL0eKPTYEXTW+eL/2DKn73J9BTXYANG57hz1cEMviVf/4tf5b/6C5pTQkMIWoAq7hTpOJjtAM4pxKu5vg5vXeUrtI09/Mo/5H+4z+Mp5xULh7cEm2QbRP2tFIKR7WM3fPf/jZ3SWCqLM2l4NxID5zB72HQXv3jj/8mLR5xXNA5v8EbFQEz7PpRfl1+MB/hlAN65qgDn3wTgH13hK7T59bmP+NIx1SHHU84nLOITt3iVz8mNO+lPrjGAnBFqmioNn1mTyk1ta47R6d4MrX7tjrnjYUpdUbv2rVr6YpVfsGG58AG8Ah9eyUN8CX4WfgV+G8LVWPDGb+Zd4cU584CtqSbMKxauxTg+dyn/LkVgA+IR8KHtejeFKRtTmLLpxN6mYVLjYxwXf5x2VofiZcp/lwKk4wGOpYDnoIZPdg/AAbwMfx0+ge9dgZvYjuqKe4HnGnykYo5TvJbG0Vj12JagRhwKa44H95ShkZa5RyLGGdfYvG7aw1TsF6iapPAS29mNS3NmsTQZCmgTzFwgL3upCTgtBTRwvGMAKrgLn4evwin8+afJRcff+8izUGUM63GOOuAs3tJkw7J4kyoNreqrpO6cYLQeFUd7TTpr5YOTLc9RUUogUOVJQ1GYJaFLAW0oTmKyYS46ZooP4S4EON3xQ5zC8/CX4CnM4c1PE8ApexpoYuzqlP3d4S3OJP8ZDK7cKWNaTlqmgDiiHwl1YsE41w1zT4iRTm3DBqxvOUsbMKKDa/EHxagtnta072ejc3DOIh5ojvh8l3tk1JF/AV6FU6jh3U8HwEazLgdCLYSQ+MYiAI2ltomkzttUb0gGHdSUUgsIYjTzLG3mObX4FBRaYtpDVNZrih9TgTeYOBxsEnN1gOCTM8Bsw/ieMc75w9kuAT6A+/AiHGvN/+Gn4KRkiuzpNNDYhDGFndWRpE6SVfm8U5bxnSgVV2jrg6JCKmneqey8VMFgq2+AM/i4L4RUbfSi27lNXZ7R7W9RTcq/q9fk4Xw3AMQd4I5ifAZz8FcVtm9SAom/dyN4lczJQW/kC42ZrHgcCoIf1oVMKkVItmMBi9cOeNHGLqOZk+QqQmrbc5YmYgxELUUN35z2iohstgfLIFmcMV7s4CFmI74L9+EFmGsi+tGnAOD4Yk9gIpo01Y4cA43BWGygMdr4YZekG3OBIUXXNukvJS8tqa06e+lSDCtnqqMFu6hWHXCF+WaYt64m9QBmNxi7Ioy7D+fa1yHw+FMAcPt7SysFLtoG4PXAk7JOA3aAxBRqUiAdU9Yp5lK3HLSRFtOim0sa8euEt08xvKjYjzeJ2GU7YawexrnKI9tmobInjFXCewpwriY9+RR4aaezFhMhGCppKwom0ChrgFlKzyPKkGlTW1YQrE9HJqu8hKGgMc6hVi5QRq0PZxNfrYNgE64utmRv6KKHRpxf6VDUaOvNP5jCEx5q185My/7RKz69UQu2im5k4/eownpxZxNLwiZ1AZTO2ZjWjkU9uaB2HFn6Q3u0JcsSx/qV9hTEApRzeBLDJQXxYmTnq7bdLa3+uqFrxLJ5w1TehnNHx5ECvCh2g2c3hHH5YsfdaSKddztfjQ6imKFGSyFwlLzxEGPp6r5IevVjk1AMx3wMqi1NxDVjLBiPs9tbsCkIY5we5/ML22zrCScFxnNtzsr9Wcc3CnD+pYO+4VXXiDE0oc/vQQ/fDK3oPESJMYXNmJa/DuloJZkcTpcYE8lIH8Dz8DJMiynNC86Mb2lNaaqP/+L7f2fcE/yP7/Lde8xfgSOdMxvOixZf/9p3+M4hT1+F+zApxg9XfUvYjc8qX2lfOOpK2gNRtB4flpFu9FTKCp2XJRgXnX6olp1zyYjTKJSkGmLE2NjUr1bxFM4AeAAHBUFIeSLqXR+NvH/M9fOnfHzOD2vCSyQJKzfgsCh+yi/Mmc35F2fUrw7miW33W9hBD1vpuUojFphIyvg7aTeoymDkIkeW3XLHmguMzbIAJejN6B5MDrhipE2y6SoFRO/AK/AcHHZHNIfiWrEe/C6cr3f/yOvrQKB+zMM55/GQdLDsR+ifr5Fiuu+/y+M78LzOE5dsNuXC3PYvYWd8NXvphLSkJIasrlD2/HOqQ+RjcRdjKTGWYhhVUm4yxlyiGPuMsZR7sMCHUBeTuNWA7if+ifXgc/hovftHXs/DV+Fvwe+f8shzMiMcweFgBly3//vwJfg5AN4450fn1Hd1Rm1aBLu22Dy3y3H2+OqMemkbGZ4jozcDjJf6596xOLpC0eMTHbKnxLxH27uZ/bMTGs2jOaMOY4m87CfQwF0dw53oa1k80JRuz/XgS+8fX3N9Af4qPIMfzKgCp4H5TDGe9GGeFPzSsZz80SlPTxXjgwJmC45njzgt2vbQ4b4OAdUK4/vWhO8d8v6EE8fMUsfakXbPpFJeLs2ubM/qdm/la3WP91uWhxXHjoWhyRUq2iJ/+5mA73zwIIo+LoZ/SgvIRjAd1IMvvn98PfgOvAJfhhm8scAKVWDuaRaK8aQ9f7vuPDH6Bj47ZXau7rqYJ66mTDwEDU6lLbCjCK0qTXyl5mnDoeNRxanj3FJbaksTk0faXxHxLrssgPkWB9LnA/MFleXcJozzjwsUvUG0X/QCve51qkMDXp9mtcyOy3rwBfdvVJK7D6/ACSzg3RoruIq5UDeESfEmVclDxnniU82vxMLtceD0hGZWzBNPMM/jSPne2OVatiTKUpY5vY7gc0LdUAWeWM5tH+O2I66AOWw9xT2BuyRVLGdoDHUsVRXOo/c+ZdRXvFfnxWyIV4upFLCl9eAL7h8Zv0QH8Ry8pA2cHzQpGesctVA37ZtklBTgHjyvdSeKY/RZw/kJMk0Y25cSNRWSigQtlULPTw+kzuJPeYEkXjQRpoGZobYsLF79pyd1dMRHInbgFTZqNLhDqiIsTNpoex2WLcy0/X6rHcdMMQvFSd5dWA++4P7xv89deACnmr36uGlL69bRCL6BSZsS6c0TU2TKK5gtWCzgAOOwQcurqk9j8whvziZSMLcq5hbuwBEsYjopUBkqw1yYBGpLA97SRElEmx5MCInBY5vgLk94iKqSWmhIGmkJ4Bi9m4L645J68LyY4wsFYBfUg5feP/6gWWm58IEmKQM89hq7KsZNaKtP5TxxrUZZVkNmMJtjbKrGxLNEbHPJxhqy7lAmbC32ZqeF6lTaknRWcYaFpfLUBh/rwaQycCCJmW15Kstv6jRHyJFry2C1ahkkIW0LO75s61+owxK1y3XqweX9m5YLM2DPFeOjn/iiqCKJ+yKXF8t5Yl/kNsqaSCryxPq5xWTFIaP8KSW0RYxqupaUf0RcTNSSdJZGcKYdYA6kdtrtmyBckfKXwqk0pHpUHlwWaffjNRBYFPUDWa8e3Lt/o0R0CdisKDM89cX0pvRHEfM8ca4t0s2Xx4kgo91MPQJ/0c9MQYq0co8MBh7bz1fio0UUHLR4aAIOvOmoYO6kwlEVODSSTliWtOtH6sPkrtctF9ZtJ9GIerBskvhdVS5cFNv9s1BU0AbdUgdK4FG+dRnjFmDTzniRMdZO1QhzMK355vigbdkpz9P6qjUGE5J2qAcXmwJ20cZUiAD0z+pGMx6xkzJkmEf40Hr4qZfVg2XzF9YOyoV5BjzVkUJngKf8lgNYwKECEHrCNDrWZzMlflS3yBhr/InyoUgBc/lKT4pxVrrC6g1YwcceK3BmNxZcAtz3j5EIpqguh9H6wc011YN75cKDLpFDxuwkrPQmUwW4KTbj9mZTwBwLq4aQMUZbHm1rylJ46dzR0dua2n3RYCWZsiHROeywyJGR7mXKlpryyCiouY56sFkBWEnkEB/raeh/Sw4162KeuAxMQpEkzy5alMY5wamMsWKKrtW2WpEWNnReZWONKWjrdsKZarpFjqCslq773PLmEhM448Pc3+FKr1+94vv/rfw4tEcu+lKTBe4kZSdijBrykwv9vbCMPcLQTygBjzVckSLPRVGslqdunwJ4oegtFOYb4SwxNgWLCmD7T9kVjTv5YDgpo0XBmN34Z/rEHp0sgyz7lngsrm4lvMm2Mr1zNOJYJ5cuxuQxwMGJq/TP5emlb8fsQBZviK4t8hFL+zbhtlpwaRSxQRWfeETjuauPsdGxsBVdO7nmP4xvzSoT29pRl7kGqz+k26B3Oy0YNV+SXbbQas1ctC/GarskRdFpKczVAF1ZXnLcpaMuzVe6lZ2g/1ndcvOVgRG3sdUAY1bKD6achijMPdMxV4muKVorSpiDHituH7rSTs7n/4y5DhRXo4FVBN4vO/zbAcxhENzGbHCzU/98Mcx5e7a31kWjw9FCe/zNeYyQjZsWb1uc7U33pN4Mji6hCLhivqfa9Ss6xLg031AgfesA/l99m9fgvnaF9JoE6bYKmkGNK3aPbHB96w3+DnxFm4hs0drLsk7U8kf/N/CvwQNtllna0rjq61sH8L80HAuvwH1tvBy2ChqWSCaYTaGN19sTvlfzFD6n+iKTbvtayfrfe9ueWh6GJFoxLdr7V72a5ZpvHcCPDzma0wTO4EgbLyedxstO81n57LYBOBzyfsOhUKsW1J1BB5vr/tz8RyqOFylQP9Tvst2JALsC5lsH8PyQ40DV4ANzYa4dedNiKNR1s+x2wwbR7q4/4cTxqEk4LWDebfisuo36JXLiWFjOtLrlNWh3K1rRS4xvHcDNlFnNmWBBAl5SWaL3oPOfnvbr5pdjVnEaeBJSYjuLEkyLLsWhKccadmOphZkOPgVdalj2QpSmfOsADhMWE2ZBu4+EEJI4wKTAuCoC4xwQbWXBltpxbjkXJtKxxabo9e7tyhlgb6gNlSbUpMh+l/FaqzVwewGu8BW1Zx7pTpQDJUjb8tsUTW6+GDXbMn3mLbXlXJiGdggxFAoUrtPS3wE4Nk02UZG2OOzlk7fRs7i95QCLo3E0jtrjnM7SR3uS1p4qtS2nJ5OwtQVHgOvArLBFijZUV9QtSl8dAY5d0E0hM0w3HS2DpIeB6m/A1+HfhJcGUq4sOxH+x3f5+VO+Ds9rYNI7zPXOYWPrtf8bYMx6fuOAX5jzNR0PdsuON+X1f7EERxMJJoU6GkTEWBvVolVlb5lh3tKCg6Wx1IbaMDdJ+9sUCc5KC46hKGCk3IVOS4TCqdBNfUs7Kd4iXf2RjnT/LLysJy3XDcHLh/vde3x8DoGvwgsa67vBk91G5Pe/HbOe7xwym0NXbtiuuDkGO2IJDh9oQvJ4cY4vdoqLDuoH9Zl2F/ofsekn8lkuhIlhQcffUtSjytFyp++p6NiE7Rqx/lodgKVoceEp/CP4FfjrquZaTtj2AvH5K/ywpn7M34K/SsoYDAdIN448I1/0/wveW289T1/lX5xBzc8N5IaHr0XMOQdHsIkDuJFifj20pBm5jzwUv9e2FhwRsvhAbalCIuIw3bhJihY3p6nTFFIZgiSYjfTf3aXuOjmeGn4bPoGvwl+CFzTRczBIuHBEeImHc37/lGfwZR0cXzVDOvaKfNHvwe+suZ771K/y/XcBlsoN996JpBhoE2toYxOznNEOS5TJc6Id5GEXLjrWo+LEWGNpPDU4WAwsIRROu+1vM+0oW37z/MBN9kqHnSArwPfgFJ7Cq/Ai3Ie7g7ncmI09v8sjzw9mzOAEXoIHxURueaAce5V80f/DOuuZwHM8vsMb5wBzOFWM7wymTXPAEvm4vcFpZ2ut0VZRjkiP2MlmLd6DIpbGSiHOjdnUHN90hRYmhTnmvhzp1iKDNj+b7t5hi79lWGwQ+HN9RsfFMy0FXbEwhfuczKgCbyxYwBmcFhhvo/7a44v+i3XWcwDP86PzpGQYdWh7csP5dBvZ1jNzdxC8pBGuxqSW5vw40nBpj5JhMwvOzN0RWqERHMr4Lv1kWX84xLR830G3j6yqZ1a8UstTlW+qJPOZ+sZ7xZPKTJLhiNOAFd6tk+jrTH31ncLOxid8+nzRb128HhUcru/y0Wn6iT254YPC6FtVSIMoW2sk727AhvTtrWKZTvgsmckfXYZWeNRXx/3YQ2OUxLDrbHtN11IwrgXT6c8dATDwLniYwxzO4RzuQqTKSC5gAofMZ1QBK3zQ4JWobFbcvJm87FK+6JXrKahLn54m3p+McXzzYtP8VF/QpJuh1OwieElEoI1pRxPS09FBrkq2tWCU59+HdhNtTIqKm8EBrw2RTOEDpG3IKo2Y7mFdLm3ZeVjYwVw11o/oznceMve4CgMfNym/utA/d/ILMR7gpXzRy9eDsgLcgbs8O2Va1L0zzIdwGGemTBuwROHeoMShkUc7P+ISY3KH5ZZeWqO8mFTxQYeXTNuzvvK5FGPdQfuu00DwYFY9dyhctEt+OJDdnucfpmyhzUJzfsJjr29l8S0bXBfwRS9ZT26tmMIdZucch5ZboMz3Nio3nIOsYHCGoDT4kUA9MiXEp9Xsui1S8th/kbWIrMBxDGLodWUQIWcvnXy+9M23xPiSMOiRPqM+YMXkUN3gXFrZJwXGzUaMpJfyRS9ZT0lPe8TpScuRlbMHeUmlaKDoNuy62iWNTWNFYjoxFzuJs8oR+RhRx7O4SVNSXpa0ZJQ0K1LAHDQ+D9IepkMXpcsq5EVCvClBUIzDhDoyKwDw1Lc59GbTeORivugw1IcuaEOaGWdNm+Ps5fQ7/tm0DjMegq3yM3vb5j12qUId5UZD2oxDSEWOZMSqFl/W+5oynWDa/aI04tJRQ2eTXusg86SQVu/nwSYwpW6wLjlqIzwLuxGIvoAvul0PS+ZNz0/akp/pniO/8JDnGyaCkzbhl6YcqmK/69prxPqtpx2+Km9al9sjL+rwMgHw4jE/C8/HQ3m1vBuL1fldbzd8mOueVJ92syqdEY4KJjSCde3mcRw2TA6szxedn+zwhZMps0XrqEsiUjnC1hw0TELC2Ek7uAAdzcheXv1BYLagspxpzSAoZZUsIzIq35MnFQ9DOrlNB30jq3L4pkhccKUAA8/ocvN1Rzx9QyOtERs4CVsJRK/DF71kPYrxYsGsm6RMh4cps5g1DOmM54Ly1ii0Hd3Y/BMk8VWFgBVmhqrkJCPBHAolwZaWzLR9Vb7bcWdX9NyUYE+uB2BKfuaeBUcjDljbYVY4DdtsVWvzRZdWnyUzDpjNl1Du3aloAjVJTNDpcIOVVhrHFF66lLfJL1zJr9PQ2nFJSBaKoDe+sAvLufZVHVzYh7W0h/c6AAZ+7Tvj6q9j68G/cTCS/3n1vLKHZwNi+P+pS0WkZNMBMUl+LDLuiE4omZy71r3UFMwNJV+VJ/GC5ixVUkBStsT4gGKh0Gm4Oy3qvq7Lbmq24nPdDuDR9deR11XzP4vFu3TYzfnIyiSVmgizUYGqkIXNdKTY9pgb9D2Ix5t0+NHkVzCdU03suWkkVZAoCONCn0T35gAeW38de43mf97sMOpSvj4aa1KYUm58USI7Wxxes03bAZdRzk6UtbzMaCQ6IxO0dy7X+XsjoD16hpsBeGz9dfzHj+R/Hp8nCxZRqkEDTaCKCSywjiaoMJ1TITE9eg7Jqnq8HL6gDwiZb0u0V0Rr/rmvqjxKuaLCX7ZWXTvAY+uvm3z8CP7nzVpngqrJpZKwWnCUjIviYVlirlGOzPLI3SMVyp/elvBUjjDkNhrtufFFErQ8pmdSlbK16toBHlt/HV8uHMX/vEGALkV3RJREiSlopxwdMXOZPLZ+ix+kAHpMKIk8UtE1ygtquttwxNhphrIZ1IBzjGF3IIGxGcBj6q8bHJBG8T9vdsoWrTFEuebEZuVxhhClH6P5Zo89OG9fwHNjtNQTpD0TG9PJLEYqvEY6Rlxy+ZZGfL0Aj62/bnQCXp//eeM4KzfQVJbgMQbUjlMFIm6TpcfWlZje7NBSV6IsEVmumWIbjiloUzQX9OzYdo8L1wjw2PrrpimONfmfNyzKklrgnEkSzT5QWYQW40YShyzqsRmMXbvVxKtGuYyMKaU1ugenLDm5Ily4iT14fP11Mx+xJv+zZ3MvnfdFqxU3a1W/FTB4m3Qfsyc1XUcdVhDeUDZXSFHHLQj/Y5jtC7ZqM0CXGwB4bP11i3LhOvzPGygYtiUBiwQV/4wFO0majijGsafHyRLu0yG6q35cL1rOpVxr2s5cM2jJYMCdc10Aj6q/blRpWJ//+dmm5psMl0KA2+AFRx9jMe2WbC4jQxnikd4DU8TwUjRVacgdlhmr3bpddzuJ9zXqr2xnxJfzP29RexdtjDVZqzkqa6PyvcojGrfkXiJ8SEtml/nYskicv0ivlxbqjemwUjMw5evdg8fUX9nOiC/lf94Q2i7MURk9nW1MSj5j8eAyV6y5CN2S6qbnw3vdA1Iwq+XOSCl663udN3IzLnrt+us25cI1+Z83SXQUldqQq0b5XOT17bGpLd6ssN1VMPf8c+jG8L3NeCnMdF+Ra3fRa9dft39/LuZ/3vwHoHrqGmQFafmiQw6eyzMxS05K4bL9uA+SKUQzCnSDkqOGokXyJvbgJ/BHI+qvY69//4rl20NsmK2ou2dTsyIALv/91/8n3P2Aao71WFGi8KKv1fRC5+J67Q/507/E/SOshqN5TsmYIjVt+kcjAx98iz/4SaojbIV1rexE7/C29HcYD/DX4a0rBOF5VTu7omsb11L/AWcVlcVZHSsqGuXLLp9ha8I//w3Mv+T4Ew7nTBsmgapoCrNFObIcN4pf/Ob/mrvHTGqqgAupL8qWjWPS9m/31jAe4DjA+4+uCoQoT/zOzlrNd3qd4SdphFxsUvYwGWbTWtISc3wNOWH+kHBMfc6kpmpwPgHWwqaSUG2ZWWheYOGQGaHB+eQ/kn6b3pOgLV+ODSn94wDvr8Bvb70/LLuiPPEr8OGVWfDmr45PZyccEmsVXZGe1pRNX9SU5+AVQkNTIVPCHF/jGmyDC9j4R9LfWcQvfiETmgMMUCMN1uNCakkweZsowdYobiMSlnKA93u7NzTXlSfe+SVbfnPQXmg9LpYAQxpwEtONyEyaueWM4FPjjyjG3uOaFmBTWDNgBXGEiQpsaWhnAqIijB07Dlsy3fUGeP989xbWkyf+FF2SNEtT1E0f4DYYVlxFlbaSMPIRMk/3iMU5pME2SIWJvjckciebkQuIRRyhUvkHg/iUljG5kzVog5hV7vIlCuBrmlhvgPfNHQM8lCf+FEGsYbMIBC0qC9a0uuy2wLXVbLBaP5kjHokCRxapkQyzI4QEcwgYHRZBp+XEFTqXFuNVzMtjXLJgX4gAid24Hjwc4N3dtVSe+NNiwTrzH4WVUOlDobUqr1FuAgYllc8pmzoVrELRHSIW8ViPxNy4xwjBpyR55I6J220qQTZYR4guvUICJiSpr9gFFle4RcF/OMB7BRiX8sSfhpNSO3lvEZCQfLUVTKT78Ek1LRLhWN+yLyTnp8qWUZ46b6vxdRGXfHVqx3eI75YaLa4iNNiK4NOW7wPW6lhbSOF9/M9qw8e/aoB3d156qTzxp8pXx5BKAsYSTOIIiPkp68GmTq7sZtvyzBQaRLNxIZ+paozHWoLFeExIhRBrWitHCAHrCF7/thhD8JhYz84wg93QRV88wLuLY8zF8sQ36qF1J455bOlgnELfshKVxYOXKVuKx0jaj22sczTQqPqtV/XDgpswmGTWWMSDw3ssyUunLLrVPGjYRsH5ggHeHSWiV8kT33ycFSfMgkoOK8apCye0J6VW6GOYvffgU9RWsukEi2kUV2nl4dOYUzRik9p7bcA4ggdJ53LxKcEe17B1R8eqAd7dOepV8sTXf5lhejoL85hUdhDdknPtKHFhljOT+bdq0hxbm35p2nc8+Ja1Iw+tJykgp0EWuAAZYwMVwac5KzYMslhvgHdHRrxKnvhTYcfKsxTxtTETkjHO7rr3zjoV25lAQHrqpV7bTiy2aXMmUhTBnKS91jhtR3GEoF0oLnWhWNnYgtcc4N0FxlcgT7yz3TgNIKkscx9jtV1ZKpWW+Ub1tc1eOv5ucdgpx+FJy9pgbLE7xDyXb/f+hLHVGeitHOi6A7ybo3sF8sS7w7cgdk0nJaOn3hLj3uyD0Zp5pazFIUXUpuTTU18d1EPkDoX8SkmWTnVIozEdbTcZjoqxhNHf1JrSS/AcvHjZ/SMHhL/7i5z+POsTUh/8BvNfYMTA8n+yU/MlTZxSJDRStqvEuLQKWwDctMTQogUDyQRoTQG5Kc6oQRE1yV1jCA7ri7jdZyK0sYTRjCR0Hnnd+y7nHxNgTULqw+8wj0mQKxpYvhjm9uSUxg+TTy7s2GtLUGcywhXSKZN275GsqlclX90J6bRI1aouxmgL7Q0Nen5ziM80SqMIo8cSOo+8XplT/5DHNWsSUr/6lLN/QQ3rDyzLruEW5enpf7KqZoShEduuSFOV7DLX7Ye+GmXb6/hnNNqKsVXuMDFpb9Y9eH3C6NGEzuOuI3gpMH/I6e+zDiH1fXi15t3vA1czsLws0TGEtmPEJdiiFPwlwKbgLHAFk4P6ZyPdymYYHGE0dutsChQBl2JcBFlrEkY/N5bQeXQ18gjunuMfMfsBlxJSx3niO485fwO4fGD5T/+3fPQqkneWVdwnw/3bMPkW9Wbqg+iC765Zk+xcT98ibKZc2EdgHcLoF8cSOo/Oc8fS+OyEULF4g4sJqXVcmfMfsc7A8v1/yfGXmL9I6Fn5pRwZhsPv0TxFNlAfZCvG+Oohi82UC5f/2IsJo0cTOm9YrDoKhFPEUr/LBYTUNht9zelHXDqwfPCIw4owp3mOcIQcLttWXFe3VZ/j5H3cIc0G6oPbCR+6Y2xF2EC5cGUm6wKC5tGEzhsWqw5hNidUiKX5gFWE1GXh4/Qplw4sVzOmx9QxU78g3EF6wnZlEN4FzJ1QPSLEZz1KfXC7vd8ssGdIbNUYpVx4UapyFUHzJoTOo1McSkeNn1M5MDQfs4qQuhhX5vQZFw8suwWTcyYTgioISk2YdmkhehG4PkE7w51inyAGGaU+uCXADabGzJR1fn3lwkty0asIo8cROm9Vy1g0yDxxtPvHDAmpu+PKnM8Ix1wwsGw91YJqhteaWgjYBmmQiebmSpwKKzE19hx7jkzSWOm66oPbzZ8Yj6kxVSpYjVAuvLzYMCRo3oTQecOOjjgi3NQ4l9K5/hOGhNTdcWVOTrlgYNkEXINbpCkBRyqhp+LdRB3g0OU6rMfW2HPCFFMV9nSp+uB2woepdbLBuJQyaw/ZFysXrlXwHxI0b0LovEkiOpXGA1Ijagf+KUNC6rKNa9bQnLFqYNkEnMc1uJrg2u64ELPBHpkgWbmwKpJoDhMwNbbGzAp7Yg31wS2T5rGtzit59PrKhesWG550CZpHEzpv2NGRaxlNjbMqpmEIzygJqQfjypycs2pg2cS2RY9r8HUqkqdEgKTWtWTKoRvOBPDYBltja2SO0RGjy9UHtxwRjA11ujbKF+ti5cIR9eCnxUg6owidtyoU5tK4NLji5Q3HCtiyF2IqLGYsHViOXTXOYxucDqG0HyttqYAKqYo3KTY1ekyDXRAm2AWh9JmsVh/ccg9WJ2E8YjG201sPq5ULxxX8n3XLXuMInbft2mk80rRGjCGctJ8/GFdmEQ9Ug4FlE1ll1Y7jtiraqm5Fe04VV8lvSVBL8hiPrfFVd8+7QH3Qbu2ipTVi8cvSGivc9cj8yvH11YMHdNSERtuOslM97feYFOPKzGcsI4zW0YGAbTAOaxCnxdfiYUmVWslxiIblCeAYr9VYR1gM7GmoPrilunSxxeT3DN/2eBQ9H11+nk1adn6VK71+5+Jfct4/el10/7KBZfNryUunWSCPxPECk1rdOv1WVSrQmpC+Tl46YD3ikQYcpunSQgzVB2VHFhxHVGKDgMEY5GLlQnP7FMDzw7IacAWnO6sBr12u+XanW2AO0wQ8pknnFhsL7KYIqhkEPmEXFkwaN5KQphbkUmG72wgw7WSm9RiL9QT925hkjiVIIhphFS9HKI6/8QAjlpXqg9W2C0apyaVDwKQwrwLY3j6ADR13ZyUNByQXHQu6RY09Hu6zMqXRaNZGS/KEJs0cJEe9VH1QdvBSJv9h09eiRmy0V2uJcqHcShcdvbSNg5fxkenkVprXM9rDVnX24/y9MVtncvbKY706anNl3ASll9a43UiacVquXGhvq4s2FP62NGKfQLIQYu9q1WmdMfmUrDGt8eDS0cXozH/fjmUH6Jruvm50hBDSaEU/2Ru2LEN/dl006TSc/g7tfJERxGMsgDUEr104pfWH9lQaN+M4KWQjwZbVc2rZVNHsyHal23wZtIs2JJqtIc/WLXXRFCpJkfE9jvWlfFbsNQ9pP5ZBS0zKh4R0aMFj1IjTcTnvi0Zz2rt7NdvQb2mgbju1plsH8MmbnEk7KbK0b+wC2iy3aX3szW8xeZvDwET6hWZYwqTXSSG+wMETKum0Dq/q+x62gt2ua2ppAo309TRk9TPazfV3qL9H8z7uhGqGqxNVg/FKx0HBl9OVUORn8Q8Jx9gFttGQUDr3tzcXX9xGgN0EpzN9mdZ3GATtPhL+CjxFDmkeEU6x56kqZRusLzALXVqkCN7zMEcqwjmywDQ6OhyUe0Xao1Qpyncrg6wKp9XfWDsaZplElvQ/b3sdweeghorwBDlHzgk1JmMc/wiERICVy2VJFdMjFuLQSp3S0W3+sngt2njwNgLssFGVQdJ0tu0KH4ky1LW4yrbkuaA6Iy9oz/qEMMXMMDWyIHhsAyFZc2peV9hc7kiKvfULxCl9iddfRK1f8kk9qvbdOoBtOg7ZkOZ5MsGrSHsokgLXUp9y88smniwWyuFSIRVmjplga3yD8Uij5QS1ZiM4U3Qw5QlSm2bXjFe6jzzBFtpg+/YBbLAWG7OPynNjlCw65fukGNdkJRf7yM1fOxVzbxOJVocFoYIaGwH22mIQkrvu1E2nGuebxIgW9U9TSiukPGU+Lt++c3DJPKhyhEEbXCQLUpae2exiKy6tMPe9mDRBFCEMTWrtwxN8qvuGnt6MoihKWS5NSyBhbH8StXoAz8PLOrRgLtOT/+4vcu+7vDLnqNvztOq7fmd8sMmY9Xzn1zj8Dq8+XVdu2Nv0IIySgEdQo3xVHps3Q5i3fLFsV4aiqzAiBhbgMDEd1uh8qZZ+lwhjkgokkOIv4xNJmyncdfUUzgB4oFMBtiu71Xumpz/P+cfUP+SlwFExwWW62r7b+LSPxqxn/gvMZ5z9C16t15UbNlq+jbGJtco7p8wbYlL4alSyfWdeuu0j7JA3JFNuVAwtst7F7FhWBbPFNKIUORndWtLraFLmMu7KFVDDOzqkeaiN33YAW/r76wR4XDN/yN1z7hejPau06EddkS/6XThfcz1fI/4K736fO48vlxt2PXJYFaeUkFS8U15XE3428xdtn2kc8GQlf1vkIaNRRnOMvLTWrZbElEHeLWi1o0dlKPAh1MVgbbVquPJ5+Cr8LU5/H/+I2QlHIU2ClXM9G8v7Rr7oc/hozfUUgsPnb3D+I+7WF8kNO92GY0SNvuxiE+2Bt8prVJTkzE64sfOstxuwfxUUoyk8VjcTlsqe2qITSFoSj6Epd4KsT6BZOWmtgE3hBfir8IzZDwgV4ZTZvD8VvPHERo8v+vL1DASHTz/i9OlKueHDjK5Rnx/JB1Vb1ioXdBra16dmt7dgik10yA/FwJSVY6XjA3oy4SqM2frqDPPSRMex9qs3XQtoWxMj7/Er8GWYsXgjaVz4OYumP2+9kbxvny/6kvWsEBw+fcb5bInc8APdhpOSs01tEqIkoiZjbAqKMruLbJYddHuHFRIyJcbdEdbl2sVLaySygunutBg96Y2/JjKRCdyHV+AEFtTvIpbKIXOamknYSiB6KV/0JetZITgcjjk5ZdaskBtWO86UF0ap6ozGXJk2WNiRUlCPFir66lzdm/SLSuK7EUdPz8f1z29Skq6F1fXg8+5UVR6bszncP4Tn4KUkkdJ8UFCY1zR1i8RmL/qQL3rlei4THG7OODlnKko4oI01kd3CaM08Ia18kC3GNoVaO9iDh+hWxSyTXFABXoau7Q6q9OxYg/OVEMw6jdbtSrJ9cBcewGmaZmg+bvkUnUUaGr+ZfnMH45Ivevl61hMcXsxYLFTu1hTm2zViCp7u0o5l+2PSUh9bDj6FgYypufBDhqK2+oXkiuHFHR3zfj+9PtA8oR0xnqX8qn+sx3bFODSbbF0X8EUvWQ8jBIcjo5bRmLOljDNtcqNtOe756h3l0VhKa9hDd2l1eqmsnh0MNMT/Cqnx6BInumhLT8luljzQ53RiJeA/0dxe5NK0o2fA1+GLXr6eNQWHNUOJssQaTRlGpLHKL9fD+IrQzTOMZS9fNQD4AnRNVxvTdjC+fJdcDDWQcyB00B0t9BDwTxXgaAfzDZ/DBXzRnfWMFRwuNqocOmX6OKNkY63h5n/fFcB28McVHqnXZVI27K0i4rDLNE9lDKV/rT+udVbD8dFFu2GGZ8mOt0kAXcoX3ZkIWVtw+MNf5NjR2FbivROHmhV1/pj2egv/fMGIOWTIWrV3Av8N9imV9IWml36H6cUjqEWNv9aNc+veb2sH46PRaHSuMBxvtW+twxctq0z+QsHhux8Q7rCY4Ct8lqsx7c6Sy0dl5T89rIeEuZKoVctIk1hNpfavER6yyH1Vvm3MbsUHy4ab4hWr/OZPcsRBphnaV65/ZcdYPNNwsjN/djlf9NqCw9U5ExCPcdhKxUgLSmfROpLp4WSUr8ojdwbncbvCf+a/YzRaEc6QOvXcGO256TXc5Lab9POvB+AWY7PigWYjzhifbovuunzRawsO24ZqQQAqguBtmpmPB7ysXJfyDDaV/aPGillgz1MdQg4u5MYaEtBNNHFjkRlSpd65lp4hd2AVPTfbV7FGpyIOfmNc/XVsPfg7vzaS/3nkvLL593ANLvMuRMGpQIhiF7kUEW9QDpAUbTWYBcbp4WpacHHY1aacqQyjGZS9HI3yCBT9kUZJhVOD+zUDvEH9ddR11fzPcTDQ5TlgB0KwqdXSavk9BC0pKp0WmcuowSw07VXmXC5guzSa4p0UvRw2lbDiYUx0ExJJRzWzi6Gm8cnEkfXXsdcG/M/jAJa0+bmCgdmQ9CYlNlSYZOKixmRsgiFxkrmW4l3KdFKv1DM8tk6WxPYJZhUUzcd8Kdtgrw/gkfXXDT7+avmfVak32qhtkg6NVdUS5wgkru1YzIkSduTW1FDwVWV3JQVJVuieTc0y4iDpFwc7/BvSalvKdQM8sv662cevz/+8sQVnjVAT0W2wLllw1JiMhJRxgDjCjLQsOzSFSgZqx7lAW1JW0e03yAD3asC+GD3NbQhbe+mN5GXH1F83KDOM4n/e5JIuH4NpdQARrFPBVptUNcjj4cVMcFSRTE2NpR1LEYbYMmfWpXgP9KejaPsLUhuvLCsVXznAG9dfx9SR1ud/3hZdCLHb1GMdPqRJgqDmm76mHbvOXDtiO2QPUcKo/TWkQ0i2JFXpBoo7vij1i1Lp3ADAo+qvG3V0rM//vFnnTE4hxd5Ka/Cor5YEdsLVJyKtDgVoHgtW11pWSjolPNMnrlrVj9Fv2Qn60twMwKPqr+N/wvr8z5tZcDsDrv06tkqyzESM85Ycv6XBWA2birlNCXrI6VbD2lx2L0vQO0QVTVVLH4SE67fgsfVXv8n7sz7/85Z7cMtbE6f088wSaR4kCkCm10s6pKbJhfqiUNGLq+0gLWC6eUAZFPnLjwqtKd8EwGvWX59t7iPW4X/eAN1svgRVSY990YZg06BD1ohLMtyFTI4pKTJsS9xREq9EOaPWiO2gpms7397x6nQJkbh+Fz2q/rqRROX6/M8bJrqlVW4l6JEptKeUFuMYUbtCQ7CIttpGc6MY93x1r1vgAnRXvY5cvwWPqb9uWQm+lP95QxdNMeWhOq1x0Db55C7GcUv2ZUuN6n8iKzsvOxibC//Yfs9Na8r2Rlz02vXXDT57FP/zJi66/EJSmsJKa8QxnoqW3VLQ+jZVUtJwJ8PNX1NQCwfNgdhhHD9on7PdRdrdGPF28rJr1F+3LBdeyv+8yYfLoMYet1vX4upNAjVvwOUWnlNXJXlkzk5Il6kqeoiL0C07qno+/CYBXq/+utlnsz7/Mzvy0tmI4zm4ag23PRN3t/CWryoUVJGm+5+K8RJ0V8Hc88/XHUX/HfiAq7t+BH+x6v8t438enWmdJwFA6ZINriLGKv/95f8lT9/FnyA1NMVEvQyaXuu+gz36f/DD73E4pwqpLcvm/o0Vle78n//+L/NPvoefp1pTJye6e4A/D082FERa5/opeH9zpvh13cNm19/4v/LDe5xMWTi8I0Ta0qKlK27AS/v3/r+/x/2GO9K2c7kVMonDpq7//jc5PKCxeNPpFVzaRr01wF8C4Pu76hXuX18H4LduTr79guuFD3n5BHfI+ZRFhY8w29TYhbbLi/bvBdqKE4fUgg1pBKnV3FEaCWOWyA+m3WpORZr/j+9TKJtW8yBTF2/ZEODI9/QavHkVdGFp/Pjn4Q+u5hXapsP5sOH+OXXA1LiKuqJxiMNbhTkbdJTCy4llEt6NnqRT4dhg1V3nbdrm6dYMecA1yTOL4PWTE9L5VzPFlLBCvlG58AhehnN4uHsAYinyJ+AZ/NkVvELbfOBUuOO5syBIEtiqHU1k9XeISX5bsimrkUUhnGDxourN8SgUsCZVtKyGbyGzHXdjOhsAvOAswSRyIBddRdEZWP6GZhNK/yjwew9ehBo+3jEADu7Ay2n8mDc+TS7awUHg0OMzR0LABhqLD4hJEh/BEGyBdGlSJoXYXtr+3HS4ijzVpgi0paWXtdruGTknXBz+11qT1Q2inxaTzQCO46P3lfLpyS4fou2PH/PupwZgCxNhGlj4IvUuWEsTkqMWm6i4xCSMc9N1RDQoCVcuGItJ/MRWefais+3synowi/dESgJjkilnWnBTGvRWmaw8oR15257t7CHmCf8HOn7cwI8+NQBXMBEmAa8PMRemrNCEhLGEhDQKcGZWS319BX9PFBEwGTbRBhLbDcaV3drFcDqk5kCTd2JF1Wp0HraqBx8U0wwBTnbpCadwBA/gTH/CDrcCs93LV8E0YlmmcyQRQnjBa8JESmGUfIjK/7fkaDJpmD2QptFNVJU1bbtIAjjWQizepOKptRjbzR9Kag6xZmMLLjHOtcLT3Tx9o/0EcTT1XN3E45u24AiwEypDJXihKjQxjLprEwcmRKclaDNZCVqr/V8mYWyFADbusiY5hvgFoU2vio49RgJLn5OsReRFN6tabeetiiy0V7KFHT3HyZLx491u95sn4K1QQSPKM9hNT0wMVvAWbzDSVdrKw4zRjZMyJIHkfq1VAVCDl/bUhNKlGq0zGr05+YAceXVPCttVk0oqjVwMPt+BBefx4yPtGVkUsqY3CHDPiCM5ngupUwCdbkpd8kbPrCWHhkmtIKLEetF2499eS1jZlIPGYnlcPXeM2KD9vLS0bW3ktYNqUllpKLn5ZrsxlIzxvDu5eHxzGLctkZLEY4PgSOg2IUVVcUONzUDBEpRaMoXNmUc0tFZrTZquiLyKxrSm3DvIW9Fil+AkhXu5PhEPx9mUNwqypDvZWdKlhIJQY7vn2OsnmBeOWnYZ0m1iwbbw1U60by5om47iHRV6fOgzjMf/DAZrlP40Z7syxpLK0lJ0gqaAK1c2KQKu7tabTXkLFz0sCftuwX++MyNeNn68k5Buq23YQhUh0SNTJa1ioQ0p4nUG2y0XilF1JqODqdImloPS4Bp111DEWT0jJjVv95uX9BBV7eB3bUWcu0acSVM23YZdd8R8UbQUxJ9wdu3oMuhdt929ME+mh6JXJ8di2RxbTi6TbrDquqV4aUKR2iwT6aZbyOwEXN3DUsWr8Hn4EhwNyHuXHh7/pdaUjtR7vnDh/d8c9xD/s5f501eQ1+CuDiCvGhk1AN/4Tf74RfxPwD3toLarR0zNtsnPzmS64KIRk861dMWCU8ArasG9T9H0ZBpsDGnjtAOM2+/LuIb2iIUGXNgl5ZmKD/Tw8TlaAuihaFP5yrw18v4x1898zIdP+DDAX1bM3GAMvPgRP/cJn3zCW013nrhHkrITyvYuwOUkcHuKlRSW5C6rzIdY4ppnF7J8aAJbQepgbJYBjCY9usGXDKQxq7RZfh9eg5d1UHMVATRaD/4BHK93/1iAgYZ/+jqPn8Dn4UExmWrpa3+ZOK6MvM3bjwfzxNWA2dhs8+51XHSPJiaAhGSpWevEs5xHLXcEGFXYiCONySH3fPWq93JIsBiSWvWyc3CAN+EcXoT7rCSANloPPoa31rt/5PUA/gp8Q/jDD3hyrjzlR8VkanfOvB1XPubt17vzxAfdSVbD1pzAnfgyF3ycadOTOTXhpEUoLC1HZyNGW3dtmjeXgr2r56JNmRwdNNWaQVBddd6rh4MhviEB9EFRD/7RGvePvCbwAL4Mx/D6M541hHO4D3e7g6PafdcZVw689z7NGTwo5om7A8sPhccT6qKcl9NJl9aM/9kX+e59Hh1yPqGuCCZxuITcsmNaJ5F7d0q6J3H48TO1/+M57085q2icdu2U+W36Ldllz9Agiv4YGljoEN908EzvDOrBF98/vtJwCC/BF2AG75xxEmjmMIcjxbjoaxqOK3/4hPOZzhMPBpYPG44CM0dTVm1LjLtUWWVz1Bcf8tEx0zs8O2A2YVHRxKYOiy/aOVoAaMu0i7ubu43njjmd4ibMHU1sIDHaQNKrZND/FZYdk54oCXetjq7E7IVl9eAL7t+oHnwXXtLx44czzoRFHBztYVwtH1d+NOMkupZ5MTM+gUmq90X+Bh9zjRlmaQ+m7YMqUL/veemcecAtOJ0yq1JnVlN27di2E0+Klp1tAJ4KRw1eMI7aJjsO3R8kPSI3fUFXnIOfdQe86sIIVtWDL7h//Ok6vj8vwDk08NEcI8zz7OhBy+WwalzZeZ4+0XniRfst9pAJqQHDGLzVQ2pheZnnv1OWhwO43/AgcvAEXEVVpa4db9sGvNK8wjaENHkfFQ4Ci5i7dqnQlPoLQrHXZDvO3BIXZbJOBrOaEbML6sFL798I4FhKihjHMsPjBUZYCMFr6nvaArxqXPn4lCa+cHfSa2cP27g3Z3ziYTRrcbQNGLQmGF3F3cBdzzzX7AILx0IB9rbwn9kx2G1FW3Inic+ZLIsVvKR8Zwfj0l1fkqo8LWY1M3IX14OX3r9RKTIO+d9XzAI8qRPGPn/4NC2n6o4rN8XJ82TOIvuVA8zLKUHRFgBCetlDZlqR1gLKjS39xoE7Bt8UvA6BxuEDjU3tFsEijgA+615tmZkXKqiEENrh41iLDDZNq4pKTWR3LZfnos81LOuNa15cD956vLMsJd1rqYp51gDUQqMYm2XsxnUhD2jg1DM7SeuJxxgrmpfISSXVIJIS5qJJSvJPEQ49DQTVIbYWJ9QWa/E2+c/oPK1drmC7WSfJRNKBO5Yjvcp7Gc3dmmI/Xh1kDTEuiSnWqQf37h+fTMhGnDf6dsS8SQfQWlqqwXXGlc/PEZ/SC5mtzIV0nAshlQdM/LvUtYutrEZ/Y+EAFtq1k28zQhOwLr1AIeANzhF8t9qzTdZf2qRKO6MWE9ohBYwibbOmrFtNmg3mcS+tB28xv2uKd/agYCvOP+GkSc+0lr7RXzyufL7QbkUpjLjEWFLqOIkAGu2B0tNlO9Eau2W1qcOUvVRgKzypKIQZ5KI3q0MLzqTNRYqiZOqmtqloIRlmkBHVpHmRYV6/HixbO6UC47KOFJnoMrVyr7wYz+SlW6GUaghYbY1I6kkxA2W1fSJokUdSh2LQ1GAimRGm0MT+uu57H5l7QgOWxERpO9moLRPgTtquWCfFlGlIjQaRly9odmzMOWY+IBO5tB4sW/0+VWGUh32qYk79EidWKrjWuiLpiVNGFWFRJVktyeXWmbgBBzVl8anPuXyNJlBJOlKLTgAbi/EYHVHxWiDaVR06GnHQNpJcWcK2jJtiCfG2sEHLzuI66sGrMK47nPIInPnu799935aOK2cvmvubrE38ZzZjrELCmXM2hM7UcpXD2oC3+ECVp7xtIuxptJ0jUr3sBmBS47TVxlvJ1Sqb/E0uLdvLj0lLr29ypdd/eMX3f6lrxGlKwKQxEGvw0qHbkbwrF3uHKwVENbIV2wZ13kNEF6zD+x24aLNMfDTCbDPnEikZFyTNttxWBXDaBuM8KtI2rmaMdUY7cXcUPstqTGvBGSrFWIpNMfbdea990bvAOC1YX0qbc6smDS1mPxSJoW4fwEXvjMmhlijDRq6qale6aJEuFGoppYDoBELQzLBuh/mZNx7jkinv0EtnUp50lO9hbNK57lZaMAWuWR5Yo9/kYwcYI0t4gWM47Umnl3YmpeBPqSyNp3K7s2DSAS/39KRuEN2bS4xvowV3dFRMx/VFcp2Yp8w2nTO9hCXtHG1kF1L4KlrJr2wKfyq77R7MKpFKzWlY9UkhYxyHWW6nBWPaudvEAl3CGcNpSXPZ6R9BbBtIl6cHL3gIBi+42CYXqCx1gfGWe7Ap0h3luyXdt1MKy4YUT9xSF01G16YEdWsouW9mgDHd3veyA97H+Ya47ZmEbqMY72oPztCGvK0onL44AvgC49saZKkWRz4veWljE1FHjbRJaWv6ZKKtl875h4CziFCZhG5rx7tefsl0aRT1bMHZjm8dwL/6u7wCRysaQblQoG5yAQN5zpatMNY/+yf8z+GLcH/Qn0iX2W2oEfXP4GvwQHuIL9AYGnaO3zqAX6946nkgqZNnUhx43DIdQtMFeOPrgy/y3Yd85HlJWwjLFkU3kFwq28xPnuPhMWeS+tDLV9Otllq7pQCf3uXJDN9wFDiUTgefHaiYbdfi3b3u8+iY6TnzhgehI1LTe8lcd7s1wJSzKbahCRxKKztTLXstGAiu3a6rPuQs5pk9TWAan5f0BZmGf7Ylxzzk/A7PAs4QPPPAHeFQ2hbFHszlgZuKZsJcUmbDC40sEU403cEjczstOEypa+YxevL4QBC8oRYqWdK6b7sK25tfE+oDZgtOQ2Jg8T41HGcBE6fTWHn4JtHcu9S7uYgU5KSCkl/mcnq+5/YBXOEr6lCUCwOTOM1taOI8mSxx1NsCXBEmLKbMAg5MkwbLmpBaFOPrNSlO2HnLiEqW3tHEwd8AeiQLmn+2gxjC3k6AxREqvKcJbTEzlpLiw4rNZK6oJdidbMMGX9FULKr0AkW+2qDEPBNNm5QAt2Ik2nftNWHetubosHLo2nG4vQA7GkcVCgVCgaDixHqo9UUn1A6OshapaNR/LPRYFV8siT1cCtJE0k/3WtaNSuUZYKPnsVIW0xXWnMUxq5+En4Kvw/MqQmVXnAXj9Z+9zM98zM/Agy7F/qqj2Nh67b8HjFnPP3iBn/tkpdzwEJX/whIcQUXOaikeliCRGUk7tiwF0rItwMEhjkZ309hikFoRAmLTpEXWuHS6y+am/KB/fM50aLEhGnSMwkpxzOov4H0AvgovwJ1iGzDLtJn/9BU+fAINfwUe6FHSLhu83viV/+/HrOePX+STT2B9uWGbrMHHLldRBlhS/CJQmcRxJFqZica01XixAZsYiH1uolZxLrR/SgxVIJjkpQP4PE9sE59LKLr7kltSBogS5tyszzH8Fvw8/AS8rNOg0xUS9fIaHwb+6et8Q/gyvKRjf5OusOzGx8evA/BP4IP11uN/grca5O0lcsPLJ5YjwI4QkJBOHa0WdMZYGxPbh2W2nR9v3WxEWqgp/G3+6VZbRLSAAZ3BhdhAaUL33VUSw9yjEsvbaQ9u4A/gGXwZXoEHOuU1GSj2chf+Mo+f8IcfcAxfIKVmyunRbYQVnoevwgfw3TXXcw++xNuP4fhyueEUNttEduRVaDttddoP0eSxLe2LENk6itYxlrxBNBYrNNKSQmeaLcm9c8UsaB5WyO6675yyQIAWSDpBVoA/gxmcwEvwoDv0m58UE7gHn+fJOa8/Ywan8EKRfjsopF83eCglX/Sfr7OeaRoQfvt1CGvIDccH5BCvw1sWIzRGC/66t0VTcLZQZtm6PlAasbOJ9iwWtUo7biktTSIPxnR24jxP1ZKaqq+2RcXM9OrBAm/AAs7hDJ5bNmGb+KIfwCs8a3jnjBrOFeMjHSCdbKr+2uOLfnOd9eiA8Hvvwwq54VbP2OqwkB48Ytc4YEOiH2vTXqodabfWEOzso4qxdbqD5L6tbtNPECqbhnA708DZH4QOJUXqScmUlks7Ot6FBuZw3n2mEbaUX7kDzxHOOQk8nKWMzAzu6ZZ8sOFw4RK+6PcuXo9tB4SbMz58ApfKDXf3szjNIIbGpD5TKTRxGkEMLjLl+K3wlWXBsCUxIDU+jbOiysESqAy1MGUJpXgwbTWzNOVEziIXZrJ+VIztl1PUBxTSo0dwn2bOmfDRPD3TRTGlfbCJvO9KvuhL1hMHhB9wPuPRLGHcdOWG2xc0U+5bQtAJT0nRTewXL1pgk2+rZAdeWmz3jxAqfNQQdzTlbF8uJ5ecEIWvTkevAHpwz7w78QujlD/Lr491bD8/1vhM2yrUQRrWXNQY4fGilfctMWYjL72UL/qS9eiA8EmN88nbNdour+PBbbAjOjIa4iBhfFg6rxeKdEGcL6p3EWR1Qq2Qkhs2DrnkRnmN9tG2EAqmgPw6hoL7Oza7B+3SCrR9tRftko+Lsf2F/mkTndN2LmzuMcKTuj/mX2+4Va3ki16+nnJY+S7MefpkidxwnV+4wkXH8TKnX0tsYzYp29DOOoSW1nf7nTh2akYiWmcJOuTidSaqESrTYpwjJJNVGQr+rLI7WsqerHW6Kp/oM2pKuV7T1QY9gjqlZp41/WfKpl56FV/0kvXQFRyeQ83xaTu5E8p5dNP3dUF34ihyI3GSpeCsywSh22ZJdWto9winhqifb7VRvgktxp13vyjrS0EjvrRfZ62uyqddSWaWYlwTPAtJZ2oZ3j/Sgi/mi+6vpzesfAcWNA0n8xVyw90GVFGuZjTXEQy+6GfLGLMLL523f5E0OmxVjDoOuRiH91RKU+vtoCtH7TgmvBLvtFXWLW15H9GTdVw8ow4IlRLeHECN9ym1e9K0I+Cbnhgv4Yu+aD2HaQJ80XDqOzSGAV4+4yCqBxrsJAX6ZTIoX36QnvzhhzzMfFW2dZVLOJfo0zbce5OvwXMFaZ81mOnlTVXpDZsQNuoYWveketKb5+6JOOsgX+NTm7H49fUTlx+WLuWL7qxnOFh4BxpmJx0p2gDzA/BUARuS6phR+pUsY7MMboAHx5xNsSVfVZcYSwqCKrqon7zM+8ecCkeS4nm3rINuaWvVNnMRI1IRpxTqx8PZUZ0Br/UEduo3B3hNvmgZfs9gQPj8vIOxd2kndir3awvJ6BLvoUuOfFWNYB0LR1OQJoUySKb9IlOBx74q1+ADC2G6rOdmFdJcD8BkfualA+BdjOOzP9uUhGUEX/TwhZsUduwRr8wNuXKurCixLBgpQI0mDbJr9dIqUuV+92ngkJZ7xduCk2yZKbfWrH1VBiTg9VdzsgRjW3CVXCvAwDd+c1z9dWw9+B+8MJL/eY15ZQ/HqvTwVdsZn5WQsgRRnMaWaecu3jFvMBEmgg+FJFZsnSl0zjB9OqPYaBD7qmoVyImFvzi41usesV0julaAR9dfR15Xzv9sEruRDyk1nb+QaLU67T885GTls6YgcY+UiMa25M/pwGrbCfzkvR3e0jjtuaFtnwuagHTSb5y7boBH119HXhvwP487jJLsLJ4XnUkHX5sLbS61dpiAXRoZSCrFJ+EjpeU3puVfitngYNo6PJrAigKktmwjyQdZpfq30mmtulaAx9Zfx15Xzv+cyeuiBFUs9zq8Kq+XB9a4PVvph3GV4E3y8HENJrN55H1X2p8VyqSKwVusJDKzXOZzplWdzBUFK9e+B4+uv468xvI/b5xtSAkBHQaPvtqWzllVvEOxPbuiE6+j2pvjcKsbvI7txnRErgfH7LdXqjq0IokKzga14GzQ23SSbCQvO6r+Or7SMIr/efOkkqSdMnj9mBx2DRsiY29Uj6+qK9ZrssCKaptR6HKURdwUYeUWA2kPzVKQO8ku2nU3Anhs/XWkBx3F/7wJtCTTTIKftthue1ty9xvNYLY/zo5KSbIuKbXpbEdSyeRyYdAIwKY2neyoc3+k1XUaufYga3T9daMUx/r8z1s10ITknIO0kuoMt+TB8jK0lpayqqjsJ2qtXAYwBU932zinimgmd6mTRDnQfr88q36NAI+tv24E8Pr8zxtasBqx0+xHH9HhlrwsxxNUfKOHQaZBITNf0uccj8GXiVmXAuPEAKSdN/4GLHhs/XWj92dN/uetNuBMnVR+XWDc25JLjo5Mg5IZIq226tmCsip2zZliL213YrTlL2hcFjpCduyim3M7/eB16q/blQsv5X/esDRbtJeabLIosWy3ycavwLhtxdWzbMmHiBTiVjJo6lCLjXZsi7p9PEPnsq6X6wd4bP11i0rD5fzPm/0A6brrIsllenZs0lCJlU4abakR59enZKrKe3BZihbTxlyZ2zl1+g0wvgmA166/bhwDrcn/7Ddz0eWZuJvfSESug6NzZsox3Z04FIxz0mUjMwVOOVTq1CQ0AhdbBGVdjG/CgsfUX7esJl3K/7ytWHRv683praW/8iDOCqWLLhpljDY1ZpzK75QiaZoOTpLKl60auHS/97oBXrv+umU9+FL+5+NtLFgjqVLCdbmj7pY5zPCPLOHNCwXGOcLquOhi8CmCWvbcuO73XmMUPab+ug3A6/A/78Bwe0bcS2+tgHn4J5pyS2WbOck0F51Vq3LcjhLvZ67p1ABbaL2H67bg78BfjKi/jr3+T/ABV3ilLmNXTI2SpvxWBtt6/Z//D0z/FXaGbSBgylzlsEGp+5//xrd4/ae4d8DUUjlslfIYS3t06HZpvfQtvv0N7AHWqtjP2pW08QD/FLy//da38vo8PNlKHf5y37Dxdfe/oj4kVIgFq3koLReSR76W/bx//n9k8jonZxzWTANVwEniDsg87sOSd/z7//PvMp3jQiptGVWFX2caezzAXwfgtzYUvbr0iozs32c3Uge7varH+CNE6cvEYmzbPZ9hMaYDdjK4V2iecf6EcEbdUDVUARda2KzO/JtCuDbNQB/iTeL0EG1JSO1jbXS+nLxtPMDPw1fh5+EPrgSEKE/8Gry5A73ui87AmxwdatyMEBCPNOCSKUeRZ2P6Myb5MRvgCHmA9ywsMifU+AYXcB6Xa5GibUC5TSyerxyh0j6QgLVpdyhfArRTTLqQjwe4HOD9s92D4Ap54odXAPBWLAwB02igG5Kkc+piN4lvODIFGAZgT+EO4Si1s7fjSR7vcQETUkRm9O+MXyo9OYhfe4xt9STQ2pcZRLayCV90b4D3jR0DYAfyxJ+eywg2IL7NTMXna7S/RpQ63JhWEM8U41ZyQGjwsVS0QBrEKLu8xwZsbi4wLcCT+OGidPIOCe1PiSc9Qt+go+vYqB7cG+B9d8cAD+WJPz0Am2gxXgU9IneOqDpAAXOsOltVuMzpdakJXrdPCzXiNVUpCeOos5cxnpQT39G+XVLhs1osQVvJKPZyNq8HDwd4d7pNDuWJPxVX7MSzqUDU6gfadKiNlUFTzLeFHHDlzO4kpa7aiKhBPGKwOqxsBAmYkOIpipyXcQSPlRTf+Tii0U3EJGaZsDER2qoB3h2hu0qe+NNwUooYU8y5mILbJe6OuX+2FTKy7bieTDAemaQyQ0CPthljSWO+xmFDIYiESjM5xKd6Ik5lvLq5GrQ3aCMLvmCA9wowLuWJb9xF59hVVP6O0CrBi3ZjZSNOvRy+I6klNVRJYRBaEzdN+imiUXQ8iVF8fsp+W4JXw7WISW7fDh7lptWkCwZ4d7QTXyBPfJMYK7SijjFppGnlIVJBJBYj7eUwtiP1IBXGI1XCsjNpbjENVpSAJ2hq2LTywEly3hUYazt31J8w2+aiLx3g3fohXixPfOMYm6zCGs9LVo9MoW3MCJE7R5u/WsOIjrqBoHUO0bJE9vxBpbhsd3+Nb4/vtPCZ4oZYCitNeYuC/8UDvDvy0qvkiW/cgqNqRyzqSZa/s0mqNGjtKOoTm14zZpUauiQgVfqtQiZjq7Q27JNaSK5ExRcrGCXO1FJYh6jR6CFqK7bZdQZ4t8g0rSlPfP1RdBtqaa9diqtzJkQ9duSryi2brQXbxDwbRUpFMBHjRj8+Nt7GDKgvph9okW7LX47gu0SpGnnFQ1S1lYldOsC7hYteR574ZuKs7Ei1lBsfdz7IZoxzzCVmmVqaSySzQbBVAWDek+N4jh9E/4VqZrJjPwiv9BC1XcvOWgO8275CVyBPvAtTVlDJfZkaZGU7NpqBogAj/xEHkeAuJihWYCxGN6e8+9JtSegFXF1TrhhLGP1fak3pebgPz192/8gB4d/6WT7+GdYnpH7hH/DJzzFiYPn/vjW0SgNpTNuPIZoAEZv8tlGw4+RLxy+ZjnKa5NdFoC7UaW0aduoYse6+bXg1DLg6UfRYwmhGEjqPvF75U558SANrElK/+MdpXvmqBpaXOa/MTZaa1DOcSiLaw9j0NNNst3c+63c7EKTpkvKHzu6bPbP0RkuHAVcbRY8ijP46MIbQeeT1mhA+5PV/inyDdQipf8LTvMXbwvoDy7IruDNVZKTfV4CTSRUYdybUCnGU7KUTDxLgCknqUm5aAW6/1p6eMsOYsphLzsHrE0Y/P5bQedx1F/4yPHnMB3/IOoTU9+BL8PhtjuFKBpZXnYNJxTuv+2XqolKR2UQgHhS5novuxVySJhBNRF3SoKK1XZbbXjVwWNyOjlqWJjrWJIy+P5bQedyldNScP+HZ61xKSK3jyrz+NiHG1hcOLL/+P+PDF2gOkekKGiNWKgJ+8Z/x8Iv4DdQHzcpZyF4v19I27w9/yPGDFQvmEpKtqv/TLiWMfn4sofMm9eAH8Ao0zzh7h4sJqYtxZd5/D7hkYPneDzl5idlzNHcIB0jVlQ+8ULzw/nc5/ojzl2juE0apD7LRnJxe04dMz2iOCFNtGFpTuXA5AhcTRo8mdN4kz30nVjEC4YTZQy4gpC7GlTlrePKhGsKKgeXpCYeO0MAd/GH7yKQUlXPLOasOH3FnSphjHuDvEu4gB8g66oNbtr6eMbFIA4fIBJkgayoXriw2XEDQPJrQeROAlY6aeYOcMf+IVYTU3XFlZufMHinGywaW3YLpObVBAsbjF4QJMsVUSayjk4voPsHJOQfPWDhCgDnmDl6XIRerD24HsGtw86RMHOLvVSHrKBdeVE26gKB5NKHzaIwLOmrqBWJYZDLhASG16c0Tn+CdRhWDgWXnqRZUTnPIHuMJTfLVpkoYy5CzylHVTGZMTwkGAo2HBlkQplrJX6U+uF1wZz2uwS1SQ12IqWaPuO4baZaEFBdukksJmkcTOm+YJSvoqPFzxFA/YUhIvWxcmSdPWTWwbAKVp6rxTtPFUZfKIwpzm4IoMfaYQLWgmlG5FME2gdBgm+J7J+rtS/XBbaVLsR7bpPQnpMFlo2doWaVceHk9+MkyguZNCJ1He+kuHTWyQAzNM5YSUg/GlTk9ZunAsg1qELVOhUSAK0LABIJHLKbqaEbHZLL1VA3VgqoiOKXYiS+HRyaEKgsfIqX64HYWbLRXy/qWoylIV9gudL1OWBNgBgTNmxA6b4txDT4gi3Ri7xFSLxtXpmmYnzAcWDZgY8d503LFogz5sbonDgkKcxGsWsE1OI+rcQtlgBBCSOKD1mtqYpIU8cTvBmAT0yZe+zUzeY92fYjTtGipXLhuR0ePoHk0ofNWBX+lo8Z7pAZDk8mEw5L7dVyZZoE/pTewbI6SNbiAL5xeygW4xPRuLCGbhcO4RIeTMFYHEJkYyEO9HmJfXMDEj/LaH781wHHZEtqSQ/69UnGpzH7LKIAZEDSPJnTesJTUa+rwTepI9dLJEawYV+ZkRn9g+QirD8vF8Mq0jFQ29js6kCS3E1+jZIhgPNanHdHFqFvPJLHqFwQqbIA4jhDxcNsOCCQLDomaL/dr5lyJaJU6FxPFjO3JOh3kVMcROo8u+C+jo05GjMF3P3/FuDLn5x2M04xXULPwaS6hBYki+MrMdZJSgPHlcB7nCR5bJ9Kr5ACUn9jk5kivdd8tk95SOGrtqu9lr2IhK65ZtEl7ZKrp7DrqwZfRUSN1el7+7NJxZbywOC8neNKTch5vsTEMNsoCCqHBCqIPRjIPkm0BjvFODGtto99rCl+d3wmHkW0FPdpZtC7MMcVtGFQjJLX5bdQ2+x9ypdc313uj8xlsrfuLgWXz1cRhZvJYX0iNVBRcVcmCXZs6aEf3RQF2WI/TcCbKmGU3IOoDJGDdDub0+hYckt6PlGu2BcxmhbTdj/klhccLGJMcqRjMJP1jW2ETqLSWJ/29MAoORluJ+6LPffBZbi5gqi5h6catQpmOT7/OFf5UorRpLzCqcMltBLhwd1are3kztrSzXO0LUbXRQcdLh/RdSZ+swRm819REDrtqzC4es6Gw4JCKlSnjYVpo0xeq33PrADbFLL3RuCmObVmPN+24kfa+AojDuM4umKe2QwCf6EN906HwjujaitDs5o0s1y+k3lgbT2W2i7FJdnwbLXhJUBq/9liTctSmFC/0OqUinb0QddTWamtjbHRFuWJJ6NpqZ8vO3fZJ37Db+2GkaPYLGHs7XTTdiFQJ68SkVJFVmY6McR5UycflNCsccHFaV9FNbR4NttLxw4pQ7wJd066Z0ohVbzihaxHVExd/ay04oxUKWt+AsdiQ9OUyZ2krzN19IZIwafSTFgIBnMV73ADj7V/K8u1MaY2sJp2HWm0f41tqwajEvdHWOJs510MaAqN4aoSiPCXtN2KSi46dUxHdaMquar82O1x5jqhDGvqmoE9LfxcY3zqA7/x3HA67r9ZG4O6Cuxu12/+TP+eLP+I+HErqDDCDVmBDO4larujNe7x8om2rMug0MX0rL1+IWwdwfR+p1TNTyNmVJ85ljWzbWuGv8/C7HD/izjkHNZNYlhZcUOKVzKFUxsxxN/kax+8zPWPSFKw80rJr9Tizyj3o1gEsdwgWGoxPezDdZ1TSENE1dLdNvuKL+I84nxKesZgxXVA1VA1OcL49dFlpFV5yJMhzyCmNQ+a4BqusPJ2bB+xo8V9u3x48VVIEPS/mc3DvAbXyoYr6VgDfh5do5hhHOCXMqBZUPhWYbWZECwVJljLgMUWOCB4MUuMaxGNUQDVI50TQ+S3kFgIcu2qKkNSHVoM0SHsgoZxP2d5HH8B9woOk4x5bPkKtAHucZsdykjxuIpbUrSILgrT8G7G5oCW+K0990o7E3T6AdW4TilH5kDjds+H64kS0mz24grtwlzDHBJqI8YJQExotPvoC4JBq0lEjjQkyBZ8oH2LnRsQ4Hu1QsgDTJbO8fQDnllitkxuVskoiKbRF9VwzMDvxHAdwB7mD9yCplhHFEyUWHx3WtwCbSMMTCUCcEmSGlg4gTXkHpZXWQ7kpznK3EmCHiXInqndkQjunG5kxTKEeGye7jWz9cyMR2mGiFQ15ENRBTbCp+Gh86vAyASdgmJq2MC6hoADQ3GosP0QHbnMHjyBQvQqfhy/BUbeHd5WY/G/9LK/8Ka8Jd7UFeNWEZvzPb458Dn8DGLOe3/wGL/4xP+HXlRt+M1PE2iLhR8t+lfgxsuh7AfO2AOf+owWhSZRYQbd622hbpKWKuU+XuvNzP0OseRDa+mObgDHJUSc/pKx31QdKffQ5OIJpt8GWjlgTwMc/w5MPCR/yl1XC2a2Yut54SvOtMev55Of45BOat9aWG27p2ZVORRvnEk1hqWMVUmqa7S2YtvlIpspuF1pt0syuZS2NV14mUidCSfzQzg+KqvIYCMljIx2YK2AO34fX4GWdu5xcIAb8MzTw+j/lyWM+Dw/gjs4GD6ehNgA48kX/AI7XXM/XAN4WHr+9ntywqoCakCqmKP0rmQrJJEErG2Upg1JObr01lKQy4jskWalKYfJ/EDLMpjNSHFEUAde2fltaDgmrNaWQ9+AAb8I5vKjz3L1n1LriB/BXkG/wwR9y/oRX4LlioHA4LzP2inzRx/DWmutRweFjeP3tNeSGlaE1Fde0OS11yOpmbIp2u/jF1n2RRZviJM0yBT3IZl2HWImKjQOxIyeU325b/qWyU9Moj1o07tS0G7qJDoGHg5m8yeCxMoEH8GU45tnrNM84D2l297DQ9t1YP7jki/7RmutRweEA77/HWXOh3HCxkRgldDQkAjNTMl2Iloc1qN5JfJeeTlyTRzxURTdn1Ixv2uKjs12AbdEWlBtmVdk2k7FFwj07PCZ9XAwW3dG+8xKzNFr4EnwBZpy9Qzhh3jDXebBpYcpuo4fQ44u+fD1dweEnHzI7v0xuuOALRUV8rXpFyfSTQYkhd7IHm07jpyhlkCmI0ALYqPTpUxXS+z4jgDj1Pflvmz5ecuItpIBxyTHpSTGWd9g1ApfD/bvwUhL4nT1EzqgX7cxfCcNmb3mPL/qi9SwTHJ49oj5ZLjccbTG3pRmlYi6JCG0mQrAt1+i2UXTZ2dv9IlQpN5naMYtviaXlTrFpoMsl3bOAFEa8sqPj2WCMrx3Yjx99qFwO59Aw/wgx+HlqNz8oZvA3exRDvuhL1jMQHPaOJ0+XyA3fp1OfM3qObEVdhxjvynxNMXQV4+GJyvOEFqeQBaIbbO7i63rpxCltdZShPFxkjM2FPVkn3TG+Rp9pO3l2RzFegGfxGDHIAh8SteR0C4HopXzRF61nheDw6TFN05Ebvq8M3VKKpGjjO6r7nhudTEGMtYM92HTDaR1FDMXJ1eThsbKfywyoWwrzRSXkc51flG3vIid62h29bIcFbTGhfV+faaB+ohj7dPN0C2e2lC96+XouFByen9AsunLDJZ9z7NExiUc0OuoYW6UZkIyx2YUR2z6/TiRjyKMx5GbbjLHvHuf7YmtKghf34LJfx63Yg8vrvN2zC7lY0x0tvKezo4HmGYDU+Gab6dFL+KI761lDcNifcjLrrr9LWZJctG1FfU1uwhoQE22ObjdfkSzY63CbU5hzs21WeTddH2BaL11Gi7lVdlxP1nkxqhnKhVY6knS3EPgVGg1JpN5cP/hivujOelhXcPj8HC/LyI6MkteVjlolBdMmF3a3DbsuAYhL44dxzthWSN065xxUd55Lmf0wRbOYOqH09/o9WbO2VtFdaMb4qBgtFJoT1SqoN8wPXMoXLb3p1PUEhxfnnLzGzBI0Ku7FxrKsNJj/8bn/H8fPIVOd3rfrklUB/DOeO+nkghgSPzrlPxluCMtOnDL4Yml6dK1r3vsgMxgtPOrMFUZbEUbTdIzii5beq72G4PD0DKnwjmBULUVFmy8t+k7fZ3pKc0Q4UC6jpVRqS9Umv8bxw35flZVOU1X7qkjnhZlsMbk24qQ6Hz7QcuL6sDC0iHHki96Uh2UdvmgZnjIvExy2TeJdMDZNSbdZyAHe/Yd1xsQhHiKzjh7GxQ4yqMPaywPkjMamvqrYpmO7Knad+ZQC5msCuAPWUoxrxVhrGv7a+KLXFhyONdTMrZ7ke23qiO40ZJUyzgYyX5XyL0mV7NiUzEs9mjtbMN0dERqwyAJpigad0B3/zRV7s4PIfXSu6YV/MK7+OrYe/JvfGMn/PHJe2fyUdtnFrKRNpXV0Y2559aWPt/G4BlvjTMtXlVIWCnNyA3YQBDmYIodFz41PvXPSa6rq9lWZawZ4dP115HXV/M/tnFkkrBOdzg6aP4pID+MZnTJ1SuuB6iZlyiox4HT2y3YBtkUKWooacBQUDTpjwaDt5poBHl1/HXltwP887lKKXxNUEyPqpGTyA699UqY/lt9yGdlUKra0fFWS+36iylVWrAyd7Uw0CZM0z7xKTOduznLIjG2Hx8cDPLb+OvK6Bv7n1DYci4CxUuRxrjBc0bb4vD3rN5Zz36ntLb83eVJIB8LiIzCmn6SMPjlX+yNlTjvIGjs+QzHPf60Aj62/jrzG8j9vYMFtm1VoRWCJdmw7z9N0t+c8cxZpPeK4aTRicS25QhrVtUp7U578chk4q04Wx4YoQSjFryUlpcQ1AbxZ/XVMknIU//OGl7Q6z9Zpxi0+3yFhSkjUDpnCIUhLWVX23KQ+L9vKvFKI0ZWFQgkDLvBoylrHNVmaw10zwCPrr5tlodfnf94EWnQ0lFRWy8pW9LbkLsyUVDc2NSTHGDtnD1uMtchjbCeb1mpxFP0YbcClhzdLu6lfO8Bj6q+bdT2sz/+8SZCV7VIxtt0DUn9L7r4cLYWDSXnseEpOGFuty0qbOVlS7NNzs5FOGJUqQpl2Q64/yBpZf90sxbE+//PGdZ02HSipCbmD6NItmQ4Lk5XUrGpDMkhbMm2ZVheNYV+VbUWTcv99+2NyX1VoafSuC+AN6q9bFIMv5X/eagNWXZxEa9JjlMwNWb00akGUkSoepp1/yRuuqHGbUn3UdBSTxBU6SEVklzWRUkPndVvw2PrrpjvxOvzPmwHc0hpmq82npi7GRro8dXp0KXnUQmhZbRL7NEVp1uuZmO45vuzKsHrktS3GLWXODVjw+vXXLYx4Hf7njRPd0i3aoAGX6W29GnaV5YdyDj9TFkakje7GHYzDoObfddHtOSpoi2SmzJHrB3hM/XUDDEbxP2/oosszcRlehWXUvzHv4TpBVktHqwenFo8uLVmy4DKLa5d3RtLrmrM3aMFr1183E4sewf+85VWeg1c5ag276NZrM9IJVNcmLEvDNaV62aq+14IAOGFsBt973Ra8Xv11YzXwNfmft7Jg2oS+XOyoC8/cwzi66Dhmgk38kUmP1CUiYWOX1bpD2zWXt2FCp7uq8703APAa9dfNdscR/M/bZLIyouVxqJfeWvG9Je+JVckHQ9+CI9NWxz+blX/KYYvO5n2tAP/vrlZ7+8/h9y+9qeB/Hnt967e5mevX10rALDWK//FaAT5MXdBXdP0C/BAes792c40H+AiAp1e1oH8HgH94g/Lttx1gp63op1eyoM/Bvw5/G/7xFbqJPcCXnmBiwDPb/YKO4FX4OjyCb289db2/Noqicw4i7N6TVtoz8tNwDH+8x/i6Ae7lmaQVENzJFb3Di/BFeAwz+Is9SjeQySpPqbLFlNmyz47z5a/AF+AYFvDmHqibSXTEzoT4Gc3OALaqAP4KPFUJ6n+1x+rGAM6Zd78bgJ0a8QN4GU614vxwD9e1Amy6CcskNrczLx1JIp6HE5UZD/DBHrFr2oNlgG4Odv226BodoryjGJ9q2T/AR3vQrsOCS0ctXZi3ruLlhpFDJYl4HmYtjQCP9rhdn4suySLKDt6wLcC52h8xPlcjju1fn+yhuw4LZsAGUuo2b4Fx2UwQu77uqRHXGtg92aN3tQCbFexc0uk93vhTXbct6y7MulLycoUljx8ngDMBg1tvJjAazpEmOtxlzclvj1vQf1Tx7QlPDpGpqgtdSKz/d9/hdy1vTfFHSmC9dGDZbLiezz7Ac801HirGZsWjydfZyPvHXL/Y8Mjzg8BxTZiuwKz4Eb8sBE9zznszmjvFwHKPIWUnwhqfVRcd4Ck0K6ate48m1oOfrX3/yOtvAsJ8zsPAM89sjnddmuLuDPjX9Bu/L7x7xpMzFk6nWtyQfPg278Gn4Aekz2ZgOmU9eJ37R14vwE/BL8G3aibCiWMWWDQ0ZtkPMnlcGeAu/Ag+8ZyecU5BPuy2ILD+sQqyZhAKmn7XZd+jIMTN9eBL7x95xVLSX4On8EcNlXDqmBlqS13jG4LpmGbkF/0CnOi3H8ETOIXzmnmtb0a16Tzxj1sUvQCBiXZGDtmB3KAefPH94xcUa/6vwRn80GOFyjEXFpba4A1e8KQfFF+259tx5XS4egYn8fQsLGrqGrHbztr+uByTahWuL1NUGbDpsnrwBfePPwHHIf9X4RnM4Z2ABWdxUBlqQ2PwhuDxoS0vvqB1JzS0P4h2nA/QgTrsJFn+Y3AOjs9JFC07CGWX1oNX3T/yHOzgDjwPn1PM3g9Jk9lZrMEpxnlPmBbjyo2+KFXRU52TJM/2ALcY57RUzjObbjqxVw++4P6RAOf58pcVsw9Daje3htriYrpDOonre3CudSe6bfkTEgHBHuDiyu5MCsc7BHhYDx7ePxLjqigXZsw+ijMHFhuwBmtoTPtOxOrTvYJDnC75dnUbhfwu/ZW9AgYd+peL68HD+0emKquiXHhWjJg/UrkJYzuiaL3E9aI/ytrCvAd4GcYZMCkSQxfUg3v3j8c4e90j5ZTPdvmJJGHnOCI2nHS8081X013pHuBlV1gB2MX1YNmWLHqqGN/TWmG0y6clJWthxNUl48q38Bi8vtMKyzzpFdSDhxZ5WBA5ZLt8Jv3895DduBlgbPYAj8C4B8hO68FDkoh5lydC4FiWvBOVqjYdqjiLv92t8yPDjrDaiHdUD15qkSURSGmXJwOMSxWAXYwr3zaAufJ66l+94vv3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/wHuD9tQd4f+0B3l97gPfXHuD9tQd4f+0B3l97gG8LwP8G/AL8O/A5OCq0Ys2KIdv/qOIXG/4mvFAMF16gZD+2Xvu/B8as5+8bfllWyg0zaNO5bfXj6vfhhwD86/Aq3NfRS9t9WPnhfnvCIw/CT8GLcFTMnpntdF/z9V+PWc/vWoIH+FL3Znv57PitcdGP4R/C34avw5fgRVUInCwbsn1yyA8C8zm/BH8NXoXnVE6wVPjdeCI38kX/3+Ct9dbz1pTmHFRu+Hm4O9Ch3clr99negxfwj+ER/DR8EV6B5+DuQOnTgUw5rnkY+FbNU3gNXh0o/JYTuWOvyBf9FvzX663HH/HejO8LwAl8Hl5YLTd8q7sqA3wbjuExfAFegQdwfyDoSkWY8swzEf6o4Qyewefg+cHNbqMQruSL/u/WWc+E5g7vnnEXgDmcDeSGb/F4cBcCgT+GGRzDU3hZYburAt9TEtHgbM6JoxJ+6NMzzTcf6c2bycv2+KK/f+l6LBzw5IwfqZJhA3M472pWT/ajKxnjv4AFnMEpnBTPND6s2J7qHbPAqcMK74T2mZ4VGB9uJA465It+/eL1WKhYOD7xHOkr1ajK7d0C4+ke4Hy9qXZwpgLr+Znm/uNFw8xQOSy8H9IzjUrd9+BIfenYaylf9FsXr8fBAadnPIEDna8IBcwlxnuA0/Wv6GAWPd7dDIKjMdSWueAsBj4M7TOd06qBbwDwKr7oleuxMOEcTuEZTHWvDYUO7aHqAe0Bbq+HEFRzOz7WVoTDQkVds7A4sIIxfCQdCefFRoIOF/NFL1mPab/nvOakSL/Q1aFtNpUb/nFOVX6gzyg/1nISyDfUhsokIzaBR9Kxm80s5mK+6P56il1jXic7nhQxsxSm3OwBHl4fFdLqi64nDQZvqE2at7cWAp/IVvrN6/BFL1mPhYrGMBfOi4PyjuSGf6wBBh7p/FZTghCNWGgMzlBbrNJoPJX2mW5mwZfyRffXo7OFi5pZcS4qZUrlViptrXtw+GQoyhDPS+ANjcGBNRiLCQDPZPMHuiZfdFpPSTcQwwKYdRNqpkjm7AFeeT0pJzALgo7g8YYGrMHS0iocy+YTm2vyRUvvpXCIpQ5pe666TJrcygnScUf/p0NDs/iAI/nqDHC8TmQT8x3NF91l76oDdQGwu61Z6E0ABv7uO1dbf/37Zlv+Zw/Pbh8f1s4Avur6657/+YYBvur6657/+YYBvur6657/+YYBvur6657/+aYBvuL6657/+VMA8FXWX/f8zzcN8BXXX/f8zzcNMFdbf93zP38KLPiK6697/uebtuArrr/u+Z9vGmCusP6653/+1FjwVdZf9/zPN7oHX339dc//fNMu+irrr3v+50+Bi+Zq6697/uebA/jz8Pudf9ht/fWv517J/XUzAP8C/BAeX9WCDrUpZ3/dEMBxgPcfbtTVvsYV5Yn32u03B3Ac4P3b8I+vxNBKeeL9dRMAlwO83959qGO78sT769oB7g3w/vGVYFzKE++v6wV4OMD7F7tckFkmT7y/rhHgpQO8b+4Y46XyxPvrugBeNcB7BRiX8sT767oAvmCA9woAHsoT76+rBJjLBnh3txOvkifeX1dswZcO8G6N7sXyxPvr6i340gHe3TnqVfLE++uKAb50gHcXLnrX8sR7gNdPRqwzwLu7Y/FO5Yn3AK9jXCMGeHdgxDuVJ75VAI8ljP7PAb3/RfjcZfePHBB+79dpfpH1CanN30d+mT1h9GqAxxJGM5LQeeQ1+Tb+EQJrElLb38VHQ94TRq900aMIo8cSOo+8Dp8QfsB8zpqE1NO3OI9Zrj1h9EV78PqE0WMJnUdeU6E+Jjyk/hbrEFIfeWbvId8H9oTRFwdZaxJGvziW0Hn0gqYB/wyZ0PwRlxJST+BOw9m77Amj14ii1yGM/txYQudN0qDzGe4EqfA/5GJCagsHcPaEPWH0esekSwmjRxM6b5JEcZ4ww50ilvAOFxBSx4yLW+A/YU8YvfY5+ALC6NGEzhtmyZoFZoarwBLeZxUhtY4rc3bKnjB6TKJjFUHzJoTOozF2YBpsjcyxDgzhQ1YRUse8+J4wenwmaylB82hC5w0zoRXUNXaRBmSMQUqiWSWkLsaVqc/ZE0aPTFUuJWgeTei8SfLZQeMxNaZSIzbII4aE1Nmr13P2hNHjc9E9guYNCZ032YlNwESMLcZiLQHkE4aE1BFg0yAR4z1h9AiAGRA0jyZ03tyIxWMajMPWBIsxYJCnlITU5ShiHYdZ94TR4wCmSxg9jtB5KyPGYzymAYexWEMwAPIsAdYdV6aObmNPGD0aYLoEzaMJnTc0Ygs+YDw0GAtqxBjkuP38bMRWCHn73xNGjz75P73WenCEJnhwyVe3AEe8TtKdJcYhBl97wuhNAObK66lvD/9J9NS75v17wuitAN5fe4D31x7g/bUHeH/tAd5fe4D3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/w/toDvAd4f/24ABzZ8o+KLsSLS+Pv/TqTb3P4hKlQrTGh+fbIBT0Axqznnb+L/V2mb3HkN5Mb/nEHeK7d4IcDld6lmDW/iH9E+AH1MdOw/Jlu2T1xNmY98sv4wHnD7D3uNHu54WUuOsBTbQuvBsPT/UfzNxGYzwkP8c+Yz3C+r/i6DcyRL/rZ+utRwWH5PmfvcvYEt9jLDS/bg0/B64DWKrQM8AL8FPwS9beQCe6EMKNZYJol37jBMy35otdaz0Bw2H/C2Smc7+WGB0HWDELBmOByA3r5QONo4V+DpzR/hFS4U8wMW1PXNB4TOqYz9urxRV++ntWCw/U59Ty9ebdWbrgfRS9AYKKN63ZokZVygr8GZ/gfIhZXIXPsAlNjPOLBby5c1eOLvmQ9lwkOy5x6QV1j5TYqpS05JtUgUHUp5toHGsVfn4NX4RnMCe+AxTpwmApTYxqMxwfCeJGjpXzRF61nbcHhUBPqWze9svwcHJ+S6NPscKrEjug78Dx8Lj3T8D4YxGIdxmJcwhi34fzZUr7olevZCw5vkOhoClq5zBPZAnygD/Tl9EzDh6kl3VhsHYcDEb+hCtJSvuiV69kLDm+WycrOTArHmB5/VYyP6jOVjwgGawk2zQOaTcc1L+aLXrKeveDwZqlKrw8U9Y1p66uK8dEzdYwBeUQAY7DbyYNezBfdWQ97weEtAKYQg2xJIkuveAT3dYeLGH+ShrWNwZgN0b2YL7qznr3g8JYAo5bQBziPjx7BPZ0d9RCQp4UZbnFdzBddor4XHN4KYMrB2qHFRIzzcLAHQZ5the5ovui94PCWAPefaYnxIdzRwdHCbuR4B+tbiy96Lzi8E4D7z7S0mEPd+eqO3cT53Z0Y8SV80XvB4Z0ADJi/f7X113f+7p7/+UYBvur6657/+YYBvur6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+VMA8FXWX/f8z58OgK+y/rrnf75RgLna+uue//lTA/CV1V/3/M837aKvvv6653++UQvmauuve/7nTwfAV1N/3fM/fzr24Cuuv+75nz8FFnxl9dc9//MOr/8/glixwRuUfM4AAAAASUVORK5CYII="},getSearchTexture:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII="}});var Pp=function(t,e,n,r){Ch.call(this),this.scene=t,this.camera=e,this.sampleLevel=4,this.unbiased=!0,this.clearColor=void 0!==n?n:0,this.clearAlpha=void 0!==r?r:0,void 0===ep&&console.error("SSAARenderPass relies on CopyShader");var i=ep;this.copyUniforms=tl.clone(i.uniforms),this.copyMaterial=new dt({uniforms:this.copyUniforms,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,premultipliedAlpha:!0,transparent:!0,blending:Go,depthTest:!1,depthWrite:!1}),this.camera2=new ct(-1,1,1,-1,0,1),this.scene2=new ut,this.quad2=new B(new ft(2,2),this.copyMaterial),this.quad2.frustumCulled=!1,this.scene2.add(this.quad2)};Pp.prototype=Object.assign(Object.create(Ch.prototype),{constructor:Pp,dispose:function(){this.sampleRenderTarget&&(this.sampleRenderTarget.dispose(),this.sampleRenderTarget=null)},setSize:function(t,e){this.sampleRenderTarget&&this.sampleRenderTarget.setSize(t,e)},render:function(t,e,n){this.sampleRenderTarget||(this.sampleRenderTarget=new pt(n.width,n.height,{minFilter:ja,magFilter:ja,format:ns}),this.sampleRenderTarget.texture.name="SSAARenderPass.sample");var r=Pp.JitterVectors[Math.max(0,Math.min(this.sampleLevel,5))],i=t.autoClear;t.autoClear=!1;var o=t.getClearColor().getHex(),a=t.getClearAlpha(),s=1/r.length;this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture;for(var l=n.width,u=n.height,c=0;c<r.length;c++){var h=r[c];this.camera.setViewOffset&&this.camera.setViewOffset(l,u,.0625*h[0],.0625*h[1],l,u);var p=s;if(this.unbiased){p+=1/32*((c+.5)/r.length-.5)}this.copyUniforms.opacity.value=p,t.setClearColor(this.clearColor,this.clearAlpha),t.render(this.scene,this.camera,this.sampleRenderTarget,!0),0===c&&t.setClearColor(0,0),t.render(this.scene2,this.camera2,this.renderToScreen?null:e,0===c)}this.camera.clearViewOffset&&this.camera.clearViewOffset(),t.autoClear=i,t.setClearColor(o,a)}}),Pp.JitterVectors=[[[0,0]],[[4,4],[-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]];var Op={uniforms:{tDiffuse:{value:null},tDepth:{value:null},size:{value:new m(512,512)},cameraNear:{value:1},cameraFar:{value:100},radius:{value:32},onlyAO:{value:0},aoClamp:{value:.25},lumInfluence:{value:.7}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float cameraNear;","uniform float cameraFar;","#ifdef USE_LOGDEPTHBUF","uniform float logDepthBufFC;","#endif","uniform float radius;","uniform bool onlyAO;","uniform vec2 size;","uniform float aoClamp;","uniform float lumInfluence;","uniform sampler2D tDiffuse;","uniform sampler2D tDepth;","varying vec2 vUv;","#define DL 2.399963229728653","#define EULER 2.718281828459045","const int samples = 64;","const bool useNoise = true;","const float noiseAmount = 0.0004;","const float diffArea = 0.4;","const float gDisplace = 0.4;","#include <packing>","vec2 rand( const vec2 coord ) {","vec2 noise;","if ( useNoise ) {","float nx = dot ( coord, vec2( 12.9898, 78.233 ) );","float ny = dot ( coord, vec2( 12.9898, 78.233 ) * 2.0 );","noise = clamp( fract ( 43758.5453 * sin( vec2( nx, ny ) ) ), 0.0, 1.0 );","} else {","float ff = fract( 1.0 - coord.s * ( size.x / 2.0 ) );","float gg = fract( coord.t * ( size.y / 2.0 ) );","noise = vec2( 0.25, 0.75 ) * vec2( ff ) + vec2( 0.75, 0.25 ) * gg;","}","return ( noise * 2.0  - 1.0 ) * noiseAmount;","}","float readDepth( const in vec2 coord ) {","float cameraFarPlusNear = cameraFar + cameraNear;","float cameraFarMinusNear = cameraFar - cameraNear;","float cameraCoef = 2.0 * cameraNear;","#ifdef USE_LOGDEPTHBUF","float logz = unpackRGBAToDepth( texture2D( tDepth, coord ) );","float w = pow(2.0, (logz / logDepthBufFC)) - 1.0;","float z = (logz / w) + 1.0;","#else","float z = unpackRGBAToDepth( texture2D( tDepth, coord ) );","#endif","return cameraCoef / ( cameraFarPlusNear - z * cameraFarMinusNear );","}","float compareDepths( const in float depth1, const in float depth2, inout int far ) {","float garea = 8.0;","float diff = ( depth1 - depth2 ) * 100.0;","if ( diff < gDisplace ) {","garea = diffArea;","} else {","far = 1;","}","float dd = diff - gDisplace;","float gauss = pow( EULER, -2.0 * ( dd * dd ) / ( garea * garea ) );","return gauss;","}","float calcAO( float depth, float dw, float dh ) {","vec2 vv = vec2( dw, dh );","vec2 coord1 = vUv + radius * vv;","vec2 coord2 = vUv - radius * vv;","float temp1 = 0.0;","float temp2 = 0.0;","int far = 0;","temp1 = compareDepths( depth, readDepth( coord1 ), far );","if ( far > 0 ) {","temp2 = compareDepths( readDepth( coord2 ), depth, far );","temp1 += ( 1.0 - temp1 ) * temp2;","}","return temp1;","}","void main() {","vec2 noise = rand( vUv );","float depth = readDepth( vUv );","float tt = clamp( depth, aoClamp, 1.0 );","float w = ( 1.0 / size.x ) / tt + ( noise.x * ( 1.0 - noise.x ) );","float h = ( 1.0 / size.y ) / tt + ( noise.y * ( 1.0 - noise.y ) );","float ao = 0.0;","float dz = 1.0 / float( samples );","float l = 0.0;","float z = 1.0 - dz / 2.0;","for ( int i = 0; i <= samples; i ++ ) {","float r = sqrt( 1.0 - z );","float pw = cos( l ) * r;","float ph = sin( l ) * r;","ao += calcAO( depth, pw * w, ph * h );","z = z - dz;","l = l + DL;","}","ao /= float( samples );","ao = 1.0 - ao;","vec3 color = texture2D( tDiffuse, vUv ).rgb;","vec3 lumcoeff = vec3( 0.299, 0.587, 0.114 );","float lum = dot( color.rgb, lumcoeff );","vec3 luminance = vec3( lum );","vec3 final = vec3( color * mix( vec3( ao ), vec3( 1.0 ), luminance * lumInfluence ) );","if ( onlyAO ) {","final = vec3( mix( vec3( ao ), vec3( 1.0 ), luminance * lumInfluence ) );","}","gl_FragColor = vec4( final, 1.0 );","}"].join("\n")},Np=function(t,e,n,r){if(void 0===Op)return console.warn("SSAOPass depends on SSAOShader"),new Eh;Eh.call(this,Op),this.width=void 0!==n?n:512,this.height=void 0!==r?r:256,this.renderToScreen=!1,this.camera2=e,this.scene2=t,this.depthMaterial=new lt,this.depthMaterial.depthPacking=Ws,this.depthMaterial.blending=zo,this.depthRenderTarget=new pt(this.width,this.height,{minFilter:ja,magFilter:ja}),this.uniforms.tDepth.value=this.depthRenderTarget.texture,this.uniforms.size.value.set(this.width,this.height),this.uniforms.cameraNear.value=this.camera2.near,this.uniforms.cameraFar.value=this.camera2.far,this.uniforms.radius.value=4,this.uniforms.onlyAO.value=!1,this.uniforms.aoClamp.value=.25,this.uniforms.lumInfluence.value=.7,Object.defineProperties(this,{radius:{get:function(){return this.uniforms.radius.value},set:function(t){this.uniforms.radius.value=t}},onlyAO:{get:function(){return this.uniforms.onlyAO.value},set:function(t){this.uniforms.onlyAO.value=t}},aoClamp:{get:function(){return this.uniforms.aoClamp.value},set:function(t){this.uniforms.aoClamp.value=t}},lumInfluence:{get:function(){return this.uniforms.lumInfluence.value},set:function(t){this.uniforms.lumInfluence.value=t}}})};(Np.prototype=Object.create(Eh.prototype)).render=function(t,e,n,r,i){this.scene2.overrideMaterial=this.depthMaterial,t.render(this.scene2,this.camera2,this.depthRenderTarget,!0),this.scene2.overrideMaterial=null,Eh.prototype.render.call(this,t,e,n,r,i)},Np.prototype.setScene=function(t){this.scene2=t},Np.prototype.setCamera=function(t){this.camera2=t,this.uniforms.cameraNear.value=this.camera2.near,this.uniforms.cameraFar.value=this.camera2.far},Np.prototype.setSize=function(t,e){this.width=t,this.height=e,this.uniforms.size.value.set(this.width,this.height),this.depthRenderTarget.setSize(this.width,this.height)};var Lp=function(t,e,n){void 0===Pp&&console.error("TAARenderPass relies on SSAARenderPass"),Pp.call(this,t,e,n),this.sampleLevel=0,this.accumulate=!1};Lp.JitterVectors=Pp.JitterVectors,Lp.prototype=Object.assign(Object.create(Pp.prototype),{constructor:Lp,render:function(t,e,n,r){if(!this.accumulate)return Pp.prototype.render.call(this,t,e,n,r),void(this.accumulateIndex=-1);var i=Lp.JitterVectors[5];this.sampleRenderTarget||(this.sampleRenderTarget=new pt(n.width,n.height,this.params),this.sampleRenderTarget.texture.name="TAARenderPass.sample"),this.holdRenderTarget||(this.holdRenderTarget=new pt(n.width,n.height,this.params),this.holdRenderTarget.texture.name="TAARenderPass.hold"),this.accumulate&&-1===this.accumulateIndex&&(Pp.prototype.render.call(this,t,this.holdRenderTarget,n,r),this.accumulateIndex=0);var o=t.autoClear;t.autoClear=!1;var a=1/i.length;if(this.accumulateIndex>=0&&this.accumulateIndex<i.length){this.copyUniforms.opacity.value=a,this.copyUniforms.tDiffuse.value=e.texture;for(var s=Math.pow(2,this.sampleLevel),l=0;l<s;l++){var u=i[this.accumulateIndex];if(this.camera.setViewOffset&&this.camera.setViewOffset(n.width,n.height,.0625*u[0],.0625*u[1],n.width,n.height),t.render(this.scene,this.camera,e,!0),t.render(this.scene2,this.camera2,this.sampleRenderTarget,0===this.accumulateIndex),this.accumulateIndex++,this.accumulateIndex>=i.length)break}this.camera.clearViewOffset&&this.camera.clearViewOffset()}var c=this.accumulateIndex*a;c>0&&(this.copyUniforms.opacity.value=1,this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture,t.render(this.scene2,this.camera2,e,!0)),c<1&&(this.copyUniforms.opacity.value=1-c,this.copyUniforms.tDiffuse.value=this.holdRenderTarget.texture,t.render(this.scene2,this.camera2,e,0===c)),t.autoClear=o}});var Ip=function(t,e){Ch.call(this),void 0===ep&&console.error("TexturePass relies on CopyShader");var n=ep;this.map=t,this.opacity=void 0!==e?e:1,this.uniforms=tl.clone(n.uniforms),this.material=new dt({uniforms:this.uniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,depthTest:!1,depthWrite:!1}),this.needsSwap=!1,this.camera=new ct(-1,1,1,-1,0,1),this.scene=new ut,this.quad=new B(new mt(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};Ip.prototype=Object.assign(Object.create(Ch.prototype),{constructor:Ip,render:function(t,e,n,r,i){var o=t.autoClear;t.autoClear=!1,this.quad.material=this.material,this.uniforms.opacity.value=this.opacity,this.uniforms.tDiffuse.value=this.map,this.material.transparent=this.opacity<1,t.render(this.scene,this.camera,this.renderToScreen?null:n,this.clear),t.autoClear=o}});var Dp={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{type:"t",value:null},luminosityThreshold:{type:"f",value:1},smoothWidth:{type:"f",value:1},defaultColor:{type:"c",value:new h(0)},defaultOpacity:{type:"f",value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 defaultColor;","uniform float defaultOpacity;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float v = dot( texel.xyz, luma );","vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );","float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","gl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")},Fp=function(t,e,n,r){Ch.call(this),this.strength=void 0!==e?e:1,this.radius=n,this.threshold=r,this.resolution=void 0!==t?new m(t.x,t.y):new m(256,256);var o={minFilter:ja,magFilter:ja,format:ns};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;var a=Math.round(this.resolution.x/2),s=Math.round(this.resolution.y/2);this.renderTargetBright=new pt(a,s,o),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(var l=0;l<this.nMips;l++){(u=new pt(a,s,o)).texture.name="UnrealBloomPass.h"+l,u.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(u);var u;(u=new pt(a,s,o)).texture.name="UnrealBloomPass.v"+l,u.texture.generateMipmaps=!1,this.renderTargetsVertical.push(u),a=Math.round(a/2),s=Math.round(s/2)}void 0===Dp&&console.error("UnrealBloomPass relies on LuminosityHighPassShader");var c=Dp;this.highPassUniforms=tl.clone(c.uniforms),this.highPassUniforms.luminosityThreshold.value=r,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new dt({uniforms:this.highPassUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,defines:{}}),this.separableBlurMaterials=[];var p=[3,5,7,9,11];for(a=Math.round(this.resolution.x/2),s=Math.round(this.resolution.y/2),l=0;l<this.nMips;l++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(p[l])),this.separableBlurMaterials[l].uniforms.texSize.value=new m(a,s),a=Math.round(a/2),s=Math.round(s/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=e,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new i(1,1,1),new i(1,1,1),new i(1,1,1),new i(1,1,1),new i(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,void 0===ep&&console.error("BloomPass relies on CopyShader");var d=ep;this.copyUniforms=tl.clone(d.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new dt({uniforms:this.copyUniforms,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,blending:Go,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new h,this.oldClearAlpha=1,this.camera=new ct(-1,1,1,-1,0,1),this.scene=new ut,this.basic=new D,this.quad=new B(new mt(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};Fp.prototype=Object.assign(Object.create(Ch.prototype),{constructor:Fp,dispose:function(){for(var t=0;t<this.renderTargetsHorizontal.length;t++)this.renderTargetsHorizontal[t].dispose();for(t=0;t<this.renderTargetsVertical.length;t++)this.renderTargetsVertical[t].dispose();this.renderTargetBright.dispose()},setSize:function(t,e){var n=Math.round(t/2),r=Math.round(e/2);this.renderTargetBright.setSize(n,r);for(var i=0;i<this.nMips;i++)this.renderTargetsHorizontal[i].setSize(n,r),this.renderTargetsVertical[i].setSize(n,r),this.separableBlurMaterials[i].uniforms.texSize.value=new m(n,r),n=Math.round(n/2),r=Math.round(r/2)},render:function(t,e,n,r,i){this.oldClearColor.copy(t.getClearColor()),this.oldClearAlpha=t.getClearAlpha();var o=t.autoClear;t.autoClear=!1,t.setClearColor(new h(0,0,0),0),i&&t.context.disable(t.context.STENCIL_TEST),this.renderToScreen&&(this.quad.material=this.basic,this.basic.map=n.texture,t.render(this.scene,this.camera,void 0,!0)),this.highPassUniforms.tDiffuse.value=n.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.quad.material=this.materialHighPassFilter,t.render(this.scene,this.camera,this.renderTargetBright,!0);for(var a=this.renderTargetBright,s=0;s<this.nMips;s++)this.quad.material=this.separableBlurMaterials[s],this.separableBlurMaterials[s].uniforms.colorTexture.value=a.texture,this.separableBlurMaterials[s].uniforms.direction.value=Fp.BlurDirectionX,t.render(this.scene,this.camera,this.renderTargetsHorizontal[s],!0),this.separableBlurMaterials[s].uniforms.colorTexture.value=this.renderTargetsHorizontal[s].texture,this.separableBlurMaterials[s].uniforms.direction.value=Fp.BlurDirectionY,t.render(this.scene,this.camera,this.renderTargetsVertical[s],!0),a=this.renderTargetsVertical[s];this.quad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,t.render(this.scene,this.camera,this.renderTargetsHorizontal[0],!0),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,i&&t.context.enable(t.context.STENCIL_TEST),t.render(this.scene,this.camera,this.renderToScreen?void 0:n,!1),t.setClearColor(this.oldClearColor,this.oldClearAlpha),t.autoClear=o},getSeperableBlurMaterial:function(t){return new dt({defines:{KERNEL_RADIUS:t,SIGMA:t},uniforms:{colorTexture:{value:null},texSize:{value:new m(.5,.5)},direction:{value:new m(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat fSigma = float(SIGMA);\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\t\t\t\t\t\tfloat x = float(i);\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\t\t\t\t\t\tweightSum += 2.0 * w;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})},getCompositeMaterial:function(t){return new dt({defines:{NUM_MIPS:t},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D blurTexture1;\t\t\t\tuniform sampler2D blurTexture2;\t\t\t\tuniform sampler2D blurTexture3;\t\t\t\tuniform sampler2D blurTexture4;\t\t\t\tuniform sampler2D blurTexture5;\t\t\t\tuniform sampler2D dirtTexture;\t\t\t\tuniform float bloomStrength;\t\t\t\tuniform float bloomRadius;\t\t\t\tuniform float bloomFactors[NUM_MIPS];\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\t\t\t\t\t\t\t\tfloat lerpBloomFactor(const in float factor) { \t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\t\t\t\t}\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\t\t\t\t}"})}}),Fp.BlurDirectionX=new m(1,0),Fp.BlurDirectionY=new m(0,1);Object.assign(Dn.prototype,{set:function(t,e,n,r,i,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;n<6;n++)e[n].copy(t.planes[n]);return this},setFromMatrix:function(t){var e=this.planes,n=t.elements,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],l=n[5],u=n[6],c=n[7],h=n[8],p=n[9],d=n[10],f=n[11],m=n[12],v=n[13],g=n[14],y=n[15];return e[0].setComponents(a-r,c-s,f-h,y-m).normalize(),e[1].setComponents(a+r,c+s,f+h,y+m).normalize(),e[2].setComponents(a+i,c+l,f+p,y+v).normalize(),e[3].setComponents(a-i,c-l,f-p,y-v).normalize(),e[4].setComponents(a-o,c-u,f-d,y-g).normalize(),e[5].setComponents(a+o,c+u,f+d,y+g).normalize(),this},intersectsObject:function(){var t=new f;return function(e){var n=e.geometry;return null===n.boundingSphere&&n.computeBoundingSphere(),t.copy(n.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSprite:function(){var t=new f;return function(e){return t.center.set(0,0,0),t.radius=.7071067811865476,t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){for(var e=this.planes,n=t.center,r=-t.radius,i=0;i<6;i++){if(e[i].distanceToPoint(n)<r)return!1}return!0},intersectsBox:function(){var t=new i,e=new i;return function(n){for(var r=this.planes,i=0;i<6;i++){var o=r[i];t.x=o.normal.x>0?n.min.x:n.max.x,e.x=o.normal.x>0?n.max.x:n.min.x,t.y=o.normal.y>0?n.min.y:n.max.y,e.y=o.normal.y>0?n.max.y:n.min.y,t.z=o.normal.z>0?n.min.z:n.max.z,e.z=o.normal.z>0?n.max.z:n.min.z;var a=o.distanceToPoint(t),s=o.distanceToPoint(e);if(a<0&&s<0)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}});var Rp=function(){this.id=0,this.object=null,this.z=0,this.renderOrder=0},kp=function(){this.id=0,this.v1=new Up,this.v2=new Up,this.v3=new Up,this.normalModel=new i,this.vertexNormalsModel=[new i,new i,new i],this.vertexNormalsLength=0,this.color=new h,this.material=null,this.uvs=[new m,new m,new m],this.z=0,this.renderOrder=0},Up=function(){this.position=new i,this.positionWorld=new i,this.positionScreen=new g,this.visible=!0};Up.prototype.copy=function(t){this.positionWorld.copy(t.positionWorld),this.positionScreen.copy(t.positionScreen)};var jp=function(){this.id=0,this.v1=new Up,this.v2=new Up,this.vertexColors=[new h,new h],this.material=null,this.z=0,this.renderOrder=0},Bp=function(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=0,this.scale=new m,this.material=null,this.renderOrder=0},zp=function(){function t(n){if(!1!==n.visible){if(n instanceof Oe)R.lights.push(n);else if(n instanceof B||n instanceof z||n instanceof be){if(!1===n.material.visible)return;if(!0===n.frustumCulled&&!1===q.intersectsObject(n))return;e(n)}else if(n instanceof Sn){if(!1===n.material.visible)return;if(!0===n.frustumCulled&&!1===q.intersectsSprite(n))return;e(n)}for(var r=n.children,i=0,o=r.length;i<o;i++)t(r[i])}}function e(t){(h=function(){if(p===T){var t=new Rp;return M.push(t),T++,p++,t}return M[p++]}()).id=t.id,h.object=t,k.setFromMatrixPosition(t.matrixWorld),k.applyMatrix4(W),h.z=k.z,h.renderOrder=t.renderOrder,R.objects.push(h)}function n(t,e,n){var r=1/t.w;t.z*=r,t.z>=-1&&t.z<=1&&((w=function(){if(S===F){var t=new Bp;return D.push(t),F++,S++,t}return D[S++]}()).id=e.id,w.x=t.x*r,w.y=t.y*r,w.z=t.z,w.renderOrder=e.renderOrder,w.object=e,w.rotation=e.rotation,w.scale.x=e.scale.x*Math.abs(w.x-(t.x+n.projectionMatrix.elements[0])/(t.w+n.projectionMatrix.elements[12])),w.scale.y=e.scale.y*Math.abs(w.y-(t.y+n.projectionMatrix.elements[5])/(t.w+n.projectionMatrix.elements[13])),w.material=e.material,R.elements.push(w))}function o(){if(m===E){var t=new Up;return C.push(t),E++,m++,t}return C[m++]}function a(){if(b===N){var t=new kp;return P.push(t),N++,b++,t}return P[b++]}function s(){if(x===I){var t=new jp;return L.push(t),I++,x++,t}return L[x++]}function l(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id!==e.id?t.id-e.id:0}function c(t,e){var n=0,r=1,i=t.z+t.w,o=e.z+e.w,a=-t.z+t.w,s=-e.z+e.w;return i>=0&&o>=0&&a>=0&&s>=0||!(i<0&&o<0||a<0&&s<0)&&(i<0?n=Math.max(n,i/(i-o)):o<0&&(r=Math.min(r,i/(i-o))),a<0?n=Math.max(n,a/(a-s)):s<0&&(r=Math.min(r,a/(a-s))),!(r<n)&&(t.lerp(e,n),e.lerp(t,1-r),!0))}var h,p,f,m,y,b,_,x,w,S,A,M=[],T=0,C=[],E=0,P=[],N=0,L=[],I=0,D=[],F=0,R={objects:[],lights:[],elements:[]},k=new i,U=new g,j=new d(new i(-1,-1,-1),new i(1,1,1)),V=new d,G=new Array(3),H=new r,W=new r,X=new r,Y=new u,q=new Dn,Z=new g,Q=new g;this.projectVector=function(t,e){console.warn("Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(){console.error("Projector: .pickingRay() is now raycaster.setFromCamera().")};var J=new function(){function t(t){var e=t.positionWorld,n=t.positionScreen;e.copy(t.position).applyMatrix4(A),n.copy(e).applyMatrix4(W);var r=1/n.w;n.x*=r,n.y*=r,n.z*=r,t.visible=n.x>=-1&&n.x<=1&&n.y>=-1&&n.y<=1&&n.z>=-1&&n.z<=1}function e(t,e,n){return!0===t.visible||!0===e.visible||!0===n.visible||(G[0]=t.positionScreen,G[1]=e.positionScreen,G[2]=n.positionScreen,j.intersectsBox(V.setFromPoints(G)))}function n(t,e,n){return(n.positionScreen.x-t.positionScreen.x)*(e.positionScreen.y-t.positionScreen.y)-(n.positionScreen.y-t.positionScreen.y)*(e.positionScreen.x-t.positionScreen.x)<0}var r=[],i=[],l=[],h=null,p=null,d=new u;return{setObject:function(t){p=(h=t).material,d.getNormalMatrix(h.matrixWorld),r.length=0,i.length=0,l.length=0},projectVertex:t,checkTriangleVisibility:e,checkBackfaceCulling:n,pushVertex:function(e,n,r){(f=o()).position.set(e,n,r),t(f)},pushNormal:function(t,e,n){r.push(t,e,n)},pushColor:function(t,e,n){i.push(t,e,n)},pushUv:function(t,e){l.push(t,e)},pushLine:function(t,e){var n=C[t],r=C[e];n.positionScreen.copy(n.position).applyMatrix4(X),r.positionScreen.copy(r.position).applyMatrix4(X),!0===c(n.positionScreen,r.positionScreen)&&(n.positionScreen.multiplyScalar(1/n.positionScreen.w),r.positionScreen.multiplyScalar(1/r.positionScreen.w),(_=s()).id=h.id,_.v1.copy(n),_.v2.copy(r),_.z=Math.max(n.positionScreen.z,r.positionScreen.z),_.renderOrder=h.renderOrder,_.material=h.material,h.material.vertexColors===Bo&&(_.vertexColors[0].fromArray(i,3*t),_.vertexColors[1].fromArray(i,3*e)),R.elements.push(_))},pushTriangle:function(t,i,o){var s=arguments,u=C[t],c=C[i],f=C[o];if(!1!==e(u,c,f)&&(p.side===ko||!0===n(u,c,f))){(y=a()).id=h.id,y.v1.copy(u),y.v2.copy(c),y.v3.copy(f),y.z=(u.positionScreen.z+c.positionScreen.z+f.positionScreen.z)/3,y.renderOrder=h.renderOrder,y.normalModel.fromArray(r,3*t),y.normalModel.applyMatrix3(d).normalize();for(var m=0;m<3;m++){var v=y.vertexNormalsModel[m];v.fromArray(r,3*s[m]),v.applyMatrix3(d).normalize(),y.uvs[m].fromArray(l,2*s[m])}y.vertexNormalsLength=3,y.material=h.material,R.elements.push(y)}}}};this.projectScene=function(e,r,i,u){b=0,x=0,S=0,R.elements.length=0,!0===e.autoUpdate&&e.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld(),H.copy(r.matrixWorldInverse),W.multiplyMatrices(r.projectionMatrix,H),q.setFromMatrix(W),p=0,R.objects.length=0,R.lights.length=0,t(e),!0===i&&R.objects.sort(l);for(var h=R.objects,d=0,f=h.length;d<f;d++){var g=h[d].object,w=g.geometry;if(J.setObject(g),A=g.matrixWorld,m=0,g instanceof B){if(w instanceof O){var M=w.groups;if(void 0===(At=w.attributes).position)continue;for(var T=0,E=(Mt=At.position.array).length;T<E;T+=3)J.pushVertex(Mt[T],Mt[T+1],Mt[T+2]);if(void 0!==At.normal){var P=At.normal.array;for(T=0,E=P.length;T<E;T+=3)J.pushNormal(P[T],P[T+1],P[T+2])}if(void 0!==At.uv){var N=At.uv.array;for(T=0,E=N.length;T<E;T+=2)J.pushUv(N[T],N[T+1])}if(null!==w.index){var L=w.index.array;if(M.length>0)for(var I=0;I<M.length;I++){var D=M[I];for(T=D.start,E=D.start+D.count;T<E;T+=3)J.pushTriangle(L[T],L[T+1],L[T+2])}else for(T=0,E=L.length;T<E;T+=3)J.pushTriangle(L[T],L[T+1],L[T+2])}else for(T=0,E=Mt.length/3;T<E;T+=3)J.pushTriangle(T,T+1,T+2)}else if(w instanceof v){var F=w.vertices,j=w.faces,V=w.faceVertexUvs[0];Y.getNormalMatrix(A);for(var G=g.material,K=Array.isArray(G),$=0,tt=F.length;$<tt;$++){if(k.copy(St=F[$]),!0===G.morphTargets)for(var et=w.morphTargets,nt=g.morphTargetInfluences,rt=0,it=et.length;rt<it;rt++){var ot=nt[rt];if(0!==ot){var at=et[rt].vertices[$];k.x+=(at.x-St.x)*ot,k.y+=(at.y-St.y)*ot,k.z+=(at.z-St.z)*ot}}J.pushVertex(k.x,k.y,k.z)}for(var st=0,lt=j.length;st<lt;st++){var ut=j[st];if(void 0!==(G=!0===K?g.material[ut.materialIndex]:g.material)){var ct=G.side,ht=C[ut.a],pt=C[ut.b],dt=C[ut.c];if(!1!==J.checkTriangleVisibility(ht,pt,dt)){var ft=J.checkBackfaceCulling(ht,pt,dt);if(ct!==ko){if(ct===Fo&&!1===ft)continue;if(ct===Ro&&!0===ft)continue}(y=a()).id=g.id,y.v1.copy(ht),y.v2.copy(pt),y.v3.copy(dt),y.normalModel.copy(ut.normal),!1!==ft||ct!==Ro&&ct!==ko||y.normalModel.negate(),y.normalModel.applyMatrix3(Y).normalize();for(var mt=ut.vertexNormals,vt=0,gt=Math.min(mt.length,3);vt<gt;vt++){var yt=y.vertexNormalsModel[vt];yt.copy(mt[vt]),!1!==ft||ct!==Ro&&ct!==ko||yt.negate(),yt.applyMatrix3(Y).normalize()}y.vertexNormalsLength=mt.length;var bt=V[st];if(void 0!==bt)for(var _t=0;_t<3;_t++)y.uvs[_t].copy(bt[_t]);y.color=ut.color,y.material=G,y.z=(ht.positionScreen.z+pt.positionScreen.z+dt.positionScreen.z)/3,y.renderOrder=g.renderOrder,R.elements.push(y)}}}}}else if(g instanceof z){if(X.multiplyMatrices(W,A),w instanceof O){if(void 0!==(At=w.attributes).position){for(T=0,E=(Mt=At.position.array).length;T<E;T+=3)J.pushVertex(Mt[T],Mt[T+1],Mt[T+2]);if(void 0!==At.color){var xt=At.color.array;for(T=0,E=xt.length;T<E;T+=3)J.pushColor(xt[T],xt[T+1],xt[T+2])}if(null!==w.index)for(T=0,E=(L=w.index.array).length;T<E;T+=2)J.pushLine(L[T],L[T+1]);else{var wt=g instanceof je?2:1;for(T=0,E=Mt.length/3-1;T<E;T+=wt)J.pushLine(T,T+1)}}}else if(w instanceof v){if(0===(F=g.geometry.vertices).length)continue;(ht=o()).positionScreen.copy(F[0]).applyMatrix4(X);for(wt=g instanceof je?2:1,$=1,tt=F.length;$<tt;$++)(ht=o()).positionScreen.copy(F[$]).applyMatrix4(X),($+1)%wt>0||(pt=C[m-2],Z.copy(ht.positionScreen),Q.copy(pt.positionScreen),!0===c(Z,Q)&&(Z.multiplyScalar(1/Z.w),Q.multiplyScalar(1/Q.w),(_=s()).id=g.id,_.v1.positionScreen.copy(Z),_.v2.positionScreen.copy(Q),_.z=Math.max(Z.z,Q.z),_.renderOrder=g.renderOrder,_.material=g.material,g.material.vertexColors===Bo&&(_.vertexColors[0].copy(g.geometry.colors[$]),_.vertexColors[1].copy(g.geometry.colors[$-1])),R.elements.push(_)))}}else if(g instanceof be){if(X.multiplyMatrices(W,A),w instanceof v)for($=0,tt=(F=g.geometry.vertices).length;$<tt;$++){var St;U.set((St=F[$]).x,St.y,St.z,1),U.applyMatrix4(X),n(U,g,r)}else if(w instanceof O){var At;if(void 0!==(At=w.attributes).position){var Mt;for(T=0,E=(Mt=At.position.array).length;T<E;T+=3)U.set(Mt[T],Mt[T+1],Mt[T+2],1),U.applyMatrix4(X),n(U,g,r)}}}else g instanceof Sn&&(U.set(A.elements[12],A.elements[13],A.elements[14],1),U.applyMatrix4(W),n(U,g,r))}return!0===u&&R.elements.sort(l),R}},Vp=function(t){I.call(this),this.type="SpriteCanvasMaterial",this.color=new h(16777215),this.program=function(){},this.setValues(t)};(Vp.prototype=Object.create(I.prototype)).constructor=Vp,Vp.prototype.isSpriteCanvasMaterial=!0,Vp.prototype.clone=function(){var t=new Vp;return t.copy(this),t.color.copy(this.color),t.program=this.program,t};var Gp=function(t){c.call(this),this.element=t,this.element.style.position="absolute",this.addEventListener("removed",function(t){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)})};(Gp.prototype=Object.create(c.prototype)).constructor=Gp;var Hp=function(t){c.call(this),this.element=t,this.element.style.position="absolute",this.addEventListener("removed",function(){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)})};Hp.prototype=Object.create(c.prototype),Hp.prototype.constructor=Hp;var Wp=function(t){Hp.call(this,t)};Wp.prototype=Object.create(Hp.prototype),Wp.prototype.constructor=Wp;Object.assign(function(t){function e(t){t.postMessage({init:[i,o],worker:t.id,blockSize:f})}function n(t){if(!m.length)return l=!1,a.dispatchEvent({type:"complete"});var e=m.pop(),n=e%b*f,r=(e/b|0)*f;t.postMessage({render:!0,x:n,y:r,sceneId:g}),c.fillStyle="#"+t.color,c.fillRect(n,r,f,f)}function r(t){var e=t.material;if(e&&!(e.uuid in A)){var n={};for(var r in M)void 0!==e[r]&&(n[r]=e[r]);A[e.uuid]=n}}console.log("RaytracingRenderer",To),t=t||{};var i,o,a=this,s=[],l=!1,u=document.createElement("canvas"),c=u.getContext("2d",{alpha:!0===t.alpha}),p=new h(0);this.domElement=u,this.autoClear=!0;var d=t.workers,f=t.blockSize||64;this.randomize=t.randomize;var m=[],v=0,g=0;console.log("%cSpinning off "+d+" Workers ","font-size: 20px; background: black; color: white; font-family: monospace;"),this.setWorkers=function(r){for(d=r||navigator.hardwareConcurrency||4;s.length<d;){var i=new Worker(t.workerPath);i.id=v++,i.onmessage=function(t){var e=t.data;if(e&&e.blockSize&&g==e.sceneId){var r=new ImageData(new Uint8ClampedArray(e.data),e.blockSize,e.blockSize);if(c.putImageData(r,e.blockX,e.blockY),console.log("Worker "+this.id,e.time/1e3,(Date.now()-S)/1e3+" s"),s.length>d)return s.splice(s.indexOf(this),1),this.terminate();n(this)}},i.color=(new h).setHSL(Math.random(),.8,.8).getHexString(),s.push(i),e(i),l&&(i.postMessage({scene:x,camera:w,annex:A,sceneId:g}),n(i))}if(!l)for(;s.length>d;)s.pop().terminate()},this.setWorkers(d),this.setClearColor=function(t,e){p.set(t)},this.setPixelRatio=function(){},this.setSize=function(t,n){u.width=t,u.height=n,i=u.width,o=u.height,c.fillStyle="white",s.forEach(e)},this.setSize(u.width,u.height),this.clear=function(){};var y,b,_,x,w,S,A={},M={mirror:1,reflectivity:1,refractionRatio:1,glass:1};this.render=function(t,e){l=!0,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),x=t.toJSON(),w=e.toJSON(),++g,t.traverse(r),s.forEach(function(t){t.postMessage({scene:x,camera:w,annex:A,sceneId:g})}),c.clearRect(0,0,i,o),S=Date.now(),b=Math.ceil(i/f),_=Math.ceil(o/f),y=b*_,m=[];for(var u=0;u<y;u++)m.push(u);if(a.randomize)for(u=0;u<y;u++){var h=Math.random()*y|0,p=m[h];m[h]=m[u],m[u]=p}s.forEach(n)}}.prototype,a.prototype);var Xp=function(t){function e(t){for(var e=c*p*4,n=0;n<e;n+=4)A[n]=255*t.r|0,A[n+1]=255*t.g|0,A[n+2]=255*t.b|0,A[n+3]=N?0:255;O.fillStyle=N?"rgba(0, 0, 0, 0)":t.getStyle(),O.fillRect(0,0,c,p)}function n(t,e){var n=0,r=0,i=255*t.color.r,o=255*t.color.g,a=255*t.color.b,s=new Uint8Array(768);if(e){for(;n<204;)s[r++]=Math.min(n*i/204,255),s[r++]=Math.min(n*o/204,255),s[r++]=Math.min(n*a/204,255),++n;for(;n<256;)s[r++]=Math.min(i+(n-204)*(255-i)/82,255),s[r++]=Math.min(o+(n-204)*(255-o)/82,255),s[r++]=Math.min(a+(n-204)*(255-a)/82,255),++n}else for(;n<256;)s[r++]=Math.min(n*i/255,255),s[r++]=Math.min(n*o/255,255),s[r++]=Math.min(n*a/255,255),++n;return s}function r(t,e,n,r,i,o,a,s,l){var u=4*n,c=I[l.map.id];if(c.data){var h=c.width,p=h-1,d=c.data,f=4*((o*h&p)*h+(i*h&p));if(l.transparent){var m=d[f+1],v=d[f+2],g=d[f+3]*l.opacity/255,y=t[u+1],b=t[u+2];t[u]=d[f]*g+t[u]*(1-g),t[u+1]=m*g+y*(1-g),t[u+2]=v*g+b*(1-g),t[u+3]=(l.opacity<<8)-1,255==t[u+3]&&(e[n]=r)}else t[u]=d[f],t[u+1]=d[f+1],t[u+2]=d[f+2],t[u+3]=(l.opacity<<8)-1,e[n]=r}}function o(t,e,n,r,i,o,a,s,l){var u=4*n,c=I[l.map.id];if(c.data){var h=c.width,p=3*(a>0?~~a:0),d=h-1,f=c.data,m=4*((o*h&d)*h+(i*h&d));if(l.transparent){var v=l.palette[p+1]*f[m+1],g=l.palette[p+2]*f[m+2],y=f[m+3]*l.opacity/256,b=t[u+1],_=t[u+2];t[u]=l.palette[p]*f[m]*y+t[u]*(1-y),t[u+1]=v*y+b*(1-y),t[u+2]=g*y+_*(1-y),t[u+3]=(l.opacity<<8)-1,255==t[u+3]&&(e[n]=r)}else t[u]=l.palette[p]*f[m]>>8,t[u+1]=l.palette[p+1]*f[m+1]>>8,t[u+2]=l.palette[p+2]*f[m+2]>>8,t[u+3]=(l.opacity<<8)-1,e[n]=r}}function a(t){var e=t.id,i=L[e];if(i&&t.map&&!I[t.map.id]&&delete L[e],void 0===L[e]||!0===t.needsUpdate){if(t instanceof D||t instanceof _t||t instanceof wt||t instanceof Pt){t instanceof _t?t.palette||(t.palette=n(t,!1)):t instanceof wt&&(t.palette||(t.palette=n(t,!0)));if(t.map){var a=new Xp.Texture;if(a.fromImage(t.map.image),!a.data)return;I[t.map.id]=a,i=t instanceof D||t instanceof Pt?r:o}else s=t.vertexColors===jo?["var colorOffset = offset * 4;","buffer[ colorOffset ] = face.color.r * 255;","buffer[ colorOffset + 1 ] = face.color.g * 255;","buffer[ colorOffset + 2 ] = face.color.b * 255;","buffer[ colorOffset + 3 ] = material.opacity * 255;","depthBuf[ offset ] = depth;"].join("\n"):["var colorOffset = offset * 4;","buffer[ colorOffset ] = material.color.r * 255;","buffer[ colorOffset + 1 ] = material.color.g * 255;","buffer[ colorOffset + 2 ] = material.color.b * 255;","buffer[ colorOffset + 3 ] = material.opacity * 255;","depthBuf[ offset ] = depth;"].join("\n"),i=new Function("buffer, depthBuf, offset, depth, u, v, n, face, material",s)}else if(t instanceof F){var s=["var colorOffset = offset * 4;","buffer[ colorOffset ] = material.color.r * (color1.r+color2.r) * 0.5 * 255;","buffer[ colorOffset + 1 ] = material.color.g * (color1.g+color2.g) * 0.5 * 255;","buffer[ colorOffset + 2 ] = material.color.b * (color1.b+color2.b) * 0.5 * 255;","buffer[ colorOffset + 3 ] = 255;","depthBuf[ offset ] = depth;"].join("\n");i=new Function("buffer, depthBuf, offset, depth, color1, color2, material",s)}else{s=["var colorOffset = offset * 4;","buffer[ colorOffset ] = u * 255;","buffer[ colorOffset + 1 ] = v * 255;","buffer[ colorOffset + 2 ] = 0;","buffer[ colorOffset + 3 ] = 255;","depthBuf[ offset ] = depth;"].join("\n");i=new Function("buffer, depthBuf, offset, depth, u, v, n, face, material",s)}L[e]=i,t.needsUpdate=!1}return i}function s(t,e,n,r,o,a,l,h,f){if(!(t.z<-1||t.z>1||e.z<-1||e.z>1||n.z<-1||n.z>1)){var S=1<<j,T=t.x*v+_|0,P=e.x*v+_|0,O=n.x*v+_|0,N=t.y*y+x|0,L=e.y*y+x|0,I=n.y*y+x|0,D=h.vertexNormalsModel&&h.vertexNormalsModel.length,F=r&&o&&a,R=Math.max(Math.sqrt((T-P)*(T-P)+(N-L)*(N-L)),Math.sqrt((P-O)*(P-O)+(L-I)*(L-I)),Math.sqrt((O-T)*(O-T)+(I-N)*(I-N)));if(!(h instanceof Bp)&&R>100*S){var G,H,W,X={vertexNormalsModel:[],color:h.color};if(F){dt===pt.length?(G=new m,pt.push(G),++dt,H=new m,pt.push(H),++dt,W=new m,pt.push(W),++dt):(G=pt[dt],H=pt[++dt],W=pt[++dt],++dt);var J;J=(1+e.z)*(e.w/t.w)/(1+t.z),G.copy(r).multiplyScalar(J).add(o).multiplyScalar(1/(J+1)),J=(1+n.z)*(n.w/e.w)/(1+e.z),H.copy(o).multiplyScalar(J).add(a).multiplyScalar(1/(J+1)),J=(1+t.z)*(t.w/n.w)/(1+n.z),W.copy(a).multiplyScalar(J).add(r).multiplyScalar(1/(J+1))}var K,$,tt;ut===lt.length?(K=new g,lt.push(K),++ut,$=new g,lt.push($),++ut,tt=new g,lt.push(tt),++ut):(K=lt[ut],$=lt[++ut],tt=lt[++ut],++ut),K.copy(t).add(e).multiplyScalar(.5),$.copy(e).add(n).multiplyScalar(.5),tt.copy(n).add(t).multiplyScalar(.5);var et,nt,rt;return D&&(ht===ct.length?(et=new i,ct.push(et),++ht,nt=new i,ct.push(nt),++ht,rt=new i,ct.push(rt),++ht):(et=ct[ht],nt=ct[++ht],rt=ct[++ht],++ht),et.copy(h.vertexNormalsModel[0]).add(h.vertexNormalsModel[1]).normalize(),nt.copy(h.vertexNormalsModel[1]).add(h.vertexNormalsModel[2]).normalize(),rt.copy(h.vertexNormalsModel[2]).add(h.vertexNormalsModel[0]).normalize()),D&&(X.vertexNormalsModel[0]=h.vertexNormalsModel[0],X.vertexNormalsModel[1]=et,X.vertexNormalsModel[2]=rt),s(t,K,tt,r,G,W,l,X,f),D&&(X.vertexNormalsModel[0]=h.vertexNormalsModel[1],X.vertexNormalsModel[1]=nt,X.vertexNormalsModel[2]=et),s(e,$,K,o,H,G,l,X,f),D&&(X.vertexNormalsModel[0]=et,X.vertexNormalsModel[1]=nt,X.vertexNormalsModel[2]=rt),s(K,$,tt,G,H,W,l,X,f),D&&(X.vertexNormalsModel[0]=h.vertexNormalsModel[2],X.vertexNormalsModel[1]=rt,X.vertexNormalsModel[2]=nt),void s(n,tt,$,a,W,H,l,X,f)}var it,ot,at,st,ft,mt,vt=t.z*b+w|0,gt=e.z*b+w|0,yt=n.z*b+w|0;F=!1;r&&o&&a&&(F=!0,it=r.x,ot=1-r.y,at=o.x,st=1-o.y,ft=a.x,mt=1-a.y);var bt,_t,xt;D&&(bt=255*h.vertexNormalsModel[0].z,_t=255*h.vertexNormalsModel[1].z,xt=255*h.vertexNormalsModel[2].z);var wt=T-P,St=L-N,At=P-O,Mt=I-L,Tt=O-T,Ct=N-I,Et=Math.max(Math.min(T,P,O)+B>>j,0),Pt=Math.min(Math.max(T,P,O)+B>>j,c),Ot=Math.max(Math.min(N,L,I)+B>>j,0),Nt=Math.min(Math.max(N,L,I)+B>>j,p);Y=Math.min(Et,Y),Z=Math.max(Pt,Z),q=Math.min(Ot,q),Q=Math.max(Nt,Q);var Lt=V,It=(Et&=~(Lt-1))<<j,Dt=(Ot&=~(Lt-1))<<j,Ft=St*(It-T)+wt*(Dt-N),Rt=Mt*(It-P)+At*(Dt-L),kt=Ct*(It-O)+Tt*(Dt-I);(St>0||0==St&&wt>0)&&Ft++,(Mt>0||0==Mt&&At>0)&&Rt++,(Ct>0||0==Ct&&Tt>0)&&kt++,Ft=Ft-1>>j,Rt=Rt-1>>j,kt=kt-1>>j;var Ut=vt-gt,jt=yt-vt,Bt=1/(wt*Ct-Tt*St),zt=Bt*(Ut*Ct-jt*St),Vt=Bt*(Ut*Tt-wt*jt),Gt=vt+(It-T)*zt+(Dt-N)*Vt|0;zt=zt*S|0,Vt=Vt*S|0;var Ht,Wt,Xt,Yt;if(F){var qt=it-at,Zt=ft-it,Qt=Bt*(qt*Ct-Zt*St),Jt=Bt*(qt*Tt-wt*Zt),Kt=ot-st,$t=mt-ot;Xt=it+(It-T)*Qt+(Dt-N)*Jt,Yt=ot+(It-T)*(Ht=Bt*(Kt*Ct-$t*St))+(Dt-N)*(Wt=Bt*(Kt*Tt-wt*$t)),Qt*=S,Jt*=S,Ht*=S,Wt*=S}var te;if(D){var ee,ne=bt-_t,re=xt-bt,ie=Bt*(ne*Ct-re*St);te=bt+(It-T)*ie+(Dt-N)*(ee=Bt*(ne*Tt-wt*re)),ie*=S,ee*=S}var oe=Lt-1,ae=0,se=0,le=0,ue=0,ce=0,he=0,pe=0,de=0;wt>=0?se-=oe*wt:ae-=oe*wt,St>=0?se-=oe*St:ae-=oe*St,At>=0?ue-=oe*At:le-=oe*At,Mt>=0?ue-=oe*Mt:le-=oe*Mt,Tt>=0?he-=oe*Tt:ce-=oe*Tt,Ct>=0?he-=oe*Ct:ce-=oe*Ct,zt>=0?de+=oe*zt:pe+=oe*zt,Vt>=0?de+=oe*Vt:pe+=oe*Vt;var fe,me,ve=c-Lt,ge=Ft,ye=Rt,be=kt,_e=Gt,xe=-Lt,we=xe*St,Se=xe*Mt,Ae=xe*Ct,Me=xe*zt;F&&(fe=xe*Qt,me=xe*Ht);var Te;D&&(Te=xe*ie);for(var Ce=Et,Ee=Ot;Ee<Nt;Ee+=Lt){for(;Ce>=Et&&Ce<Pt&&ge>=se&&ye>=ue&&be>=he;)Ce+=xe,ge+=we,ye+=Se,be+=Ae,_e+=Me,F&&(Xt+=fe,Yt+=me),D&&(te+=Te);for(xe=-xe,we=-we,Se=-Se,Ae=-Ae,Me=-Me,F&&(fe=-fe,me=-me),D&&(Te=-Te);Ce+=xe,ge+=we,ye+=Se,be+=Ae,_e+=Me,F&&(Xt+=fe,Yt+=me),D&&(te+=Te),!(Ce<Et||Ce>=Pt);)if(ge<se){if(we<0)break}else if(ye<ue){if(Se<0)break}else if(be<he){if(Ae<0)break}else{var Pe=Ce>>z,Oe=Ee>>z,Ne=Pe+Oe*d;if(!(C[Ne]<_e+pe)){var Le=E[Ne];Le&U&&u(Pe,Oe),E[Ne]=Le&~(k|U);var Ie=Ce+Ee*c;if(ge>=ae&&ye>=le&&be>=ce){var De=_e+de;C[Ne]=Math.min(C[Ne],De);var Fe=ge,Re=ye,ke=_e;F&&(Ge=Xt,He=Yt);D&&(Xe=te);for(var Ue=0;Ue<Lt;Ue++){var je=Fe,Be=Re,ze=ke;F&&(Ye=Ge,qe=He);D&&(Qe=Xe);for(var Ve=0;Ve<Lt;Ve++){(Je=ze)<M[Ie]&&l(A,M,Ie,Je,Ye,qe,Qe,h,f),je+=St,Be+=Mt,ze+=zt,F&&(Ye+=Qt,qe+=Ht),D&&(Qe+=ie),Ie++}Fe+=wt,Re+=At,ke+=Vt,F&&(Ge+=Jt,He+=Wt),D&&(Xe+=ee),Ie+=ve}}else{Fe=ge,Re=ye;var Ge,He,We=be;ke=_e;F&&(Ge=Xt,He=Yt);var Xe;D&&(Xe=te);for(Ue=0;Ue<Lt;Ue++){je=Fe,Be=Re;var Ye,qe,Ze=We;ze=ke;F&&(Ye=Ge,qe=He);var Qe;D&&(Qe=Xe);for(Ve=0;Ve<Lt;Ve++){if((je|Be|Ze)>=0){var Je;(Je=ze)<M[Ie]&&l(A,M,Ie,Je,Ye,qe,Qe,h,f)}je+=St,Be+=Mt,Ze+=Ct,ze+=zt,F&&(Ye+=Qt,qe+=Ht),D&&(Qe+=ie),Ie++}Fe+=wt,Re+=At,We+=Tt,ke+=Vt,F&&(Ge+=Jt,He+=Wt),D&&(Xe+=ee),Ie+=ve}}}}ge+=Lt*wt,ye+=Lt*At,be+=Lt*Tt,_e+=Lt*Vt,F&&(Xt+=Lt*Jt,Yt+=Lt*Wt),D&&(te+=Lt*ee)}}}function l(t,n,r,i,o,a){if(H||(H=!0,V=1<<(z=0),function(t,n){d=Math.floor(t/V),f=Math.floor(n/V);var r=1<<j;v=r*(c=d*V)/2,y=-r*(p=f*V)/2,b=G/2,_=r*c/2+.5,x=r*p/2+.5,w=G/2+.5,P.width=c,P.height=p,O.fillStyle=N?"rgba(0, 0, 0, 0)":R.getStyle(),O.fillRect(0,0,c,p),S=O.getImageData(0,0,c,p),A=S.data,M=new Int32Array(A.length/4),T=d*f,C=new Int32Array(T),E=new Uint8Array(T);for(var i=0,o=M.length;i<o;i++)M[i]=G;for(i=0;i<T;i++)E[i]=k;e(R)}(P.width,P.height)),!(t.z<-1||t.z>1||n.z<-1||n.z>1)){var s=Math.floor(.5*(a.linewidth-1)),l=t.x*v+_|0,h=n.x*v+_|0,m=t.y*y+x|0,g=n.y*y+x|0,L=t.z*b+w|0,I=n.z*b+w|0,D=l-h,F=m-g,J=L-I,K=Math.max(Math.min(l,h)+B>>j,0),$=Math.min(Math.max(l,h)+B>>j,c),tt=Math.max(Math.min(m,g)+B>>j,0),et=Math.min(Math.max(m,g)+B>>j,p),nt=Math.max(Math.min(L,I)+B>>j,0),rt=Math.max(L,I)+B>>j;Y=Math.min(K,Y),Z=Math.max($,Z),q=Math.min(tt,q),Q=Math.max(et,Q);var it,ot,at,st,lt,ut=Math.sqrt(F*F+D*D),ct=D/ut,ht=F/ut,pt=J/ut;for(X.set(ct,ht,pt),X.cross(W),X.normalize();ut>0;){it=(it=h+ut*ct)+B>>j,ot=(ot=g+ut*ht)+B>>j,lt=I+ut*pt+B>>j;for(var dt=-s;dt<=s;++dt)if(at=Math.floor(it+X.x*dt),st=Math.floor(ot+X.y*dt),!(Y>=at||Z<=at||q>=st||Q<=st)){var ft=at>>z,mt=st>>z,vt=ft+mt*d;if(!(C[vt]<nt)){C[vt]=Math.min(C[vt],rt);var gt=E[vt];gt&U&&u(ft,mt),E[vt]=gt&~(k|U);var yt=at+st*c;lt<M[yt]&&o(A,M,yt,lt,r,i,a)}}--ut}}}function u(t,e){for(var n=t*V+e*V*c,r=4*n,i=c-V,o=4*i,a=0;a<V;a++){for(var s=0;s<V;s++)M[n++]=G,A[r++]=255*R.r|0,A[r++]=255*R.g|0,A[r++]=255*R.b|0,A[r++]=N?0:255;n+=i,r+=o}}console.log("SoftwareRenderer",To);var c,p,d,f,v,y,b,_,x,w,S,A,M,T,C,E,P=void 0!==(t=t||{}).canvas?t.canvas:document.createElement("canvas"),O=P.getContext("2d",{alpha:!0===t.alpha}),N=t.alpha,L={},I={},R=new h(0),k=1,U=2,j=4,B=(1<<j)-1,z=3,V=1<<z,G=1<<24,H=!1,W=new i(0,0,1),X=new i,Y=1/0,q=1/0,Z=0,Q=0,J=1/0,K=1/0,$=0,tt=0,et=new zp,nt=new g,rt=new g,it=new g,ot=new m,at=new m,st=new m,lt=[],ut=0,ct=[],ht=0,pt=[],dt=0;this.domElement=P,this.autoClear=!0,this.setClearColor=function(t){R.set(t),e(R)},this.setPixelRatio=function(){},this.setSize=function(t,n){d=Math.floor(t/V),f=Math.floor(n/V);var r=1<<j;v=r*(c=d*V)/2,y=-r*(p=f*V)/2,b=G/2,_=r*c/2+.5,x=r*p/2+.5,w=G/2+.5,P.width=c,P.height=p,O.fillStyle=N?"rgba(0, 0, 0, 0)":R.getStyle(),O.fillRect(0,0,c,p),S=O.getImageData(0,0,c,p),A=S.data,M=new Int32Array(A.length/4),T=d*f,C=new Int32Array(T),E=new Uint8Array(T);for(var i=0,o=M.length;i<o;i++)M[i]=G;for(i=0;i<T;i++)E[i]=k;e(R)},this.setSize(P.width,P.height),this.clear=function(){Y=1/0,q=1/0,Z=0,Q=0,ut=0,ht=0,dt=0;for(var t=0;t<T;t++)C[t]=G,E[t]=E[t]&k?k:U},this.render=function(t,n){this.clear();var r=t.background;r&&r.isColor&&e(r);for(var i=et.projectScene(t,n,!1,!1).elements,o=0,c=i.length;o<c;o++){var h=i[o],p=h.material;if(g=a(p))if(h instanceof kp)h.uvs?s(h.v1.positionScreen,h.v2.positionScreen,h.v3.positionScreen,h.uvs[0],h.uvs[1],h.uvs[2],g,h,p):s(h.v1.positionScreen,h.v2.positionScreen,h.v3.positionScreen,null,null,null,g,h,p);else if(h instanceof Bp){var m=.5*h.scale.x,v=.5*h.scale.y;nt.copy(h),nt.x-=m,nt.y+=v,rt.copy(h),rt.x-=m,rt.y-=v,it.copy(h),it.x+=m,it.y+=v,p.map?(ot.set(0,1),at.set(0,0),st.set(1,1),s(nt,rt,it,ot,at,st,g,h,p)):s(nt,rt,it,null,null,null,g,h,p),nt.copy(h),nt.x+=m,nt.y+=v,rt.copy(h),rt.x-=m,rt.y-=v,it.copy(h),it.x+=m,it.y-=v,p.map?(ot.set(1,1),at.set(0,0),st.set(1,0),s(nt,rt,it,ot,at,st,g,h,p)):s(nt,rt,it,null,null,null,g,h,p)}else if(h instanceof jp){var g=a(p);l(h.v1.positionScreen,h.v2.positionScreen,h.vertexColors[0],h.vertexColors[1],g,p)}}!function(){for(var t=0,e=0;e<f;e++)for(var n=0;n<d;n++)E[t]&U&&(u(n,e),E[t]=k),t++}();var y=Math.min(Y,J),b=Math.min(q,K),_=Math.max(Z,$)-y,x=Math.max(Q,tt)-b;y!==1/0&&O.putImageData(S,0,0,y,b,_,x),J=Y,K=q,$=Z,tt=Q}};Xp.Texture=function(){var t;this.fromImage=function(e){if(!(!e||e.width<=0||e.height<=0)){void 0===t&&(t=document.createElement("canvas"));var n=e.width>e.height?e.width:e.height;n=xo.ceilPowerOfTwo(n),t.width==n&&t.height==n||(t.width=n,t.height=n);var r=t.getContext("2d");r.clearRect(0,0,n,n),r.drawImage(e,0,0,n,n);var i=r.getImageData(0,0,n,n);this.data=i.data,this.width=n,this.height=n,this.srcUrl=e.src}}};var Yp=function(t){c.call(this),this.node=t};(Yp.prototype=Object.create(c.prototype)).constructor=Yp;var qp=new ht,Zp=new hn,Qp=[],Jp=[],Kp=new Float32Array(16),$p=new Float32Array(9);pr.prototype.setValue=function(t,e){for(var n=this.seq,r=0,i=n.length;r!==i;++r){var o=n[r];o.setValue(t,e[o.id])}};var td=/([\w\d_]+)(\])?(\[|\.)?/g;mr.prototype.setValue=function(t,e,n){var r=this.map[e];void 0!==r&&r.setValue(t,n,this.renderer)},mr.prototype.setOptional=function(t,e,n){var r=e[n];void 0!==r&&this.setValue(t,n,r)},mr.upload=function(t,e,n,r){for(var i=0,o=e.length;i!==o;++i){var a=e[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(t,s.value,r)}},mr.seqWithValue=function(t,e){for(var n=[],r=0,i=t.length;r!==i;++r){var o=t[r];o.id in e&&n.push(o)}return n};var ed=0,nd=0;Dr.prototype=Object.assign(Object.create(st.prototype),{constructor:Dr,isArrayCamera:!0}),Rr.prototype.clone=function(){return new Rr(void 0===this.value.clone?this.value:this.value.clone())};new m(1/1024,1/512),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["precision highp float;","","uniform sampler2D tDiffuse;","","uniform vec2 resolution;","","varying vec2 vUv;","","// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)","","//----------------------------------------------------------------------------------","// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag","// SDK Version: v3.00","// Email:       gameworks@nvidia.com","// Site:        http://developer.nvidia.com/","//","// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.","//","// Redistribution and use in source and binary forms, with or without","// modification, are permitted provided that the following conditions","// are met:","//  * Redistributions of source code must retain the above copyright","//    notice, this list of conditions and the following disclaimer.","//  * Redistributions in binary form must reproduce the above copyright","//    notice, this list of conditions and the following disclaimer in the","//    documentation and/or other materials provided with the distribution.","//  * Neither the name of NVIDIA CORPORATION nor the names of its","//    contributors may be used to endorse or promote products derived","//    from this software without specific prior written permission.","//","// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY","// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE","// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR","// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR","// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,","// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,","// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR","// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY","// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT","// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE","// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.","//","//----------------------------------------------------------------------------------","","#define FXAA_PC 1","#define FXAA_GLSL_100 1","#define FXAA_QUALITY_PRESET 12","","#define FXAA_GREEN_AS_LUMA 1","","","#ifndef FXAA_PC_CONSOLE","    //","    // The console algorithm for PC is included","    // for developers targeting really low spec machines.","    // Likely better to just run FXAA_PC, and use a really low preset.","    //","    #define FXAA_PC_CONSOLE 0","#endif","","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 0","#endif","","#ifndef FXAA_HLSL_3","    #define FXAA_HLSL_3 0","#endif","","#ifndef FXAA_HLSL_4","    #define FXAA_HLSL_4 0","#endif","","#ifndef FXAA_HLSL_5","    #define FXAA_HLSL_5 0","#endif","","#ifndef FXAA_GREEN_AS_LUMA","    //","    // For those using non-linear color,","    // and either not able to get luma in alpha, or not wanting to,","    // this enables FXAA to run using green as a proxy for luma.","    // So with this enabled, no need to pack luma in alpha.","    //","    // This will turn off AA on anything which lacks some amount of green.","    // Pure red and blue or combination of only R and B, will get no AA.","    //","    // Might want to lower the settings for both,","    //    fxaaConsoleEdgeThresholdMin","    //    fxaaQualityEdgeThresholdMin","    // In order to insure AA does not get turned off on colors","    // which contain a minor amount of green.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_GREEN_AS_LUMA 0","#endif","","#ifndef FXAA_EARLY_EXIT","    //","    // Controls algorithm's early exit path.","    // On PS3 turning this ON adds 2 cycles to the shader.","    // On 360 turning this OFF adds 10ths of a millisecond to the shader.","    // Turning this off on console will result in a more blurry image.","    // So this defaults to on.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_EARLY_EXIT 1","#endif","","#ifndef FXAA_DISCARD","    //","    // Only valid for PC OpenGL currently.","    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.","    //","    // 1 = Use discard on pixels which don't need AA.","    //     For APIs which enable concurrent TEX+ROP from same surface.","    // 0 = Return unchanged color on pixels which don't need AA.","    //","    #define FXAA_DISCARD 0","#endif","","#ifndef FXAA_FAST_PIXEL_OFFSET","    //","    // Used for GLSL 120 only.","    //","    // 1 = GL API supports fast pixel offsets","    // 0 = do not use fast pixel offsets","    //","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","","#ifndef FXAA_GATHER4_ALPHA","    //","    // 1 = API supports gather4 on alpha channel.","    // 0 = API does not support gather4 on alpha channel.","    //","    #if (FXAA_HLSL_5 == 1)","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","","","","#ifndef FXAA_QUALITY_PRESET","    //","    // Choose the quality preset.","    // This needs to be compiled into the shader as it effects code.","    // Best option to include multiple presets is to","    // in each shader define the preset, then include this file.","    //","    // OPTIONS","    // -----------------------------------------------------------------------","    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)","    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)","    // 39       - no dither, very expensive","    //","    // NOTES","    // -----------------------------------------------------------------------","    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)","    // 13 = about same speed as FXAA 3.9 and better than 12","    // 23 = closest to FXAA 3.9 visually and performance wise","    //  _ = the lowest digit is directly related to performance","    // _  = the highest digit is directly related to style","    //","    #define FXAA_QUALITY_PRESET 12","#endif","","","","","","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","","","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","","","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","","#if (FXAA_GLSL_120 == 1)","    // Requires,","    //  #version 120","    // And at least,","    //  #extension GL_EXT_gpu_shader4 : enable","    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","","#if (FXAA_GLSL_130 == 1)",'    // Requires "#version 130" or better',"    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","","#if (FXAA_HLSL_3 == 1)","    #define FxaaInt2 float2","    #define FxaaTex sampler2D","    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))","    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))","#endif","","#if (FXAA_HLSL_4 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","#endif","","#if (FXAA_HLSL_5 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)","    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)","    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)","    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)","#endif","","","","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","","","","","","#if (FXAA_PC == 1)","","FxaaFloat4 FxaaPixelShader(","    //","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy} = center of pixel","    FxaaFloat2 pos,","    //","    // Used only for FXAA Console, and not used on the 360 version.","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy_} = upper left of pixel","    // {_zw} = lower right of pixel","    FxaaFloat4 fxaaConsolePosPos,","    //","    // Input color texture.","    // {rgb_} = color in linear or perceptual color space","    // if (FXAA_GREEN_AS_LUMA == 0)","    //     {__a} = luma in perceptual color space (not linear)","    FxaaTex tex,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 2nd sampler.","    // This sampler needs to have an exponent bias of -1.","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 3nd sampler.","    // This sampler needs to have an exponent bias of -2.","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    //","    // Only used on FXAA Quality.","    // This must be from a constant/uniform.","    // {x_} = 1.0/screenWidthInPixels","    // {_y} = 1.0/screenHeightInPixels","    FxaaFloat2 fxaaQualityRcpFrame,","    //","    // Only used on FXAA Console.","    // This must be from a constant/uniform.","    // This effects sub-pixel AA quality and inversely sharpness.","    //   Where N ranges between,","    //     N = 0.50 (default)","    //     N = 0.33 (sharper)","    // {x__} = -N/screenWidthInPixels","    // {_y_} = -N/screenHeightInPixels","    // {_z_} =  N/screenWidthInPixels","    // {__w} =  N/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    //","    // Only used on FXAA Console.","    // Not used on 360, but used on PS3 and PC.","    // This must be from a constant/uniform.","    // {x__} = -2.0/screenWidthInPixels","    // {_y_} = -2.0/screenHeightInPixels","    // {_z_} =  2.0/screenWidthInPixels","    // {__w} =  2.0/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    //","    // Only used on FXAA Console.","    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.","    // This must be from a constant/uniform.","    // {x__} =  8.0/screenWidthInPixels","    // {_y_} =  8.0/screenHeightInPixels","    // {_z_} = -4.0/screenWidthInPixels","    // {__w} = -4.0/screenHeightInPixels","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_SUBPIX define.","    // It is here now to allow easier tuning.","    // Choose the amount of sub-pixel aliasing removal.","    // This can effect sharpness.","    //   1.00 - upper limit (softer)","    //   0.75 - default amount of filtering","    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)","    //   0.25 - almost off","    //   0.00 - completely off","    FxaaFloat fxaaQualitySubpix,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // The minimum amount of local contrast required to apply algorithm.","    //   0.333 - too little (faster)","    //   0.250 - low quality","    //   0.166 - default","    //   0.125 - high quality","    //   0.063 - overkill (slower)","    FxaaFloat fxaaQualityEdgeThreshold,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    //   0.0833 - upper limit (default, the start of visible unfiltered edges)","    //   0.0625 - high quality (faster)","    //   0.0312 - visible limit (slower)","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaQualityEdgeThresholdMin,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only three safe values here: 2 and 4 and 8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // For all other platforms can be a non-power of two.","    //   8.0 is sharper (default!!!)","    //   4.0 is softer","    //   2.0 is really soft (good only for vector graphics inputs)","    FxaaFloat fxaaConsoleEdgeSharpness,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only two safe values here: 1/4 and 1/8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // The console setting has a different mapping than the quality setting.","    // Other platforms can use other values.","    //   0.125 leaves less aliasing, but is softer (default!!!)","    //   0.25 leaves more aliasing, and is sharper","    FxaaFloat fxaaConsoleEdgeThreshold,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    // The console setting has a different mapping than the quality setting.","    // This only applies when FXAA_EARLY_EXIT is 1.","    // This does not apply to PS3,","    // PS3 was simplified to avoid more shader instructions.","    //   0.06 - faster but more aliasing in darks","    //   0.05 - default","    //   0.04 - slower and less aliasing in darks","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    //","    // Extra constants for 360 FXAA Console only.","    // Use zeros or anything else for other platforms.","    // These must be in physical constant registers and NOT immedates.","    // Immedates will result in compiler un-optimizing.","    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)","    FxaaFloat4 fxaaConsole360ConstDir",") {","","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","","                    }","                    #endif","","                }","                #endif","","            }","            #endif","","        }","        #endif","","    }","    #endif","","                        }","                        #endif","","                    }","                    #endif","","                }","                #endif","","            }","            #endif","","        }","        #endif","","    }","","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  // TODO avoid querying texture twice for same texel","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n");var rd={packVector3:["float vec3_to_float( vec3 data ) {","\tconst float unit = 255.0/256.0;","\thighp float compressed = fract( data.x * unit ) + floor( data.y * unit * 255.0 ) + floor( data.z * unit * 255.0 ) * 255.0;","\treturn compressed;","}"].join("\n"),unpackFloat:["vec3 float_to_vec3( float data ) {","\tconst float unit = 255.0;","\tvec3 uncompressed;","\tuncompressed.x = fract( data );","\tfloat zInt = floor( data / unit );","\tuncompressed.z = fract( zInt / unit );","\tuncompressed.y = fract( floor( data - ( zInt * unit ) ) / unit );","\treturn uncompressed;","}"].join("\n"),packNormal:["vec2 normal_to_vec2( vec3 normal ) {","\treturn normal.xy / sqrt( normal.z * 8.0 + 8.0 ) + 0.5;","}"].join("\n"),unpackVector2:["vec3 vec2_to_normal( vec2 data ) {","\tvec2 fenc = data * 4.0 - 2.0;","\tfloat f = dot( fenc, fenc );","\tfloat g = sqrt( 1.0 - f / 4.0 );","\tvec3 normal;","\tnormal.xy = fenc * g;","\tnormal.z = 1.0 - f / 2.0;","\treturn normal;","}"].join("\n"),computeTextureCoord:["vec2 texCoord = gl_FragCoord.xy / vec2( viewWidth, viewHeight );"].join("\n"),packNormalDepth:["vec4 packedNormalDepth;","packedNormalDepth.xyz = normal * 0.5 + 0.5;","packedNormalDepth.w = position.z / position.w;"].join("\n"),unpackNormalDepth:["vec4 normalDepthMap = texture2D( samplerNormalDepth, texCoord );","float depth = normalDepthMap.w;","if ( depth == 0.0 ) discard;","vec3 normal = normalDepthMap.xyz * 2.0 - 1.0;"].join("\n"),packNormalDepthShininess:["vec4 packedNormalDepthShininess;","packedNormalDepthShininess.xy = normal_to_vec2( normal );","packedNormalDepthShininess.z = shininess;","packedNormalDepthShininess.w = position.z / position.w;"].join("\n"),unpackNormalDepthShininess:["vec4 normalDepthMap = texture2D( samplerNormalDepthShininess, texCoord );","float depth = normalDepthMap.w;","if ( depth == 0.0 ) discard;","vec3 normal = vec2_to_normal( normalDepthMap.xy );","float shininess = normalDepthMap.z;"].join("\n"),packColor:["vec4 packedColor;","packedColor.x = vec3_to_float( diffuseColor.rgb );","packedColor.y = vec3_to_float( emissiveColor );","packedColor.z = vec3_to_float( specularColor );","packedColor.w = shininess;"].join("\n"),unpackColor:["vec4 colorMap = texture2D( samplerColor, texCoord );","vec3 diffuseColor = float_to_vec3( colorMap.x );","vec3 emissiveColor = float_to_vec3( colorMap.y );","vec3 specularColor = float_to_vec3( colorMap.z );","float shininess = colorMap.w;"].join("\n"),packLight:["vec4 packedLight;","packedLight.xyz = lightIntensity * lightColor * max( dot( lightVector, normal ), 0.0 ) * attenuation;","packedLight.w = lightIntensity * specular * max( dot( lightVector, normal ), 0.0 ) * attenuation;"].join("\n"),computeVertexPositionVS:["vec2 xy = texCoord * 2.0 - 1.0;","vec4 vertexPositionProjected = vec4( xy, depth, 1.0 );","vec4 vertexPositionVS = matProjInverse * vertexPositionProjected;","vertexPositionVS.xyz /= vertexPositionVS.w;","vertexPositionVS.w = 1.0;"].join("\n"),computeSpecular:["vec3 halfVector = normalize( lightVector - normalize( vertexPositionVS.xyz ) );","float dotNormalHalf = max( dot( normal, halfVector ), 0.0 );","float specular = 0.31830988618 * ( shininess * 0.5 + 1.0 ) * pow( dotNormalHalf, shininess );"].join("\n"),combine:["gl_FragColor = vec4( lightIntensity * lightColor * max( dot( lightVector, normal ), 0.0 ) * ( diffuseColor + specular * specularColor ) * attenuation, 1.0 );"].join("\n")},id={commonUniforms:{matProjInverse:new Rr(new r),viewWidth:new Rr(800),viewHeight:new Rr(600)}};["varying vec3 vNormal;","varying vec4 vPosition;","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","void main() {","#include <begin_vertex>","#include <beginnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","\tvNormal = normalize( transformedNormal );","\tvPosition = gl_Position;","}"].join("\n"),["varying vec3 vNormal;","varying vec4 vPosition;","void main() {","\tvec3 normal = vNormal;","\tvec4 position = vPosition;",rd.packNormalDepth,"\tgl_FragColor = packedNormalDepth;","}"].join("\n"),new Rr(null),new Rr(new g(0,0,1,1)),new Rr(new h(0)),new Rr(new h(0)),new Rr(new h(0)),new Rr(30),["#include <uv_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","void main() {","#include <uv_vertex>","#include <begin_vertex>","#include <beginnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","}"].join("\n"),["uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;","#include <uv_pars_fragment>","#include <map_pars_fragment>",rd.packVector3,"void main() {","\tvec4 diffuseColor = vec4( diffuse, 1.0 );","\tvec3 emissiveColor = emissive;","\tvec3 specularColor = specular;","#include <map_fragment>",rd.packColor,"\tgl_FragColor = packedColor;","}"].join("\n"),Object.assign({samplerColor:new Rr(null)},id.commonUniforms),["void main() { ","\tgl_Position = vec4( sign( position.xy ), 0.0, 1.0 );","}"].join("\n"),["uniform sampler2D samplerColor;","uniform float viewHeight;","uniform float viewWidth;",rd.unpackFloat,"void main() {",rd.computeTextureCoord,rd.unpackColor,"\tgl_FragColor = vec4( emissiveColor, 1.0 );","}"].join("\n"),Object.assign({samplerNormalDepth:new Rr(null),samplerColor:new Rr(null),lightColor:new Rr(new h(0)),lightPositionVS:new Rr(new i(0,1,0)),lightIntensity:new Rr(1),lightRadius:new Rr(1)},id.commonUniforms),["void main() {","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D samplerNormalDepth;","uniform sampler2D samplerColor;","uniform float viewHeight;","uniform float viewWidth;","uniform vec3 lightColor;","uniform vec3 lightPositionVS;","uniform float lightIntensity;","uniform float lightRadius;","uniform mat4 matProjInverse;",rd.unpackFloat,"void main() {",rd.computeTextureCoord,rd.unpackNormalDepth,rd.computeVertexPositionVS,"\tvec3 lightVector = lightPositionVS - vertexPositionVS.xyz;","\tfloat distance = length( lightVector );","\tif ( distance > lightRadius ) discard;","\tlightVector = normalize( lightVector );",rd.unpackColor,rd.computeSpecular,"\t//float cutoff = 0.3;","\t//float denom = distance / lightRadius + 1.0;","\t//float attenuation = 1.0 / ( denom * denom );","\t//attenuation = ( attenuation - cutoff ) / ( 1.0 - cutoff );","\t//attenuation = max( attenuation, 0.0 );","\t//attenuation *= attenuation;","\t//diffuseColor *= saturate( -distance / lightRadius + 1.0 );","\t//float attenuation = 1.0;","\tfloat attenuation = saturate( -distance / lightRadius + 1.0 );",rd.combine,"}"].join("\n"),Object.assign({samplerNormalDepth:new Rr(null),samplerColor:new Rr(null),lightColor:new Rr(new h(0)),lightDirectionVS:new Rr(new i(0,1,0)),lightPositionVS:new Rr(new i(0,1,0)),lightAngle:new Rr(1),lightIntensity:new Rr(1)},id.commonUniforms),["void main() { ","\tgl_Position = vec4( sign( position.xy ), 0.0, 1.0 );","}"].join("\n"),["uniform sampler2D samplerNormalDepth;","uniform sampler2D samplerColor;","uniform float viewHeight;","uniform float viewWidth;","uniform vec3 lightColor;","uniform vec3 lightPositionVS;","uniform vec3 lightDirectionVS;","uniform float lightAngle;","uniform float lightIntensity;","uniform mat4 matProjInverse;",rd.unpackFloat,"void main() {",rd.computeTextureCoord,rd.unpackNormalDepth,rd.computeVertexPositionVS,rd.unpackColor,"\tvec3 lightVector = normalize( lightPositionVS.xyz - vertexPositionVS.xyz );","\tfloat rho = dot( lightDirectionVS, lightVector );","\tfloat rhoMax = cos( lightAngle );","\tif ( rho <= rhoMax ) discard;","\tfloat theta = rhoMax + 0.0001;","\tfloat phi = rhoMax + 0.05;","\tfloat falloff = 4.0;","\tfloat spot = 0.0;","\tif ( rho >= phi ) {","\t\tspot = 1.0;","\t} else if ( rho <= theta ) {","\t\tspot = 0.0;","\t} else { ","\t\tspot = pow( ( rho - theta ) / ( phi - theta ), falloff );","\t}","\tdiffuseColor *= spot;",rd.computeSpecular,"\tconst float attenuation = 1.0;",rd.combine,"}"].join("\n"),Object.assign({samplerNormalDepth:new Rr(null),samplerColor:new Rr(null),lightColor:new Rr(new h(0)),lightDirectionVS:new Rr(new i(0,1,0)),lightIntensity:new Rr(1)},id.commonUniforms),["void main() { ","\tgl_Position = vec4( sign( position.xy ), 0.0, 1.0 );","}"].join("\n"),["uniform sampler2D samplerNormalDepth;","uniform sampler2D samplerColor;","uniform float viewHeight;","uniform float viewWidth;","uniform vec3 lightColor;","uniform vec3 lightDirectionVS;","uniform float lightIntensity;","uniform mat4 matProjInverse;",rd.unpackFloat,"void main() {",rd.computeTextureCoord,rd.unpackNormalDepth,rd.computeVertexPositionVS,rd.unpackColor,"\tvec3 lightVector = normalize( lightDirectionVS );",rd.computeSpecular,"\tconst float attenuation = 1.0;",rd.combine,"}"].join("\n"),new Rr(30),["varying vec3 vNormal;","varying vec4 vPosition;","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","void main() {","#include <begin_vertex>","#include <beginnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","\tvNormal = normalize( transformedNormal );","\tvPosition = gl_Position;","}"].join("\n"),["varying vec3 vNormal;","varying vec4 vPosition;","uniform float shininess;",rd.packNormal,"void main() {","\tvec3 normal = vNormal;","\tvec4 position = vPosition;",rd.packNormalDepthShininess,"\tgl_FragColor = packedNormalDepthShininess;","}"].join("\n"),Object.assign({samplerNormalDepthShininess:new Rr(null),lightColor:new Rr(new h(0)),lightPositionVS:new Rr(new i(0,1,0)),lightIntensity:new Rr(1),lightRadius:new Rr(1)},id.commonUniforms),["void main() {","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D samplerNormalDepthShininess;","uniform float viewHeight;","uniform float viewWidth;","uniform vec3 lightColor;","uniform vec3 lightPositionVS;","uniform float lightIntensity;","uniform float lightRadius;","uniform mat4 matProjInverse;",rd.unpackFloat,rd.unpackVector2,"void main() {",rd.computeTextureCoord,rd.unpackNormalDepthShininess,rd.computeVertexPositionVS,"\tvec3 lightVector = lightPositionVS - vertexPositionVS.xyz;","\tfloat distance = length( lightVector );","\tif ( distance > lightRadius ) discard;","\tlightVector = normalize( lightVector );",rd.computeSpecular,"\tfloat attenuation = saturate( -distance / lightRadius + 1.0 );",rd.packLight,"\tgl_FragColor = packedLight;","}"].join("\n"),Object.assign({samplerNormalDepthShininess:new Rr(null),lightColor:new Rr(new h(0)),lightDirectionVS:new Rr(new i(0,1,0)),lightPositionVS:new Rr(new i(0,1,0)),lightAngle:new Rr(1),lightIntensity:new Rr(1)},id.commonUniforms),["void main() { ","\tgl_Position = vec4( sign( position.xy ), 0.0, 1.0 );","}"].join("\n"),["uniform sampler2D samplerNormalDepthShininess;","uniform float viewHeight;","uniform float viewWidth;","uniform vec3 lightColor;","uniform vec3 lightPositionVS;","uniform vec3 lightDirectionVS;","uniform float lightAngle;","uniform float lightIntensity;","uniform mat4 matProjInverse;",rd.unpackFloat,rd.unpackVector2,"void main() {",rd.computeTextureCoord,rd.unpackNormalDepthShininess,rd.computeVertexPositionVS,"\tvec3 lightVector = normalize( lightPositionVS.xyz - vertexPositionVS.xyz );","\tfloat rho = dot( lightDirectionVS, lightVector );","\tfloat rhoMax = cos( lightAngle );","\tif ( rho <= rhoMax ) discard;","\tfloat theta = rhoMax + 0.0001;","\tfloat phi = rhoMax + 0.05;","\tfloat falloff = 4.0;","\tfloat spot = 0.0;","\tif ( rho >= phi ) {","\t\tspot = 1.0;","\t} else if ( rho <= theta ) {","\t\tspot = 0.0;","\t} else { ","\t\tspot = pow( ( rho - theta ) / ( phi - theta ), falloff );","\t}",rd.computeSpecular,"\tconst float attenuation = 1.0;",rd.packLight,"\tgl_FragColor = spot * packedLight;","}"].join("\n"),Object.assign({samplerNormalDepthShininess:new Rr(null),lightColor:new Rr(new h(0)),lightDirectionVS:new Rr(new i(0,1,0)),lightIntensity:new Rr(1)},id.commonUniforms),["void main() { ","\tgl_Position = vec4( sign( position.xy ), 0.0, 1.0 );","}"].join("\n"),["uniform sampler2D samplerNormalDepthShininess;","uniform float viewHeight;","uniform float viewWidth;","uniform vec3 lightColor;","uniform vec3 lightDirectionVS;","uniform float lightIntensity;","uniform mat4 matProjInverse;",rd.unpackFloat,rd.unpackVector2,"void main() {",rd.computeTextureCoord,rd.unpackNormalDepthShininess,rd.computeVertexPositionVS,"\tvec3 lightVector = normalize( lightDirectionVS );",rd.computeSpecular,"\tconst float attenuation = 1.0;",rd.packLight,"\tgl_FragColor = packedLight;","}"].join("\n"),Object.assign({samplerLight:new Rr(null),map:new Rr(null),offsetRepeat:new Rr(new g(0,0,1,1)),diffuse:new Rr(new h(0)),emissive:new Rr(new h(0)),specular:new Rr(new h(0)),shininess:new Rr(30)},id.commonUniforms),["#include <uv_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","void main() {","#include <uv_vertex>","#include <begin_vertex>","#include <beginnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","}"].join("\n"),["uniform sampler2D samplerLight;","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;","uniform float viewHeight;","uniform float viewWidth;","#include <uv_pars_fragment>","#include <map_pars_fragment>",rd.unpackFloat,"void main() {","\tvec4 diffuseColor = vec4( diffuse, 1.0 );","\tvec3 emissiveColor = emissive;","\tvec3 specularColor = specular;",rd.computeTextureCoord,"\tvec4 light = texture2D( samplerLight, texCoord );","#include <map_fragment>","\tvec3 diffuseFinal = diffuseColor.rgb * light.rgb;","\tvec3 emissiveFinal = emissiveColor;","\tvec3 specularFinal = specularColor * light.rgb * light.a;","\tgl_FragColor = vec4( diffuseFinal + emissiveFinal + specularFinal, 1.0 );","}"].join("\n"),new Rr(null),["varying vec2 texCoord;","void main() {","\tvec4 pos = vec4( sign( position.xy ), 0.0, 1.0 );","\ttexCoord = pos.xy * vec2( 0.5 ) + 0.5;","\tgl_Position = pos;","}"].join("\n"),["varying vec2 texCoord;","uniform sampler2D samplerResult;","void main() {","\tgl_FragColor = texture2D( samplerResult, texCoord );","}"].join("\n");(function(t,e){function n(t,e){C.set(0,0,-1).applyQuaternion(f);for(var n=0;n<t.length;n++)T.copy(t[n]),T.applyQuaternion(f),T.add(v),a.push(T.x,T.y,T.z),s.push(C.x,C.y,C.z),l.push(e[0],e[1],e[2]);for(C.set(0,0,1).applyQuaternion(f),n=t.length-1;n>=0;n--)T.copy(t[n]),T.applyQuaternion(f),T.add(v),a.push(T.x,T.y,T.z),s.push(C.x,C.y,C.z),l.push(e[0],e[1],e[2])}function r(t,e,n){for(var r=0,i=t.length;r<i;r++){var o=t[r],u=t[(r+1)%i];E.copy(o).add(e),E.applyQuaternion(f),E.add(v),P.copy(u).add(e),P.applyQuaternion(f),P.add(v),N.copy(u).add(e),N.applyQuaternion(m),N.add(g),L.copy(o).add(e),L.applyQuaternion(m),L.add(g),a.push(E.x,E.y,E.z),a.push(P.x,P.y,P.z),a.push(L.x,L.y,L.z),a.push(P.x,P.y,P.z),a.push(N.x,N.y,N.z),a.push(L.x,L.y,L.z),I.copy(o),I.applyQuaternion(f),I.normalize(),D.copy(u),D.applyQuaternion(f),D.normalize(),F.copy(u),F.applyQuaternion(m),F.normalize(),R.copy(o),R.applyQuaternion(m),R.normalize(),s.push(I.x,I.y,I.z),s.push(D.x,D.y,D.z),s.push(R.x,R.y,R.z),s.push(D.x,D.y,D.z),s.push(F.x,F.y,F.z),s.push(R.x,R.y,R.z),l.push(n[0],n[1],n[2]),l.push(n[0],n[1],n[2]),l.push(n[0],n[1],n[2]),l.push(n[0],n[1],n[2]),l.push(n[0],n[1],n[2]),l.push(n[0],n[1],n[2])}}O.call(this);var a=[],s=[],l=[],u=[1,1,1],c=[1,1,0],h=new i(0,1,0),p=new i,d=new i,f=new o,m=new o;m.setFromAxisAngle(h,Math.PI/2);var v=new i,g=new i;g.copy(t.getPointAt(0));for(var b=[new i(-.225,0,0),new i(0,-.05,0),new i(0,-.175,0),new i(0,-.05,0),new i(.225,0,0),new i(0,-.175,0)],_=2*Math.PI,x=5,w=[],S=0;S<x;S++){var A=S/x*_;w.push(new i(.06*Math.sin(A),.06*Math.cos(A),0))}x=6;var M=[];for(S=0;S<x;S++)A=S/x*_,M.push(new i(.025*Math.sin(A),.025*Math.cos(A),0));var T=new i,C=new i,E=new i,P=new i,N=new i,L=new i,I=new i,D=new i,F=new i,R=new i,k=new i;for(S=1;S<=e;S++)v.copy(t.getPointAt(S/e)),h.set(0,1,0),p.subVectors(v,g).normalize(),d.crossVectors(h,p).normalize(),h.crossVectors(p,d),A=Math.atan2(p.x,p.z),f.setFromAxisAngle(h,A),S%2==0&&n(b,c),r(w,k.set(0,-.125,0),c),r(M,k.set(.2,0,0),u),r(M,k.set(-.2,0,0),u),g.copy(v),m.copy(f);this.addAttribute("position",new y(new Float32Array(a),3)),this.addAttribute("normal",new y(new Float32Array(s),3)),this.addAttribute("color",new y(new Float32Array(l),3))}).prototype=Object.create(O.prototype),function(t,e){function n(t,e,n){for(var i=0,o=t.length;i<o;i++){var l=t[i],u=t[(i+1)%o];f.copy(l),f.applyQuaternion(s),f.add(e),m.copy(u),m.applyQuaternion(s),m.add(e),v.copy(u),v.applyQuaternion(s),v.add(n),g.copy(l),g.applyQuaternion(s),g.add(n),r.push(f.x,f.y,f.z),r.push(m.x,m.y,m.z),r.push(g.x,g.y,g.z),r.push(m.x,m.y,m.z),r.push(v.x,v.y,v.z),r.push(g.x,g.y,g.z),b.copy(l),b.applyQuaternion(s),b.normalize(),_.copy(u),_.applyQuaternion(s),_.normalize(),x.copy(u),x.applyQuaternion(s),x.normalize(),w.copy(l),w.applyQuaternion(s),w.normalize(),a.push(b.x,b.y,b.z),a.push(_.x,_.y,_.z),a.push(w.x,w.y,w.z),a.push(_.x,_.y,_.z),a.push(x.x,x.y,x.z),a.push(w.x,w.y,w.z)}}O.call(this);for(var r=[],a=[],s=new o,l=new i(0,1,0),u=new i,c=new i,h=[new i(0,.05,-.05),new i(0,.05,.05),new i(0,-.05,0)],p=[new i(-.05,0,.05),new i(-.05,0,-.05),new i(.05,0,0)],d=[new i(.05,0,-.05),new i(.05,0,.05),new i(-.05,0,0)],f=new i,m=new i,v=new i,g=new i,b=new i,_=new i,x=new i,w=new i,S=new i,A=new i,M=1;M<=e;M++){u.copy(t.getPointAt(M/e)),c.copy(t.getTangentAt(M/e));var T=Math.atan2(c.x,c.z);s.setFromAxisAngle(l,T),u.y>10?(S.set(-.75,-.35,0),S.applyQuaternion(s),S.add(u),A.set(.75,-.35,0),A.applyQuaternion(s),A.add(u),n(h,S,A),S.set(-.7,-.3,0),S.applyQuaternion(s),S.add(u),A.set(-.7,-u.y,0),A.applyQuaternion(s),A.add(u),n(p,S,A),S.set(.7,-.3,0),S.applyQuaternion(s),S.add(u),A.set(.7,-u.y,0),A.applyQuaternion(s),A.add(u),n(d,S,A)):(S.set(0,-.2,0),S.applyQuaternion(s),S.add(u),A.set(0,-u.y,0),A.applyQuaternion(s),A.add(u),n(d,S,A))}this.addAttribute("position",new y(new Float32Array(r),3)),this.addAttribute("normal",new y(new Float32Array(a),3))}.prototype=Object.create(O.prototype),function(t,e){O.call(this);var n=[],r=new i(0,1,0),a=new i,s=new o,l=new o;l.setFromAxisAngle(r,Math.PI/2);var u=new i,c=new i;c.copy(t.getPointAt(0)),c.y=0;for(var h=new i,p=new i,d=new i,f=new i,m=1;m<=e;m++){u.copy(t.getPointAt(m/e)),u.y=0,a.subVectors(u,c);var v=Math.atan2(a.x,a.z);s.setFromAxisAngle(r,v),h.set(-.3,0,0),h.applyQuaternion(s),h.add(u),p.set(.3,0,0),p.applyQuaternion(s),p.add(u),d.set(.3,0,0),d.applyQuaternion(l),d.add(c),f.set(-.3,0,0),f.applyQuaternion(l),f.add(c),n.push(h.x,h.y,h.z),n.push(p.x,p.y,p.z),n.push(f.x,f.y,f.z),n.push(p.x,p.y,p.z),n.push(d.x,d.y,d.z),n.push(f.x,f.y,f.z),c.copy(u),l.copy(s)}this.addAttribute("position",new y(new Float32Array(n),3))}.prototype=Object.create(O.prototype),function(){O.call(this);for(var t=[],e=0;e<100;e++){var n=800*Math.random()-400,r=50*Math.random()+50,i=800*Math.random()-400,o=40*Math.random()+20;t.push(n-o,r,i-o),t.push(n+o,r,i-o),t.push(n-o,r,i+o),t.push(n+o,r,i-o),t.push(n+o,r,i+o),t.push(n-o,r,i+o)}this.addAttribute("position",new y(new Float32Array(t),3))}.prototype=Object.create(O.prototype),function(t){O.call(this);var e=[],n=[],r=new Ft;r.ray.direction.set(0,-1,0);for(var i=0;i<2e3;i++){var o=500*Math.random()-250,a=500*Math.random()-250;r.ray.origin.set(o,50,a);var s=r.intersectObject(t);if(0!==s.length){var l=s[0].point.y,u=5*Math.random()+.5,c=Math.random()*Math.PI*2;e.push(o+Math.sin(c),l,a+Math.cos(c)),e.push(o,l+u,a),e.push(o+Math.sin(c+Math.PI),l,a+Math.cos(c+Math.PI)),c+=Math.PI/2,e.push(o+Math.sin(c),l,a+Math.cos(c)),e.push(o,l+u,a),e.push(o+Math.sin(c+Math.PI),l,a+Math.cos(c+Math.PI));for(var h=.1*Math.random(),p=0;p<6;p++)n.push(.2+h,.4+h,0)}}this.addAttribute("position",new y(new Float32Array(e),3)),this.addAttribute("color",new y(new Float32Array(n),3))}.prototype=Object.create(O.prototype);new m(.5,.5),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["#define TAPS_PER_PASS 6.0","varying vec2 vUv;","uniform sampler2D tInput;","uniform vec2 vSunPositionScreenSpace;","uniform float fStepSize;","void main() {","vec2 delta = vSunPositionScreenSpace - vUv;","float dist = length( delta );","vec2 stepv = fStepSize * delta / dist;","float iters = dist/fStepSize;","vec2 uv = vUv.xy;","float col = 0.0;","if ( 0.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","uv += stepv;","if ( 1.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","uv += stepv;","if ( 2.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","uv += stepv;","if ( 3.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","uv += stepv;","if ( 4.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","uv += stepv;","if ( 5.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","uv += stepv;","gl_FragColor = vec4( col/TAPS_PER_PASS );","gl_FragColor.a = 1.0;","}"].join("\n"),new m(.5,.5),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["varying vec2 vUv;","uniform sampler2D tColors;","uniform sampler2D tGodRays;","uniform vec2 vSunPositionScreenSpace;","uniform float fGodRayIntensity;","void main() {","gl_FragColor = texture2D( tColors, vUv ) + fGodRayIntensity * vec4( 1.0 - texture2D( tGodRays, vUv ).r );","gl_FragColor.a = 1.0;","}"].join("\n"),new m(.5,.5),new h(16772608),new h(0),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["varying vec2 vUv;","uniform vec2 vSunPositionScreenSpace;","uniform float fAspect;","uniform vec3 sunColor;","uniform vec3 bgColor;","void main() {","vec2 diff = vUv - vSunPositionScreenSpace;","diff.x *= fAspect;","float prop = clamp( length( diff ) / 0.5, 0.0, 1.0 );","prop = 0.35 * pow( 1.0 - prop, 3.0 );","gl_FragColor.xyz = mix( sunColor, bgColor, 1.0 - prop );","gl_FragColor.w = 1.0;","}"].join("\n"),["void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["void main() {","gl_FragColor = vec4( 1.0, 0.0, 0.0, 0.5 );","}"].join("\n"),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 base = texture2D( tDiffuse, vUv );","vec3 lumCoeff = vec3( 0.25, 0.65, 0.1 );","float lum = dot( lumCoeff, base.rgb );","vec3 blend = vec3( lum );","float L = min( 1.0, max( 0.0, 10.0 * ( lum - 0.45 ) ) );","vec3 result1 = 2.0 * base.rgb * blend;","vec3 result2 = 1.0 - 2.0 * ( 1.0 - blend ) * ( 1.0 - base.rgb );","vec3 newColor = mix( result1, result2, L );","float A2 = opacity * base.a;","vec3 mixRGB = A2 * newColor.rgb;","mixRGB += ( ( 1.0 - A2 ) * base.rgb );","gl_FragColor = vec4( mixRGB, base.a );","}"].join("\n"),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform float opacity;","uniform float mixRatio;","uniform sampler2D tDiffuse1;","uniform sampler2D tDiffuse2;","varying vec2 vUv;","void main() {","vec4 texel1 = texture2D( tDiffuse1, vUv );","vec4 texel2 = texture2D( tDiffuse2, vUv );","gl_FragColor = opacity * mix( texel1, texel2, mixRatio );","}"].join("\n"),new m,["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["#include <common>","varying vec2 vUv;","uniform sampler2D tColor;","uniform sampler2D tDepth;","uniform float textureWidth;","uniform float textureHeight;","uniform float focalDepth;  //focal distance value in meters, but you may use autofocus option below","uniform float focalLength; //focal length in mm","uniform float fstop; //f-stop value","uniform bool showFocus; //show debug focus point and focal range (red = focal point, green = focal range)","","uniform float znear; // camera clipping start","uniform float zfar; // camera clipping end","//------------------------------------------","//user variables","const int samples = SAMPLES; //samples on the first ring","const int rings = RINGS; //ring count","const int maxringsamples = rings * samples;","uniform bool manualdof; // manual dof calculation","float ndofstart = 1.0; // near dof blur start","float ndofdist = 2.0; // near dof blur falloff distance","float fdofstart = 1.0; // far dof blur start","float fdofdist = 3.0; // far dof blur falloff distance","float CoC = 0.03; //circle of confusion size in mm (35mm film = 0.03mm)","uniform bool vignetting; // use optical lens vignetting","float vignout = 1.3; // vignetting outer border","float vignin = 0.0; // vignetting inner border","float vignfade = 22.0; // f-stops till vignete fades","uniform bool shaderFocus;","// disable if you use external focalDepth value","uniform vec2 focusCoords;","// autofocus point on screen (0.0,0.0 - left lower corner, 1.0,1.0 - upper right)","// if center of screen use vec2(0.5, 0.5);","uniform float maxblur;","//clamp value of max blur (0.0 = no blur, 1.0 default)","uniform float threshold; // highlight threshold;","uniform float gain; // highlight gain;","uniform float bias; // bokeh edge bias","uniform float fringe; // bokeh chromatic aberration / fringing","uniform bool noise; //use noise instead of pattern for sample dithering","uniform float dithering;","uniform bool depthblur; // blur the depth buffer","float dbsize = 1.25; // depth blur size","","uniform bool pentagon; //use pentagon as bokeh shape?","float feather = 0.4; //pentagon shape feather","//------------------------------------------","float penta(vec2 coords) {","//pentagonal shape","float scale = float(rings) - 1.3;","vec4  HS0 = vec4( 1.0,         0.0,         0.0,  1.0);","vec4  HS1 = vec4( 0.309016994, 0.951056516, 0.0,  1.0);","vec4  HS2 = vec4(-0.809016994, 0.587785252, 0.0,  1.0);","vec4  HS3 = vec4(-0.809016994,-0.587785252, 0.0,  1.0);","vec4  HS4 = vec4( 0.309016994,-0.951056516, 0.0,  1.0);","vec4  HS5 = vec4( 0.0        ,0.0         , 1.0,  1.0);","vec4  one = vec4( 1.0 );","vec4 P = vec4((coords),vec2(scale, scale));","vec4 dist = vec4(0.0);","float inorout = -4.0;","dist.x = dot( P, HS0 );","dist.y = dot( P, HS1 );","dist.z = dot( P, HS2 );","dist.w = dot( P, HS3 );","dist = smoothstep( -feather, feather, dist );","inorout += dot( dist, one );","dist.x = dot( P, HS4 );","dist.y = HS5.w - abs( P.z );","dist = smoothstep( -feather, feather, dist );","inorout += dist.x;","return clamp( inorout, 0.0, 1.0 );","}","float bdepth(vec2 coords) {","// Depth buffer blur","float d = 0.0;","float kernel[9];","vec2 offset[9];","vec2 wh = vec2(1.0/textureWidth,1.0/textureHeight) * dbsize;","offset[0] = vec2(-wh.x,-wh.y);","offset[1] = vec2( 0.0, -wh.y);","offset[2] = vec2( wh.x -wh.y);","offset[3] = vec2(-wh.x,  0.0);","offset[4] = vec2( 0.0,   0.0);","offset[5] = vec2( wh.x,  0.0);","offset[6] = vec2(-wh.x, wh.y);","offset[7] = vec2( 0.0,  wh.y);","offset[8] = vec2( wh.x, wh.y);","kernel[0] = 1.0/16.0;   kernel[1] = 2.0/16.0;   kernel[2] = 1.0/16.0;","kernel[3] = 2.0/16.0;   kernel[4] = 4.0/16.0;   kernel[5] = 2.0/16.0;","kernel[6] = 1.0/16.0;   kernel[7] = 2.0/16.0;   kernel[8] = 1.0/16.0;","for( int i=0; i<9; i++ ) {","float tmp = texture2D(tDepth, coords + offset[i]).r;","d += tmp * kernel[i];","}","return d;","}","vec3 color(vec2 coords,float blur) {","//processing the sample","vec3 col = vec3(0.0);","vec2 texel = vec2(1.0/textureWidth,1.0/textureHeight);","col.r = texture2D(tColor,coords + vec2(0.0,1.0)*texel*fringe*blur).r;","col.g = texture2D(tColor,coords + vec2(-0.866,-0.5)*texel*fringe*blur).g;","col.b = texture2D(tColor,coords + vec2(0.866,-0.5)*texel*fringe*blur).b;","vec3 lumcoeff = vec3(0.299,0.587,0.114);","float lum = dot(col.rgb, lumcoeff);","float thresh = max((lum-threshold)*gain, 0.0);","return col+mix(vec3(0.0),col,thresh*blur);","}","vec3 debugFocus(vec3 col, float blur, float depth) {","float edge = 0.002*depth; //distance based edge smoothing","float m = clamp(smoothstep(0.0,edge,blur),0.0,1.0);","float e = clamp(smoothstep(1.0-edge,1.0,blur),0.0,1.0);","col = mix(col,vec3(1.0,0.5,0.0),(1.0-m)*0.6);","col = mix(col,vec3(0.0,0.5,1.0),((1.0-e)-(1.0-m))*0.2);","return col;","}","float linearize(float depth) {","return -zfar * znear / (depth * (zfar - znear) - zfar);","}","float vignette() {","float dist = distance(vUv.xy, vec2(0.5,0.5));","dist = smoothstep(vignout+(fstop/vignfade), vignin+(fstop/vignfade), dist);","return clamp(dist,0.0,1.0);","}","float gather(float i, float j, int ringsamples, inout vec3 col, float w, float h, float blur) {","float rings2 = float(rings);","float step = PI*2.0 / float(ringsamples);","float pw = cos(j*step)*i;","float ph = sin(j*step)*i;","float p = 1.0;","if (pentagon) {","p = penta(vec2(pw,ph));","}","col += color(vUv.xy + vec2(pw*w,ph*h), blur) * mix(1.0, i/rings2, bias) * p;","return 1.0 * mix(1.0, i /rings2, bias) * p;","}","void main() {","//scene depth calculation","float depth = linearize(texture2D(tDepth,vUv.xy).x);","// Blur depth?","if (depthblur) {","depth = linearize(bdepth(vUv.xy));","}","//focal plane calculation","float fDepth = focalDepth;","if (shaderFocus) {","fDepth = linearize(texture2D(tDepth,focusCoords).x);","}","// dof blur factor calculation","float blur = 0.0;","if (manualdof) {","float a = depth-fDepth; // Focal plane","float b = (a-fdofstart)/fdofdist; // Far DoF","float c = (-a-ndofstart)/ndofdist; // Near Dof","blur = (a>0.0) ? b : c;","} else {","float f = focalLength; // focal length in mm","float d = fDepth*1000.0; // focal plane in mm","float o = depth*1000.0; // depth in mm","float a = (o*f)/(o-f);","float b = (d*f)/(d-f);","float c = (d-f)/(d*fstop*CoC);","blur = abs(a-b)*c;","}","blur = clamp(blur,0.0,1.0);","// calculation of pattern for dithering","vec2 noise = vec2(rand(vUv.xy), rand( vUv.xy + vec2( 0.4, 0.6 ) ) )*dithering*blur;","// getting blur x and y step factor","float w = (1.0/textureWidth)*blur*maxblur+noise.x;","float h = (1.0/textureHeight)*blur*maxblur+noise.y;","// calculation of final color","vec3 col = vec3(0.0);","if(blur < 0.05) {","//some optimization thingy","col = texture2D(tColor, vUv.xy).rgb;","} else {","col = texture2D(tColor, vUv.xy).rgb;","float s = 1.0;","int ringsamples;","for (int i = 1; i <= rings; i++) {","","ringsamples = i * samples;","for (int j = 0 ; j < maxringsamples ; j++) {","if (j >= ringsamples) break;","s += gather(float(i), float(j), ringsamples, col, w, h, blur);","}","","}","col /= s; //divide by sample count","}","if (showFocus) {","col = debugFocus(col, blur, depth);","}","if (vignetting) {","col *= vignette();","}","gl_FragColor.rgb = col;","gl_FragColor.a = 1.0;","} "].join("\n"),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D tDiffuse;","uniform float brightness;","uniform float contrast;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D( tDiffuse, vUv );","gl_FragColor.rgb += brightness;","if (contrast > 0.0) {","gl_FragColor.rgb = (gl_FragColor.rgb - 0.5) / (1.0 - contrast) + 0.5;","} else {","gl_FragColor.rgb = (gl_FragColor.rgb - 0.5) * (1.0 + contrast) + 0.5;","}","}"].join("\n"),new i(2,2,2),new i(1,1,1),new i(0,0,0),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D tDiffuse;","uniform vec3 powRGB;","uniform vec3 mulRGB;","uniform vec3 addRGB;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D( tDiffuse, vUv );","gl_FragColor.rgb = mulRGB * pow( ( gl_FragColor.rgb + addRGB ), powRGB );","}"].join("\n"),new h(16777215),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float v = dot( texel.xyz, luma );","gl_FragColor = vec4( v * color, texel.w );","}"].join("\n"),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform float focus;","uniform float maxblur;","uniform sampler2D tColor;","uniform sampler2D tDepth;","varying vec2 vUv;","void main() {","vec4 depth = texture2D( tDepth, vUv );","float factor = depth.x - focus;","vec4 col = texture2D( tColor, vUv, 2.0 * maxblur * abs( focus - depth.x ) );","gl_FragColor = col;","gl_FragColor.a = 1.0;","}"].join("\n"),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform float screenWidth;","uniform float screenHeight;","uniform float sampleDistance;","uniform float waveFactor;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 color, org, tmp, add;","float sample_dist, f;","vec2 vin;","vec2 uv = vUv;","add = color = org = texture2D( tDiffuse, uv );","vin = ( uv - vec2( 0.5 ) ) * vec2( 1.4 );","sample_dist = dot( vin, vin ) * 2.0;","f = ( waveFactor * 100.0 + sample_dist ) * sampleDistance * 4.0;","vec2 sampleSize = vec2(  1.0 / screenWidth, 1.0 / screenHeight ) * vec2( f );","add += tmp = texture2D( tDiffuse, uv + vec2( 0.111964, 0.993712 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( 0.846724, 0.532032 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( 0.943883, -0.330279 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( 0.330279, -0.943883 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( -0.532032, -0.846724 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( -0.993712, -0.111964 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","add += tmp = texture2D( tDiffuse, uv + vec2( -0.707107, 0.707107 ) * sampleSize );","if( tmp.b < color.b ) color = tmp;","color = color * vec4( 2.0 ) - ( add / vec4( 8.0 ) );","color = color + ( add / vec4( 8.0 ) - color ) * ( vec4( 1.0 ) - vec4( sample_dist * 0.5 ) );","gl_FragColor = vec4( color.rgb * color.rgb * vec3( 0.95 ) + color.rgb, 1.0 );","}"].join("\n"),new m(512,512),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D tDiffuse;","varying vec2 vUv;","uniform vec2 aspect;","vec2 texel = vec2(1.0 / aspect.x, 1.0 / aspect.y);","mat3 G[9];","const mat3 g0 = mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );","const mat3 g1 = mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );","const mat3 g2 = mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );","const mat3 g3 = mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );","const mat3 g4 = mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );","const mat3 g5 = mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );","const mat3 g6 = mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );","const mat3 g7 = mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );","const mat3 g8 = mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );","void main(void)","{","G[0] = g0,","G[1] = g1,","G[2] = g2,","G[3] = g3,","G[4] = g4,","G[5] = g5,","G[6] = g6,","G[7] = g7,","G[8] = g8;","mat3 I;","float cnv[9];","vec3 sample;","for (float i=0.0; i<3.0; i++) {","for (float j=0.0; j<3.0; j++) {","sample = texture2D(tDiffuse, vUv + texel * vec2(i-1.0,j-1.0) ).rgb;","I[int(i)][int(j)] = length(sample);","}","}","for (int i=0; i<9; i++) {","float dp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);","cnv[i] = dp3 * dp3;","}","float M = (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);","float S = (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);","gl_FragColor = vec4(vec3(sqrt(M/S)), 1.0);","}"].join("\n"),["uniform float mRefractionRatio;","uniform float mFresnelBias;","uniform float mFresnelScale;","uniform float mFresnelPower;","varying vec3 vReflect;","varying vec3 vRefract[3];","varying float vReflectionFactor;","void main() {","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vec3 worldNormal = normalize( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );","vec3 I = worldPosition.xyz - cameraPosition;","vReflect = reflect( I, worldNormal );","vRefract[0] = refract( normalize( I ), worldNormal, mRefractionRatio );","vRefract[1] = refract( normalize( I ), worldNormal, mRefractionRatio * 0.99 );","vRefract[2] = refract( normalize( I ), worldNormal, mRefractionRatio * 0.98 );","vReflectionFactor = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( I ), worldNormal ), mFresnelPower );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),["uniform samplerCube tCube;","varying vec3 vReflect;","varying vec3 vRefract[3];","varying float vReflectionFactor;","void main() {","vec4 reflectedColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );","vec4 refractedColor = vec4( 1.0 );","refractedColor.r = textureCube( tCube, vec3( -vRefract[0].x, vRefract[0].yz ) ).r;","refractedColor.g = textureCube( tCube, vec3( -vRefract[1].x, vRefract[1].yz ) ).g;","refractedColor.b = textureCube( tCube, vec3( -vRefract[2].x, vRefract[2].yz ) ).b;","gl_FragColor = mix( refractedColor, reflectedColor, clamp( vReflectionFactor, 0.0, 1.0 ) );","}"].join("\n"),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 tex = texture2D( tDiffuse, vec2( vUv.x, vUv.y ) );","gl_FragColor = LinearToGamma( tex, float( GAMMA_FACTOR ) );","}"].join("\n"),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D tDiffuse;","uniform float h;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n"),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D tDiffuse;","uniform float h;","uniform float r;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","float hh = h * abs( r - vUv.y );","sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * hh, vUv.y ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * hh, vUv.y ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * hh, vUv.y ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * hh, vUv.y ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * hh, vUv.y ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * hh, vUv.y ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * hh, vUv.y ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * hh, vUv.y ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n"),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D tDiffuse;","uniform float hue;","uniform float saturation;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D( tDiffuse, vUv );","float angle = hue * 3.14159265;","float s = sin(angle), c = cos(angle);","vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;","float len = length(gl_FragColor.rgb);","gl_FragColor.rgb = vec3(","dot(gl_FragColor.rgb, weights.xyz),","dot(gl_FragColor.rgb, weights.zxy),","dot(gl_FragColor.rgb, weights.yzx)",");","float average = (gl_FragColor.r + gl_FragColor.g + gl_FragColor.b) / 3.0;","if (saturation > 0.0) {","gl_FragColor.rgb += (average - gl_FragColor.rgb) * (1.0 - 1.0 / (1.001 - saturation));","} else {","gl_FragColor.rgb += (average - gl_FragColor.rgb) * (-saturation);","}","}"].join("\n"),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D tDiffuse;","uniform float sides;","uniform float angle;","varying vec2 vUv;","void main() {","vec2 p = vUv - 0.5;","float r = length(p);","float a = atan(p.y, p.x) + angle;","float tau = 2. * 3.1416 ;","a = mod(a, tau/sides);","a = abs(a - tau/sides/2.) ;","p = r * vec2(cos(a), sin(a));","vec4 color = texture2D(tDiffuse, p + 0.5);","gl_FragColor = color;","}"].join("\n"),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D tDiffuse;","uniform int side;","varying vec2 vUv;","void main() {","vec2 p = vUv;","if (side == 0){","if (p.x > 0.5) p.x = 1.0 - p.x;","}else if (side == 1){","if (p.x < 0.5) p.x = 1.0 - p.x;","}else if (side == 2){","if (p.y < 0.5) p.y = 1.0 - p.y;","}else if (side == 3){","if (p.y > 0.5) p.y = 1.0 - p.y;","} ","vec4 color = texture2D(tDiffuse, p);","gl_FragColor = color;","}"].join("\n"),new m(512,512),new m(1,1),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform float height;","uniform vec2 resolution;","uniform sampler2D heightMap;","varying vec2 vUv;","void main() {","float val = texture2D( heightMap, vUv ).x;","float valU = texture2D( heightMap, vUv + vec2( 1.0 / resolution.x, 0.0 ) ).x;","float valV = texture2D( heightMap, vUv + vec2( 0.0, 1.0 / resolution.y ) ).x;","gl_FragColor = vec4( ( 0.5 * normalize( vec3( val - valU, val - valV, height  ) ) + 0.5 ), 1.0 );","}"].join("\n"),["varying vec2 vUv;","varying vec3 vViewPosition;","varying vec3 vNormal;","void main() {","vUv = uv;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vViewPosition = -mvPosition.xyz;","vNormal = normalize( normalMatrix * normal );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),["uniform sampler2D bumpMap;","uniform sampler2D map;","uniform float parallaxScale;","uniform float parallaxMinLayers;","uniform float parallaxMaxLayers;","varying vec2 vUv;","varying vec3 vViewPosition;","varying vec3 vNormal;","#ifdef USE_BASIC_PARALLAX","vec2 parallaxMap( in vec3 V ) {","float initialHeight = texture2D( bumpMap, vUv ).r;","vec2 texCoordOffset = parallaxScale * V.xy * initialHeight;","return vUv - texCoordOffset;","}","#else","vec2 parallaxMap( in vec3 V ) {","float numLayers = mix( parallaxMaxLayers, parallaxMinLayers, abs( dot( vec3( 0.0, 0.0, 1.0 ), V ) ) );","float layerHeight = 1.0 / numLayers;","float currentLayerHeight = 0.0;","vec2 dtex = parallaxScale * V.xy / V.z / numLayers;","vec2 currentTextureCoords = vUv;","float heightFromTexture = texture2D( bumpMap, currentTextureCoords ).r;","for ( int i = 0; i < 30; i += 1 ) {","if ( heightFromTexture <= currentLayerHeight ) {","break;","}","currentLayerHeight += layerHeight;","currentTextureCoords -= dtex;","heightFromTexture = texture2D( bumpMap, currentTextureCoords ).r;","}","#ifdef USE_STEEP_PARALLAX","return currentTextureCoords;","#elif defined( USE_RELIEF_PARALLAX )","vec2 deltaTexCoord = dtex / 2.0;","float deltaHeight = layerHeight / 2.0;","currentTextureCoords += deltaTexCoord;","currentLayerHeight -= deltaHeight;","const int numSearches = 5;","for ( int i = 0; i < numSearches; i += 1 ) {","deltaTexCoord /= 2.0;","deltaHeight /= 2.0;","heightFromTexture = texture2D( bumpMap, currentTextureCoords ).r;","if( heightFromTexture > currentLayerHeight ) {","currentTextureCoords -= deltaTexCoord;","currentLayerHeight += deltaHeight;","} else {","currentTextureCoords += deltaTexCoord;","currentLayerHeight -= deltaHeight;","}","}","return currentTextureCoords;","#elif defined( USE_OCLUSION_PARALLAX )","vec2 prevTCoords = currentTextureCoords + dtex;","float nextH = heightFromTexture - currentLayerHeight;","float prevH = texture2D( bumpMap, prevTCoords ).r - currentLayerHeight + layerHeight;","float weight = nextH / ( nextH - prevH );","return prevTCoords * weight + currentTextureCoords * ( 1.0 - weight );","#else","return vUv;","#endif","}","#endif","vec2 perturbUv( vec3 surfPosition, vec3 surfNormal, vec3 viewPosition ) {","vec2 texDx = dFdx( vUv );","vec2 texDy = dFdy( vUv );","vec3 vSigmaX = dFdx( surfPosition );","vec3 vSigmaY = dFdy( surfPosition );","vec3 vR1 = cross( vSigmaY, surfNormal );","vec3 vR2 = cross( surfNormal, vSigmaX );","float fDet = dot( vSigmaX, vR1 );","vec2 vProjVscr = ( 1.0 / fDet ) * vec2( dot( vR1, viewPosition ), dot( vR2, viewPosition ) );","vec3 vProjVtex;","vProjVtex.xy = texDx * vProjVscr.x + texDy * vProjVscr.y;","vProjVtex.z = dot( surfNormal, viewPosition );","return parallaxMap( vProjVtex );","}","void main() {","vec2 mapUv = perturbUv( -vViewPosition, normalize( vNormal ), normalize( vViewPosition ) );","gl_FragColor = texture2D( map, mapUv );","}"].join("\n"),["varying highp vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D tDiffuse;","uniform float pixelSize;","uniform vec2 resolution;","varying highp vec2 vUv;","void main(){","vec2 dxy = pixelSize / resolution;","vec2 coord = dxy * floor( vUv / dxy );","gl_FragColor = texture2D(tDiffuse, coord);","}"].join("\n"),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D tDiffuse;","uniform float amount;","uniform float angle;","varying vec2 vUv;","void main() {","vec2 offset = amount * vec2( cos(angle), sin(angle));","vec4 cr = texture2D(tDiffuse, vUv + offset);","vec4 cga = texture2D(tDiffuse, vUv);","vec4 cb = texture2D(tDiffuse, vUv - offset);","gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);","}"].join("\n"),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform float amount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 color = texture2D( tDiffuse, vUv );","vec3 c = color.rgb;","color.r = dot( c, vec3( 1.0 - 0.607 * amount, 0.769 * amount, 0.189 * amount ) );","color.g = dot( c, vec3( 0.349 * amount, 1.0 - 0.314 * amount, 0.168 * amount ) );","color.b = dot( c, vec3( 0.272 * amount, 0.534 * amount, 1.0 - 0.869 * amount ) );","gl_FragColor = vec4( min( vec3( 1.0 ), color.rgb ), color.a );","}"].join("\n"),new m,["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D tDiffuse;","uniform vec2 resolution;","varying vec2 vUv;","void main() {","vec2 texel = vec2( 1.0 / resolution.x, 1.0 / resolution.y );","const mat3 Gx = mat3( -1, -2, -1, 0, 0, 0, 1, 2, 1 );","const mat3 Gy = mat3( -1, 0, 1, -2, 0, 2, -1, 0, 1 );","float tx0y0 = texture2D( tDiffuse, vUv + texel * vec2( -1, -1 ) ).r;","float tx0y1 = texture2D( tDiffuse, vUv + texel * vec2( -1,  0 ) ).r;","float tx0y2 = texture2D( tDiffuse, vUv + texel * vec2( -1,  1 ) ).r;","float tx1y0 = texture2D( tDiffuse, vUv + texel * vec2(  0, -1 ) ).r;","float tx1y1 = texture2D( tDiffuse, vUv + texel * vec2(  0,  0 ) ).r;","float tx1y2 = texture2D( tDiffuse, vUv + texel * vec2(  0,  1 ) ).r;","float tx2y0 = texture2D( tDiffuse, vUv + texel * vec2(  1, -1 ) ).r;","float tx2y1 = texture2D( tDiffuse, vUv + texel * vec2(  1,  0 ) ).r;","float tx2y2 = texture2D( tDiffuse, vUv + texel * vec2(  1,  1 ) ).r;","float valueGx = Gx[0][0] * tx0y0 + Gx[1][0] * tx1y0 + Gx[2][0] * tx2y0 + ","Gx[0][1] * tx0y1 + Gx[1][1] * tx1y1 + Gx[2][1] * tx2y1 + ","Gx[0][2] * tx0y2 + Gx[1][2] * tx1y2 + Gx[2][2] * tx2y2; ","float valueGy = Gy[0][0] * tx0y0 + Gy[1][0] * tx1y0 + Gy[2][0] * tx2y0 + ","Gy[0][1] * tx0y1 + Gy[1][1] * tx1y1 + Gy[2][1] * tx2y1 + ","Gy[0][2] * tx0y2 + Gy[1][2] * tx1y2 + Gy[2][2] * tx2y2; ","float G = sqrt( ( valueGx * valueGx ) + ( valueGy * valueGy ) );","gl_FragColor = vec4( vec3( G ), 1 );","}"].join("\n"),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 tex = texture2D( tDiffuse, vec2( vUv.x, vUv.y ) );","vec4 newTex = vec4(tex.r, (tex.g + tex.b) * .5, (tex.g + tex.b) * .5, 1.0);","gl_FragColor = newTex;","}"].join("\n"),new m(1,1),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["#include <common>","#define ITERATIONS 10.0","uniform sampler2D texture;","uniform vec2 delta;","varying vec2 vUv;","void main() {","vec4 color = vec4( 0.0 );","float total = 0.0;","float offset = rand( vUv );","for ( float t = -ITERATIONS; t <= ITERATIONS; t ++ ) {","float percent = ( t + offset - 0.5 ) / ITERATIONS;","float weight = 1.0 - abs( percent );","color += texture2D( texture, vUv + delta * percent ) * weight;","total += weight;","}","gl_FragColor = color / total;","}"].join("\n"),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D tDiffuse;","uniform float v;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n"),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D tDiffuse;","uniform float v;","uniform float r;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","float vv = v * abs( r - vUv.y );","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * vv ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * vv ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * vv ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * vv ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * vv ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * vv ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * vv ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * vv ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n"),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform float offset;","uniform float darkness;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec2 uv = ( vUv - vec2( 0.5 ) ) * vec2( offset );","gl_FragColor = vec4( mix( texel.rgb, vec3( 1.0 - darkness ), dot( uv, uv ) ), texel.a );","}"].join("\n"),["uniform mat4 textureMatrix;","varying vec2 vUv;","varying vec4 vUvRefraction;","void main() {","\tvUv = uv;","\tvUvRefraction = textureMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform vec3 color;","uniform float time;","uniform sampler2D tDiffuse;","uniform sampler2D tDudv;","varying vec2 vUv;","varying vec4 vUvRefraction;","float blendOverlay( float base, float blend ) {","\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ),blendOverlay( base.b, blend.b ) );","}","void main() {"," float waveStrength = 0.1;"," float waveSpeed = 0.03;","\tvec2 distortedUv = texture2D( tDudv, vec2( vUv.x + time * waveSpeed, vUv.y ) ).rg * waveStrength;","\tdistortedUv = vUv.xy + vec2( distortedUv.x, distortedUv.y + time * waveSpeed );","\tvec2 distortion = ( texture2D( tDudv, distortedUv ).rg * 2.0 - 1.0 ) * waveStrength;"," vec4 uv = vec4( vUvRefraction );"," uv.xy += distortion;","\tvec4 base = texture2DProj( tDiffuse, uv );","\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n"),tl.merge([Ol.fog,Ol.lights,{enableBump:{value:0},enableSpecular:{value:0},tDiffuse:{value:null},tBeckmann:{value:null},diffuse:{value:new h(15658734)},specular:{value:new h(1118481)},opacity:{value:1},uRoughness:{value:.15},uSpecularBrightness:{value:.75},bumpMap:{value:null},bumpScale:{value:1},specularMap:{value:null},offsetRepeat:{value:new g(0,0,1,1)},uWrapRGB:{value:new i(.75,.375,.1875)}}]),["#define USE_BUMPMAP","uniform bool enableBump;","uniform bool enableSpecular;","uniform vec3 diffuse;","uniform vec3 specular;","uniform float opacity;","uniform float uRoughness;","uniform float uSpecularBrightness;","uniform vec3 uWrapRGB;","uniform sampler2D tDiffuse;","uniform sampler2D tBeckmann;","uniform sampler2D specularMap;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",Pl.common,Pl.bsdfs,Pl.packing,Pl.lights_pars_begin,Pl.shadowmap_pars_fragment,Pl.fog_pars_fragment,Pl.bumpmap_pars_fragment,"float fresnelReflectance( vec3 H, vec3 V, float F0 ) {","float base = 1.0 - dot( V, H );","float exponential = pow( base, 5.0 );","return exponential + F0 * ( 1.0 - exponential );","}","float KS_Skin_Specular( vec3 N,","vec3 L,","vec3 V,","float m,","float rho_s",") {","float result = 0.0;","float ndotl = dot( N, L );","if( ndotl > 0.0 ) {","vec3 h = L + V;","vec3 H = normalize( h );","float ndoth = dot( N, H );","float PH = pow( 2.0 * texture2D( tBeckmann, vec2( ndoth, m ) ).x, 10.0 );","float F = fresnelReflectance( H, V, 0.028 );","float frSpec = max( PH * F / dot( h, h ), 0.0 );","result = ndotl * rho_s * frSpec;","}","return result;","}","void main() {","vec3 outgoingLight = vec3( 0.0 );","vec4 diffuseColor = vec4( diffuse, opacity );","vec4 colDiffuse = texture2D( tDiffuse, vUv );","colDiffuse.rgb *= colDiffuse.rgb;","diffuseColor = diffuseColor * colDiffuse;","vec3 normal = normalize( vNormal );","vec3 viewerDirection = normalize( vViewPosition );","float specularStrength;","if ( enableSpecular ) {","vec4 texelSpecular = texture2D( specularMap, vUv );","specularStrength = texelSpecular.r;","} else {","specularStrength = 1.0;","}","#ifdef USE_BUMPMAP","if ( enableBump ) normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );","#endif","vec3 totalSpecularLight = vec3( 0.0 );","vec3 totalDiffuseLight = vec3( 0.0 );","#if NUM_POINT_LIGHTS > 0","for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {","vec3 lVector = pointLights[ i ].position + vViewPosition.xyz;","float attenuation = calcLightAttenuation( length( lVector ), pointLights[ i ].distance, pointLights[ i ].decay );","lVector = normalize( lVector );","float pointDiffuseWeightFull = max( dot( normal, lVector ), 0.0 );","float pointDiffuseWeightHalf = max( 0.5 * dot( normal, lVector ) + 0.5, 0.0 );","vec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), uWrapRGB );","float pointSpecularWeight = KS_Skin_Specular( normal, lVector, viewerDirection, uRoughness, uSpecularBrightness );","totalDiffuseLight += pointLight[ i ].color * ( pointDiffuseWeight * attenuation );","totalSpecularLight += pointLight[ i ].color * specular * ( pointSpecularWeight * specularStrength * attenuation );","}","#endif","#if NUM_DIR_LIGHTS > 0","for( int i = 0; i < NUM_DIR_LIGHTS; i++ ) {","vec3 dirVector = directionalLights[ i ].direction;","float dirDiffuseWeightFull = max( dot( normal, dirVector ), 0.0 );","float dirDiffuseWeightHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );","vec3 dirDiffuseWeight = mix( vec3 ( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), uWrapRGB );","float dirSpecularWeight = KS_Skin_Specular( normal, dirVector, viewerDirection, uRoughness, uSpecularBrightness );","totalDiffuseLight += directionalLights[ i ].color * dirDiffuseWeight;","totalSpecularLight += directionalLights[ i ].color * ( dirSpecularWeight * specularStrength );","}","#endif","#if NUM_HEMI_LIGHTS > 0","for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {","vec3 lVector = hemisphereLightDirection[ i ];","float dotProduct = dot( normal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","totalDiffuseLight += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","float hemiSpecularWeight = 0.0;","hemiSpecularWeight += KS_Skin_Specular( normal, lVector, viewerDirection, uRoughness, uSpecularBrightness );","vec3 lVectorGround = -lVector;","hemiSpecularWeight += KS_Skin_Specular( normal, lVectorGround, viewerDirection, uRoughness, uSpecularBrightness );","vec3 hemiSpecularColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","totalSpecularLight += hemiSpecularColor * specular * ( hemiSpecularWeight * specularStrength );","}","#endif","outgoingLight += diffuseColor.xyz * ( totalDiffuseLight + ambientLightColor * diffuse ) + totalSpecularLight;","gl_FragColor = linearToOutputTexel( vec4( outgoingLight, diffuseColor.a ) );",Pl.fog_fragment,"}"].join("\n"),["uniform vec4 offsetRepeat;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",Pl.common,Pl.lights_pars_begin,Pl.shadowmap_pars_vertex,Pl.fog_pars_vertex,"void main() {","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vViewPosition = -mvPosition.xyz;","vNormal = normalize( normalMatrix * normal );","vUv = uv * offsetRepeat.zw + offsetRepeat.xy;","gl_Position = projectionMatrix * mvPosition;",Pl.shadowmap_vertex,Pl.fog_vertex,"}"].join("\n"),tl.merge([Ol.fog,Ol.lights,{passID:{value:0},tDiffuse:{value:null},tNormal:{value:null},tBlur1:{value:null},tBlur2:{value:null},tBlur3:{value:null},tBlur4:{value:null},tBeckmann:{value:null},uNormalScale:{value:1},diffuse:{value:new h(15658734)},specular:{value:new h(1118481)},opacity:{value:1},uRoughness:{value:.15},uSpecularBrightness:{value:.75}}]),["uniform vec3 diffuse;","uniform vec3 specular;","uniform float opacity;","uniform float uRoughness;","uniform float uSpecularBrightness;","uniform int passID;","uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tBlur1;","uniform sampler2D tBlur2;","uniform sampler2D tBlur3;","uniform sampler2D tBlur4;","uniform sampler2D tBeckmann;","uniform float uNormalScale;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",Pl.common,Pl.lights_pars_begin,Pl.fog_pars_fragment,"float fresnelReflectance( vec3 H, vec3 V, float F0 ) {","float base = 1.0 - dot( V, H );","float exponential = pow( base, 5.0 );","return exponential + F0 * ( 1.0 - exponential );","}","float KS_Skin_Specular( vec3 N,","vec3 L,","vec3 V,","float m,","float rho_s",") {","float result = 0.0;","float ndotl = dot( N, L );","if( ndotl > 0.0 ) {","vec3 h = L + V;","vec3 H = normalize( h );","float ndoth = dot( N, H );","float PH = pow( 2.0 * texture2D( tBeckmann, vec2( ndoth, m ) ).x, 10.0 );","float F = fresnelReflectance( H, V, 0.028 );","float frSpec = max( PH * F / dot( h, h ), 0.0 );","result = ndotl * rho_s * frSpec;","}","return result;","}","void main() {","vec3 outgoingLight = vec3( 0.0 );","vec4 diffuseColor = vec4( diffuse, opacity );","vec4 mSpecular = vec4( specular, opacity );","vec4 colDiffuse = texture2D( tDiffuse, vUv );","colDiffuse *= colDiffuse;","diffuseColor *= colDiffuse;","vec4 posAndU = vec4( -vViewPosition, vUv.x );","vec4 posAndU_dx = dFdx( posAndU ),  posAndU_dy = dFdy( posAndU );","vec3 tangent = posAndU_dx.w * posAndU_dx.xyz + posAndU_dy.w * posAndU_dy.xyz;","vec3 normal = normalize( vNormal );","vec3 binormal = normalize( cross( tangent, normal ) );","tangent = cross( normal, binormal );","mat3 tsb = mat3( tangent, binormal, normal );","vec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;","normalTex.xy *= uNormalScale;","normalTex = normalize( normalTex );","vec3 finalNormal = tsb * normalTex;","normal = normalize( finalNormal );","vec3 viewerDirection = normalize( vViewPosition );","vec3 totalDiffuseLight = vec3( 0.0 );","vec3 totalSpecularLight = vec3( 0.0 );","#if NUM_POINT_LIGHTS > 0","for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {","vec3 pointVector = normalize( pointLights[ i ].direction );","float attenuation = calcLightAttenuation( length( lVector ), pointLights[ i ].distance, pointLights[ i ].decay );","float pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );","totalDiffuseLight += pointLightColor[ i ] * ( pointDiffuseWeight * attenuation );","if ( passID == 1 ) {","float pointSpecularWeight = KS_Skin_Specular( normal, pointVector, viewerDirection, uRoughness, uSpecularBrightness );","totalSpecularLight += pointLightColor[ i ] * mSpecular.xyz * ( pointSpecularWeight * attenuation );","}","}","#endif","#if NUM_DIR_LIGHTS > 0","for( int i = 0; i < NUM_DIR_LIGHTS; i++ ) {","vec3 dirVector = directionalLights[ i ].direction;","float dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );","totalDiffuseLight += directionalLights[ i ].color * dirDiffuseWeight;","if ( passID == 1 ) {","float dirSpecularWeight = KS_Skin_Specular( normal, dirVector, viewerDirection, uRoughness, uSpecularBrightness );","totalSpecularLight += directionalLights[ i ].color * mSpecular.xyz * dirSpecularWeight;","}","}","#endif","outgoingLight += diffuseColor.rgb * ( totalDiffuseLight + totalSpecularLight );","if ( passID == 0 ) {","outgoingLight = sqrt( outgoingLight );","} else if ( passID == 1 ) {","#ifdef VERSION1","vec3 nonblurColor = sqrt(outgoingLight );","#else","vec3 nonblurColor = outgoingLight;","#endif","vec3 blur1Color = texture2D( tBlur1, vUv ).xyz;","vec3 blur2Color = texture2D( tBlur2, vUv ).xyz;","vec3 blur3Color = texture2D( tBlur3, vUv ).xyz;","vec3 blur4Color = texture2D( tBlur4, vUv ).xyz;","outgoingLight = vec3( vec3( 0.22,  0.437, 0.635 ) * nonblurColor + ","vec3( 0.101, 0.355, 0.365 ) * blur1Color + ","vec3( 0.119, 0.208, 0.0 )   * blur2Color + ","vec3( 0.114, 0.0,   0.0 )   * blur3Color + ","vec3( 0.444, 0.0,   0.0 )   * blur4Color );","outgoingLight *= sqrt( colDiffuse.xyz );","outgoingLight += ambientLightColor * diffuse * colDiffuse.xyz + totalSpecularLight;","#ifndef VERSION1","outgoingLight = sqrt( outgoingLight );","#endif","}","gl_FragColor = vec4( outgoingLight, diffuseColor.a );",Pl.fog_fragment,"}"].join("\n"),["#ifdef VERTEX_TEXTURES","uniform sampler2D tDisplacement;","uniform float uDisplacementScale;","uniform float uDisplacementBias;","#endif","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",Pl.common,Pl.fog_pars_vertex,"void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vViewPosition = -mvPosition.xyz;","vNormal = normalize( normalMatrix * normal );","vUv = uv;","#ifdef VERTEX_TEXTURES","vec3 dv = texture2D( tDisplacement, uv ).xyz;","float df = uDisplacementScale * dv.x + uDisplacementBias;","vec4 displacedPosition = vec4( vNormal.xyz * df, 0.0 ) + mvPosition;","gl_Position = projectionMatrix * displacedPosition;","#else","gl_Position = projectionMatrix * mvPosition;","#endif",Pl.fog_vertex,"}"].join("\n"),["varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",Pl.common,"void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vViewPosition = -mvPosition.xyz;","vNormal = normalize( normalMatrix * normal );","vUv = uv;","gl_Position = vec4( uv.x * 2.0 - 1.0, uv.y * 2.0 - 1.0, 0.0, 1.0 );","}"].join("\n"),["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["varying vec2 vUv;","float PHBeckmann( float ndoth, float m ) {","float alpha = acos( ndoth );","float ta = tan( alpha );","float val = 1.0 / ( m * m * pow( ndoth, 4.0 ) ) * exp( -( ta * ta ) / ( m * m ) );","return val;","}","float KSTextureCompute( vec2 tex ) {","return 0.5 * pow( PHBeckmann( tex.x, tex.y ), 0.1 );","}","void main() {","float x = KSTextureCompute( vUv );","gl_FragColor = vec4( x, x, x, 1.0 );","}"].join("\n"),tl.merge([Ol.fog,Ol.lights,{enableDiffuse1:{value:0},enableDiffuse2:{value:0},enableSpecular:{value:0},enableReflection:{value:0},tDiffuse1:{value:null},tDiffuse2:{value:null},tDetail:{value:null},tNormal:{value:null},tSpecular:{value:null},tDisplacement:{value:null},uNormalScale:{value:1},uDisplacementBias:{value:0},uDisplacementScale:{value:1},diffuse:{value:new h(15658734)},specular:{value:new h(1118481)},shininess:{value:30},opacity:{value:1},uRepeatBase:{value:new m(1,1)},uRepeatOverlay:{value:new m(1,1)},uOffset:{value:new m(0,0)}}]),["uniform vec3 diffuse;","uniform vec3 specular;","uniform float shininess;","uniform float opacity;","uniform bool enableDiffuse1;","uniform bool enableDiffuse2;","uniform bool enableSpecular;","uniform sampler2D tDiffuse1;","uniform sampler2D tDiffuse2;","uniform sampler2D tDetail;","uniform sampler2D tNormal;","uniform sampler2D tSpecular;","uniform sampler2D tDisplacement;","uniform float uNormalScale;","uniform vec2 uRepeatOverlay;","uniform vec2 uRepeatBase;","uniform vec2 uOffset;","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",Pl.common,Pl.bsdfs,Pl.lights_pars_begin,Pl.shadowmap_pars_fragment,Pl.fog_pars_fragment,"float calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {","if ( decayExponent > 0.0 ) {","return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );","}","return 1.0;","}","void main() {","vec3 outgoingLight = vec3( 0.0 );","vec4 diffuseColor = vec4( diffuse, opacity );","vec3 specularTex = vec3( 1.0 );","vec2 uvOverlay = uRepeatOverlay * vUv + uOffset;","vec2 uvBase = uRepeatBase * vUv;","vec3 normalTex = texture2D( tDetail, uvOverlay ).xyz * 2.0 - 1.0;","normalTex.xy *= uNormalScale;","normalTex = normalize( normalTex );","if( enableDiffuse1 && enableDiffuse2 ) {","vec4 colDiffuse1 = texture2D( tDiffuse1, uvOverlay );","vec4 colDiffuse2 = texture2D( tDiffuse2, uvOverlay );","colDiffuse1 = GammaToLinear( colDiffuse1, float( GAMMA_FACTOR ) );","colDiffuse2 = GammaToLinear( colDiffuse2, float( GAMMA_FACTOR ) );","diffuseColor *= mix ( colDiffuse1, colDiffuse2, 1.0 - texture2D( tDisplacement, uvBase ) );"," } else if( enableDiffuse1 ) {","diffuseColor *= texture2D( tDiffuse1, uvOverlay );","} else if( enableDiffuse2 ) {","diffuseColor *= texture2D( tDiffuse2, uvOverlay );","}","if( enableSpecular )","specularTex = texture2D( tSpecular, uvOverlay ).xyz;","mat3 tsb = mat3( vTangent, vBinormal, vNormal );","vec3 finalNormal = tsb * normalTex;","vec3 normal = normalize( finalNormal );","vec3 viewPosition = normalize( vViewPosition );","vec3 totalDiffuseLight = vec3( 0.0 );","vec3 totalSpecularLight = vec3( 0.0 );","#if NUM_POINT_LIGHTS > 0","for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {","vec3 lVector = pointLights[ i ].position + vViewPosition.xyz;","float attenuation = calcLightAttenuation( length( lVector ), pointLights[ i ].distance, pointLights[ i ].decay );","lVector = normalize( lVector );","vec3 pointHalfVector = normalize( lVector + viewPosition );","float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","float pointDiffuseWeight = max( dot( normal, lVector ), 0.0 );","float pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, shininess ), 0.0 );","totalDiffuseLight += attenuation * pointLights[ i ].color * pointDiffuseWeight;","totalSpecularLight += attenuation * pointLights[ i ].color * specular * pointSpecularWeight * pointDiffuseWeight;","}","#endif","#if NUM_DIR_LIGHTS > 0","vec3 dirDiffuse = vec3( 0.0 );","vec3 dirSpecular = vec3( 0.0 );","for( int i = 0; i < NUM_DIR_LIGHTS; i++ ) {","vec3 dirVector = directionalLights[ i ].direction;","vec3 dirHalfVector = normalize( dirVector + viewPosition );","float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","float dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );","float dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, shininess ), 0.0 );","totalDiffuseLight += directionalLights[ i ].color * dirDiffuseWeight;","totalSpecularLight += directionalLights[ i ].color * specular * dirSpecularWeight * dirDiffuseWeight;","}","#endif","#if NUM_HEMI_LIGHTS > 0","vec3 hemiDiffuse  = vec3( 0.0 );","vec3 hemiSpecular = vec3( 0.0 );","for( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {","vec3 lVector = hemisphereLightDirection[ i ];","float dotProduct = dot( normal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","totalDiffuseLight += mix( hemisphereLights[ i ].groundColor, hemisphereLights[ i ].skyColor, hemiDiffuseWeight );","float hemiSpecularWeight = 0.0;","vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );","float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;","hemiSpecularWeight += specularTex.r * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );","vec3 lVectorGround = -lVector;","vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );","float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;","hemiSpecularWeight += specularTex.r * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );","totalSpecularLight += specular * mix( hemisphereLights[ i ].groundColor, hemisphereLights[ i ].skyColor, hemiDiffuseWeight ) * hemiSpecularWeight * hemiDiffuseWeight;","}","#endif","outgoingLight += diffuseColor.xyz * ( totalDiffuseLight + ambientLightColor + totalSpecularLight );","gl_FragColor = vec4( outgoingLight, diffuseColor.a );",Pl.fog_fragment,"}"].join("\n"),["attribute vec4 tangent;","uniform vec2 uRepeatBase;","uniform sampler2D tNormal;","#ifdef VERTEX_TEXTURES","uniform sampler2D tDisplacement;","uniform float uDisplacementScale;","uniform float uDisplacementBias;","#endif","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",Pl.shadowmap_pars_vertex,Pl.fog_pars_vertex,"void main() {","vNormal = normalize( normalMatrix * normal );","vTangent = normalize( normalMatrix * tangent.xyz );","vBinormal = cross( vNormal, vTangent ) * tangent.w;","vBinormal = normalize( vBinormal );","vUv = uv;","vec2 uvBase = uv * uRepeatBase;","#ifdef VERTEX_TEXTURES","vec3 dv = texture2D( tDisplacement, uvBase ).xyz;","float df = uDisplacementScale * dv.x + uDisplacementBias;","vec3 displacedPosition = normal * df + position;","vec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );","vec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );","#else","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","#endif","gl_Position = projectionMatrix * mvPosition;","vViewPosition = -mvPosition.xyz;","vec3 normalTex = texture2D( tNormal, uvBase ).xyz * 2.0 - 1.0;","vNormal = normalMatrix * normalTex;",Pl.shadowmap_vertex,Pl.fog_vertex,"}"].join("\n"),new i,new h(15658734),new h(328965),new h(16777215),["varying vec3 vNormal;","varying vec3 vRefract;","void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","vec3 worldNormal = normalize ( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );","vNormal = normalize( normalMatrix * normal );","vec3 I = worldPosition.xyz - cameraPosition;","vRefract = refract( normalize( I ), worldNormal, 1.02 );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),["uniform vec3 uBaseColor;","uniform vec3 uDirLightPos;","uniform vec3 uDirLightColor;","uniform vec3 uAmbientLightColor;","varying vec3 vNormal;","varying vec3 vRefract;","void main() {","float directionalLightWeighting = max( dot( normalize( vNormal ), uDirLightPos ), 0.0);","vec3 lightWeighting = uAmbientLightColor + uDirLightColor * directionalLightWeighting;","float intensity = smoothstep( - 0.5, 1.0, pow( length(lightWeighting), 20.0 ) );","intensity += length(lightWeighting) * 0.2;","float cameraWeighting = dot( normalize( vNormal ), vRefract );","intensity += pow( 1.0 - length( cameraWeighting ), 6.0 );","intensity = intensity * 0.2 + 0.3;","if ( intensity < 0.50 ) {","gl_FragColor = vec4( 2.0 * intensity * uBaseColor, 1.0 );","} else {","gl_FragColor = vec4( 1.0 - 2.0 * ( 1.0 - intensity ) * ( 1.0 - uBaseColor ), 1.0 );","}","}"].join("\n"),new i,new h(15658734),new h(328965),new h(15658734),new h(8421504),new h(0),new h(0),new h(0),["varying vec3 vNormal;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","vNormal = normalize( normalMatrix * normal );","}"].join("\n"),["uniform vec3 uBaseColor;","uniform vec3 uLineColor1;","uniform vec3 uLineColor2;","uniform vec3 uLineColor3;","uniform vec3 uLineColor4;","uniform vec3 uDirLightPos;","uniform vec3 uDirLightColor;","uniform vec3 uAmbientLightColor;","varying vec3 vNormal;","void main() {","float camera = max( dot( normalize( vNormal ), vec3( 0.0, 0.0, 1.0 ) ), 0.4);","float light = max( dot( normalize( vNormal ), uDirLightPos ), 0.0);","gl_FragColor = vec4( uBaseColor, 1.0 );","if ( length(uAmbientLightColor + uDirLightColor * light) < 1.00 ) {","gl_FragColor *= vec4( uLineColor1, 1.0 );","}","if ( length(uAmbientLightColor + uDirLightColor * camera) < 0.50 ) {","gl_FragColor *= vec4( uLineColor2, 1.0 );","}","}"].join("\n"),new i,new h(15658734),new h(328965),new h(16777215),new h(0),new h(0),new h(0),new h(0),["varying vec3 vNormal;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","vNormal = normalize( normalMatrix * normal );","}"].join("\n"),["uniform vec3 uBaseColor;","uniform vec3 uLineColor1;","uniform vec3 uLineColor2;","uniform vec3 uLineColor3;","uniform vec3 uLineColor4;","uniform vec3 uDirLightPos;","uniform vec3 uDirLightColor;","uniform vec3 uAmbientLightColor;","varying vec3 vNormal;","void main() {","float directionalLightWeighting = max( dot( normalize(vNormal), uDirLightPos ), 0.0);","vec3 lightWeighting = uAmbientLightColor + uDirLightColor * directionalLightWeighting;","gl_FragColor = vec4( uBaseColor, 1.0 );","if ( length(lightWeighting) < 1.00 ) {","if ( mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {","gl_FragColor = vec4( uLineColor1, 1.0 );","}","}","if ( length(lightWeighting) < 0.75 ) {","if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {","gl_FragColor = vec4( uLineColor2, 1.0 );","}","}","if ( length(lightWeighting) < 0.50 ) {","if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {","gl_FragColor = vec4( uLineColor3, 1.0 );","}","}","if ( length(lightWeighting) < 0.3465 ) {","if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {","gl_FragColor = vec4( uLineColor4, 1.0 );","}","}","}"].join("\n"),new i,new h(15658734),new h(328965),new h(16777215),new h(0),["varying vec3 vNormal;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","vNormal = normalize( normalMatrix * normal );","}"].join("\n"),["uniform vec3 uBaseColor;","uniform vec3 uLineColor1;","uniform vec3 uLineColor2;","uniform vec3 uLineColor3;","uniform vec3 uLineColor4;","uniform vec3 uDirLightPos;","uniform vec3 uDirLightColor;","uniform vec3 uAmbientLightColor;","varying vec3 vNormal;","void main() {","float directionalLightWeighting = max( dot( normalize(vNormal), uDirLightPos ), 0.0);","vec3 lightWeighting = uAmbientLightColor + uDirLightColor * directionalLightWeighting;","gl_FragColor = vec4( uBaseColor, 1.0 );","if ( length(lightWeighting) < 1.00 ) {","if ( ( mod(gl_FragCoord.x, 4.001) + mod(gl_FragCoord.y, 4.0) ) > 6.00 ) {","gl_FragColor = vec4( uLineColor1, 1.0 );","}","}","if ( length(lightWeighting) < 0.50 ) {","if ( ( mod(gl_FragCoord.x + 2.0, 4.001) + mod(gl_FragCoord.y + 2.0, 4.0) ) > 6.00 ) {","gl_FragColor = vec4( uLineColor1, 1.0 );","}","}","}"].join("\n");var od=function(t){void 0==t&&(t=Math),this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(var e=0;e<256;e++)this.p[e]=Math.floor(256*t.random());this.perm=[];for(e=0;e<512;e++)this.perm[e]=this.p[255&e];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]};od.prototype.dot=function(t,e,n){return t[0]*e+t[1]*n},od.prototype.dot3=function(t,e,n,r){return t[0]*e+t[1]*n+t[2]*r},od.prototype.dot4=function(t,e,n,r,i){return t[0]*e+t[1]*n+t[2]*r+t[3]*i},od.prototype.noise=function(t,e){var n,r,i,o,a,s=(t+e)*(.5*(Math.sqrt(3)-1)),l=Math.floor(t+s),u=Math.floor(e+s),c=(3-Math.sqrt(3))/6,h=(l+u)*c,p=t-(l-h),d=e-(u-h);p>d?(o=1,a=0):(o=0,a=1);var f=p-o+c,m=d-a+c,v=p-1+2*c,g=d-1+2*c,y=255&l,b=255&u,_=this.perm[y+o+this.perm[b+a]]%12,x=this.perm[y+1+this.perm[b+1]]%12,w=.5-p*p-d*d;n=w<0?0:(w*=w)*w*this.dot(this.grad3[this.perm[y+this.perm[b]]%12],p,d);var S=.5-f*f-m*m;r=S<0?0:(S*=S)*S*this.dot(this.grad3[_],f,m);var A=.5-v*v-g*g;return i=A<0?0:(A*=A)*A*this.dot(this.grad3[x],v,g),70*(n+r+i)},od.prototype.noise3d=function(t,e,n){var r,i,o,a,s,l,u,c,h,p,d=(t+e+n)*(1/3),f=Math.floor(t+d),m=Math.floor(e+d),v=Math.floor(n+d),g=(f+m+v)*(1/6),y=t-(f-g),b=e-(m-g),_=n-(v-g);y>=b?b>=_?(s=1,l=0,u=0,c=1,h=1,p=0):y>=_?(s=1,l=0,u=0,c=1,h=0,p=1):(s=0,l=0,u=1,c=1,h=0,p=1):b<_?(s=0,l=0,u=1,c=0,h=1,p=1):y<_?(s=0,l=1,u=0,c=0,h=1,p=1):(s=0,l=1,u=0,c=1,h=1,p=0);var x=y-s+1/6,w=b-l+1/6,S=_-u+1/6,A=y-c+1/6*2,M=b-h+1/6*2,T=_-p+1/6*2,C=y-1+.5,E=b-1+.5,P=_-1+.5,O=255&f,N=255&m,L=255&v,I=this.perm[O+s+this.perm[N+l+this.perm[L+u]]]%12,D=this.perm[O+c+this.perm[N+h+this.perm[L+p]]]%12,F=this.perm[O+1+this.perm[N+1+this.perm[L+1]]]%12,R=.6-y*y-b*b-_*_;r=R<0?0:(R*=R)*R*this.dot3(this.grad3[this.perm[O+this.perm[N+this.perm[L]]]%12],y,b,_);var k=.6-x*x-w*w-S*S;i=k<0?0:(k*=k)*k*this.dot3(this.grad3[I],x,w,S);var U=.6-A*A-M*M-T*T;o=U<0?0:(U*=U)*U*this.dot3(this.grad3[D],A,M,T);var j=.6-C*C-E*E-P*P;return a=j<0?0:(j*=j)*j*this.dot3(this.grad3[F],C,E,P),32*(r+i+o+a)},od.prototype.noise4d=function(t,e,n,r){var i,o,a,s,l,u,c,h,p,d,f,m,v,g,y,b,_,x=this.grad4,w=this.simplex,S=this.perm,A=(Math.sqrt(5)-1)/4,M=(5-Math.sqrt(5))/20,T=(t+e+n+r)*A,C=Math.floor(t+T),E=Math.floor(e+T),P=Math.floor(n+T),O=Math.floor(r+T),N=(C+E+P+O)*M,L=t-(C-N),I=e-(E-N),D=n-(P-N),F=r-(O-N),R=(L>I?32:0)+(L>D?16:0)+(I>D?8:0)+(L>F?4:0)+(I>F?2:0)+(D>F?1:0),k=L-(u=w[R][0]>=3?1:0)+M,U=I-(c=w[R][1]>=3?1:0)+M,j=D-(h=w[R][2]>=3?1:0)+M,B=F-(p=w[R][3]>=3?1:0)+M,z=L-(d=w[R][0]>=2?1:0)+2*M,V=I-(f=w[R][1]>=2?1:0)+2*M,G=D-(m=w[R][2]>=2?1:0)+2*M,H=F-(v=w[R][3]>=2?1:0)+2*M,W=L-(g=w[R][0]>=1?1:0)+3*M,X=I-(y=w[R][1]>=1?1:0)+3*M,Y=D-(b=w[R][2]>=1?1:0)+3*M,q=F-(_=w[R][3]>=1?1:0)+3*M,Z=L-1+4*M,Q=I-1+4*M,J=D-1+4*M,K=F-1+4*M,$=255&C,tt=255&E,et=255&P,nt=255&O,rt=S[$+u+S[tt+c+S[et+h+S[nt+p]]]]%32,it=S[$+d+S[tt+f+S[et+m+S[nt+v]]]]%32,ot=S[$+g+S[tt+y+S[et+b+S[nt+_]]]]%32,at=S[$+1+S[tt+1+S[et+1+S[nt+1]]]]%32,st=.6-L*L-I*I-D*D-F*F;i=st<0?0:(st*=st)*st*this.dot4(x[S[$+S[tt+S[et+S[nt]]]]%32],L,I,D,F);var lt=.6-k*k-U*U-j*j-B*B;o=lt<0?0:(lt*=lt)*lt*this.dot4(x[rt],k,U,j,B);var ut=.6-z*z-V*V-G*G-H*H;a=ut<0?0:(ut*=ut)*ut*this.dot4(x[it],z,V,G,H);var ct=.6-W*W-X*X-Y*Y-q*q;s=ct<0?0:(ct*=ct)*ct*this.dot4(x[ot],W,X,Y,q);var ht=.6-Z*Z-Q*Q-J*J-K*K;return l=ht<0?0:(ht*=ht)*ht*this.dot4(x[at],Z,Q,J,K),27*(i+o+a+s+l)};var ad=function(t,e,n){this._scene=t,this._trackInfo=e,this._onUpdate=n,this._mixer=new gn(t),this._clip=null,this._action=null,this._tracks={},this._propRefs={},this._channelNames=[]};ad.prototype={constructor:ad,init:function(t){for(var e=[],n=this._trackInfo,r=0,i=n.length;r!==i;++r){var o=n[r];e.push(this._addTrack(o.type,o.propertyPath,o.initialValue,o.interpolation))}this._clip=new ot("editclip",0,e),this._action=this._mixer.clipAction(this._clip).play()},setDisplayTime:function(t){this._action.time=t,this._mixer.update(0),this._onUpdate()},setDuration:function(t){this._clip.duration=t},getChannelNames:function(){return this._channelNames},getChannelKeyTimes:function(t){return this._tracks[t].times},setKeyframe:function(t,e){var n=this._tracks[t],r=n.times,i=Timeliner.binarySearch(r,e),o=n.values,a=n.getValueSize(),s=i*a;if(i<0){s=(i=~i)*a;for(var l=o.length+a,u=r.length+1-1;u!==i;--u)r[u]=r[u-1];u=l-1;for(var c=s+a-1;u!==c;--u)o[u]=o[u-a]}r[i]=e,this._propRefs[t].getValue(o,s)},delKeyframe:function(t,e){var n=this._tracks[t],r=n.times,i=Timeliner.binarySearch(r,e);if(r.length>1&&i>=0){for(var o=r.length-1,a=n.values,s=n.getValueSize(),l=a.length-s,u=i;u!==o;++u)r[u]=r[u+1];r.pop();for(var c=i*s;c!==l;++c)a[c]=a[c+s];a.length=l}},moveKeyframe:function(t,e,n,r){var i=this._tracks[t],o=i.times,a=Timeliner.binarySearch(o,e);if(a>=0){for(var s=r?o.length:a+1,l=o[a-1]<=e||!r&&e>=o[a+1];a!==s;)o[a++]+=n;l&&this._sort(i)}},serialize:function(){for(var t={duration:this._clip.duration,channels:{}},e=this._channelNames,n=this._tracks,r=t.channels,i=0,o=e.length;i!==o;++i){var a=e[i],s=n[a];r[a]={times:s.times,values:s.values}}return t},deserialize:function(t){var e=this._channelNames,n=this._tracks,r=t.channels;this.setDuration(t.duration);for(var i=0,o=e.length;i!==o;++i){var a=e[i],s=n[a],l=r[a];this._setArray(s.times,l.times),this._setArray(s.values,l.values)}this.setDisplayTime(this._mixer.time)},_sort:function(t){var e=t.times,n=Js.getKeyframeOrder(e);this._setArray(e,Js.sortedArray(e,1,n));var r=t.values,i=t.getValueSize();this._setArray(r,Js.sortedArray(r,i,n))},_setArray:function(t,e){t.length=0,t.push.apply(t,e)},_addTrack:function(t,e,n,r){var i=new t(e,[0],n,r);return i.times=Array.prototype.slice.call(i.times),i.values=Array.prototype.slice.call(i.values),this._channelNames.push(e),this._tracks[e]=i,this._propRefs[e]=new me(this._scene,e),i}};var sd={};sd.quicksortIP=function(t,e,n){for(var r,i,o=[],a=-1,s=0,l=t.length/e-1,u=0,c=0,h=0,p=function(n,r){for(n*=e,r*=e,h=0;h<e;h++)u=t[n+h],t[n+h]=t[r+h],t[r+h]=u},d=new Float32Array(e),f=new Float32Array(e);;)if(l-s<=25){for(i=s+1;i<=l;i++){for(c=0;c<e;c++)d[c]=t[i*e+c];for(r=i-1;r>=s&&t[r*e+n]>d[n];){for(c=0;c<e;c++)t[(r+1)*e+c]=t[r*e+c];r--}for(c=0;c<e;c++)t[(r+1)*e+c]=d[c]}if(-1==a)break;l=o[a--],s=o[a--]}else{for(i=l,p(s+l>>1,r=s+1),t[s*e+n]>t[l*e+n]&&p(s,l),t[r*e+n]>t[l*e+n]&&p(r,l),t[s*e+n]>t[r*e+n]&&p(s,r),c=0;c<e;c++)f[c]=t[r*e+c];for(;;){do{r++}while(t[r*e+n]<f[n]);do{i--}while(t[i*e+n]>f[n]);if(i<r)break;p(r,i)}for(c=0;c<e;c++)t[(s+1)*e+c]=t[i*e+c],t[i*e+c]=f[c];l-r+1>=i-s?(o[++a]=r,o[++a]=l,l=i-1):(o[++a]=s,o[++a]=i-1,s=r)}return t},sd.Kdtree=function(t,e,n){function r(t,e,s,l){var u,c,h=e%n,p=t.length/n;return e>o&&(o=e),0===p?null:1===p?new i.Node(a(t,0),e,s,l):(sd.quicksortIP(t,n,h),u=Math.floor(p/2),c=new i.Node(a(t,u),e,s,u+l),c.left=r(t.subarray(0,u*n),e+1,c,l),c.right=r(t.subarray((u+1)*n,t.length),e+1,c,l+u+1),c)}var i=this,o=0,a=function(t,e){return t.subarray(e*n,e*n+n)};this.root=r(t,0,null,0),this.getMaxDepth=function(){return o},this.nearest=function(t,r,o){function a(i){function o(t,e){u.push([t,e]),u.size()>r&&u.pop()}var s,l,c,h=i.depth%n,p=e(t,i.obj),d=0,f=[];for(c=0;c<n;c+=1)f[c]=c===i.depth%n?t[c]:i.obj[c];d=e(f,i.obj),null!==i.right||null!==i.left?(a(s=null===i.right?i.left:null===i.left?i.right:t[h]<i.obj[h]?i.left:i.right),(u.size()<r||p<u.peek()[1])&&o(i,p),(u.size()<r||Math.abs(d)<u.peek()[1])&&null!==(l=s===i.left?i.right:i.left)&&a(l)):(u.size()<r||p<u.peek()[1])&&o(i,p)}var s,l,u;if(u=new sd.Kdtree.BinaryHeap(function(t){return-t[1]}),o)for(s=0;s<r;s+=1)u.push([null,o]);for(a(i.root),l=[],s=0;s<r;s+=1)u.content[s][0]&&l.push([u.content[s][0],u.content[s][1]]);return l}},sd.Kdtree.prototype.Node=function(t,e,n,r){this.obj=t,this.left=null,this.right=null,this.parent=n,this.depth=e,this.pos=r},sd.Kdtree.BinaryHeap=function(t){this.content=[],this.scoreFunction=t},sd.Kdtree.BinaryHeap.prototype={push:function(t){this.content.push(t),this.bubbleUp(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.sinkDown(0)),t},peek:function(){return this.content[0]},remove:function(t){for(var e=this.content.length,n=0;n<e;n++)if(this.content[n]==t){var r=this.content.pop();return void(n!=e-1&&(this.content[n]=r,this.scoreFunction(r)<this.scoreFunction(t)?this.bubbleUp(n):this.sinkDown(n)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(t){for(var e=this.content[t];t>0;){var n=Math.floor((t+1)/2)-1,r=this.content[n];if(!(this.scoreFunction(e)<this.scoreFunction(r)))break;this.content[n]=e,this.content[t]=r,t=n}},sinkDown:function(t){for(var e=this.content.length,n=this.content[t],r=this.scoreFunction(n);;){var i=2*(t+1),o=i-1,a=null;if(o<e){var s=this.scoreFunction(this.content[o]);s<r&&(a=o)}if(i<e){this.scoreFunction(this.content[i])<(null===a?r:s)&&(a=i)}if(null===a)break;this.content[t]=this.content[a],this.content[a]=n,t=a}}};var ld={merge:function(t,e,n){console.warn("GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var r;e instanceof B&&(e.matrixAutoUpdate&&e.updateMatrix(),r=e.matrix,e=e.geometry),t.merge(e,r,n)},randomPointInTriangle:function(){var t=new i;return function(e,n,r){var o=new i,a=Math.random(),s=Math.random();a+s>1&&(a=1-a,s=1-s);var l=1-a-s;return o.copy(e),o.multiplyScalar(a),t.copy(n),t.multiplyScalar(s),o.add(t),t.copy(r),t.multiplyScalar(l),o.add(t),o}}(),randomPointInFace:function(t,e){var n,r,i;return n=e.vertices[t.a],r=e.vertices[t.b],i=e.vertices[t.c],ld.randomPointInTriangle(n,r,i)},randomPointsInGeometry:function(t,e){function n(t){function e(n,r){if(r<n)return n;var i=n+Math.floor((r-n)/2);return u[i]>t?e(n,i-1):u[i]<t?e(i+1,r):i}return e(0,u.length-1)}var r,i,o=t.faces,a=t.vertices,s=o.length,l=0,u=[];for(i=0;i<s;i++)(r=o[i])._area=ld.triangleArea(a[r.a],a[r.b],a[r.c]),u[i]=l+=r._area;var c,h=[];for(i=0;i<e;i++)c=n(Math.random()*l),h[i]=ld.randomPointInFace(o[c],t);return h},randomPointsInBufferGeometry:function(t,e){function n(t){function e(n,r){if(r<n)return n;var i=n+Math.floor((r-n)/2);return c[i]>t?e(n,i-1):c[i]<t?e(i+1,r):i}return e(0,c.length-1)}var r,o,a,s,l=t.attributes.position.array,u=0,c=[];o=new i,a=new i,s=new i;var h=l.length/9;for(r=0;r<h;r++)o.set(l[9*r+0],l[9*r+1],l[9*r+2]),a.set(l[9*r+3],l[9*r+4],l[9*r+5]),s.set(l[9*r+6],l[9*r+7],l[9*r+8]),u+=ld.triangleArea(o,a,s),c.push(u);var p,d=[];for(r=0;r<e;r++)p=n(Math.random()*u),o.set(l[9*p+0],l[9*p+1],l[9*p+2]),a.set(l[9*p+3],l[9*p+4],l[9*p+5]),s.set(l[9*p+6],l[9*p+7],l[9*p+8]),d[r]=ld.randomPointInTriangle(o,a,s);return d},triangleArea:function(){var t=new i,e=new i;return function(n,r,i){return t.subVectors(r,n),e.subVectors(i,n),t.cross(e),.5*t.length()}}(),center:function(t){return console.warn("GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},ud=function(t){var e,n=this,r=void 0!==t.name&&""!==t.name,i=10,o=10,a=256,s=256,l=new ct(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,1,10);l.position.set(0,0,2);var u=new ut,c=Ap,h=new tl.clone(c.uniforms),p=new dt({uniforms:h,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader}),d=new B(new mt(a,s),p);u.add(d);var f,m;if(r){var v=(f=document.createElement("canvas")).getContext("2d");v.font="Bold 20px Arial";var g=v.measureText(t.name).width;f.width=g,f.height=25,v.font="Bold 20px Arial",v.fillStyle="rgba( 255, 0, 0, 1 )",v.fillText(t.name,0,20);var y=new ht(f);y.magFilter=ja,y.minFilter=ja,y.needsUpdate=!0;var b=new D({map:y,side:ko});b.transparent=!0;var _=new mt(f.width,f.height);m=new B(_,b),u.add(m)}this.enabled=!0,this.size={width:a,height:s,set:function(t,e){this.width=t,this.height=e,d.scale.set(this.width/a,this.height/s,1),n.position.set(n.position.x,n.position.y)}},this.position={x:i,y:o,set:function(t,e){this.x=t,this.y=e;var i=n.size.width,o=n.size.height;d.position.set(-window.innerWidth/2+i/2+this.x,window.innerHeight/2-o/2-this.y,0),r&&m.position.set(d.position.x,d.position.y-n.size.height/2+f.height/2,0)}},this.render=function(n){this.enabled&&(h.tDiffuse.value=t.shadow.map.texture,e=n.autoClear,n.autoClear=!1,n.clearDepth(),n.render(u,l),n.autoClear=e)},this.updateForWindowResize=function(){this.enabled&&(l.left=window.innerWidth/-2,l.right=window.innerWidth/2,l.top=window.innerHeight/2,l.bottom=window.innerHeight/-2,l.updateProjectionMatrix(),this.update())},this.update=function(){this.position.set(this.position.x,this.position.y),this.size.set(this.size.width,this.size.height)},this.update()};ud.prototype.constructor=ud;var cd=function(t,e,n){var r=this;this.volume=t,e=e||0,Object.defineProperty(this,"index",{get:function(){return e},set:function(t){return e=t,r.geometryNeedsUpdate=!0,e}}),this.axis=n||"z",this.canvas=document.createElement("canvas"),this.canvasBuffer=document.createElement("canvas"),this.updateGeometry();var i=new ht(this.canvas);i.minFilter=ja,i.wrapS=i.wrapT=Da;var o=new D({map:i,side:ko,transparent:!0});this.mesh=new B(this.geometry,o),this.geometryNeedsUpdate=!0,this.repaint()};cd.prototype={constructor:cd,repaint:function(){this.geometryNeedsUpdate&&this.updateGeometry();var t=this.iLength,e=this.jLength,n=this.sliceAccess,r=this.volume,i=this.canvasBuffer,o=this.ctxBuffer,a=o.getImageData(0,0,t,e),s=a.data,l=r.data,u=r.upperThreshold,c=r.lowerThreshold,h=r.windowLow,p=r.windowHigh,d=0;if("label"===r.dataType)for(var f=0;f<e;f++)for(var m=0;m<t;m++){var v=l[n(m,f)],g=this.colorMap[v=v>=this.colorMap.length?v%this.colorMap.length+1:v];s[4*d]=g>>24&255,s[4*d+1]=g>>16&255,s[4*d+2]=g>>8&255,s[4*d+3]=255&g,d++}else for(f=0;f<e;f++)for(m=0;m<t;m++){var y=l[n(m,f)],b=255;b=u>=y&&c<=y?b:0,y=Math.floor(255*(y-h)/(p-h)),s[4*d]=y=y>255?255:y<0?0:0|y,s[4*d+1]=y,s[4*d+2]=y,s[4*d+3]=b,d++}o.putImageData(a,0,0),this.ctx.drawImage(i,0,0,t,e,0,0,this.canvas.width,this.canvas.height),this.mesh.material.map.needsUpdate=!0},updateGeometry:function(){var t=this.volume.extractPerpendicularPlane(this.axis,this.index);this.sliceAccess=t.sliceAccess,this.jLength=t.jLength,this.iLength=t.iLength,this.matrix=t.matrix,this.canvas.width=t.planeWidth,this.canvas.height=t.planeHeight,this.canvasBuffer.width=this.iLength,this.canvasBuffer.height=this.jLength,this.ctx=this.canvas.getContext("2d"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.geometry=new ft(t.planeWidth,t.planeHeight),this.mesh&&(this.mesh.geometry=this.geometry,this.mesh.matrix=(new r).identity(),this.mesh.applyMatrix(this.matrix)),this.geometryNeedsUpdate=!1}};var hd=function(){c.call(this);var t,e=this,n=[0,0],r=!1,o=new i;this.matrixAutoUpdate=!1,this.getGamepad=function(){return t},this.getTouchpadState=function(){return r},this.update=function(){if(void 0!==(t=function(){for(var t=navigator.getGamepads&&navigator.getGamepads(),e=0;e<4;e++){var n=t[e];if(n&&"Daydream Controller"===n.id)return n}}())&&void 0!==t.pose){var i=t.pose;if(null===i)return;null!==i.orientation&&e.quaternion.fromArray(i.orientation),e.updateMatrix(),e.visible=!0,null===i.angularVelocity||o.equals(i.angularVelocity)||(o.fromArray(i.angularVelocity),e.dispatchEvent({type:"angularvelocitychanged",angularVelocity:o})),n[0]===t.axes[0]&&n[1]===t.axes[1]||(n[0]=t.axes[0],n[1]=t.axes[1],e.dispatchEvent({type:"axischanged",axes:n})),r!==t.buttons[0].pressed&&e.dispatchEvent({type:(r=t.buttons[0].pressed)?"touchpaddown":"touchpadup"})}else e.visible=!1},this.getTouchPadState=function(){return console.warn("DaydreamController: getTouchPadState() is now getTouchpadState()"),r}};(hd.prototype=Object.create(c.prototype)).constructor=hd;var pd=function(){c.call(this);var t,e=this,n=[0,0],r=!1,o=!1,a=new i;this.matrixAutoUpdate=!0,this.getGamepad=function(){return t},this.getTouchpadState=function(){return r},this.update=function(){if(void 0!==(t=function(){for(var t=navigator.getGamepads&&navigator.getGamepads(),e=0;e<4;e++){var n=t[e];if(n&&"Gear VR Controller"===n.id)return n}}())&&void 0!==t.pose){var i=t.pose;if(null===i)return;null!==i.orientation&&e.quaternion.fromArray(i.orientation),e.updateMatrix(),e.visible=!0,null===i.angularVelocity||a.equals(i.angularVelocity)||(a.fromArray(i.angularVelocity),e.dispatchEvent({type:"angularvelocitychanged",angularVelocity:a})),n[0]===t.axes[0]&&n[1]===t.axes[1]||(n[0]=t.axes[0],n[1]=t.axes[1],e.dispatchEvent({type:"axischanged",axes:n})),r!==t.buttons[0].pressed&&e.dispatchEvent({type:(r=t.buttons[0].pressed)?"touchpaddown":"touchpadup",axes:n}),o!==t.buttons[1].pressed&&e.dispatchEvent({type:(o=t.buttons[1].pressed)?"triggerdown":"triggerup"})}else e.visible=!1},this.getTouchPadState=function(){return console.warn("GearVRController: getTouchPadState() is now getTouchpadState()"),r},this.setHand=function(){console.warn("GearVRController: setHand() has been removed.")}};(pd.prototype=Object.create(c.prototype)).constructor=pd;var dd=function(t){c.call(this);var e,n=this,i=[0,0],o=!1,a=!1,s=!1,l=!1;this.matrixAutoUpdate=!1,this.standingMatrix=new r,this.getGamepad=function(){return e},this.getButtonState=function(t){return"thumbpad"===t?o:"trigger"===t?a:"grips"===t?s:"menu"===t?l:void 0},this.update=function(){if(void 0!==(e=function(t){for(var e=navigator.getGamepads&&navigator.getGamepads(),n=0,r=0;n<e.length;n++){var i=e[n];if(i&&("OpenVR Gamepad"===i.id||i.id.startsWith("Oculus Touch")||i.id.startsWith("Spatial Controller"))){if(r===t)return i;r++}}}(t))&&void 0!==e.pose){if(null===e.pose)return;var r=e.pose;null!==r.position&&n.position.fromArray(r.position),null!==r.orientation&&n.quaternion.fromArray(r.orientation),n.matrix.compose(n.position,n.quaternion,n.scale),n.matrix.premultiply(n.standingMatrix),n.matrixWorldNeedsUpdate=!0,n.visible=!0,i[0]===e.axes[0]&&i[1]===e.axes[1]||(i[0]=e.axes[0],i[1]=e.axes[1],n.dispatchEvent({type:"axischanged",axes:i})),o!==e.buttons[0].pressed&&n.dispatchEvent({type:(o=e.buttons[0].pressed)?"thumbpaddown":"thumbpadup",axes:i}),a!==e.buttons[1].pressed&&n.dispatchEvent({type:(a=e.buttons[1].pressed)?"triggerdown":"triggerup"}),s!==e.buttons[2].pressed&&n.dispatchEvent({type:(s=e.buttons[2].pressed)?"gripsdown":"gripsup"}),l!==e.buttons[3].pressed&&n.dispatchEvent({type:(l=e.buttons[3].pressed)?"menudown":"menuup"})}else n.visible=!1}};(dd.prototype=Object.create(c.prototype)).constructor=dd,(kr.prototype=Object.create(v.prototype)).constructor=kr,(Ur.prototype=Object.create(O.prototype)).constructor=Ur,(jr.prototype=Object.create(v.prototype)).constructor=jr,(Br.prototype=Object.create(Bt.prototype)).constructor=Br,(zr.prototype=Object.create(Jt.prototype)).constructor=zr,zr.prototype.isEllipseCurve=!0,zr.prototype.getPoint=function(t,e){for(var n=e||new m,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);var a=this.aStartAngle+t*i,s=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var u=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=s-this.aX,p=l-this.aY;s=h*u-p*c+this.aX,l=h*c+p*u+this.aY}return n.set(s,l)},zr.prototype.copy=function(t){return Jt.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},zr.prototype.toJSON=function(){var t=Jt.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},zr.prototype.fromJSON=function(t){return Jt.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},(Vr.prototype=Object.create(zr.prototype)).constructor=Vr,Vr.prototype.isArcCurve=!0;var fd=new i,md=new Gr,vd=new Gr,gd=new Gr;(Hr.prototype=Object.create(Jt.prototype)).constructor=Hr,Hr.prototype.isCatmullRomCurve3=!0,Hr.prototype.getPoint=function(t,e){var n=e||new i,r=this.points,o=r.length,a=(o-(this.closed?0:1))*t,s=Math.floor(a),l=a-s;this.closed?s+=s>0?0:(Math.floor(Math.abs(s)/r.length)+1)*r.length:0===l&&s===o-1&&(s=o-2,l=1);var u,c,h,p;if(this.closed||s>0?u=r[(s-1)%o]:(fd.subVectors(r[0],r[1]).add(r[0]),u=fd),c=r[s%o],h=r[(s+1)%o],this.closed||s+2<o?p=r[(s+2)%o]:(fd.subVectors(r[o-1],r[o-2]).add(r[o-1]),p=fd),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,f=Math.pow(u.distanceToSquared(c),d),m=Math.pow(c.distanceToSquared(h),d),v=Math.pow(h.distanceToSquared(p),d);m<1e-4&&(m=1),f<1e-4&&(f=m),v<1e-4&&(v=m),md.initNonuniformCatmullRom(u.x,c.x,h.x,p.x,f,m,v),vd.initNonuniformCatmullRom(u.y,c.y,h.y,p.y,f,m,v),gd.initNonuniformCatmullRom(u.z,c.z,h.z,p.z,f,m,v)}else"catmullrom"===this.curveType&&(md.initCatmullRom(u.x,c.x,h.x,p.x,this.tension),vd.initCatmullRom(u.y,c.y,h.y,p.y,this.tension),gd.initCatmullRom(u.z,c.z,h.z,p.z,this.tension));return n.set(md.calc(l),vd.calc(l),gd.calc(l)),n},Hr.prototype.copy=function(t){Jt.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){this.points.push(t.points[e].clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Hr.prototype.toJSON=function(){var t=Jt.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){t.points.push(this.points[e].toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Hr.prototype.fromJSON=function(t){Jt.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new i).fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},(qr.prototype=Object.create(Jt.prototype)).constructor=qr,qr.prototype.isCubicBezierCurve=!0,qr.prototype.getPoint=function(t,e){var n=e||new m,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(Yr(t,r.x,i.x,o.x,a.x),Yr(t,r.y,i.y,o.y,a.y)),n},qr.prototype.copy=function(t){return Jt.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},qr.prototype.toJSON=function(){var t=Jt.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},qr.prototype.fromJSON=function(t){return Jt.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},(Zr.prototype=Object.create(Jt.prototype)).constructor=Zr,Zr.prototype.isCubicBezierCurve3=!0,Zr.prototype.getPoint=function(t,e){var n=e||new i,r=this.v0,o=this.v1,a=this.v2,s=this.v3;return n.set(Yr(t,r.x,o.x,a.x,s.x),Yr(t,r.y,o.y,a.y,s.y),Yr(t,r.z,o.z,a.z,s.z)),n},Zr.prototype.copy=function(t){return Jt.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Zr.prototype.toJSON=function(){var t=Jt.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Zr.prototype.fromJSON=function(t){return Jt.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},(Qr.prototype=Object.create(Jt.prototype)).constructor=Qr,Qr.prototype.isLineCurve=!0,Qr.prototype.getPoint=function(t,e){var n=e||new m;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},Qr.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Qr.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},Qr.prototype.copy=function(t){return Jt.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Qr.prototype.toJSON=function(){var t=Jt.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Qr.prototype.fromJSON=function(t){return Jt.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(Jr.prototype=Object.create(Jt.prototype)).constructor=Jr,Jr.prototype.isLineCurve3=!0,Jr.prototype.getPoint=function(t,e){var n=e||new i;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},Jr.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Jr.prototype.copy=function(t){return Jt.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Jr.prototype.toJSON=function(){var t=Jt.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Jr.prototype.fromJSON=function(t){return Jt.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(Kr.prototype=Object.create(Jt.prototype)).constructor=Kr,Kr.prototype.isQuadraticBezierCurve=!0,Kr.prototype.getPoint=function(t,e){var n=e||new m,r=this.v0,i=this.v1,o=this.v2;return n.set(Xr(t,r.x,i.x,o.x),Xr(t,r.y,i.y,o.y)),n},Kr.prototype.copy=function(t){return Jt.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Kr.prototype.toJSON=function(){var t=Jt.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Kr.prototype.fromJSON=function(t){return Jt.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},($r.prototype=Object.create(Jt.prototype)).constructor=$r,$r.prototype.isQuadraticBezierCurve3=!0,$r.prototype.getPoint=function(t,e){var n=e||new i,r=this.v0,o=this.v1,a=this.v2;return n.set(Xr(t,r.x,o.x,a.x),Xr(t,r.y,o.y,a.y),Xr(t,r.z,o.z,a.z)),n},$r.prototype.copy=function(t){return Jt.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},$r.prototype.toJSON=function(){var t=Jt.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},$r.prototype.fromJSON=function(t){return Jt.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(ti.prototype=Object.create(Jt.prototype)).constructor=ti,ti.prototype.isSplineCurve=!0,ti.prototype.getPoint=function(t,e){var n=e||new m,r=this.points,i=(r.length-1)*t,o=Math.floor(i),a=i-o,s=r[0===o?o:o-1],l=r[o],u=r[o>r.length-2?r.length-1:o+1],c=r[o>r.length-3?r.length-1:o+2];return n.set(Wr(a,s.x,l.x,u.x,c.x),Wr(a,s.y,l.y,u.y,c.y)),n},ti.prototype.copy=function(t){Jt.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){this.points.push(t.points[e].clone())}return this},ti.prototype.toJSON=function(){var t=Jt.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){t.points.push(this.points[e].toArray())}return t},ti.prototype.fromJSON=function(t){Jt.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new m).fromArray(r))}return this};var yd={ArcCurve:Vr,CatmullRomCurve3:Hr,CubicBezierCurve:qr,CubicBezierCurve3:Zr,EllipseCurve:zr,LineCurve:Qr,LineCurve3:Jr,QuadraticBezierCurve:Kr,QuadraticBezierCurve3:$r,SplineCurve:ti};ei.prototype=Object.assign(Object.create(Jt.prototype),{constructor:ei,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new yd.LineCurve(e,t))},getPoint:function(t){for(var e=t*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=e){var i=n[r]-e,o=this.curves[r],a=o.getLength();return o.getPointAt(0===a?0:1-i/a)}r++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,n=[],r=0,i=this.curves;r<i.length;r++)for(var o=i[r],a=o.getPoints(o&&o.isEllipseCurve?2*t:o&&o.isLineCurve?1:o&&o.isSplineCurve?t*o.points.length:t),s=0;s<a.length;s++){var l=a[s];e&&e.equals(l)||(n.push(l),e=l)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(t){Jt.prototype.copy.call(this,t),this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){this.curves.push(t.curves[e].clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=Jt.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,n=this.curves.length;e<n;e++){t.curves.push(this.curves[e].toJSON())}return t},fromJSON:function(t){Jt.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push((new yd[r.type]).fromJSON(r))}return this}}),ni.prototype=Object.assign(Object.create(ei.prototype),{constructor:ni,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var n=new Qr(this.currentPoint.clone(),new m(t,e));this.curves.push(n),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,n,r){var i=new Kr(this.currentPoint.clone(),new m(t,e),new m(n,r));this.curves.push(i),this.currentPoint.set(n,r)},bezierCurveTo:function(t,e,n,r,i,o){var a=new qr(this.currentPoint.clone(),new m(t,e),new m(n,r),new m(i,o));this.curves.push(a),this.currentPoint.set(i,o)},splineThru:function(t){var e=new ti([this.currentPoint.clone()].concat(t));this.curves.push(e),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,n,r,i,o){this.absarc(t+this.currentPoint.x,e+this.currentPoint.y,n,r,i,o)},absarc:function(t,e,n,r,i,o){this.absellipse(t,e,n,n,r,i,o)},ellipse:function(t,e,n,r,i,o,a,s){this.absellipse(t+this.currentPoint.x,e+this.currentPoint.y,n,r,i,o,a,s)},absellipse:function(t,e,n,r,i,o,a,s){var l=new zr(t,e,n,r,i,o,a,s);if(this.curves.length>0){var u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);var c=l.getPoint(1);this.currentPoint.copy(c)},copy:function(t){return ei.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=ei.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return ei.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),ri.prototype=Object.assign(Object.create(ni.prototype),{constructor:ri,getPointsHoles:function(t){for(var e=[],n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){ni.prototype.copy.call(this,t),this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){this.holes.push(t.holes[e].clone())}return this},toJSON:function(){var t=ni.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,n=this.holes.length;e<n;e++){t.holes.push(this.holes[e].toJSON())}return t},fromJSON:function(t){ni.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push((new ni).fromJSON(r))}return this}});var bd=function(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,o=ii(t,0,i,n,!0),a=[];if(!o)return a;var s,l,u,c,h,p,d;if(r&&(o=si(t,e,o,n)),t.length>80*n){s=u=t[0],l=c=t[1];for(var f=n;f<i;f+=n)p=t[f+1],(h=t[f])<s&&(s=h),p<l&&(l=p),h>u&&(u=h),p>c&&(c=p);d=0!==(d=Math.max(u-s,c-l))?1/d:0}return ai(o,a,n,s,l,d),a},_d={area:function(t){for(var e=t.length,n=0,r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n},isClockWise:function(t){return _d.area(t)<0},triangulateShape:function(t,e){var n=[],r=[],i=[];bi(t),_i(n,t);var o=t.length;e.forEach(bi);for(var a=0;a<e.length;a++)r.push(o),o+=e[a].length,_i(n,e[a]);var s=bd(n,r);for(a=0;a<s.length;a+=3)i.push(s.slice(a,a+3));return i}};(xi.prototype=Object.create(v.prototype)).constructor=xi,xi.prototype.toJSON=function(){var t=v.prototype.toJSON.call(this);return Si(this.parameters.shapes,t)},(wi.prototype=Object.create(O.prototype)).constructor=wi,wi.prototype.toJSON=function(){var t=O.prototype.toJSON.call(this);return Si(this.parameters.shapes,t)};var xd=function(t){function e(t,e){var n=Math.atan(.25),r=1.5*e,i=Math.tan(n)*r*2;t.vertices[0].set(0,-.75,0),t.vertices[1].set(0+i/2,-.75+r,0),t.vertices[2].set(0-i/2,-.75+r,0),t.verticesNeedUpdate=!0}dd.call(this,t);var n=2*Math.PI,r={COLOR:0,SIZE:1},i=r.COLOR,o=new h(1,1,1),a=1,s=new B(l=new kr(1,32),f=new D({map:function(){var t=document.createElement("canvas");t.width=256,t.height=256;for(var e=t.getContext("2d"),r=e.getImageData(0,0,256,256),i=r.data,o=new h,a=0,s=0;a<i.length;a+=4,s++){var l=s%256/256-.5,u=Math.floor(s/256)/256-.5;o.setHSL(Math.atan2(u,l)/n,1,2*(.5-Math.sqrt(l*l+u*u))),i[a+0]=256*o.r,i[a+1]=256*o.g,i[a+2]=256*o.b,i[a+3]=256}return e.putImageData(r,0,0),new wn(t)}()}));s.position.set(0,.005,.0495),s.rotation.x=-1.45,s.scale.setScalar(.02),this.add(s);var l=new jr(.1,2);(f=new D).color=o;var u=new B(l,f);s.add(u);var c=new Me;c.position.set(0,.005,.0495),c.rotation.x=-1.45,c.scale.setScalar(.02),this.add(c);var p=new ri;p.moveTo(0,-1),p.lineTo(1,1),p.lineTo(-1,1);var d=new B(l=new xi(p),f=new D({color:2236962,wireframe:!0}));d.position.z=.001,e(d.geometry,1),c.add(d);var f;l=new xi(p);(f=new D({side:ko})).color=o;var m=new B(l,f);m.position.z=.0011,e(m.geometry,.5),c.add(m),c.visible=!1,this.getColor=function(){return o},this.getSize=function(){return a},this.addEventListener("axischanged",function(t){if(!1!==this.getButtonState("thumbpad")){var s=t.axes[0]/2,l=-t.axes[1]/2;if(i===r.COLOR&&(o.setHSL(Math.atan2(l,s)/n,1,2*(.5-Math.sqrt(s*s+l*l))),u.position.set(t.axes[0],t.axes[1],0)),i===r.SIZE){var c=.5-l;a=2*c,e(m.geometry,c)}}}),this.addEventListener("gripsdown",function(t){return i===r.COLOR?(i=r.SIZE,s.visible=!1,void(c.visible=!0)):i===r.SIZE?(i=r.COLOR,s.visible=!0,void(c.visible=!1)):void 0})};(xd.prototype=Object.create(dd.prototype)).constructor=xd;Object.assign(function(){var t=arguments;this.uuid=xo.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var n=0,r=arguments.length;n!==r;++n)e[t[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=arguments,e=this._objects,n=e.length,r=this.nCachedObjects_,i=this._indicesByUUID,o=this._paths,a=this._parsedPaths,s=this._bindings,l=s.length,u=void 0,c=0,h=arguments.length;c!==h;++c){var p=t[c],d=p.uuid,f=i[d];if(void 0===f){f=n++,i[d]=f,e.push(p);for(var m=0,v=l;m!==v;++m)s[m].push(new me(p,o[m],a[m]))}else if(f<r){u=e[f];var g=--r,y=e[g];i[y.uuid]=f,e[f]=y,i[d]=g,e[g]=p;for(m=0,v=l;m!==v;++m){var b=s[m],_=b[f];b[f]=b[g],void 0===_&&(_=new me(p,o[m],a[m])),b[g]=_}}else e[f]!==u&&console.error("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=r},remove:function(){for(var t=arguments,e=this._objects,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var l=t[a],u=l.uuid,c=r[u];if(void 0!==c&&c>=n){var h=n++,p=e[h];r[p.uuid]=c,e[c]=p,r[u]=h,e[h]=l;for(var d=0,f=o;d!==f;++d){var m=i[d],v=m[c];m[c]=m[h],m[h]=v}}}this.nCachedObjects_=n},uncache:function(){for(var t=arguments,e=this._objects,n=e.length,r=this.nCachedObjects_,i=this._indicesByUUID,o=this._bindings,a=o.length,s=0,l=arguments.length;s!==l;++s){var u=t[s].uuid,c=i[u];if(void 0!==c)if(delete i[u],c<r){var h=--r,p=e[h],d=e[g=--n];i[p.uuid]=c,e[c]=p,i[d.uuid]=h,e[h]=d,e.pop();for(var f=0,m=a;f!==m;++f){var v=(y=o[f])[g];y[c]=y[h],y[h]=v,y.pop()}}else{var g;i[(d=e[g=--n]).uuid]=c,e[c]=d,e.pop();for(f=0,m=a;f!==m;++f){var y;(y=o[f])[c]=y[g],y.pop()}}}this.nCachedObjects_=r},subscribe_:function(t,e){var n=this._bindingsIndicesByPath,r=n[t],i=this._bindings;if(void 0!==r)return i[r];var o=this._paths,a=this._parsedPaths,s=this._objects,l=s.length,u=this.nCachedObjects_,c=new Array(l);n[t]=r=i.length,o.push(t),a.push(e),i.push(c);for(var h=u,p=s.length;h!==p;++h){c[h]=new me(s[h],t,e)}return c},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){var r=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];e[t[a]]=n,o[n]=s,o.pop(),i[n]=i[a],i.pop(),r[n]=r[a],r.pop()}}}),Object.assign(function(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),n=0;n<e.length;n++)t+=e[n];return t/e.length}}),Ai.prototype=Object.assign(Object.create(dn.prototype),{constructor:Ai,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){this.panner.refDistance=t},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){this.panner.rolloffFactor=t},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){this.panner.distanceModel=t},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){this.panner.maxDistance=t},updateMatrixWorld:function(){var t=new i;return function(e){c.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}()}),(Mi.prototype=Object.create(c.prototype)).constructor=Mi,Ti.prototype=Object.assign(Object.create(y.prototype),{constructor:Ti,isInstancedBufferAttribute:!0,copy:function(t){return y.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(Ci.prototype,{moveTo:function(t,e){this.currentPath=new ni,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,n,r){this.currentPath.quadraticCurveTo(t,e,n,r)},bezierCurveTo:function(t,e,n,r,i,o){this.currentPath.bezierCurveTo(t,e,n,r,i,o)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(t,e){function n(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n],o=new ri;o.curves=i.curves,e.push(o)}return e}function r(t,e){for(var n=e.length,r=!1,i=n-1,o=0;o<n;i=o++){var a=e[i],s=e[o],l=s.x-a.x,u=s.y-a.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(a=e[o],l=-l,s=e[i],u=-u),t.y<a.y||t.y>s.y)continue;if(t.y===a.y){if(t.x===a.x)return!0}else{var c=u*(t.x-a.x)-l*(t.y-a.y);if(0===c)return!0;if(c<0)continue;r=!r}}else{if(t.y!==a.y)continue;if(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x)return!0}}return r}var i=_d.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===e)return n(o);var a,s,l,u=[];if(1===o.length)return s=o[0],l=new ri,l.curves=s.curves,u.push(l),u;var c=!i(o[0].getPoints());c=t?!c:c;var h,p=[],d=[],f=[],m=0;d[m]=void 0,f[m]=[];for(var v=0,g=o.length;v<g;v++)a=i(h=(s=o[v]).getPoints()),(a=t?!a:a)?(!c&&d[m]&&m++,d[m]={s:new ri,p:h},d[m].s.curves=s.curves,c&&m++,f[m]=[]):f[m].push({h:s,p:h[0]});if(!d[0])return n(o);if(d.length>1){for(var y=!1,b=[],_=0,x=d.length;_<x;_++)p[_]=[];for(_=0,x=d.length;_<x;_++)for(var w=f[_],S=0;S<w.length;S++){for(var A=w[S],M=!0,T=0;T<d.length;T++)r(A.p,d[T].p)&&(_!==T&&b.push({froms:_,tos:T,hole:S}),M?(M=!1,p[T].push(A)):y=!0);M&&p[_].push(A)}b.length>0&&(y||(f=p))}v=0;for(var C,E=d.length;v<E;v++){u.push(l=d[v].s);for(var P=0,O=(C=f[v]).length;P<O;P++)l.holes.push(C[P].h)}return u}}),Object.assign(Ei.prototype,{isFont:!0,generateShapes:function(t,e,n){void 0===e&&(e=100),void 0===n&&(n=4);for(var r=[],i=Pi(t,e,0,this.data),o=0,a=i.length;o<a;o++)Array.prototype.push.apply(r,i[o].toShapes());return r}}),(Oi.prototype=Object.create(W.prototype)).constructor=Oi,(Ni.prototype=Object.create(X.prototype)).constructor=Ni,(Li.prototype=Object.create(v.prototype)).constructor=Li,(Ii.prototype=Object.create(Bt.prototype)).constructor=Ii,(Di.prototype=Object.create(O.prototype)).constructor=Di,(Fi.prototype=Object.create(v.prototype)).constructor=Fi,(Ri.prototype=Object.create(O.prototype)).constructor=Ri,Ri.prototype.getArrays=function(){var t=this.getAttribute("position"),e=t?Array.prototype.slice.call(t.array):[],n=this.getAttribute("uv"),r=n?Array.prototype.slice.call(n.array):[],i=this.index;return{position:e,uv:r,index:i?Array.prototype.slice.call(i.array):[]}},Ri.prototype.addShapeList=function(t,e){var n=t.length;e.arrays=this.getArrays();for(var r=0;r<n;r++){this.addShape(t[r],e)}this.setIndex(e.arrays.index),this.addAttribute("position",new T(e.arrays.position,3)),this.addAttribute("uv",new T(e.arrays.uv,2))},Ri.prototype.addShape=function(t,e){function n(t,e,n){return e||console.error("ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}function r(t,e,n){var r,i,o,a=t.x-e.x,s=t.y-e.y,l=n.x-t.x,u=n.y-t.y,c=a*a+s*s,h=a*u-s*l;if(Math.abs(h)>Number.EPSILON){var p=Math.sqrt(c),d=Math.sqrt(l*l+u*u),f=e.x-s/p,v=e.y+a/p,g=((n.x-u/d-f)*u-(n.y+l/d-v)*l)/(a*u-s*l),y=(r=f+a*g-t.x)*r+(i=v+s*g-t.y)*i;if(y<=2)return new m(r,i);o=Math.sqrt(y/2)}else{var b=!1;a>Number.EPSILON?l>Number.EPSILON&&(b=!0):a<-Number.EPSILON?l<-Number.EPSILON&&(b=!0):Math.sign(s)===Math.sign(u)&&(b=!0),b?(r=-s,i=a,o=Math.sqrt(c)):(r=a,i=s,o=Math.sqrt(c/2))}return new m(r/o,i/o)}function o(t,e){var n,r;for(Q=t.length;--Q>=0;){n=Q,(r=Q-1)<0&&(r=t.length-1);var i=0,o=E+2*A;for(i=0;i<o;i++){var a=Y*i,s=Y*(i+1);!function(t,e,n,r){l(t),l(e),l(r),l(e),l(n),l(r);var i=g.length/3,o=N.generateSideWallUV(F,g,i-6,i-3,i-2,i-1);u(o[0]),u(o[1]),u(o[3]),u(o[1]),u(o[2]),u(o[3])}(e+n+a,e+r+a,e+r+s,e+n+s)}}}function a(t,e,n){_.push(t),_.push(e),_.push(n)}function s(t,e,n){l(t),l(e),l(n);var r=g.length/3,i=N.generateTopUV(F,g,r-3,r-2,r-1);u(i[0]),u(i[1]),u(i[2])}function l(t){y.push(g.length/3),g.push(_[3*t+0]),g.push(_[3*t+1]),g.push(_[3*t+2])}function u(t){b.push(t.x),b.push(t.y)}var c,h,p,d,f,v=e.arrays?e.arrays:this.getArrays(),g=v.position,y=v.index,b=v.uv,_=[],x=void 0!==e.amount?e.amount:100,w=void 0!==e.bevelThickness?e.bevelThickness:6,S=void 0!==e.bevelSize?e.bevelSize:w-2,A=void 0!==e.bevelSegments?e.bevelSegments:3,M=void 0===e.bevelEnabled||e.bevelEnabled,C=void 0!==e.curveSegments?e.curveSegments:12,E=void 0!==e.steps?e.steps:1,P=e.extrudePath,O=!1,N=void 0!==e.UVGenerator?e.UVGenerator:Fi.WorldUVGenerator;P&&(c=P.getSpacedPoints(E),O=!0,M=!1,h=void 0!==e.frames?e.frames:P.computeFrenetFrames(E,!1),p=new i,d=new i,f=new i),M||(A=0,w=0,S=0);var L,I,D,F=this,R=t.extractPoints(C),k=R.shape,U=R.holes;if(!_d.isClockWise(k))for(k=k.reverse(),I=0,D=U.length;I<D;I++)_d.isClockWise(L=U[I])&&(U[I]=L.reverse());var j=_d.triangulateShape(k,U),B=k;for(I=0,D=U.length;I<D;I++)k=k.concat(L=U[I]);for(var z,V,G,H,W,X,Y=k.length,q=j.length,Z=[],Q=0,J=B.length,K=J-1,$=Q+1;Q<J;Q++,K++,$++)K===J&&(K=0),$===J&&($=0),Z[Q]=r(B[Q],B[K],B[$]);var tt,et=[],nt=Z.concat();for(I=0,D=U.length;I<D;I++){for(tt=[],K=(J=(L=U[I]).length)-1,$=(Q=0)+1;Q<J;Q++,K++,$++)K===J&&(K=0),$===J&&($=0),tt[Q]=r(L[Q],L[K],L[$]);et.push(tt),nt=nt.concat(tt)}for(z=0;z<A;z++){for(G=z/A,H=w*Math.cos(G*Math.PI/2),V=S*Math.sin(G*Math.PI/2),Q=0,J=B.length;Q<J;Q++)a((W=n(B[Q],Z[Q],V)).x,W.y,-H);for(I=0,D=U.length;I<D;I++)for(tt=et[I],Q=0,J=(L=U[I]).length;Q<J;Q++)a((W=n(L[Q],tt[Q],V)).x,W.y,-H)}for(V=S,Q=0;Q<Y;Q++)W=M?n(k[Q],nt[Q],V):k[Q],O?(d.copy(h.normals[0]).multiplyScalar(W.x),p.copy(h.binormals[0]).multiplyScalar(W.y),f.copy(c[0]).add(d).add(p),a(f.x,f.y,f.z)):a(W.x,W.y,0);var rt;for(rt=1;rt<=E;rt++)for(Q=0;Q<Y;Q++)W=M?n(k[Q],nt[Q],V):k[Q],O?(d.copy(h.normals[rt]).multiplyScalar(W.x),p.copy(h.binormals[rt]).multiplyScalar(W.y),f.copy(c[rt]).add(d).add(p),a(f.x,f.y,f.z)):a(W.x,W.y,x/E*rt);for(z=A-1;z>=0;z--){for(G=z/A,H=w*Math.cos(G*Math.PI/2),V=S*Math.sin(G*Math.PI/2),Q=0,J=B.length;Q<J;Q++)a((W=n(B[Q],Z[Q],V)).x,W.y,x+H);for(I=0,D=U.length;I<D;I++)for(tt=et[I],Q=0,J=(L=U[I]).length;Q<J;Q++)W=n(L[Q],tt[Q],V),O?a(W.x,W.y+c[E-1].y,c[E-1].x+H):a(W.x,W.y,x+H)}!function(){var t=g.length/3;if(M){var e=0,n=Y*e;for(Q=0;Q<q;Q++)s((X=j[Q])[2]+n,X[1]+n,X[0]+n);for(n=Y*(e=E+2*A),Q=0;Q<q;Q++)s((X=j[Q])[0]+n,X[1]+n,X[2]+n)}else{for(Q=0;Q<q;Q++)s((X=j[Q])[2],X[1],X[0]);for(Q=0;Q<q;Q++)s((X=j[Q])[0]+Y*E,X[1]+Y*E,X[2]+Y*E)}F.addGroup(t,g.length/3-t,0)}(),function(){var t=g.length/3,e=0;for(o(B,e),e+=B.length,I=0,D=U.length;I<D;I++)o(L=U[I],e),e+=L.length;F.addGroup(t,g.length/3-t,1)}(),e.arrays||(this.setIndex(y),this.addAttribute("position",new T(g,3)),this.addAttribute("uv",new T(b,2)))},Fi.WorldUVGenerator={generateTopUV:function(t,e,n,r,i){var o=e[3*r],a=e[3*r+1],s=e[3*i],l=e[3*i+1];return[new m(e[3*n],e[3*n+1]),new m(o,a),new m(s,l)]},generateSideWallUV:function(t,e,n,r,i,o){var a=e[3*n],s=e[3*n+1],l=e[3*n+2],u=e[3*r],c=e[3*r+1],h=e[3*r+2],p=e[3*i],d=e[3*i+1],f=e[3*i+2],v=e[3*o],g=e[3*o+1],y=e[3*o+2];return Math.abs(s-c)<.01?[new m(a,1-l),new m(u,1-h),new m(p,1-f),new m(v,1-y)]:[new m(s,1-l),new m(c,1-h),new m(d,1-f),new m(g,1-y)]}},(ki.prototype=Object.create(v.prototype)).constructor=ki,(Ui.prototype=Object.create(O.prototype)).constructor=Ui,(ji.prototype=Object.create(v.prototype)).constructor=ji,(Bi.prototype=Object.create(O.prototype)).constructor=Bi,(zi.prototype=Object.create(v.prototype)).constructor=zi,(Vi.prototype=Object.create(O.prototype)).constructor=Vi,(Gi.prototype=Object.create(v.prototype)).constructor=Gi,(Hi.prototype=Object.create(Bt.prototype)).constructor=Hi,(Wi.prototype=Object.create(v.prototype)).constructor=Wi,(Xi.prototype=Object.create(Ri.prototype)).constructor=Xi,(Yi.prototype=Object.create(v.prototype)).constructor=Yi,(qi.prototype=Object.create(O.prototype)).constructor=qi,(Zi.prototype=Object.create(v.prototype)).constructor=Zi,(Qi.prototype=Object.create(O.prototype)).constructor=Qi;var wd,Sd;(Ji.prototype=Object.create(c.prototype)).constructor=Ji,Ji.prototype.setDirection=function(){var t,e=new i;return function(n){n.y>.99999?this.quaternion.set(0,0,0,1):n.y<-.99999?this.quaternion.set(1,0,0,0):(e.set(n.z,0,-n.x).normalize(),t=Math.acos(n.y),this.quaternion.setFromAxisAngle(e,t))}}(),Ji.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},Ji.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},(Ki.prototype=Object.create(je.prototype)).constructor=Ki,($i.prototype=Object.create(je.prototype)).constructor=$i,$i.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),c.prototype.updateMatrixWorld.call(this,t))},(to.prototype=Object.create(je.prototype)).constructor=to,to.prototype.update=function(){function t(t,i,a,s){r.set(i,a,s).unproject(o);var l=n[t];if(void 0!==l)for(var u=e.getAttribute("position"),c=0,h=l.length;c<h;c++)u.setXYZ(l[c],r.x,r.y,r.z)}var e,n,r=new i,o=new at;return function(){e=this.geometry,n=this.pointMap;o.projectionMatrix.copy(this.camera.projectionMatrix),t("c",0,0,-1),t("t",0,0,1),t("n1",-1,-1,-1),t("n2",1,-1,-1),t("n3",-1,1,-1),t("n4",1,1,-1),t("f1",-1,-1,1),t("f2",1,-1,1),t("f3",-1,1,1),t("f4",1,1,1),t("u1",.7,1.1,-1),t("u2",-.7,1.1,-1),t("u3",0,2,-1),t("cf1",-1,0,1),t("cf2",1,0,1),t("cf3",0,-1,1),t("cf4",0,1,1),t("cn1",-1,0,-1),t("cn2",1,0,-1),t("cn3",0,-1,-1),t("cn4",0,1,-1),e.getAttribute("position").needsUpdate=!0}}(),(eo.prototype=Object.create(c.prototype)).constructor=eo,eo.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},eo.prototype.update=function(){var t=new i,e=new i,n=new i;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(e,t),this.lightPlane.lookAt(n),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(n),this.targetLine.scale.z=n.length()}}(),(no.prototype=Object.create(je.prototype)).constructor=no,no.prototype.update=function(){var t=new i,e=new i,n=new u;return function(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var r=this.object.matrixWorld,i=this.geometry.attributes.position,o=this.object.geometry,a=o.vertices,s=o.faces,l=0,u=0,c=s.length;u<c;u++){var h=s[u],p=h.normal;t.copy(a[h.a]).add(a[h.b]).add(a[h.c]).divideScalar(3).applyMatrix4(r),e.copy(p).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),i.setXYZ(l,t.x,t.y,t.z),i.setXYZ(l+=1,e.x,e.y,e.z),l+=1}i.needsUpdate=!0}}(),(ro.prototype=Object.create(je.prototype)).constructor=ro,(io.prototype=Object.create(c.prototype)).constructor=io,io.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},io.prototype.update=function(){var t=new i,e=new h,n=new h;return function(){var r=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var i=r.geometry.getAttribute("color");e.copy(this.light.color),n.copy(this.light.groundColor);for(var o=0,a=i.count;o<a;o++){var s=o<a/2?e:n;i.setXYZ(o,s.r,s.g,s.b)}i.needsUpdate=!0}r.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),(oo.prototype=Object.create(z.prototype)).constructor=oo,oo.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.lookAt(this.plane.normal),c.prototype.updateMatrixWorld.call(this,t)},(ao.prototype=Object.create(B.prototype)).constructor=ao,ao.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},ao.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},(so.prototype=Object.create(je.prototype)).constructor=so,(lo.prototype=Object.create(c.prototype)).constructor=lo,lo.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},lo.prototype.update=function(){var t=.5*this.light.width,e=.5*this.light.height,n=this.line.geometry.attributes.position,r=n.array;r[0]=t,r[1]=-e,r[2]=0,r[3]=t,r[4]=e,r[5]=0,r[6]=-t,r[7]=e,r[8]=0,r[9]=-t,r[10]=-e,r[11]=0,r[12]=t,r[13]=-e,r[14]=0,n.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},(co.prototype=Object.create(je.prototype)).constructor=co,co.prototype.updateMatrixWorld=function(){var t=new i,e=new r,n=new r;return function(r){var i=this.bones,o=this.geometry,a=o.getAttribute("position");n.getInverse(this.root.matrixWorld);for(var s=0,l=0;s<i.length;s++){var u=i[s];u.parent&&u.parent.isBone&&(e.multiplyMatrices(n,u.matrixWorld),t.setFromMatrixPosition(e),a.setXYZ(l,t.x,t.y,t.z),e.multiplyMatrices(n,u.parent.matrixWorld),t.setFromMatrixPosition(e),a.setXYZ(l+1,t.x,t.y,t.z),l+=2)}o.getAttribute("position").needsUpdate=!0,c.prototype.updateMatrixWorld.call(this,r)}}(),(ho.prototype=Object.create(c.prototype)).constructor=ho,ho.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},ho.prototype.update=function(){var t=new i,e=new i;return function(){this.light.updateMatrixWorld();var n=this.light.distance?this.light.distance:1e3,r=n*Math.tan(this.light.angle);this.cone.scale.set(r,r,n),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),(po.prototype=Object.create(je.prototype)).constructor=po,po.prototype.update=function(){var t=new i,e=new i,n=new u;return function(){var r=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var i=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry;if(a&&a.isGeometry)for(var s=a.vertices,l=a.faces,u=0,c=0,h=l.length;c<h;c++)for(var p=l[c],d=0,f=p.vertexNormals.length;d<f;d++){var m=p.vertexNormals[d];t.copy(s[p[r[d]]]).applyMatrix4(i),e.copy(m).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(u,t.x,t.y,t.z),o.setXYZ(u+=1,e.x,e.y,e.z),u+=1}else if(a&&a.isBufferGeometry){var v=a.attributes.position,g=a.attributes.normal;for(u=0,d=0,f=v.count;d<f;d++)t.set(v.getX(d),v.getY(d),v.getZ(d)).applyMatrix4(i),e.set(g.getX(d),g.getY(d),g.getZ(d)),e.applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(u,t.x,t.y,t.z),o.setXYZ(u+=1,e.x,e.y,e.z),u+=1}o.needsUpdate=!0}}(),fo.prototype=Object.assign(Object.create(Oe.prototype),{constructor:fo,isRectAreaLight:!0,copy:function(t){return Oe.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var e=Oe.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}}),Object.assign(function(t){this.manager=void 0!==t?t:il}.prototype,{load:function(t,e,n,r){var i=this;new gt(i.manager).load(t,function(t){e(i.parse(JSON.parse(t)))},n,r)},parse:function(t,e){for(var n=[],r=0;r<t.length;r++){var i=ot.parse(t[r]);n.push(i)}e(n)}}),Object.assign(mo.prototype,{load:function(t,e,n,r){var i=this;new gt(i.manager).load(t,function(t){e(i.parse(JSON.parse(t)))},n,r)},parse:function(t){var e=new O,n=t.data.index;if(void 0!==n){var r=new Ad[n.type](n.array);e.setIndex(new y(r,1))}var o=t.data.attributes;for(var a in o){var s=o[a];r=new Ad[s.type](s.array);e.addAttribute(a,new y(r,s.itemSize,s.normalized))}var l=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==l)for(var u=0,c=l.length;u!==c;++u){var h=l[u];e.addGroup(h.start,h.count,h.materialIndex)}var p=t.data.boundingSphere;if(void 0!==p){var d=new i;void 0!==p.center&&d.fromArray(p.center),e.boundingSphere=new f(d,p.radius)}return e}});var Ad={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};Object.assign(function(t){this.manager=void 0!==t?t:il}.prototype,{crossOrigin:"Anonymous",load:function(t,e,n,r){function i(n){a.load(t[n],function(t){o.images[n]=t,6===++s&&(o.needsUpdate=!0,e&&e(o))},void 0,r)}var o=new hn,a=new Nt(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);for(var s=0,l=0;l<t.length;++l)i(l);return o},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(function(t){this.manager=void 0!==t?t:il}.prototype,{load:function(t,e,n,r){var i=this,o=new gt(this.manager);o.setPath(this.path),o.load(t,function(t){var n;try{n=JSON.parse(t)}catch(e){console.warn("FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}var r=i.parse(n);e&&e(r)},n,r)},parse:function(t){return new Ei(t)},setPath:function(t){return this.path=t,this}}),vo.prototype={constructor:vo,setOptions:function(t){return this.options=t,this},load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t);var i=this,o=rl.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o;fetch(t).then(function(t){return t.blob()}).then(function(t){return createImageBitmap(t,i.options)}).then(function(n){rl.add(t,n),e&&e(n),i.manager.itemEnd(t)}).catch(function(e){r&&r(e),i.manager.itemEnd(t),i.manager.itemError(t)})},setCrossOrigin:function(){return this},setPath:function(t){return this.path=t,this}},go.prototype=Object.assign(Object.create(c.prototype),{constructor:go,copy:function(t){c.prototype.copy.call(this,t,!1);for(var e=t.levels,n=0,r=e.length;n<r;n++){var i=e[n];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=this.levels,r=0;r<n.length&&!(e<n[r].distance);r++);n.splice(r,0,{distance:e,object:t}),this.add(t)},getObjectForDistance:function(t){for(var e=this.levels,n=1,r=e.length;n<r&&!(t<e[n].distance);n++);return e[n-1].object},raycast:function(){var t=new i;return function(e,n){t.setFromMatrixPosition(this.matrixWorld);var r=e.ray.origin.distanceTo(t);this.getObjectForDistance(r).raycast(e,n)}}(),update:function(){var t=new i,e=new i;return function(n){var r=this.levels;if(r.length>1){t.setFromMatrixPosition(n.matrixWorld),e.setFromMatrixPosition(this.matrixWorld);var i=t.distanceTo(e);r[0].object.visible=!0;for(var o=1,a=r.length;o<a&&i>=r[o].distance;o++)r[o-1].object.visible=!1,r[o].object.visible=!0;for(;o<a;o++)r[o].object.visible=!1}}}(),toJSON:function(t){var e=c.prototype.toJSON.call(this,t);e.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var o=n[r];e.object.levels.push({object:o.object.uuid,distance:o.distance})}return e}}),yo.prototype.isFog=!0,yo.prototype.clone=function(){return new yo(this.color.getHex(),this.near,this.far)},yo.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},bo.prototype.isFogExp2=!0,bo.prototype.clone=function(){return new bo(this.color.getHex(),this.density)},bo.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}};var Md={WireframeGeometry:Ae,TetrahedronGeometry:Gi,TetrahedronBufferGeometry:Hi,OctahedronGeometry:zt,OctahedronBufferGeometry:Vt,IcosahedronGeometry:jr,IcosahedronBufferGeometry:Br,DodecahedronGeometry:Li,DodecahedronBufferGeometry:Ii,PolyhedronGeometry:jt,PolyhedronBufferGeometry:Bt,TubeGeometry:Zi,TubeBufferGeometry:Qi,TorusKnotGeometry:Yi,TorusGeometry:Gt,TorusBufferGeometry:Ht,TextGeometry:Wi,TextBufferGeometry:Xi,SphereGeometry:N,SphereBufferGeometry:L,RingGeometry:zi,RingBufferGeometry:Vi,PlaneGeometry:ft,PlaneBufferGeometry:mt,LatheGeometry:ki,LatheBufferGeometry:Ui,ShapeGeometry:xi,ShapeBufferGeometry:wi,ExtrudeGeometry:Fi,ExtrudeBufferGeometry:Ri,EdgesGeometry:Di,ConeGeometry:Oi,ConeBufferGeometry:Ni,CylinderGeometry:W,CylinderBufferGeometry:X,CircleGeometry:kr,CircleBufferGeometry:Ur,BoxGeometry:G,BoxBufferGeometry:H};Object.assign(function(t){this.manager=void 0!==t?t:il,this.texturePath=""}.prototype,{load:function(t,e,n,r){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var i=this;new gt(i.manager).load(t,function(n){var o=null;try{o=JSON.parse(n)}catch(e){return void 0!==r&&r(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}var a=o.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?i.parse(o,e):console.error("ObjectLoader: Can't load "+t+". Use JSONLoader instead.")},n,r)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var n=this.parseShape(t.shapes),r=this.parseGeometries(t.geometries,n),i=this.parseImages(t.images,function(){void 0!==e&&e(s)}),o=this.parseTextures(t.textures,i),a=this.parseMaterials(t.materials,o),s=this.parseObject(t.object,r,a);return t.animations&&(s.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(s),s},parseShape:function(t){var e={};if(void 0!==t)for(var n=0,r=t.length;n<r;n++){var i=(new ri).fromJSON(t[n]);e[i.uuid]=i}return e},parseGeometries:function(t,e){var n={};if(void 0!==t)for(var r=new Dt,i=new mo,o=0,a=t.length;o<a;o++){var s,l=t[o];switch(l.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new Md[l.type](l.width,l.height,l.widthSegments,l.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new Md[l.type](l.width,l.height,l.depth,l.widthSegments,l.heightSegments,l.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new Md[l.type](l.radius,l.segments,l.thetaStart,l.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new Md[l.type](l.radiusTop,l.radiusBottom,l.height,l.radialSegments,l.heightSegments,l.openEnded,l.thetaStart,l.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new Md[l.type](l.radius,l.height,l.radialSegments,l.heightSegments,l.openEnded,l.thetaStart,l.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new Md[l.type](l.radius,l.widthSegments,l.heightSegments,l.phiStart,l.phiLength,l.thetaStart,l.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new Md[l.type](l.radius,l.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new Md[l.type](l.innerRadius,l.outerRadius,l.thetaSegments,l.phiSegments,l.thetaStart,l.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new Md[l.type](l.radius,l.tube,l.radialSegments,l.tubularSegments,l.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new Md[l.type](l.radius,l.tube,l.tubularSegments,l.radialSegments,l.p,l.q);break;case"LatheGeometry":case"LatheBufferGeometry":s=new Md[l.type](l.points,l.segments,l.phiStart,l.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new Md[l.type](l.vertices,l.indices,l.radius,l.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":var u=[];for(o=0,a=l.shapes.length;o<a;o++){u.push(e[l.shapes[o]])}s=new Md[l.type](u,l.curveSegments);break;case"BufferGeometry":s=i.parse(l);break;case"Geometry":s=r.parse(l,this.texturePath).geometry;break;default:console.warn('ObjectLoader: Unsupported geometry type "'+l.type+'"');continue}s.uuid=l.uuid,void 0!==l.name&&(s.name=l.name),n[l.uuid]=s}return n},parseMaterials:function(t,e){var n={};if(void 0!==t){var r=new Ot;r.setTextures(e);for(var i=0,o=t.length;i<o;i++){var a=t[i];if("MultiMaterial"===a.type){for(var s=[],l=0;l<a.materials.length;l++)s.push(r.parse(a.materials[l]));n[a.uuid]=s}else n[a.uuid]=r.parse(a)}}return n},parseAnimations:function(t){for(var e=[],n=0;n<t.length;n++){var r=ot.parse(t[n]);e.push(r)}return e},parseImages:function(t,e){function n(t){return r.manager.itemStart(t),o.load(t,function(){r.manager.itemEnd(t)},void 0,function(){r.manager.itemEnd(t),r.manager.itemError(t)})}var r=this,i={};if(void 0!==t&&t.length>0){var o=new Nt(new vt(e));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=t.length;a<s;a++){var l=t[a],u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:r.texturePath+l.url;i[l.uuid]=n(u)}}return i},parseTextures:function(t,e){function n(t,e){return"number"==typeof t?t:(console.warn("ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var r={};if(void 0!==t)for(var i=0,o=t.length;i<o;i++){var a=t[i];void 0===a.image&&console.warn('ObjectLoader: No "image" specified for',a.uuid),void 0===e[a.image]&&console.warn("ObjectLoader: Undefined image",a.image);var s=new ht(e[a.image]);s.needsUpdate=!0,s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.mapping&&(s.mapping=n(a.mapping,Td)),void 0!==a.offset&&s.offset.fromArray(a.offset),void 0!==a.repeat&&s.repeat.fromArray(a.repeat),void 0!==a.center&&s.center.fromArray(a.center),void 0!==a.rotation&&(s.rotation=a.rotation),void 0!==a.wrap&&(s.wrapS=n(a.wrap[0],Cd),s.wrapT=n(a.wrap[1],Cd)),void 0!==a.format&&(s.format=a.format),void 0!==a.minFilter&&(s.minFilter=n(a.minFilter,Ed)),void 0!==a.magFilter&&(s.magFilter=n(a.magFilter,Ed)),void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy),void 0!==a.flipY&&(s.flipY=a.flipY),r[a.uuid]=s}return r},parseObject:function(t,e,n){function r(t){return void 0===e[t]&&console.warn("ObjectLoader: Undefined geometry",t),e[t]}function i(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],r=0,i=t.length;r<i;r++){var o=t[r];void 0===n[o]&&console.warn("ObjectLoader: Undefined material",o),e.push(n[o])}return e}return void 0===n[t]&&console.warn("ObjectLoader: Undefined material",t),n[t]}}var o;switch(t.type){case"Scene":o=new ut,void 0!==t.background&&Number.isInteger(t.background)&&(o.background=new h(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?o.fog=new yo(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(o.fog=new bo(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":o=new st(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(o.focus=t.focus),void 0!==t.zoom&&(o.zoom=t.zoom),void 0!==t.filmGauge&&(o.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(o.filmOffset=t.filmOffset),void 0!==t.view&&(o.view=Object.assign({},t.view));break;case"OrthographicCamera":o=new ct(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(o.zoom=t.zoom),void 0!==t.view&&(o.view=Object.assign({},t.view));break;case"AmbientLight":o=new Ue(t.color,t.intensity);break;case"DirectionalLight":o=new De(t.color,t.intensity);break;case"PointLight":o=new Le(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":o=new fo(t.color,t.intensity,t.width,t.height);break;case"SpotLight":o=new Re(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":o=new ke(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var a=r(t.geometry),s=i(t.material);o=a.bones&&a.bones.length>0?new Ce(a,s):new B(a,s);break;case"LOD":o=new go;break;case"Line":o=new z(r(t.geometry),i(t.material),t.mode);break;case"LineLoop":o=new Ve(r(t.geometry),i(t.material));break;case"LineSegments":o=new je(r(t.geometry),i(t.material));break;case"PointCloud":case"Points":o=new be(r(t.geometry),i(t.material));break;case"Sprite":o=new Sn(i(t.material));break;case"Group":o=new Me;break;default:o=new c}if(o.uuid=t.uuid,void 0!==t.name&&(o.name=t.name),void 0!==t.matrix?(o.matrix.fromArray(t.matrix),o.matrix.decompose(o.position,o.quaternion,o.scale)):(void 0!==t.position&&o.position.fromArray(t.position),void 0!==t.rotation&&o.rotation.fromArray(t.rotation),void 0!==t.quaternion&&o.quaternion.fromArray(t.quaternion),void 0!==t.scale&&o.scale.fromArray(t.scale)),void 0!==t.castShadow&&(o.castShadow=t.castShadow),void 0!==t.receiveShadow&&(o.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(o.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(o.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&o.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(o.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(o.visible=t.visible),void 0!==t.frustumCulled&&(o.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(o.renderOrder=t.renderOrder),void 0!==t.userData&&(o.userData=t.userData),void 0!==t.children)for(var l=t.children,u=0;u<l.length;u++)o.add(this.parseObject(l[u],e,n));if("LOD"===t.type)for(var p=t.levels,d=0;d<p.length;d++){var f=p[d],m=o.getObjectByProperty("uuid",f.object);void 0!==m&&o.addLevel(m,f.distance)}return o}});var Td={UVMapping:Ma,CubeReflectionMapping:Ta,CubeRefractionMapping:Ca,EquirectangularReflectionMapping:Ea,EquirectangularRefractionMapping:Pa,SphericalReflectionMapping:Oa,CubeUVReflectionMapping:Na,CubeUVRefractionMapping:La},Cd={RepeatWrapping:Ia,ClampToEdgeWrapping:Da,MirroredRepeatWrapping:Fa},Ed={NearestFilter:Ra,NearestMipMapNearestFilter:ka,NearestMipMapLinearFilter:Ua,LinearFilter:ja,LinearMipMapNearestFilter:Ba,LinearMipMapLinearFilter:za};Object.assign(function(t,e,n){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==n?n:0,this}.prototype,{set:function(t,e,n){return this.radius=t,this.theta=e,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.radius=Math.sqrt(t.x*t.x+t.z*t.z),this.theta=Math.atan2(t.x,t.z),this.y=t.y,this}}),_o.prototype=Object.assign(Object.create(ht.prototype),{constructor:_o,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}})},function(t,e,n){"use strict";function r(t){return a._22(0,[(t()(),a.Z(0,0,null,null,2,":svg:svg",[["viewBox","0 0 64 64"]],null,null,null,null,null)),a.Y(1,278528,null,0,s.m,[a.q,a.j,a.A],{ngStyle:[0,"ngStyle"]},null),(t()(),a.Z(2,0,null,null,0,":svg:circle",[["transform","translate(32,32)"]],[[1,"r",0]],null,null,null,null))],function(t,e){t(e,1,0,e.context.$implicit.style)},function(t,e){t(e,2,0,e.context.$implicit.r)})}function i(t){return a._22(0,[(t()(),a.Z(0,0,null,null,2,":svg:svg",[["viewBox","0 0 64 64"]],null,null,null,null,null)),a.Y(1,278528,null,0,s.m,[a.q,a.j,a.A],{ngStyle:[0,"ngStyle"]},null),(t()(),a.Z(2,0,null,null,0,":svg:line",[["transform","translate(32,32)"]],[[1,"y1",0],[1,"y2",0]],null,null,null,null))],function(t,e){t(e,1,0,e.context.$implicit.style)},function(t,e){t(e,2,0,e.context.$implicit.y1,e.context.$implicit.y2)})}function o(t){return a._22(2,[(t()(),a.U(16777216,null,null,1,null,r)),a.Y(1,802816,null,0,s.i,[a.I,a.F,a.p],{ngForOf:[0,"ngForOf"]},null),(t()(),a.U(16777216,null,null,1,null,i)),a.Y(3,802816,null,0,s.i,[a.I,a.F,a.p],{ngForOf:[0,"ngForOf"]},null)],function(t,e){var n=e.component;t(e,1,0,n._c);t(e,3,0,n._l)},null)}n.d(e,"a",function(){return l}),e.b=o;var a=n(0),s=n(16),l=(n(1),a.X({encapsulation:2,styles:[],data:{}}))},,function(t,e,n){"use strict";var r=n(28),i=n(79),o=n(137);e.toSubscriber=function(t,e,n){if(t){if(t instanceof r.Subscriber)return t;if(t[i.rxSubscriber])return t[i.rxSubscriber]()}return t||e||n?new r.Subscriber(t,e,n):new r.Subscriber(o.empty)}},function(t,e,n){"use strict";function r(){try{return i.apply(this,arguments)}catch(t){return o.errorObject.e=t,o.errorObject}}var i,o=n(136);e.tryCatch=function(t){return i=t,r}},function(t,e,n){"use strict";var r=n(5).__extends,i=function(t){function e(e){t.call(this),this.errors=e;var n=Error.call(this,e?e.length+" errors occurred during unsubscription:\n  "+e.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"");this.name=n.name="UnsubscriptionError",this.stack=n.stack,this.message=n.message}return r(e,t),e}(Error);e.UnsubscriptionError=i},function(t,e,n){"use strict";function r(t){return t?1===t.length?t[0]:function(e){return t.reduce(function(t,e){return e(t)},e)}:i.noop}var i=n(203);e.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return r(t)},e.pipeFromArray=r},function(t,e,n){"use strict";e.noop=function(){}},function(t,e,n){"use strict";var r=n(14),i=n(205),o=n(140),a=n(207);e.merge=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var n=Number.POSITIVE_INFINITY,s=null,l=t[t.length-1];return o.isScheduler(l)?(s=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(n=t.pop())):"number"==typeof l&&(n=t.pop()),null===s&&1===t.length&&t[0]instanceof r.Observable?t[0]:a.mergeAll(n)(new i.ArrayObservable(t,s))}},function(t,e,n){"use strict";var r=n(5).__extends,i=n(14),o=n(206),a=n(139),s=n(140);e.ArrayObservable=function(t){function e(e,n){t.call(this),this.array=e,this.scheduler=n,n||1!==e.length||(this._isScalar=!0,this.value=e[0])}return r(e,t),e.create=function(t,n){return new e(t,n)},e.of=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];var r=t[t.length-1];s.isScheduler(r)?t.pop():r=null;var i=t.length;return i>1?new e(t,r):1===i?new o.ScalarObservable(t[0],r):new a.EmptyObservable(r)},e.dispatch=function(t){var e=t.array,n=t.index,r=t.subscriber;n>=t.count?r.complete():(r.next(e[n]),r.closed||(t.index=n+1,this.schedule(t)))},e.prototype._subscribe=function(t){var n=this.array,r=n.length,i=this.scheduler;if(i)return i.schedule(e.dispatch,0,{array:n,index:0,count:r,subscriber:t});for(var o=0;o<r&&!t.closed;o++)t.next(n[o]);t.complete()},e}(i.Observable)},function(t,e,n){"use strict";var r=n(5).__extends,i=n(14);e.ScalarObservable=function(t){function e(e,n){t.call(this),this.value=e,this.scheduler=n,this._isScalar=!0,n&&(this._isScalar=!1)}return r(e,t),e.create=function(t,n){return new e(t,n)},e.dispatch=function(t){var e=t.value,n=t.subscriber;t.done?n.complete():(n.next(e),n.closed||(t.done=!0,this.schedule(t)))},e.prototype._subscribe=function(t){var n=this.value,r=this.scheduler;if(r)return r.schedule(e.dispatch,0,{done:!1,value:n,subscriber:t});t.next(n),t.closed||t.complete()},e}(i.Observable)},function(t,e,n){"use strict";var r=n(208),i=n(213);e.mergeAll=function(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),r.mergeMap(i.identity,null,t)}},function(t,e,n){"use strict";var r=n(5).__extends,i=n(80),o=n(81);e.mergeMap=function(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),function(r){return"number"==typeof e&&(n=e,e=null),r.lift(new a(t,e,n))}};var a=function(){function t(t,e,n){void 0===n&&(n=Number.POSITIVE_INFINITY),this.project=t,this.resultSelector=e,this.concurrent=n}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.project,this.resultSelector,this.concurrent))},t}();e.MergeMapOperator=a;var s=function(t){function e(e,n,r,i){void 0===i&&(i=Number.POSITIVE_INFINITY),t.call(this,e),this.project=n,this.resultSelector=r,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}return r(e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e,t,n)},e.prototype._innerSub=function(t,e,n){this.add(i.subscribeToResult(this,t,e,n))},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete()},e.prototype.notifyNext=function(t,e,n,r,i){this.resultSelector?this._notifyResultSelector(t,e,n,r):this.destination.next(e)},e.prototype._notifyResultSelector=function(t,e,n,r){var i;try{i=this.resultSelector(t,e,n,r)}catch(t){return void this.destination.error(t)}this.destination.next(i)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(o.OuterSubscriber);e.MergeMapSubscriber=s},function(t,e,n){"use strict";e.isArrayLike=function(t){return t&&"number"==typeof t.length}},function(t,e,n){"use strict";e.isPromise=function(t){return t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}},function(t,e,n){"use strict";function r(t){var e=t.Symbol;if("function"==typeof e)return e.iterator||(e.iterator=e("iterator polyfill")),e.iterator;var n=t.Set;if(n&&"function"==typeof(new n)["@@iterator"])return"@@iterator";var r=t.Map;if(r)for(var i=Object.getOwnPropertyNames(r.prototype),o=0;o<i.length;++o){var a=i[o];if("entries"!==a&&"size"!==a&&r.prototype[a]===r.prototype.entries)return a}return"@@iterator"}var i=n(33);e.symbolIteratorPonyfill=r,e.iterator=r(i.root),e.$$iterator=e.iterator},function(t,e,n){"use strict";var r=n(5).__extends,i=n(28);e.InnerSubscriber=function(t){function e(e,n,r){t.call(this),this.parent=e,this.outerValue=n,this.outerIndex=r,this.index=0}return r(e,t),e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(i.Subscriber)},function(t,e,n){"use strict";e.identity=function(t){return t}},function(t,e,n){"use strict";var r=n(215);e.share=function(){return r.share()(this)}},function(t,e,n){"use strict";function r(){return new a.Subject}var i=n(216),o=n(141),a=n(44);e.share=function(){return function(t){return o.refCount()(i.multicast(r)(t))}}},function(t,e,n){"use strict";var r=n(217);e.multicast=function(t,e){return function(n){var o;if(o="function"==typeof t?t:function(){return t},"function"==typeof e)return n.lift(new i(o,e));var a=Object.create(n,r.connectableObservableDescriptor);return a.source=n,a.subjectFactory=o,a}};var i=function(){function t(t,e){this.subjectFactory=t,this.selector=e}return t.prototype.call=function(t,e){var n=this.selector,r=this.subjectFactory(),i=n(r).subscribe(t);return i.add(e.subscribe(r)),i},t}();e.MulticastOperator=i},function(t,e,n){"use strict";var r=n(5).__extends,i=n(44),o=n(14),a=(n(28),n(37)),s=n(141),l=function(t){function e(e,n){t.call(this),this.source=e,this.subjectFactory=n,this._refCount=0,this._isComplete=!1}return r(e,t),e.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},e.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},e.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new a.Subscription).add(this.source.subscribe(new c(this.getSubject(),this))),t.closed?(this._connection=null,t=a.Subscription.EMPTY):this._connection=t),t},e.prototype.refCount=function(){return s.refCount()(this)},e}(o.Observable);e.ConnectableObservable=l;var u=l.prototype;e.connectableObservableDescriptor={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:u._subscribe},_isComplete:{value:u._isComplete,writable:!0},getSubject:{value:u.getSubject},connect:{value:u.connect},refCount:{value:u.refCount}};var c=function(t){function e(e,n){t.call(this,e),this.connectable=n}return r(e,t),e.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},e}(i.SubjectSubscriber)},function(t,e,n){"use strict";var r=n(5).__extends,i=function(t){function e(){var e=t.call(this,"object unsubscribed");this.name=e.name="ObjectUnsubscribedError",this.stack=e.stack,this.message=e.message}return r(e,t),e}(Error);e.ObjectUnsubscribedError=i},function(t,e,n){"use strict";var r=n(5).__extends,i=n(37);e.SubjectSubscription=function(t){function e(e,n){t.call(this),this.subject=e,this.subscriber=n,this.closed=!1}return r(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},e}(i.Subscription)},function(t,e,n){"use strict";var r=n(221);e.forkJoin=r.ForkJoinObservable.create},function(t,e,n){"use strict";var r=n(5).__extends,i=n(14),o=n(139),a=n(134),s=n(80),l=n(81);e.ForkJoinObservable=function(t){function e(e,n){t.call(this),this.sources=e,this.resultSelector=n}return r(e,t),e.create=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];if(null===t||0===arguments.length)return new o.EmptyObservable;var r=null;return"function"==typeof t[t.length-1]&&(r=t.pop()),1===t.length&&a.isArray(t[0])&&(t=t[0]),0===t.length?new o.EmptyObservable:new e(t,r)},e.prototype._subscribe=function(t){return new u(t,this.sources,this.resultSelector)},e}(i.Observable);var u=function(t){function e(e,n,r){t.call(this,e),this.sources=n,this.resultSelector=r,this.completed=0,this.haveValues=0;var i=n.length;this.total=i,this.values=new Array(i);for(var o=0;o<i;o++){var a=s.subscribeToResult(this,n[o],null,o);a&&(a.outerIndex=o,this.add(a))}}return r(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.values[n]=e,i._hasValue||(i._hasValue=!0,this.haveValues++)},e.prototype.notifyComplete=function(t){var e=this.destination,n=this.haveValues,r=this.resultSelector,i=this.values,o=i.length;if(t._hasValue){if(this.completed++,this.completed===o){if(n===o){var a=r?r.apply(this,i):i;e.next(a)}e.complete()}}else e.complete()},e}(l.OuterSubscriber)},function(t,e,n){"use strict";var r=n(223);e.fromPromise=r.PromiseObservable.create},function(t,e,n){"use strict";function r(t){var e=t.subscriber;e.closed||(e.next(t.value),e.complete())}function i(t){var e=t.subscriber;e.closed||e.error(t.err)}var o=n(5).__extends,a=n(33),s=n(14);e.PromiseObservable=function(t){function e(e,n){t.call(this),this.promise=e,this.scheduler=n}return o(e,t),e.create=function(t,n){return new e(t,n)},e.prototype._subscribe=function(t){var e=this,n=this.promise,o=this.scheduler;if(null==o)this._isScalar?t.closed||(t.next(this.value),t.complete()):n.then(function(n){e.value=n,e._isScalar=!0,t.closed||(t.next(n),t.complete())},function(e){t.closed||t.error(e)}).then(null,function(t){a.root.setTimeout(function(){throw t})});else if(this._isScalar){if(!t.closed)return o.schedule(r,0,{value:this.value,subscriber:t})}else n.then(function(n){e.value=n,e._isScalar=!0,t.closed||t.add(o.schedule(r,0,{value:n,subscriber:t}))},function(e){t.closed||t.add(o.schedule(i,0,{err:e,subscriber:t}))}).then(null,function(t){a.root.setTimeout(function(){throw t})})},e}(s.Observable)},function(t,e,n){"use strict";var r=n(5).__extends,i=n(28);e.map=function(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new o(t,e))}};var o=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.project,this.thisArg))},t}();e.MapOperator=o;var a=function(t){function e(e,n,r){t.call(this,e),this.project=n,this.count=0,this.thisArg=r||this}return r(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(i.Subscriber)},function(t,e,n){"use strict";var r=n(226);e.takeUntil=function(t){return r.takeUntil(t)(this)}},function(t,e,n){"use strict";var r=n(5).__extends,i=n(81),o=n(80);e.takeUntil=function(t){return function(e){return e.lift(new a(t))}};var a=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.notifier))},t}(),s=function(t){function e(e,n){t.call(this,e),this.notifier=n,this.add(o.subscribeToResult(this,n))}return r(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.complete()},e.prototype.notifyComplete=function(){},e}(i.OuterSubscriber)},function(t,e,n){"use strict";var r=n(14),i=n(149);r.Observable.prototype.map=i.map},function(t,e,n){"use strict";var r=n(14),i=n(229);r.Observable.prototype.timeout=i.timeout},function(t,e,n){"use strict";var r=n(168),i=n(234);e.timeout=function(t,e){return void 0===e&&(e=r.async),i.timeout(t,e)(this)}},function(t,e,n){"use strict";var r=n(5).__extends,i=n(33),o=n(231);e.AsyncAction=function(t){function e(e,n){t.call(this,e,n),this.scheduler=e,this.work=n,this.pending=!1}return r(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t,this.pending=!0;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this},e.prototype.requestAsyncId=function(t,e,n){return void 0===n&&(n=0),i.root.setInterval(t.flush.bind(t,this),n)},e.prototype.recycleAsyncId=function(t,e,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return e;i.root.clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var n=!1,r=void 0;try{this.work(t)}catch(t){n=!0,r=!!t&&t||new Error(t)}if(n)return this.unsubscribe(),r},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(o.Action)},function(t,e,n){"use strict";var r=n(5).__extends,i=n(37);e.Action=function(t){function e(e,n){t.call(this)}return r(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(i.Subscription)},function(t,e,n){"use strict";var r=n(5).__extends,i=n(233);e.AsyncScheduler=function(t){function e(){t.apply(this,arguments),this.actions=[],this.active=!1,this.scheduled=void 0}return r(e,t),e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}},e}(i.Scheduler)},function(t,e,n){"use strict";e.Scheduler=function(){function t(e,n){void 0===n&&(n=t.now),this.SchedulerAction=e,this.now=n}return t.prototype.schedule=function(t,e,n){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(n,e)},t.now=Date.now?Date.now:function(){return+new Date},t}()},function(t,e,n){"use strict";var r=n(5).__extends,i=n(168),o=n(235),a=n(28),s=n(236);e.timeout=function(t,e){void 0===e&&(e=i.async);var n=o.isDate(t),r=n?+t-e.now():Math.abs(t);return function(t){return t.lift(new l(r,n,e,new s.TimeoutError))}};var l=function(){function t(t,e,n,r){this.waitFor=t,this.absoluteTimeout=e,this.scheduler=n,this.errorInstance=r}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.absoluteTimeout,this.waitFor,this.scheduler,this.errorInstance))},t}(),u=function(t){function e(e,n,r,i,o){t.call(this,e),this.absoluteTimeout=n,this.waitFor=r,this.scheduler=i,this.errorInstance=o,this.action=null,this.scheduleTimeout()}return r(e,t),e.dispatchTimeout=function(t){t.error(t.errorInstance)},e.prototype.scheduleTimeout=function(){var t=this.action;t?this.action=t.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(e.dispatchTimeout,this.waitFor,this))},e.prototype._next=function(e){this.absoluteTimeout||this.scheduleTimeout(),t.prototype._next.call(this,e)},e.prototype._unsubscribe=function(){this.action=null,this.scheduler=null,this.errorInstance=null},e}(a.Subscriber)},function(t,e,n){"use strict";e.isDate=function(t){return t instanceof Date&&!isNaN(+t)}},function(t,e,n){"use strict";var r=n(5).__extends,i=function(t){function e(){var e=t.call(this,"Timeout has occurred");this.name=e.name="TimeoutError",this.stack=e.stack,this.message=e.message}return r(e,t),e}(Error);e.TimeoutError=i},function(t,e,n){(function(e){var n;!function(e){t.exports=e()}(function(){return function t(e,r,i){function o(s,l){if(!r[s]){if(!e[s]){if(!l&&("function"==typeof n&&n))return n(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return o(n||t)},c,c.exports,t,e,r,i)}return r[s].exports}for(var a="function"==typeof n&&n,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,n){"use strict";function r(){}function i(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=f,this.queue=[],this.outcome=void 0,t!==r&&l(this,t)}function o(t,e,n){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function a(t,e,n){c(function(){var r;try{r=e(n)}catch(e){return h.reject(t,e)}r===t?h.reject(t,new TypeError("Cannot resolve promise with itself")):h.resolve(t,r)})}function s(t){var e=t&&t.then;if(t&&"object"==typeof t&&"function"==typeof e)return function(){e.apply(t,arguments)}}function l(t,e){function n(e){i||(i=!0,h.reject(t,e))}function r(e){i||(i=!0,h.resolve(t,e))}var i=!1,o=u(function(){e(r,n)});"error"===o.status&&n(o.value)}function u(t,e){var n={};try{n.value=t(e),n.status="success"}catch(t){n.status="error",n.value=t}return n}var c=t(2),h={},p=["REJECTED"],d=["FULFILLED"],f=["PENDING"];e.exports=n=i,i.prototype.catch=function(t){return this.then(null,t)},i.prototype.then=function(t,e){if("function"!=typeof t&&this.state===d||"function"!=typeof e&&this.state===p)return this;var n=new this.constructor(r);if(this.state!==f){a(n,this.state===d?t:e,this.outcome)}else this.queue.push(new o(n,t,e));return n},o.prototype.callFulfilled=function(t){h.resolve(this.promise,t)},o.prototype.otherCallFulfilled=function(t){a(this.promise,this.onFulfilled,t)},o.prototype.callRejected=function(t){h.reject(this.promise,t)},o.prototype.otherCallRejected=function(t){a(this.promise,this.onRejected,t)},h.resolve=function(t,e){var n=u(s,e);if("error"===n.status)return h.reject(t,n.value);var r=n.value;if(r)l(t,r);else{t.state=d,t.outcome=e;for(var i=-1,o=t.queue.length;++i<o;)t.queue[i].callFulfilled(e)}return t},h.reject=function(t,e){t.state=p,t.outcome=e;for(var n=-1,r=t.queue.length;++n<r;)t.queue[n].callRejected(e);return t},n.resolve=function(t){return t instanceof this?t:h.resolve(new this(r),t)},n.reject=function(t){var e=new this(r);return h.reject(e,t)},n.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,i=!1;if(!n)return this.resolve([]);for(var o=new Array(n),a=0,s=-1,l=new this(r);++s<n;)!function(t,r){e.resolve(t).then(function(t){o[r]=t,++a!==n||i||(i=!0,h.resolve(l,o))},function(t){i||(i=!0,h.reject(l,t))})}(t[s],s);return l},n.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,i=!1;if(!n)return this.resolve([]);for(var o=-1,a=new this(r);++o<n;)!function(t){e.resolve(t).then(function(t){i||(i=!0,h.resolve(a,t))},function(t){i||(i=!0,h.reject(a,t))})}(t[o]);return a}},{2:2}],2:[function(t,n,r){(function(t){"use strict";function e(){u=!0;for(var t,e,n=c.length;n;){for(e=c,c=[],t=-1;++t<n;)e[t]();n=c.length}u=!1}var r,i=t.MutationObserver||t.WebKitMutationObserver;if(i){var o=0,a=new i(e),s=t.document.createTextNode("");a.observe(s,{characterData:!0}),r=function(){s.data=o=++o%2}}else if(t.setImmediate||void 0===t.MessageChannel)r="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var n=t.document.createElement("script");n.onreadystatechange=function(){e(),n.onreadystatechange=null,n.parentNode.removeChild(n),n=null},t.document.documentElement.appendChild(n)}:function(){setTimeout(e,0)};else{var l=new t.MessageChannel;l.port1.onmessage=e,r=function(){l.port2.postMessage(0)}}var u,c=[];n.exports=function(t){1!==c.push(t)||u||r()}}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(t,n,r){(function(e){"use strict";"function"!=typeof e.Promise&&(e.Promise=t(1))}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1}],4:[function(t,e,n){"use strict";function r(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(i){if("TypeError"!==i.name)throw i;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<t.length;r+=1)n.append(t[r]);return n.getBlob(e.type)}}function i(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}function o(t,e,n){"function"==typeof e&&t.then(e),"function"==typeof n&&t.catch(n)}function a(t){return"boolean"==typeof y?_.resolve(y):function(t){return new _(function(e){var n=r([""]);t.objectStore(x).put(n,"key"),t.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},t.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);e(n||!t||parseInt(t[1],10)>=43)}}).catch(function(){return!1})}(t).then(function(t){return y=t})}function s(t,e){return new _(function(n,r){if(t.db){if(!e)return n(t.db);!function(t){var e=b[t.name],n={};n.promise=new _(function(t){n.resolve=t}),e.deferredOperations.push(n),e.dbReady=e.dbReady?e.dbReady.then(function(){return n.promise}):n.promise}(t),t.db.close()}var i=[t.name];e&&i.push(t.version);var o=g.open.apply(g,i);e&&(o.onupgradeneeded=function(e){var n=o.result;try{n.createObjectStore(t.storeName),e.oldVersion<=1&&n.createObjectStore(x)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+t.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),o.onerror=function(){r(o.error)},o.onsuccess=function(){n(o.result),function(t){var e=b[t.name].deferredOperations.pop();e&&e.resolve()}(t)}})}function l(t){return r([function(t){for(var e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n),i=0;i<e;i++)r[i]=t.charCodeAt(i);return n}(atob(t.data))],{type:t.type})}function u(t){return t&&t.__local_forage_encoded_blob}function c(t){var e=this,n=e._initReady().then(function(){var t=b[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady});return o(n,t,t),n}function h(t){var e,n,r,i,o,a=.75*t.length,s=t.length,l=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var u=new ArrayBuffer(a),c=new Uint8Array(u);for(e=0;e<s;e+=4)n=A.indexOf(t[e]),r=A.indexOf(t[e+1]),i=A.indexOf(t[e+2]),o=A.indexOf(t[e+3]),c[l++]=n<<2|r>>4,c[l++]=(15&r)<<4|i>>2,c[l++]=(3&i)<<6|63&o;return u}function p(t){var e,n=new Uint8Array(t),r="";for(e=0;e<n.length;e+=3)r+=A[n[e]>>2],r+=A[(3&n[e])<<4|n[e+1]>>4],r+=A[(15&n[e+1])<<2|n[e+2]>>6],r+=A[63&n[e+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}function d(t,e){t[e]=function(){var n=arguments;return t.ready().then(function(){return t[e].apply(t,n)})}}function f(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var n in e)e.hasOwnProperty(n)&&(arguments[0][n]=Q(e[n])?e[n].slice():e[n])}return arguments[0]}function m(t){for(var e in X)if(X.hasOwnProperty(e)&&X[e]===t)return!0;return!1}var v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){}}();"undefined"==typeof Promise&&void 0!==t&&t(3);var y,b,_=Promise,x="local-forage-detect-blob-support",w=Object.prototype.toString,S={_driver:"asyncStorage",_initStorage:function(t){function e(){return _.resolve()}var n=this,r={db:null};if(t)for(var i in t)r[i]=t[i];b||(b={});var o=b[r.name];o||(b[r.name]=o={forages:[],db:null,dbReady:null,deferredOperations:[]}),o.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=c);for(var a=[],l=0;l<o.forages.length;l++){var u=o.forages[l];u!==n&&a.push(u._initReady().catch(e))}var h=o.forages.slice(0);return _.all(a).then(function(){return r.db=o.db,function(t){return s(t,!1)}(r)}).then(function(t){return r.db=t,function(t,e){if(!t.db)return!0;var n=!t.db.objectStoreNames.contains(t.storeName),r=t.version>t.db.version;if(t.version<t.db.version&&(t.version!==e&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),r||n){if(n){var i=t.db.version+1;i>t.version&&(t.version=i)}return!0}return!1}(r,n._defaultConfig.version)?function(t){return s(t,!0)}(r):t}).then(function(t){r.db=o.db=t,n._dbInfo=r;for(var e=0;e<h.length;e++){var i=h[e];i!==n&&(i._dbInfo.db=r.db,i._dbInfo.version=r.version)}})},iterate:function(t,e){var n=this,r=new _(function(e,r){n.ready().then(function(){var i=n._dbInfo,o=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName).openCursor(),a=1;o.onsuccess=function(){var n=o.result;if(n){var r=n.value;u(r)&&(r=l(r));var i=t(r,n.key,a++);void 0!==i?e(i):n.continue()}else e()},o.onerror=function(){r(o.error)}}).catch(r)});return i(r,e),r},getItem:function(t,e){var n=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=new _(function(e,r){n.ready().then(function(){var i=n._dbInfo,o=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName).get(t);o.onsuccess=function(){var t=o.result;void 0===t&&(t=null),u(t)&&(t=l(t)),e(t)},o.onerror=function(){r(o.error)}}).catch(r)});return i(r,e),r},setItem:function(t,e,n){var r=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var o=new _(function(n,i){var o;r.ready().then(function(){return o=r._dbInfo,"[object Blob]"===w.call(e)?a(o.db).then(function(t){return t?e:function(t){return new _(function(e,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");e({__local_forage_encoded_blob:!0,data:r,type:t.type})},r.readAsBinaryString(t)})}(e)}):e}).then(function(e){var r=o.db.transaction(o.storeName,"readwrite"),a=r.objectStore(o.storeName);null===e&&(e=void 0),r.oncomplete=function(){void 0===e&&(e=null),n(e)},r.onabort=r.onerror=function(){i(s.error?s.error:s.transaction.error)};var s=a.put(e,t)}).catch(i)});return i(o,n),o},removeItem:function(t,e){var n=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=new _(function(e,r){n.ready().then(function(){var i=n._dbInfo,o=i.db.transaction(i.storeName,"readwrite"),a=o.objectStore(i.storeName).delete(t);o.oncomplete=function(){e()},o.onerror=function(){r(a.error)},o.onabort=function(){r(a.error?a.error:a.transaction.error)}}).catch(r)});return i(r,e),r},clear:function(t){var e=this,n=new _(function(t,n){e.ready().then(function(){var r=e._dbInfo,i=r.db.transaction(r.storeName,"readwrite"),o=i.objectStore(r.storeName).clear();i.oncomplete=function(){t()},i.onabort=i.onerror=function(){n(o.error?o.error:o.transaction.error)}}).catch(n)});return i(n,t),n},length:function(t){var e=this,n=new _(function(t,n){e.ready().then(function(){var r=e._dbInfo,i=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName).count();i.onsuccess=function(){t(i.result)},i.onerror=function(){n(i.error)}}).catch(n)});return i(n,t),n},key:function(t,e){var n=this,r=new _(function(e,r){t<0?e(null):n.ready().then(function(){var i=n._dbInfo,o=!1,a=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName).openCursor();a.onsuccess=function(){var n=a.result;n?0===t?e(n.key):o?e(n.key):(o=!0,n.advance(t)):e(null)},a.onerror=function(){r(a.error)}}).catch(r)});return i(r,e),r},keys:function(t){var e=this,n=new _(function(t,n){e.ready().then(function(){var r=e._dbInfo,i=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName).openCursor(),o=[];i.onsuccess=function(){var e=i.result;e?(o.push(e.key),e.continue()):t(o)},i.onerror=function(){n(i.error)}}).catch(n)});return i(n,t),n}},A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",M="~~local_forage_type~",T=/^~~local_forage_type~([^~]+)~/,C="__lfsc__:",E=C.length,P="arbf",O="blob",N="si08",L="ui08",I="uic8",D="si16",F="si32",R="ur16",k="ui32",U="fl32",j="fl64",B=E+P.length,z=Object.prototype.toString,V={serialize:function(t,e){var n="";if(t&&(n=z.call(t)),t&&("[object ArrayBuffer]"===n||t.buffer&&"[object ArrayBuffer]"===z.call(t.buffer))){var r,i=C;t instanceof ArrayBuffer?(r=t,i+=P):(r=t.buffer,"[object Int8Array]"===n?i+=N:"[object Uint8Array]"===n?i+=L:"[object Uint8ClampedArray]"===n?i+=I:"[object Int16Array]"===n?i+=D:"[object Uint16Array]"===n?i+=R:"[object Int32Array]"===n?i+=F:"[object Uint32Array]"===n?i+=k:"[object Float32Array]"===n?i+=U:"[object Float64Array]"===n?i+=j:e(new Error("Failed to get type for BinaryArray"))),e(i+p(r))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n=M+t.type+"~"+p(this.result);e(C+O+n)},o.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(n){console.error("Couldn't convert value into a JSON string: ",t),e(null,n)}},deserialize:function(t){if(t.substring(0,E)!==C)return JSON.parse(t);var e,n=t.substring(B),i=t.substring(E,B);if(i===O&&T.test(n)){var o=n.match(T);e=o[1],n=n.substring(o[0].length)}var a=h(n);switch(i){case P:return a;case O:return r([a],{type:e});case N:return new Int8Array(a);case L:return new Uint8Array(a);case I:return new Uint8ClampedArray(a);case D:return new Int16Array(a);case R:return new Uint16Array(a);case F:return new Int32Array(a);case k:return new Uint32Array(a);case U:return new Float32Array(a);case j:return new Float64Array(a);default:throw new Error("Unkown type: "+i)}},stringToBuffer:h,bufferToString:p},G={_driver:"webSQLStorage",_initStorage:function(t){var e=this,n={db:null};if(t)for(var r in t)n[r]="string"!=typeof t[r]?t[r].toString():t[r];var i=new _(function(t,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(t){return r(t)}n.db.transaction(function(i){i.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){e._dbInfo=n,t()},function(t,e){r(e)})})});return n.serializer=V,i},iterate:function(t,e){var n=this,r=new _(function(e,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("SELECT * FROM "+i.storeName,[],function(n,r){for(var o=r.rows,a=o.length,s=0;s<a;s++){var l=o.item(s),u=l.value;if(u&&(u=i.serializer.deserialize(u)),void 0!==(u=t(u,l.key,s+1)))return void e(u)}e()},function(t,e){r(e)})})}).catch(r)});return i(r,e),r},getItem:function(t,e){var n=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=new _(function(e,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[t],function(t,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=i.serializer.deserialize(r)),e(r)},function(t,e){r(e)})})}).catch(r)});return i(r,e),r},setItem:function(t,e,n){var r=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var o=new _(function(n,i){r.ready().then(function(){void 0===e&&(e=null);var o=e,a=r._dbInfo;a.serializer.serialize(e,function(e,r){r?i(r):a.db.transaction(function(r){r.executeSql("INSERT OR REPLACE INTO "+a.storeName+" (key, value) VALUES (?, ?)",[t,e],function(){n(o)},function(t,e){i(e)})},function(t){t.code===t.QUOTA_ERR&&i(t)})})}).catch(i)});return i(o,n),o},removeItem:function(t,e){var n=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=new _(function(e,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("DELETE FROM "+i.storeName+" WHERE key = ?",[t],function(){e()},function(t,e){r(e)})})}).catch(r)});return i(r,e),r},clear:function(t){var e=this,n=new _(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){e.executeSql("DELETE FROM "+r.storeName,[],function(){t()},function(t,e){n(e)})})}).catch(n)});return i(n,t),n},length:function(t){var e=this,n=new _(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){e.executeSql("SELECT COUNT(key) as c FROM "+r.storeName,[],function(e,n){var r=n.rows.item(0).c;t(r)},function(t,e){n(e)})})}).catch(n)});return i(n,t),n},key:function(t,e){var n=this,r=new _(function(e,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[t+1],function(t,n){var r=n.rows.length?n.rows.item(0).key:null;e(r)},function(t,e){r(e)})})}).catch(r)});return i(r,e),r},keys:function(t){var e=this,n=new _(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){e.executeSql("SELECT key FROM "+r.storeName,[],function(e,n){for(var r=[],i=0;i<n.rows.length;i++)r.push(n.rows.item(i).key);t(r)},function(t,e){n(e)})})}).catch(n)});return i(n,t),n}},H={_driver:"localStorageWrapper",_initStorage:function(t){var e={};if(t)for(var n in t)e[n]=t[n];return e.keyPrefix=e.name+"/",e.storeName!==this._defaultConfig.storeName&&(e.keyPrefix+=e.storeName+"/"),this._dbInfo=e,e.serializer=V,_.resolve()},iterate:function(t,e){var n=this,r=n.ready().then(function(){for(var e=n._dbInfo,r=e.keyPrefix,i=r.length,o=localStorage.length,a=1,s=0;s<o;s++){var l=localStorage.key(s);if(0===l.indexOf(r)){var u=localStorage.getItem(l);if(u&&(u=e.serializer.deserialize(u)),void 0!==(u=t(u,l.substring(i),a++)))return u}}});return i(r,e),r},getItem:function(t,e){var n=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=n.ready().then(function(){var e=n._dbInfo,r=localStorage.getItem(e.keyPrefix+t);return r&&(r=e.serializer.deserialize(r)),r});return i(r,e),r},setItem:function(t,e,n){var r=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var o=r.ready().then(function(){void 0===e&&(e=null);var n=e;return new _(function(i,o){var a=r._dbInfo;a.serializer.serialize(e,function(e,r){if(r)o(r);else try{localStorage.setItem(a.keyPrefix+t,e),i(n)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||o(t),o(t)}})})});return i(o,n),o},removeItem:function(t,e){var n=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=n.ready().then(function(){var e=n._dbInfo;localStorage.removeItem(e.keyPrefix+t)});return i(r,e),r},clear:function(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(t)&&localStorage.removeItem(r)}});return i(n,t),n},length:function(t){var e=this.keys().then(function(t){return t.length});return i(e,t),e},key:function(t,e){var n=this,r=n.ready().then(function(){var e,r=n._dbInfo;try{e=localStorage.key(t)}catch(t){e=null}return e&&(e=e.substring(r.keyPrefix.length)),e});return i(r,e),r},keys:function(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo,n=localStorage.length,r=[],i=0;i<n;i++)0===localStorage.key(i).indexOf(t.keyPrefix)&&r.push(localStorage.key(i).substring(t.keyPrefix.length));return r});return i(n,t),n}},W={},X={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},Y=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],q={description:"",driver:[X.INDEXEDDB,X.WEBSQL,X.LOCALSTORAGE].slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},Z={};Z[X.INDEXEDDB]=function(){try{return!!g&&!("undefined"!=typeof openDatabase&&"undefined"!=typeof navigator&&navigator.userAgent&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent))&&g&&"function"==typeof g.open&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}}(),Z[X.WEBSQL]="function"==typeof openDatabase,Z[X.LOCALSTORAGE]=function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&localStorage.setItem}catch(t){return!1}}();var Q=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},J=new(function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.INDEXEDDB=X.INDEXEDDB,this.LOCALSTORAGE=X.LOCALSTORAGE,this.WEBSQL=X.WEBSQL,this._defaultConfig=f({},q),this._config=f({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver)}return t.prototype.config=function(t){if("object"===(void 0===t?"undefined":v(t))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t)"storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),this._config[e]=t[e];return"driver"in t&&t.driver&&this.setDriver(this._config.driver),!0}return"string"==typeof t?this._config[t]:this._config},t.prototype.defineDriver=function(t,e,n){var r=new _(function(e,n){try{var r=t._driver,i=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),o=new Error("Custom driver name already in use: "+t._driver);if(!t._driver)return void n(i);if(m(t._driver))return void n(o);for(var a=Y.concat("_initStorage"),s=0;s<a.length;s++){var l=a[s];if(!l||!t[l]||"function"!=typeof t[l])return void n(i)}var u=_.resolve(!0);"_support"in t&&(u=t._support&&"function"==typeof t._support?t._support():_.resolve(!!t._support)),u.then(function(n){Z[r]=n,W[r]=t,e()},n)}catch(t){n(t)}});return o(r,e,n),r},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(t,e,n){var r=this,i=_.resolve().then(function(){if(!m(t)){if(W[t])return W[t];throw new Error("Driver not found.")}switch(t){case r.INDEXEDDB:return S;case r.LOCALSTORAGE:return H;case r.WEBSQL:return G}});return o(i,e,n),i},t.prototype.getSerializer=function(t){var e=_.resolve(V);return o(e,t),e},t.prototype.ready=function(t){var e=this,n=e._driverSet.then(function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready});return o(n,t,t),n},t.prototype.setDriver=function(t,e,n){function r(){i._config.driver=i.driver()}var i=this;Q(t)||(t=[t]);var a=this._getSupportedDrivers(t),s=null!==this._driverSet?this._driverSet.catch(function(){return _.resolve()}):_.resolve();return this._driverSet=s.then(function(){var t=a[0];return i._dbInfo=null,i._ready=null,i.getDriver(t).then(function(t){i._driver=t._driver,r(),i._wrapLibraryMethodsWithReady(),i._initDriver=function(t){return function(){function e(){for(;n<t.length;){var o=t[n];return n++,i._dbInfo=null,i._ready=null,i.getDriver(o).then(function(t){return i._extend(t),r(),i._ready=i._initStorage(i._config),i._ready}).catch(e)}r();var a=new Error("No available storage method found.");return i._driverSet=_.reject(a),i._driverSet}var n=0;return e()}}(a)})}).catch(function(){r();var t=new Error("No available storage method found.");return i._driverSet=_.reject(t),i._driverSet}),o(this._driverSet,e,n),this._driverSet},t.prototype.supports=function(t){return!!Z[t]},t.prototype._extend=function(t){f(this,t)},t.prototype._getSupportedDrivers=function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];this.supports(i)&&e.push(i)}return e},t.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0;t<Y.length;t++)d(this,Y[t])},t.prototype.createInstance=function(e){return new t(e)},t}());e.exports=J},{3:3}]},{},[4])(4)})}).call(e,n(78))},function(t,e,n){!function(e,n){t.exports=n()}(0,function(){"use strict";function t(e){return t.result?t.result:e&&"function"==typeof e.getSerializer?t.result=e.getSerializer():Promise.reject(new Error("localforage.getSerializer() was not available! localforage v1.4+ is required!"))}function e(t,n){return(e.result=e.result||{})[n]?e.result[n]:t&&"function"==typeof t.getDriver?e.result[n]=t.getDriver(n):Promise.reject(new Error("localforage.getDriver() was not available! localforage v1.4+ is required!"))}function n(t){return e(t,t.WEBSQL)}function r(){return i.then(function(){if("undefined"!=typeof sqlitePlugin&&"function"==typeof sqlitePlugin.openDatabase)return sqlitePlugin.openDatabase;throw new Error("SQLite plugin is not present.")})}var i=new Promise(function(t,e){"undefined"!=typeof sqlitePlugin?t():"undefined"==typeof cordova?e(new Error("cordova is not defined.")):document.addEventListener("deviceready",function(){return t()},!1)}).catch(function(){return Promise.resolve()}),o={_driver:"cordovaSQLiteDriver",_initStorage:function(e){var i=this,o={db:null};if(e)for(var a in e)o[a]="string"!=typeof e[a]?e[a].toString():e[a];var s=r().then(function(t){return new Promise(function(e,n){try{o.location=o.location||"default",o.db=t({name:o.name,version:String(o.version),description:o.description,size:o.size,location:o.location})}catch(t){n(t)}o.db.transaction(function(t){t.executeSql("CREATE TABLE IF NOT EXISTS "+o.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){i._dbInfo=o,e()},function(t,e){n(e)})})})}),l=t(i),u=n(i);return Promise.all([l,u,s]).then(function(t){return o.serializer=t[0],s})},_support:function(){return r().then(function(t){return!!t}).catch(function(){return!1})}};return function(t){function e(t,e){t[e]=function(){var t=this,r=arguments;return n(t).then(function(n){return n[e].apply(t,r)})}}for(var r=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],i=0,o=r.length;i<o;i++)e(t,r[i])}(o),o})},function(t,e,n){"use strict";function r(t){return i._22(0,[i._18(402653184,1,{_vp:0}),(t()(),i.Z(1,16777216,[[1,3],["viewport",1]],null,0,"div",[["nav-viewport",""]],null,null,null,null,null)),(t()(),i.Z(2,0,null,null,0,"div",[["class","nav-decor"]],null,null,null,null,null))],null,null)}n.d(e,"a",function(){return o}),e.b=r;var i=n(0),o=(n(4),n(19),n(1),n(3),n(7),n(31),n(12),n(9),i.X({encapsulation:2,styles:[],data:{}}))}]);